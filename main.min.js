var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{h(a.next(e))}catch(t){o(t)}}function s(e){try{h(a["throw"](e))}catch(t){o(t)}}function h(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,s)}h((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return a([e,t])}}function a(n){if(i)throw new TypeError("Generator is already executing.");for(;h;)try{if(i=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,o=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){h.label=n[1];break}if(6===n[0]&&h.label<r[1]){h.label=r[1],r=n;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(n);break}r[2]&&h.ops.pop(),h.trys.pop();continue}n=t.call(e,h)}catch(a){n=[6,a],o=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,r,s,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},BaseBody=function(e){function t(){var t=e.call(this)||this;return t.moveSpeed=GameDefine.Define_Move_Speed,t}return __extends(t,e),t.prototype.setMovePoint=function(e){this._movePaths=e,this._movePaths&&this._movePaths.length>0?(this._moveTarget=this._movePaths.shift(),this.onChangeDir()):this._moveTarget=null},Object.defineProperty(t.prototype,"movePaths",{get:function(){return this._movePaths},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveTarget",{get:function(){return this._moveTarget},enumerable:!0,configurable:!0}),t.prototype.setMePositon=function(e,t){this._slefPos||(this._slefPos=new egret.Point),this.x=e,this.y=t,this._slefPos.setTo(this.x,this.y)},Object.defineProperty(t.prototype,"selfPoint",{get:function(){return this._slefPos||(this._slefPos=new egret.Point),this._slefPos.setTo(this.x,this.y),this._slefPos},enumerable:!0,configurable:!0}),t.prototype.isMove=function(){return this._moveTarget?!0:!1},t.prototype.stopMove=function(){this._moveTarget=null,this._movePaths=null},t.prototype.logicMove=function(e,t){if(void 0===t&&(t=0),this._moveTarget){var n=egret.Point.distance(this.selfPoint,this._moveTarget),a=e*this.moveSpeed/1e3;if(n+t>a){var i=a/n;this.moveRun(Math.round((this._moveTarget.x-this.x)*i),Math.round((this._moveTarget.y-this.y)*i))}else this.moveFinish()}else this.stopMove();return!1},t.prototype.moveRun=function(e,t){this.setMePositon(this.x+e,this.y+t)},t.prototype.moveFinish=function(){this.setMePositon(this._moveTarget.x,this._moveTarget.y),this._movePaths&&this._movePaths.length>0?(this._moveTarget=this._movePaths.shift(),this.onChangeDir()):this.stopMove()},t.prototype.onChangeDir=function(){},t.prototype.distanceToSelf=function(e){return egret.Point.distance(this.selfPoint,e.selfPoint)},t.prototype.getDistToTarget=function(){return this._moveTarget?egret.Point.distance(this.selfPoint,this._moveTarget):0},t.prototype.onReset=function(){this.stopMove()},t.prototype.onDestroy=function(){},t}(egret.DisplayObjectContainer);__reflect(BaseBody.prototype,"BaseBody");var BaseWindowPanel=function(e){function t(t){var n=e.call(this)||this;return n.funcID=-1,n.points=RedPointManager.createPoint(0),n.priority=PANEL_HIERARCHY_TYPE.I,n.owner=t,n.basic=new eui.Component,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LOADING_OPEN)),this.onSkinName()},t.prototype.onLoadComplete=function(){this.isloadComp=!0,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LOADING_CLOSE)),this.onInit(),this._isShow&&(this.showHandler(),this.onRegist()),SDKManager.isHidePay&&SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&GameCommon.getInstance().onHideIOSBanWord(this)},t.prototype.onInit=function(){},t.prototype.onRefresh=function(){},t.prototype.onSkinName=function(){},t.prototype.onShow=function(){-1!=this.funcID&&FunDefine.onIsLockandErrorHint(this.funcID)||this.parentLayer&&(this._isShow||(this._isShow=!0,this.onAddToWindowLayer(),this.isloadComp&&(this.onRegist(),this.onRefresh())))},t.prototype.onAddToWindowLayer=function(){this.parentLayer.addChild(this),this.isloadComp&&this.showHandler()},t.prototype.showHandler=function(){this.priority==PANEL_HIERARCHY_TYPE.II?(this.owner.onShowOrHideMaskView(),this.height=GameDefine.GAME_STAGE_HEIGHT,this.y=size.height-GameDefine.GAME_STAGE_HEIGHT):this.basic&&(this.basic.height=size.height,DataManager.IS_PC_Game||(size.height<=GameDefine.GAME_STAGE_HEIGHT?(this.scaleY=(size.height-50)/size.height,this.y=50):(this.basic.height=GameDefine.GAME_STAGE_HEIGHT,this.y=size.height-GameDefine.GAME_STAGE_HEIGHT)),DataManager.IS_PC_Game||(this.basic.width=size.width,this.width=size.width,this.x=(GameDefine.GAME_STAGE_WIDTH-size.width)/2)),this.basic&&this.basic.mainbtnbarLayer&&this.owner.mainbtnbarUI.addToLayer(this.basic.mainbtnbarLayer),this.updateCurreny()},t.prototype.onShowWithParam=function(e){this.onShow()},t.prototype.onRegist=function(){(this.basic.money_bind||this.basic.money_gold)&&GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.updateCurreny,this),this.basic.closeBtn1&&this.basic.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.basic.closeBtn2&&this.basic.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.basic.btnTopMoney&&this.basic.btnTopMoney.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTopMoney,this),this.basic.btnTopDiamond&&this.basic.btnTopDiamond.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTopDiamond,this),this.onReloadUIResource()},t.prototype.onRemove=function(){this.basic.closeBtn1&&this.basic.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.basic.closeBtn2&&this.basic.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.basic.btnTopMoney&&this.basic.btnTopMoney.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTopMoney,this),this.basic.btnTopDiamond&&this.basic.btnTopDiamond.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTopDiamond,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.updateCurreny,this),this.onDisposeUIAnim()},t.prototype.onTouchCloseBtn=function(){this.onHide()},t.prototype.onTouchTopMoney=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"HallWelfarePanel")},t.prototype.onTouchTopDiamond=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onHide=function(){this._isShow=!1,this.isloadComp&&this.onRemove(),this.parent&&this.parent.removeChild(this);for(var e=!0,t=this.parentLayer.numChildren-1;t>=0;t--){var n=this.parentLayer.getChildAt(t);if(n&&n.priority==PANEL_HIERARCHY_TYPE.I){e=!1;break}n.basic&&n.basic.mainbtnbarLayer&&this.owner.mainbtnbarUI.addToLayer(n.basic.mainbtnbarLayer)}e&&(GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_ALLREMOVED)),this.owner.mainviewPointRefresh()),this.owner.onShowOrHideMaskView(),this.owner&&this.owner.onQuitGuide(this)},t.prototype.onDisposeUIAnim=function(){this._ResIsDispose=!0,this.removeEventListener(egret.Event.ADDED,this.onChildAdded,this)},t.prototype.onReloadUIResource=function(){if(this._ResIsDispose){this._ResIsDispose=!1;for(var e=0;e<this.numChildren;e++){var t=this.getChildAt(e);LoadManager.getInstance().reloadUIImageAndAnim(t)}this.addEventListener(egret.Event.ADDED,this.onChildAdded,this)}},t.prototype.onChildAdded=function(e){egret.is(e.currentTarget,"egret.DisplayObjectContainer")&&LoadManager.getInstance().reloadUIImageAndAnim(e.currentTarget)},Object.defineProperty(t.prototype,"parentLayer",{get:function(){return this.owner.PupoBar},enumerable:!0,configurable:!0}),t.prototype.setTitle=function(e){if(e){var t=this.basic.panel_title,n=this.basic.label_title;e.indexOf("png")>0?(t&&(t.source=e),n&&(n.text="")):this.basic.label_title&&(n&&(n.text=e),t&&(t.source=""))}},t.prototype.setTitlePercent=function(e){this.basic.panel_title.scaleX=e,this.basic.panel_title.scaleY=e},t.prototype.setTiltleOffY=function(e){this.basic.panel_title.y+=e},t.prototype.setBg=function(e){this.basic.basic_tip_bg.source=e},t.prototype.updateCurreny=function(){var e=DataManager.getInstance().playerManager.player;this.basic.money_bind&&(this.basic.money_bind.text=GameCommon.getInstance().getFormatNumberShow(e.money)),this.basic.money_gold&&(this.basic.money_gold.text=GameCommon.getInstance().getFormatNumberShow(e.gold))},Object.defineProperty(t.prototype,"isShow",{get:function(){return this._isShow},enumerable:!0,configurable:!0}),t.prototype.createRedPoint=function(){var e=new redPoint;return this.points.push(e),e},t.prototype.trigger=function(){if(this.isloadComp){for(var e=0;e<this.points.length;e++)this.points[e].checkPointAll();this.basic&&this.basic.mainbtnbarLayer&&this.basic.mainbtnbarLayer.getChildIndex(this.owner.mainbtnbarUI)>=0&&this.owner.mainbtnbarUI.trigger()}},t}(eui.Component);__reflect(BaseWindowPanel.prototype,"BaseWindowPanel");var WindowParam=function(){function e(e,t){this.windowName=e,this.param=t}return e}();__reflect(WindowParam.prototype,"WindowParam");var PANEL_HIERARCHY_TYPE;!function(e){e[e.I=0]="I",e[e.II=1]="II"}(PANEL_HIERARCHY_TYPE||(PANEL_HIERARCHY_TYPE={}));var ModelJsonBase=function(){function e(e){this._json=e}return Object.defineProperty(e.prototype,"id",{get:function(){var e=this._json.ID||this._json.id||this._json.Id;return Tool.stringIsNum(e)?parseInt(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrAry",{get:function(){return this._attributes||(this._attributes=GameCommon.getInstance().getAttributeAry(this)),this._attributes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"costList",{get:function(){return this._costList||(this._costList=GameCommon.getInstance().onParseAwardItemstr(this._json.consume||this._json.cost||this._json.itemCost)),this._costList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cost",{get:function(){return this._cost||(this._cost=GameCommon.parseAwardItem(this._json.consume||this._json.cost||this._json.itemCost)),this._cost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"costOneKey",{get:function(){return this._costOneKey||(this._costOneKey=GameCommon.parseAwardItem(this._json.costOneKey)),this._costOneKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewards",{get:function(){return this._rewards||(this._rewards=GameCommon.getInstance().onParseAwardItemstr(this.getStrValue("reward")||this.getStrValue("rewards")||this.getStrValue("show"))),this._rewards},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"costNum",{get:function(){return parseInt(this._json.cost)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dailytaskPro",{get:function(){return this._dailytaskPro},set:function(e){this._dailytaskPro=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"base_effect",{get:function(){return this._attrEffect||(this._attrEffect=GameCommon.getInstance().onParseAttributeStr(this._json.effect)),this._attrEffect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shuxing",{get:function(){if(!this._shuxing){var e=[],t=this._json.shuxing;if(t){t=t.split("#");for(var n=0;n<t.length;++n){var a=t[n].split(",");e[a[0]]=parseInt(a[1])}}this._shuxing=e}return this._shuxing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"base_jackaroo",{get:function(){return this.getStrValue("jackaroo")},enumerable:!0,configurable:!0}),e.prototype.getStrValue=function(e){return"*"==this._json[e]?"":this._json[e]},Object.defineProperty(e.prototype,"unionBossStatus",{get:function(){return this._bossStatus},set:function(e){this._bossStatus=e},enumerable:!0,configurable:!0}),e}();__reflect(ModelJsonBase.prototype,"ModelJsonBase");var DataManager=function(){function e(){}return Object.defineProperty(e,"version",{get:function(){return"1_0_0"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"res_ver",{get:function(){return"1_0_0"},enumerable:!0,configurable:!0}),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},Object.defineProperty(e.prototype,"playerManager",{get:function(){return this._playerManager||(this._playerManager=new PlayerManager),this._playerManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverManager",{get:function(){return this._serverManager||(this._serverManager=new ServerManager),this._serverManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strongerManager",{get:function(){return this._strongerManager||(this._strongerManager=new StrongerMonterManager),this._strongerManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yewaipvpManager",{get:function(){return this._yewaipvpManager||(this._yewaipvpManager=new YewaiPvPManager),this._yewaipvpManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bagManager",{get:function(){return this._bagManager||(this._bagManager=new BagManager),this._bagManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forgeManager",{get:function(){return this._forgeManager||(this._forgeManager=new ForgeManager),this._forgeManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dupManager",{get:function(){return this._dupManager||(this._dupManager=new DupManager),this._dupManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"legendManager",{get:function(){return this._legendManager||(this._legendManager=new LegendManager),this._legendManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xiandanManager",{get:function(){return this._xiandanManager||(this._xiandanManager=new XianDanManager),this._xiandanManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pulseManager",{get:function(){return this._pulseManager||(this._pulseManager=new PulseManager),this._pulseManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"arenaManager",{get:function(){return this._arenaManager||(this._arenaManager=new ArenaManager),this._arenaManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localArenaManager",{get:function(){return this._localArenaManager||(this._localArenaManager=new LocalArenaManager),this._localArenaManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shopManager",{get:function(){return this._shopManager||(this._shopManager=new ShopManager),this._shopManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taskManager",{get:function(){return this._taskManager||(this._taskManager=new TaskManager),this._taskManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailManager",{get:function(){return this._mailManager||(this._mailManager=new MailManager),this._mailManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chatManager",{get:function(){return this._chatManager||(this._chatManager=new ChatManager),this._chatManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unionManager",{get:function(){return this._unionManager||(this._unionManager=new UnionManager),this._unionManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"broadcastManager",{get:function(){return this._broadcastManager||(this._broadcastManager=new BroadcastManager),this._broadcastManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hintManager",{get:function(){return this._hintManager||(this._hintManager=new HintManager),this._hintManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"psychManager",{get:function(){return this._psychManager||(this._psychManager=new PsychManager),this._psychManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fateManager",{get:function(){return this._fateManager||(this._fateManager=new FateManager),this._fateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redPointManager",{get:function(){return this._redPointManager||(this._redPointManager=new RedPointManager),this._redPointManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blessManager",{get:function(){return this._blessManager||(this._blessManager=new BlessManager),this._blessManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillManager",{get:function(){return this._skillManager||(this._skillManager=new SkillManager),this._skillManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillEnhantM",{get:function(){return this._skillEnhantM||(this._skillEnhantM=new SkillEnchantManager),this._skillEnhantM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"escortManager",{get:function(){return this._escortManager||(this._escortManager=new EscortManager),this._escortManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityManager",{get:function(){return this._activityManager||(this._activityManager=new ActivityManager),this._activityManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sevenDayCarnivalManager",{get:function(){return this._sevenDayCarnivalManager||(this._sevenDayCarnivalManager=new SevenDayCarnivalManager),this._sevenDayCarnivalManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRankManager",{get:function(){return this._topRankManager||(this._topRankManager=new TopRankManager),this._topRankManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"newactivitysManager",{get:function(){return this._newactivitysManager||(this._newactivitysManager=new NewactivitysManager),this._newactivitysManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"monthCardManager",{get:function(){return this._monthCardManager||(this._monthCardManager=new MonthCardManager),this._monthCardManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vipManager",{get:function(){return this._vipManager||(this._vipManager=new VipManager),this._vipManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rechargeManager",{get:function(){return this._rechargeManager||(this._rechargeManager=new RechargeManager),this._rechargeManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"welfareManager",{get:function(){return this._welfareManager||(this._welfareManager=new WelfareManager),this._welfareManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hallActivityManager",{get:function(){return this._hallActivityManager||(this._hallActivityManager=new HallActivityManager),this._hallActivityManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalRechargeManager",{get:function(){return this._totalRechargeManager||(this._totalRechargeManager=new TotalRechargeManager),this._totalRechargeManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"investManager",{get:function(){return this._investManager||(this._investManager=new InvestManager),this._investManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rebateManager",{get:function(){return this._rebateManager||(this._rebateManager=new RebateManager),this._rebateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lianxuChongManager",{get:function(){return this._lianxuLeiChongManager||(this._lianxuLeiChongManager=new LianXuLeiChongManager),this._lianxuLeiChongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openServerLeiChongManager",{get:function(){return this._openServerLeiChongManager||(this._openServerLeiChongManager=new OpenServerLeiChongManager),this._openServerLeiChongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tLShopManager",{get:function(){return this._tLShopManager||(this._tLShopManager=new TLShopManager),this._tLShopManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tLGiftManager",{get:function(){return this._tLGiftManager||(this._tLGiftManager=new TLGiftManager),this._tLGiftManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tOPRankGiftManager",{get:function(){return this._tOPRankGiftManager||(this._tOPRankGiftManager=new TOPRankGiftManager),this._tOPRankGiftManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"turnplateManager",{get:function(){return this._turnplateManager||(this._turnplateManager=new TurnplateManager),this._turnplateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeGoodsManager",{get:function(){return this._timeGoodsManager||(this._timeGoodsManager=new TimeGoodsManager),this._timeGoodsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vipTLGiftManager",{get:function(){return this._vipTLGiftManager||(this._vipTLGiftManager=new VIPTLGiftManager),this._vipTLGiftManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vipTLShopManager",{get:function(){return this._vipTLShopManager||(this._vipTLShopManager=new VIPTLShopManager),this._vipTLShopManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shentongManager",{get:function(){return this._shentongManager||(this._shentongManager=new ShenTongManager),this._shentongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coatardManager",{get:function(){return this._coatardManager||(this._coatardManager=new CoatardManager),this._coatardManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collectWordManager",{get:function(){return this._collectWordManager||(this._collectWordManager=new CollectWordManager),this._collectWordManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tLDogzManager",{get:function(){return this._tLDogzManager||(this._tLDogzManager=new TLDogzManager),this._tLDogzManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"springActivityManager",{get:function(){return this._springActivityManager||(this._springActivityManager=new SpringActivityManager),this._springActivityManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"signInManager",{get:function(){return this._signInManager||(this._signInManager=new SignInManager),this._signInManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"springTLShopManager",{get:function(){return this._springTLShopManager||(this._springTLShopManager=new SpringTLShopManager),this._springTLShopManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crossConsumeRankManager",{get:function(){return this._crossConsumeRankManager||(this._crossConsumeRankManager=new CrossConsumeRankManager),this._crossConsumeRankManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalConsumeManager",{get:function(){return this._totalConsumeManager||(this._totalConsumeManager=new TotalConsumeManager),this._totalConsumeManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oneDollarManager",{get:function(){return this._oneDollarManager||(this._oneDollarManager=new OneDollarManager),this._oneDollarManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"luckTurnplateManager",{get:function(){return this._luckTurnplateManager||(this._luckTurnplateManager=new LuckTurnplateManager),this._luckTurnplateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gemManager",{get:function(){return this._gemManager||(this._gemManager=new GemManager),this._gemManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spatBloodsManager",{get:function(){return this._spatBloodsManager||(this._spatBloodsManager=new SpatBloodManager),this._spatBloodsManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oneRebateSTManager",{get:function(){return this._oneRebateSTManager||(this._oneRebateSTManager=new OneRebateSTManager),this._oneRebateSTManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orangeFeastManager",{get:function(){return this._orangeFeastManager||(this._orangeFeastManager=new OrangeFeastManager),this._orangeFeastManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rebirthManager",{get:function(){return this._rebirthManager||(this._rebirthManager=new RebirthManager),this._rebirthManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dominateManager",{get:function(){return this._dominateManager||(this._dominateManager=new DominateManager),this._dominateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"magicManager",{get:function(){return this._magicManager||(this._magicManager=new MagicManager),this._magicManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"celestialManager",{get:function(){return this._celestialManager||(this._celestialManager=new CelestialManager),this._celestialManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shenqiZhuanPanManager",{get:function(){return this._shenqiZhuanPanManager||(this._shenqiZhuanPanManager=new ShenQiZhuanPanManager),this._shenqiZhuanPanManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tianGongManager",{get:function(){return this._tianGongManager||(this._tianGongManager=new TianGongManager),this._tianGongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fuLingManager",{get:function(){return this._fuLingManager||(this._fuLingManager=new FuLingManager),this._fuLingManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleManager",{get:function(){return this._titleManager||(this._titleManager=new TitleManager),this._titleManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tujianManager",{get:function(){return this._tujianManager||(this._tujianManager=new TuJianManager),this._tujianManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treasureRankManager",{get:function(){return this._treasureRankManager||(this._treasureRankManager=new TreasureRankManager),this._treasureRankManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"functionManager",{get:function(){return this._functionManager||(this._functionManager=new FunctionManager),this._functionManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wishingWellManager",{get:function(){return this._wishingWellManager||(this._wishingWellManager=new WishingWellManager),this._wishingWellManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friendManager",{get:function(){return this._friendManager||(this._friendManager=new FriendManager),this._friendManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalLoginManager",{get:function(){return this._festivalLoginManager||(this._festivalLoginManager=new FestivalLoginManager),this._festivalLoginManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalDanChongManager",{get:function(){return this._festivalDanChongManager||(this._festivalDanChongManager=new FestivalDanChongManager),this._festivalDanChongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wxDanChongManager",{get:function(){return this._wxDanChongManager||(this._wxDanChongManager=new WXDanChongManager),this._wxDanChongManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalFavorableManager",{get:function(){return this._festivalFavorableManager||(this._festivalFavorableManager=new FestivalFavorableManager),this._festivalFavorableManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalWishingwellManager",{get:function(){return this._festivalWishingwellManager||(this._festivalWishingwellManager=new FestivalWishingwellManager),this._festivalWishingwellManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalTargetManager",{get:function(){return this._festivalTargetManager||(this._festivalTargetManager=new FestivalTargetManager),this._festivalTargetManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalShopManager",{get:function(){return this._festivalShopManager||(this._festivalShopManager=new FestivalShopManager),this._festivalShopManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalLuckyBagManager",{get:function(){return this._festivalLuckyBagManager||(this._festivalLuckyBagManager=new FestivalLuckyBagManager),this._festivalLuckyBagManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"festivalWuYiManager",{get:function(){return this._festivalWuYiManager||(this._festivalWuYiManager=new FestivalWuYiManager),this._festivalWuYiManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hefuActManager",{get:function(){return this._hefuActManager||(this._hefuActManager=new HefuActivtyManager),this._hefuActManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tuangouActManager",{get:function(){return this._tuangouActManager||(this._tuangouActManager=new ActivityTuangouManager),this._tuangouActManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"petManager",{get:function(){return this._PetManager||(this._PetManager=new PetManager),this._PetManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playCafeManager",{get:function(){return this._PlayCafeManager||(this._PlayCafeManager=new PlayCafeManager),this._PlayCafeManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragonSoulManager",{get:function(){return this._dragonSoulManager||(this._dragonSoulManager=new DragonSoulManager),this._dragonSoulManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labaManager",{get:function(){return this._labaManager||(this._labaManager=new ActivityLabaManager),this._labaManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wxgameManager",{get:function(){return this._wxgameManager||(this._wxgameManager=new WXGameManager),this._wxgameManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zqManager",{get:function(){return this._zqManager||(this._zqManager=new ActivityZQManager),this._zqManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yuanjieManager",{get:function(){return this._yjManager||(this._yjManager=new YuanJieManager),this._yjManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wuTanManager",{get:function(){return this._wtManager||(this._wtManager=new WuTanManager),this._wtManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jxdManager",{get:function(){return this._jxdManager||(this._jxdManager=new ActJueXingDanManager),this._jxdManager
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activitySmeltManager",{get:function(){return this._activitySmeltManager||(this._activitySmeltManager=new ActivitySmeltManager),this._activitySmeltManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a666Manager",{get:function(){return this._a666Manager||(this._a666Manager=new Activity666Manager),this._a666Manager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pvpManager",{get:function(){return this._pvpManager||(this._pvpManager=new PVPManager),this._pvpManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ringManager",{get:function(){return this._ringManager||(this._ringManager=new MarryRingManager),this._ringManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marryManager",{get:function(){return this._marryManager||(this._marryManager=new MarryManager),this._marryManager},enumerable:!0,configurable:!0}),e.IOS_PAY_ISOPEN=!0,e.IOS_PAY_OPENMISSION=0,e.IOS_PAY_LEVEL=0,e}();__reflect(DataManager.prototype,"DataManager");var ThingBase=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.num=0,this.type=e,this.modelId=t,this.num=n}return e.prototype.onupdate=function(e,t,n){void 0===t&&(t=-1),void 0===n&&(n=0),this.modelId=e,0>t?this.quality=this.model.quality:this.quality=t,this.num=n},Object.defineProperty(e.prototype,"model",{get:function(){var e=GameCommon.getInstance().getThingModel(this.type,this.modelId,this.quality);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"idKey",{get:function(){return this.type+"_"+this.modelId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asAward",{get:function(){return new AwardItem(this.type,this.modelId,this.num)},enumerable:!0,configurable:!0}),e}();__reflect(ThingBase.prototype,"ThingBase");var GoodsQuality;!function(e){e[e.White=0]="White",e[e.Green=1]="Green",e[e.Blue=2]="Blue",e[e.Purple=3]="Purple",e[e.Orange=4]="Orange",e[e.Red=5]="Red",e[e.Gold=6]="Gold"}(GoodsQuality||(GoodsQuality={}));var BodyData=function(){function e(e,t){this.figthPower=0,this.reborncount=0,this.shieldValue=0,this._deathCount=-1,this.attributes=GameCommon.getInstance().getAttributeAry(),this.targets=[],this.bufferInfoDict={},this.updateData(e,t)}return e.prototype.updateData=function(e,t){if(this.modelid!=e){if(this.modelid=e,this.bodyType=t,this.model=ModelManager.getInstance().getModelFigher(this.modelid),this.model||Tool.throwException("缺少fightter数据！::::"+this.modelid),this.skills)for(var n=this.skills.length-1;n>=0;n--){var a=this.skills[n];a=null,this.skills.splice(n,1)}else this.skills=[];for(var i=this.model.skill.split(","),n=0;n<i.length;n++){var o=parseInt(i[n]);if(o){var a=new SkillInfo(o,n);this.skills.push(a)}}}this.onRefreshProp(),this.onRebirth()},e.prototype.onRefreshProp=function(){this.figthPower=GameCommon.calculationFighting(this.attributes)},Object.defineProperty(e.prototype,"maxHp",{get:function(){return this._maxHp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentHp",{get:function(){return this._currentHp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDie",{get:function(){return this._currentHp<=0},enumerable:!0,configurable:!0}),e.prototype.onRebirth=function(){this._useSkill&&(this._useSkill=null),this.onRestHpInfo(this.attributes[ATTR_TYPE.HP],this.attributes[ATTR_TYPE.HP]),this._deathCount=-1,this.hit_mabi=0,this.hit_chenmo=0,this.hasArtifactEft||(this.refreshRebornEft(),this.refreshShieldEft())},Object.defineProperty(e.prototype,"deathCount",{get:function(){return this._deathCount},set:function(e){this._deathCount=e},enumerable:!0,configurable:!0}),e.prototype.onRestHpInfo=function(e,t){void 0===t&&(t=0),t>0&&(this._maxHp=t),Tool.isNumber(e)||(e=0),this._currentHp=Math.min(this._maxHp,Math.max(e,0))},e.prototype.getCanUseSkill=function(){if(this.isUseingSkill)return null;if(this.isHitChenMo&&(this._useSkill=this.getSkillInfoById(SkillDefine.COMMON_SKILL_ID)),this._useSkill)return this._useSkill;for(var e=0;e<this.skills.length;e++){var t=this.skills[e];if(t.level>0&&!t.isSkillCD)return this._useSkill=t,this._useSkill}},e.prototype.onReleaseSkill=function(){this._useSkill&&(this.skillStampTime=egret.getTimer()+this._useSkill.model.castTime,this._useSkill.usestart(),this._useSkill=null,this._attackCount++)},Object.defineProperty(e.prototype,"useSkill",{get:function(){return this._useSkill},set:function(e){this._useSkill=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUseingSkill",{get:function(){var e=this.skillStampTime-egret.getTimer();return e>0&&5e3>e},enumerable:!0,configurable:!0}),e.prototype.getSkillInfoById=function(e){for(var t=0;t<this.skills.length;t++)if(e==this.skills[t].id)return this.skills[t];return null},e.prototype.resetAllSkillCD=function(e){for(var t=0;t<this.skills.length;t++){var n=this.skills[t];n.reset()}this.skillStampTime=0,this._useSkill=null,this.use_mabi=0,this.use_chenmo=0,this._attackCount=0,this._relseSkillCount=0,this._startRandomIdx=Math.max(0,e),this.onResetSkillStartIdx()},e.prototype.onResetSkillStartIdx=function(){},Object.defineProperty(e.prototype,"randomValue",{get:function(){if(!Tool.isNumber(this._startRandomIdx))return-1;var e=RandomDefine.FIGHT_RANDOM[GameFight.getInstance().fight_randomIndex];return e[this.radomIndex%e.length]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radomIndex",{get:function(){return this._startRandomIdx+this._attackCount-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHitMaBi",{get:function(){return this.hit_mabi>=egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHitChenMo",{get:function(){return this.hit_chenmo>=egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mabiEffect",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mabiRatio",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.onHitMaBi=function(e){this.hit_mabi=egret.getTimer()+e},Object.defineProperty(e.prototype,"chenmoEffect",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chenmoRatio",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.onHitChenMo=function(e){this.hit_chenmo=egret.getTimer()+e,this._useSkill=this.getSkillInfoById(SkillDefine.COMMON_SKILL_ID)},e.prototype.refreshRebornEft=function(){this.reborncount=0},e.prototype.onRebornEffect=function(){if(this.reborncount>0){this.reborncount--,this.hit_mabi=0,this.hit_chenmo=0;var e=Tool.toInt(this.maxHp*this.rebornEffect/GameDefine.GAME_ADD_RATIO);this.onRestHpInfo(e)}},Object.defineProperty(e.prototype,"rebornEffect",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.refreshShieldEft=function(){this.shieldValue=0},Object.defineProperty(e.prototype,"shieldEffect",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pojiaEffect",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.addBuffer=function(e,t){e>0&&(this.removeBuffer(e),this.bufferInfoDict[e]=new BuffInfo(e,t))},e.prototype.removeBuffer=function(e){this.bufferInfoDict[e]&&(this.bufferInfoDict[e]=null,delete this.bufferInfoDict[e])},Object.defineProperty(e.prototype,"currentAttributes",{get:function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=0;t<this.attributes.length;t++){var n=this.attributes[t];n>0&&(e[t]+=n)}if(GameFight.getInstance().onCheckBodyIsHero(this)){var a=GameFight.getInstance().unionCheerNum;if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.LODDER_ARENA){var i=DataManager.getInstance().arenaManager.ladderArenaData;if(i.inspireCount>0){var o=FightDefine.ladderBuffEffect[i.inspireCount-1];e[ATTR_TYPE.ATTACK]=Math.floor(e[ATTR_TYPE.ATTACK]*(100+o)/100)}}else if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.DIFU_DUP)for(var r=DataManager.getInstance().dupManager.xuezhanInfo,s=0;s<r.attrAddRates.length;s++){var h=r.attrAddRates[s];0>=h||(s>ATTR_TYPE.MAGICDEF?e[s]+=h:e[s]=Tool.toInt(e[s]*(100+h)/100))}else if(a>0){var l=DataManager.getInstance().unionManager.getCheerAttrAddRate(a);e[ATTR_TYPE.ATTACK]=Math.floor(e[ATTR_TYPE.ATTACK]*(100+l)/100)}}for(var g in this.bufferInfoDict){for(var c=this.bufferInfoDict[g],s=0;s<ATTR_TYPE.SIZE;s++){var p=c.attributes[s];p&&(e[s]+=p)}for(var s=0;s<ATTR_TYPE.SIZE;s++){var u=c.attributes[ATTR_TYPE.SIZE+s];u&&(e[s]=Tool.toInt(e[s]*(u+GameDefine.GAME_ADD_RATIO)/GameDefine.GAME_ADD_RATIO))}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e},enumerable:!0,configurable:!0}),e}();__reflect(BodyData.prototype,"BodyData");var ActionBody=function(e){function t(){var t=e.call(this)||this;return t.mapOrder=0,t.isFace5=!0,t._action=ACTION.STAND,t._direction=Direction.DOWN,t._isFlip=!1,t._atkAcitonIdx=1,t._actionPlayNum=1,t._mountOffY=0,t._jumpTime=1e3,t._jumpSpeed=400,t._jumpOffsetY=0,t.ignoreDist=!1,t.inMap=!0,t._isshowShadow=!0,t._bodyVisible=!0,t._speedpathTime=0,t._dt=40,t.walkLogicTime=0,t._childOffY=0,t._curAtkSkIdx=0,t._talkIntervalId=-1,t._isDamageFalse=!1,t._skillEffectsDict={},t.bottomLayer=new egret.DisplayObjectContainer,t.addChildAt(t.bottomLayer,0),t.bodyLayer=new egret.DisplayObjectContainer,t.addChildAt(t.bodyLayer,1),t.foreLayer=new egret.DisplayObjectContainer,t.addChildAt(t.foreLayer,2),t.topLayer=new egret.DisplayObjectContainer,t.addChildAt(t.topLayer,3),t.onInitBodyHead(),t}return __extends(t,e),t.prototype.updateY=function(){this.mapY=this.y},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=null,delete this._data,e&&(this._data=e,this.onRefreshData())},enumerable:!0,configurable:!0}),t.prototype.onRefreshData=function(){this.onResetHeadInfo(),this.onUpdateHeadPos(),this.onUpdateAvatar(),this.onCheckDeath()},t.prototype.onUpdateAvatar=function(){this.updateAction()},t.prototype.onInitBodyHead=function(){this.bodyHead=new BodyHead,this.topLayer.addChildAt(this.bodyHead,0)},t.prototype.onShowOrHideHpBar=function(e){this.bodyHead.showorhideHpPro(e)},t.prototype.onshoworhideShodow=function(e){this._isshowShadow=e},Object.defineProperty(t.prototype,"isshowShadow",{get:function(){return this._isshowShadow},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bodyVisible",{set:function(e){this._bodyVisible=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){e!=this._direction&&(this._direction=e,this.directionHandler(),this.onUpdateAvatar())},enumerable:!0,configurable:!0}),t.prototype.directionHandler=function(){var e;e=this.direction==Direction.LEFTUP||this.direction==Direction.LEFT||this.direction==Direction.LEFTDOWN?!0:!1,e!=this._isFlip&&(this._isFlip=e,this.bodyLayer.scaleX*=-1)},t.prototype.getDirectionFrame=function(){if(this.isFace5)switch(this.direction){case Direction.LEFTUP:return Direction.RIGHTUP+"";case Direction.LEFT:return Direction.RIGHT+"";case Direction.LEFTDOWN:return Direction.RIGHTDOWN+""}else switch(this._direction){case Direction.RIGHTDOWN:case Direction.RIGHT:return Direction.RIGHTDOWN+"";case Direction.RIGHTUP:case Direction.UP:return Direction.RIGHTUP+"";case Direction.LEFTUP:case Direction.LEFT:return Direction.RIGHTUP+"";case Direction.LEFTDOWN:case Direction.DOWN:return Direction.RIGHTDOWN+""}return this.direction+""},t.prototype.onChangeAction=function(e){if(this.data.isStop&&(e=ACTION.NULL),this._action==ACTION.DEATH&&this.data.isDie)return!1;if(this._action==ACTION.JUMP&&this.isPlayJump)return!1;if(e!=ACTION.NULL){if(this.data.isUseingSkill)return e==ACTION.MOVE&&this.walkOn&&this.onWalkHandler(),!1}else e=ACTION.STAND;if(this._action==ACTION.ATTACK){this._action=ACTION.NULL;for(var t=0;t<this.bodyLayer.numChildren;t++){var n=this.bodyLayer.getChildAt(t);n.onRemoveCallBack&&n.onRemoveCallBack()}this._shifaEffect&&(this._shifaEffect.onDestroy(),this._shifaEffect=null)}if(this._action!=e){switch(e){case ACTION.ATTACK:this._actionPlayNum=this.data.useSkill?this.data.useSkill.model.playnum:1;break;case ACTION.DEATH:case ACTION.JUMP:this._actionPlayNum=0;break;default:this._actionPlayNum=-1}this._action=e,this.onUpdateAvatar()}switch(e){case ACTION.STAND:this.onStandHandler();break;case ACTION.MOVE:this.onWalkHandler();break;case ACTION.ATTACK:this.onAttackHandler();break;case ACTION.JUMP:this.onJumpHandler();break;case ACTION.HURT:break;case ACTION.DEATH:}return!0},t.prototype.updateAction=function(){},Object.defineProperty(t.prototype,"actionName",{get:function(){var e="";switch(this._action){case ACTION.STAND:switch(this.mountType){case MOUNT_TYPE.RIDE_MOUNT:e="ride_stand";break;default:e="stand"}break;case ACTION.MOVE:switch(this.mountType){case MOUNT_TYPE.NO_MOUNT:e="move";break;case MOUNT_TYPE.STAND_MOUNT:e="stand";break;case MOUNT_TYPE.RIDE_MOUNT:e="ride_walk"}break;case ACTION.ATTACK:e="attack"+(this._atkAcitonIdx>0?this._atkAcitonIdx+"":"");break;case ACTION.JUMP:e="jump";break;case ACTION.DEATH:e=this.data.bodyType==BODY_TYPE.BOSS||this.data.bodyType==BODY_TYPE.MONSTER?"stand":"";break;case ACTION.HURT:e=""}return e},enumerable:!0,configurable:!0}),t.prototype.onUpdateHeadPos=function(){this.bodyHead.x=-75,this.bodyHead.y=-this.data.model.high-30},t.prototype.addLayerOrder=function(e,t){var n;Tool.isNumber(t)?n=t:egret.is(t,"egret.DisplayObject")&&this.bodyLayer.getChildIndex(t)>=0&&(n=this.bodyLayer.getChildIndex(t)+1);var a=this.bodyLayer.getChildIndex(e);0>a?Tool.isNumber(n)?this.bodyLayer.addChildAt(e,n):this.bodyLayer.addChild(e):Tool.isNumber(n)&&n!=a&&this.bodyLayer.setChildIndex(e,n)},t.prototype.removeSelfBody=function(e){this.bodyLayer.getChildIndex(e)>=0&&this.bodyLayer.removeChild(e)},t.prototype.checkFace=function(e,t){return Tool.checkFace8(this.x,this.y,e,t)},t.prototype.onActionReset=function(){this._action!=ACTION.STAND&&this.onChangeAction(ACTION.NULL)},t.prototype.onStand=function(){this.onChangeAction(ACTION.STAND)},t.prototype.onStandHandler=function(){e.prototype.stopMove.call(this),this.walkOn=!1,this._speedpathTime>0&&(this._speedpathTime=0,this._speedTeapCount=0)},t.prototype.stopMove=function(){this.isPlayJump?this.onInitJump():this.onStand()},Object.defineProperty(t.prototype,"isMoving",{get:function(){return this.isMove()||this.isPlayJump?!0:!1},enumerable:!0,configurable:!0}),t.prototype.setMove=function(e){this.setMovePoint(e)},t.prototype.setWalkOn=function(e){e&&(this.walkOn=!0,this.setMove(e))},t.prototype.setWalkWithSpeed=function(e,t){this._speedpathTime=t,this.setWalkOn(e),this._speedTeapCount=Math.floor(t/this._dt),this._changeSpeed=Math.ceil(2*this.getDistToTarget()/((this._speedTeapCount+1)*this._speedTeapCount))},t.prototype.onMove=function(){this.isPlayJump?this.onJumpHandler():this._moveTarget&&this.onChangeAction(ACTION.MOVE)},t.prototype.onWalkHandler=function(){var t=this._dt;if(!(egret.getTimer()-this.walkLogicTime<20)){var n=this.moveSpeed;this._speedTeapCount>0&&(t=1e3,this.moveSpeed=this._speedTeapCount*this._changeSpeed,this._speedTeapCount>0?this._speedTeapCount--:(this._speedpathTime=0,this._speedTeapCount=0)),this.walkLogicTime=egret.getTimer(),e.prototype.logicMove.call(this,t),n!=this.moveSpeed&&(this.moveSpeed=n)}},t.prototype.onChangeDir=function(){this._moveTarget&&0==this._speedpathTime&&(this.direction=this.checkFace(this._moveTarget.x,this._moveTarget.y))},t.prototype.onJump=function(e,t){void 0===t&&(t=!1),this.onChangeAction(ACTION.JUMP)},t.prototype.onInitJump=function(){},t.prototype.onJumpHandler=function(){},t.prototype.onFinishJump=function(){this.childOffY=0,this._jumpPoints=null},Object.defineProperty(t.prototype,"isPlayJump",{get:function(){return this._jumpPoints&&this._jumpPoints.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childOffY",{get:function(){return this._childOffY},set:function(e){this._childOffY=e;for(var t=0;t<this.numChildren;t++){var n=this.getChildAt(t);n.y=e}},enumerable:!0,configurable:!0}),t.prototype.onAttack=function(){var e=this.data.useSkill;if(e&&this.hurtBody){var t=Tool.toInt(this._curAtkSkIdx/SkillDefine.MAX_ATKCOUNT),n=e.id*SkillDefine.MAX_ATKCOUNT,a=t==e.id?Math.max(0,this._curAtkSkIdx-n+1):0;a=a>=SkillDefine.MAX_ATKCOUNT?0:a,e.model.actionIndex>0?this._atkAcitonIdx=e.model.actionIndex:e.id==SkillDefine.COMMON_SKILL_ID?t==SkillDefine.COMMON_SKILL_ID?this._atkAcitonIdx=this._atkAcitonIdx%SkillDefine.Attack_Action_Max+1:this._atkAcitonIdx=1:this.data.bodyType==BODY_TYPE.BOSS?this._atkAcitonIdx=0:this._atkAcitonIdx=Math.ceil(Math.random()*SkillDefine.Attack_Action_Max),this._curAtkSkIdx=n+a,this.onChangeAction(ACTION.ATTACK)}},t.prototype.onAddEnemyBodyList=function(e){for(var t in e){var n=e[t];this.data.targets.indexOf(n)<0&&this.data.targets.push(n)}},t.prototype.onClearTargets=function(){for(var e in this.data.targets)this.onRemoveTarget(this.data.targets[e]);this.hurtBody&&(this.hurtBody=null)},t.prototype.onRemoveTarget=function(e){this.hurtBody&&this.hurtBody===e&&(this.hurtBody=null,this.setMove(null),this.isChagre&&this.overChagre()),Tool.removeArrayObj(this.data.targets,e)},Object.defineProperty(t.prototype,"currTarget",{get:function(){return this.hurtBody},set:function(e){this.data.targets.indexOf(e)<0||(this.hurtBody=e)},enumerable:!0,configurable:!0}),t.prototype.onAttackPlayEnd=function(e){this._action==ACTION.ATTACK&&this.onActionReset()},t.prototype.onAttackHandler=function(){this._body.playFinishCallBack(this.onAttackPlayEnd,this,this._curAtkSkIdx);var e=this.data.useSkill;if(e&&this.currTarget&&!this.data.isDie){if(this.data.onReleaseSkill(),this.isChagre&&this.overChagre(),this.direction=this.checkFace(this.hurtBody.x,this.hurtBody.y),e.attackCount=1,!this.inMap||GameFight.getInstance().onCheckPosInMapView(this.x,this.y))if(e.model.effect1&&this.onAddDelayFunc(this.playShifaSkillEft,this,e.model.delay1,e),e.effectClass){var t=SkillEffectManager.getInstance().createSkillEffect(e,this,this.hurtBody);if(t){switch(e.effectClass){case"CommonSkillEffect":t.param.param1="skill_effect"+(e.styleNum+1)+"_"+this._atkAcitonIdx+"_"+this.getDirectionFrame();break;case"FeijianSkillEffect":case"ShenbingSkillEffect":t.param.param1=this.getDirectionFrame()}this.onAddDelayFunc(this.playSpecialSkillEft,this,e.model.delay2,t),e.attackCount=t.attackCount}}else if(e.model.effect2){var n=new SkillParam;n.eftRes=e.model.effect2,n.dirType=e.model.isDir,n.target=this.parent,n.x=this.hurtBody.x,n.y=this.hurtBody.y,n.isBottom="BOTTOM"==e.model.bodyLayer,this.onAddDelayFunc(this.onCreateEffect,this,e.model.delay2,n),e.attackCount=e.model.duoduan}this.onRemoveSkillFontAnim(),e.model.fonteffect&&(this._skillFontEft=new Animation(e.model.fonteffect,1,!1),this._skillFontEft.x=this.x,this._skillFontEft.y=this.y-this.data.model.high+this._mountOffY-80,GameFight.getInstance().addDropBodyToLayer(this._skillFontEft),egret.Tween.get(this._skillFontEft).wait(1e3).to({alpha:0},500),this.onAddDelayFunc(this.onRemoveSkillFontAnim,this,e.model.castTime)),0!=e.model.targetType?this.onAddDelayFunc(this.addBuffer,this,e.model.castTime,e):this.onHurtHandler(e),this.data.bodyType==BODY_TYPE.SELF&&1==e.model.zhenping&&Tool.callbackTime(this.onEarthQuake,this,e.model.hurtdelay)}},t.prototype.onRemoveSkillFontAnim=function(){this._skillFontEft&&(egret.Tween.removeTweens(this._skillFontEft),this._skillFontEft.onDestroy(),this._skillFontEft=null)},t.prototype.onEarthQuake=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_EARTHQUAKE_STRAT))},t.prototype.playShifaSkillEft=function(e){this._shifaEffect&&(this._shifaEffect.onDestroy(),this._shifaEffect=null);var t;switch(e.model.isDir){case SKILL_DIR_TYPE.FRAME:t=e.model.effect1+"_"+this.getDirectionFrame();break;default:t=e.model.effect1}var n=new SkillParam;n.eftRes=t,n.dirType=e.model.isDir,n.playNum=this._actionPlayNum,n.scale=e.model.fangda/100,n.layer=e.model.bodyLayer,this._shifaEffect=this.onCreateEffect(n)},t.prototype.playSpecialSkillEft=function(e){e.play()},t.prototype.addSkillEffectByID=function(e,t){this._skillEffectsDict[e]||(this._skillEffectsDict[e]=t)},t.prototype.getSkillEffectByID=function(e){return this._skillEffectsDict[e]},t.prototype.onCreateEffect=function(e){if(!RES.hasRes(e.eftRes+"_json"))return void Tool.log("没有技能特效资源：：：："+e.eftRes);var t=0,n=null,a=e.layer;if(e.dirType==SKILL_DIR_TYPE.FRAME)n=this.direction;else if(e.dirType==SKILL_DIR_TYPE.ANGLE){var i=parseInt(String(this.direction))-1;t=-45*i}else e.dirType==SKILL_DIR_TYPE.RADOM_ANGLE&&(t=Math.floor(360*Math.random()));var o=new EffectBody(e.eftRes,n,e.playNum);return o.x=e.x,o.y=e.y,o.rotation=t,o.isUnder=e.isBottom,o.scaleX=o.scaleY=e.scale,o.addEventListener(Action_Event.BODY_EFFECT_DESTROY,this.effectDisposeHanlder,this),this.addEffectToSprite(o,e.target?e.target:this,a),o},t.prototype.effectDisposeHanlder=function(e){var t=e.currentTarget;t.removeEventListener(Action_Event.BODY_EFFECT_DESTROY,this.effectDisposeHanlder,this),this._hurtEffBody===t&&(this._hurtEffBody=null),t=null},t.prototype.addEffectToSprite=function(e,t,n){if(this.parent&&t&&t===this.parent){var a=-1;switch(n){case"BOTTOM":a=this.parent.getChildIndex(this)}this.inMap?GameFight.getInstance().addBodyToMapLayer(e,a):0>a?this.parent.addChild(e):this.parent.addChildAt(e,a)}else this.addEffectToSelf(n,e)},t.prototype.addBuffer=function(e){var t=(e.model.delay1,e.model.buffId),n=JsonModelManager.instance.getModelbuff()[t];n&&(this.data.addBuffer(t,e.level),n.effect&&this.onAddDelayFunc(this.delayAddBuffEff,this,e.model.hurtdelay,n))},t.prototype.delayAddBuffEff=function(e){if(this.effectBuffers||(this.effectBuffers={}),!this.effectBuffers[e.id]){var t=new EffectBody(e.effect,null,-1);t.x=0,t.y=this._body.y,this.addEffectToSprite(t,this,"TOP"),this.effectBuffers[e.id]=t}},t.prototype.removeBuffer=function(e){if(this.effectBuffers&&this.effectBuffers[e]){var t=this.effectBuffers[e];t.onDestroy(),t=null,delete this.effectBuffers[e]}this.data.removeBuffer(e)},t.prototype.checkBuffer=function(){for(var e in this.data.bufferInfoDict){var t=this.data.bufferInfoDict[e];t.isOver&&this.removeBuffer(e)}},t.prototype.clearAllBuffer=function(){for(var e in this.data.bufferInfoDict){this.data.bufferInfoDict[e];this.removeBuffer(e)}},t.prototype.onAddDelayFunc=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];if(this.attackDelayAry||(this.attackDelayAry={}),n>0){var o={intervalId:0,callback:e,target:t,args:a};o.intervalId=Tool.callbackTime(this.onDeleteDelayFunc,this,n,o),this.attackDelayAry[o.intervalId]=o}else Tool.callback.apply(Tool,[e,t].concat(a))},t.prototype.onDeleteDelayFunc=function(e){if(e&&this.attackDelayAry){var t=e.intervalId;this.attackDelayAry[t]&&(Tool.callback.apply(Tool,[e.callback,e.target].concat(e.args)),e=null,delete this.attackDelayAry[t])}},t.prototype.onRemoveAllDalay=function(){if(this.attackDelayAry)for(var e in this.attackDelayAry){var t=this.attackDelayAry[e].intervalId;egret.clearTimeout(t),this.attackDelayAry[e]=null,delete this.attackDelayAry[e]}},t.prototype.onHurtHandler=function(e){var t=this.currTarget;if(t&&0==e.model.buffId){var n=[];if(t.data.isDie||n.push(t),e.model.rectType>0)for(var a,i=0;i<this.data.targets.length;i++)if(a=this.data.targets[i],!t.data.isDie&&a!==t)if(this.ignoreDist)n.push(a);else{var o=0;o=0==e.model.attackType?this.distanceToSelf(a):t.distanceToSelf(a),e.model.rectType>=o&&n.push(a)}for(var r=n.length-1;r>=0;r--){var s=n[r],h="herohpDown_fnt";switch(this.data.bodyType){case BODY_TYPE.SELF:h="hero_damage_fnt1_fnt";break;case BODY_TYPE.RETINUE:case BODY_TYPE.PET:h="hero_damage_fnt2_fnt"}var l=this.calculateDamage(s,e);if(l.attacker=this,l.scenetype=GameFight.getInstance().fightsceneTpye,l.judge!=FightDefine.JUDGE_DODGE&&0!=l.value)for(var g=void 0,c=void 0,p=e.attackCount,u=4*p,d=1;p>=d;d++){var _=new DamageData;if(_.attacker=this,_.scenetype=GameFight.getInstance().fightsceneTpye,_.isDmgFalse=this.isDamageFalse,_.skill=e,_.damageFnt=h,_.value=d==p?l.value-(d-1)*Math.floor(l.value/u):Math.floor(l.value/u),_.pojia=d==p?l.pojia-(d-1)*Math.floor(l.pojia/u):Math.floor(l.pojia/u),_.fromDire=this.checkFace(s.x,s.y),_.floatingRD=1==d?l.floatingRD:100,_.judge=1==d?l.judge:FightDefine.JUDGE_DUODUAN,l.value=l.value-_.value,g=Math.max(0,e.model.castTime-e.model.hurtdelay),c=e.model.hurtdelay+Math.floor(g/p)*(d-1),this.onAddDelayFunc(s.onHurt,s,c,_),!_.isDmgFalse&&this.data.currentHp-_.value<=0)break}else l.isDmgFalse=this.isDamageFalse,l.skill=e,l.damageFnt=h,l.fromDire=this.checkFace(s.x,s.y),s.onHurt(l)}n=null}},t.prototype.calculateDamage=function(e,t){var n=new DamageData,a=GameDefine.GAME_ADD_RATIO,i=Math.max(0,e.data.currentAttributes[ATTR_TYPE.DODGE]-this.data.currentAttributes[ATTR_TYPE.HIT])/a,o=Math.max(0,this.data.currentAttributes[ATTR_TYPE.CRIT]-e.data.currentAttributes[ATTR_TYPE.DUCT])/a,r=Math.max(0,e.data.currentAttributes[ATTR_TYPE.BLOCK]-this.data.currentAttributes[ATTR_TYPE.BREAK])/a;i=Math.min(i*a,5e3),o=Math.min(o*a,5e3),r=Math.min(r*a,7e3),a=this.data.randomValue;var s=0;s=e.data.bodyType==BODY_TYPE.BOSS&&GameFight.getInstance().unableArtifactBoss?0:this.data.mabiRatio;var h=this.data.chenmoRatio;if(n.judge=FightDefine.getFightJudge(a,s,h,i,o,r),n.judge==FightDefine.JUDGE_CHENMO&&(e.data.bodyType==BODY_TYPE.PLAYER||e.data.bodyType==BODY_TYPE.ROBOT||e.data.bodyType==BODY_TYPE.SELF||(n.judge=-1)),n.judge!=FightDefine.JUDGE_DODGE){var l=FightDefine.BASE_RATIO;FightDefine.JUDGE_CRIT==n.judge?l=FightDefine.CRIT_RATIO:FightDefine.JUDGE_BLOCK==n.judge?l=FightDefine.BLOCK_RATIO:FightDefine.JUDGE_MABI==n.judge?e.data.onHitMaBi(this.data.mabiEffect):FightDefine.JUDGE_CHENMO==n.judge&&e.data.onHitChenMo(this.data.chenmoEffect);var g=t.model.hurtType==SKILL_HURT_TYPE.PHY_HURT?e.data.currentAttributes[ATTR_TYPE.PHYDEF]:e.data.currentAttributes[ATTR_TYPE.MAGICDEF];n.value=Tool.toInt(this.data.currentAttributes[ATTR_TYPE.ATTACK]-g),n.value=n.value>Tool.toInt(this.data.currentAttributes[ATTR_TYPE.ATTACK]*FightDefine.ATTACK_RATIO)?n.value:Tool.toInt(this.data.currentAttributes[ATTR_TYPE.ATTACK]*FightDefine.ATTACK_RATIO),n.value=Tool.toInt(n.value*t.getBaseDamage()+t.getExtraDamage()),n.value=Tool.toInt(n.value*l),a>=0&&(n.floatingRD=105-Tool.toInt(a/1e3),n.value=Tool.toInt(n.value*(n.floatingRD/100)));var c=Tool.toInt(n.value*this.data.pojiaEffect/GameDefine.GAME_ADD_RATIO);n.value=n.value+c,n.pojia=c,GameFight.getInstance().isPVPFightScene&&egret.is(this,"PlayerBody")&&egret.is(e,"PlayerBody")&&(n.value=Tool.toInt(n.value/FightDefine.PVPFIGHT_DAMAGE_RATE))}return n},t.prototype.onHurt=function(e){if(!this.data.isDie&&e.scenetype==GameFight.getInstance().fightsceneTpye){switch(e.judge){case FightDefine.JUDGE_MABI:this._mabiAnim||(this._mabiAnim=new EffectBody("mabiEffect",null,-1),this._mabiAnim.y=-(this.data.model.high/2)+this._mountOffY,this.addEffectToSprite(this._mabiAnim,this,"TOP")),this.allBodyStop();break;case FightDefine.JUDGE_CHENMO:this._chenmoAnim||(this._chenmoAnim=new EffectBody("chenmoEffect",null,-1),this._chenmoAnim.y=-(this.data.model.high/2)+this._mountOffY,this.addEffectToSprite(this._chenmoAnim,this,"TOP"));break;default:this.playHurtAnim(e.skill)}if(!e.isDmgFalse){var t=this.data.deathCount>0;if(t)e.judge!=FightDefine.JUDGE_DUODUAN&&(this.hp=this.data.currentHp-1);else{var n=this.data.shieldValue,a=Math.max(0,e.value-this.data.shieldValue);this.data.shieldValue=Math.max(0,this.data.shieldValue-e.value),this.hp=this.data.currentHp-a,e.xishou=Math.max(0,n-this.data.shieldValue)}this.addFlyFont(e)}GameFight.getInstance().fightScene.onBodyHurtHanlder(e.attacker,this,e),this.onCheckDeath()}},t.prototype.playHurtAnim=function(e){if(GameFight.getInstance().onCheckPosInMapView(this.x,this.y)&&e&&e.model&&e.model.hurteffect){var t=0,n=0;e.model.hurtpos==HURT_POS_TYPE.CENTER?n+=-(this.data.model.high/2):e.model.hurtpos==HURT_POS_TYPE.CENTER_WITH_DIR&&(n+=-(this.data.model.high/2)),this._hurtEffBody&&(this._hurtEffBody.visible=!1,this._hurtEffBody.onDestroy(),this._hurtEffBody=null);var a=new SkillParam;a.eftRes=e.model.hurteffect,a.dirType=SKILL_DIR_TYPE.RADOM_ANGLE,a.x=t,a.y=n,this._hurtEffBody=this.onCreateEffect(a)}},t.prototype.allBodyStop=function(){this._body&&this._body.onStop()},t.prototype.removeMaBiAnim=function(){this._mabiAnim&&(this._mabiAnim.onDestroy(),this._mabiAnim=null)},t.prototype.removeChenMoAnim=function(){this._chenmoAnim&&(this._chenmoAnim.onDestroy(),this._chenmoAnim=null)},t.prototype.addFlyFont=function(e){e.judge==FightDefine.JUDGE_MABI?(e.value=0,PromptPanel.getInstance().onCreateDamageFont(e,this),e.judge=-1):e.judge==FightDefine.JUDGE_CHENMO&&(e.value=0,PromptPanel.getInstance().onCreateDamageFont(e,this),e.judge=-1),e.xishou>0?(e.value=e.value-e.xishou,e.judge=FightDefine.JUDGE_XISHOU,PromptPanel.getInstance().onCreateDamageFont(e,this)):e.pojia>0&&(e.value=e.value-e.pojia,Tool.callbackTime(function(e){e.judge=FightDefine.JUDGE_POJIA,PromptPanel.getInstance().onCreateDamageFont(e,this)},this,100,e)),(e.value>0||e.judge==FightDefine.JUDGE_DODGE)&&PromptPanel.getInstance().onCreateDamageFont(e,this)},t.prototype.onCheckDeath=function(){return this.data.isDie&&(this.data.reborncount>0&&(this.data.onRebornEffect(),this.onPlayRebornAnim()),this.data.isDie)?(this.onDeath(),!0):!1},t.prototype.onDeath=function(){this._action!=ACTION.DEATH&&(this.setMove(null),this.onChangeAction(ACTION.DEATH)),this.dispatchEvent(new egret.Event(Action_Event.BODY_DEATH_FINISH))},t.prototype.onPlayRebornAnim=function(){var e=new SkillParam;e.eftRes="qihunshengji",e.dirType=SKILL_DIR_TYPE.NULL,e.x=0,e.y=-(this.data.model.high/2);var t=new DamageData;t.judge=FightDefine.JUDGE_FUHUO,PromptPanel.getInstance().onCreateDamageFont(t,this)},t.prototype.onRide=function(e){},Object.defineProperty(t.prototype,"mountOffY",{get:function(){return this._mountOffY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mountType",{get:function(){return MOUNT_TYPE.NO_MOUNT},enumerable:!0,configurable:!0}),t.prototype.onResetHeadInfo=function(){this.bodyHead.bodyName=this.data.bodyType==BODY_TYPE.SELF?"":this.data.name,this.updateHP(this.data.currentHp,this.data.maxHp)},t.prototype.onHideHeadBar=function(e){this.bodyHead.visible=e},Object.defineProperty(t.prototype,"hp",{set:function(e){this.data.onRestHpInfo(e),this.updateHP(e)},enumerable:!0,configurable:!0}),t.prototype.setDeathCount=function(e,t){void 0===t&&(t=0),t=Math.max(t,e),this.data.deathCount=t,this.updateHP(e,t)},t.prototype.updateHP=function(e,t){void 0===t&&(t=0),this.data.onRestHpInfo(e,t),this.bodyHead.maximum=this.data.maxHp,this.bodyHead.value=this.data.currentHp},t.prototype.addEffectToSelf=function(e,t){switch(e){case"TOP":this.foreLayer.addChild(t);break;case"BOTTOM":this.bottomLayer.addChild(t);break;case"HEAD":this.bodyHead.addAnimToHead(t)}},t.prototype.bodySpeak=function(e){this._bodytalkUI||(this._bodytalkUI=new eui.Component,this._bodytalkUI.skinName=skins.ChatBodySkin,this.bodyHead.addChild(this._bodytalkUI),this._bodytalkUI.bottom=26);var t="right";this._bodytalkUI.x=0,(this.direction==Direction.LEFT||this.direction==Direction.LEFTDOWN||this.direction==Direction.LEFTUP)&&(t="left"),this._bodytalkUI.currentState=t,this._bodytalkUI.talk_label.textFlow=(new egret.HtmlTextParser).parse(e),this._talkIntervalId>=0&&egret.clearTimeout(this._talkIntervalId),this._talkIntervalId=Tool.callbackTime(this.onRemoveSpeak,this,GameDefine.BodyChat_ShowTime)},t.prototype.onRemoveSpeak=function(){this._talkIntervalId=-1,this._bodytalkUI&&(this._bodytalkUI.removeChildren(),this._bodytalkUI.parent&&this._bodytalkUI.parent.removeChild(this._bodytalkUI),this._bodytalkUI=null)},t.prototype.playChagre=function(e,t){void 0===t&&(t=!1)},t.prototype.overChagre=function(){},Object.defineProperty(t.prototype,"isChagre",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDamageFalse",{get:function(){return this._isDamageFalse
},set:function(e){this._isDamageFalse=e},enumerable:!0,configurable:!0}),t.prototype.onSetCover=function(e){e!=this._isCover&&(this._isCover=e,this.alpha=this._isCover?GameDefine.Cover_Alpha_Value:1)},t.prototype.onDestroy=function(){this.data.onRestHpInfo(0),this._body&&(this._body.onDestroy(),this._body=null),this.onDestoryCacheSkillEft()},t.prototype.onDestoryCacheSkillEft=function(){for(var e in this._skillEffectsDict){var t=this._skillEffectsDict[e];t.onDestory(),t=null,delete this._skillEffectsDict[e]}this._skillEffectsDict={}},t.prototype.onResetSkillEffect=function(){this._atkAcitonIdx=0,this.onDestoryCacheSkillEft()},t.prototype.onReset=function(){e.prototype.onReset.call(this),this.isPlayJump&&this.onFinishJump(),this.clearAllBuffer(),this.onRemoveSpeak(),this.onActionReset(),this.onRemoveAllDalay(),this.foreLayer.removeChildren(),this.bottomLayer.removeChildren(),this.data.isStop=null,this.data.hasArtifactEft=null,this.isDamageFalse=!1,this.ignoreDist=!1,this._hurtEffBody=null,1!=this.alpha&&(this.alpha=1),this.visible||(this.visible=!0),this.removeMaBiAnim(),this.removeChenMoAnim(),this.onRemoveSkillFontAnim()},t}(BaseBody);__reflect(ActionBody.prototype,"ActionBody",["IMapOrder"]);var BodyHead=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.BodyHead,t}return __extends(t,e),Object.defineProperty(t.prototype,"bodyName",{set:function(e){this.nameLabel.text!=e&&(this.nameLabel.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bodyGrade",{set:function(e){this.grade_lab.text!=e&&(this.grade_lab.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nameColor",{set:function(e){this.nameLabel.textColor!=e&&(this.nameLabel.textColor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{set:function(e){e=Math.max(0,e),this.hpBar.maximum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{set:function(e){0>e||(this.hpBar.value=e)},enumerable:!0,configurable:!0}),t.prototype.showorhideHpPro=function(e){this.hpBar.visible=e},t.prototype.hpProBarSkinName=function(e){this.hpBar.skinName=e},t.prototype.addAnimToHead=function(e){this.onRefreshLayout(),this.anim_group.addChild(e)},t.prototype.onRefreshLayout=function(){for(var e=0,t=0;t<this.title_group.numChildren;t++)e+=this.title_group.getChildAt(t).height/2;this.anim_group.y=-e},t.prototype.addTitleToHead=function(e){this.title_group.addChild(e),this.onRefreshLayout()},t}(eui.Component);__reflect(BodyHead.prototype,"BodyHead");var Direction;!function(e){e[e.DOWN=1]="DOWN",e[e.RIGHTDOWN=2]="RIGHTDOWN",e[e.RIGHT=3]="RIGHT",e[e.RIGHTUP=4]="RIGHTUP",e[e.UP=5]="UP",e[e.LEFTUP=6]="LEFTUP",e[e.LEFT=7]="LEFT",e[e.LEFTDOWN=8]="LEFTDOWN"}(Direction||(Direction={}));var ACTION;!function(e){e[e.NULL=0]="NULL",e[e.STAND=1]="STAND",e[e.MOVE=2]="MOVE",e[e.ATTACK=3]="ATTACK",e[e.DEATH=4]="DEATH",e[e.JUMP=5]="JUMP",e[e.HURT=6]="HURT"}(ACTION||(ACTION={}));var MOUNT_TYPE;!function(e){e[e.NO_MOUNT=0]="NO_MOUNT",e[e.RIDE_MOUNT=1]="RIDE_MOUNT",e[e.STAND_MOUNT=2]="STAND_MOUNT"}(MOUNT_TYPE||(MOUNT_TYPE={}));var Action_Event={BODY_EFFECT_DESTROY:"game_effect_destroy",BODY_DEATH_FINISH:"game_body_death_finish"},HURT_POS_TYPE;!function(e){e[e.BOTTOM=0]="BOTTOM",e[e.CENTER=1]="CENTER",e[e.CENTER_WITH_DIR=2]="CENTER_WITH_DIR"}(HURT_POS_TYPE||(HURT_POS_TYPE={}));var SKILL_DIR_TYPE;!function(e){e[e.NULL=0]="NULL",e[e.FRAME=1]="FRAME",e[e.ANGLE=2]="ANGLE",e[e.RADOM_ANGLE=3]="RADOM_ANGLE"}(SKILL_DIR_TYPE||(SKILL_DIR_TYPE={}));var WXBoxPlatform=function(){function e(){}return e.prototype.getOption=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,null]})})},e.prototype.loadImage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,null]})})},e.prototype.onShare=function(e){},e.prototype.onShareAppMessage=function(e){},e.prototype.previewImage=function(e){},e.prototype.navigateToMiniProgram=function(e){},e.prototype.showAlert=function(e){},e.prototype.getSystemInfoSync=function(){},e.prototype.setClipboardData=function(e){},e.prototype.onListenerShow=function(e){},e.prototype.onListenerHide=function(e){},e.prototype.getShareGroupID=function(e){},e.prototype.openCustomerServiceConversation=function(e){},e.prototype.getEnvVersio=function(){return"undefined"},e.prototype.isLocalTest=function(){return!1},e.prototype.triggerGC=function(){},e.prototype.exit=function(){},e}();__reflect(WXBoxPlatform.prototype,"WXBoxPlatform",["Platform"]),window.platform||(window.platform=new WXBoxPlatform);var BaseListItem=function(e){function t(){var t=e.call(this)||this;return t.isLoaded=!1,t.initializeSize(),t.once(eui.UIEvent.COMPLETE,t.onLoadComplete,t),t}return __extends(t,e),t.prototype.initializeSize=function(){},t.prototype.onInit=function(){},t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.onInit(),this.data&&this.dataChanged()},t.prototype.dataChanged=function(){this.isLoaded&&this.onUpdate()},t.prototype.onUpdate=function(){},t}(eui.ItemRenderer);__reflect(BaseListItem.prototype,"BaseListItem",["eui.UIComponent","egret.DisplayObject"]);var BaseSystemPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=0,n.tabs={},n.tabFs={},n.allwindows={},n.alerts={},n.isShowAlert=!1,n.lockIDs={},n.isActivity=!1,n}return __extends(t,e),t.prototype.onInit=function(){this.onInitRegistPage(),e.prototype.onInit.call(this)},t.prototype.onInitRegistPage=function(){this._initRegistPage=!0},t.prototype.onRegist=function(){this._initRegistPage||this.onInitRegistPage(),e.prototype.onRegist.call(this);for(var t in this.tabFs)this.tabFs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.onLevelChange,this),this.refreshFunOpen()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t in this.tabFs)this.tabFs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);GameDispatcher.getInstance().removeEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.onLevelChange,this),this.index=0,this._initRegistPage=!1},t.prototype.registerPage=function(e,t,n,a){if(void 0===n&&(n=GameDefine.RED_TAB_POS),void 0===a&&(a=!1),e){this.tabBtnsBar=this.basic.tabBtnsBar,this.sysInfos=e;var i,o=this.sysInfos.length;egret.is(this.basic.btnTabLayer,"eui.Group")?this.basic.btnTabLayer.numChildren>0&&this.basic.btnTabLayer.removeChildren():egret.is(this.basic.btnTabLayer,"ScrollerTabBtnsBar")&&this.basic.btnTabLayer.removeChildrenAll();for(var r in this.tabFs)this.tabFs[r].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.lockIDs={},this.tabFs={},this.allwindows={},a&&(this.index=0);for(var s=0;o>s;s++){if(SDKManager.isHidePay){var h=Constant.get(Constant.FANGKUAIWAN_IOS_HIDE_PANEL);if(h.indexOf(this.sysInfos[s].sysName)>=0)continue}var l=new eui.Group;l.touchEnabled=!0,l.name=s.toString(),i=this.getTabButtonSkin(this.sysInfos[s].btnRes),i.value=s,i.groupName=t,i.touchEnabled=!1,this.tabs[s]=i,this.tabFs[s]=l,this.sysInfos[s].redP&&this.sysInfos[s].redP.addRedPointImg(i,n),this.lockIDs[s]=this.sysInfos[s].funcID,l.addChild(i),this.basic.btnTabLayer.addChild(l)}for(var r in this.tabFs)this.tabFs[r].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);if(this.tabBtnsBar){for(var s=0;s<this.sysInfos.length;s++)this.sysInfos[s].initRedChild();this.tabBtnsBar.setListenerBack(this.onCallTabBtns,this)}}},t.prototype.getTabButtonSkin=function(e){var t,n=e;return this.sysInfos[this.sysInfos.length-1].btnRes==e&&5==this.sysInfos.length?(t=new BaseTabButton2(e,n),t.width=103):(t=new BaseTabButton(e,n),t.width=103),t},t.prototype.onTouchTab=function(e){var t=parseInt(e.target.name);this.lockIDs[t]>0&&FunDefine.onIsLockandErrorHint(this.lockIDs[t])||this.index!=t&&(this.index=t,this.onRefresh())},t.prototype.setPageTab=function(e,t){if(void 0===t&&(t=-1),e<this.sysInfos.length){if(FunDefine.onIsLockandErrorHint(this.lockIDs[e]))return;if(t>=0){var n=this.sysInfos[e];if(n.tabBtns&&t<n.tabBtns.length){if(FunDefine.onIsLockandErrorHint(n.tabBtns[t].funcID))return;n.index=t}}this.index=e,this.onRefresh()}},t.prototype.onTouchCloseBtn=function(){this.isShowAlert?this.onShowPanel():(this.currPanel&&this.currPanel.onHide(),this.onHide())},t.prototype.onRefresh=function(){this.onShowPanel(),this.trigger()},t.prototype.onShowWithParam=function(e){e&&(this.showParam=e),this.onShow()},t.prototype.onRefreshTabIndex=function(){if(this.showParam){for(var e,t=0;t<this.sysInfos.length;t++){var n=this.sysInfos[t];if(n.tabBtns)for(var a=0;a<n.tabBtns.length;a++){var i=n.tabBtns[a];if(i.funcID==this.showParam||i.subFuncIDs&&i.subFuncIDs.indexOf(this.showParam)>=0){this.index=t,n.index=i.getIdx(),e=!0;break}}if(e)break;if(n.funcID==this.showParam||n.subFuncIDs&&n.subFuncIDs.indexOf(this.showParam)>=0){this.index=t,e=!0;break}}this.showParam=null}},t.prototype.getRegisterSystemParam=function(){return this.sysInfos[this.index]},t.prototype.getWindowName=function(){var e=this.getRegisterSystemParam();return this.refreshTabBtns(e),e.tabBtns?(this.tabBtnsBar||Tool.throwException("BaseSystemPanel - getWindowName - error: "+e.tabBtns[e.index].sysName),e.tabBtns[e.index].sysName):e.sysName},t.prototype.onShowPanel=function(){if(this.onRefreshTabIndex(),this.currPanel){if(!this.currPanel.isOnloadComp())return;this.currPanel.onHide(),this.isShowAlert=!1}var e=this.getWindowName();e&&(Tool.logClassName(e),this.currPanel=this.allwindows[e],this.currPanel?(this.basic.tabLayer.addChild(this.currPanel),this.currPanel.onShow()):(this.currPanel=new window[e](this),this.allwindows[e]=this.currPanel,this.basic.tabLayer.addChild(this.currPanel)),this.tabs[this.index]&&(this.tabs[this.index].selected=!0))},t.prototype.setTabsJianTou=function(e){this.tabBtnsBar&&(this.tabBtnsBar.setPreImgVisible(e),this.tabBtnsBar.setNextImgVisible(e))},t.prototype.setTabsPage=function(e){this.tabBtnsBar&&this.tabBtnsBar.setTagIndex(e)},t.prototype.onCallTabBtns=function(e){e.funcID>0&&FunDefine.onIsLockandErrorHint(e.funcID)||(this.getRegisterSystemParam().index=e.getIdx(),this.onRefresh())},t.prototype.refreshTabBtns=function(e){if(this.tabBtnsBar){if(this.tabBtnsBar.removeChildrenAll(),e.tabBtns){for(var t=e.tabBtns[e.index],n=0;n<e.tabBtns.length;n++){var a=this.tabBtnsBar.addTabButton(e.tabBtns[n],this.isActivity);e.tabBtns[n].redP&&e.tabBtns[n].redP.addRedPointImg(a,GameDefine.RED_TAB_BTN_POS)}this.tabBtnsBar.setTagIndex(e.index),this.setTitle(t.title),this.tabBtnsBar.visible=!0}else this.tabBtnsBar.visible=!1;this.basic.tabbar_bg_grp&&(this.basic.tabbar_bg_grp.visible=this.tabBtnsBar.visible)}},t.prototype.onShowAlertByName=function(e){this.currPanel&&this.currPanel.onHide(),this.currPanel=this.alerts[e],this.currPanel?(this.basic.tabLayer.addChild(this.currPanel),this.currPanel.onShow()):(this.currPanel=new window[e](this),this.alerts[e]=this.currPanel,this.basic.tabLayer.addChild(this.currPanel)),this.isShowAlert=!0},t.prototype.refreshFunOpen=function(){},t.prototype.onLevelChange=function(e){e.data&&this.refreshFunOpen()},t.prototype.addTabChild=function(e){this.currPanel&&this.currPanel.onHide(),this.currPanel=this.allwindows[e],this.currPanel||(this.currPanel=new window[e](this.owner),this.allwindows[e]=this.currPanel),this.basic.tabLayer.addChild(this.currPanel),this.currPanel.onShow(),this.index=-1},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.currPanel&&this.currPanel.trigger()},Object.defineProperty(t.prototype,"tab",{get:function(){return this.index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subTab",{get:function(){var e=this.getRegisterSystemParam();return e?e.index:-1},enumerable:!0,configurable:!0}),t.prototype.getTabBtnGrp=function(e){return this.tabFs[e]},Object.defineProperty(t.prototype,"currTabPanel",{get:function(){return this.currPanel},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(BaseSystemPanel.prototype,"BaseSystemPanel");var RegisterSystemParam=function(){function e(e,t,n){this.funcID=-1,this.index=0,this.sysName=e,this.btnRes=t,this.redP=n}return e.prototype.initRedChild=function(){if(this.tabBtns){for(var e=[],t=0;t<this.tabBtns.length;++t)this.tabBtns[t].setIdx(t),this.tabBtns[t].redP&&e.push(this.tabBtns[t].redP);this.redP&&e.length>0&&(this.redP.redPointChild=e)}},e}();__reflect(RegisterSystemParam.prototype,"RegisterSystemParam");var RegisterTabBtnParam=function(){function e(e,t){this.funcID=-1,this.sysName=e,this.tabBtnRes=t,this.checkBtnRes()}return e.prototype.setIdx=function(e){this.index=e},e.prototype.getIdx=function(){return this.index},e.prototype.checkBtnRes=function(){this.tabBtnRes&&-1==this.tabBtnRes.indexOf("_png")&&(this.tabBtnRes=this.tabBtnRes+"_png")},e}();__reflect(RegisterTabBtnParam.prototype,"RegisterTabBtnParam");var BaseTabView=function(e){function t(t){var n=e.call(this)||this;return n.onloadComp=!1,n.points=RedPointManager.createPoint(0),n.owner=t,n.once(eui.UIEvent.COMPLETE,n.onLoadComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(t,e),t.prototype.getRegisterSystemParam=function(){return this.owner.getRegisterSystemParam()},t.prototype.onAddToStage=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LOADING_OPEN)),this.onSkinName()},t.prototype.onSkinName=function(){},t.prototype.onLoadComplete=function(){this.onloadComp=!0,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LOADING_CLOSE)),DataManager.IS_PC_Game||(this.width=size.width),this.onInit(),this.parent&&this.onRegist()},t.prototype.isOnloadComp=function(){return this.onloadComp},t.prototype.onInit=function(){},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){},t.prototype.onRemove=function(){},t.prototype.onShow=function(){this.onloadComp&&(this.onRegist(),this.onRefresh())},t.prototype.onHide=function(){this.parent&&(this.onloadComp&&this.onRemove(),this.parent.removeChild(this))},t.prototype.createRedPoint=function(){var e=new redPoint;return this.points.push(e),e},t.prototype.trigger=function(){if(this.onloadComp)for(var e=0;e<this.points.length;e++)this.points[e].func&&this.points[e].checkPoint()},t.prototype.onChangeRole=function(){},t}(eui.Component);__reflect(BaseTabView.prototype,"BaseTabView");var BaseTipsBar=function(e){function t(t){var n=e.call(this)||this;return n.timeGoods=null,n.owner=t,n.onloadComp=!1,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.initSkinName(),n}return __extends(t,e),t.prototype.onLoadComplete=function(){this.onloadComp=!0,this.onsetParam&&this.onUpdate(this.param),this.onRegist()},t.prototype.isOnloadComp=function(){return this.onloadComp},t.prototype.initSkinName=function(){},t.prototype.onRegist=function(){},t.prototype.onRemove=function(){this.parent&&this.parent.removeChild(this)},t.prototype.setParam=function(e){this.param=e,this.onsetParam=!0,this.onloadComp&&(this.onUpdate(this.param),this.onRegist())},t.prototype.onUpdate=function(e){this.param=e},t.prototype.onRefreshCommonUI=function(e,t){void 0===t&&(t=-1),this.goods_item.onUpdate(e.type,e.id,0,e.quality),t=-1!=t?t:e.quality,this.name_label.textFlow=new Array({text:e.name,style:{textColor:GameCommon.getInstance().CreateNameColer[t]}}),this.desc_label&&(this.desc_label.text=e.des),this.timeGoods&&e.limitTime>0&&Tool.addTimer(this.updateLimitTime,this)},t.prototype.updateLimitTime=function(){this.limitTimeLabel&&(this.limitTimeLabel.text=this.timeGoods.timeStr)},t.prototype.onHide=function(){this.owner.onHide()},t}(eui.Component);__reflect(BaseTipsBar.prototype,"BaseTipsBar");var SDKHW=function(){function e(){this.loginPath="login",this.payPath="create_order"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){this.payContainer=t;var n=ChannelDefine.createURL(this.info,this.payPath,{amount:Tool.currencyTo(e.amount),goodsname:e.goodsName,requestId:this.info.serverId+"_"+this.info.playerId+"_"+e.amount+"_"+(new Date).getTime(),extReserved:this.info.serverId+"_"+this.info.playerId+"_"+e.amount+"_"+this.info.account});HttpUtil.sendGetRequest(n,this.createOrderCallback,this)},e.prototype.createOrderCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n&&(egret.log(n),SDKHWJS.pay(JSON.stringify(n)))},e}();__reflect(SDKHW.prototype,"SDKHW",["ISDKHandler"]);var SimplePlayerData=function(){function e(){this.rebirthLv=0}return e.prototype.parseMsg=function(e){this.id=e.getInt(),this.name=e.getString(),this.headindex=e.getByte(),this.headFrame=e.getByte();var t=e.getShort(),n=JsonModelManager.instance.getModelzhuansheng()[t];this.rebirthLv=n?n.zhuansheng:0,this.level=e.getShort(),this.vipExp=e.getInt(),this.fightvalue=e.getLong()},Object.defineProperty(e.prototype,"vipExp",{get:function(){return this._vipExp},set:function(e){this._vipExp=e,this.viplevel=GameCommon.getInstance().getVipLevel(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerLevelDesc",{get:function(){return(this.rebirthLv>0?Language.instance.getText("coatard_level"+this.rebirthLv):"")+this.level+Language.instance.getText("level")},enumerable:!0,configurable:!0}),e}();__reflect(SimplePlayerData.prototype,"SimplePlayerData");var BaseSimPlayerData=function(){function e(){}return e.prototype.parseMsg=function(e){this.playerId=e.getInt(),this.name=e.getString(),this.headindex=e.getByte(),this.headFrame=e.getByte();var t=e.getShort(),n=JsonModelManager.instance.getModelzhuansheng()[t];this.coatardlv=n?n.zhuansheng:0,this.level=e.getShort()},e}();__reflect(BaseSimPlayerData.prototype,"BaseSimPlayerData");var PlayerAppears=function(){function e(){this.petGrade=0}return e.prototype.parseMsg=function(e){this.petGrade=e.getByte(),this.appears=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new AppearPlayerData;a.parseMsg(e),this.appears.push(a)}},e}();__reflect(PlayerAppears.prototype,"PlayerAppears");var AppearPlayerData=function(){function e(){this.titleId=0,this.appears=[]}return e.prototype.parseMsg=function(e){this.occupation=e.getByte(),this.sex=e.getByte(),this.titleId=e.getByte();for(var t=[],n=0;n<BLESS_TYPE.SIZE;n++){var a=e.getByte();t[n]=t[a]}for(var n=0;n<BLESS_TYPE.SIZE;n++){var i=e.getByte();if(t[n]>0)if(i>0){var o=JsonModelManager.instance.getModelfashion()[i];o&&(this.appears[n]=o.waixing1)}else this.appears[n]=0;else this.appears[n]=GameDefine.PLAYER_DEFUALT_AVATAR[n]}},e}();__reflect(AppearPlayerData.prototype,"AppearPlayerData");var OtherFightData=function(){function e(){this._ohterAppears=new PlayerAppears}return e.prototype.parseYewaiPVPMsg=function(e){this.playerId=e.getInt(),this.playerName=e.getString(),this.headIndex=e.getByte(),this.headFrame=e.getByte();var t=e.getShort(),n=JsonModelManager.instance.getModelzhuansheng()[t];this.reinLv=n?n.zhuansheng:0,this.duanLv=n?n.duanwei:0,this.level=e.getShort(),this.parseAppears(e)},Object.defineProperty(e.prototype,"appears",{get:function(){return this._ohterAppears.appears},enumerable:!0,configurable:!0}),e.prototype.parseAppears=function(e){-1!=this.playerId&&this._ohterAppears.parseMsg(e)},e}();__reflect(OtherFightData.prototype,"OtherFightData");var SimpleFightRankData=function(){function e(){}return e.prototype.onParseMsg=function(e,t){this.rank=t,this.playerId=e.getInt(),this.playerName=e.getString(),this.damageValue=e.getLong(),this.vipLevel=e.getByte()},e}();__reflect(SimpleFightRankData.prototype,"SimpleFightRankData");var PlayerXinfaData=function(){function e(e){this.id=e}return Object.defineProperty(e.prototype,"model",{get:function(){return JsonModelManager.instance.getModeltujian2()[this.id]},enumerable:!0,configurable:!0}),e}();__reflect(PlayerXinfaData.prototype,"PlayerXinfaData");var EChannel;!function(e){e[e.CHANNEL_AWY=1001]="CHANNEL_AWY",e[e.CHANNEL_CRAZY=1002]="CHANNEL_CRAZY",e[e.CHANNEL_YYB=1003]="CHANNEL_YYB",e[e.CHANNEL_EGRET=1004]="CHANNEL_EGRET",e[e.CHANNEL_WANBA=1005]="CHANNEL_WANBA",e[e.CHANNEL_AQY=1006]="CHANNEL_AQY",e[e.CHANNEL_JINBANG=1007]="CHANNEL_JINBANG",e[e.CHANNEL_360=1008]="CHANNEL_360",e[e.CHANNEL_QUICK=1010]="CHANNEL_QUICK",e[e.CHANNEL_SHENQI=1013]="CHANNEL_SHENQI",e[e.CHANNEL_YYBQUICK=1014]="CHANNEL_YYBQUICK",e[e.CHANNEL_KAOPUGP=1015]="CHANNEL_KAOPUGP",e[e.CHANNEL_VIVO=1016]="CHANNEL_VIVO",e[e.CHANNEL_HUAWEI=1017]="CHANNEL_HUAWEI",e[e.CHANNEL_SOEZ=1018]="CHANNEL_SOEZ",e[e.CHANNEL_QUNHEI=1019]="CHANNEL_QUNHEI",e[e.CHANNEL_YIYOU=1020]="CHANNEL_YIYOU",e[e.CHANNEL_HUIYOU=1021]="CHANNEL_HUIYOU",e[e.CHANNEL_WXGAMEBOX=1022]="CHANNEL_WXGAMEBOX",e[e.CHANNEL_NEZHA=1023]="CHANNEL_NEZHA",e[e.CHANNEL_LOCAL=1e4]="CHANNEL_LOCAL"}(EChannel||(EChannel={}));var ChannelDefine=function(){function e(){}return e.checkResult=function(t){return t[e.RET]?t[e.RET]!=e.SUCCESS?!1:!0:!1},e.getLibs=function(t){var n=EChannel[t];return e.CHANNEL_LIBS[n]},Object.defineProperty(e,"cdnUrl",{get:function(){if(platform.isLocalTest())return e.CDN_URL[EChannel.CHANNEL_LOCAL];var t=EChannel[SDKManager.loginInfo.channel];return e.CDN_URL[t]},enumerable:!0,configurable:!0}),e.getUrl=function(t){if(platform.isLocalTest())return e.LOGON_URL[EChannel.CHANNEL_LOCAL];var n=EChannel[t];return e.LOGON_URL[n]},e.createURL=function(e,t,n){var a=e.url+"/sdk/"+e.channel+"/"+t;n&&(a+="?");for(var i in n)a+=i+"="+n[i]+"&";return a},e.RET="ret",e.SUCCESS="0",e.ERROR="-1",e.CHANNEL_LIBS={CHANNEL_AWY:["libs/SDK/SDKAWYJS.js","https://cdn.11h5.com/static/js/sdk.min.js"],CHANNEL_CRAZY:["libs/SDK/SDKCrazyJS.js","http://h5.hortorgames.com/sdk/sdk_agent.min.js"],CHANNEL_YYB:["libs/SDK/SDKYYBJS.js","http://qzonestyle.gtimg.cn/open/mobile/h5gamesdk/build/sdk.js"],CHANNEL_EGRET:[],CHANNEL_WANBA:["libs/SDK/SDKWanBa.js"],CHANNEL_JINBANG:["libs/SDK/SDKJinBang.js","https://cdn.99kgames.com/js/tpgame_sdk.min.js"],CHANNEL_360:["libs/SDK/SDK360JS.js","http://h5.wan.360.cn/h5-cp-sdk-loader.js"],CHANNEL_QUICK:["libs/SDK/SDKQuickJS.js","https://sdkapi02.quicksdk.net/static/lib/libQuickSDKH5_To_Client.js"],CHANNEL_SHENQI:["libs/SDK/SDKQuickJS.js","https://sdkapi02.quicksdk.net/static/lib/libQuickSDKH5_To_Client.js"],CHANNEL_YYBQUICK:["libs/SDK/SDKQuickJS.js","https://sdkapi02.quicksdk.net/static/lib/libQuickSDKH5_To_Client.js"],CHANNEL_KAOPUGP:["libs/SDK/SDKKAOPUJS.js","http://down.kaopu001.com/H5SDK/SuperSDK/JS/supersdk.min.js"],CHANNEL_VIVO:["libs/SDK/SDKVIVOJS.js","libs/SDK/h5game.min.js"],CHANNEL_HUAWEI:["libs/SDK/SDKHWJS.js",""],CHANNEL_SOEZ:["libs/SDK/SDKEZ.js","https://cn.soeasysdk.com/soeasysr/zm_engine_v2.js"],CHANNEL_QUNHEI:["libs/SDK/SDKEZ.js","https://cn.soeasysdk.com/soeasysr/zm_engine_v2.js"],CHANNEL_YIYOU:["libs/SDK/SDKYUJS.js","//h5.h5youyou.com/assets/v0.1.0/sdk.js"],CHANNEL_HUIYOU:["libs/SDK/SDKHUIYOUJS.js"],CHANNEL_NEZHA:["libs/SDK/SDKNeZha.js","//h5-img.binglue.com/js/sdk_game2.js?v=1.0"],CHANNEL_LOCAL:[]},e.STATISTICS_CHANID={CHANNEL_WANBA:10080},e.LOGON_URL={CHANNEL_AWY:"https://azxlogin.ih5games.com:20000",CHANNEL_CRAZY:"https://csylogin.ih5games.com:20000",CHANNEL_360:"http://360syjlogin.ih5games.com:20000",CHANNEL_QUICK:"https://qsyjlogin.ih5games.com:20000",CHANNEL_SHENQI:"https://qsyjlogin.ih5games.com:20000",CHANNEL_YYBQUICK:"https://kpsyjlogin.ih5games.com:20000",CHANNEL_YYB:"http://211.159.156.144:10000",CHANNEL_EGRET:"http://120.92.90.21:10000",CHANNEL_WANBA:"https://wzxlogin.ih5games.com:20000",CHANNEL_JINBANG:"http://ssss.milgame.cn:10000",CHANNEL_KAOPUGP:"https://kpsyjlogin.ih5games.com:20000",CHANNEL_VIVO:"https://qsyjlogin.ih5games.com:20000",CHANNEL_HUAWEI:"https://qsyjlogin.ih5games.com:20000",CHANNEL_SOEZ:"https://qsyjlogin.ih5games.com:20000",CHANNEL_QUNHEI:"https://qsyjlogin.ih5games.com:20000",CHANNEL_YIYOU:"https://qsyjlogin.ih5games.com:20000",CHANNEL_HUIYOU:"https://qsyjlogin.ih5games.com:20000",CHANNEL_WXGAMEBOX:"https://jpsx-login.szfyhd.com/loginServer",CHANNEL_NEZHA:"https://qsyjlogin.ih5games.com:20000",CHANNEL_LOCAL:"http://192.168.1.100:21000"},e.CDN_URL={CHANNEL_WXGAMEBOX:"https://jpsx-login.szfyhd.com/FENGYUN_"+DataManager.res_ver+"/",CHANNEL_LOCAL:""},e}();__reflect(ChannelDefine.prototype,"ChannelDefine");var ChatDefine=function(){function e(){}return e.getChatParamText=function(e){var t="",n=e.param.split("#"),a=n[0],i=n[1].split(",");switch(a){case"teamdup":var o=parseInt(i[1]),r=JsonModelManager.instance.getModelcopy()[o];if(r)switch(r.type){case DUP_TYPE.DUP_TEAM:t=Language.instance.parseInsertText("chat_type_"+a,e.player.name,r.name);break;case DUP_TYPE.DUP_VIP_TEAM:t=Language.instance.parseInsertText("chat_type_vipteamdup",e.player.name,r.name)}break;case"soldier":t=Language.instance.getText("myboss_notice")}return t},e.onChatHrefEvent=function(e){var t=e.split("#"),n=t[0],a=t[1].split(",");switch(n){case"soldier":GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionBossFightPanel",1));break;case"teamdup":GameFight.getInstance().onSendJoinTeamDupRoomMsg(parseInt(a[0]),parseInt(a[1]))}},e.getChatValidTime=function(e){var t=e.split("#"),n=t[0];t[1].split(",");switch(n){case"soldier":case"teamdup":return egret.getTimer()+15e3}return 0},e.DEFAULT_SHORT_CHAT=["chat_shortword1","chat_shortword2","chat_shortword3","chat_shortword4","chat_shortword5","chat_shortword6","chat_shortword7"],e.ACT_DEFAULT_SHORTCHAT=["activityChat_1","activityChat_2","activityChat_3","activityChat_4","activityChat_5","activityChat_6"],e.MAX_RECORD_INFO=100,e}();__reflect(ChatDefine.prototype,"ChatDefine");var CHANNEL;!function(e){e[e.SYS=0]="SYS",e[e.CURRENT=1]="CURRENT",e[e.GUILD=2]="GUILD",e[e.ALL=3]="ALL",e[e.WHISPER=4]="WHISPER",e[e.ALLSERVER=5]="ALLSERVER"}(CHANNEL||(CHANNEL={}));var BroadcastType;!function(e){e[e.SERVER_CLOSE=-1]="SERVER_CLOSE",e[e.SYSTEM=0]="SYSTEM"}(BroadcastType||(BroadcastType={}));var MASTER_EQUIP_TYPE;!function(e){e[e.HEIMET=0]="HEIMET",e[e.PAULDRON=1]="PAULDRON",e[e.CLOAK=2]="CLOAK",e[e.NECKLACES=3]="NECKLACES",e[e.BELT=4]="BELT",e[e.CLOTHES=5]="CLOTHES",e[e.TROUSERS=6]="TROUSERS",e[e.SHOES=7]="SHOES",e[e.WEAPON=8]="WEAPON",e[e.RING=9]="RING",e[e.SIZE=10]="SIZE"}(MASTER_EQUIP_TYPE||(MASTER_EQUIP_TYPE={}));var GoodsDefine=function(){function e(){}return e.EQUIP_SLOT_TYPE=[MASTER_EQUIP_TYPE.HEIMET,MASTER_EQUIP_TYPE.PAULDRON,MASTER_EQUIP_TYPE.CLOAK,MASTER_EQUIP_TYPE.NECKLACES,MASTER_EQUIP_TYPE.BELT,MASTER_EQUIP_TYPE.CLOTHES,MASTER_EQUIP_TYPE.TROUSERS,MASTER_EQUIP_TYPE.SHOES,MASTER_EQUIP_TYPE.WEAPON,MASTER_EQUIP_TYPE.RING],e.SLOT_GEMTYPE=[[1,2,1,0,3],[1,3,1,0,2],[3,1,0,1,2],[3,1,0,1,2],[1,2,1,0,3],[1,3,1,0,2],[3,1,0,1,2],[3,1,0,1,2],[1,2,1,0,3],[1,3,1,0,2]],e.EQUIP_QUALITY_ADDRATE=[1,1.25,1.75,2.5,3.5,1,1],e.ITEM_ID_SP_ZUOYAN=14,e.ITEM_ID_SP_YOUMOU=15,e.SHOWITEM_ID_PRESTIGE=0,e.ITEM_ID_ZHULINGSHI=3,e.ITEM_ID_LIANHUAZHIHUN=5,e.ITEM_ID_CZSP=41,e.ITEM_ID_TSSP=141,e.ITEM_ID_HORSE_GROW=12,e.ITEM_ID_WEAPON_GROW=13,e.ITEM_ID_CLOTHES_GROW=14,e.ITEM_ID_WING_GROW=15,e.ITEM_ID_MAGIC_GROW=16,e.ITEM_ID_WEAPON_APTITUDE=23,e.ITEM_ID_CLOTHES_APTITUDE=24,e.ITEM_ID_WING_APTITUDE=25,e.ITEM_ID_MAGIC_APTITUDE=26,e.ITEM_ID_LIMIT_HORSE_RANK=39,e.ITEM_ID_LIMIT_WING_RANK=42,e.ITEM_ID_LIMIT_MAGIC_RANK=43,e.ITEM_PET_XIAOTIAN=40,e.ITEM_PET_QINGQIU=53,e.ITEM_FUDAI=51,e.ITEM_FIRSTPAY_FASHION=543,e.ITEM_FIRSTPAY_XUANQI=253,e.ITEM_ID_CUILIAN=4,e.ITEM_BLESS_UPDAN=[31,32,33,34,35,36,37,38,39,40],e.ITEM_BLESS_SUPERUPDAN=[162,163,164,165,166,167,168,169,170,171],e.FATE_GOD_COST=50,e.ITEM_ID_FATE=153,e.FATE_UNLOCK=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],e}();__reflect(GoodsDefine.prototype,"GoodsDefine");var GOODS_TYPE;!function(e){e[e.MASTER_EQUIP=0]="MASTER_EQUIP",e[e.SERVANT_EQUIP=1]="SERVANT_EQUIP",e[e.ITEM=2]="ITEM",e[e.BOX=3]="BOX",e[e.GOLD=4]="GOLD",e[e.DIAMOND=5]="DIAMOND",e[e.EXP=6]="EXP",e[e.SHENGWANG=7]="SHENGWANG",e[e.ANIMA=8]="ANIMA",e[e.YUANSHEN=9]="YUANSHEN",e[e.FAHUN=10]="FAHUN",e[e.RONGYU=11]="RONGYU",e[e.VIPEXP=12]="VIPEXP",e[e.ARENA=13]="ARENA",e[e.POINTS=14]="POINTS",e[e.SHOW=15]="SHOW",e[e.DONATE=16]="DONATE",e[e.SAVVY=17]="SAVVY",e[e.VIGOUR=18]="VIGOUR",e[e.SHENTONG=19]="SHENTONG",e[e.TLINTEGRAL=20]="TLINTEGRAL",e[e.SHOJIFEN=21]="SHOJIFEN",e[e.HUANQI=22]="HUANQI",e[e.DANYAO=24]="DANYAO",e[e.CAOYAO=25]="CAOYAO",e[e.RNUES=26]="RNUES",e[e.YUELI=27]="YUELI",e[e.ZHANGONG=28]="ZHANGONG",e[e.SHAREEXP=29]="SHAREEXP",e[e.GEM=1e5]="GEM"}(GOODS_TYPE||(GOODS_TYPE={}));var PSYCH_CHANGE_TYPE;!function(e){e[e.CHANGE_ADD=10075]="CHANGE_ADD"}(PSYCH_CHANGE_TYPE||(PSYCH_CHANGE_TYPE={}));var GOODS_CHANGE_TYPE;!function(e){e[e.GM_ADD=0]="GM_ADD",e[e.TAKEOFF_ADD=10001]="TAKEOFF_ADD",e[e.MERIDIAN_UP_ADD=10002]="MERIDIAN_UP_ADD",e[e.LADDER_FIGHT_REWARD=10003]="LADDER_FIGHT_REWARD",e[e.FIGHT_BRUSH_MONSTER_ADD=10004]="FIGHT_BRUSH_MONSTER_ADD",e[e.FIGHT_BRUSH_BOSS_ADD=10005]="FIGHT_BRUSH_BOSS_ADD",e[e.FIGHT_DUNGEON_ADD=10006]="FIGHT_DUNGEON_ADD",e[e.SHOP_BUY_ADD=10007]="SHOP_BUY_ADD",e[e.MAIL_ADD=10008]="MAIL_ADD",e[e.SWORD_POOL_ADD=10009]="SWORD_POOL_ADD",e[e.GOODS_USE_ADD=10010]="GOODS_USE_ADD",e[e.SPIRIT_LOTTERY_ADD=10011]="SPIRIT_LOTTERY_ADD",e[e.BLOODY_BATTLE_ADD=10012]="BLOODY_BATTLE_ADD",e[e.BLESS_EQUIP_ADD=10091]="BLESS_EQUIP_ADD",e[e.MELT_ADD=10013]="MELT_ADD",e[e.DIAL_ADD=10035]="DIAL_ADD",e[e.MAGIC_TURNPLATE_ADD=10068]="MAGIC_TURNPLATE_ADD",e[e.YEWAI_PVP_ADD=10073]="YEWAI_PVP_ADD",e[e.CELESTIAL_COMPOUND=10069]="CELESTIAL_COMPOUND",e[e.ORANGE_COMPOUND=10014]="ORANGE_COMPOUND",e[e.WISHINGWELL_ADD=10101]="WISHINGWELL_ADD",e[e.SERVER_ARENA_ADD=10109]="SERVER_ARENA_ADD",e[e.XIANSHAN_ADD=10127]="XIANSHAN_ADD",e[e.VIPZHUANPAN_ADD=10131]="VIPZHUANPAN_ADD",e[e.RNUES_EQUIP_PACKAGE_ADD=10143]="RNUES_EQUIP_PACKAGE_ADD",e[e.RNUES_EQUIP_ADD=10144]="RNUES_EQUIP_ADD",e[e.STRENGTHEN_CONSUME=20001]="STRENGTHEN_CONSUME",e[e.PASSIVESKILL_UP_CONSUME=20002]="PASSIVESKILL_UP_CONSUME",e[e.SKILL_UP_CONSUME=20003]="SKILL_UP_CONSUME",e[e.ZHULING_CONSUME=20004]="ZHULING_CONSUME",e[e.MELT_CONSUME=20005]="MELT_CONSUME",e[e.HORSE_BLESS_CONSUME=20006]="HORSE_BLESS_CONSUME",e[e.WEAPON_BLESS_CONSUME=20007]="WEAPON_BLESS_CONSUME",e[e.WING_UP_CONSUME=20008]="WING_UP_CONSUME",e[e.CLOTHES_UP_CONSUME=20009]="CLOTHES_UP_CONSUME",e[e.MAGIC_UP_CONSUME=20010]="MAGIC_UP_CONSUME",e[e.TAKEOFF_CONSUME=20012]="TAKEOFF_CONSUME",e[e.SHENQI_UP_CONSUME=20013]="SHENQI_UP_CONSUME",e[e.MERIDIAN_UP_CONSUME=20014]="MERIDIAN_UP_CONSUME",e[e.SHOP_BUY_CONSUME=20015]="SHOP_BUY_CONSUME",e[e.DUNGEON_SWEEP_CONSUME=20016]="DUNGEON_SWEEP_CONSUME",e[e.LADDER_BUY_COUNT_CONSUME=20017]="LADDER_BUY_COUNT_CONSUME",e[e.SPIRIT_UPGRADE_CONSUME=20018]="SPIRIT_UPGRADE_CONSUME",e[e.GOODS_USE_CONSUME=20019]="GOODS_USE_CONSUME",e[e.SPIRIT_LOTTERY_CONSUME=20020]="SPIRIT_LOTTERY_CONSUME",e[e.DELAY_ADD=1]="DELAY_ADD"}(GOODS_CHANGE_TYPE||(GOODS_CHANGE_TYPE={}));var Fourinages_Type;!function(e){e[e.XUANWU=0]="XUANWU",e[e.BAIHU=1]="BAIHU",e[e.ZHUQUE=2]="ZHUQUE",e[e.QINGLONG=3]="QINGLONG",e[e.SIZE=4]="SIZE"}(Fourinages_Type||(Fourinages_Type={}));var BaseFightScene=function(){function e(e){this.mainscene=e}return e.prototype.onInitScene=function(e){this._rushData||(this._rushData=new RushEnemyData),this._scenetype=e,this.mainscene.onResetAllHeroBody(),this.mainscene.getModuleLayer().onRefreshScene()},e.prototype.registFightMessage=function(){this.fight_info_bar&&this.fight_info_bar.leave_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLeaveBtn,this)},e.prototype.removeFightMessage=function(){this.fight_info_bar&&this.fight_info_bar.leave_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLeaveBtn,this)},e.prototype.onParseFightMsg=function(e){},e.prototype.onLoadingSceneRes=function(e){this.lodingResList=[],this.onCraeteLoadRes(e),this.mainscene.getModuleLayer().onshowGameloadingUI(this.onLoadComplete,this,this.lodingResList)},e.prototype.onInitFightInfoBar=function(){this.fight_info_bar&&(DataManager.IS_PC_Game?this.fight_info_bar.width=GameDefine.GAME_STAGE_WIDTH:this.fight_info_bar.width=size.width)},e.prototype.onSwitchMap=function(e){return this._isChangeMap=!0,this.onInitFightInfoBar(),this.mainscene.getModuleLayer().onHideBossHpBar(),this.mainscene.mapInfo.mapId==e?(this._isChangeMap=!1,void this.onLoadComplete()):(this.removeFightMessage(),SkillEffectManager.getInstance().onDestroyAllSkillEffect(),this.mainscene.getBodyManager().onRefreshSence(),this.mainscene.getMapLayer().removeBodyLayerAll(),this.mainscene.pauseFightRun(),this.mainscene.getBodyManager().fightPause=!0,this.mainscene.getModuleLayer().onPlayPassSceneAnim(),this._status=FIGHT_STATUS.Loading,void this.mainscene.mapInfo.onRefreshMapInfo(e))
},e.prototype.onLoadComplete=function(){this.setStagePointType(),this._isChangeMap&&this.mainscene.getMapLayer().onRefreshMap(),this._status=FIGHT_STATUS.Enter,this.onEnterSuccessScene(),this.onStartFight(),this.mainscene.onupdateHero(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SCENE_ENTER_SUCCESS))},e.prototype.setStagePointType=function(){this.mainscene.mapInfo.heroPointType=CameraType.CENTER},e.prototype.onStartFight=function(){this._status=FIGHT_STATUS.Fighting,this.mainscene.getBodyManager().fightPause=!1},e.prototype.onCraeteLoadRes=function(e){var t=JsonModelManager.instance.getModelmap()[e];if(this.lodingResList.push("map"+t.resources+"_small_jpg"),this.mainscene.mapInfo.fightId>0){var n=this.mainscene.mapInfo.fightId+"_fight_xml";this.lodingResList.push(n)}},e.prototype.onEnterSuccessScene=function(){this.registFightMessage(),this.mainscene.startFightRun()},e.prototype.onDeath=function(){},e.prototype.onFightWin=function(){},e.prototype.onFightLose=function(){},e.prototype.onRushMonster=function(){},e.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);if(a){var i=this.mainscene.heroBody.data.targets;if(i.indexOf(t)<0)return;for(var o=0;o<i.length;o++){var t=i[o];if(egret.is(t,"BossBody")){var r=t.data;0==t.data.targets.length&&this.mainscene.getModuleLayer().onShowBossHpBar(r),this.mainscene.getModuleLayer().onUpdateBossHpBar(r.currentHp,r.maxHp)}0==t.data.targets.length&&t.onAddEnemyBodyList(this.mainscene.heroBodys)}}},e.prototype.onKillTargetHandle=function(){this._status==FIGHT_STATUS.Fighting&&0==this.mainscene.heroBody.data.targets.length&&this.onFightWin()},e.prototype.onFinishFight=function(e){this.mainscene.getBodyManager().fightPause=!0,this._status=FIGHT_STATUS.Result},e.prototype.onDestroyScene=function(){this.removeFightMessage(),this.mainscene.getModuleLayer().overBossIncomeingAnim(),this.fight_info_bar&&this.fight_info_bar.parent&&this.fight_info_bar.parent.removeChild(this.fight_info_bar),this._status=FIGHT_STATUS.Leave},e.prototype.onTouchLeaveBtn=function(){var e=[{text:Language.instance.getText("zhongtutuichushuoming")}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onQuitScene,this)))},e.prototype.onQuitScene=function(){GameFight.getInstance().fightsceneTpye==this.sceneTpye&&this.mainscene.onReturnYewaiScene()},e.prototype.onUpdateHeroInfo=function(){},e.prototype.playBossIncomeAnim=function(){this.mainscene.getModuleLayer().playBossIncomingAnim(),this.mainscene.getBodyManager().fightPause=!0,Tool.callbackTime(function(e){GameFight.getInstance().fightsceneTpye==e&&(this.mainscene.getBodyManager().fightPause=!1)},this,1e3,this.sceneTpye)},Object.defineProperty(e.prototype,"sceneTpye",{get:function(){return this._scenetype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightStatus",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TickInterval",{get:function(){return 5e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rushData",{get:function(){return this._rushData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapInfo",{get:function(){return this.mainscene.mapInfo},enumerable:!0,configurable:!0}),e}();__reflect(BaseFightScene.prototype,"BaseFightScene",["IFightScene"]);var RushEnemyData=function(){function e(){this.back_goType=0}return e}();__reflect(RushEnemyData.prototype,"RushEnemyData");var JsonModelTemplet=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowRank",{get:function(){return this._lowRank},set:function(e){this._lowRank=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highRank",{get:function(){return this._highRank},set:function(e){this._highRank=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rate",{get:function(){return this._rate},set:function(e){this._rate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rank",{get:function(){return this._rank},set:function(e){this._rank=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hp",{get:function(){return this._hp},set:function(e){this._hp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attack",{get:function(){return this._attack},set:function(e){this._attack=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"phyDef",{get:function(){return this._phyDef},set:function(e){this._phyDef=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"magicDef",{get:function(){return this._magicDef},set:function(e){this._magicDef=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"limitLevel",{get:function(){return this._limitLevel},set:function(e){this._limitLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(e){this._startTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endTime",{get:function(){return this._endTime},set:function(e){this._endTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTime",{get:function(){return this._durationTime},set:function(e){this._durationTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fightCD",{get:function(){return this._fightCD},set:function(e){this._fightCD=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modelId",{get:function(){return this._modelId},set:function(e){this._modelId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"map",{get:function(){return this._map},set:function(e){this._map=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rewardWin",{get:function(){return this._rewardWin},set:function(e){this._rewardWin=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rewardLose",{get:function(){return this._rewardLose},set:function(e){this._rewardLose=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yulan",{get:function(){return this._yulan},set:function(e){this._yulan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EXPLORE_BOSS_RULE",{get:function(){return this._EXPLORE_BOSS_RULE},set:function(e){this._EXPLORE_BOSS_RULE=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EXPLORE_BOSS_EXIST",{get:function(){return this._EXPLORE_BOSS_EXIST},set:function(e){this._EXPLORE_BOSS_EXIST=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EXPLORE_POWER_MAX",{get:function(){return this._EXPLORE_POWER_MAX},set:function(e){this._EXPLORE_POWER_MAX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EXPLORE_POWER_RECOVER",{get:function(){return this._EXPLORE_POWER_RECOVER},set:function(e){this._EXPLORE_POWER_RECOVER=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DISAPPEAR_TIME",{get:function(){return this._DISAPPEAR_TIME},set:function(e){this._DISAPPEAR_TIME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EXIST_TIME",{get:function(){return this._EXIST_TIME},set:function(e){this._EXIST_TIME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BOSS_FIGHT_MAX",{get:function(){return this._BOSS_FIGHT_MAX},set:function(e){this._BOSS_FIGHT_MAX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BOSS_FIGHT_TIME",{get:function(){return this._BOSS_FIGHT_TIME},set:function(e){this._BOSS_FIGHT_TIME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ATK_CD_TIME",{get:function(){return this._ATK_CD_TIME},set:function(e){this._ATK_CD_TIME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstReward",{get:function(){return this._firstReward},set:function(e){this._firstReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstTitle",{get:function(){return this._firstTitle},set:function(e){this._firstTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstContent",{get:function(){return this._firstContent},set:function(e){this._firstContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondReward",{get:function(){return this._secondReward},set:function(e){this._secondReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondTitle",{get:function(){return this._secondTitle},set:function(e){this._secondTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondContent",{get:function(){return this._secondContent},set:function(e){this._secondContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Reward345",{get:function(){return this._Reward345},set:function(e){this._Reward345=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Title345",{get:function(){return this._Title345},set:function(e){this._Title345=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Content345",{get:function(){return this._Content345},set:function(e){this._Content345=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canyuReward",{get:function(){return this._canyuReward},set:function(e){this._canyuReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canyuTitle",{get:function(){return this._canyuTitle},set:function(e){this._canyuTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canyuContent",{get:function(){return this._canyuContent},set:function(e){this._canyuContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"killReward",{get:function(){return this._killReward},set:function(e){this._killReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"killTitle",{get:function(){return this._killTitle},set:function(e){this._killTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"killContent",{get:function(){return this._killContent},set:function(e){this._killContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levelLimit",{get:function(){return this._levelLimit},set:function(e){this._levelLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vipLimit",{get:function(){return this._vipLimit},set:function(e){this._vipLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return this._icon},set:function(e){this._icon=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dropicon",{get:function(){return this._Dropicon},set:function(e){this._Dropicon=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"consumeId",{get:function(){return this._consumeId},set:function(e){this._consumeId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"consumeNum",{get:function(){return this._consumeNum},set:function(e){this._consumeNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gainId",{get:function(){return this._gainId},set:function(e){this._gainId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"des",{get:function(){return this._des},set:function(e){this._des=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"haveNum",{get:function(){return this._haveNum},set:function(e){this._haveNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pinzhi",{get:function(){return this._pinzhi},set:function(e){this._pinzhi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastTime",{get:function(){return this._lastTime},set:function(e){this._lastTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useful",{get:function(){return this._useful},set:function(e){this._useful=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useMax",{get:function(){return this._useMax},set:function(e){this._useMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffAdd",{get:function(){return this._buffAdd},set:function(e){this._buffAdd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffMul",{get:function(){return this._buffMul},set:function(e){this._buffMul=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(e){this._time=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},set:function(e){this._effect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hurtpos",{get:function(){return this._hurtpos},set:function(e){this._hurtpos=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"point",{get:function(){return this._point},set:function(e){this._point=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monsterId",{get:function(){return this._monsterId},set:function(e){this._monsterId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bossId",{get:function(){return this._bossId},set:function(e){this._bossId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(e){this._num=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monsterDrop",{get:function(){return this._monsterDrop},set:function(e){this._monsterDrop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bossDrop",{get:function(){return this._bossDrop},set:function(e){this._bossDrop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desc",{get:function(){return this._desc},set:function(e){this._desc=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this._batch},set:function(e){this._batch=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"channelList",{get:function(){return this._channelList},set:function(e){this._channelList=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cdkeyCount",{get:function(){return this._cdkeyCount},set:function(e){this._cdkeyCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxId",{get:function(){return this._boxId},set:function(e){this._boxId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCountLimit",{get:function(){return this._userCountLimit},set:function(e){this._userCountLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useLimit",{get:function(){return this._useLimit},set:function(e){this._useLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ditu",{get:function(){return this._ditu},set:function(e){this._ditu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wenzi",{get:function(){return this._wenzi},set:function(e){this._wenzi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(e){this._size=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hit",{get:function(){return this._hit},set:function(e){this._hit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dodge",{get:function(){return this._dodge},set:function(e){this._dodge=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crit",{get:function(){return this._crit},set:function(e){this._crit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duct",{get:function(){return this._duct},set:function(e){this._duct=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"block",{get:function(){return this._block},set:function(e){this._block=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"counter",{get:function(){return this._counter},set:function(e){this._counter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goType",{get:function(){return this._goType},set:function(e){this._goType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventType",{get:function(){return this._eventType},set:function(e){this._eventType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateType",{get:function(){return this._updateType},set:function(e){this._updateType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extParam",{get:function(){return this._extParam},set:function(e){this._extParam=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},set:function(e){this._param=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jackaroo",{get:function(){return this._jackaroo},set:function(e){this._jackaroo=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chongzhi",{get:function(){return this._chongzhi},set:function(e){this._chongzhi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lv",{get:function(){return this._lv},set:function(e){this._lv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exp",{get:function(){return this._exp},set:function(e){this._exp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao",{get:function(){return this._mubiao},set:function(e){this._mubiao=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"points",{get:function(){return this._points},set:function(e){this._points=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"harm",{get:function(){return this._harm},set:function(e){this._harm=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jieduan",{get:function(){return this._jieduan},set:function(e){this._jieduan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waixing1",{get:function(){return this._waixing1},set:function(e){this._waixing1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemCost",{get:function(){return this._itemCost},set:function(e){this._itemCost=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemExp",{get:function(){return this._itemExp},set:function(e){this._itemExp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chenggonggailv",{get:function(){return this._chenggonggailv},set:function(e){this._chenggonggailv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gain",{get:function(){return this._gain},set:function(e){this._gain=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapid",{get:function(){return this._mapid},set:function(e){this._mapid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subType",{get:function(){return this._subType},set:function(e){this._subType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lvlimit",{get:function(){return this._lvlimit},set:function(e){this._lvlimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viplimit",{get:function(){return this._viplimit},set:function(e){this._viplimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nums",{get:function(){return this._nums},set:function(e){this._nums=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"price",{get:function(){return this._price},set:function(e){this._price=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"priceAdd",{get:function(){return this._priceAdd},set:function(e){this._priceAdd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fightId",{get:function(){return this._fightId},set:function(e){this._fightId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nandu1",{get:function(){return this._nandu1},set:function(e){this._nandu1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nandu2",{get:function(){return this._nandu2},set:function(e){this._nandu2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nandu3",{get:function(){return this._nandu3},set:function(e){this._nandu3=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward1",{get:function(){return this._reward1},set:function(e){this._reward1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward2",{get:function(){return this._reward2},set:function(e){this._reward2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward3",{get:function(){return this._reward3},set:function(e){this._reward3=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward4",{get:function(){return this._reward4},set:function(e){this._reward4=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"power",{get:function(){return this._power},set:function(e){this._power=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gailv",{get:function(){return this._gailv},set:function(e){this._gailv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isView",{get:function(){return this._isView},set:function(e){this._isView=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biaoti",{get:function(){return this._biaoti},set:function(e){this._biaoti=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bg",{get:function(){return this._bg},set:function(e){this._bg=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keeptime",{get:function(){return this._keeptime},set:function(e){this._keeptime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jiangli",{get:function(){return this._jiangli},set:function(e){this._jiangli=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coatardLv",{get:function(){return this._coatardLv},set:function(e){this._coatardLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"occupation",{get:function(){return this._occupation},set:function(e){this._occupation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Appearance",{get:function(){return this._Appearance},set:function(e){this._Appearance=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"star",{get:function(){return this._star},set:function(e){this._star=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lv",{get:function(){return this._Lv},set:function(e){this._Lv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"satr",{get:function(){return this._satr},set:function(e){this._satr=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gold",{get:function(){return this._gold},set:function(e){this._gold=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiply",{get:function(){return this._multiply},set:function(e){this._multiply=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itme",{get:function(){return this._itme},set:function(e){this._itme=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goDesc",{get:function(){return this._goDesc},set:function(e){this._goDesc=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill",{get:function(){return this._skill},set:function(e){this._skill=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waixing2",{get:function(){return this._waixing2},set:function(e){this._waixing2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shopType",{get:function(){return this._shopType},set:function(e){this._shopType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},set:function(e){this._item=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"days",{get:function(){return this._days},set:function(e){this._days=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){return this._times},set:function(e){this._times=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"avata",{get:function(){return this._avata},set:function(e){this._avata=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"high",{get:function(){return this._high},set:function(e){this._high=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lingxing",{get:function(){return this._lingxing},set:function(e){this._lingxing=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guanqia",{get:function(){return this._guanqia},set:function(e){this._guanqia=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vip",{get:function(){return this._vip},set:function(e){this._vip=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logic",{get:function(){return this._logic},set:function(e){this._logic=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jingjie",{get:function(){return this._jingjie},set:function(e){this._jingjie=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pvpLv",{get:function(){return this._pvpLv},set:function(e){this._pvpLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"functionType",{get:function(){return this._functionType},set:function(e){this._functionType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAct",{get:function(){return this._isAct},set:function(e){this._isAct=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGroup",{get:function(){return this._isGroup},set:function(e){this._isGroup=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropType",{get:function(){return this._dropType},set:function(e){this._dropType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"equip_percent",{get:function(){return this._equip_percent},set:function(e){this._equip_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"equipdropNum",{get:function(){return this._equipdropNum},set:function(e){this._equipdropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"equip",{get:function(){return this._equip},set:function(e){this._equip=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item_percent",{get:function(){return this._item_percent},set:function(e){this._item_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemdropNum",{get:function(){return this._itemdropNum},set:function(e){this._itemdropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currency_percent",{get:function(){return this._currency_percent},set:function(e){this._currency_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currencydropNum",{get:function(){return this._currencydropNum},set:function(e){this._currencydropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currency",{get:function(){return this._currency},set:function(e){this._currency=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diamond_percent",{get:function(){return this._diamond_percent},set:function(e){this._diamond_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diamonddropNum",{get:function(){return this._diamonddropNum},set:function(e){this._diamonddropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diamond",{get:function(){return this._diamond},set:function(e){this._diamond=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box_percent",{get:function(){return this._box_percent},set:function(e){this._box_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxdropNum",{get:function(){return this._boxdropNum},set:function(e){this._boxdropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},set:function(e){this._box=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanshen_percent",{get:function(){return this._yuanshen_percent},set:function(e){this._yuanshen_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanshendropNum",{get:function(){return this._yuanshendropNum},set:function(e){this._yuanshendropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanshen",{get:function(){return this._yuanshen},set:function(e){this._yuanshen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fate_percent",{get:function(){return this._fate_percent},set:function(e){this._fate_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fatedropNum",{get:function(){return this._fatedropNum},set:function(e){this._fatedropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fate",{get:function(){return this._fate},set:function(e){this._fate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baoshi_percent",{get:function(){return this._baoshi_percent},set:function(e){this._baoshi_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baoshidropNum",{get:function(){return this._baoshidropNum},set:function(e){this._baoshidropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baoshi",{get:function(){return this._baoshi},set:function(e){this._baoshi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiandan_percent",{get:function(){return this._xiandan_percent},set:function(e){this._xiandan_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiandandropNum",{get:function(){return this._xiandandropNum},set:function(e){this._xiandandropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiandan",{get:function(){return this._xiandan},set:function(e){this._xiandan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rune_percent",{get:function(){return this._rune_percent},set:function(e){this._rune_percent=e
},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"runedropNum",{get:function(){return this._runedropNum},set:function(e){this._runedropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rune",{get:function(){return this._rune},set:function(e){this._rune=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xfpoints_percent",{get:function(){return this._xfpoints_percent},set:function(e){this._xfpoints_percent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xfpointsdropNum",{get:function(){return this._xfpointsdropNum},set:function(e){this._xfpointsdropNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xfpoints",{get:function(){return this._xfpoints},set:function(e){this._xfpoints=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhuxian",{get:function(){return this._zhuxian},set:function(e){this._zhuxian=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"png",{get:function(){return this._png},set:function(e){this._png=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nandu",{get:function(){return this._nandu},set:function(e){this._nandu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._first},set:function(e){this._first=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renshuMax",{get:function(){return this._renshuMax},set:function(e){this._renshuMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhuanpanMax",{get:function(){return this._zhuanpanMax},set:function(e){this._zhuanpanMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillMax",{get:function(){return this._skillMax},set:function(e){this._skillMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill2Max",{get:function(){return this._skill2Max},set:function(e){this._skill2Max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tongyongReward",{get:function(){return this._tongyongReward},set:function(e){this._tongyongReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tongyongTitle",{get:function(){return this._tongyongTitle},set:function(e){this._tongyongTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tongyongContent",{get:function(){return this._tongyongContent},set:function(e){this._tongyongContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cangkuReward",{get:function(){return this._cangkuReward},set:function(e){this._cangkuReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guildExp",{get:function(){return this._guildExp},set:function(e){this._guildExp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"banggong",{get:function(){return this._banggong},set:function(e){this._banggong=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expMax",{get:function(){return this._expMax},set:function(e){this._expMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attPlus",{get:function(){return this._attPlus},set:function(e){this._attPlus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hpPlus",{get:function(){return this._hpPlus},set:function(e){this._hpPlus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huizhangReward",{get:function(){return this._huizhangReward},set:function(e){this._huizhangReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huizhangTitle",{get:function(){return this._huizhangTitle},set:function(e){this._huizhangTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huizhangContent",{get:function(){return this._huizhangContent},set:function(e){this._huizhangContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huiyuanReward",{get:function(){return this._huiyuanReward},set:function(e){this._huiyuanReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huiyuanTitle",{get:function(){return this._huiyuanTitle},set:function(e){this._huiyuanTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"huiyuanContent",{get:function(){return this._huiyuanContent},set:function(e){this._huiyuanContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},set:function(e){this._count=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hecheng",{get:function(){return this._hecheng},set:function(e){this._hecheng=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Eqid",{get:function(){return this._Eqid},set:function(e){this._Eqid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tujing",{get:function(){return this._tujing},set:function(e){this._tujing=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gotype",{get:function(){return this._gotype},set:function(e){this._gotype=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"taozhuangName",{get:function(){return this._taozhuangName},set:function(e){this._taozhuangName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"taozhuang",{get:function(){return this._taozhuang},set:function(e){this._taozhuang=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"damage",{get:function(){return this._damage},set:function(e){this._damage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ranking",{get:function(){return this._ranking},set:function(e){this._ranking=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiuwei",{get:function(){return this._xiuwei},set:function(e){this._xiuwei=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hpplus",{get:function(){return this._hpplus},set:function(e){this._hpplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attackplus",{get:function(){return this._attackplus},set:function(e){this._attackplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"phyDefplus",{get:function(){return this._phyDefplus},set:function(e){this._phyDefplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"magicDefplus",{get:function(){return this._magicDefplus},set:function(e){this._magicDefplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"critplus",{get:function(){return this._critplus},set:function(e){this._critplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ductplus",{get:function(){return this._ductplus},set:function(e){this._ductplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bornPoint",{get:function(){return this._bornPoint},set:function(e){this._bornPoint=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextid",{get:function(){return this._nextid},set:function(e){this._nextid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resources",{get:function(){return this._resources},set:function(e){this._resources=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boshu",{get:function(){return this._boshu},set:function(e){this._boshu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fightid",{get:function(){return this._fightid},set:function(e){this._fightid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiaoguai",{get:function(){return this._xiaoguai},set:function(e){this._xiaoguai=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chushiExp",{get:function(){return this._chushiExp},set:function(e){this._chushiExp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lan",{get:function(){return this._lan},set:function(e){this._lan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zi",{get:function(){return this._zi},set:function(e){this._zi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cheng",{get:function(){return this._cheng},set:function(e){this._cheng=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hong",{get:function(){return this._hong},set:function(e){this._hong=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eXlv",{get:function(){return this._eXlv},set:function(e){this._eXlv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eXlan",{get:function(){return this._eXlan},set:function(e){this._eXlan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eXzi",{get:function(){return this._eXzi},set:function(e){this._eXzi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eXcheng",{get:function(){return this._eXcheng},set:function(e){this._eXcheng=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eXhong",{get:function(){return this._eXhong},set:function(e){this._eXhong=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtype",{get:function(){return this._subtype},set:function(e){this._subtype=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"postion",{get:function(){return this._postion},set:function(e){this._postion=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stand_offY",{get:function(){return this._stand_offY},set:function(e){this._stand_offY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"move_offY",{get:function(){return this._move_offY},set:function(e){this._move_offY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mount_stand",{get:function(){return this._mount_stand},set:function(e){this._mount_stand=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"monut_run",{get:function(){return this._monut_run},set:function(e){this._monut_run=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p_stand",{get:function(){return this._p_stand},set:function(e){this._p_stand=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"p_run",{get:function(){return this._p_run},set:function(e){this._p_run=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openCoatard",{get:function(){return this._openCoatard},set:function(e){this._openCoatard=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fashionId",{get:function(){return this._fashionId},set:function(e){this._fashionId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rmb",{get:function(){return this._rmb},set:function(e){this._rmb=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goods",{get:function(){return this._goods},set:function(e){this._goods=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goodsName",{get:function(){return this._goodsName},set:function(e){this._goodsName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copyId",{get:function(){return this._copyId},set:function(e){this._copyId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhangong",{get:function(){return this._zhangong},set:function(e){this._zhangong=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miaoshu",{get:function(){return this._miaoshu},set:function(e){this._miaoshu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plusType",{get:function(){return this._plusType},set:function(e){this._plusType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teshuxiaoguoId",{get:function(){return this._teshuxiaoguoId},set:function(e){this._teshuxiaoguoId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coatardLimit",{get:function(){return this._coatardLimit},set:function(e){this._coatardLimit=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPk",{get:function(){return this._isPk},set:function(e){this._isPk=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fuhuotime",{get:function(){return this._fuhuotime},set:function(e){this._fuhuotime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canyuRewards",{get:function(){return this._canyuRewards},set:function(e){this._canyuRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gaiLv",{get:function(){return this._gaiLv},set:function(e){this._gaiLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addExp",{get:function(){return this._addExp},set:function(e){this._addExp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levelUpExp",{get:function(){return this._levelUpExp},set:function(e){this._levelUpExp=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"friendNumMax",{get:function(){return this._friendNumMax},set:function(e){this._friendNumMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allplus",{get:function(){return this._allplus},set:function(e){this._allplus=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"donghua",{get:function(){return this._donghua},set:function(e){this._donghua=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pic",{get:function(){return this._pic},set:function(e){this._pic=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemType",{get:function(){return this._itemType},set:function(e){this._itemType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goldprice",{get:function(){return this._goldprice},set:function(e){this._goldprice=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanbaoprice",{get:function(){return this._yuanbaoprice},set:function(e){this._yuanbaoprice=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"daojuLv",{get:function(){return this._daojuLv},set:function(e){this._daojuLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiaoguo",{get:function(){return this._xiaoguo},set:function(e){this._xiaoguo=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ewaizhanli",{get:function(){return this._ewaizhanli},set:function(e){this._ewaizhanli=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhekou",{get:function(){return this._zhekou},set:function(e){this._zhekou=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pvpLevel",{get:function(){return this._pvpLevel},set:function(e){this._pvpLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xiangoucishu",{get:function(){return this._xiangoucishu},set:function(e){this._xiangoucishu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fighterId",{get:function(){return this._fighterId},set:function(e){this._fighterId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Num",{get:function(){return this._Num},set:function(e){this._Num=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drop",{get:function(){return this._drop},set:function(e){this._drop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstRewards",{get:function(){return this._firstRewards},set:function(e){this._firstRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxRewards",{get:function(){return this._boxRewards},set:function(e){this._boxRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fangda",{get:function(){return this._fangda},set:function(e){this._fangda=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disc",{get:function(){return this._disc},set:function(e){this._disc=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bodyLayer",{get:function(){return this._bodyLayer},set:function(e){this._bodyLayer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ewai",{get:function(){return this._ewai},set:function(e){this._ewai=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"castTime",{get:function(){return this._castTime},set:function(e){this._castTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effect1",{get:function(){return this._effect1},set:function(e){this._effect1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay1",{get:function(){return this._delay1},set:function(e){this._delay1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effect2",{get:function(){return this._effect2},set:function(e){this._effect2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay2",{get:function(){return this._delay2},set:function(e){this._delay2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hurteffect",{get:function(){return this._hurteffect},set:function(e){this._hurteffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hurtdelay",{get:function(){return this._hurtdelay},set:function(e){this._hurtdelay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offY",{get:function(){return this._offY},set:function(e){this._offY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cd",{get:function(){return this._cd},set:function(e){this._cd=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dist",{get:function(){return this._dist},set:function(e){this._dist=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionIndex",{get:function(){return this._actionIndex},set:function(e){this._actionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playnum",{get:function(){return this._playnum},set:function(e){this._playnum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetType",{get:function(){return this._targetType},set:function(e){this._targetType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attackType",{get:function(){return this._attackType},set:function(e){this._attackType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rectType",{get:function(){return this._rectType},set:function(e){this._rectType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hurtType",{get:function(){return this._hurtType},set:function(e){this._hurtType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDir",{get:function(){return this._isDir},set:function(e){this._isDir=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueBase",{get:function(){return this._valueBase},set:function(e){this._valueBase=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffId",{get:function(){return this._buffId},set:function(e){this._buffId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffProb",{get:function(){return this._buffProb},set:function(e){this._buffProb=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"talk",{get:function(){return this._talk},set:function(e){this._talk=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duoduan",{get:function(){return this._duoduan},set:function(e){this._duoduan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhenping",{get:function(){return this._zhenping},set:function(e){this._zhenping=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fonteffect",{get:function(){return this._fonteffect},set:function(e){this._fonteffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill1",{get:function(){return this._skill1},set:function(e){this._skill1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill2",{get:function(){return this._skill2},set:function(e){this._skill2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill3",{get:function(){return this._skill3},set:function(e){this._skill3=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill4",{get:function(){return this._skill4},set:function(e){this._skill4=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill5",{get:function(){return this._skill5},set:function(e){this._skill5=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillId",{get:function(){return this._skillId},set:function(e){this._skillId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tupoLv",{get:function(){return this._tupoLv},set:function(e){this._tupoLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},set:function(e){this._stage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"self",{get:function(){return this._self},set:function(e){this._self=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"talktype",{get:function(){return this._talktype},set:function(e){this._talktype=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"talkwords",{get:function(){return this._talkwords},set:function(e){this._talkwords=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(e){this._score=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanjia",{get:function(){return this._yuanjia},set:function(e){this._yuanjia=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opType",{get:function(){return this._opType},set:function(e){this._opType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eqid",{get:function(){return this._eqid},set:function(e){this._eqid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(e){this._next=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tiaojian",{get:function(){return this._tiaojian},set:function(e){this._tiaojian=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jiangeTime",{get:function(){return this._jiangeTime},set:function(e){this._jiangeTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cishu",{get:function(){return this._cishu},set:function(e){this._cishu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sex",{get:function(){return this._sex},set:function(e){this._sex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"winreward",{get:function(){return this._winreward},set:function(e){this._winreward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lostre",{get:function(){return this._lostre},set:function(e){this._lostre=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"winjifen",{get:function(){return this._winjifen},set:function(e){this._winjifen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lostjifen",{get:function(){return this._lostjifen},set:function(e){this._lostjifen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxjifen",{get:function(){return this._maxjifen},set:function(e){this._maxjifen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"typeName",{get:function(){return this._typeName},set:function(e){this._typeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"donghua1",{get:function(){return this._donghua1},set:function(e){this._donghua1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"donghua2",{get:function(){return this._donghua2},set:function(e){this._donghua2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weals",{get:function(){return this._weals},set:function(e){this._weals=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isnew",{get:function(){return this._isnew},set:function(e){this._isnew=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"doubleEveryday",{get:function(){return this._doubleEveryday},set:function(e){this._doubleEveryday=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},set:function(e){this._context=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"round",{get:function(){return this._round},set:function(e){this._round=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yuanJia",{get:function(){return this._yuanJia},set:function(e){this._yuanJia=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"discount",{get:function(){return this._discount},set:function(e){this._discount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weizhi",{get:function(){return this._weizhi},set:function(e){this._weizhi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speRewards",{get:function(){return this._speRewards},set:function(e){this._speRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caoyao",{get:function(){return this._caoyao},set:function(e){this._caoyao=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhaohuanRewards",{get:function(){return this._zhaohuanRewards},set:function(e){this._zhaohuanRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jishaRewards",{get:function(){return this._jishaRewards},set:function(e){this._jishaRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jihuocost",{get:function(){return this._jihuocost},set:function(e){this._jihuocost=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"beizhu",{get:function(){return this._beizhu},set:function(e){this._beizhu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},set:function(e){this._panel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texiao",{get:function(){return this._texiao},set:function(e){this._texiao=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(e){this._target=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guishuReward",{get:function(){return this._guishuReward},set:function(e){this._guishuReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oneKeyCount",{get:function(){return this._oneKeyCount},set:function(e){this._oneKeyCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"jifen",{get:function(){return this._jifen},set:function(e){this._jifen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prices",{get:function(){return this._prices},set:function(e){this._prices=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"second",{get:function(){return this._second},set:function(e){this._second=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"third",{get:function(){return this._third},set:function(e){this._third=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waixing",{get:function(){return this._waixing},set:function(e){this._waixing=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fenjie",{get:function(){return this._fenjie},set:function(e){this._fenjie=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepday",{get:function(){return this._keepday},set:function(e){this._keepday=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"diejia",{get:function(){return this._diejia},set:function(e){this._diejia=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tequan",{get:function(){return this._tequan},set:function(e){this._tequan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rankMin",{get:function(){return this._rankMin},set:function(e){this._rankMin=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rankMax",{get:function(){return this._rankMax},set:function(e){this._rankMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uncall",{get:function(){return this._uncall},set:function(e){this._uncall=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duanwei",{get:function(){return this._duanwei},set:function(e){this._duanwei=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhuansheng",{get:function(){return this._zhuansheng},set:function(e){this._zhuansheng=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tiaojianLv",{get:function(){return this._tiaojianLv},set:function(e){this._tiaojianLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tiaojianGuanqia",{get:function(){return this._tiaojianGuanqia},set:function(e){this._tiaojianGuanqia=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duanweiRewards",{get:function(){return this._duanweiRewards},set:function(e){this._duanweiRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duanweiShuxing",{get:function(){return this._duanweiShuxing},set:function(e){this._duanweiShuxing=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zhuanshengRewards",{get:function(){return this._zhuanshengRewards},set:function(e){this._zhuanshengRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNum",{get:function(){return this._maxNum},set:function(e){this._maxNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rushTime",{get:function(){return this._rushTime},set:function(e){this._rushTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rushNum",{get:function(){return this._rushNum},set:function(e){this._rushNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numReward",{get:function(){return this._numReward},set:function(e){this._numReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tongguan",{get:function(){return this._tongguan},set:function(e){this._tongguan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxTimes",{get:function(){return this._maxTimes},set:function(e){this._maxTimes=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viprewards",{get:function(){return this._viprewards},set:function(e){this._viprewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canyurewards",{get:function(){return this._canyurewards},set:function(e){this._canyurewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepDay",{get:function(){return this._keepDay},set:function(e){this._keepDay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"restDay",{get:function(){return this._restDay},set:function(e){this._restDay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(e){this._loop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roundTime",{get:function(){return this._roundTime},set:function(e){this._roundTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openLv",{get:function(){return this._openLv},set:function(e){this._openLv=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIos",{get:function(){return this._isIos},set:function(e){this._isIos=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activityId",{get:function(){return this._activityId},set:function(e){this._activityId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imgtitle",{get:function(){return this._imgtitle
},set:function(e){this._imgtitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rewards300",{get:function(){return this._rewards300},set:function(e){this._rewards300=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao1",{get:function(){return this._mubiao1},set:function(e){this._mubiao1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao2",{get:function(){return this._mubiao2},set:function(e){this._mubiao2=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao3",{get:function(){return this._mubiao3},set:function(e){this._mubiao3=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao4",{get:function(){return this._mubiao4},set:function(e){this._mubiao4=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao5",{get:function(){return this._mubiao5},set:function(e){this._mubiao5=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward5",{get:function(){return this._reward5},set:function(e){this._reward5=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao6",{get:function(){return this._mubiao6},set:function(e){this._mubiao6=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward6",{get:function(){return this._reward6},set:function(e){this._reward6=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiao7",{get:function(){return this._mubiao7},set:function(e){this._mubiao7=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reward7",{get:function(){return this._reward7},set:function(e){this._reward7=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mubiaotitle",{get:function(){return this._mubiaotitle},set:function(e){this._mubiaotitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thirdReward",{get:function(){return this._thirdReward},set:function(e){this._thirdReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thirdTitle",{get:function(){return this._thirdTitle},set:function(e){this._thirdTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thirdContent",{get:function(){return this._thirdContent},set:function(e){this._thirdContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forthReward",{get:function(){return this._forthReward},set:function(e){this._forthReward=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forthTitle",{get:function(){return this._forthTitle},set:function(e){this._forthTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forthContent",{get:function(){return this._forthContent},set:function(e){this._forthContent=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ranktitle",{get:function(){return this._ranktitle},set:function(e){this._ranktitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ranktitledesc",{get:function(){return this._ranktitledesc},set:function(e){this._ranktitledesc=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"costTen",{get:function(){return this._costTen},set:function(e){this._costTen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapId",{get:function(){return this._mapId},set:function(e){this._mapId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rewards1000",{get:function(){return this._rewards1000},set:function(e){this._rewards1000=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstDuihuan",{get:function(){return this._firstDuihuan},set:function(e){this._firstDuihuan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherRewards",{get:function(){return this._otherRewards},set:function(e){this._otherRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherDuihuan",{get:function(){return this._otherDuihuan},set:function(e){this._otherDuihuan=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"day",{get:function(){return this._day},set:function(e){this._day=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemId",{get:function(){return this._itemId},set:function(e){this._itemId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"free",{get:function(){return this._free},set:function(e){this._free=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"costFive",{get:function(){return this._costFive},set:function(e){this._costFive=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shenqiRush",{get:function(){return this._shenqiRush},set:function(e){this._shenqiRush=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tasks",{get:function(){return this._tasks},set:function(e){this._tasks=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"privatePay",{get:function(){return this._privatePay},set:function(e){this._privatePay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"severPay",{get:function(){return this._severPay},set:function(e){this._severPay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"goldRewards",{get:function(){return this._goldRewards},set:function(e){this._goldRewards=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baoji",{get:function(){return this._baoji},set:function(e){this._baoji=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baifenbi",{get:function(){return this._baifenbi},set:function(e){this._baifenbi=e},enumerable:!0,configurable:!0}),t}(ModelJsonBase);__reflect(JsonModelTemplet.prototype,"JsonModelTemplet");var ModelBase=function(){function e(){}return e.prototype.getXmlValue=function(e,t){return e.attributes[t]},e.prototype.getXmlValueNumber=function(e,t){return parseInt(this.getXmlValue(e,t)?this.getXmlValue(e,t):0)},e.prototype.parseXML=function(e){this.id=this.getXmlValue(e,"id")},e}();__reflect(ModelBase.prototype,"ModelBase");var SkillEnchantLevelPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n.useskillTime=0,n}return __extends(t,e),Object.defineProperty(t.prototype,"mainPanel",{get:function(){return this.owner},enumerable:!0,configurable:!0}),t.prototype.onSkinName=function(){this.skinName=skins.SkillAttPanelSkin},t.prototype.onInit=function(){this.roleAvatar=new PlayerBody,this.roleAvatar.isDamageFalse=!0,this.roleAvatar.inMap=!1;var t=GameFight.getInstance().onRandomCrateRobotData(1,2),n=new AppearPlayerData;t.sex=this.playerData.sex;for(var a=0;a<BLESS_TYPE.SIZE;a++)n.appears[a]=this.playerData.getAppearID(a);t.setAppear(n),this.roleAvatar.data=t,this.roleAvatar.onHideHeadBar(!1),this.emenyAvatar=new MonsterBody,this.emenyAvatar.data=new MonsterData(FightDefine.PVE_MONSTER_COMID,BODY_TYPE.MONSTER),this.emenyAvatar.visible=!1,this.emenyAvatar.inMap=!1,this.roleAvatar.onAddEnemyBodyList([this.emenyAvatar]),this.roleAvatar.currTarget=this.emenyAvatar,this.avatar_grp.scaleX=this.avatar_grp.scaleY=.6,this.SKILL_MAX_NUM=this.playerData.skills.length;for(var i=0;i<this.SKILL_MAX_NUM;i++){var o=this.playerData.skills[i],r=this["skill_tab"+i];r.value=o.id,r.label=o.getName(),r.icon=o.getIcon(),this.points[i].register(r,GameDefine.RED_GOODSINSTANCE_POS,this,"oncheckSkillTabRedPoint",o.id)}JsonModelManager.instance.getModelxinfaLv();this.SKIN_MAX_NUM=Math.round(ModelManager.getInstance().getModelLength("xinfaLv")/this.SKILL_MAX_NUM);for(var s=1;s<=this.SKIN_MAX_NUM;s++){var h=JsonModelManager.instance.getModelxinfaLv()[s],l=this["skin_btn"+s];l.name=""+s,l.label=h.name,this.points[this.SKILL_MAX_NUM+s-1].register(l,GameDefine.RED_FASHION_ITEM_POS,this,"oncheckSKinBtnRedPoint",s)}Tool.isNumber(this.mainPanel.curSkin_ID)||(this.mainPanel.curSkill_ID=parseInt(this.skill_tab0.value),this.mainPanel.curSkinBtnIdx=parseInt(this.skin_btn1.name),this.mainPanel.curSkin_ID=1),this.updateBtnName(),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.updateBtnName=function(){this.btn_advance.label=Language.instance.getText("sixiangshengji")},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.playerData.skills.length;t++){var n=this["skill_tab"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkillTab,this)}for(var t=1;t<=this.SKIN_MAX_NUM;t++){var a=this["skin_btn"+t];a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkinBtn,this)}this.btn_active.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onActive,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdvanceHanlde,this),this.btn_cloth.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloth,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_ACTIVE_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE.toString(),this.onAdvanceReciveMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE.toString(),this.onAdvanceReciveMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.playerData.skills.length;t++){var n=this["skill_tab"+t];n.selected=!1,n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkillTab,this)}for(var t=1;t<=this.SKIN_MAX_NUM;t++){var a=this["skin_btn"+t];a.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkinBtn,this)}this.btn_active.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onActive,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdvanceHanlde,this),this.btn_cloth.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloth,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_ACTIVE_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE.toString(),this.onAdvanceReciveMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE.toString(),this.onAdvanceReciveMsg,this),this.roleAvatar.onDestroy()},t.prototype.onRefresh=function(){this["skill_tab"+(this.mainPanel.curSkill_ID-1)].selected=!0,this.onUpdateRoleAvatar(),this.onChangeSkillShow(),this.onChangeSkinHandle()},t.prototype.onUpdateRoleAvatar=function(){this.roleAvatar.onUpdateAvatar()},t.prototype.onAdvanceReciveMsg=function(){var e=new Animation("qihunshengji",1,!0);e.x=this.width/2,e.y=350,this.addChildAt(e,this.getChildIndex(this.avatar_grp)),this.onChangeSkinHandle()},t.prototype.onTouchSkillTab=function(e){var t=e.currentTarget;if(t.value!=this.mainPanel){this.mainPanel.curSkill_ID=parseInt(t.value),this.useskillTime=0;var n=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+this.mainPanel.curSkinBtnIdx;this.mainPanel.curSkin_ID=n,this.onUpdateAttribute(),this.onUpdateStatus(),this.onUpdateCost()}this.onChangeSkillShow()},t.prototype.onChangeSkillShow=function(){if(!(this.useskillTime>egret.getTimer()))switch(this.avatar_grp.removeChildren(),this.avatar_grp.addChild(this.roleAvatar),this.avatar_grp.addChild(this.emenyAvatar),this.skillInfo.styleNum=this.mainPanel.curSkin_ID,this.roleAvatar.data.onRebirth(),this.roleAvatar.onResetSkillEffect(),this.roleAvatar.y=670,this.emenyAvatar.x=this.roleAvatar.x+10,this.emenyAvatar.y=this.roleAvatar.y,this.mainPanel.curSkill_ID){case SkillDefine.COMMON_SKILL_ID:Tool.callbackTime(this.onUseSkill,this,300,this.mainPanel.curSkill_ID),Tool.callbackTime(this.onUseSkill,this,1e3,this.mainPanel.curSkill_ID),Tool.callbackTime(this.onUseSkill,this,1700,this.mainPanel.curSkill_ID),this.useskillTime=egret.getTimer()+2e3;break;default:this.onUseSkill(this.mainPanel.curSkill_ID),this.useskillTime=egret.getTimer()+1e3}},t.prototype.onUseSkill=function(e){this.mainPanel.curSkill_ID==e&&(this.roleAvatar.data.useSkill=this.skillInfo,this.roleAvatar.onAttack())},t.prototype.onTouchSkinBtn=function(e){var t=e.currentTarget,n=parseInt(t.name);this.mainPanel.curSkinBtnIdx!=n&&(this.mainPanel.curSkinBtnIdx=n,this.mainPanel.curSkin_ID=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+this.mainPanel.curSkinBtnIdx,this.onChangeSkinHandle()),this.useskillTime=0,this.onChangeSkillShow(),this.trigger()},t.prototype.onChangeSkinHandle=function(){this.changeSelectSkin(),this.onUpdateAttribute(),this.onUpdateStatus(),this.onUpdateCost()},t.prototype.onUpdateStatus=function(){var e=(JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID]),t=e?e.level:0;if(0==t)this.currentState="normal";else{this.currentState="upGrade";var n=this.playerData.getSkillInfoById(this.mainPanel.curSkill_ID);n.styleNum==this.mainPanel.curSkin_ID?this.btn_cloth.label="卸 下":this.btn_cloth.label="启 用"}},t.prototype.onUpdateAttribute=function(){for(var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],n=t?t.level:0,a=GameCommon.getInstance().getAttributeAry(),i="",o="",r=0;r<e.attrAry.length;++r){var s=e.attrAry[r];s>0&&(i=i+GameDefine.Attr_FontName[r]+"："+s*n+"\n",a[r]=s*n,o=o+GameDefine.Attr_FontName[r]+"："+s*(n+1)+"\n")}this.curPro.text=i,this.nextPro.text=o,this.powerBar.power=GameCommon.calculationFighting(a)},t.prototype.onUpdateCost=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],n=t?t.level:0;if(0==n)if(e.jihuocost){var a=GameCommon.parseAwardItem(e.jihuocost),i=GameCommon.getInstance().getThingModel(a.type,a.id);i.type==GOODS_TYPE.ITEM?this.consumItem.setCostByAwardItem(a):this.consumItem.setCostByAwardItem(e.cost),this.consumItem.visible=!0}else this.consumItem.visible=!1;else{var a=GameCommon.parseAwardItem(e.jihuocost);this.consumItem.setCostByAwardItem(a),this.consumItem.visible||(this.consumItem.visible=!0)}},t.prototype.changeSelectSkin=function(){var e=Math.floor(this.mainPanel.curSkin_ID%this.SKIN_MAX_NUM);e=0==e?this.SKIN_MAX_NUM:e;var t=this["skin_btn"+e];this.selectAnim||(this.selectAnim=new Animation("guanghuancheng",-1),this.selectAnim.rotation=45,this.selectAnim.x=47,this.selectAnim.y=52),t.addChild(this.selectAnim)},t.prototype.onActive=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e)if(e.jihuocost){var t=GameCommon.parseAwardItem(e.jihuocost);GameCommon.getInstance().onCheckItemConsume(t.id,t.num,t.type)&&DataManager.getInstance().skillEnhantM.onSendActiveMsg(this.mainPanel.curSkin_ID)}else DataManager.getInstance().skillEnhantM.onSendActiveMsg(this.mainPanel.curSkin_ID)},t.prototype.onCloth=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e){var t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID];if(t&&0!=t.level){var n=this.playerData.getSkillInfoById(this.mainPanel.curSkill_ID);n.styleNum==this.mainPanel.curSkin_ID?DataManager.getInstance().skillEnhantM.onSendClothSkinMsg(0,this.skillInfo.id):DataManager.getInstance().skillEnhantM.onSendClothSkinMsg(this.mainPanel.curSkin_ID,this.skillInfo.id)}}},t.prototype.onAdvanceHanlde=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e){var t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID];if(t&&0!=t.level){var n=4e3+100*t.level;GameCommon.getInstance().onCheckItemConsume(0,n,GOODS_TYPE.YUELI)&&DataManager.getInstance().skillEnhantM.onSendLevelUpMsg(this.mainPanel.curSkin_ID)}}},Object.defineProperty(t.prototype,"skillInfo",{get:function(){return this.roleAvatar.data.getSkillInfoById(this.mainPanel.curSkill_ID)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t.prototype.oncheckSkillTabRedPoint=function(e){for(var t=1;t<=this.SKIN_MAX_NUM;t++){var n=(e-1)*this.SKIN_MAX_NUM+t;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUplevelByIDRed(n))return!0}return!1},t.prototype.oncheckSKinBtnRedPoint=function(e){if(Tool.isNumber(this.mainPanel.curSkill_ID)){var t=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+e;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUplevelByIDRed(t))return!0}return!1},t}(BaseTabView);__reflect(SkillEnchantLevelPanel.prototype,"SkillEnchantLevelPanel");var EPlatform;!function(e){e[e.PLATFORM_NONE=0]="PLATFORM_NONE",e[e.PLATFORM_ANDROID=1]="PLATFORM_ANDROID",e[e.PLATFORM_IOS=2]="PLATFORM_IOS"}(EPlatform||(EPlatform={}));var SDK360=function(){function e(){this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="",this.GAME_DESC="",this.loginPath="login",this.checkUserPath="check_user",this.exchangePath="exchange",this.createOrderPath="create_order"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.login=function(){},e.prototype.onGetUserInfo=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.code==ChannelDefine.SUCCESS&&n.userid?(this.info.account=n.userid,this.info.nickName=n.nickname,this.loginCallback()):(egret.error("SDK360.login() failed. Error sign."),this.loginFailed())},e.prototype.pay=function(e,t){this.payContainer=t;var n={amount:e.amount,item_id:e.amount+"_"+this.info.serverId+"_"+this.info.playerId,goods_name:"钻石",qid:this.info.account,rate:e.amount,gname:"神游记"},a=ChannelDefine.createURL(this.info,this.createOrderPath,n);HttpUtil.sendGetRequest(a,this.onCreateOrder,this)},e.prototype.onCreateOrder=function(e){var t=e.currentTarget;try{egret.log("360 onCreateOrder request="+t);var n=JSON.parse(t.response);egret.log("360 onCreateOrder order="+n),n&&SDK360JS.pay(n)}catch(a){egret.error("SDK360.createOrder faied. "+a.message)}},e}();__reflect(SDK360.prototype,"SDK360",["ISDKHandler"]);var SDKAWY=function(){function e(){this.APPID=347,this.disableFocus=!1,this.loginPath="login",this.focusPath="focus",this.sharePath="share",this.shareInfoPath="shareInfo",this.giftPath="gift",this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="神游记修仙巨作",this.GAME_DESC="飞升境界，组队开黑，一起来神游修仙！",this.verify=1}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKAWYJS.init(this.APPID,this.shareSuccessCallback),SDKAWYJS.shareParams(this.GAME_DESC,this.GAME_TITLE,this.logoUrl)},e.prototype.login=function(){var e=SDKUtil.getQueryString("token"),t=(SDKUtil.getQueryString("fuid"),SDKUtil.getQueryString("focus"),"1"==SDKUtil.getQueryString("disableFocus"),ChannelDefine.createURL(this.info,this.loginPath,{userToken:e}));HttpUtil.sendGetRequest(t,this.onGetAppSigComplete,this)},e.prototype.onGetAppSigComplete=function(e){var t=e.currentTarget,n=JSON.parse(t.response);!n.ret&&n.uid?(this.info.account=n.uid,this.info.nickName=decodeURI(n.nickname),this.info.focus=n.focus,this.info.disableFocus=this.disableFocus,this.loginCallback()):(SDKAWYJS.logout(),this.loginFailed())},e.prototype.onEnterGame=function(e,t){var n=SDKUtil.getQueryString("verify");if(n&&"1"==n){var a=this.getGiftInfo(1);egret.log("onEnterGame get url="+a),HttpUtil.sendGetRequest(a,this.giftCallback,this)}if(this.info.focus){var i=ChannelDefine.createURL(this.info,this.focusPath,{uid:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId});HttpUtil.sendGetRequest(i,null,this)}},e.prototype.giftCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);if(egret.log("giftCallback:"+n),"2"==n){var a=new Message(MESSAGE_ID.VERIFY_GIFT);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}},e.prototype.pay=function(t,n){var a=this.info.serverId+"*"+this.info.playerId;a=encodeURI(a);var i=e.GOODS_DEFINE[t.amount],o={userdata:a,pid:i,txid:""};SDKAWYJS.pay(o)},e.prototype.subscribe=function(){SDKAWYJS.subscribe()},e.prototype.share=function(e){this.shareContainer=e,SDKAWYJS.share()},e.prototype.requestShareInfo=function(){function t(t){var n=t.currentTarget,a=JSON.parse(n.response),i=e.parseShareInfo(a);i&&this.shareContainer.showShareInfo(i)}var n={};n.uid=this.info.account;var a=ChannelDefine.createURL(this.info,this.shareInfoPath,n);HttpUtil.sendGetRequest(a,t,this)},e.parseShareInfo=function(e){if(e.ret&&e.ret!=ChannelDefine.SUCCESS)return egret.error("SDKAWY.parseShareInfo() return failed."),null;var t=e.share_cd,n=e.share_reward_times,a=e.share_total_times,i=e.share_reward_diamond,o={cd:t,dailyTimes:n,totalTimes:a,rewardDiamond:i};return o},e.prototype.shareSuccessCallback=function(t){var n=e.getInstance().shareContainer;n.shareComplete()},e.prototype.doCheckVerify=function(){SDKAWYJS.verify(this.verifyCallback)},e.prototype.verifyCallback=function(t){egret.log(t),t&&(e.getInstance().verify=t.error,egret.log(this.verify));var n=new Message(MESSAGE_ID.VERIFY_GIFT);n.setByte(0),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.getGiftInfo=function(e){var t=ChannelDefine.createURL(this.info,this.giftPath,{account:this.info.account,check:e+""});return t},e.GOODS_DEFINE={1:11368,10:11369,20:11370,28:11371,50:11463,88:11464,99:11465,100:11466,198:11467,200:11468,500:11469,1e3:11470,1500:11471,2e3:11472,3e3:11473},e}();__reflect(SDKAWY.prototype,"SDKAWY",["ISDKHandler"]);var SDKCrazy=function(){function e(){this.appId="syj",this.logoUrl="http://cdn.ih5games.com/ZEROKRGAME/logo.png",this.GAME_TITLE="神游记修仙巨作",this.GAME_DESC="飞升境界，组队开黑，一起来神游修仙！",this.loginPath="login",this.orderPath="order",this.sharePath="share",this.focusPath="focus",this.shareInfoPath="shareInfo",this.createRolePath="create"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.TimelineConfig={title:this.GAME_TITLE,imgUrl:this.logoUrl,success:this.shareCallback,cancel:this.shareCancel},this.FriendConfig={title:this.GAME_TITLE,desc:this.GAME_DESC,imgUrl:this.logoUrl,success:this.shareFriendCallback,cancel:this.shareFriendCancel},SDKCrazyJS.init(this.appId,this.TimelineConfig,this.FriendConfig,this.payCallback)},e.prototype.login=function(){var t=e.LoginParamName,n={},a="";for(var i in t){var o=t[i];n[i]=SDKUtil.getDecodedString(o),a+=o+"="+n[i]+","}this.checkLogin(n)},e.prototype.checkLogin=function(t){function n(n){var a=n.currentTarget,i=JSON.parse(a.response);ChannelDefine.checkResult(i)?(e.getInstance().updateLoginInfo(t),this.loginCallback()):(egret.error("SDKCrazy.login() failed. Error sign."),this.loginFailed())}var a=e.LoginParamName,i={};i[a.friendCode]=encodeURI(t[a.friendCode]),i[a.userId]=encodeURI(t[a.userId]),i[a.time]=encodeURI(t[a.time]),i[a.sign]=encodeURI(t[a.sign]);var o=ChannelDefine.createURL(this.info,this.loginPath,i);egret.log("SDKCrazy.checkLogin whit url="+o),HttpUtil.sendGetRequest(o,n,this)},e.prototype.updateLoginInfo=function(t){var n=(this.info,e.LoginParamName);this.info.account=t[n.userId],this.info.nickName=t[n.userName],this.info.sex=t[n.userSex],this.info.focus="true"==t[n.isSubscribe],this.info.shareCode=t[n.shareCode],this.info.friendCode=t[n.friendCode]},e.prototype.pay=function(e,t){function n(e){var t=e.currentTarget,n=JSON.parse(t.response);SDKCrazyJS.pay(n)}var a=100*e.amount,i=10*e.amount,o=encodeURI(e.goodsName+"x"+i),r=this.info.serverId+"*"+this.info.playerId+"*"+a;r=encodeURI(r);var s={goodsId:"1",goodsName:o,userId:this.info.account,ext:r},h=ChannelDefine.createURL(this.info,this.orderPath,s);HttpUtil.sendGetRequest(h,n,this)},e.prototype.payCallback=function(){},e.prototype.share=function(e){this.shareContainer=e,this.requestShareInfo()},e.prototype.requestShareInfo=function(){function t(t){var n=t.currentTarget,a=JSON.parse(n.response);egret.log("onShareInfoReceived success result="+a);var i=e.parseShareInfo(a);i&&this.shareContainer.showShareInfo(i)}var n={};n[e.LoginParamName.userId]=this.info.account;var a=ChannelDefine.createURL(this.info,this.shareInfoPath,n);HttpUtil.sendGetRequest(a,t,this)},e.parseShareInfo=function(e){if(e.ret&&e.ret!=ChannelDefine.SUCCESS)return egret.error("SDKCrazy.parseShareInfo() return failed."),null;var t=e.share_cd,n=e.share_reward_times,a=e.share_total_times,i=e.share_reward_diamond,o={cd:t,dailyTimes:n,totalTimes:a,rewardDiamond:i};return o},e.prototype.shareCallback=function(){e.getInstance().requestShareReward()},e.prototype.shareCancel=function(){},e.prototype.shareFriendCallback=function(){e.getInstance().shareCallback()},e.prototype.shareFriendCancel=function(){e.getInstance().shareCancel()},e.prototype.requestShareReward=function(){this.shareContainer.shareComplete()},e.prototype.onShareComplete=function(t){var n=t.currentTarget,a=JSON.parse(n.response);if(!a.ret){var i=e.parseShareInfo(a);if(i){var o=this.shareContainer;o.updateShareInfo(i)}}},e.prototype.subscribe=function(){SDKCrazyJS.subscribe()},e.prototype.onEnterGame=function(e,t){if(Boolean(this.info.focus)){var n=ChannelDefine.createURL(this.info,this.focusPath,{userId:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId});HttpUtil.sendGetRequest(n,null,this)}},e.prototype.onCreateRole=function(e,t){if(egret.log("疯狂 onCreateRole（）"),t){var n=ChannelDefine.createURL(this.info,this.createRolePath,{user_id:this.info.account,server_id:this.info.serverId,sign:this.info.sign,player_name:t.name});Tool.log("疯狂新增建角记录"+n),HttpUtil.sendGetRequest(n,null,this)}},e.LoginParamName={userName:"userName",userSex:"userSex",time:"time",channel:"channel",sign:"sign",userId:"userId",userImg:"userImg",isSubscribe:"isSubscribe",shareCode:"shareCode",friendCode:"friendCode",loginPlatform:"loginPlatform"},e}();__reflect(SDKCrazy.prototype,"SDKCrazy",["ISDKHandler"]);var SDKEgret=function(){function e(){this.APPID=91284,this.loginPath="login",this.focusPath="focus"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},Object.defineProperty(e.prototype,"spid",{get:function(){return this._spid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSupportShare",{get:function(){return this._isSupportShare},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.login=function(){this._spid=SDKUtil.getQueryString("egret.runtime.spid"),this._platform=SDKUtil.getQueryString("egretPlat");var e=SDKUtil.getQueryString("adId");if(e){var t={adFrom:e,deviceId:SDKUtil.getQueryString("deviceId"),mac:SDKUtil.getQueryString("mac"),imei:SDKUtil.getQueryString("imei"),wd:SDKUtil.getQueryString("wd"),netType:SDKUtil.getQueryString("netType"),brand:SDKUtil.getQueryString("brand"),model:SDKUtil.getQueryString("model"),spid:this._spid};this.info.adFrom=t}var n={};n.egretAppId=this.APPID,n.version=2,n.debug=!1;var a=this;nest.easyuser.startup(n,function(e){0==e.result?a.loginType():a.loginFailed()})},e.prototype.loginType=function(){var e=nest.easyuser.getLoginTypes();e.length||nest.easyuser.login({},this.onLoginCallback.bind(this))},e.prototype.onLoginCallback=function(e){if(0==e.result){var t=ChannelDefine.createURL(this.info,this.loginPath,{token:e.token});HttpUtil.sendGetRequest(t,this.onGetUserInfoCallback,this)}else alert("登录失败"),location.reload()},e.prototype.onGetUserInfoCallback=function(e){var t=this;nest.app.isSupport({},function(e){t.info.focus=1==e.attention?!1:!0,t.attention=e.attention}),nest.share.isSupport({},function(e){t._isSupportShare=e.share});var n=e.currentTarget,a=JSON.parse(n.response);this.info.account=a.data.id,this.info.nickName=a.data.name,this.info.avatarUrl=a.data.pic,this.loginCallback()},e.prototype.pay=function(t,n){var a;a=this.info.adFrom?{playerId:this.info.playerId,chanId:this.info.adFrom.spid,adId:this.info.adFrom.adFrom,level:t.playerInfo.level,goodsName:t.goodsName}:{playerId:this.info.playerId};var i={};if(i.goodsId=e.GOODS_DEFINE[t.amount],this.isIOS22698()){var o=this.getIOS22698(parseInt(t.amount.toString()));i.goodsId=e.GOODS_DEFINE[o]}i.goodsNumber="1",i.serverId=this.info.serverId,i.ext=JSON.stringify(a),nest.iap.pay(i,function(e){0==e.result?console.log("pay success"):-1==e.result?console.log("pay cancel"):-3==e.result?console.log("pay exit"):console.log("pay fail")})},e.prototype.subscribe=function(){var e=this;nest.app.attention({},function(t){0==t.result?e.sendFocus():-1==t.result||-3==t.result})},e.prototype.sendFocus=function(){var e=ChannelDefine.createURL(this.info,this.focusPath,{uid:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId});HttpUtil.sendGetRequest(e,null,this)},e.prototype.onEnterGame=function(e,t){try{nest.role.isSupport({},function(n){var a=(1==n.create,1==n.report);1==n.update;if(a){var i={};i.serverId=e.serverId,i.serverName="",i.nickName=e.nickName?e.nickName:"",i.roleId=t.id,i.roleName=t.name,i.level=t.level,nest.role.report(i,function(e){0==e.result?Tool.log("nest.role.report()."):-3==e.result?Tool.log("nest.role.report() failed. result=-3"):Tool.log("nest.role.report() failed. result="+e.result)})}})}catch(n){egret.log(n.message)}2==this.attention&&this.sendFocus()},e.prototype.onCreateRole=function(e,t){try{nest.role.isSupport({},function(n){var a=1==n.create;1==n.report,1==n.update;if(a){var i={};i.serverId=e.serverId,i.serverName="",i.nickName=e.nickName?e.nickName:"",i.roleId=t.id,i.roleName=t.name,i.level=t.level,nest.role.create(i,function(e){0==e.result?Tool.log("nest.createRole.createRole()."):-3==e.result?Tool.log("nest.createRole.createRole() failed. result=-3"):Tool.log("nest.createRole.createRole() failed. result="+e.result)})}})}catch(n){egret.log(n.message)}},e.prototype.onLevelup=function(e,t){try{nest.role.isSupport({},function(n){var a=(1==n.create,1==n.report,1==n.update);if(a){var i={};i.serverId=e.serverId,i.serverName="",i.nickName=e.nickName?e.nickName:"",i.roleId=t.id,i.roleName=t.name,i.level=t.level,nest.role.update(i,function(e){0==e.result?Tool.log("nest.role.update()."):-3==e.result?Tool.log("nest.role.update() failed. result=-3"):Tool.log("nest.role.update() failed. result="+e.result)})}})}catch(n){egret.log(n.message)}},e.prototype.share=function(e){var t={};t.title="神游记修仙巨作",t.description="飞升境界，组队开黑，一起来神游修仙！",t.url="",t.imageUrl="";var n=this;if(22373==n._spid)try{return void(window.DakaShareSuccess=e.shareComplete)}catch(a){egret.error(a.message)}nest.share.share(t,function(t){0==t.result?10016!=n.spid&&e.shareComplete():-1==t.result||-3==t.result})},e.prototype.isIOS22698=function(){return 22698==this._spid&&"ios_micro"==this._platform?!0:!1},e.prototype.getIOS22698=function(e){switch(e){case 10:e=6;break;case 20:e=18;break;case 100:e=98;break;case 200:e=198;break;case 500:e=488;break;case 1e3:e=998;break;case 2e3:e=1998;break;case 28:e=30}return e},e.GOODS_DEFINE={10:2,20:3,50:4,100:5,200:6,500:7,1e3:8,2e3:9,28:10,88:11,6:12,18:13,98:14,198:15,488:16,998:17,1998:18,30:19},e}();__reflect(SDKEgret.prototype,"SDKEgret",["ISDKHandler"]);var SDKEZ=function(){function e(){this.payPath="create_order",this.focusPath="focus",this.isSupportShare=!1}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKEZJS.setGameMusic(this.comeBackGame,this.underHomeButton),this.isSupportShare=SDKEZJS.setShareInfo(e.shareData,this.shareSuccessCallback)},e.prototype.setShareInfoCallBack=function(e){egret.log(e)},e.prototype.share=function(t){this.shareContainer=t,SDKEZJS.doShare(e.shareData,this.shareSuccessCallback)},e.prototype.shareSuccessCallback=function(t){egret.log("SDKEZ 分享成功 ret="+t);var n=e.getInstance().shareContainer;n.shareComplete()},e.prototype.underHomeButton=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)
},e.prototype.comeBackGame=function(){SoundFactory.playMusic(SoundDefine.SOUND_BGM)},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){if(this.info.focus){var n=ChannelDefine.createURL(this.info,this.focusPath,{uid:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId,subChannel:e.subChannel});HttpUtil.sendGetRequest(n,null,this)}},e.prototype.pay=function(e,t){this.payContainer=t;var n=ChannelDefine.createURL(this.info,this.payPath,{feeid:e.amount,fee:100*e.amount,feename:e.goodsName,extradata:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,serverid:this.info.serverId,rolename:e.playerInfo.name,roleid:this.info.playerId,servername:"神游记"+this.info.serverId});HttpUtil.sendGetRequest(n,this.createOrderCallback,this)},e.prototype.createOrderCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);egret.log(n),SDKEZJS.pay(n,this.payCallback)},e.prototype.payCallback=function(e){},e.prototype.subscribe=function(){SDKEZJS.doFocus(null,null),10233==this.info.subChannel},e.prototype.onCreateRole=function(e,t){var n={datatype:2,serverid:this.info.serverId,servername:"神游记"+this.info.serverId+"服",roleid:t.id,rolename:t.name,rolelevel:t.level,fightvalue:4396,moneynum:t.gold,rolecreatetime:(new Date).getTime(),rolelevelmtime:(new Date).getTime(),gender:t.sex,professionid:0,profession:"0",vip:0,partyid:1,partyname:"神游机 ",partyroleid:7,partyrolename:"神游机",friendlist:[{"roleid ":"0","intimacy ":"100","nexusid ":"6 "}]};SDKEZJS.reportRoleStatus(n)},e.prototype.uploadGameRoleInfo=function(e,t){var n={datatype:4,serverid:this.info.serverId,servername:"神游记"+this.info.serverId+"服",roleid:e.id,rolename:e.name,rolelevel:e.level,fightvalue:4396,moneynum:e.gold,rolecreatetime:e.createTime,rolelevelmtime:(new Date).getTime(),gender:e.sex,professionid:0,profession:"0",vip:e.viplevel,partyid:1,partyname:"神游机 ",partyroleid:7,partyrolename:"神游机",friendlist:[{"roleid ":"0","intimacy ":"100","nexusid ":"6 "}]};SDKEZJS.reportRoleStatus(n)},e.shareData={title:"神游记",content:"飞升境界，组队开黑，一起来神游修仙！",imgurl:"http://cdn.ih5games.com/ZXFML/logo1005.png",ext:"1018"},e}();__reflect(SDKEZ.prototype,"SDKEZ",["ISDKHandler"]);var SDKHUIYOU=function(){function e(){}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.share=function(e){},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){var n=(new Date).getTime(),a={orderid:this.info.serverId+"_"+this.info.playerId+"_"+e.amount+"_"+n,price:100*e.amount,goodsname:e.goodsName,ext:this.info.serverId+"_"+this.info.playerId+"_"+e.amount};SDKHUIYOUJS.pay(a)},e.prototype.subscribe=function(){},e.prototype.onCreateRole=function(e,t){},e}();__reflect(SDKHUIYOU.prototype,"SDKHUIYOU",["ISDKHandler"]);var ArenaData=function(){function e(){this.enemyList=[],this.serverRankDatas=[]}return e.prototype.parseMsg=function(e){try{this.isOpen=1==e.getByte(),this.lefttime=e.getInt(),this.lefttime=this.lefttime>0?1e3*this.lefttime+egret.getTimer():0,this.rank=e.getByte();var t=e.getByte();this.serverRankDatas=[];for(var n=0;t>n;n++)this.serverRankDatas.push(e.getString());this.fightCount=e.getInt(),this.buyCount=e.getInt(),this.parseEnmeyMsg(e)}catch(a){}},e.prototype.parseEnmeyMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){this.enemyList.length<=n&&this.enemyList.push(new ArenaEnemy);var a=this.enemyList[n];a.parseMsg(e)}},e}();__reflect(ArenaData.prototype,"ArenaData");var ArenaEnemy=function(){function e(){this.playerData=new SimplePlayerData,this.showAppear=new AppearPlayerData}return e.prototype.parseMsg=function(e){this.playerData.parseMsg(e),this.rank=e.getInt(),this.value1=GameCommon.getInstance().getFormatNumberShow(e.getLong()),this.value2=GameCommon.getInstance().getFormatNumberShow(e.getInt()),this.showAppear.parseMsg(e)},e}();__reflect(ArenaEnemy.prototype,"ArenaEnemy");var ArenaRankData=function(){function e(){this.playerData=new SimplePlayerData}return e.prototype.parseMsg=function(e){this.serverId=e.getShort(),this.playerData.parseMsg(e)},e}();__reflect(ArenaRankData.prototype,"ArenaRankData");var ArenaHistoryData=function(){function e(){}return e.prototype.parseMsg=function(e){this.type=e.getByte(),this.timestr=e.getString(),this.targetName=e.getString(),this.result=e.getByte(),this.changeRank=e.getInt()},e}();__reflect(ArenaHistoryData.prototype,"ArenaHistoryData");var SDKJinBang=function(){function e(){this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="",this.GAME_DESC="",this.loginPath="login",this.focusPath="focus",this.createOrderPath="createOrder",this.sharePath="share",this.shareInfoPath="shareInfo"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.shareSuccessCallback=function(t){var n=e.getInstance().shareContainer;n.shareComplete()},e.prototype.init=function(){var t={title:this.GAME_TITLE,desc:this.GAME_DESC,imgUrl:this.logoUrl,success:this.shareSuccessCallback,cancel:function(){}},n={title:this.GAME_TITLE,imgUrl:this.logoUrl,success:this.shareSuccessCallback,cancel:function(){}},a={success:function(){var t=e.getInstance().payContainer;t&&t.showTips("支付成功")},cancel:function(){var t=e.getInstance().payContainer;t&&t.showTips("支付取消")}},i={share:{friend:t,timeline:n},pay:a};SDKJinBangJS.init(i)},e.prototype.login=function(){var e=SDKUtil.getQueryString("access_token"),t=ChannelDefine.createURL(this.info,this.loginPath,{access_token:e});HttpUtil.sendGetRequest(t,this.onGetUserInfo,this)},e.prototype.onGetUserInfo=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.code==ChannelDefine.SUCCESS&&n.userid?(this.info.account=n.userid,this.info.nickName=n.nickname,this.loginCallback()):(egret.error("SDKJinBang.login() failed. Error sign."),this.loginFailed())},e.prototype.onEnterGame=function(e,t){var n=ChannelDefine.createURL(this.info,this.focusPath,{user_identify:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId});HttpUtil.sendGetRequest(n,this.onGetFocus,this)},e.prototype.onGetFocus=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.ret==ChannelDefine.SUCCESS&&(this.info.focus=!0)},e.prototype.pay=function(e,t){this.payContainer=t,this.requestOrder(e)},e.prototype.requestOrder=function(e){var t=this.info.serverId+"*"+this.info.playerId;t=encodeURI(t);var n={out_trade_no:"",product_id:"",total_fee:100*e.amount,body:e.goodsName,detail:"",attach:t,sign:""},a=ChannelDefine.createURL(this.info,this.createOrderPath,n);HttpUtil.sendGetRequest(a,this.onCreateOrder,this)},e.prototype.onCreateOrder=function(e){var t=e.currentTarget;try{var n=JSON.parse(t.response);n&&n.out_trade_no&&SDKJinBangJS.pay(n)}catch(a){egret.error("SDKJinBang.createOrder faied. "+a.message)}},e.prototype.subscribe=function(){SDKJinBangJS.focus()},e.prototype.share=function(e){this.shareContainer=e},e.prototype.requestShareInfo=function(){function t(t){var n=t.currentTarget,a=JSON.parse(n.response),i=e.parseShareInfo(a);i&&this.shareContainer.showShareInfo(i)}var n={};n.uid=this.info.account;var a=ChannelDefine.createURL(this.info,this.shareInfoPath,n);HttpUtil.sendGetRequest(a,t,this)},e.parseShareInfo=function(e){if(e.ret&&e.ret!=ChannelDefine.SUCCESS)return egret.error("SDKJinBang.parseShareInfo() return failed."),null;var t=e.share_cd,n=e.share_reward_times,a=e.share_total_times,i=e.share_reward_diamond,o={cd:t,dailyTimes:n,totalTimes:a,rewardDiamond:i};return o},e.prototype.requestShareReward=function(){var t=e.getInstance().info,n=e.getInstance().sharePath,a=ChannelDefine.createURL(t,n,{uid:t.account,server_id:t.serverId,player_id:t.playerId});HttpUtil.sendGetRequest(a,this.onShareComplete,this)},e.prototype.onShareComplete=function(t){var n=t.currentTarget,a=JSON.parse(n.response);if(!a.ret){var i=e.parseShareInfo(a);if(i){var o=this.shareContainer;o.updateShareInfo(i)}}},e}();__reflect(SDKJinBang.prototype,"SDKJinBang",["ISDKHandler"]);var SDKKAOPU=function(){function e(){this.loginPath="login",this.payPath="pay",this.balancePath="balance"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKKAOPUJS.addShareEventListener(this.shareCallback)},e.prototype.shareCallback=function(t){if(1==t.success){var n=e.getInstance().shareContainer;n.shareComplete()}},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){this.payContainer=t;var n={orderid:this.info.serverId+"_"+this.info.playerId+"_"+e.amount+"_"+(new Date).getTime(),itemsid:e.amount,itemsname:e.goodsName,amount:.01};SDKKAOPUJS.pay(n,this.payCallback)},e.prototype.payCallback=function(){egret.log("支付成功")},e.prototype.requestPay=function(e){},e.prototype.share=function(e){this.shareContainer=e,SDKKAOPUJS.doSetCustomShareData()},e.prototype.onCreateRole=function(e,t){var n={datatype:0,rolename:t.name,uopenid:e.account,gameserver:"",gameserverid:e.serverId,rolelevel:"1",rolecombatval:3700};SDKKAOPUJS.doCreateRole(n)},e}();__reflect(SDKKAOPU.prototype,"SDKKAOPU",["ISDKHandler"]);var SDKNeZha=function(){function e(){this.payPath="create_order"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.share=function(e){},e.prototype.shareSuccessCallback=function(){},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){this.payContainer=t;var n={order_id:this.info.serverId+"_"+this.info.playerId+"_"+e.amount+"_"+(new Date).getTime(),goods_name:e.goodsName,amount:e.amount,ext:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,product_id:e.amount};SDKNeZhaJS.pay(n)},e.prototype.subscribe=function(){},e.prototype.onCreateRole=function(e,t){},e}();__reflect(SDKNeZha.prototype,"SDKNeZha",["ISDKHandler"]);var SDKQH=function(){function e(){this.payPath="create_order",this.focusPath="focus",this.gid="3946"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.share=function(e){this.shareContainer=e,SDKQHJS.doShare(this.shareSuccessCallback)},e.prototype.shareSuccessCallback=function(){var t=e.getInstance().shareContainer;t.shareComplete()},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){if(this.info.focus){var n=ChannelDefine.createURL(this.info,this.focusPath,{uid:this.info.account,server_id:this.info.serverId,player_id:this.info.playerId,subChannel:e.subChannel});HttpUtil.sendGetRequest(n,null,this)}},e.prototype.pay=function(e,t){this.payContainer=t;var n=ChannelDefine.createURL(this.info,this.payPath,{userId:this.info.account,gid:this.gid,roleName:e.playerInfo.name,goodsId:e.amount,goodsName:e.goodsName,money:e.amount,ext:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,serverId:this.info.serverId});HttpUtil.sendGetRequest(n,this.createOrderCallback,this)},e.prototype.createOrderCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);egret.log("群黑充值订单内容"+t.response),SDKQHJS.pay(n,this.payCallback)},e.prototype.payCallback=function(e){},e.prototype.subscribe=function(){SDKQHJS.doFocus()},e.prototype.onCreateRole=function(e,t){var n={act:"1",serverid:this.info.serverId,rolename:t.name,roleid:t.id,level:"1"};SDKQHJS.reportRoleStatus(n)},e.prototype.uploadGameRoleInfo=function(e,t){var n={act:"2",serverid:this.info.serverId,rolename:e.name,roleid:e.id,level:"1"};SDKQHJS.reportRoleStatus(n)},e}();__reflect(SDKQH.prototype,"SDKQH",["ISDKHandler"]);var SDKQuick=function(){function e(){this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="",this.GAME_DESC="",this.productCode="05425578266356246482673853629430",this.loginPath="login",this.checkUserPath="check_user",this.exchangePath="exchange"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKQuickJS.setOnResumeNotification(this.comeBackGame),SDKQuickJS.setOnStopNotification(this.underHomeButton)},e.prototype.login=function(){},e.prototype.underHomeButton=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)},e.prototype.comeBackGame=function(){SoundFactory.playMusic(SoundDefine.SOUND_BGM)},e.prototype.onGetUserInfo=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.code==ChannelDefine.SUCCESS&&n.userid?(this.info.account=n.userid,this.info.nickName=n.nickname,this.loginCallback()):(egret.error("SDKQuick.login() failed. Error sign."),this.loginFailed())},e.prototype.pay=function(e,t){this.payContainer=t;var n=(ChannelDefine.createURL(this.info,this.exchangePath,null),{productCode:this.productCode,uid:this.info.account,userRoleId:this.info.playerId,userRoleName:this.info.gamename,userServer:this.info.serverId,userLevel:e.playerInfo.level,cpOrderNo:"hafdwioahfiabwfojow",amount:e.amount,subject:e.goodsName,desc:"钻石",callbackUrl:"",extrasParams:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,goodsId:e.amount,count:1,quantifier:"份"}),a=JSON.stringify(n);SDKQuickJS.pay(a)},e.prototype.onCreateRole=function(e,t){var n={isCreateRole:!0,roleCreateTime:(new Date).getTime(),serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:t.name,userRoleId:t.id,userRoleBalance:t.gold,vipLevel:0,userRoleLevel:t.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:1250,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e.prototype.uploadGameRoleInfo=function(e,t){var n={isCreateRole:t,roleCreateTime:e.createTime,serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:e.name,userRoleId:e.id,userRoleBalance:e.gold,vipLevel:e.viplevel,userRoleLevel:e.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:e.playerTotalPower,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e}();__reflect(SDKQuick.prototype,"SDKQuick",["ISDKHandler"]);var SDKShenQi=function(){function e(){this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="",this.GAME_DESC="",this.productCode="54691280226976290481495087372468",this.loginPath="login",this.checkUserPath="check_user",this.exchangePath="exchange"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKQuickJS.setOnResumeNotification(this.comeBackGame),SDKQuickJS.setOnStopNotification(this.underHomeButton)},e.prototype.login=function(){},e.prototype.underHomeButton=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)},e.prototype.comeBackGame=function(){SoundFactory.playMusic(SoundDefine.SOUND_BGM)},e.prototype.onGetUserInfo=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.code==ChannelDefine.SUCCESS&&n.userid?(this.info.account=n.userid,this.info.nickName=n.nickname,this.loginCallback()):(egret.error("SDKQuick.login() failed. Error sign."),this.loginFailed())},e.prototype.pay=function(e,t){this.payContainer=t;var n=(ChannelDefine.createURL(this.info,this.exchangePath,null),{productCode:this.productCode,uid:this.info.account,userRoleId:this.info.playerId,userRoleName:this.info.gamename,userServer:this.info.serverId,userLevel:e.playerInfo.level,cpOrderNo:"hafdwioahfiabwfojow",amount:e.amount,subject:e.goodsName,desc:"元宝",callbackUrl:"",extrasParams:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,goodsId:e.amount,count:1,quantifier:"份"}),a=JSON.stringify(n);SDKQuickJS.pay(a)},e.prototype.onCreateRole=function(e,t){var n={isCreateRole:!0,roleCreateTime:(new Date).getTime(),serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:t.name,userRoleId:t.id,userRoleBalance:t.gold,vipLevel:0,userRoleLevel:t.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:1250,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e.prototype.uploadGameRoleInfo=function(e,t){var n={isCreateRole:t,roleCreateTime:e.createTime,serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:e.name,userRoleId:e.id,userRoleBalance:e.gold,vipLevel:e.viplevel,userRoleLevel:e.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:e.playerTotalPower,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e}();__reflect(SDKShenQi.prototype,"SDKShenQi",["ISDKHandler"]);var SDKVIVO=function(){function e(){this.loginPath="login",this.payPath="create_order",this.appid="618d62357303afef631e21c908cbdb86"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKVIVOJS.logout(this.underHomeButton)},e.prototype.login=function(){},e.prototype.underHomeButton=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)},e.prototype.comeBackGame=function(){SoundFactory.playMusic(SoundDefine.SOUND_BGM)},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){this.payContainer=t;var n=ChannelDefine.createURL(this.info,this.payPath,{goodsName:e.goodsName,amount:e.amount,serverId:this.info.serverId,playerId:this.info.playerId});HttpUtil.sendGetRequest(n,this.createOrderCallback,this)},e.prototype.createOrderCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);if(n){var a=JSON.parse(n.ret);if("200"==a.respCode){var i={productName:"元宝",productDes:"元宝",productPrice:a.orderAmount,vivoSignature:a.accessKey,appId:this.appid,transNo:a.orderNumber,uid:this.info.account};SDKVIVOJS.pay(i)}}},e}();__reflect(SDKVIVO.prototype,"SDKVIVO",["ISDKHandler"]);var SDKWanBa=function(){function e(){this.APPID="1106712754",this.loginPath="login",this.balancePath="balance",this.payPath="pay",this.giftPath="gift",this.logoUrl="http://cdn.ih5games.com/ZXFML/logo1005.png",this.GAME_TITLE="神游记修仙巨作",this.GAME_DESC="飞升境界，组队开黑，一起来神游修仙！",this.boxId=null,this.giftOK=!0}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){var e="iOS"==egret.Capabilities.os,t=this.logoUrl+"?v="+Math.floor(1e4*Math.random());this.SHARE_OPTION={title:this.GAME_TITLE,desc:this.GAME_DESC,image:t,isIphone:e},this.SHOTCUT_OPTION={title:SDKManager.gamename,image:t},SDKWanBaJS.init(this.SHARE_OPTION,this.SHOTCUT_OPTION),SDKWanBaJS.setOnShareHandler(this.SHARE_OPTION,this.shareCallback);var n=SDKWanBaJS.getOpenDataSync();this.openid=n.openid,this.openkey=this.getParamFromeUrl(n.appurl),this.pf=n.pf,this.platform=n.platform},e.prototype.login=function(){var e=SDKWanBaJS.getOpenDataSync();egret.log(e),this.openid=e.openid,this.openkey=this.getParamFromeUrl(e.appurl),this.pf=e.pf,this.platform=e.platform,this.gift=SDKUtil.getQueryString("GIFT");var t=ChannelDefine.createURL(this.info,this.loginPath,{openid:this.openid,openkey:this.openkey,pf:this.pf});HttpUtil.sendGetRequest(t,this.onGetUserInfoComplete,this)},e.prototype.getParamFromeUrl=function(e){var t="",n="openkey=",a=e.lastIndexOf(n),i=e.substring(a).indexOf("&");return t=e.substring(a+n.length,a+i)},e.prototype.onGetUserInfoComplete=function(e){var t=e.currentTarget,n=JSON.parse(t.response);if(n.ret)this.loginFailed();else{this.info.account=this.openid,this.info.nickName=decodeURI(n.nickname),this.info.platform=this.platform,this.loginCallback();try{SDKWanBaJS.register()}catch(a){Tool.log("Register report failed:"+a.message)}}},e.prototype.onEnterGame=function(e,t){try{SDKWanBaJS.login()}catch(n){Tool.log("Login report failed:"+n.message)}},e.prototype.pay=function(t,n){try{var a=this,i=function(i){var o=i.currentTarget,r=JSON.parse(o.response);if(0!=r.code)return void n.showTips("支付失败:"+r.code+","+r.msg);var s=r.data[0].score,h=t.amount,l=function(){n.showTips("支付失败")},g=function(){var i=a.platform==EPlatform.PLATFORM_ANDROID?e.ZONE1_GOODS_DEFINE[t.amount]:e.ZONE2_GOODS_DEFINE[t.amount];a.requestPay(i,n)},c=function(){n.showTips("支付取消")},p=10*h;if(p>s)SDKWanBaJS.pay({defaultScore:p,appid:a.APPID,paySuccess:g,payError:l,payClose:c});else{var u="您当前余额为:"+s+",本次需花费:"+p+",确认购买？",d=[{text:u,style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(d,function(){g()},this)))}};this.requestBalance(i)}catch(o){n.showTips("支付失败:"+o.message)}},e.prototype.requestBalance=function(e){var t=ChannelDefine.createURL(this.info,this.balancePath,{openid:this.openid,openkey:this.openkey,pf:this.pf,zoneid:this.platform});HttpUtil.sendGetRequest(t,e,this)},e.prototype.requestPay=function(e,t){var n=ChannelDefine.createURL(this.info,this.payPath,{openid:this.openid,openkey:this.openkey,pf:this.pf,zoneid:this.platform,itemid:e,serverid:this.info.serverId,playerid:this.info.playerId});HttpUtil.sendGetRequest(n,a,this);var a=function(e){var n=e.currentTarget,a=JSON.parse(n.response);a.ret?t.showTips("支付成功"):t.showTips("余额不足")}},e.prototype.getVipInfo=function(){var e=ChannelDefine.createURL(this.info,this.giftPath,{openid:this.info.account,zoneid:this.info.platform,serverid:this.info.serverId,playerid:this.info.playerId,pf:this.pf,openkey:this.openkey});return e},e.prototype.sendVipGetAward=function(e){var t=ChannelDefine.createURL(this.info,this.giftPath,{openid:this.info.account,zoneid:this.info.platform,serverid:this.info.serverId,playerid:this.info.playerId,pf:this.pf,openkey:this.openkey,boxid:e});return t},e.prototype.getGift=function(e){if(this.gift=SDKUtil.getQueryString("GIFT"),!this.gift)return null;var t=ChannelDefine.createURL(this.info,this.giftPath,{openid:this.info.account,zoneid:this.info.platform,serverid:this.info.serverId,playerid:this.info.playerId,pf:this.pf,openkey:this.openkey,boxid:this.gift});HttpUtil.sendGetRequest(t,this.recordGiftData,this)},e.prototype.recordGiftData=function(e){var t=e.currentTarget,n=JSON.parse(t.response);if(egret.log(n),this.boxId=this.gift,n){if(n.ret>0?this.giftOK=!0:this.giftOK=!1,-1==n.ret)return;egret.log("wanba gift is ok:"+this.giftOK),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"WanbaGiftPanel")}},e.prototype.share=function(e){this.shareContainer=e,SDKWanBaJS.showShare()},e.prototype.shareCallback=function(t){switch(t){case 0:var n=e.getInstance().shareContainer;n.shareComplete();break;case 1:case 2:}},e.prototype.sendToDesktop=function(){SDKWanBaJS.sendToDesktop(this.deskCallback);var e=new Message(MESSAGE_ID.WANBA_DESK_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.deskCallback=function(){},e.prototype.isLoginIn=function(){var e=ChannelDefine.createURL(this.info,"xuming",{openid:this.info.account,pf:this.pf,openkey:this.openkey});HttpUtil.sendGetRequest(e,null,this)},e.ParamNameDefine={openid:"openid",openkey:"openkey",pf:"pf",zoneid:"zoneid",platform:"platform"},e.ZONE1_GOODS_DEFINE={1:24560,10:24561,20:24562,28:24563,48:24564,50:24565,88:24566,99:24567,100:24568,198:24764,200:24569,500:24570,1e3:24571,1500:24572,2e3:24573,3e3:24574},e.ZONE2_GOODS_DEFINE={1:24575,10:24576,20:24577,28:24578,48:24579,50:24580,88:24581,99:24582,100:24583,198:24765,200:24584,500:24585,1e3:24822,1500:24586,2e3:24587,3e3:24588},e}();__reflect(SDKWanBa.prototype,"SDKWanBa",["ISDKHandler"]);var SDKWXGAMEBOX=function(){function e(){this.appid="wx60bab776ca043f7c",this.identify="jpsx",this.appSecret="701806b73d35b511d06bf1188ecd843d",this.loginCode="",this.grant_type="authorization_code",this.rmb_to_zuanshi_rate=100,this.loginPath="login",this.balancePath="create_order",this.payPath="pay",this.SHARE_PIC="https://jpsx-login.szfyhd.com/share_pic1.jpg",this.SHARE_DESC="跨服争武坛，三界争夺唯有你来战",this.SHARE_QUERY=""}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a,i;return __generator(this,function(o){switch(o.label){case 0:return this.info.wx_phone_sysinfo=platform.getSystemInfoSync(),[4,platform.getOption()];case 1:return e=o.sent(),t=e&&e.query?e.query:null,n="test_channel_id",a="test_sub_channel_id2",t&&t.chid&&t.subchid&&(n=t.chid,a=t.subchid),i={adFrom:n,subchid:a},this.info.adFrom=i,[2]}})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(a){switch(a.label){case 0:return e=this,[4,platform.getOption()];case 1:return t=a.sent(),n={client_id:e.appid,identify:e.identify,source_appid:t?t.referrerInfo.appId:"",channel_id:e.info.adFrom.adFrom,sub_channel_id:e.info.adFrom.subchid},window.fySDK.getFyhd().getFyhdUserInfo(n,!1,function(t){if(1==t.err_code){var n=t.result.user;e.info.account=n.openid,e.info.sign=n.sign;var a=platform.getEnvVersio();"undefined"==a||"develop"==a||"trial"==a?DataManager.isRelease=!1:DataManager.isRelease=!0,SDKManager.loginSuccessCallBack(),e.onCheckIosPayLimit()}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_SDK_LOGIN_FAIL),"登录失败！errMsg::"+t.err_msg)}),[2]}})})},e.prototype.onCheckIosPayLimit=function(){var e=platform.getEnvVersio();switch(e){case"undefined":case"develop":e="develop";break;case"trial":e="trial";break;default:e="release"}var t={client_id:this.appid,channel_id:this.info.adFrom.adFrom,openid:this.info.account,envVersion:e};egret.log("print ios pay limit ::::"+JSON.stringify(t)),window.fySDK.getFyhd().paylimit(t,function(e){DataManager.IOS_PAY_ISOPEN=e.is_open,DataManager.IOS_PAY_OPENMISSION=e.mission,DataManager.IOS_PAY_LEVEL=e.level,e.open_date&&(DataManager.IOS_PAY_OPENDATE=e.open_date),e.time_zones&&(DataManager.IOS_PAY_ZONETIME=e.time_zones),egret.log("ios pay limit return::::"+JSON.stringify(e))})},e.prototype.pay=function(e,t){try{var n=this;if(SDKManager.isHidePay)return;var a=SDKManager.loginInfo.wx_phone_sysinfo;if(a&&Tool.compareVersion(a.SDKVersion,"2.2.0")>=0){var i=new Date(DataManager.getInstance().playerManager.player.currentTime+(egret.getTimer()-DataManager.getInstance().playerManager.player.signTime)),o=""+n.info.playerId+i.getFullYear()+i.getMonth()+i.getDay()+i.getHours()+i.getMinutes()+i.getSeconds(),r={identify:this.identify,client_id:this.appid,openid:this.info.account,goods_count:e.amount*this.rmb_to_zuanshi_rate,goods_name:e.goodsName,goods_des:e.goodsName,goods_identifier:"diamond",pay_amount:e.amount,role_id:e.playerInfo.id,role_name:e.playerInfo.name,server_id:this.info.serverId,server_name:""+this.info.gamename+this.info.serverId+"服",extra_info:this.info.serverId+"_"+e.playerInfo.id,redirect_uri:"https://jpsx-login.szfyhd.com/loginServer/SDK/SWF_EXCHANGE?",order_sn:o};window.fySDK.getFyhd().shanwan_pay(r,function(e){})}else platform.openCustomerServiceConversation({})}catch(s){n.payFailHandler("支付失败！\n请联系客服人员。")}},e.prototype.payFailHandler=function(e){var t=[{text:e,style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,function(){platform.openCustomerServiceConversation({})},this)))},e.prototype.refreshShareInfo=function(){var e=Constant.get(Constant.FANGKUAIWAN_SHARE_TITLE).split("#");e.length>0&&(this.SHARE_DESC=e[Tool.randomInt(0,e.length)]);var t=Constant.get(Constant.FANGKUAIWAN_SHARE_PIC).split("#");if(t.length>0&&(this.SHARE_PIC=t[Tool.randomInt(0,t.length)]),!this.SHARE_QUERY){var n=Constant.get(Constant.FANGKUAIWAN_SHARE_QUERY).split("#");if(n.length>0){for(var a=0;a<n.length;a++)this.SHARE_QUERY+=n[a]+"&";this.SHARE_QUERY+="inviteSrever="+this.info.serverId+"&invitePlayerID="+this.info.playerId}}},e.prototype.share=function(e,t){this.refreshShareInfo(),platform.onShare({title:this.SHARE_DESC,imageUrl:this.SHARE_PIC,query:this.SHARE_QUERY}),e.shareComplete()},e}();__reflect(SDKWXGAMEBOX.prototype,"SDKWXGAMEBOX",["ISDKHandler"]);var SDKYiYou=function(){function e(){this.payPath="create_order",this.focusPath="focus",this.appkey="1eb22d96883f272478a0c4f8478a7a6a"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.share=function(e){},e.prototype.login=function(){},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){this.payContainer=t;var n=ChannelDefine.createURL(this.info,this.payPath,{userid:this.info.account,roleid:e.playerInfo.id,goodsid:e.amount,goodsName:e.goodsName,amt:e.amount,custom:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,server_id:this.info.serverId});HttpUtil.sendGetRequest(n,this.createOrderCallback,this)},e.prototype.createOrderCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);SDKYUJS.pay(n.code)},e.prototype.subscribe=function(){},e.prototype.onCreateRole=function(e,t){var n={serverid:e.serverId,servername:"神游记"+e.serverId+"区",roleid:t.id,rolename:t.name,rolelevel:t.level,appkey:this.appkey,account:e.account};SDKYUJS.reportRoleStatus(n)},e.prototype.uploadGameRoleInfo=function(e,t){var n={serverid:this.info.serverId,servername:"神游记"+this.info.serverId+"区",roleid:e.id,rolename:e.name,rolelevel:e.level,appkey:this.appkey,account:this.info.account};SDKYUJS.reportRoleStatus(n)},e}();__reflect(SDKYiYou.prototype,"SDKYiYou",["ISDKHandler"]);var SDKYYB=function(){function e(){this.loginPath="login",this.payPath="pay",this.balancePath="balance"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.login=function(){var t=e.ParamNameDefine;this.offerid=SDKUtil.getQueryString(t.offerid),this.openid=SDKUtil.getQueryString(t.openid),this.openkey=SDKUtil.getQueryString(t.openkey),this.pf=SDKUtil.getQueryString(t.pf),this.pfkey=SDKUtil.getQueryString(t.pfkey);var n=ChannelDefine.createURL(this.info,this.loginPath,{openid:this.openid,openkey:this.openkey,pf:this.pf});HttpUtil.sendGetRequest(n,this.onGetUserInfoComplete,this)},e.prototype.onGetUserInfoComplete=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.ret?this.loginFailed():(this.info.account=this.openid,this.info.nickName=decodeURI(n.nickname),this.loginCallback())},e.prototype.onEnterGame=function(e,t){},e.prototype.pay=function(e,t){var n=this,a=function(e){2!=e.code&&t.showTips("Error:"+e.code+","+e.msg)},i=function(t){n.requestPay(e.amount)};try{var o={saveValue:10*e.amount,zoneId:this.info.serverId,offerid:this.offerid,openid:this.info.account,openkey:this.openkey,pf:this.pf,pfkey:this.pfkey,onError:a,onSuccess:i};SDKYYBJS.pay(o)}catch(r){t.showTips("Exception:"+r.message)}},e.prototype.requestPay=function(e){var t=ChannelDefine.createURL(this.info,this.payPath,{openid:this.openid,openkey:this.openkey,appid:this.offerid,pf:this.pf,pfkey:this.pfkey,zoneid:this.info.serverId,playerid:this.info.playerId,amount:e});HttpUtil.sendGetRequest(t,null,this)},e.ParamNameDefine={offerid:"offerid",openid:"openid",openkey:"openkey",pf:"pf",pfkey:"pfkey"},e}();__reflect(SDKYYB.prototype,"SDKYYB",["ISDKHandler"]);var SDKYYBQuick=function(){function e(){this.logoUrl="http://cdn.ih5games.com/FREEGAME/logo.png",this.GAME_TITLE="",this.GAME_DESC="",this.productCode="82412263441748385012336395398866",this.loginPath="login",this.checkUserPath="check_user",this.exchangePath="exchange"}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){SDKQuickJS.setOnResumeNotification(this.comeBackGame),SDKQuickJS.setOnStopNotification(this.underHomeButton)},e.prototype.login=function(){},e.prototype.underHomeButton=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)},e.prototype.comeBackGame=function(){SoundFactory.playMusic(SoundDefine.SOUND_BGM)},e.prototype.onGetUserInfo=function(e){var t=e.currentTarget,n=JSON.parse(t.response);n.code==ChannelDefine.SUCCESS&&n.userid?(this.info.account=n.userid,this.info.nickName=n.nickname,this.loginCallback()):(egret.error("SDKYYBQuick.login() failed. Error sign."),this.loginFailed())
},e.prototype.pay=function(e,t){this.payContainer=t;var n=(ChannelDefine.createURL(this.info,this.exchangePath,null),{productCode:this.productCode,uid:this.info.account,userRoleId:this.info.playerId,userRoleName:this.info.gamename,userServer:this.info.serverId,userLevel:e.playerInfo.level,cpOrderNo:"hafdwioahfiabwfojow",amount:e.amount,subject:e.goodsName,desc:"元宝",callbackUrl:"",extrasParams:this.info.serverId+"_"+this.info.playerId+"_"+e.amount,goodsId:e.amount,count:1,quantifier:"份"}),a=JSON.stringify(n);SDKQuickJS.pay(a)},e.prototype.onCreateRole=function(e,t){var n={isCreateRole:!0,roleCreateTime:(new Date).getTime(),serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:t.name,userRoleId:t.id,userRoleBalance:t.gold,vipLevel:0,userRoleLevel:t.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:1250,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e.prototype.uploadGameRoleInfo=function(e,t){var n={isCreateRole:t,roleCreateTime:e.createTime,serverId:this.info.serverId,serverName:"神游记"+this.info.serverId+"服",userRoleName:e.name,userRoleId:e.id,userRoleBalance:e.gold,vipLevel:e.viplevel,userRoleLevel:e.level,partyId:1,partyName:"行会名称",gameRoleGender:"男",gameRolePower:e.playerTotalPower,partyRoleId:1,partyRoleName:"群众",professionId:"1",profession:"朝阳群众",friendlist:""},a=JSON.stringify(n);SDKQuickJS.uploadGameRoleInfo(a)},e}();__reflect(SDKYYBQuick.prototype,"SDKYYBQuick",["ISDKHandler"]);var SDKWXGameBoxSA=function(){function e(){this.appid="wx60bab776ca043f7c",this.CREATE_ROLE_TYPE=1,this.sa_report_queue=[]}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.onCreateRole=function(e,t){this.onCompleteSDK(e);var n={report_Type:SDKWXGAME_SA_TYPE.ROLE_DATA,role_id:t.id,grade:1,blance:0,vip_grade:0,server_id:e.serverId,server_name:""+e.gamename+e.serverId+"服",role_create_time:(new Date).getTime(),role_nickname:t.name,type:this.CREATE_ROLE_TYPE,client_id:this.appid,openid:e.account};this.addSaReportQueue(n)},e.prototype.onEnterGame=function(e,t){var n={report_Type:SDKWXGAME_SA_TYPE.LOGIN_GAME,openid:e.account,client_id:this.appid,role_id:e.playerId,role_nickname:t.name,server_id:e.serverId,server_name:""+e.gamename+e.serverId+"服",login_time:DataManager.getInstance().playerManager.player.currentTime};this.addSaReportQueue(n)},e.prototype.onPay=function(e,t,n){},e.prototype.onReportShare=function(e,t){},e.prototype.onCompleteSDK=function(e){if(!this.wechatuserIsReport){this.wechatuserIsReport=!0;var t={report_Type:SDKWXGAME_SA_TYPE.WECHAT_INFO,openid:e.account,client_id:this.appid,channel_id:e.adFrom?e.adFrom.adFrom:"",sub_channel_id:e.adFrom?e.adFrom.subchid:""};this.addSaReportQueue(t)}},e.prototype.addSaReportQueue=function(e){if(window.fySDK&&e){var t=0==this.sa_report_queue.length;this.sa_report_queue.push(e),t&&!this.report_timer_on&&(this.report_timer_on=!0,Tool.addTimer(this.onReportStatisHandler,this,3e3))}},e.prototype.onReportStatisHandler=function(){if(0==this.sa_report_queue.length)return this.report_timer_on=!1,void Tool.removeTimer(this.onReportStatisHandler,this,3e3);var e=this.sa_report_queue.shift();switch(e.report_Type){case SDKWXGAME_SA_TYPE.WECHAT_INFO:window.fySDK.getFyhd().loginData(e);break;case SDKWXGAME_SA_TYPE.ROLE_DATA:window.fySDK.getFyhd().roleData(e);break;case SDKWXGAME_SA_TYPE.LOGIN_GAME:window.fySDK.getFyhd().uploginData(e)}},e.prototype.init=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(SDKWXGameBoxSA.prototype,"SDKWXGameBoxSA",["ISDKStatistics"]);var SDKWXGAME_SA_TYPE;!function(e){e[e.WECHAT_INFO=1]="WECHAT_INFO",e[e.ROLE_DATA=2]="ROLE_DATA",e[e.LOGIN_GAME=3]="LOGIN_GAME"}(SDKWXGAME_SA_TYPE||(SDKWXGAME_SA_TYPE={}));var SkillEffectBase=function(){function e(e){this.attackCount=1,this.skinNum=0,this.id=(new egret.HashObject).hashCode,this.param=e}return e.prototype.play=function(){this.isplaying=!0},e.prototype.end=function(){this.isplaying&&SkillEffectManager.getInstance().onPlayFinishHanlde(this.id)},e.prototype.dispose=function(){this.isplaying=!1},e.prototype.onDestory=function(){this.isdestory=!0,this.dispose()},e}();__reflect(SkillEffectBase.prototype,"SkillEffectBase",["ISkillEffect"]);var BaseComp=function(e){function t(){var t=e.call(this)||this;return t._isRegist=-1,t.isLoaded=!1,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.setSkinName(),t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.onInit(),0==this._isRegist&&(this.onRegist(),this._isRegist=1),this._data&&this.dataChanged()},t.prototype.setSkinName=function(){},t.prototype.onInit=function(){},t.prototype.onRegist=function(){},t.prototype.onRemove=function(){},t.prototype.dataChanged=function(){},t.prototype.onShow=function(e){if(e.addChild(this),this._isRegist=0,this.isLoaded){this.onRegist(),this._isRegist=1;for(var t=0;t<this.numChildren;t++){var n=this.getChildAt(t);LoadManager.getInstance().reloadUIImageAndAnim(n)}}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.isLoaded&&this.dataChanged()},enumerable:!0,configurable:!0}),t.prototype.onDestory=function(){1==this._isRegist&&this.onRemove(),this._isRegist=-1,this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(BaseComp.prototype,"BaseComp",["eui.UIComponent","egret.DisplayObject"]);var EquipThing=function(e){function t(t){void 0===t&&(t=GOODS_TYPE.MASTER_EQUIP);var n=e.call(this,t)||this;return n.selected=!1,n._addAttributes=GameCommon.getInstance().getAttributeAry(),n}return __extends(t,e),t.prototype.parseEquipMessage=function(e){this.equipId=e.getShort(),this.modelId=e.getShort(),this.quality=e.getByte();for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte(),i=e.getInt();this._addAttributes[a]=i}},Object.defineProperty(t.prototype,"addAttributes",{get:function(){return(this.quality==GoodsQuality.Red||this.quality==GoodsQuality.Gold)&&(this._addAttributes=GameCommon.getInstance().getRedEquipAddAttr(this.modelId)),this._addAttributes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this.model.equipAttr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idKey",{get:function(){return this.type+"_"+this.equipId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pingfenValue",{get:function(){if(this.type==GOODS_TYPE.MASTER_EQUIP){if(this.model){var e=this.model.pingfenValue;return this.quality<=GoodsQuality.Red?e+GameCommon.calculationFighting(this.addAttributes):e}return 0}return GameCommon.calculationFighting(this.model.equipAttr)},enumerable:!0,configurable:!0}),t}(ThingBase);__reflect(EquipThing.prototype,"EquipThing");var ItemThing=function(e){function t(t){return void 0===t&&(t=GOODS_TYPE.ITEM),e.call(this,t)||this}return __extends(t,e),t.prototype.parseItem1=function(e){var t=e.getShort(),n=e.getInt();this.onupdate(t,-1,n)},t}(ThingBase);__reflect(ItemThing.prototype,"ItemThing");var MonsterBody=function(e){function t(){var t=e.call(this)||this;return t.isFace5=!1,t}return __extends(t,e),t.prototype.onInitBodyHead=function(){e.prototype.onInitBodyHead.call(this),this.bodyHead.hpProBarSkinName(skins.HpProgressBar2)},t.prototype.onResetHeadInfo=function(){e.prototype.onResetHeadInfo.call(this),this.onShowOrHideHpBar(!0)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){egret.superSetter(t,this,"data",e)},enumerable:!0,configurable:!0}),t.prototype.onRefreshData=function(){this.moveSpeed=GameDefine.XG_Move_Speed,this.bodyHead.bodyName="",e.prototype.onRefreshData.call(this)},t.prototype.updateAction=function(){this.onChangeBody()},t.prototype.updateDirection=function(){var e=this.getDirectionFrame();if(this._body){var t=LoadManager.getInstance().getMonsterResUrl(this.data.avatar,this.actionName,e);this._body.onFrame(t,e)}},t.prototype.onChangeBody=function(){if(this.data&&this.data.avatar){var e=LoadManager.getInstance().getMonsterResUrl(this.data.avatar,this.actionName,this.getDirectionFrame());this._body?this._body.onUpdateRes(e,this._actionPlayNum,this.getDirectionFrame()):(this._body=new BodyAnimation(e,this._actionPlayNum,this.getDirectionFrame()),this.onScaleHandler(),this.bodyLayer.addChildAt(this._body,PLAYER_LAYER.BODY))}},t.prototype.onMove=function(){e.prototype.onMove.call(this)},t.prototype.onScaleHandler=function(){this._body&&(this._body.scaleX=1,this._body.scaleY=1)},t.prototype.onHurt=function(t){t.scenetype==GameFight.getInstance().fightsceneTpye&&(e.prototype.onHurt.call(this,t),t.judge!=FightDefine.JUDGE_DUODUAN&&(this.data.isDie?this.onDeathEffect(t):this.onRepelEffect(t)))},t.prototype.onRepelEffect=function(e){if(GameFight.getInstance().canHitBack&&e.skill.id==SkillDefine.COMMON_SKILL_ID&&!this.walkOn){var t=-Math.atan2(this.y-e.attacker.y,this.x-e.attacker.x)*(180/Math.PI);t=0>t?360+t:t;var n=Tool.getPosByRadiiAndAngle(this.x,this.y,t,SkillDefine.DRAWBACK_DISTANCE);this.x=n.x,this.y=n.y}},t.prototype.onDeathEffect=function(e){if(this.parent){var t;e.skill.id==SkillDefine.COMMON_SKILL_ID&&(this.onShowOrHideHpBar(!1),t=Tool.beelinePoint(this.x,this.y,e.fromDire,Tool.toInt(50*Math.random())+300),TweenLiteUtil.onDeathFly(this,null,null,t),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_EARTHQUAKE_STRAT))),"FabaoSkillEffect"==e.skill.effectClass?TweenLiteUtil.onHideTween(this):(t=Tool.beelinePoint(this.x,this.y,e.fromDire,Tool.toInt(150*Math.random())+100),TweenLiteUtil.onBelineTween(this,t,600),TweenLiteUtil.onHideTween(this))}},t.prototype.onReset=function(){this.childOffY=0,egret.Tween.removeTweens(this),e.prototype.onReset.call(this)},t}(ActionBody);__reflect(MonsterBody.prototype,"MonsterBody");var Animation=function(e){function t(t,n,a,i,o){void 0===n&&(n=-1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o="action");var r=e.call(this)||this;return r._playNum=-1,r._movieClip=new egret.MovieClip,r._mcFactory=new egret.MovieClipDataFactory,r._movieClip.touchEnabled=!1,r._actionName=o,r._playNum=n,r._frame=null==i?1:i,r.autoRemove=a,r.onLoadHandler(t),r}return __extends(t,e),t.prototype.setTouch=function(e){this._movieClip.touchEnabled=e},t.prototype.onUpdateRes=function(e,t,n,a){void 0===n&&(n=null),void 0===a&&(a="action"),this._actionName=a,this._playNum=t,this._frame=null==n?1:n,this.onLoadHandler(e)},t.prototype.onLoadHandler=function(e){e&&(this.onRemoveCallBack(),this._resName!=e?(this.onDisposeTextrue(),this._loadingUrl=e,this._resName=e,this.removeChildren(),LoadManager.getInstance().loadRes(this)):this._loadingUrl||(this.playNum=this._playNum))},t.prototype.onReLoad=function(){if(-1==this._playNum){var e=this._resName;this._resName=null,this.onLoadHandler(e)}},Object.defineProperty(t.prototype,"resName",{get:function(){return this._resName},enumerable:!0,configurable:!0}),t.prototype.onFrame=function(e,t){t&&this._frame!=t&&(this._frame=t,this.onLoadHandler(e))},t.prototype.playFinishCallBack=function(e,t,n){void 0===n&&(n=null),e&&t&&(this._playNum<=0||(this.callback=e,this.callObj=t,this.callparam=n,this._autoRemove||this._loadingUrl||this._movieClip&&this._movieClip.addEventListener(egret.Event.COMPLETE,this.onFinishCallBack,this)))},t.prototype.onFinishCallBack=function(){this.callback&&Tool.callback(this.callback,this.callObj,this.callparam),this.onRemoveCallBack()},t.prototype.onRemoveCallBack=function(){this.callback=null,this.callObj=null,this.callparam=null,this._movieClip&&this._movieClip.removeEventListener(egret.Event.COMPLETE,this.onFinishCallBack,this)},Object.defineProperty(t.prototype,"playNum",{set:function(e){this._playNum=e,0==e?this.onStop():this.onPlay()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoRemove",{set:function(e){this._autoRemove=e,this._autoRemove?this._playNum<0||(0==this._playNum?this.onDestroy():this._playNum>0&&this._movieClip.addEventListener(egret.Event.COMPLETE,this.onDestroy,this)):this._movieClip.removeEventListener(egret.Event.COMPLETE,this.onDestroy,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameRate",{set:function(e){this._movieClip&&(e>0?this._movieClip.frameRate=e:this._movieClip.movieClipData&&(this._movieClip.frameRate=this._movieClip.movieClipData.frameRate))},enumerable:!0,configurable:!0}),t.prototype.onLoadComplete=function(e){if(e==this._resName&&this._movieClip){this._loadingUrl=null;var t=e+"_json",n=e+"_png",a=RES.getRes(t);if(!a)return void this.onFinishCallBack();var i=RES.getRes(n);this._mcFactory&&this._mcFactory.clearCache(),this._mcFactory.mcDataSet=a,this._mcFactory.texture=i,this._movieClip.movieClipData=this._mcFactory.generateMovieClipData(this._actionName),this._movieClip.parent||this.addChildAt(this._movieClip,0),this.playFinishCallBack(this.callback,this.callObj,this.callparam),this.playNum=this._playNum,this.dispatchEvent(new egret.Event(GameEvent.ANIMATION_LOAD_COMPLETE))}},t.prototype.onPlay=function(){if(this._movieClip&&this._movieClip.parent)try{this._movieClip.gotoAndPlay(1,this._playNum)}catch(e){SDKManager.getChannel()==EChannel.CHANNEL_LOCAL?Tool.throwException("模型动画资源出错：res："+this._resName):this._movieClip.stop()}},t.prototype.onStop=function(){if(this._movieClip&&this._movieClip.parent)try{this._movieClip.gotoAndStop(1)}catch(e){SDKManager.getChannel()==EChannel.CHANNEL_LOCAL?Tool.throwException("模型动画资源出错：res："+this._resName):this._movieClip.stop()}},t.prototype.gotoAndStop=function(e){this._movieClip&&!this._loadingUrl&&this._movieClip.gotoAndStop(e)},t.prototype.gotoAndPlay=function(e){this._movieClip&&!this._loadingUrl&&this._movieClip.gotoAndPlay(e)},t.prototype.onDestroy=function(){this._frame=null,this.parent&&this.parent.removeChild(this);try{this._movieClip&&(this.onFinishCallBack(),this._movieClip.removeEventListener(egret.Event.LOOP_COMPLETE,this.onDestroy,this),this._movieClip.removeEventListener(egret.Event.COMPLETE,this.onDestroy,this),this._movieClip.parent&&this._movieClip.parent.removeChild(this._movieClip),this._movieClip.stop(),this._movieClip=null)}catch(e){Tool.log("error - sprite movieFinish")}this.onDisposeTextrue()},t.prototype.onDisposeTextrue=function(){this._loadingUrl=null},Object.defineProperty(t.prototype,"currFrameTexture",{get:function(){return this._movieClip&&this.currFrameData?this._movieClip.movieClipData.spriteSheet.getTexture(this.currFrameData.res):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currFrameData",{get:function(){return this._movieClip.movieClipData&&this._movieClip.currentFrame?this._movieClip.movieClipData.getKeyFrameData(this._movieClip.currentFrame):null},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(Animation.prototype,"Animation");var ActivityZhongqiuBase=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.zqManager=DataManager.getInstance().zqManager,this.lbCost.text=this.zqManager.costMoney.toString(),this.lbItem.text=this.zqManager.getGoodsName(this.type,1)+"：",this.lbItem10.text=this.zqManager.getGoodsName(this.type,10)+"：",this.btnReceive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventReceive,this),this.initRedReceive(),this.initReward()},t.prototype.initReward=function(){for(var e=this.zqManager.rewardItems,t=0;t<e.length;++t){var n=GameCommon.getInstance().createGoodsIntance(e[t]);this.groupReward.addChild(n),n.name_label.visible=!1}},t.prototype.initRedReceive=function(){var e=new redPoint;e.register(this.btnReceive,GameDefine.RED_BTN_POS,this.zqManager,"isCanReceive"),this.points.push(e)},t.prototype.initRed=function(e,t,n){void 0===n&&(n=1);var a=new redPoint;a.register(e,t,this.zqManager,"getActivityPoint",this.type,n),this.points.push(a)},t.prototype.getCurrModel=function(){return this.zqManager.getCurrModel(this.type)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.updataCount(),this.showAwardPanel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.zqManager.getZhongQiuData,this.zqManager),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_FEAST_GET_MESSAGE.toString(),this.onCallInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_FEAST_RUN_MESSAGE.toString(),this.onCallDraw,this),this.lbMoney.text=this.zqManager.payMoney.toString()+"元",this.resetUI(),this.onCloseAwdShow(),this.zqManager.getZhongQiuData(),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),this.isAction=!1,this.isGet=!1,this.showAwardPanel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.zqManager.getZhongQiuData,this.zqManager),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_FEAST_GET_MESSAGE.toString(),this.onCallInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_FEAST_RUN_MESSAGE.toString(),this.onCallDraw,this)},t.prototype.examineCD=function(e){void 0===e&&(e=!0),e?Tool.addTimer(this.updateTime,this,1e3):Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ZHONGQIULEICHONG);0>=e&&(e=0,this.examineCD(!1)),this.lbTime.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.updateBtnReceive=function(){this.zqManager.isCanReceive()?this.btnReceive.enabled=!0:this.btnReceive.enabled=!1},t.prototype.updataCount=function(){this.updateBtnReceive(),this.lbCount.text=this.zqManager.getGoodsNum(this.type,1)+"/"+this.zqManager.getGoodsCost(this.type,1),this.lbCount10.text=this.zqManager.getGoodsNum(this.type,10)+"/"+this.zqManager.getGoodsCost(this.type,10)},t.prototype.onCallInfo=function(){this.isGet=!1,this.updataCount()},t.prototype.onCallDraw=function(){this.updataCount(),egret.log("返回数量： "+this.zqManager.itemList.length),this.zqManager.itemList.length>1?(this.onPlayTen(this.zqManager.getRewardItemList()),this.resetUI()):this.onDealRocker()},t.prototype.onDealRocker=function(){},t.prototype.onEventReceive=function(){if(!this.isGet&&this.zqManager.isCanReceive()){this.isGet=!0;var e=new Message(MESSAGE_ID.ACT_FEAST_GET_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onEventRocker=function(e){if(void 0===e&&(e=1),!this.isAction)if(this.zqManager.getGoodsNum(this.type,e)>=this.zqManager.getGoodsCost(this.type,e)){this.isAction=!0,egret.log("数量： "+e);var t=new Message(MESSAGE_ID.ACT_FEAST_RUN_MESSAGE);t.setByte(e),t.setByte(this.type),GameCommon.getInstance().sendMsgToServer(t)}else GameCommon.getInstance().addAlert("error_tips_6")},t.prototype.onRewardShow=function(){this.onPlayDone(this.zqManager.getRewardItem())},t.prototype.onPlayTen=function(e){var t=new TurnplateAwardParam;t.desc="十连抽获得以下奖励",t.titleSource="",t.itemAwards=e,t.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",t))},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e),this.showAwardGroup.scaleX=this.showAwardGroup.scaleY=.3,egret.Tween.get(this.showAwardGroup).to({scaleX:1,scaleY:1},1e3,egret.Ease.backInOut)},t.prototype.onCloseAwdShow=function(){this.showAwardPanel.visible=!1,egret.Tween.removeTweens(this.showAwardGroup),this.isAction=!1},t.prototype.updateGoods=function(e,t){e.onUpdate(t.type,t.id,t.uid,t.quality,t.num)},t.prototype.resetUI=function(){this.isAction=!1},t}(BaseTabView);__reflect(ActivityZhongqiuBase.prototype,"ActivityZhongqiuBase");var ActivityLabaBase=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.labaManager=DataManager.getInstance().labaManager,this.lbCost&&(this.lbCost.text=this.labaManager.currModel.costNum.toString()),this.lbCost1&&(this.lbCost1.text=this.labaManager.currModel.costNum+"元")},t.prototype.initRed=function(e,t,n){void 0===n&&(n=1);var a=new redPoint;a.register(e,t,this.labaManager,"getActivityPoint",n),this.points.push(a)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.examineCD(),this.showAwardPanel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_LABA_MESSAGE.toString(),this.onCallLaba,this),this.labaManager.updateData(),this.resetUI(),this.onCloseAwdShow()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),this.isAction=!1,this.showAwardPanel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_LABA_MESSAGE.toString(),this.onCallLaba,this)},t.prototype.onCallLaba=function(){this.progressBar.maximum=this.labaManager.currModel.costNum,this.progressBar.value=this.labaManager.getMoneyStr(),this.lbCount.text=this.labaManager.getHaveCount().toString(),this.labaManager.type>0&&(this.labaManager.itemList.length>1?(this.onPlayTen(this.labaManager.getRewardItemList()),this.resetUI()):this.onDealRocker())},t.prototype.onDealRocker=function(){},t.prototype.onEventRocker=function(e){if(void 0===e&&(e=1),!this.isAction)if(this.labaManager.getHaveCount()>=e){this.isAction=!0;var t=new Message(MESSAGE_ID.ACT_LABA_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}else GameCommon.getInstance().addAlert("error_tips_6")},t.prototype.examineCD=function(e){void 0===e&&(e=!0),e?Tool.addTimer(this.updateTime,this,1e3):Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LEICHONGLABA);0>=e&&(e=0,this.examineCD(!1)),this.lbTime.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onRewardShow=function(){this.onPlayDone(this.labaManager.getRewardItem())},t.prototype.onPlayTen=function(e){var t=new TurnplateAwardParam;t.desc="十连抽获得以下奖励",t.titleSource="",t.itemAwards=e,t.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",t))},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e),this.showAwardGroup.scaleX=this.showAwardGroup.scaleY=.3,egret.Tween.get(this.showAwardGroup).to({scaleX:1,scaleY:1},1e3,egret.Ease.backInOut)},t.prototype.onCloseAwdShow=function(){this.isAction||(this.showAwardPanel.visible=!1,egret.Tween.removeTweens(this.showAwardGroup))},t.prototype.updateGoods=function(e,t){e.onUpdate(t.type,t.id,t.uid,t.quality,t.num)},t.prototype.resetUI=function(){this.isAction=!1},t}(BaseTabView);__reflect(ActivityLabaBase.prototype,"ActivityLabaBase");var HefuTreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.WEEK_AWD_MAX=4,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuTreasurePanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().festivalWuYiManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.currHasNum=[],this.points[0].register(this.reward_week_btn,new egret.Point(101,-10),DataManager.getInstance().festivalWuYiManager,"checkTreasurePoint");for(var t=this.manager.zhuanpanModel.box.split("#"),n=0;4>n;n++){var a=t[n]?t[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this["award_times_lab"+n].text=Language.instance.getText(i,"times"),this["award_box_img"+n].name=a[1]}this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),this.reward_week_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this);for(var t=0;4>t;t++)this["award_box_img"+t].name=t+1+"",this["award_box_img"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);for(var t=0;8>t;t++)this["btn"+t]&&(this["btn"+t].name=t+"",this["btn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAwardTips,this));this.examineCD(!0),this.onShowTurnplate()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.reward_week_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this);for(var t=0;4>t;t++)this["award_box_img"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);for(var t=0;8>t;t++)this["btn"+t]&&this["btn"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAwardTips,this);this.examineCD(!1)},t.prototype.onRefresh=function(){this.isRun=!1,this.onUpdateLog(),this.onUpdateWeekAward(),this.onUpdateCost(),this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);e.setByte(2),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onUpdateLog=function(){this.label_log.textFlow=DataManager.getInstance().festivalWuYiManager.getTextFlow(),setTimeout(this.adjustChatBar.bind(this),10)},t.prototype.adjustChatBar=function(){this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ZHUANPANACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onNextData=function(){this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum;var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id);e?e.num:0;if(e&&e.num>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899}var n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=n[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<n[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t.prototype.onPlayDone=function(){this.onShowAward(),this.onRefresh(),this.isRun=!0},t.prototype.onUpdateWeekAward=function(){this.reward_week_btn.enabled=!1;var e=this.manager.zhuanpanModel,t=e.box.split("#"),n=0;for(this.nextNBItemDesc.text="";this.nbItem.numChildren>0;){var a=this.nbItem.getChildAt(0);this.nbItem.removeChild(a)}for(var i=0;i<this.WEEK_AWD_MAX;i++){var o=t[i]?t[i].split(","):null;if(!o)break;var r=parseInt(o[0]),s=this["award_box_img"+i],h=this["reward_anim_grp"+i],l=parseInt(o[0]);this["award_times_lab"+i].text=Language.instance.getText(l,"times"),h.removeChildren(),this.manager.treasureAwdIdx>=r?(n+=1,s.source="hefuActbox_open_png",s.y=-12):(s.y=-0,s.source="hefuActbox_png",this.manager.zhuanpanNum>=r&&(this.reward_week_btn.enabled||(this.reward_week_btn.enabled=!0),GameCommon.getInstance().addAnimation("baoxiangtixing",new egret.Point(-15,-10),h,-1),n+=1))}},t.prototype.onTouchBox=function(e){var t,n=e.currentTarget,a=this.manager.zhuanpanModel.box.split("#");t=a[Number(n.name)-1]?a[Number(n.name)-1].split(","):null;var i=JsonModelManager.instance.getModelbox()[t[1]],o=new ThingBase(GOODS_TYPE.BOX);o.onupdate(i.id,i.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,o,0)))},t.prototype.onShowAwardTips=function(e){var t=parseInt(e.currentTarget.name),n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show)[t];if(n){var a,i;n.type==GOODS_TYPE.MASTER_EQUIP||n.type==GOODS_TYPE.SERVANT_EQUIP?(a=new EquipThing(n.type),a.onupdate(n.id,n.quality,0),i=INTRODUCE_TYPE.EQUIP):(a=new ThingBase(n.type),a.onupdate(n.id,n.quality,0),i=INTRODUCE_TYPE.IMG),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(i,n.type,a,n.uid)))}},t.prototype.onTreasureBackMsg=function(){1==DataManager.getInstance().festivalWuYiManager.tp?(this.onNextData(),this.onRotateback()):10==DataManager.getInstance().festivalWuYiManager.tp||9==DataManager.getInstance().festivalWuYiManager.tp?this.onShowTenAward():this.onRefresh()},t.prototype.onShowTenAward=function(){var e=new TurnplateAwardParam;e.desc="十连抽获得以下奖励",e.titleSource="",e.itemAwards=DataManager.getInstance().festivalWuYiManager.temAward,e.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",e)),this.onRefresh()},t.prototype.onShowAward=function(){for(var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),t=0;t<e.length;t++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==e[t].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==e[t].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==e[t].num){var n=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);GameCommon.getInstance().onGetThingAlert(n,e[t].num,GOODS_CHANGE_TYPE.DELAY_ADD);break}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e=(this.manager.zhuanpanModel.show.split("#"),0),t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show);for(e=0;e<t.length;e++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==t[e].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==t[e].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==t[e].num){var n;return n=this.getRotationLong(8,4,3,e,-1),void egret.Tween.get(this.disc_outside).to({rotation:n},1700,egret.Ease.sineInOut).call(this.onPlayDone,this).wait(2300).call(this.onReady,this)}this.isRun=!1}},t.prototype.onHide=function(){this.isRun=!1,e.prototype.onHide.call(this)},t.prototype.onReady=function(){this.isRun=!1},t.prototype.getRotationLong=function(e,t,n,a,i){void 0===i&&(i=1);var o=360/e*a*i,r=360*(Math.floor(Math.random()*(n-t))+t)*i;return r+o},t.prototype.onTouchBtnTurn1=function(){if(!this.isRun){var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=e[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);if(t<e[0].num)return void GameCommon.getInstance().addAlert("钻石不足");
if(!GameFight.getInstance().checkBagIsFull()){var n=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);n.setByte(9),GameCommon.getInstance().sendMsgToServer(n)}}},t.prototype.onTouchBtnTurn=function(){if(!this.isRun){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(0==t){var n=DataManager.getInstance().playerManager.player.getICurrency(5);if(n<this.manager.zhuanpanModel.costList[1].num)return void GameCommon.getInstance().addAlert("钻石不足")}if(!GameFight.getInstance().checkBagIsFull()){var a=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onUpdateCost=function(){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(t>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0;var n=GameCommon.getInstance().getThingModel(this.manager.zhuanpanModel.costList[1].type,this.manager.zhuanpanModel.costList[1].id);this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var a=DataManager.getInstance().playerManager.player.getICurrency(5);a<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.img_cons.source=n.dropicon}var i=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=i[0].num.toString();var a=DataManager.getInstance().playerManager.player.getICurrency(5);a<i[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t.prototype.onShowTurnplate=function(){var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=(this.manager.zhuanpanModel.show.split("#"),0);for(n=0;n<t.length;n++){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(t[n].id,t[n].type);this.currHasNum[n]=a,e=GameCommon.getInstance().getThingModel(t[n].type,t[n].id);var i=void 0;i=this["img_icon"+n],i.onUpdate(t[n].type,t[n].id,0,t[n].quality,t[n].num,t[n].lv),i.name_label.text="",i.num_label.text="",i.currentState="notName",this["label_num"+n].text="X"+t[n].num}},t}(BaseTabView);__reflect(HefuTreasurePanel.prototype,"HefuTreasurePanel");var FriendMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="FriendListPanel",n.btnRes="列表",t.push(n),n=new RegisterSystemParam,n.sysName="FriendApplyPanel",n.btnRes="筛选",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().friendManager,"checkFriendRedPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="FriendBlackList",n.btnRes="屏蔽",t.push(n),n=new RegisterSystemParam,n.sysName="FriendListChatPanel",n.btnRes="最近",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().chatManager,"onCheckPrivateChatRedPoint"),t.push(n),this.registerPage(t,"FriendGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){this.setTitle("friend_title_png"),e.prototype.onRefresh.call(this)},t.prototype.onShowAlertByName=function(t){switch(t){case"FriendApplyPanel":this.setTitle("friend_apply_png");break;case"FriendBlackList":this.setTitle("friend_blacklist_png")}e.prototype.onShowAlertByName.call(this,t)},t.prototype.onTouchCloseBtn=function(){this.setTitle("friend_title_png"),e.prototype.onTouchCloseBtn.call(this)},t}(BaseSystemPanel);__reflect(FriendMainPanel.prototype,"FriendMainPanel");var FriendItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.onUpdate=function(){this.playerHead.setHead(this.data.player.headindex,this.data.player.headFrame),this.vip_label.text=GameCommon.getInstance().getVipName(this.data.player.viplevel)+"",this.label_info.text=this.data.player.name+" "+this.data.player.rebirthLv+"转 "+this.data.player.level+Language.instance.getText("level"),this.powerbar.power=this.data.player.fightvalue},t}(BaseListItem);__reflect(FriendItemRenderer.prototype,"FriendItemRenderer");var PlayerHeadPanel=function(e){function t(t,n){void 0===t&&(t=1),void 0===n&&(n=-1);var a=e.call(this)||this;return a.isListener=!1,a.skinName=skins.PlayerHeadSkin,a.setHead(t,n),a}return __extends(t,e),t.prototype.setHead=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=-1),-1==e&&(e=DataManager.getInstance().playerManager.player.headIndex),0==e&&(e=2),-1==t&&(t=DataManager.getInstance().playerManager.player.headFrameIndex),0==t&&(t=1),this.imgFrame.source=GameCommon.getInstance().getHeadFrameByIndex(t),this.imgHead.source=GameCommon.getInstance().getBigHeadByOccpation(e)},t.prototype.setHeadSystem=function(){this.imgFrame.source="head_icon_system_png",this.imgFrame.source=GameCommon.getInstance().getHeadFrameByIndex(1)},t.prototype.onClear=function(){this.imgFrame.source=null,this.imgHead.source=null},t.prototype.addClickListener=function(e,t){this.isListener||(this.imgHead.touchEnabled=this.imgFrame.touchEnabled=!0,this.imgHead.addEventListener(egret.TouchEvent.TOUCH_TAP,e,t),this.imgFrame.addEventListener(egret.TouchEvent.TOUCH_TAP,e,t),this.isListener=!0)},t}(eui.Component);__reflect(PlayerHeadPanel.prototype,"PlayerHeadPanel");var PlayerData=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.playerId=0,a.coatardLv=0,a.rebirth=0,a.headFrame=1,a.petGrade=-1,a.unionSkill2Array=[],a._compInit=!1,a._fashionSkillCD=0,a.equipthings=[],a.equipSlotThings=[],a.dominateTings=[],a.fourinages=[],a.psychThings=[],a.fateThings=[],a.blessinfos=[],a.seniorEquips=[],a.goldEquips=[],a.blessEquipDict={},a.blessEquipSlotDict={},a.blessSkillsDict={},a.blessWakeLevel=[],a.fashionDatas={},a.fashionWearIds={},a.fashionSkils={},a.tujianDataDict={},a._appears=[],a.legendInfo={},a.fuling=[],a.yuanjie=[],a.rnuesList=[],a.blessDanDict={},a.tianshuDict={},a.taozhuangDict={},a.skillEnhantDict={};for(var i=0;i<GameDefine.Equip_Slot_Num;i++)a.equipthings[i]=new EquipThing,a.equipthings[i].position=i,a.equipSlotThings[i]=new EquipSlotThing,a.equipSlotThings[i].slot=i;for(var i=0;i<GameDefine.Equip_Slot_Num;i++)a.seniorEquips[i]=new EquipThing,a.seniorEquips[i].position=i+GameDefine.Equip_Slot_Num;for(var i=0;i<GameDefine.CELESTIAL_EQUIP_SLOTS.length;i++)a.goldEquips[i]=new EquipThing,a.goldEquips[i].position=GameDefine.CELESTIAL_EQUIP_SLOTS[i];for(var i=0;i<GameDefine.Dominate_Slot_Num;i++)a.dominateTings[i]=new DominateThing,a.dominateTings[i].slot=i,a.dominateTings[i].onupdate(GameDefine.Domiante_IDs[i],-1,0);for(var i=0;i<GameDefine.Psych_Slot_Num;i++)a.psychThings[i]=new PsychBase,a.psychThings[i].slot=i;for(var i=0;i<GameDefine.Fate_Slot_Num;i++)a.fateThings[i]=new FateBase,a.fateThings[i].slot=i+1;return a.longhunAttribute=[],a._compInit=!0,a}return __extends(t,e),Object.defineProperty(t.prototype,"occupation",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.onInitEquip=function(e,t){var n=this.equipthings[t];n&&(n.parseEquipMessage(e),n.equipId=0,this.equipthings[t]=n,n.playerIndex=this.index)},t.prototype.onInitSeniorEquip=function(e,t){var n=this.seniorEquips[t];n&&(n.parseEquipMessage(e),n.equipId=0,this.seniorEquips[t]=n,n.playerIndex=this.index)},t.prototype.onInitGoldEquip=function(e,t){var n=this.goldEquips[t];n&&(n.parseEquipMessage(e),n.equipId=0,this.goldEquips[t]=n,n.playerIndex=this.index)},t.prototype.onInitEquipSlot=function(e,t){var n=this.equipSlotThings[t];n&&(n.parseEquipMessage(e),this.equipSlotThings[t]=n)},t.prototype.onupdateEquip=function(e){var t,n=e.getByte();t=n>=2*MASTER_EQUIP_TYPE.SIZE?this.goldEquips:n>=MASTER_EQUIP_TYPE.SIZE?this.seniorEquips:this.equipthings;for(var a=0;a<t.length;a++){var i=t[a];if(i.position==n){i.equipId=0,i.parseEquipMessage(e),i.playerIndex=this.index;break}}return n},t.prototype.getBlessSkill=function(e){return this.blessSkillsDict[e]},t.prototype.getEquipBySlot=function(e){return e>=2*MASTER_EQUIP_TYPE.SIZE?this.goldEquips[e-2*MASTER_EQUIP_TYPE.SIZE]:e>=MASTER_EQUIP_TYPE.SIZE?this.seniorEquips[e-MASTER_EQUIP_TYPE.SIZE]:this.equipthings[e]},t.prototype.getEquipByOccp=function(e){for(var t=[],n=0;n<this.equipthings.length;n++){var a=this.equipthings[n];a&&a.model&&a.model.part==e&&t.push(a)}return t},t.prototype.getPsychBySlot=function(e){return this.psychThings[e]},t.prototype.getFateSlot=function(e){return this.fateThings[e]},t.prototype.getFateSlotIdx=function(e){return this.fateThings[e]},t.prototype.getBlessEquip=function(e,t){var n,a=this.blessEquipDict[e];return a?n=a[t]:null},t.prototype.getBlessEquipSlot=function(e,t){var n,a=this.blessEquipSlotDict[e];return n=a[t]},t.prototype.parseBlessDan=function(e){return this.blessDanDict[e]},t.prototype.onParsePsychEquip=function(e){var t=new PsychBase;t.parseInit(e),this.psychThings[t.slot]?this.psychThings[t.slot].onUpdate(t):this.psychThings[t.slot]=t},t.prototype.onParseFateEquip=function(e){var t=new FateBase,n=e.getInt();t.parseInit(n,e),this.fateThings[t.slot-1]=t},t.prototype.onParseFateEquipRefresh=function(e){var t=new FateBase;t.parseFate(e),this.fateThings[t.slot-1]?this.fateThings[t.slot-1].onUpdate(t):this.fateThings[t.slot-1]=t},t.prototype.onPreseFateLvUp=function(e){this.fateThings[e.slot-1]=e},t.prototype.onGetFate=function(e){for(var t=0;t<this.fateThings.length;++t)if(this.fateThings[t].UID==e)return this.fateThings[t];return null},t.prototype.onCleanFate=function(e){for(var t=0;t<this.fateThings.length;++t)this.fateThings[t].UID==e&&(this.fateThings[t].UID=0,this.fateThings[t].lv=0,this.fateThings[t].exp=0)},t.prototype.onRebirth=function(){this.bodyType==BODY_TYPE.SELF?(this.resetAllSkillCD(GameFight.getInstance().hero_randomIndex),this._compInit&&(this.onCheckFashion(),DataManager.getInstance().titleManager.onCheckTitleTimeOut())):this.resetAllSkillCD(GameFight.getInstance().enemy_randomIndex);for(var t in this.fashionSkils){var n=this.fashionSkils[t];n&&n.onResetSkill()}GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG?this._fashionSkillCD=0:this._fashionSkillCD=SkillDefine.FASHION_SKILL_CD,e.prototype.onRebirth.call(this)},t.prototype.getCanUseSkill=function(){if(this.isUseingSkill)return null;if(this.isHitChenMo&&(this._useSkill=this.getSkillInfoById(SkillDefine.COMMON_SKILL_ID),this._fashionSkillCD>0&&this._fashionSkillCD--,0==this._fashionSkillCD&&(this._fashionSkillCD=SkillDefine.FASHION_SKILL_CD)),this._useSkill)return this._useSkill;if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG){if((this._relseSkillCount+1)%FightDefine.getXgDeathCount()!=0)this._useSkill=this.getSkillInfoById(SkillDefine.COMMON_SKILL_ID);else{for(var e=0;e<SkillDefine.FASION_SKILL_ORDER.length;e++){var t=SkillDefine.FASION_SKILL_ORDER[e],n=this.fashionSkils[t];if(n&&this.blessinfos[n.type]&&0!=this.blessinfos[n.type].grade&&n.skillInfo&&!n.skillInfo.isSkillCD){this._useSkill=n.skillInfo;break}}if(!this._useSkill){for(var a=[],e=0;e<this.skills.length;e++)this.skills[e].level>0&&a.push(this.skills[e]);this._useSkill=this.getSkillInfoById(Tool.randomInt(0,a.length)+1)}}this._relseSkillCount++}else{if(0==this._fashionSkillCD){for(var e=0;e<SkillDefine.FASION_SKILL_ORDER.length;e++){var t=SkillDefine.FASION_SKILL_ORDER[e],n=this.fashionSkils[t];if(n&&this.blessinfos[n.type]&&0!=this.blessinfos[n.type].grade){var i=n.getSkill();if(i){this._useSkill=i,this._fashionSkillCD=SkillDefine.FASHION_SKILL_CD;break}}}this._useSkill||(this._fashionSkillCD=-1)}if(!this._useSkill){for(var o=this._skillStartIdx*SkillDefine.SKILL_RELEASE_SIZE,r=SkillDefine.SKILL_RELEASE_ARY.length,s=void 0;!s||0==s.level&&s.id!=SkillDefine.COMMON_SKILL_ID;){var h=SkillDefine.SKILL_RELEASE_ARY[(o+this._relseSkillCount)%r];s=this.getSkillInfoById(h),this._relseSkillCount++}this._useSkill=s,this._fashionSkillCD>0&&this._fashionSkillCD--}}return this._useSkill},Object.defineProperty(t.prototype,"attackcount",{get:function(){return this._relseSkillCount},enumerable:!0,configurable:!0}),t.prototype.onResetSkillStartIdx=function(){this._skillStartIdx=this._startRandomIdx%SkillDefine.SKILL_RELEASE_SIZE},t.prototype.updataAttributeFighting=function(e,t){var n=DataManager.getInstance().playerManager,a=n.player;this.attributes[ATTR_TYPE.ATTACK]=this.model.attack,this.attributes[ATTR_TYPE.PHYDEF]=this.model.phyDef,this.attributes[ATTR_TYPE.MAGICDEF]=this.model.magicDef,this.attributes[ATTR_TYPE.HP]=this.model.hp,this.attributes[ATTR_TYPE.HIT]=this.model.hit,this.attributes[ATTR_TYPE.DODGE]=this.model.dodge,this.attributes[ATTR_TYPE.BLOCK]=this.model.block,this.attributes[ATTR_TYPE.BREAK]=this.model.counter,this.attributes[ATTR_TYPE.CRIT]=this.model.crit,this.attributes[ATTR_TYPE.DUCT]=this.model.duct;for(var i=0;i<ATTR_TYPE.SIZE;++i)this.attributes[i]+=e[i];var o=GameCommon.getInstance().getAttributeAry();if(this.equipthings)for(var r=void 0,s=void 0,h=0;h<this.equipthings.length;h++){var l=this.equipthings[h];if(l&&l.model)for(var g=0;g<l.attributes.length;g++){if(s=this.getEquipSlotThings(l.position),r=l.attributes[g]+l.addAttributes[g],s.quenchingLv>0){var c=JsonModelManager.instance.getModelcuilian()[s.quenchingLv];r=Math.floor(r+c.effect/GameDefine.GAME_ADD_RATIO*r)}o[g]+=r}}for(var p=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN),u=0;u<ATTR_TYPE.SIZE;++u)o[u]+=p[u];for(var d=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN),_=0;_<ATTR_TYPE.SIZE;++_)o[_]+=Tool.toInt(o[_]*d[_]/GameDefine.GAME_ADD_RATIO),this.attributes[_]+=o[_];var m=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.RED_EQUIP);if(this.seniorEquips)for(var r=void 0,E=0;E<this.seniorEquips.length;E++){var l=this.seniorEquips[E];if(l&&l.model)for(var f=0;f<l.attributes.length;f++)r=l.attributes[f]+l.addAttributes[f],this.attributes[f]+=r+Tool.toInt(r*m/GameDefine.GAME_ADD_RATIO)}if(this.goldEquips)for(var r=void 0,y=0;y<this.goldEquips.length;y++){var l=this.goldEquips[y];if(l&&l.model)for(var f=0;f<l.attributes.length;f++)r=l.attributes[f]+l.addAttributes[f],this.attributes[f]+=r}for(var I=0;I<this.dominateTings.length;++I){var v=JsonModelManager.instance.getModelshanggutaozhuang()[this.dominateTings[I].slot][this.dominateTings[I].lv-1];if(v)for(var f=0;f<ATTR_TYPE.SIZE;++f)this.dominateTings[I].tier>0?this.attributes[f]+=Math.floor(1.25*v.base_effect[f]):this.attributes[f]+=v.base_effect[f]}for(var S=GameCommon.getInstance().getAttributeAry(),T=0;T<Fourinages_Type.SIZE;T++){var M=this.fourinages[T];if(M.level>0){var A=1;if(M.grade>0){var P=JsonModelManager.instance.getModelsixiangjinjie()[T][M.grade-1];A+=P.effect/GameDefine.GAME_ADD_RATIO}for(var D=JsonModelManager.instance.getModelsixiang()[T][M.level-1],b=0;b<ATTR_TYPE.SIZE;++b)D.attrAry[b]>0&&(S[b]+=Math.floor(D.attrAry[b]*A))}}for(var G=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG),C=0;C<ATTR_TYPE.SIZE;++C)S[C]+=G[C];for(var R=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG),L=0;L<ATTR_TYPE.SIZE;++L)S[L]+=Tool.toInt(S[L]*R[L]/GameDefine.GAME_ADD_RATIO),this.attributes[L]+=S[L];for(var N=GameCommon.getInstance().getAttributeAry(),w=GameCommon.getInstance().getAttributeAry(),O=GameCommon.getInstance().getAttributeAry(),B=GameCommon.getInstance().getAttributeAry(),U=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.FORGE),I=0;I<this.equipSlotThings.length;++I){var k=this.equipSlotThings[I];if(k.intensifyLv>0)for(var x=GoodsDefine.EQUIP_SLOT_TYPE[k.slot],H=DataManager.getInstance().forgeManager.getIntensifyAttr(x),f=0;f<ATTR_TYPE.SIZE;++f)H[f]>0&&(w[f]+=H[f]);if(k.infuseLv>0)for(var F=JsonModelManager.instance.getModelronghun()[GoodsDefine.EQUIP_SLOT_TYPE[k.slot]][k.infuseLv-1],f=0;f<ATTR_TYPE.SIZE;++f)N[f]+=F.attrAry[f];if(k.gemLv>0)for(var Y=GoodsDefine.SLOT_GEMTYPE[k.slot],W=0;W<Y.length;W++){var V=Y[W],j=k.getGemLvByGemSlot(W),q=JsonModelManager.instance.getModelbaoshi()[j-1];if(q){var X=q.attrAry[V];O[V]+=X+Tool.toInt(X*U/GameDefine.GAME_ADD_RATIO)}}if(k.zhLv>0)for(var J=JsonModelManager.instance.getModellianhua(),z=J[GoodsDefine.EQUIP_SLOT_TYPE[k.slot]][k.zhLv-1],K=0;K<ATTR_TYPE.SIZE;++K){var Z=z.attrAry[K];Z>0&&(B[K]+=Z+Tool.toInt(Z*U/GameDefine.GAME_ADD_RATIO))}}for(var Q=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA),$=0;$<ATTR_TYPE.SIZE;++$)w[$]+=Q[$];for(var et=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA),tt=0;tt<ATTR_TYPE.SIZE;++tt)w[tt]+=Tool.toInt(w[tt]*et[tt]/GameDefine.GAME_ADD_RATIO),this.attributes[tt]+=w[tt];for(var nt=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA),at=0;at<ATTR_TYPE.SIZE;++at)B[at]+=nt[at];for(var it=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA),ot=0;ot<ATTR_TYPE.SIZE;++ot)B[ot]+=Tool.toInt(B[ot]*it[ot]/GameDefine.GAME_ADD_RATIO),this.attributes[ot]+=B[ot];for(var rt=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING),st=0;st<ATTR_TYPE.SIZE;++st)N[st]+=rt[st];for(var ht=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING),lt=0;lt<ATTR_TYPE.SIZE;++lt)N[lt]+=Tool.toInt(N[lt]*ht[lt]/GameDefine.GAME_ADD_RATIO),this.attributes[lt]+=N[lt];for(var gt=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI),ct=0;ct<ATTR_TYPE.SIZE;++ct)O[ct]=O[ct]+gt[ct];for(var pt=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI),ut=0;ut<ATTR_TYPE.SIZE;++ut)O[ut]+=Tool.toInt(O[ut]*pt[ut]/GameDefine.GAME_ADD_RATIO),this.attributes[ut]+=O[ut];for(var I=0;I<BLESS_TYPE.SIZE;I++)for(var dt=this.getBlessAttrByType(I),f=0;f<ATTR_TYPE.SIZE;++f)this.attributes[f]+=dt[f];for(var I=0;I<this.psychThings.length;++I){var _t=JsonModelManager.instance.getModelyuanshen()[this.psychThings[I].modelID];if(_t)for(var f=0;f<ATTR_TYPE.SIZE;++f)this.attributes[f]+=_t.attrAry[f]}var mt=(GameCommon.getInstance().getAttributeAry(),JsonModelManager.instance.getModeljingmai()[this.pulseLv]);if(mt)for(var I=0;I<ATTR_TYPE.SIZE;++I)this.attributes[I]+=mt.attrAry[I];for(var I=0;I<this.unionSkill2Array.length;++I){var Et=this.unionSkill2Array[I],ft=JsonModelManager.instance.getModelguildSkill()[Et.id][Et.level-1];if(ft)for(var yt=0;yt<ATTR_TYPE.SIZE;++yt)this.attributes[yt]+=ft.attrAry[yt]}for(var I=0;I<GameDefine.LONGHUAN_ATTR.length;I++)this.attributes[GameDefine.LONGHUAN_ATTR[I]]+=this.longhunAttribute[I];GameCommon.getInstance().getAttributeAry();if(this.wuxingLevel>0){var It=JsonModelManager.instance.getModelwuxing(),vt=It[this.wuxingLevel];if(!vt)for(var I=this.wuxingLevel-1;I>0;--I)if(It[I]){vt=It[I],this.wuxingLevel=vt.id;break}for(var I=0;I<vt.attrAry.length;I++)this.attributes[I]+=vt.attrAry[I]}if(this.qihun>0)for(var St=JsonModelManager.instance.getModelqihun()[this.qihun],I=0;I<St.attrAry.length;I++)this.attributes[I]+=St.attrAry[I]+Tool.toInt(St.attrAry[I]*m/GameDefine.GAME_ADD_RATIO);var Tt={},Mt=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.TUJIAN);for(var At in this.tujianDataDict){var Pt=this.tujianDataDict[At];if(0!=Pt.level){for(var Dt=Pt.attrAry,bt=0;bt<ATTR_TYPE.SIZE;++bt)Dt[bt]>0&&(this.attributes[bt]+=Dt[bt]+Tool.toInt(Dt[bt]*Mt/GameDefine.GAME_ADD_RATIO));Tt[Pt.model.type]||(Tt[Pt.model.type]=0),Tt[Pt.model.type]++}}for(var Gt in this.fashionDatas){var Ct=this.fashionDatas[Gt],Rt=JsonModelManager.instance.getModelfashion()[Ct.id];if(Rt)for(var f=0;f<ATTR_TYPE.SIZE;++f)this.attributes[f]+=Rt.attrAry[f]*Ct.level}for(var I=0;I<this.fateThings.length;++I){var Lt=JsonModelManager.instance.getModelmingge()[this.fateThings[I].modelID],Nt=JsonModelManager.instance.getModelminggelv()[this.fateThings[I].lv-1];if(Lt)for(var f=0;f<ATTR_TYPE.SIZE;++f)if(Lt.attrAry[f]>0)switch(Lt.pinzhi){case 1:this.attributes[f]+=Tool.toInt(Nt.attrAry[f]*Nt.lv/100);break;case 2:this.attributes[f]+=Tool.toInt(Nt.attrAry[f]*Nt.lan/100);break;case 3:this.attributes[f]+=Tool.toInt(Nt.attrAry[f]*Nt.zi/100);break;case 4:this.attributes[f]+=Tool.toInt(Nt.attrAry[f]*Nt.cheng/100);break;case 5:this.attributes[f]+=Tool.toInt(Nt.attrAry[f]*Nt.hong/100)}}for(var I=0;I<GameDefine.FULING_ATTR.length;I++)this.attributes[GameDefine.FULING_ATTR[I]]+=this.fuling[I];for(var I=0;I<GameDefine.YUANJIE_ATTR.length;I++)this.attributes[GameDefine.YUANJIE_ATTR[I]]+=this.yuanjie[I];for(var wt=n.getAllXinfaAttrAry(),Ot=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.XINFA),I=0;I<ATTR_TYPE.SIZE;++I)wt[I]>0&&(this.attributes[I]+=wt[I]+Tool.toInt(wt[I]*Ot/GameDefine.GAME_ADD_RATIO));for(var Bt=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.RUNE),I=0;50>I;I++){var Ut=a.getPlayerData().rnuesList[I];if(Ut>0){var kt=JsonModelManager.instance.getModelzhanwen()[Ut];if(!kt)continue;for(var xt=0;xt<kt.attrAry.length;xt++)kt.attrAry[xt]>0&&(this.attributes[xt]+=kt.attrAry[xt]+Tool.toInt(kt.attrAry[xt]*Bt/GameDefine.GAME_ADD_RATIO))}}var Ht=GameCommon.getInstance().getAttributeAry(),Ft=GameCommon.getInstance().getAttributeAry(),Yt=JsonModelManager.instance.getModeltianshushengji(),Wt=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.BOOK);for(var Vt in Yt){var jt=Yt[Vt],qt=JsonModelManager.instance.getModeltianshutupo()[Vt],Xt=this.tianshuDict[jt.id];if(Xt){if(Xt.level>0)for(var Jt=0;Jt<jt.attrAry.length;Jt++)jt.attrAry[Jt]>0&&(Ht[Jt]+=jt.attrAry[Jt]*Xt.level);if(Xt.grade>0)for(var zt=0;zt<qt.attrAry.length;zt++){qt.attrAry[zt]>0&&(Ht[zt]+=qt.attrAry[zt]*Xt.grade);var Kt=GameDefine.getAttrPlusKey(zt+GameDefine.ATTR_OBJ_KEYS.length);qt[Kt]&&qt[Kt]>0&&(Ft[zt]+=qt[Kt]*Xt.grade)}Wt>0&&(Ft[I]+=Tool.toInt(Ft[I]*Wt/GameDefine.GAME_ADD_RATIO))}}for(var Zt=DataManager.getInstance().strongerManager.getStrongerAtt(STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL),Qt=0;Qt<ATTR_TYPE.SIZE;++Qt)Ht[Qt]+=Zt[Qt];for(var $t=DataManager.getInstance().strongerManager.getStrongerPlusAtt(STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL),en=0;en<ATTR_TYPE.SIZE;++en)Ht[en]+=Tool.toInt(Ht[en]*$t[en]/GameDefine.GAME_ADD_RATIO),this.attributes[en]+=Ht[en];var tn,nn=GameCommon.getInstance().getAttributeAry(),an=n.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.PILL);for(var on in a.xianDans){tn=a.xianDans[on];var rn=JsonModelManager.instance.getModelxiandan()[tn.UID];if(rn)for(var xt=0;xt<rn.attrAry.length;xt++){var sn=rn.attrAry[xt];if(sn>0&&a.xianDans[tn.UID].shiyongNum>0){var hn=sn*a.xianDans[tn.UID].shiyongNum;this.attributes[xt]+=hn+Tool.toInt(hn*an/GameDefine.GAME_ADD_RATIO),nn[xt]=nn[xt]+DataManager.getInstance().xiandanManager.getXianDanAllProTimes(rn)}}}for(var ln in JsonModelManager.instance.getModelxinfaLv()){var gn=JsonModelManager.instance.getModelxinfaLv()[ln],cn=JsonModelManager.instance.getModelxinfajinjie()[ln],pn=this.skillEnhantDict[ln];if(pn){for(var xt=0;xt<gn.attrAry.length;xt++)gn.attrAry[xt]>0&&(this.attributes[xt]+=gn.attrAry[xt]*pn.level);if(pn.grade>0)for(var xt=0;xt<cn.attrAry.length;xt++)cn.attrAry[xt]>0&&(this.attributes[xt]+=cn.attrAry[xt]*pn.grade)}}var un=GameCommon.getInstance().getAttributeAry(),dn=JsonModelManager.instance.getModelmounttaozhuang();for(var _n in dn)for(var on in dn[_n])if(dn[_n][on]){var mn=this.taozhuangDict[dn[_n][on].id];if(mn>0){for(var I=0;I<dn[_n][on].attrAry.length;I++)dn[_n][on].attrAry[I]>0&&(this.attributes[I]+=dn[_n][on].attrAry[I]*mn);for(var I=10;I<2*dn[_n][on].attrAry.length;I++)dn[_n][on][GameDefine.getAttrPlusKey(I)]>0&&(un[I%ATTR_TYPE.SIZE]+=dn[_n][on][GameDefine.getAttrPlusKey(I)]*mn)}}for(var I=0;I<this.unionSkill2Array.length;++I){var Et=this.unionSkill2Array[I],En=JsonModelManager.instance.getModelguildSkill()[Et.id][Et.level-1];En&&(this.attributes[ATTR_TYPE.ATTACK]*=1+En.attPlus/GameDefine.GAME_ADD_RATIO,this.attributes[ATTR_TYPE.ATTACK]=Math.floor(this.attributes[ATTR_TYPE.ATTACK]),this.attributes[ATTR_TYPE.HP]*=1+En.hpPlus/GameDefine.GAME_ADD_RATIO,this.attributes[ATTR_TYPE.HP]=Math.floor(this.attributes[ATTR_TYPE.HP]))}for(var I=0;I<nn.length;++I)this.attributes[I]=Tool.toInt(this.attributes[I]*(1+nn[I]/GameDefine.GAME_ADD_RATIO));var fn=GameCommon.getInstance().getAttributeAry(),yn=JsonModelManager.instance.getModellingxing();for(var In in yn)if(this.fuling[6]>=yn[In].max)for(var I=10;I<2*yn[In].attrAry.length;I++)yn[In][GameDefine.getAttrPlusKey(I)]>0&&(fn[I%ATTR_TYPE.SIZE]=yn[In][GameDefine.getAttrPlusKey(I)]);for(var I=0;I<fn.length;++I)this.attributes[I]=Tool.toInt(this.attributes[I]*(1+fn[I]/GameDefine.GAME_ADD_RATIO));var vn=n.xinfaAddRatio;if(vn>0)for(var I=0;I<=ATTR_TYPE.MAGICDEF;++I)this.attributes[I]+=Tool.toInt(this.attributes[I]*vn/GameDefine.GAME_ADD_RATIO);for(var I=0;I<=Ft.length;++I)Ft[I]>0&&(this.attributes[I]+=Tool.toInt(this.attributes[I]*Ft[I]/GameDefine.GAME_ADD_RATIO));for(var Sn=DataManager.getInstance().yuanjieManager.getAttributePlus(DataManager.getInstance().yuanjieManager.getYuanJieModelCurr()),I=0;I<Sn.length;++I)this.attributes[I]=Tool.toInt(this.attributes[I]*(1+Sn[I]/GameDefine.GAME_ADD_RATIO));for(var I=0;I<un.length;++I)this.attributes[I]=Tool.toInt(this.attributes[I]*(1+un[I]/GameDefine.GAME_ADD_RATIO));for(var Tn=0,I=0;I<SkillDefine.SKILL_NUM;++I)Tn+=SkillDefine.getSkillFighting(this.skills[I].level,this.skills[I].grade);return Tn+=GameCommon.calculationFighting(this.attributes),Tn+=t,this.figthPower=Tn,this.figthPower},t.prototype.getBlessAttrByType=function(e){var t=GameCommon.getInstance().getAttributeAry(),n=GameCommon.getInstance().getAttributeAry(),a=this.blessinfos[e],i=DataManager.getInstance().blessManager.getBlessModelByData(a);if(i){for(var o=0;o<ATTR_TYPE.SIZE;++o){var r=i.attrAry[o];if(r>0){t[o]+=r;var s=DataManager.getInstance().playerManager.getTianshiAttrPlusByBlessType(e);s>0&&(t[o]+=Tool.toInt(r*s/GameDefine.GAME_ADD_RATIO))}}for(var h=DataManager.getInstance().blessManager.skillModels(a.type),o=0;o<h.length;++o){var l=h[o],g=this.getBlessSkill(l.id);if(g){for(var c=DataManager.getInstance().blessManager.getSkillAttrByID(l.id),p=0;p<ATTR_TYPE.SIZE;++p)c[p]>0&&(t[p]+=c[p]);for(var p=10;p<2*ATTR_TYPE.SIZE;++p)c[p]>0&&(n[p%ATTR_TYPE.SIZE]+=c[p])}}for(var u=DataManager.getInstance().blessManager.getblessDanModel(a.type,0),o=0;o<u.attrAry.length;++o)u.attrAry[o]>0&&(t[o]+=u.attrAry[o]*a.danDic[0],n[o]+=u.harm*a.danDic[0]);for(var u=DataManager.getInstance().blessManager.getblessDanModel(a.type,1),o=0;o<u.attrAry.length;++o)n[o]+=u.harm*a.danDic[1];for(var d=this.blessEquipDict[e],o=0;o<d.length;++o){var _=d[o];if(_)for(var m=JsonModelManager.instance.getModelmountEquipment()[_.modelId],p=0;p<ATTR_TYPE.SIZE;++p)m.attrAry[p]>0&&(t[p]+=m.attrAry[p])}var E=DataManager.getInstance().strongerManager.getJiHuoModelByType(Number(e));if(E){for(var p=0;p<ATTR_TYPE.SIZE;++p)E.attrAry[p]>0&&(t[p]+=E.attrAry[p]);if(0==E.plusType)for(var p=0;p<ATTR_TYPE.SIZE;p++){var f=GameDefine.getAttrPlusKey(p+ATTR_TYPE.SIZE);E&&E[f]&&(n[p]=n[p]+E[f])}}if(this.blessWakeLevel[e]>0)for(var y=DataManager.getInstance().blessManager.getBlessJueXingValue()[this.blessWakeLevel[e]-1],o=0;o<ATTR_TYPE.SIZE;++o)n[o]+=y;for(var o=0;o<ATTR_TYPE.SIZE;++o)t[o]>0&&n[o]&&(t[o]+=Tool.toInt(n[o]*t[o]/GameDefine.GAME_ADD_RATIO))}return t},t.prototype.updateSkillLevel=function(e,t){var n=this.skills[e];n.level=t,this.updateSkillDamage(e)},t.prototype.updateSkillGrade=function(e,t){var n=this.skills[e];n.grade=t,this.updateSkillDamage(e)},t.prototype.updateSkillSkin=function(e,t){var n=this.skills[e];n.styleNum=t},t.prototype.updateSkillDamage=function(e){var t=0,n=this.skills[e],a=JsonModelManager.instance.getModelskilldmg()[n.level-1];a&&(t+=a?a["skill"+n.id]:0);var i=JsonModelManager.instance.getModelskilltupo()[n.id];for(var o in i){var r=i[o];r.tupoLv==n.grade&&(t+=r.effect)}n.addDamage=t},Object.defineProperty(t.prototype,"currInfuseSoul",{get:function(){for(var e,t,n=0;n<this.equipSlotThings.length;n++)if(t=this.equipSlotThings[n-1>=0?n-1:this.equipSlotThings.length-1].infuseLv,e=this.equipSlotThings[n].infuseLv,t>e||t==e&&0==n)return this.equipSlotThings[n]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currIntensify",{get:function(){for(var e,t,n=0;n<this.equipSlotThings.length;n++)if(t=this.equipSlotThings[n-1>=0?n-1:this.equipSlotThings.length-1].intensifyLv,e=this.equipSlotThings[n].intensifyLv,t>e||t==e&&0==n)return this.equipSlotThings[n]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currGemInlay",{get:function(){for(var e=this.equipSlotThings[0],t=Tool.toInt(e.gemLv/GameDefine.GEM_SLOT_NUM),n=0;n<this.equipSlotThings.length;n++){var a=Tool.toInt(this.equipSlotThings[n].gemLv/GameDefine.GEM_SLOT_NUM);if(t>a){e=this.equipSlotThings[n];break}}return e},enumerable:!0,configurable:!0}),t.prototype.parseInfuseSoul=function(e,t,n){this.equipSlotThings[e].infuseLv=t,this.equipSlotThings[e].infuseExp=n},t.prototype.parseZhuHun=function(e,t){this.equipSlotThings[e].zhLv=t},t.prototype.parseIntensify=function(e,t){this.equipSlotThings[e].intensifyLv=t},t.prototype.parseGemInlay=function(e,t){this.equipSlotThings[e].gemLv=t},t.prototype.parseQuenching=function(e,t,n){this.equipSlotThings[e].quenchingLv=t,this.equipSlotThings[e].quenchingExp=n},t.prototype.getEquipSlotThings=function(e){return this.equipSlotThings[e]},t.prototype.getSortQuenching=function(){var e=this.equipSlotThings.concat();return e=e.sort(function(e,t){return e.quenchingLv>t.quenchingLv?1:e.quenchingLv<t.quenchingLv?-1:0})},t.prototype.getSuitInfuseSoulLv=function(){var e=0;if(e=Math.max(this.equipSlotThings[0].infuseLv,e),0==e)return 0;for(var t=1;t<this.equipSlotThings.length;t++)if(e=Math.min(e,this.equipSlotThings[t].infuseLv),0==e)return 0;return e},t.prototype.getSuitIntensifyLv=function(){var e=0;if(e=Math.max(this.equipSlotThings[0].intensifyLv,e),0==e)return 0;for(var t=1;t<this.equipSlotThings.length;t++)if(e=Math.min(e,this.equipSlotThings[t].intensifyLv),0==e)return 0;return e},t.prototype.getSortIntensify=function(){var e=this.equipSlotThings.concat();return e=e.sort(function(e,t){return e.intensifyLv>t.intensifyLv?1:e.intensifyLv<t.intensifyLv?-1:0})},t.prototype.getGemTotalLv=function(){for(var e=0,t=0;t<this.equipSlotThings.length;t++){var n=this.equipSlotThings[t];e+=n.gemLv}return e},t.prototype.getBlessFightingByType=function(e){var t=this.getBlessAttrByType(e);return GameCommon.calculationFighting(t)},t.prototype.parsePulseUpdate=function(e){this.pulseLv=e.getShort()},t.prototype.onUpdateFashionSkill=function(e){if(e&&0!=e.level){var t=this.fashionSkils[e.type],n=-1;return e.limitTime>=0&&(n=Math.max(0,Math.ceil((e.limitTime-egret.getTimer())/1e3)),0==n)?void(t&&t.id==e.id&&delete this.fashionSkils[e.type]):void(t?(t.limitTime>=0&&(n=Math.max(0,Math.ceil((t.limitTime-egret.getTimer())/1e3))),(0==n||t.model.order<e.model.order)&&(this.fashionSkils[e.type]=e)):this.fashionSkils[e.type]=e)}},t.prototype.updateAppear=function(){for(var e=0;e<this.blessinfos.length;e++){var t=this.blessinfos[e];if(this.fashionWearIds[t.type]){var n=this.fashionWearIds[t.type],a=JsonModelManager.instance.getModelfashion()[n];this._appears[e]=a?a.waixing1:-1}else 0==t.level&&0==t.grade?this._appears[e]=GameDefine.PLAYER_DEFUALT_AVATAR[t.type]:this._appears[e]=0}},t.prototype.getAppearID=function(e){return this.bodyType==BODY_TYPE.SELF&&GameFight.getInstance().isJackaroo&&GameDefine.JACKAROO_AVATAR[e]?GameDefine.JACKAROO_AVATAR[e]:this._appears[e]},t.prototype.setAppear=function(e){for(var t=0;t<BLESS_TYPE.SIZE;t++)this._appears[t]=e.appears[t];this.titleId=e.titleId},t.prototype.onInitDominate=function(e,t){var n=this.dominateTings[t];n&&(n.parseEquipMessage(e),this.dominateTings[t]=n)
},t.prototype.onParseDominateUpgrade=function(e){var t=e.getByte();this.dominateTings[t].lv=e.getShort()},t.prototype.onParseDominateAdvance=function(e){var t=e.getByte();this.dominateTings[t].tier=e.getByte()},t.prototype.getDominateThingBySlot=function(e){return this.dominateTings[e]},t.prototype.onCheckFashion=function(){for(var e in this.fashionDatas)this.onCheckFashionByID(parseInt(e)),this.onUpdateFashionSkill(this.fashionDatas[e])},t.prototype.onCheckFashionByID=function(e){if(this.bodyType==BODY_TYPE.SELF){var t=this.fashionDatas[e];if(t&&Tool.isNumber(t.limitTime)&&t.limitTime>0){var n=t.limitTime;n=Math.max(0,Math.ceil((n-egret.getTimer())/1e3)),0==n&&(delete this.fashionDatas[e],DataManager.getInstance().playerManager.player.updataAttribute())}}},t.prototype.getUnionSkill2=function(e){for(var t=0;t<this.unionSkill2Array.length;++t)if(this.unionSkill2Array[t].id==e)return this.unionSkill2Array[t];return null},t.prototype.parseBlessEquip=function(e,t){this.blessEquipDict[e]||(this.blessEquipDict[e]=new Array);for(var n=this.blessEquipDict[e],a=t.getByte(),i=0;a>i;++i)if(t.getBoolean()){var o;n[i]||(n[i]=new ServantEquipThing),o=n[i],o.parseMessage(t)}else n[i]=null},t.prototype.parseBlessEquipSlot=function(e,t){this.blessEquipSlotDict[e]||(this.blessEquipSlotDict[e]=[]);for(var n=this.blessEquipSlotDict[e],a=0;a<BlessDefine.BLESS_SLOT_MAXNUM;++a){var i;n[a]||(n[a]=new ServantEquipSlot(e,a)),i=n[a],i.parseMessage(t)}},Object.defineProperty(t.prototype,"cloth_res",{get:function(){return"r"+this.sex+"_cloth"+(this.getAppearID(BLESS_TYPE.CLOTHES)?this.getAppearID(BLESS_TYPE.CLOTHES):0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weapon_res",{get:function(){return"weapon"+(this.getAppearID(BLESS_TYPE.WEAPON)?this.getAppearID(BLESS_TYPE.WEAPON):0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"feijian_Res",{get:function(){var e=this._appears[BLESS_TYPE.HORSE];return 0>e||!Tool.isNumber(e)?"":"jian"+this._appears[BLESS_TYPE.HORSE]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wing_res",{get:function(){var e=this.getAppearID(BLESS_TYPE.WING);return 0>e||!Tool.isNumber(e)?"":"wing"+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ring_res",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"magic_res",{get:function(){var e=this.getAppearID(BLESS_TYPE.MAGIC);return 0>e||!Tool.isNumber(e)?"":"magic_"+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seniorEquipsPower",{get:function(){for(var e,t,n=GameCommon.getInstance().getAttributeAry(),a=0;a<this.seniorEquips.length;a++){var i=this.seniorEquips[a];if(i&&i.model){e=i.attributes;for(var o=0;o<i.attributes.length;o++)t=e[o]+i.addAttributes[o],n[o]+=t}}return GameCommon.calculationFighting(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"qihunPower",{get:function(){if(this.qihun>0){for(var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModelqihun()[this.qihun],n=0;n<t.attrAry.length;n++)e[n]+=t.attrAry[n];return GameCommon.calculationFighting(e)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fourinagesPower",{get:function(){for(var e=0,t=0;t<Fourinages_Type.SIZE;t++)e+=this.fourinages[t].power;return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mabiEffect",{get:function(){this.use_mabi=egret.getTimer()+FightDefine.MABI_EFFECT_CD;var e=0;if(this.legendInfo[ARTIFACT_TYPE.ARTIFACT_MB]){var t=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_MB];e=LegendDefine.getLegendEffect(ARTIFACT_TYPE.ARTIFACT_MB,t)}return e>0&&GameFight.getInstance().artifactFackerScene?100:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mabiRatio",{get:function(){var e=0;if(this.use_mabi>=egret.getTimer())return e;if(this.legendInfo[ARTIFACT_TYPE.ARTIFACT_MB]){var t=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_MB];e=LegendDefine.getLegendRatio(ARTIFACT_TYPE.ARTIFACT_MB,t)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chenmoEffect",{get:function(){this.use_chenmo=egret.getTimer()+FightDefine.CHENMO_EFFECT_CD;var e=0;if(this.legendInfo[ARTIFACT_TYPE.ARTIFACT_CM]){var t=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_CM];e=LegendDefine.getLegendEffect(ARTIFACT_TYPE.ARTIFACT_CM,t)}return e>0&&GameFight.getInstance().artifactFackerScene?100:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chenmoRatio",{get:function(){var e=0;if(this.use_chenmo>=egret.getTimer())return e;if(this.legendInfo[ARTIFACT_TYPE.ARTIFACT_CM]){var t=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_CM];e=LegendDefine.getLegendRatio(ARTIFACT_TYPE.ARTIFACT_CM,t)}return e},enumerable:!0,configurable:!0}),t.prototype.refreshRebornEft=function(){this.legendInfo&&this.legendInfo[ARTIFACT_TYPE.ARTIFACT_FH]&&(this.reborncount=1)},Object.defineProperty(t.prototype,"rebornEffect",{get:function(){if(this.legendInfo&&this.legendInfo[ARTIFACT_TYPE.ARTIFACT_FH]){var e=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_FH];return LegendDefine.getLegendEffect(ARTIFACT_TYPE.ARTIFACT_FH,e)}return 0},enumerable:!0,configurable:!0}),t.prototype.refreshShieldEft=function(){GameFight.getInstance().showShieldScene?this.shieldValue=Tool.toInt(this.maxHp*this.shieldEffect/GameDefine.GAME_ADD_RATIO):this.shieldValue=0},Object.defineProperty(t.prototype,"shieldEffect",{get:function(){if(this.legendInfo&&this.legendInfo[ARTIFACT_TYPE.ARTIFACT_HD]){var e=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_HD];return LegendDefine.getLegendEffect(ARTIFACT_TYPE.ARTIFACT_HD,e)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pojiaEffect",{get:function(){var e=0;if(this.legendInfo[ARTIFACT_TYPE.ARTIFACT_PJ]){var t=this.legendInfo[ARTIFACT_TYPE.ARTIFACT_PJ];e=LegendDefine.getLegendEffect(ARTIFACT_TYPE.ARTIFACT_PJ,t)}return e},enumerable:!0,configurable:!0}),t.prototype.fulingParse=function(e){for(var t=0;7>t;t++)this.fuling[t]=e.getLong(),Tool.log(this.fuling[t])},t.prototype.yuanJieParse=function(e){for(var t=0;t<GameDefine.YUANJIE_ATTR.length;t++)this.yuanjie[t]=e.getLong();DataManager.getInstance().yuanjieManager.yjExp=e.getLong()},t}(BodyData);__reflect(PlayerData.prototype,"PlayerData");var ClothEquipTips=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.ClothEquipBarSkin},t.prototype.onUpdate=function(t){e.prototype.onUpdate.call(this,t);var n=t.model,a=n.model;e.prototype.onRefreshCommonUI.call(this,a,n.quality);var i=a.coatardLv+Language.instance.getText("grade");this.level_label.text="（"+i+"）",this.label_slot.text=n.model.des;var o;this.basic_attr_layer.removeChildren();for(var r=n.attributes,s=0;s<ATTR_TYPE.SIZE;s++){var h=r[s];if(h>0){var l=n.addAttributes[s];o=new AttributeItem,o.data=[s,h,"+"+l],this.basic_attr_layer.addChild(o)}}var o,g=n.pingfenValue,c=n.position,p=DataManager.getInstance().forgeManager.getEquipSlotThing(c),u=p.intensifyLv>0,d=(u?p.intensifyLv:1,DataManager.getInstance().forgeManager.getIntensifyAttr(c));this.qianghua_attr_layer.removeChildren();for(var s=0;s<d.length;s++){var h=d[s];h>0&&(h=u?h:0,o=new AttributeItem,o.data=[s,h],this.qianghua_attr_layer.addChild(o))}0==this.qianghua_attr_layer.numChildren&&(o=new AttributeItem,o.data=["    未锻造 ",""],this.qianghua_attr_layer.addChild(o)),g+=DataManager.getInstance().forgeManager.getSlotIntensifyPower(c),this.baoshi_group.removeChildren();for(var _=GoodsDefine.SLOT_GEMTYPE[p.slot],m=0;m<_.length;m++){var E=_[m],f=p.getGemLvByGemSlot(m),y=JsonModelManager.instance.getModelbaoshi()[f-1];y&&(o=new AttributeItem,o.data=[E,y.attrAry[E]],this.baoshi_group.addChild(o))}0==this.baoshi_group.numChildren&&(o=new AttributeItem,o.data=["    未锻造 ",""],this.baoshi_group.addChild(o)),g+=DataManager.getInstance().forgeManager.getSlotGemPower(c);var o,I=p.infuseLv>0,v=I?p.infuseLv:1,S=DataManager.getInstance().forgeManager.getInfuseModel(c,v);this.zhuling_attr_layer.removeChildren();for(var s=0;s<S.attrAry.length;s++){var h=S.attrAry[s];h>0&&I&&(h=I?h:0,o=new AttributeItem,o.data=[s,h],this.zhuling_attr_layer.addChild(o))}0==this.zhuling_attr_layer.numChildren&&(o=new AttributeItem,o.data=["    未锻造 ",""],this.zhuling_attr_layer.addChild(o));var o;if(this.cuilian_attr_layer.removeChildren(),t.quenchingLv>0){var T=JsonModelManager.instance.getModelcuilian()[t.quenchingLv],M=T.effect/1e4;g+=Math.floor(M*g),o=new AttributeItem,o.data=["基础属性 +",T.effect/100+"%"],this.cuilian_attr_layer.addChild(o)}else o=new AttributeItem,o.data=["    未锻造 ",""],this.cuilian_attr_layer.addChild(o);g+=DataManager.getInstance().forgeManager.getSlotInfulsePower(c),this.bmlable_power.power=g.toString()},t.prototype.onShowStar=function(e){for(var t,n=0;10>n;n++)t=this["img_star"+n],e>=n+1?t.visible=!0:t.visible=!1},t}(BaseTipsBar);__reflect(ClothEquipTips.prototype,"ClothEquipTips");var GoodsInstance=function(e){function t(){var t=e.call(this)||this;return t._bl=!1,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddStage,t),t.skinName=skins.GoodsInstanceSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.model&&this.refresh()},t.prototype.onAddStage=function(){this.touchEnabled=!1,this.item_icon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.item_frame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.updateByAward=function(e){e&&this.onUpdate(e.type,e.id,0,-1,e.num)},t.prototype.onUpdate=function(e,t,n,a,i,o){void 0===n&&(n=0),void 0===a&&(a=-1),void 0===i&&(i=0),void 0===o&&(o=1),this.type=e,this.id=t,this.num=i,this.uid=n,this.lv=o,this.model=GameCommon.getInstance().getThingModel(this.type,this.id,a),this.model&&(this.quality=a>0?a:this.model.quality,this.refresh())},t.prototype.onReset=function(){this.type=0,this.id=0,this.quality=-1,this.num=0,this.model=null,this.isLoaded&&(this.item_icon.source="",this.name_label.text="",this.num_label.text="",this.item_frame.source="bag_whiteframe_png",this.item_name_bg.source="equip_dengjikuang_bai_png"),this.orangeAnim&&this.orangeAnim.onStop(),this.orangeLayer.visible=!1},t.prototype.refresh=function(){if(this.isLoaded){this.item_icon.source=this.model.icon;var e="";switch(this.type){case GOODS_TYPE.YUANSHEN:e=(this.lv>0?this.lv+Language.instance.getText("level"):"")+this.model.name;break;case GOODS_TYPE.GEM:this.lv>0&&(this.label_gemLv.text=this.lv+Language.instance.getText("level")),e=this.model.name;break;case GOODS_TYPE.MASTER_EQUIP:e=this.model.coatardLv+Language.instance.getText("grade");break;case GOODS_TYPE.SERVANT_EQUIP:e=this.model.starNum+Language.instance.getText("star");break;default:e=this.model.name}if(this.name_label.textFlow=new Array({text:e,style:{textColor:GameCommon.getInstance().CreateNameColer(this.quality)}}),this.item_frame.source=GameCommon.getInstance().getIconFrame(this.quality),this.item_name_bg.source=GameCommon.getInstance().getIconFrameDi(this.quality),this.num>0?this.num_label.text=GameCommon.getInstance().getFormatNumberShow(this.num):this.num_label.text="",this.quality>=GoodsQuality.Orange){this.orangeLayer.visible=!0;var t="",n=1;switch(this.quality){case GoodsQuality.Red:t="hongzhuang";break;case GoodsQuality.Gold:t="jinzhuang";break;case GoodsQuality.Orange:this.type!=GOODS_TYPE.MASTER_EQUIP&&(t="chengzhuang"),n=.95}t?(this.orangeAnim?this.orangeAnim.onUpdateRes(t,-1):(this.orangeAnim=new Animation(t,-1),this.orangeAnim.touchEnabled=!1,this.orangeAnim.touchChildren=!1,this.orangeLayer.addChild(this.orangeAnim)),this.orangeAnim.scaleX=n,this.orangeAnim.scaleY=n,this.orangeAnim.onPlay()):(this.orangeAnim&&this.orangeAnim.onStop(),this.orangeLayer.visible=!1)}else this.orangeAnim&&this.orangeAnim.onStop(),this.orangeLayer.visible=!1}},t.prototype.onHideName=function(e){this.name_label.visible=!e},t.prototype.onTouch=function(e){if(this.model){var t,n;if(this.type==GOODS_TYPE.MASTER_EQUIP||this.type==GOODS_TYPE.SERVANT_EQUIP?(t=new EquipThing(this.type),t.onupdate(this.id,this.quality,0),n=INTRODUCE_TYPE.EQUIP):(t=new ThingBase(this.type),t.onupdate(this.id,this.quality,0),n=INTRODUCE_TYPE.IMG),this.type==GOODS_TYPE.YUANSHEN){var a=JsonModelManager.instance.getModelyuanshen()[this.id];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PsychIntroducebar",new PsychIntroducebarParam(a)))}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(n,this.type,t,this.uid)))}},t.prototype.addAnimation=function(e,t){void 0===t&&(t=-1),this.remAnimation(),this.orangeAnim=new Animation(e,t,!0),this.orangeAnim.touchEnabled=!1,this.orangeAnim.touchChildren=!1,this.orangeAnim.scaleX=this.orangeAnim.scaleY=.9,this.orangeLayer.addChild(this.orangeAnim)},t.prototype.remAnimation=function(){this.orangeAnim&&(this.orangeAnim.onDestroy(),this.orangeAnim.parent&&this.orangeAnim.parent.removeChild(this.orangeAnim),this.orangeAnim=null)},t.prototype.addSpecialAnim=function(e,t,n,a){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===a&&(a=0),this.remSpecialAnim(),this.specialAnim=new Animation(e,t,!0),this.specialAnim.y=4,this.specialAnim.touchEnabled=!1,this.specialAnim.touchChildren=!1,this.orangeLayer.addChild(this.specialAnim)},t.prototype.remSpecialAnim=function(){this.specialAnim&&(this.specialAnim.onDestroy(),this.specialAnim.parent&&this.specialAnim.parent.removeChild(this.specialAnim),this.specialAnim=null)},Object.defineProperty(t.prototype,"shieldTip",{set:function(e){this._bl=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(GoodsInstance.prototype,"GoodsInstance");var TurnplatePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TurnplatePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().onButtonEnable(this.btn_one,!0),GameCommon.getInstance().onButtonEnable(this.btn_ten,!0),this.btn_goto_pointsShop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnGoto,this),this.btn_one.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),this.btn_ten.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTen,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TURNPLATE_FILT_MESSAGE.toString(),this.onRunALottery,this),Tool.addTimer(this.onCountDown,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_goto_pointsShop.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnGoto,this),this.btn_one.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),this.btn_ten.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTen,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TURNPLATE_FILT_MESSAGE.toString(),this.onRunALottery,this),Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onRefresh=function(){this.onUpdateCurrency(),this.onRunALottery()},t.prototype.onCountDown=function(){},t.prototype.onShowCD=function(e){this.label_endTime.text="活动结束剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onRunALottery=function(){GameCommon.getInstance().onButtonEnable(this.btn_one,!0),GameCommon.getInstance().onButtonEnable(this.btn_ten,!0)},t.prototype.onUpdateCurrency=function(e){void 0===e&&(e=null),this.label_points.text=DataManager.getInstance().playerManager.player.points+"",this.label_gold.text=DataManager.getInstance().playerManager.player.gold+""},t.prototype.onTouchBtnOne=function(){this.onSendMessage(0)},t.prototype.onTouchBtnTen=function(){this.onSendMessage(1)},t.prototype.onTouchBtnGoto=function(){var e=[SHOP_TYPE.TURNPLATE];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ShopPanel",e))},t.prototype.onSendMessage=function(e){var t;switch(e){case 0:t=this.model.money.num;break;case 1:t=this.model.moneyOneKey.num}if(DataManager.getInstance().playerManager.player.gold<t)return void GameCommon.getInstance().addAlert("钻石不足");var n=new Message(MESSAGE_ID.TURNPLATE_FILT_MESSAGE);n.setByte(e),GameCommon.getInstance().sendMsgToServer(n),GameCommon.getInstance().onButtonEnable(this.btn_one,!1),GameCommon.getInstance().onButtonEnable(this.btn_ten,!1)},t}(BaseWindowPanel);__reflect(TurnplatePanel.prototype,"TurnplatePanel");var LuckTurnplateManager=function(){function e(){this.currWheel=1,this.currInfo=[],this.multiple=[2,3,4,5,10,20]}return e.prototype.parseMessage=function(e){this.currWheel=e.getInt(),this.totalMoney=e.getInt(),this.needMoney=e.getInt()},e.prototype.parseWinPrizeMessage=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=new WinPrizeData,t.parseMessage(e),this.currInfo.push(t);this.onfilter()},e.prototype.getTextFlow=function(){for(var e,t=[],n=0;n<this.currInfo.length;n++)e=this.currInfo[n],t.push({text:e.name,style:{textColor:2661098}}),t.push({text:" 投资"+e.invest+"钻石获得",style:{textColor:16777215}}),t.push({text:this.multiple[e.gears]+"倍返还",style:{textColor:16426046}}),t.push({text:", 共计",style:{textColor:16777215}}),t.push({text:e.winPrize+"银币",style:{textColor:16426046}}),t.push({text:"\n",style:{}});return t.pop(),t},e.prototype.parsePlayMessage=function(e){var t=e.getByte();switch(t){case 0:GameCommon.getInstance().addAlert("数据异常");break;case 1:break;case 2:GameCommon.getInstance().addAlert("钻石不足");break;case 3:GameCommon.getInstance().addAlert("未达到充值金额")}1==t&&(this.bidding=e.getByte(),this.currAward=e.getInt())},e.prototype.onfilter=function(){for(;this.currInfo.length>10;)this.currInfo.shift()},e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.getCanShowRedPoint=function(){var e=DataManager.getInstance().luckTurnplateManager;return e.needMoney>e.totalMoney?!1:!0},e}();__reflect(LuckTurnplateManager.prototype,"LuckTurnplateManager");var WinPrizeData=function(){function e(){}return e.prototype.parseMessage=function(e){this.name=e.getString(),this.invest=e.getString(),this.gears=e.getString(),this.winPrize=e.getString()},e}();__reflect(WinPrizeData.prototype,"WinPrizeData");var LuckTurnplateWinParam=function(){function e(){this.currAward=0,this.btnlabel="确定",this.callFunc=null,this.callObj=null,this.callParam=null,this.autocloseTime=6}return e}();__reflect(LuckTurnplateWinParam.prototype,"LuckTurnplateWinParam");var MonthCardData=function(){function e(){}return e}();__reflect(MonthCardData.prototype,"MonthCardData");var MonthCardManager=function(){function e(){this.card={}}return e.prototype.parseMessage=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=new cardData,t.parseMessage(e),this.card[t.id]=t},e.prototype.parseReceiveMessage=function(e){var t=e.getByte();this.card[t]},e.getTeQuan=function(e,t){for(var n=JsonModelManager.instance.getModelyueka()[e],a=n.tequan,i=a.split("#"),o=0;o<i.length;o++)if(t==parseInt(i[o].split(",")[0]))return parseInt(i[o].split(",")[1]);return 0},e}();__reflect(MonthCardManager.prototype,"MonthCardManager");var cardData=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getByte(),this.param=e.getInt(),this.reSetTime()},e.prototype.reSetTime=function(){this.currTime=egret.getTimer()},Object.defineProperty(e.prototype,"day",{get:function(){var e=this.param-Tool.toInt((egret.getTimer()-this.currTime)/1e3),t=Math.ceil(e/86400);return t},enumerable:!0,configurable:!0}),e}();__reflect(cardData.prototype,"cardData");var TEQUAN_TYPE;!function(e){e[e.SIXIANG=9]="SIXIANG",e[e.ZHUFU=10]="ZHUFU"}(TEQUAN_TYPE||(TEQUAN_TYPE={}));var CARD_TYPE;!function(e){e[e.MONTH=1]="MONTH",e[e.LIFELONG=2]="LIFELONG"}(CARD_TYPE||(CARD_TYPE={}));var OneDollarManager=function(){function e(){}return e}();__reflect(OneDollarManager.prototype,"OneDollarManager");var OneRebateSTManager=function(){function e(){this.buyTime=0,this.record=[]}return e.prototype.parseMessage=function(e){this.buyTime=e.getInt();var t=e.getByte();this.record=[];for(var n=0;t>n;n++)this.record.push(e.getInt())},e.prototype.onSendBuyMessage=function(){var e=new Message(MESSAGE_ID.ONEREBATEST_BUY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseBuyMessage=function(e){this.buyTime=e.getInt()},e.prototype.onSendReceiveMessage=function(e){var t=new Message(MESSAGE_ID.ONEREBATEST_RECEIVE_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseReceiveMessage=function(e){var t=e.getInt(),n=this.record.indexOf(t);-1==n&&this.record.push(t)},e.prototype.getCanBuyGift=function(){return!1},e.prototype.getCanReceiveGift=function(){return!1},e.prototype.getCanShowRedpoint=function(){return DataManager.getInstance().oneRebateSTManager.getCanBuyGift()?!0:DataManager.getInstance().oneRebateSTManager.getCanReceiveGift()?!0:!1},e}();__reflect(OneRebateSTManager.prototype,"OneRebateSTManager");var OrangeFeastManager=function(){function e(){this.canBuyID=0,this.currIndex=0}return e.prototype.parseMessage=function(e){this.canBuyID=e.getInt(),this.currIndex=e.getInt()},e}();__reflect(OrangeFeastManager.prototype,"OrangeFeastManager");var PlayCafeManager=function(){function e(){this.day=1,this.record={}}return e.prototype.onParseMessage=function(e){this.day=e.getByte(),this.day>3&&(this.day=3),this.record={};for(var t,n=1;n<=this.day;n++)t=new FestivalLoginbase,t.day=n,t.onParseMessage(e),this.record[n]=t},e.prototype.onSendLoginAwardReceive=function(e){var t=new Message(MESSAGE_ID.PLAYCAFE_EXCLUSIVE_AWARD_RECEIVE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onParseLoginAwardReceive=function(e){var t=this.record[e.getByte()];t&&(t.state=2)},e.prototype.checkLoginAwardCanReceive=function(){for(var e=1;e<=this.day;e++)if(this.checkLoginAwardCanReceiveByDay(e))return!0;return!1},e.prototype.checkLoginAwardCanReceiveByDay=function(e){var t=this.record[e];return t&&1==t.state?!0:!1},e}();__reflect(PlayCafeManager.prototype,"PlayCafeManager");var RechargeManager=function(){function e(){this.record={},this.curDayRecord={},this.firstCharge=0}return e.prototype.parseMessage=function(e){for(var t,n,a,i=e.getByte(),o=0;i>o;o++)t=e.getInt(),n=e.getInt(),a=e.getInt(),this.record[t]=n,this.curDayRecord[t]=a;this.firstCharge=e.getInt()},e.prototype.checkFirstRecharge=function(e){return this.record[e]?e==this.firstCharge&&1==this.record[e]?!1:!0:!1},e.prototype.checkVipDayRecharge=function(e){if(this.curDayRecord[e]||0==this.curDayRecord[e]){for(var t=JsonModelManager.instance.getModelvip()[DataManager.getInstance().playerManager.player.viplevel-1],n=t.doubleEveryday.split("#"),a=0;a<n.length;a++){var i=n[a].split(",");if(Number(i[0])==e&&Number(i[1])>this.curDayRecord[e])return!0}return!1}return!1},e.prototype.oneRecharge=function(){return!this.record[1]},e}();__reflect(RechargeManager.prototype,"RechargeManager");var SevDayLoginBase=function(){function e(e){this.day=e}return e.prototype.parseInfo=function(e){this.state=e.getByte()},e}();__reflect(SevDayLoginBase.prototype,"SevDayLoginBase");var SevDayObjectivebase=function(){function e(){}return e.prototype.parseInfo=function(e){this.id=e.getShort(),this.currNum=e.getInt(),this.getNum=e.getInt()},e}();__reflect(SevDayObjectivebase.prototype,"SevDayObjectivebase");var SevenDayCarnivalManager=function(){function e(){this.today=0}return e.prototype.getCurrDayInfo=function(e){var t=[[],[],[],[]];return t},e.prototype.parseSevDayInfo=function(e){var t;this.sevDayLogin={},this.sevDayObjective={};var n,a;for(this.endTime=e.getString(),this.today=e.getShort(),t=0;t<this.today;t++)n=new SevDayLoginBase(t+1),n.parseInfo(e),this.sevDayLogin[n.day]=n;var i=e.getShort();for(t=0;i>t;t++)a=new SevDayObjectivebase,a.parseInfo(e),this.sevDayObjective[a.id]=a;this.startTime=egret.getTimer();var o=DataManager.getInstance().playerManager.player.createTime,r=DataManager.getInstance().playerManager.player.currentTime;this.totalTime=Tool.toInt((6048e5-(r-Tool.formatZeroDate(new Date(o)).getTime()))/1e3);this.getCountDown()},e.prototype.getCountDown=function(){return this.totalTime-Tool.toInt((egret.getTimer()-this.startTime)/1e3)},e.prototype.parseSevDayLoginReceive=function(e){var t=e.getByte();this.sevDayLogin[t]&&(this.sevDayLogin[t].state=2)},e.prototype.parseSevDayObjectiveReceive=function(e){var t,n,a=e.getShort();for(t=0;a>t;t++)n=new SevDayObjectivebase,n.parseInfo(e),this.sevDayObjective[n.id]=n},e.prototype.getHasAwardGain=function(){return DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainLogin()?!0:DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainDay()?!0:!1},e.prototype.getHasAwardGainDay=function(){for(var e=1;7>=e;e++)if(DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainOneDay(e))return!0;return!1},e.prototype.getHasAwardGainOneDay=function(e){if(DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainLoginByDay(e))return!0;for(var t=DataManager.getInstance().sevenDayCarnivalManager.getCurrDayInfo(e),n=0;n<t.length;n++)if(DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainOneDayByTab(t[n],e))return!0;return!1},e.prototype.getHasAwardGainOneDayByTab=function(e,t){var n=DataManager.getInstance().sevenDayCarnivalManager.today;return t>n?!1:!1},e.prototype.getHasAwardGainOneDayObjective=function(e,t){return!1},e.prototype.getHasAwardGainLogin=function(){for(var e=1;7>=e;e++)if(DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainLoginByDay(e))return!0;return!1},e.prototype.getHasAwardGainLoginByDay=function(e){var t=DataManager.getInstance().sevenDayCarnivalManager.today;if(e>t)return!1;var n=DataManager.getInstance().sevenDayCarnivalManager.sevDayLogin[e];return n&&2!=n.state?!0:!1},e}();__reflect(SevenDayCarnivalManager.prototype,"SevenDayCarnivalManager");var ShenQiZhuanPanManager=function(){function e(){this.zhuanpanId=0,this.zhuanpanType=0,this.zhuanpanAwardNum=0,this.tp=0,this.currInfo=[],this.zhuanpanNum=0,this.payDay=1,this.payRecord=[],this.missionDatas={},this.zhuanpanRanks=[]}return e.prototype.parseHefuMissionList=function(e){this.missionDatas=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new TaskChainData;a.parseMsg(e),this.missionDatas[a.taskId]=a}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseHefuiMissonUpdate=function(e,t){void 0===t&&(t=0),t=0==t?e.getByte():t;for(var n=0;t>n;n++){var a=e.getShort(),i=this.missionDatas[a];i||(i=new TaskChainData,i.taskId=a,this.missionDatas[i.taskId]=i),i.progress=e.getLong(),i.count=e.getByte()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkHefuMissionRedPoint=function(){for(var e in this.missionDatas){var t=this.missionDatas[e];if(1==t.count)return!0}return!1},e.prototype.onParseMessage=function(e){var t=e.getByte();this.payRecord=[];for(var n=0;t>n;n++)this.payRecord.push(e.getByte());this.payDay=e.getByte()},e.prototype.parseZhuanpanRoundMsg=function(e){this.zhuanpanRound=e.getByte(),this.zhuanpanModel=JsonModelManager.instance.getModelshenqichouqian()[this.zhuanpanRound]},e.prototype.parseChongBang=function(e){this.chongbangLiBaoId=e.getByte(),this.chargeMoneyNum=e.getInt()},e.prototype.onParseZhuanPanMessage=function(e){if(this.treasureAwdIdx=e.getShort(),this.zhuanpanNum=e.getShort(),this.tp=e.getByte(),0!=this.tp){var t=e.getByte();if(1==t)this.zhuanpanType=e.getByte(),this.zhuanpanId=e.getShort(),this.zhuanpanAwardNum=e.getInt();else{this.temAward=[];for(var n=0;t>n;n++){var a=new AwardItem;a.type=e.getByte(),a.id=e.getShort(),a.num=e.getInt(),this.temAward.push(a)}}}},e.prototype.parseZhuanpanRankMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){this.zhuanpanRanks[n]||(this.zhuanpanRanks[n]=new ShenQiZhuanPanRank);var a=this.zhuanpanRanks[n];a.parseMsg(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getRedPoint=function(){return this.checkZhuanPanPoint()?!0:!1},e.prototype.checkZhuanPanPoint=function(){return this.zhuanpanModel&&DataManager.getInstance().bagManager.getGoodsThingNumById(this.zhuanpanModel.costList[0].id,this.zhuanpanModel.costList[0].type)>=this.zhuanpanModel.costList[0].num?!0:!1},e.prototype.onfilter=function(){for(;this.currInfo.length>10;)this.currInfo.shift()},e}();__reflect(ShenQiZhuanPanManager.prototype,"ShenQiZhuanPanManager");var ShenQiZhuanPanRank=function(){function e(){}return e.prototype.parseMsg=function(e){this.rank=e.getByte(),this.playerId=e.getInt(),this.playerName=e.getString(),this.viplevel=e.getByte(),this.lotteryNum=e.getInt()},e}();__reflect(ShenQiZhuanPanRank.prototype,"ShenQiZhuanPanRank");var ActivitySmeltManager=function(){function e(){this.smeltIds={},this.smeltNums={}}return e.prototype.parseInit=function(e){var t=e.getByte();this.smeltNums={};for(var n=0;t>n;n++){var a=e.getString();if(this.smeltNums[a]=e.getByte(),this.smeltNums[a]>0){var i=e.getString();this.smeltIds[a]=i}}},e.prototype.parseUpdateMsg=function(e){var t=e.getByte();99==t?this.parseInit(e):GameCommon.getInstance().addAlert("兑换成功"),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getSmeltPoint=function(e,t){void 0===e&&(e=5),void 0===t&&(t=5);var n=JsonModelManager.instance.getModelkaifuduihuan();for(var a in n)if(e==n[a].type||5==e)if(5==t){var i=GameCommon.getInstance().onParseAwardItemstr(n[a].firstRewards),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i[0].id);if(o>0)return!0;var i=GameCommon.getInstance().onParseAwardItemstr(n[a].otherRewards),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i[0].id);if(o>0)return!0}else if(1==t){var i=GameCommon.getInstance().onParseAwardItemstr(n[a].otherRewards),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i[0].id);if(o>0)return!0}else{var i=GameCommon.getInstance().onParseAwardItemstr(n[a].firstRewards),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i[0].id);if(o>0)return!0}return!1},e.wutanCount=5,e}();__reflect(ActivitySmeltManager.prototype,"ActivitySmeltManager");var ActSmeltData=function(){function e(){}return e.prototype.parseMsg=function(e){this.tp=e.getByte()},e}();__reflect(ActSmeltData.prototype,"ActSmeltData");var SpatBloodManager=function(){function e(){this.round=0,this.recharge=0,this.record={}}return Object.defineProperty(e.prototype,"data",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.parseMessage=function(e){this.round=e.getByte(),this.recharge=e.getInt();for(var t,n,a=e.getByte(),i=0;a>i;i++)t=e.getInt(),n=e.getInt(),this.record[t]=n},e.prototype.parseBuyMessage=function(e){var t=e.getInt(),n=e.getInt();this.record[t]=n},e.prototype.onSendBuyMessage=function(e){var t=new Message(MESSAGE_ID.SPATBLOOD_BUY_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.getCanShowRedpoint=function(){var e=DataManager.getInstance().spatBloodsManager;return 0==e.recharge?!1:!1},e}();__reflect(SpatBloodManager.prototype,"SpatBloodManager");var CollectWordManager=function(){function e(){}return e.prototype.parseMsg=function(e){},e.prototype.parseActMessage=function(e){this.roundNum=e.getByte()},e.prototype.onSendExchangeMessage=function(e){var t=new Message(MESSAGE_ID.COLLECTWORD_EXCHANGE_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.getCanShowRedPoint=function(){for(var e in JsonModelManager.instance.getModelfeastjizi()){var t=JsonModelManager.instance.getModelfeastjizi()[e];if(t.round==DataManager.getInstance().collectWordManager.roundNum){for(var n=0,a=0;a<t.costList.length;a++){var i=t.costList[a],o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.id);
if(o<i.num)break;n++}if(n==t.costList.length)return!0}}return!1},e}();__reflect(CollectWordManager.prototype,"CollectWordManager");var CollectWordData=function(){function e(){}return e}();__reflect(CollectWordData.prototype,"CollectWordData");var SignInManager=function(){function e(){this.signed=!0}return Object.defineProperty(e.prototype,"data",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.parseMessage=function(e){this.day=e.getShort(),this.signed=e.getBoolean()},e.prototype.onSendSignMessage=function(e){},e.prototype.parseSignMessage=function(e){this.day=e.getShort(),this.signed=!0},e.prototype.getCanShowRedPoint=function(){return!DataManager.getInstance().signInManager.signed},e}();__reflect(SignInManager.prototype,"SignInManager");var SpringActivityManager=function(){function e(){this.crashcowFreeTimes=0}return e.prototype.getCanShowRedPoint=function(){return DataManager.getInstance().tLDogzManager.getCanShowRedPoint()?!0:DataManager.getInstance().collectWordManager.getCanShowRedPoint()?!0:DataManager.getInstance().springActivityManager.getCanShowCashcowRedPoint()?!0:!1},e.prototype.onParseCrashcowLottery=function(e){for(var t,n=[],a=e.getByte(),i=0;a>i;i++)t=new AwardItem,t.parseMessage(e),n.push(t);this.crashcowFreeTimes=e.getByte();var o=new TurnplateAwardParam;o.desc="恭喜您获得以下奖励",o.titleSource="",o.itemAwards=n,o.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TurnplateAwardPanel",o))},e.prototype.getCanShowCashcowRedPoint=function(){return DataManager.getInstance().springActivityManager.crashcowFreeTimes>0},e.prototype.getCanShowPreheatRedPoint=function(){return DataManager.getInstance().springActivityManager.getCanShowCashcowRedPoint()?!0:!1},e}();__reflect(SpringActivityManager.prototype,"SpringActivityManager");var SpringTLShopManager=function(){function e(){this.round=0,this.record={}}return e.prototype.parseMessage=function(e){this.record={};var t;this.round=e.getByte();for(var n=e.getShort(),a=0;n>a;a++)t=new TLShopData,t.parseMessage(e),this.record[t.id]=t},e.prototype.parseBuyMessage=function(e){var t=new TLShopData;t.parseMessage(e),this.record[t.id]=t},e.prototype.getGoodsByRound=function(){},e}();__reflect(SpringTLShopManager.prototype,"SpringTLShopManager");var TLDogzManager=function(){function e(){this.record={}}return e.prototype.parseMessage=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=e.getByte(),this.record[t]=t},e.prototype.onSendExchangeMessage=function(e){var t=new Message(MESSAGE_ID.TLDOGZ_EXCHANGE_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseExchangeMessage=function(e){var t=e.getByte();this.record[t]=t},e.prototype.getCanExchangeByID=function(e){DataManager.getInstance().tLDogzManager,DataManager.getInstance().bagManager;return!1},e.prototype.getCanShowRedPoint=function(){return!1},e}();__reflect(TLDogzManager.prototype,"TLDogzManager");var CrossConsumeRankManager=function(){function e(){this.lotteryNum=0,this.consumeRanks=[]}return e.prototype.parseRankMsg=function(e){this.consumeRanks=[];for(var t=e.getByte(),n=0;t>n;n++){this.consumeRanks[n]||(this.consumeRanks[n]=new CrossServerConsumeRank);var a=this.consumeRanks[n];a.parseMsg(e)}this.lotteryNum=e.getInt(),this.round=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e)},Object.defineProperty(e.prototype,"models",{get:function(){this.curModel=[];for(var e in JsonModelManager.instance.getModelkuafuxiaohao())this.round==JsonModelManager.instance.getModelkuafuxiaohao()[e].round&&this.curModel.push(JsonModelManager.instance.getModelkuafuxiaohao()[e]);return this.curModel},enumerable:!0,configurable:!0}),e.prototype.getMyRank=function(e){for(var t in this.consumeRanks){var n=this.consumeRanks[t];if(n.playerId==e)return n.rank}return-1},e}();__reflect(CrossConsumeRankManager.prototype,"CrossConsumeRankManager");var CrossServerConsumeRank=function(){function e(){}return e.prototype.parseMsg=function(e){this.rank=e.getByte(),this.playerId=e.getInt(),this.playerName=e.getString(),this.viplevel=e.getByte(),this.lotteryNum=e.getInt()},e}();__reflect(CrossServerConsumeRank.prototype,"CrossServerConsumeRank");var TotalConsumeManager=function(){function e(){this.consume_meRank=-1,this.consumeturnplate_num=0,this.turnplateNum=0,this._consumeitemScore=0,this.consumeitem_ranks=[]}return e.prototype.parseMessage=function(e){if(this.consumeitem_round=e.getByte(),this.consumeitem_pro=e.getInt(),this._consumeitemScore=0,!this.consumeitemModel||this.consumeitemModel.round!=this.consumeitem_round){for(var t in JsonModelManager.instance.getModelleijixiaohao()){var n=JsonModelManager.instance.getModelleijixiaohao()[t];if(n.round==this.consumeitem_round){this.consumeitemModel=n,GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onListenerConsume,this);break}}this.onRequestTurnplateInfoMsg()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onListenerConsume=function(e){if(this.consumeitemModel)if(DataManager.getInstance().activityManager.getActIsOpen(ACTIVITY_BRANCH_TYPE.CONSUME_ITEM)){var t=e.message;if(t&&this.consumeitemModel.itemId==t.id&&t.type==GOODS_TYPE.ITEM){this._consumeitemScore+=this.consumeitemModel.jifen;var n=parseInt(Constant.get(Constant.LEIJIXIAOHAO_SCORE)),a=this.consumeitemModel.jifen*this.consumeitem_pro-n*this.consumeturnplate_num;n>a&&a+this._consumeitemScore>=n&&this.requestConsumeItemMsg()}}else GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onListenerConsume,this),this.consumeitemModel=null},e.prototype.requestConsumeItemMsg=function(){var e=new Message(MESSAGE_ID.ACTIVITY_CONSUMEITEM_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseRankMsg=function(e){this.consumeitem_ranks=[],this.consume_meRank=-1;for(var t=e.getByte(),n=0;t>n;n++){this.consumeitem_ranks[n]||(this.consumeitem_ranks[n]=new CrossServerConsumeRank);var a=this.consumeitem_ranks[n];a.parseMsg(e),a.playerId==DataManager.getInstance().playerManager.player.id&&(this.consume_meRank=a.rank)}this.consumeitem_pro=e.getInt(),this._consumeitemScore=0,GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onRequestTurnplateInfoMsg=function(){var e=new Message(MESSAGE_ID.ACTIVITY_CONSUME_TURNPLATE_MSG);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseTurnplateMsg=function(e){this.consumeturnplate_num=e.getShort();var t,n=e.getByte();1==n?(t=new AwardItem(e.getByte(),e.getShort(),e.getInt()),this.updateTurnplateNum(),GameCommon.getInstance().receiveMsgToClient(e,t)):(this.updateTurnplateNum(),GameCommon.getInstance().receiveMsgToClient(e,null))},e.prototype.updateTurnplateNum=function(){if(this.consumeitemModel){var e=parseInt(Constant.get(Constant.LEIJIXIAOHAO_SCORE));this.turnplateNum=Math.floor(Math.max(0,this.consumeitemModel.jifen*this.consumeitem_pro-e*this.consumeturnplate_num)/e)}else this.turnplateNum=0},e.prototype.oncheckTurnplateRedPoint=function(){return this.turnplateNum>0},e.prototype.onCheckRedPoint=function(){return this.oncheckTurnplateRedPoint()?!0:!1},e}();__reflect(TotalConsumeManager.prototype,"TotalConsumeManager");var TreasureRankManager=function(){function e(){this.my_integral=0,this.record={}}return e.prototype.parseMessage=function(e){this.round=e.getByte(),this.my_integral=e.getInt()},e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.TREASURE_RANK_LIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseTreasureRankMessage=function(e){this.my_integral=e.getInt(),this.record={};for(var t,n=e.getByte(),a=1;n>=a;a++)t=new TreasureRankBase,t.parseMessage(e),this.record[a]=t},Object.defineProperty(e.prototype,"data",{get:function(){var e,t,n=[];switch(this.activityId){case ACTIVITY_BRANCH_TYPE.TREASURE_RANK:t=JsonModelManager.instance.getModelxunbaobang();break;case ACTIVITY_BRANCH_TYPE.TREASURE_RANK2:t=JsonModelManager.instance.getModelxunbaobang2();break;default:t=JsonModelManager.instance.getModelxunbaobang()}var a=1;for(var i in t)e=t[i],e.round==this.round&&(e.currRank=a,n.push(e),a++);return n},enumerable:!0,configurable:!0}),e}();__reflect(TreasureRankManager.prototype,"TreasureRankManager");var TreasureRankBase=function(){function e(){}return e.prototype.parseMessage=function(e){this.playerID=e.getInt(),this.name=e.getString(),this.integral=e.getInt(),this.vipLv=e.getByte(),this.headID=e.getByte(),this.headFrame=e.getByte()},e}();__reflect(TreasureRankBase.prototype,"TreasureRankBase");var ActivityTuangouManager=function(){function e(){this.crossPayMyRank=0,this.crossPayRankMoney=0,this.tuangou_buyIds=[],this.crossPayRanks=[]}return e.prototype.parseTuangouMsg=function(e){this.tuangou_buyIds=[],this.tuangou_ZoneMoney=e.getInt(),this.tuangou_MeMoney=e.getInt();for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.tuangou_buyIds.indexOf(a)<0&&this.tuangou_buyIds.push(a)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseCrossServerPayRankMsg=function(e){this.crossPayRanks=[],this.crossPayMyRank=0,this.crossPayRankMoney=0;for(var t=e.getByte(),n=0;t>n;n++){var a=new CrossServerPayRank;a.parseMsg(e),this.crossPayRanks.push(a),a.playerId==DataManager.getInstance().playerManager.player.id&&(this.crossPayMyRank=a.rank)}this.crossPayRankMoney=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.oncheckTuangouRpoint=function(){return!1},e}();__reflect(ActivityTuangouManager.prototype,"ActivityTuangouManager");var CrossServerPayRank=function(){function e(){}return e.prototype.parseMsg=function(e){this.rank=e.getByte(),this.playerId=e.getInt(),this.playerName=e.getString(),this.viplevel=e.getByte(),this.payNum=e.getInt()},e}();__reflect(CrossServerPayRank.prototype,"CrossServerPayRank");var VipManager=function(){function e(){this.zhuanpanNum=0,this.curDayzhuanpanNum=0,this._treasureAwdIdx=0,this._treasuretimes=0,this.zhuanpanId=0,this.zhuanpanType=0,this.zhuanpanAwardNum=0,this._vipNum=0}return e.prototype.onParseZhuanPanMessage=function(e){this.curDayzhuanpanNum=e.getShort(),this.zhuanpanNum=e.getInt(),this.zhuanpanType=e.getByte(),this.zhuanpanId=e.getShort(),this.zhuanpanAwardNum=e.getInt()},e.prototype.onParseZhuanPanGetAwardNum=function(e){this.treasureAwdIdx=e.getShort()},e.prototype.onParseInit=function(e){this.curDayzhuanpanNum=e.getShort(),this.zhuanpanNum=e.getInt(),this.treasureAwdIdx=e.getShort()},e.prototype.getZhuanPanPoint=function(){if(this.getXiangZiPoint())return!0;if(0==DataManager.getInstance().playerManager.player.viplevel)return!1;for(var e=JsonModelManager.instance.getModelvip()[DataManager.getInstance().playerManager.player.viplevel-1],t=e.weals.split("#"),n=0;n<t.length;n++){var a=t[n].split(",");if(11==Number(a[0])&&(this._vipNum=Number(a[1]),this._vipNum-DataManager.getInstance().vipManager.curDayzhuanpanNum>0))return!0}return!1},e.prototype.getXiangZiPoint=function(){for(var e=DataManager.getInstance().vipManager,t=JsonModelManager.instance.getModelzhuanpanvip()[1],n=t.box.split("#"),a=0;5>a;a++){var i=n[a]?n[a].split(","):null;if(!i)break;var o=parseInt(i[0]);if(e.treasureAwdIdx<o&&e.zhuanpanNum>=o)return!0}return!1},e}();__reflect(VipManager.prototype,"VipManager");var VipData=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getByte(),this.time=e.getInt(),this.isCanReceive=1==e.getByte()},e}();__reflect(VipData.prototype,"VipData");var WelfareManager=function(){function e(){this.welfare={},this.isOpenWelfare=!1,this.isRecharge=!1}return e.prototype.parseMessage=function(e){var t,n=e.getByte();this.isRecharge=!1,this.welfare={};for(var a=0;n>a;a++)t=new WelfareData,t.parseMessage(e),this.welfare[t.id]=t,t.isAcquire&&(this.isRecharge=t.isAcquire);this.isRecharge&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN))},e.prototype.onSendMessage=function(){},e.prototype.isCanShowWelfare=function(){var e;for(var t in DataManager.getInstance().welfareManager.welfare)if(e=DataManager.getInstance().welfareManager.welfare[t],!e.isAcquire&&20==DataManager.getInstance().playerManager.player.level)return DataManager.getInstance().welfareManager.isOpenWelfare=!0,!0;return!1},e}();__reflect(WelfareManager.prototype,"WelfareManager");var WelfareData=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getByte(),this.isAcquire=1==e.getByte()},e}();__reflect(WelfareData.prototype,"WelfareData");var WishingWellManager=function(){function e(){this.round=0,this.time=0,this.record=[]}return e.prototype.onParseMessage=function(e){this.record=[],this.round=e.getByte(),this.time=e.getByte();for(var t=e.getByte(),n=0;t>n;n++)this.record.push(e.getByte())},Object.defineProperty(e.prototype,"data",{get:function(){var e,t=JsonModelManager.instance.getModelxuyuanchi();for(var n in t)t[n].round==this.round&&(e=t[n]);return e},enumerable:!0,configurable:!0}),e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.WISHINGWELL_ADVANCE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseAdvanceMessage=function(e){this.time=e.getByte(),this.currAwardID=e.getByte(),this.record.push(this.currAwardID)},e}();__reflect(WishingWellManager.prototype,"WishingWellManager");var BodyFactory=function(){function e(){this._bodyFactoryCache={},this._damagefntCache=[],this._shadowbodyCache=[],this._dropbodyCache=[]}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.getBodyActionType=function(e){var t="";switch(e){case BODY_TYPE.PLAYER:case BODY_TYPE.ROBOT:t="PlayerBody";break;case BODY_TYPE.MONSTER:t="MonsterBody";break;case BODY_TYPE.BOSS:t="BossBody";break;case BODY_TYPE.NPC:case BODY_TYPE.COLLECTION:t="NpcBody";break;case BODY_TYPE.PET:t="PetBody";break;case BODY_TYPE.RETINUE:t="RetinueBody";break;case BODY_TYPE.MAGIC:t="MagicBody"}return t},e.prototype.createMonsterBody=function(e,t){var n,a,i=this.getBodyActionType(t);if(a=this._bodyFactoryCache[i]?this._bodyFactoryCache[i]:[],this._bodyFactoryCache[i]=a,a.length>0)n=a.shift(),n.data.updateData(e,t),n.onRefreshData();else{var o;switch(t){case BODY_TYPE.MONSTER:o=new MonsterData(e,t);break;case BODY_TYPE.BOSS:o=new MonsterData(e,t);break;case BODY_TYPE.NPC:case BODY_TYPE.COLLECTION:o=new NpcData(e,t)}n=new window[i],n.data=o}return n},e.prototype.createPlayerBody=function(e,t){var n,a=this.getBodyActionType(e);this._bodyFactoryCache[a]||(this._bodyFactoryCache[a]=[]);var i=this._bodyFactoryCache[a];return 0==i.length&&i.push(new PlayerBody),n=i.shift(),n.data=t,n.onUpdateAvatar(),n},e.prototype.createPetBody=function(e){var t,n=this.getBodyActionType(BODY_TYPE.PET);this._bodyFactoryCache[n]||(this._bodyFactoryCache[n]=[]);var a=this._bodyFactoryCache[n];return 0==a.length?(t=new PetBody,t.data=new PetBodyData(e)):(t=a.shift(),t.data.playerData=e),t},e.prototype.createRetinueBody=function(e){var t,n=this.getBodyActionType(BODY_TYPE.RETINUE);this._bodyFactoryCache[n]||(this._bodyFactoryCache[n]=[]);var a=this._bodyFactoryCache[n];return 0==a.length?(t=new RetinueBody,t.data=new RetinueBodyData(e)):(t=a.shift(),t.data.playerData=e),t},e.prototype.createRetinueArrow=function(){return this._retinueArrows||(this._retinueArrows=[]),0==this._retinueArrows.length&&this._retinueArrows.push(new Animation("pet_skill_1")),this._retinueArrows.shift()},e.prototype.onRecoverRetinueArrow=function(e){this._retinueArrows&&(this._retinueArrows.indexOf(e)>=0||(egret.Tween.removeTweens(e),e.parent&&e.parent.removeChild(e),this._dropbodyCache.length>20?(e.onDestroy(),e=null):this._retinueArrows.push(e)))},e.prototype.onRecovery=function(e){if(e&&e.data.bodyType!=BODY_TYPE.SELF){e.parent&&e.parent.removeChild(e),e.onClearTargets(),e.onDestroy();var t,n=this.getBodyActionType(e.data.bodyType);if(t=this._bodyFactoryCache[n],!(t.indexOf(e)>=0)){if(t.length>20)return void(e=null);e.onReset(),t.push(e),e.data.bodyType!=BODY_TYPE.RETINUE&&e.onHideHeadBar(!0)}}},e.prototype.onCreateShadow=function(e){var t;return t=this._shadowbodyCache.length>0?this._shadowbodyCache.shift():new ShadowBody,t.onRefresh(e),t},e.prototype.onRecoveryShadow=function(e){e.onRemove(),this._shadowbodyCache.push(e)},e.prototype.onCreateDamageFont=function(){return this._damagefntCache.length>0?this._damagefntCache.shift():new FlyFontBody},e.prototype.onRecoveryDamageFont=function(e){e.floatGC(),this._damagefntCache.indexOf(e)>=0||(this._damagefntCache.length>100?e=null:this._damagefntCache.push(e))},e.prototype.onCreateDropBody=function(e,t,n){if(this._dropbodyCache.length>0){var a=this._dropbodyCache.shift();return a.onUpdate(e,t,n),this._dropbodyCache.shift()}return new DropBody(e,t,n)},e.prototype.onRecoveryDropBody=function(e){e.onDestroy(),this._dropbodyCache.indexOf(e)>=0||(this._dropbodyCache.length>20?e=null:this._dropbodyCache.push(e))},e._instance=null,e}();__reflect(BodyFactory.prototype,"BodyFactory");var BODY_TYPE;!function(e){e[e.SELF=0]="SELF",e[e.PLAYER=1]="PLAYER",e[e.MONSTER=2]="MONSTER",e[e.BOSS=3]="BOSS",e[e.ROBOT=4]="ROBOT",e[e.NPC=5]="NPC",e[e.COLLECTION=6]="COLLECTION",e[e.PET=7]="PET",e[e.RETINUE=8]="RETINUE",e[e.MAGIC=9]="MAGIC",e[e.SHADOW=1001]="SHADOW"}(BODY_TYPE||(BODY_TYPE={}));var ArenaManager=function(){function e(){this.ladderArenaData=new LadderAreneData,this.arenaData=new ArenaData,this.ladderRanks=[]}return e.prototype.parseLadderAreneMsg=function(e){this.ladderArenaData.parseInitMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseInspire=function(e){this.ladderArenaData.inspireCount=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseLadderBuyMsg=function(e){this.ladderArenaData.fightCount=e.getInt(),this.ladderArenaData.leftRelive=e.getInt(),this.ladderArenaData.buyCount=e.getInt(),GameCommon.getInstance().receiveMsgToClient(new Message(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE))},e.prototype.parseLadderRankUpdate=function(e){if(this.ladderRanks.length>0)for(var t=this.ladderRanks.length-1;t>=0;t--)this.ladderRanks[t]=null,this.ladderRanks.splice(t,1);for(var n=e.getByte(),t=0;n>t;t++){var a=new LadderRankData;a.parseRankMsg(e),this.ladderRanks.push(a)}this.ladderRanks.length>0&&(this.selfladderRankData=this.ladderRanks.shift()),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaMsg=function(e){this.arenaData.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaEnemyMsg=function(e){this.arenaData.parseEnmeyMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaBuyMsg=function(e){this.arenaData.fightCount=e.getInt(),this.arenaData.buyCount=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onSendLadderInfoMsg=function(){if(FunDefine.isFunOpen(FUN_TYPE.FUN_ARENA)){var e=new Message(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},e.prototype.onSendLocalArenaInfoMsg=function(){if(FunDefine.isFunOpen(FUN_TYPE.FUN_ARENA)){var e=new Message(MESSAGE_ID.ARENE_INFO_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},e.prototype.onSendServerArenaInfoMsg=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_INFO_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.getLadderPointShow=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_LADDER)?0!=DataManager.getInstance().arenaManager.ladderArenaData.ladderStatus?!1:FunDefine.isFunOpen(FUN_TYPE.FUN_LADDER)&&this.ladderArenaData.fightCount>0?!0:!1:void 0},e}();__reflect(ArenaManager.prototype,"ArenaManager");var LadderAreneData=function(){function e(){this.inspireCount=0,this.statusTime=0,this.leftRelive=0,this.wincount=0,this.heroHpNum=0,this.heroShieldNum=0,this.heroRebornNum=0}return e.prototype.parseInitMsg=function(e){this.scoreCount=e.getInt(),this.inspireCount=e.getInt(),this.ladderStatus=e.getByte(),this.statusTime=1e3*e.getInt()+egret.getTimer(),this.leftRelive=e.getInt(),this.leftRelive=1e3*(this.leftRelive-1)+egret.getTimer(),this.wincount=e.getInt(),this.heroHpNum=e.getLong(),this.heroShieldNum=e.getLong(),this.heroRebornNum=e.getByte(),this.fightCount=e.getByte(),this.leftRecover=e.getShort(),this.leftRecover=1e3*(this.leftRecover-1)+egret.getTimer(),this.onUpdateScore()},e.prototype.onUpdateScore=function(){var e=0;this._score=this.scoreCount;var t,n=JsonModelManager.instance.getModelttre();for(var a in n)if(t=n[a],e=t.maxjifen,e>this.scoreCount){this._model=t;break}},Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),e}();__reflect(LadderAreneData.prototype,"LadderAreneData");var LADDER_GRADE;!function(e){e[e.Bronze=1]="Bronze",e[e.Silver=2]="Silver",e[e.Gold=3]="Gold",e[e.Diamond=4]="Diamond"}(LADDER_GRADE||(LADDER_GRADE={}));var LadderRankData=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.parseRankMsg=function(t){e.prototype.parseMsg.call(this,t),this.rank=t.getInt(),this.score=t.getInt()},Object.defineProperty(t.prototype,"duanwei",{get:function(){var e,t=JsonModelManager.instance.getModelttre(),n=0;for(var a in t)if(n++,e=t[a],this.score<e.maxjifen)return n;return e?n:1},enumerable:!0,configurable:!0}),t}(SimplePlayerData);__reflect(LadderRankData.prototype,"LadderRankData");var LocalArenaData=function(){function e(){this.enemyList=[]}return e.prototype.parseMsg=function(e){try{this.rank=e.getInt(),this.bestRank=e.getInt(),this.rankReward=e.getInt(),this.fightCount=e.getInt(),this.buyCount=e.getInt(),this.parseEnmeyMsg(e)}catch(t){}},e.prototype.parseEnmeyMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){this.enemyList.length<=n&&this.enemyList.push(new ArenaEnemy);var a=this.enemyList[n];a.parseMsg(e)}this.enemyList.sort(function(e,t){return e.rank-t.rank})},e}();__reflect(LocalArenaData.prototype,"LocalArenaData");var LocalArenaRankData=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.parseMsg=function(e){this.playerData.parseMsg(e)},t}(ArenaRankData);__reflect(LocalArenaRankData.prototype,"LocalArenaRankData");var LocalArenaManager=function(){function e(){this.localArenaData=new LocalArenaData}return e.prototype.parseArenaMsg=function(e){this.localArenaData.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaEnemyMsg=function(e){this.localArenaData.parseEnmeyMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaBuyMsg=function(e){this.localArenaData.fightCount=e.getInt(),this.localArenaData.buyCount=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseArenaFightMsg=function(e){this.localArenaData.fightCount=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseFirstAwardMsg=function(e){this.localArenaData.rankReward=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getRedPointShow=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_ARENA)&&this.localArenaData.fightCount>0?!0:!1},e.prototype.getRedArenaFirstAwd=function(){if(this.localArenaData){var e=JsonModelManager.instance.getModelarenaReward();for(var t in e){var n=e[t];if(this.localArenaData.rank<n.rank&&(this.localArenaData.rankReward<=0||this.localArenaData.rankReward>n.rank))return!0}}return!1},e.prototype.getRankAwards=function(e){var t,n=JsonModelManager.instance.getModelarenaRankReward();for(var a in n)if(t=n[a],t.highRank>=e&&t.lowRank<=e)break;return t?GameCommon.getInstance().onParseAwardItemstr(t.rate):null},e}();__reflect(LocalArenaManager.prototype,"LocalArenaManager");var AttrData=function(){function e(e,t){this._index=e,this._value=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();__reflect(AttrData.prototype,"AttrData");var BagManager=function(){function e(){this._zhanwenCfgs=JsonModelManager.instance.getModelzhanwen(),this._bagThingsTypeList={},this._bagThingAllList={},this.betterEquipAry={},this._useLimit={},this.rnuesList={};for(var e=0;e<GameDefine.Max_Role_Num;e++)this.betterEquipAry[e]={}}return e.prototype.parseInitBag=function(e){this._equipMax=e.getShort();for(var t=e.getShort(),n=0;t>n;n++){var a=new EquipThing;a.parseEquipMessage(e),this.addBagThing(a)}for(var i=e.getShort(),n=0;i>n;n++){var o=new ServantEquipThing;o.parseMessage(e),this.addBagThing(o)}for(var r=e.getShort(),n=0;r>n;n++){var s=new ItemThing;s.parseItem1(e),this.addBagThing(s)}for(var h=e.getShort(),n=0;h>n;n++){var l=new BoxThing;l.parseItem1(e),this.addBagThing(l)}for(var g=e.getShort(),n=0;g>n;n++){var c=new RnuesThing;c.parseItem1(e),this.rnuesList[c.modelId]=c}this.onupdateBestEquips()},e.prototype.parseAddBag=function(e){for(var t=e.getByte(),n=0;t>n;++n){var a,i,o=e.getByte(),r=1;if(o==GOODS_TYPE.MASTER_EQUIP){var s=new EquipThing;s.parseEquipMessage(e),this.addBagThing(s),this.sortOnEquipList(s),a=s.model,a.quality=s.quality,this.onShowEquipBagIsFullTips(),this.onCheckObtainHintEquip()}else if(o==GOODS_TYPE.SERVANT_EQUIP){var h=new ServantEquipThing;h.parseMessage(e),this.addBagThing(h),a=h.model,a.quality=h.quality,this.onShowEquipBagIsFullTips()}else if(o==GOODS_TYPE.BOX){var l=new BoxThing;l.parseItem1(e),i=this._bagThingAllList[l.idKey],this.addBagThing(l),a=l.model,r=i?l.num-i.num:l.num,l.model.useful>0}else if(o==GOODS_TYPE.ITEM){var g=new ItemThing;g.parseItem1(e),i=this._bagThingAllList[g.idKey],this.addBagThing(g),a=g.model,r=i?g.num-i.num:g.num,g.model.useful>0&&-1!=GameDefine.HINT_PRIORITY.indexOf(g.model.gotype)&&DataManager.getInstance().hintManager.getHintSystemByType(g.model.gotype)}else if(o==GOODS_TYPE.GEM){var c=new GemThing;c.parseItem1(e),this.addBagThing(c),a=c.model,a.quality=c.quality}else if(o==GOODS_TYPE.RNUES){var p=new RnuesThing;p.parseItem1(e),a=p.model,i=this.rnuesList[p.modelId],this.rnuesList[p.modelId]=p,r=i?p.num-i.num:p.num}var u=e.getShort();GameCommon.getInstance().onGetThingAlert(a,r,u)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),o)},e.prototype.praseRemoveBag=function(e){var t=e.getByte(),n=e.getShort(),a=e.getInt();this.removeBagThing(t,n,a),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),t)},e.prototype.removeBag=function(e,t,n){this.removeBagThing(e,t,n),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),e)},e.prototype.addBagThing=function(e){var t,n=this._bagThingAllList[e.idKey];if(this._bagThingsTypeList[e.type]||(this._bagThingsTypeList[e.type]=[]),t=this._bagThingsTypeList[e.type],n){var a=t.indexOf(n);0>a?t.push(e):t.splice(a,1,e)}else t.push(e);this._bagThingAllList[e.idKey]=e,n=null},e.prototype.removeBagThing=function(e,t,n){var a=e+"_"+t,i=this._bagThingAllList[a];if(26==e){var o=new RnuesThing;o.modelId=t,o.num=n,o.quality=o.model.quality,this.rnuesList[o.modelId]=o}if(i){if(i.type==GOODS_TYPE.MASTER_EQUIP)this.sortOnEquipList(i,!1),this.onShowEquipBagIsFullTips();else if(i.type==GOODS_TYPE.SERVANT_EQUIP)this.onShowEquipBagIsFullTips();else if(i.type==GOODS_TYPE.BOX&&i.num>n&&i.model&&i.model.rewards&&i.model.rewards[0]&&i.model.rewards[0].type==GOODS_TYPE.EXP){var r=GameCommon.getInstance().getThingModel(GOODS_TYPE.EXP,0),s=i.num-n;GameCommon.getInstance().onGetThingAlert(r,i.model.rewards[0].num*s,GOODS_CHANGE_TYPE.GOODS_USE_ADD)}var h=0==n,l=this._bagThingsTypeList[e];h?(l&&Tool.removeArrayObj(l,i),delete this._bagThingAllList[a],i=null):i.num=n}},e.prototype.getRnuesList=function(e){return this.rnuesList[e]?this.rnuesList[e].num:0},e.prototype.getRnuesLvPoint=function(e){if(void 0===e&&(e=-1),!FunDefine.isFunOpen(FUN_TYPE.FUN_RNUES))return!1;if(e>=0){for(var t in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[t].id)>=2&&this._zhanwenCfgs[t].type==e&&this._zhanwenCfgs[Number(t)+1+""]&&this._zhanwenCfgs[Number(t)+1+""].type==this._zhanwenCfgs[t].type)return!0}else for(var t in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[t].id)>=2&&this._zhanwenCfgs[Number(t)+1+""]&&this._zhanwenCfgs[Number(t)+1+""].type==this._zhanwenCfgs[t].type)return!0;return!1},e.prototype.getEquipRnuesPoint=function(e){if(void 0===e&&(e=-1),e>=0)for(var t=0,n=5*e-5;5*e>n;n++){var a=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[n];if(0==a){for(var i in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[i].id)>0&&this._zhanwenCfgs[i].type==t)return!0}else for(var i in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[i].id)>0&&this._zhanwenCfgs[i].type==t&&this._zhanwenCfgs[i].id>a)return!0;t+=1}else for(var t=0,n=0;50>n;n++){var a=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[n];if(0==a){for(var i in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[i].id)>0&&this._zhanwenCfgs[i].type==t)return!0}else for(var i in this._zhanwenCfgs)if(this.getRnuesList(this._zhanwenCfgs[i].id)>0&&this._zhanwenCfgs[i].type==t&&this._zhanwenCfgs[i].id>a)return!0;t+=1,t>=5&&(t=0)}return!1},e.prototype.onGetEquipLvUpPoint=function(e){if(void 0===e&&(e=-1),e>=0)for(var t=5*e-5;5*e>t;t++){var n=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[t];if(n>0){var a=JsonModelManager.instance.getModelzhanwen()[n],i=JsonModelManager.instance.getModelzhanwen()[n+1];if(i&&i.type==a.type&&DataManager.getInstance().bagManager.getRnuesList(n)>0)return!0}}else for(var t=0;50>t;t++){var n=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[t];if(n>0){var a=JsonModelManager.instance.getModelzhanwen()[n],i=JsonModelManager.instance.getModelzhanwen()[n+1];if(i&&i.type==a.type&&DataManager.getInstance().bagManager.getRnuesList(n)>0)return!0}}return!1},e.prototype.getAllRnuesPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_RNUES)?this.getRnuesLvPoint()?!0:this.checkAllEquipPointPoint()?!0:!1:!1},e.prototype.checkAllEquipPointPoint=function(e){if(void 0===e&&(e=-1),!FunDefine.isFunOpen(FUN_TYPE.FUN_RNUES))return!1;if(e>=0){if(this.getEquipRnuesPoint(e))return!0;if(this.onGetEquipLvUpPoint(e))return!0}else{if(this.getEquipRnuesPoint())return!0;if(this.onGetEquipLvUpPoint())return!0}return!1},e.prototype.onClothEquipAll=function(e){void 0===e&&(e=0);var t=this.getJobClothEquips(e);if(t.length>0){var n=new Message(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE);n.setByte(0),n.setByte(t.length);for(var a in t){var i=t[a];n.setByte(i.model.part),n.setShort(i.equipId),this.onRemoveClothhEquips(i)}GameCommon.getInstance().sendMsgToServer(n)}},e.prototype.sortOnEquipList=function(e,t){if(void 0===t&&(t=!0),t){var n=(e.model,Math.max(1,DataManager.getInstance().playerManager.player.coatardLv));e.model.coatardLv<=n&&this.onSaveCanClothEquips(e)}else this.onRemoveClothhEquips(e)},e.prototype.onSaveCanClothEquips=function(e,t){void 0===t&&(t=0);var n=e.model.part,a=this.betterEquipAry[t][n];if(a){if(a.idKey==e.idKey)return;a=GameCommon.getInstance().compareEquip(a,e,!0),a.idKey==e.idKey&&(this.betterEquipAry[t][n]=e)}else{var i=DataManager.getInstance().playerManager.player.getPlayerDataByOccp(t),o=i.getEquipBySlot(n);if(o.idKey==e.idKey)return;a=GameCommon.getInstance().compareEquip(o,e,!0),a.idKey==e.idKey&&(this.betterEquipAry[t][n]=e)}},e.prototype.onRemoveClothhEquips=function(e){for(var t=e.model,n=0;n<GameDefine.Max_Role_Num;n++){var a=this.betterEquipAry[n],i=a[t.part];if(i&&i.idKey==e.idKey){delete this.betterEquipAry[n][t.part];break}}},e.prototype.getJobClothEquips=function(e,t){void 0===t&&(t=0);var n=this.betterEquipAry[t],a=[];for(var i in n){var o=n[i];(0==e&&o.model.part<GameDefine.Equip_Slot_Num||1==e&&o.model.part>=GameDefine.Equip_Slot_Num&&o.model.part<2*GameDefine.Equip_Slot_Num||2==e&&o.model.part>=2*GameDefine.Equip_Slot_Num)&&a.push(o)}return a},e.prototype.onCheckObtainHintEquip=function(){var e=this.onCheckHasBestEquip();
e&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_OBTAINHINT_SHOW),new ObtainHintParam(HINT_TIPS_TYPE.EQUIP,e))},e.prototype.onCheckHasBestEquip=function(){for(var e=0;e<DataManager.getInstance().playerManager.player.playerDatas.length;e++)for(var t=(DataManager.getInstance().playerManager.player.playerDatas[e],0);t<GoodsDefine.EQUIP_SLOT_TYPE.length;t++){var n=GoodsDefine.EQUIP_SLOT_TYPE[t],a=this.betterEquipAry[e][n];if(a)return a}return null},e.prototype.onupdateBestEquips=function(){for(var e=this.getGoodsListByType(GOODS_TYPE.MASTER_EQUIP),t=0;t<e.length;t++)this.sortOnEquipList(e[t])},e.prototype.getGoodsListByType=function(e){var t=this._bagThingsTypeList[e];if(t)for(var n=t.length-1;n>=0;n--)t[n].num<=0&&t[n].type!=GOODS_TYPE.MASTER_EQUIP&&t[n].type!=GOODS_TYPE.SERVANT_EQUIP&&t.splice(n,1);else t=[];return t},e.prototype.getGoodsListByTypes=function(e){for(var t,n=[],a=0;a<e.length;a++)if(t=this._bagThingsTypeList[e[a]])for(var i=0;i<t.length;i++)n.push(t[i]);if(1==e[0])for(;n.length>this._equipMax;)n.shift();return n},e.prototype.getAllRunes=function(){var e,t=[];for(var n in this.rnuesList)e=this.rnuesList[n],e&&e.num>0&&t.push(this.rnuesList[n]);for(;t.length>this._equipMax;)t.shift();return t},e.prototype.getIsFullBag=function(){var e=this.getGoodsListByTypes(BagTypePanel.types[0]);return e.length==this._equipMax},e.prototype.getGoodsThingById=function(e,t){return void 0===t&&(t=GOODS_TYPE.ITEM),this._bagThingAllList[t+"_"+e]},e.prototype.getGoodsThingNumById=function(e,t){void 0===t&&(t=GOODS_TYPE.ITEM);var n=0,a=this.getGoodsThingById(e,t);return n=a?a.num:0},e.prototype.parseUpdateBag=function(e){for(var t=e.getShort(),n=0;t>n;n++){var a=e.getShort();this.removeBagThing(GOODS_TYPE.MASTER_EQUIP,a,0)}t=e.getShort();for(var n=0;t>n;n++){var a=e.getShort();this.removeBagThing(GOODS_TYPE.SERVANT_EQUIP,a,0)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),GOODS_TYPE.MASTER_EQUIP)},e.prototype.parseUpdateMasterBag=function(e){for(var t=e.getShort(),n=0;t>n;n++){var a=e.getInt();this.removeBagThing(GOODS_TYPE.MASTER_EQUIP,a,0)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),GOODS_TYPE.MASTER_EQUIP)},e.prototype.parseUpperlimit=function(e){e.getByte();this._equipMax=e.getShort(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUselimit=function(e){for(var t,n=e.getShort(),a=0;n>a;a++)t=new UseLimit,t.parseMessage(e),this._useLimit[t.id]=t},e.prototype.getEquipListCanSmelt=function(){var e=[],t=this.getGoodsListByType(GOODS_TYPE.MASTER_EQUIP);if(!t)return e;for(var n,a={},i=0;i<t.length;i++){var o=t[i];if(!(o.quality>GoodsQuality.Orange)){var r=o.model,s=this.betterEquipAry[0][r.part];if(!s||s.idKey!=o.idKey){var h=DataManager.getInstance().playerManager.player.getPlayerData().getEquipBySlot(o.model.part);if(h&&(n=GameCommon.getInstance().compareEquip(h,o,!1),n.idKey==h.idKey))e.push(o);else{var l=r.level+"_"+r.part;if(a[l]){var g=a[l];n=GameCommon.getInstance().compareEquip(g,o,!1),n.idKey==o.idKey?(a[l]=o,e.push(g)):e.push(o)}else a[l]=o}}}}return e},e.prototype.removeEquipByArr=function(e){for(var t=e.length,n=0;t>n;n++){var a=e[n].equipId;this.removeBagThing(GOODS_TYPE.MASTER_EQUIP,a,0)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_BAG_UPDATE),GOODS_TYPE.MASTER_EQUIP)},Object.defineProperty(e.prototype,"equipMax",{get:function(){return this._equipMax},enumerable:!0,configurable:!0}),e.prototype.cheakEquipbagIsFull=function(e){void 0===e&&(e=0);var t=this.getGoodsListByTypes([GOODS_TYPE.MASTER_EQUIP,GOODS_TYPE.SERVANT_EQUIP]);return t?t.length>=this.equipMax-e:!1},e.prototype.onShowEquipBagIsFullTips=function(){this.cheakEquipbagIsFull(11)?GameCommon.getInstance().onShowFuncTipsBar(FUNCTIP_TYPE.BAGFULL,"背包容量不足，请回收"):GameCommon.getInstance().onHideFuncTipsBar(FUNCTIP_TYPE.BAGFULL)},e.prototype.getCanOpenBox=function(){var e,t=DataManager.getInstance().bagManager.getGoodsListByType(GOODS_TYPE.BOX);for(var n in t)if(e=t[n])return!0;return!1},e.prototype.isOwnThis=function(e){for(var t,n,a=DataManager.getInstance().bagManager,i=!0,o=0;o<e.length;o++)if(t=e[o],n=a._bagThingAllList[t.idKey],!n||n.num<t.num)return!1;return i},e.prototype.getOneSeriesGemByGemType=function(e){var t,n=[],a=this._bagThingsTypeList[GOODS_TYPE.GEM];if(a){for(var i in a)t=a[i],t.model.type==e&&n.push(t);n=n.sort(function(e,t){return e.model.level>t.model.level?-1:1})}return n},e.prototype.getOneSeriesOBJGemByGemType=function(e){var t,n={},a=this._bagThingsTypeList[GOODS_TYPE.GEM];if(a)for(var i in a)t=a[i],t.model.type==e&&(n[t.modelId]=t);return n},e.prototype.getDomInateEquip=function(){for(var e,t=[],n=0;n<GameDefine.Domiante_IDs.length;n++)e=this.getGoodsThingById(GameDefine.Domiante_IDs[n],GOODS_TYPE.ITEM),e&&t.push(e);return t},e.prototype.getSmeltEquipNormal=function(){return this.getEquipListCanSmelt()},e.prototype.getSmeltEquipSpecial=function(e){void 0===e&&(e=-1);var t,n,a,i=[],o={},r=this.getGoodsListByType(GOODS_TYPE.SERVANT_EQUIP);if(!r)return i;for(var s=0;s<r.length;s++)if(t=r[s],n=r[s].model,!(t.issmelt||e>=0&&n.blesstype!=e))if(a=DataManager.getInstance().playerManager.player.getPlayerData().getBlessEquip(n.blesstype,n.part),a&&a.pingfenValue>=t.pingfenValue)i.push(t);else{var h=n.blesstype+"_"+n.part,l=o[h];l?l.pingfenValue>=t.pingfenValue?i.push(t):(o[h]=t,i.push(l)):o[h]=t}return i},e.prototype.getUseLimitNumByID=function(e){return this._useLimit[e]?this._useLimit[e].useTime:0},e.prototype.getEquipSmeltPointShow=function(){return this.getSmeltEquipCommonPoint()?!0:this.getSmeltEquipSpecialPointShow()?!0:!1},e.prototype.getSmeltEquipCommonPoint=function(){var e=this.getEquipListCanSmelt();return e.length>=GameDefine.SMELT_EQUIPS_NUM?!0:!1},e.prototype.getSmeltEquipSpecialPointShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_BLESS_SMELT))return!1;var e=this.getSmeltEquipSpecial();return e&&e.length>0?!0:!1},e.prototype.recordVipBoxOpenId=function(e){this._openVipBoxIds||(this._openVipBoxIds=[]),this._openVipBoxIds.indexOf(e)<0&&this._openVipBoxIds.push(e)},e.prototype.getItemCanUsePointShow=function(){var e=this.getGoodsListByType(GOODS_TYPE.BOX);if(!e)return!1;for(var t=0;t<e.length;t++)if(this.getItemCanUsePointShowByUID(e[t].modelId))return!0;return!1},e.prototype.getItemCanUsePointShowByUID=function(e){if(this._openVipBoxIds&&this._openVipBoxIds.indexOf(e)>=0)return!1;var t=this.getGoodsThingNumById(e),n=JsonModelManager.instance.getModelbox()[e],a=this.getUseLimitNumByID(e);if(-1==n.useMax)return!0;var i=n.useMax-a;return t>0&&i>0?!0:!1},e.prototype.getAllRedEquip=function(){var e=[],t=DataManager.getInstance().bagManager.getGoodsListByType(GOODS_TYPE.MASTER_EQUIP);if(t)for(var n=0;n<t.length;n++){var a=t[n],i=this.betterEquipAry[0][a.model.part];i&&i.idKey==a.idKey||a.quality==GoodsQuality.Red&&e.push(a)}return e},e.prototype.getAllGoldEquip=function(){var e=[],t=DataManager.getInstance().bagManager.getGoodsListByType(GOODS_TYPE.MASTER_EQUIP);if(t)for(var n=0;n<t.length;n++){var a=t[n],i=this.betterEquipAry[0][a.model.part];i&&i.idKey==a.idKey||a.quality==GoodsQuality.Gold&&e.push(a)}return e},e}();__reflect(BagManager.prototype,"BagManager");var UseLimit=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.id=e,this.useTime=t}return e.prototype.parseMessage=function(e){this.id=e.getShort(),this.useTime=e.getInt()},e}();__reflect(UseLimit.prototype,"UseLimit");var TimeGoodsManager=function(){function e(){this.timeGoodsList=new Array,Tool.addTimer(this.onCountDown,this)}return e.prototype.parseTimeGoodsList=function(e){this.timeGoodsList=new Array;for(var t=e.getShort(),n=0;t>n;++n){var a=new TimeGoods;a.parseMessage(e),this.timeGoodsList.push(a)}},e.prototype.parseTimeGoods=function(e){var t=new TimeGoods;t.parseMessage(e);for(var n=0;n<this.timeGoodsList.length;++n)if(this.timeGoodsList[n].id==t.id&&this.timeGoodsList[n].type==t.type)return this.timeGoodsList[n].time=t.time,void(this.timeGoodsList[n].timestamp=t.timestamp);this.timeGoodsList.push(t)},e.prototype.onCountDown=function(){for(var e=egret.getTimer(),t=0;t<this.timeGoodsList.length;++t){var n=this.timeGoodsList[t];n.countDown(e)&&(this.timeGoodsList.splice(t,1),DataManager.getInstance().bagManager.removeBag(n.type,n.id,0),n=null)}},e.prototype.getTimeGoods=function(e,t){for(var n=0;n<this.timeGoodsList.length;++n){var a=this.timeGoodsList[n];if(a.type==e&&a.id==t)return a}return null},e}();__reflect(TimeGoodsManager.prototype,"TimeGoodsManager");var TimeGoods=function(){function e(){}return e.prototype.parseMessage=function(e){this.type=e.getByte(),this.id=e.getShort(),this.time=e.getInt(),this.timestamp=egret.getTimer()},e.prototype.countDown=function(e){return e-this.timestamp>this.time?!0:(this.timeStr=Tool.getTimeStr(Tool.toInt(this.time-(e-this.timestamp))/1e3),!1)},e}();__reflect(TimeGoods.prototype,"TimeGoods");var BlessManager=function(){function e(){this.btnType=0}return e.prototype.onSendBlessUpMsg=function(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=1);var i="";if(this.onCheckUpDanWarn(e,BlessDefine.BLESS_UPDAN_NORMALTYPE,t)?i="bless_updan_warn1":this.onCheckUpDanWarn(e,BlessDefine.BLESS_UPDAN_SUPERTYPE,t)&&(i="bless_updan_warn2"),i){var o=[{text:Language.instance.getText(i),style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(o,this.sendBlessUpMsgOK,this,[e,t,a])))}else this.sendBlessUpMsgOK([e,t,a,n])},e.prototype.onCheckUpDanWarn=function(e,t,n){var a,i,o=this.getPlayerBlessData(e),r=0,s=BlessDefine.BLESS_UPDAN_MAXGRADE[t];switch(t){case BlessDefine.BLESS_UPDAN_NORMALTYPE:a=GoodsDefine.ITEM_BLESS_UPDAN[e];break;case BlessDefine.BLESS_UPDAN_SUPERTYPE:a=GoodsDefine.ITEM_BLESS_SUPERUPDAN[e]}if(i=DataManager.getInstance().bagManager.getGoodsThingById(a),i&&(r=i.num),r>0&&o.grade==s-1&&9==o.level){var h=this.getBlessModelByData(o),l=0;if(i=DataManager.getInstance().bagManager.getGoodsThingById(h.cost.id),i&&i.num>0&&(l=h.itemExp),i&&n&&(l*=i.num),h.exp<=o.exp+l)return!0}return!1},e.prototype.sendBlessUpMsgOK=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=new Message(MESSAGE_ID.BLESS_UP_MESSAGE);o.setByte(0),o.setByte(a),o.setByte(t),o.setBoolean(n),o.setByte(i),GameCommon.getInstance().sendMsgToServer(o)},e.prototype.getPlayerBlessData=function(e){var t=DataManager.getInstance().playerManager.player.getPlayerData().blessinfos[e];return t},e.prototype.getPlayerBlessModel=function(e){return this.getBlessModelByData(this.getPlayerBlessData(e))},e.prototype.getBlessModel=function(e,t,n){return ModelManager.getInstance().getModelMount(e,t,n)},e.prototype.getBlessModelByData=function(e){return this.getBlessModel(e.type,e.grade,e.level)},e.prototype.getNextBlessModel=function(e,t,n){var a=this.getBlessModel(e,t,n+1);return a=a?a:this.getBlessModel(e,t+1,0)},e.prototype.getblessDanModel=function(e,t){var n;n=JsonModelManager.instance.getModelmountDan();for(var a in n)if(n[a].type==e&&t==n[a].subtype)return n[a]},e.prototype.skillModels=function(e){var t,n=[];t=JsonModelManager.instance.getModelmountSkill();for(var a in t)t[a].type==e&&n.push(t[a]);return n},e.prototype.getSkillAttrByID=function(e,t){void 0===t&&(t=!1);var n=[],a=JsonModelManager.instance.getModelmountSkill()[e],i=DataManager.getInstance().playerManager.player.getPlayerData().getBlessSkill(e),o=i?i.level:0;if(t&&o++,o>=BlessDefine.BLESS_SKILL_MAX)return n;for(var r=0;r<GameDefine.ATTR_OBJ_KEYS.length;r++){var s=GameDefine.ATTR_OBJ_KEYS[r];a&&a[s]?n[r]=Tool.toInt(a[s]*Math.pow(o,1.1)):n[r]=0}for(;r<2*GameDefine.ATTR_OBJ_KEYS.length;r++){var s=GameDefine.getAttrPlusKey(r);a&&a[s]?n[r]=a[s]*o:n[r]=0}return n},e.prototype.getSkillExpMaxByID=function(e){var t=DataManager.getInstance().playerManager.player.getPlayerData().getBlessSkill(e),n=t?t.level:0;return n>=BlessDefine.BLESS_SKILL_MAX?0:Tool.toInt(BlessDefine.BLESS_SKILL_BASIC*(Math.pow(n+1,1.3)-Math.pow(n,1.3)))},e.prototype.getBlessJueXingItemId=function(e){return parseInt(Constant.get(Constant.BLESS_WAKE_UP_ITEM).split(",")[e])},e.prototype.getBlessJueXingValue=function(){if(!this.juexingLevens){this.juexingLevens=[];for(var e=Constant.get(Constant.BLESS_WAKE_UP_PERCENT).split(","),t=0;t<e.length;++t)this.juexingLevens[t]=parseInt(e[t])}return this.juexingLevens},e}();__reflect(BlessManager.prototype,"BlessManager");var BlessData=function(){function e(e){this.danDic=[],this.isBaoji=!1,this.type=e,this.danDic[0]=0,this.danDic[1]=0}return e.prototype.parseMsg=function(e){this.level=e.getShort(),this.grade=e.getShort(),this.exp=e.getInt()},e}();__reflect(BlessData.prototype,"BlessData");var BlessSkillData=function(){function e(e){this.type=e}return e.prototype.parseMsg=function(e){this.id=e.getByte(),this.level=e.getShort(),this.exp=e.getInt()},e}();__reflect(BlessSkillData.prototype,"BlessSkillData");var EBroadcastChannel;!function(e){e[e.System=0]="System",e[e.Player=1]="Player"}(EBroadcastChannel||(EBroadcastChannel={}));var BroadcastBase=function(){function e(){this.id=null,this.str="",this.playerId=null,this.society=null,this.vip=null,this.server=null,this.occpcution=null,this.name=null,this.title=null,this.messageParams=[]}return e.prototype.getPlayerInfoDesc=function(){var e="";return this.vip&&this.channel!=EBroadcastChannel.System&&(e+="<font color='#dfa519'>VIP </font>"),null!=this.name&&(e+="<font color='#02ec02'>"+this.name+"</font>"),e},Object.defineProperty(e.prototype,"vipExp",{get:function(){return this._vipExp},set:function(e){this._vipExp=e,this.vip=GameCommon.getInstance().getVipLevel(e)},enumerable:!0,configurable:!0}),e}();__reflect(BroadcastBase.prototype,"BroadcastBase");var BroadcastManager=function(){function e(){this._messageArray={}}return e.prototype.parseBroadcast=function(t,n){var a=new BroadcastBase;switch(a.id=t.getByte(),a.channel=n,a.channel){case EBroadcastChannel.Player:a.playerId=t.getInt(),a.name=t.getString(),a.vipExp=t.getInt(),a.occpcution=t.getByte();break;case EBroadcastChannel.System:}for(var i=t.getByte(),o=0;i>o;o++){var r=t.getString();if(r.slice(0,e.TIPS_START.length)==e.TIPS_START){var s=r.indexOf(e.TIPS_END),h=r.substr(e.TIPS_START.length,s-e.TIPS_START.length),l=JsonModelManager.instance.getModeltips()[h];r=l.desc}a.messageParams.push(r)}a.str=BroadcastModel.getBroadcastStr(a),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SYSTEM_CHAT_BROADCAST),a),this.pushMessages(a)},e.prototype.pushMessages=function(t){var n=this._messageArray[t.channel];switch(n||(n=[],this._messageArray[t.channel]=n),t.channel){case EBroadcastChannel.System:n.unshift(t);break;case EBroadcastChannel.Player:n.length<=e.ARRAY_CAPACITY&&t.id!=EBroadcastId.Message_BossCall&&t.id!=EBroadcastId.Message_BossKill&&n.push(t);break;default:egret.error("BroadcastManager.parseBroadcastList() failed. Unexpected msgType="+t.channel)}if(t.id==EBroadcastId.Message_BossCall||t.id==EBroadcastId.Message_BossKill){var a=new Message(MESSAGE_ID.EXPLOREBOSS_BOSS_INIT);GameCommon.getInstance().sendMsgToServer(a)}},e.prototype.getMessageArray=function(e){return this._messageArray[e]},e.TIPS_START="[GameTips#",e.TIPS_END="]",e.ARRAY_CAPACITY=200,e}();__reflect(BroadcastManager.prototype,"BroadcastManager");var EBroadcastId;!function(e){e[e.Message_ServerClose=-1]="Message_ServerClose",e[e.Message_Server=0]="Message_Server",e[e.Message_FirstPay=1]="Message_FirstPay",e[e.Message_VIP=2]="Message_VIP",e[e.Message_BlessHorseUp=3]="Message_BlessHorseUp",e[e.Message_BlessWeaponUp=4]="Message_BlessWeaponUp",e[e.Message_BlessClothesUp=5]="Message_BlessClothesUp",e[e.Message_BlessWingUp=6]="Message_BlessWingUp",e[e.Message_EquipStrengthen=7]="Message_EquipStrengthen",e[e.Message_BossCall=8]="Message_BossCall",e[e.Message_BossKill=9]="Message_BossKill",e[e.Message_GodArtifactUp=10]="Message_GodArtifactUp",e[e.Message_MagicUp=11]="Message_MagicUp",e[e.Message_CreateUnion=12]="Message_CreateUnion",e[e.Message_XunBao=13]="Message_XunBao",e[e.Message_OrangeUp=14]="Message_OrangeUp",e[e.Message_LadderGold=15]="Message_LadderGold",e[e.Message_LadderDiamond=16]="Message_LadderDiamond",e[e.Message_BossOrange=17]="Message_BossOrange",e[e.Message_ShenQiJiHuo=18]="Message_ShenQiJiHuo",e[e.Message_LianHua=19]="Message_LianHua",e[e.Message_DuJieFuChou=20]="Message_DuJieFuChou",e[e.Message_OrangeMix=21]="Message_OrangeMix",e[e.Message_WishingWell=22]="Message_WishingWell",e[e.Message_GangChampion=23]="Message_GangChampion",e[e.Message_GangPersonal=24]="Message_GangPersonal",e[e.Message_FestZhuanPan=25]="Message_FestZhuanPan",e[e.Message_PetLottery=26]="Message_PetLottery"}(EBroadcastId||(EBroadcastId={}));var BroadcastModel=function(){function e(){}return e.getBroadcastStr=function(e){var t=Language.instance.getText("EBroadcast_"+e.id);return t&&(t=(n=Language.instance).parseInsertText.apply(n,[t].concat(e.messageParams)),t.indexOf("[player]")>=0&&(t=t.replace("[player]",e.getPlayerInfoDesc())),t.indexOf("[society]")>=0&&(t=t.replace("[society]","[#c586c0"+e.society+"]")),t.indexOf("[gamename]")>=0&&(t=t.replace("[gamename]",SDKManager.gamename)),t=GameCommon.getInstance().readStringToHtml(t)),t;var n},e}();__reflect(BroadcastModel.prototype,"BroadcastModel");var ChatBase=function(){function e(e){this.job=5,this.param="",this.type=e,this.player=new SimplePlayerData}return e.prototype.onParseMsg=function(e){this.type==CHANNEL.WHISPER&&(this.sendID=e.getInt(),this.receiveID=e.getInt()),this.player.parseMsg(e),this.onParseContent(e),this.type==CHANNEL.GUILD&&(this.job=e.getByte())},e.prototype.onParseContent=function(e){this.content=e.getString();var t=this.content.match(/\{\w+#\w[\w,]*}/g);if(t){var n=t[0];this.param=n.slice(1,n.length-1),this.content=ChatDefine.getChatParamText(this)}},e}();__reflect(ChatBase.prototype,"ChatBase");var ChatManager=function(){function e(){this.hasNewGuidTalk=!1,this.hasNewWhisperTalk=!1,this.isSucceed=!1,this.chat=[[],[],[],[],[],[]],this.record={},this.test=new eui.Label,this.cds={},this.cds[CHANNEL.CURRENT]=new ChatChannelCD(CHANNEL.CURRENT,1e4),this.cds[CHANNEL.GUILD]=new ChatChannelCD(CHANNEL.GUILD,1e4),this.cds[CHANNEL.WHISPER]=new ChatChannelCD(CHANNEL.WHISPER,1e4),this.cds[CHANNEL.SYS]=new ChatChannelCD(CHANNEL.SYS,1e4),this.cds[CHANNEL.ALLSERVER]=new ChatChannelCD(CHANNEL.SYS,1e4),GameDispatcher.getInstance().addEventListener(GameEvent.SYSTEM_CHAT_BROADCAST,this.onBroadcast,this)}return e.prototype.onSendChatRecord=function(e){var t=new Message(MESSAGE_ID.PLAYER_CHAT_RECEIVE_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseChatRecord=function(e){var t=e.getByte();this.chat[t]=[],DataManager.getInstance().friendManager.clearRecentContacts();for(var n,a=e.getByte(),i=0;a>i;i++)n=new ChatBase(t),n.onParseMsg(e),this.pushByType(t,n),t==CHANNEL.WHISPER&&DataManager.getInstance().friendManager.addRecentContacts(new FriendInfoBase(n.player),!0)},e.prototype.parseChatNew=function(e){this.currType=e.getByte();var t=new ChatBase(this.currType);switch(t.onParseMsg(e),this.currType){case CHANNEL.GUILD:t.player.id!=DataManager.getInstance().playerManager.player.id&&(this.hasNewGuidTalk=!0);break;case CHANNEL.WHISPER:t.sendID!=DataManager.getInstance().playerManager.player.id&&(this.hasNewWhisperTalk=!0,DataManager.getInstance().friendManager.addRecentContacts(new FriendInfoBase(t.player),!1))}this.pushByType(this.currType,t),t.param&&(t.time=ChatDefine.getChatValidTime(t.param)),GameCommon.getInstance().receiveMsgToClient(e,t)},e.prototype.pushByType=function(e,t){if(this.isSucceed=!1,!DataManager.getInstance().friendManager.getIsInBlackList(t.player.id)){this.isSucceed=!0;var n=this.chat[e];if(!n)return;n.push(t),e!=CHANNEL.WHISPER&&this.chat[CHANNEL.ALL].push(t);var a=void 0;switch(e){case CHANNEL.SYS:this.chat[e].length>=30&&(a=this.chat[e].shift());break;default:this.chat[e].length>=ChatDefine.MAX_RECORD_INFO&&(a=this.chat[e].shift())}if(a){if(this.chat[CHANNEL.ALL].length>=ChatDefine.MAX_RECORD_INFO){var i=this.chat[CHANNEL.ALL].indexOf(a);i>=0&&this.chat[CHANNEL.ALL].splice(i,1)}a.player=null,a=null}}},e.prototype.onBroadcast=function(e){var t=0,n=new ChatBase(t),a=e.data;n.player.id=a.channel-2,n.player.name="",n.player.viplevel=a.vip,n.player.headindex=a.occpcution,n.content=a.str,this.pushByType(t,n),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SYSTEM_CHAT_BROADCAST_UPDATEMAINVIEW))},e.prototype.getChatTextFlow=function(e,t){var n,a,i=0,o=[],r=[],s=t.length;if(0==s)return o;for(var h=0;s>h;h++)switch(n=t[h],a=n.player.id){case-2:for(o.push({text:"[系统]",style:{textColor:16756257}}),r=(new egret.HtmlTextParser).parser(n.content),i=0;i<r.length;i++)o.push(r[i]);o.push({text:"\n",style:{}});break;case-1:for(o.push({text:"[公告]",style:{textColor:16711680}}),r=(new egret.HtmlTextParser).parser(n.content),i=0;i<r.length;i++)o.push(r[i]);o.push({text:"\n",style:{}});break;default:switch(n.type){case 2:o.push({text:"[仙盟]",style:{textColor:13511409}}),o.push({text:"["+UnionDefine.Union_Postions[n.job]+"]",style:{textColor:13511409}}),o.push({text:GameCommon.getInstance().getNickname(n.player.name)+":",style:{textColor:13220481}}),n.param?n.time>egret.getTimer()?(o.push({text:n.content,style:{textColor:65280,href:"event:"+n.param,underline:!0}}),o.push({text:"\n",style:{}})):(o.push({text:n.content,style:{textColor:9013641}}),o.push({text:"\n",style:{}})):(o.push({text:n.content,style:{textColor:13290186}}),o.push({text:"\n",style:{}}));break;case 4:break;default:if(o.push({text:"[世界]",style:{textColor:16777215}}),n.param)if(n.time>egret.getTimer()){for(r=this.parseHtmlToTextElement(n),i=0;i<r.length;i++)o.push(r[i]);o.push({text:"\n",style:{href:"event:"+n.param}})}else{for(r=this.parseHtmlToTextElement(n,!0),i=0;i<r.length;i++)o.push(r[i]);o.push({text:"\n",style:{}})}else o.push({text:GameCommon.getInstance().getNickname(n.player.name)+":",style:{textColor:13220481}}),o.push({text:n.content,style:{textColor:13290186}}),o.push({text:"\n",style:{}})}}return o.pop(),o},e.prototype.parseHtmlToTextElement=function(e,t){void 0===t&&(t=!1);var n=e.content,a=[],i=n.match(/\[#[0-9a-fA-F]{6}.*?]/g);if(i)for(var o=0,r=0;r<=i.length;r++){var s=o,h=void 0,l="",g=void 0;if(i.length>r){var c=i[r];h=n.indexOf(c),l=c.slice(8,c.length-1),g=parseInt("0x"+c.slice(2,8)),o=h+c.length}else h=n.length,o=n.length;var p=n.slice(s,h);t?a.push({text:p+l,style:{textColor:16777215}}):(a.push({text:p,style:{textColor:65280,href:"event:"+e.param,underline:!0}}),l&&a.push({text:l,style:{textColor:g,href:"event:"+e.param,underline:!0}}))}else t?a.push({text:n,style:{textColor:16777215}}):a.push({text:n,style:{textColor:65280,href:"event:"+e.param,underline:!0}});return a},e.prototype.onCheckChatRedPoint=function(){return this.onCheckChatRedPointByType(CHANNEL.GUILD)?!0:this.onCheckChatRedPointByType(CHANNEL.WHISPER)?!0:!1},e.prototype.onCheckPrivateChatRedPoint=function(){var e=DataManager.getInstance().friendManager.getRecentContacts();for(var t in e)if(e[t].order>0)return!0;return!1},e.prototype.onCheckChatRedPointByType=function(e){var t=!1;switch(e){case CHANNEL.GUILD:t=this.hasNewGuidTalk;break;case CHANNEL.WHISPER:t=this.hasNewWhisperTalk}return t},e.prototype.getChatWH=function(e,t){var n=this.record[t+"_"+e];return n||(this.test.size=t,this.test.fontFamily="SimHei",this.test.text=e,n=[this.test.textWidth,this.test.textHeight]),n},e}();__reflect(ChatManager.prototype,"ChatManager");var CoatardManager=function(){function e(){}return e.prototype.getCanShowRedPoint=function(){var e=DataManager.getInstance().playerManager.player;e.coatardLv,e.vigour;return!1},e.prototype.getCoatardPower=function(e){var t=DataManager.getInstance().coatardManager.getOneArrCoatardByLv(e),n=GameCommon.calculationFighting(t);return n},e.prototype.getOneArrCoatardByLv=function(e){return null},e}();__reflect(CoatardManager.prototype,"CoatardManager");var DominateManager=function(){function e(){}return e.prototype.onSendUpgradeMessage=function(e,t){var n=new Message(MESSAGE_ID.DOMINATE_UPGRADE_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onParseDominateUpgrade=function(e){DataManager.getInstance().playerManager.player.onParseDominateUpgrade(e),this.succeed=e.getByte()},e.prototype.onSendAdvanceMessage=function(e,t){var n=new Message(MESSAGE_ID.DOMINATE_ADVANCE_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onParseDominateAdvance=function(e){DataManager.getInstance().playerManager.player.onParseDominateAdvance(e)},e.prototype.onSendDecomposeMessage=function(e){var t=0;for(var n in e)t++;if(0!=t){var a=new Message(MESSAGE_ID.DOMINATE_DECOMPOSE_MESSAGE);a.setShort(t);for(var n in e)a.setShort(parseInt(n)),a.setInt(e[n]);GameCommon.getInstance().sendMsgToServer(a)}},e.prototype.onParseDecompose=function(e){},e.prototype.getOneJobDomPower=function(e,t){var n=GameCommon.getInstance().getAttributeAry(),a=this.getPlayerData(e).getDominateThingBySlot(t),i=JsonModelManager.instance.getModelshanggutaozhuang(),o=i[a.slot][a.lv-1];return o&&(n=o.base_effect),GameCommon.calculationFighting(n)},e.prototype.getPlayerData=function(e){return void 0===e&&(e=0),DataManager.getInstance().playerManager.player.getPlayerData(e)},e.prototype.checkDomPoint=function(){return this.checkDomUpgradePoint()?!0:this.checkDomAdvancePoint()?!0:this.checkDecomposPoint()?!0:!1},e.prototype.checkJobDomPoint=function(e){return this.checkJobDomUpgradePoint(e)?!0:this.checkJobDomAdvancePoint(e)?!0:!1},e.prototype.checkDomUpgradePoint=function(){for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.checkJobDomUpgradePoint(e))return!0;return!1},e.prototype.checkJobDomUpgradePoint=function(e){void 0===e&&(e=0);for(var t=0;t<GameDefine.Dominate_Slot_Num;t++)if(this.checkJobDomUpgradePointBySlot(t))return!0;return!1},e.prototype.checkJobDomUpgradePointBySlot=function(e){var t=this.getPlayerData();if(!t)return!1;var n=t.getDominateThingBySlot(e),a=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[e]],i=a.level;if(DataManager.getInstance().playerManager.player.level<i)return!1;var o=JsonModelManager.instance.getModelshanggutaozhuang(),r=o[n.slot][n.lv];if(!r)return!1;var s=DataManager.getInstance().bagManager.getGoodsThingNumById(r.cost.id,r.cost.type);return s>=r.cost.num?!0:!1},e.prototype.checkDomAdvancePoint=function(){for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.checkJobDomAdvancePoint(e))return!0;return!1},e.prototype.checkJobDomAdvancePoint=function(e){void 0===e&&(e=0);for(var t=0;t<GameDefine.Dominate_Slot_Num;t++)if(this.checkJobDomAdvancePointBySlot(t))return!0;return!1},e.prototype.checkJobDomAdvancePointBySlot=function(e){var t=this.getPlayerData();if(!t)return!1;var n=t.getDominateThingBySlot(e);if(1==n.tier)return!1;var a=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[e]],i=a.level;if(DataManager.getInstance().playerManager.player.level<i)return!1;var o=JsonModelManager.instance.getModelshanggutaozhuang(),r=o[n.slot][n.lv];if(!r)return!1;var s=DataManager.getInstance().bagManager.getGoodsThingNumById(GameDefine.Domiante_Advance_needID,GOODS_TYPE.ITEM);return s>=GameDefine.Domiante_Advance_needNum?!0:!1},e.prototype.checkDecomposPoint=function(){for(var e=0;e<GameDefine.Dominate_Slot_Num;e++){var t=this.getPlayerData().getDominateThingBySlot(e),n=JsonModelManager.instance.getModelshanggutaozhuang()[e][0];if(t.lv>0){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(n.cost.id,GOODS_TYPE.ITEM);if(a&&a>0)return!0}}},e}();__reflect(DominateManager.prototype,"DominateManager");var DragonSoulManager=function(){function e(){this.curRandomValue=[]}return e.prototype.parseRandomValue=function(e){e.getByte();for(var t=0;t<GameDefine.LONGHUAN_ATTR.length;t++)this.curRandomValue[t]=e.getInt()},e.prototype.clear=function(){this.curRandomValue=[]},e.prototype.sendRandomMessage=function(e,t,n){var a=new Message(MESSAGE_ID.LONGHUN_RANDOM);a.setByte(e),a.setByte(t?1:0),a.setByte(n),GameCommon.getInstance().sendMsgToServer(a)},e.prototype.checkRedPoint=function(){if(FunDefine.isFunOpen(FUN_TYPE.FUN_DRAGONSOUL)){var e=DataManager.getInstance().bagManager.getGoodsThingNumById(GameDefine.LONGHUN_GOODS_ID);if(e>=GameDefine.LONGHUN_GOODS_NUM)return!0}return!1},e.prototype.getLonghunPower=function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=0;t<GameDefine.LONGHUAN_ATTR.length;t++)e[t]=this.getPlayerData().longhunAttribute[t];return GameCommon.calculationFighting(e)},e.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},e}();__reflect(DragonSoulManager.prototype,"DragonSoulManager");var AllPeopleBossData=function(){function e(){this.infos=[],this.xuezhanInfos=[],this.xianshanInfos=[],this._otherFightDatas=[],this.remindBossIds=[],this.vipbossInfos={}}return Object.defineProperty(e.prototype,"leftRecover",{get:function(){return Math.ceil((this._leftRecover-egret.getTimer())/1e3)},set:function(e){this._leftRecover=1e3*e+egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reborntime",{get:function(){return Math.ceil((this._rebornLefttime-egret.getTimer())/1e3)},set:function(e){this._rebornLefttime=1e3*e+egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherFightDatas",{get:function(){return this._otherFightDatas},enumerable:!0,configurable:!0}),e.prototype.addOtherFightData=function(e){var t;if(this._otherFightDatas.length<=DupDefine.ALLPEOPLE_SHOWBODY_MAX){if(t=new OtherFightData,t.parseYewaiPVPMsg(e),t.playerId==DataManager.getInstance().playerManager.player.id)return;for(var n=!0,a=0;a<this._otherFightDatas.length;a++)if(this._otherFightDatas[a].playerId==t.playerId){this._otherFightDatas[a]=t,n=!1;break}n&&this._otherFightDatas.push(t)}return t},e.prototype.removeOneOhterFightData=function(e){for(var t=this._otherFightDatas.length-1;t>=0;t--){var n=this._otherFightDatas[t];e==n.playerId&&(this._otherFightDatas[t]=null,this._otherFightDatas.splice(t,1));break}},e.prototype.removeAllOtherFightData=function(){for(var e=this._otherFightDatas.length;e>=0;e--)this._otherFightDatas[e]=null,this._otherFightDatas.splice(e,1)},e}();__reflect(AllPeopleBossData.prototype,"AllPeopleBossData");var AllPeopleBossInfo=function(){function e(){}return e.prototype.parseMessage=function(e){this.bossID=e.getShort(),this.joinNum=e.getInt(),this.leftHp=e.getLong(),this.rebirthTime=e.getInt(),this.guishuName=e.getString()},Object.defineProperty(e.prototype,"rebirthTime",{get:function(){return Math.max(0,Math.ceil((this._rebirthTime-egret.getTimer())/1e3))},set:function(e){this._rebirthTime=e>0?1e3*e+egret.getTimer():0,this.isOpen=0==this._rebirthTime;DataManager.getInstance().dupManager.allpeoplebossData},enumerable:!0,configurable:!0}),e}();__reflect(AllPeopleBossInfo.prototype,"AllPeopleBossInfo");var XuezhanBossInfo=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getShort(),this.bossID=e.getInt(),this.leftHp=e.getLong(),this.rebirthTime=e.getInt(),this.guishuName=e.getString(),this.deathLeftTime=e.getInt(),this._model=JsonModelManager.instance.getModelxuezhanboss()[this.id]},Object.defineProperty(e.prototype,"rebirthTime",{get:function(){return Math.max(0,Math.ceil((this._rebirthTime-egret.getTimer())/1e3))},set:function(e){this._rebirthTime=e>0?1e3*e+egret.getTimer():0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deathLeftTime",{get:function(){return Math.max(0,Math.ceil((this._deathLefttime-egret.getTimer())/1e3))},set:function(e){this._deathLefttime=e>0?1e3*e+egret.getTimer():0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e}();__reflect(XuezhanBossInfo.prototype,"XuezhanBossInfo");var VipBossInfo=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getShort(),this.leftHp=e.getLong(),this.rebirthTime=e.getInt(),this.deathLeftTime=e.getInt(),this._model=JsonModelManager.instance.getModelvipboss()[this.id]
},Object.defineProperty(e.prototype,"deathLeftTime",{get:function(){return Math.max(0,Math.ceil((this._deathLefttime-egret.getTimer())/1e3))},set:function(e){this._deathLefttime=e>0?1e3*e+egret.getTimer():0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e}();__reflect(VipBossInfo.prototype,"VipBossInfo");var AllPeoplePKInfo=function(){function e(){this.playerId=0,this.startHp=0,this.endHp=0,this.totalHp=0,this.leftReborn=0,this.attackNum=0}return e.prototype.parseInfo=function(e){this.playerId=e.getInt(),this.startHp=e.getLong(),this.endHp=e.getLong(),this.totalHp=e.getLong(),this.leftReborn=e.getByte()},e}();__reflect(AllPeoplePKInfo.prototype,"AllPeoplePKInfo");var XianShanBossInfo=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getShort(),this.bossID=e.getInt(),this.rebirthTime=e.getShort(),this.battleNum=e.getInt(),this.leftHp=e.getLong(),this.guishuName=e.getString(),this._model=JsonModelManager.instance.getModelxianshanzhaohuan()[this.id]},Object.defineProperty(e.prototype,"rebirthTime",{get:function(){return Math.max(0,Math.ceil((this._rebirthTime-egret.getTimer())/1e3))},set:function(e){this._rebirthTime=e>0?1e3*e+egret.getTimer():0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e}();__reflect(XianShanBossInfo.prototype,"XianShanBossInfo");var CrossPVEBossData=function(){function e(){this.myRankNum=0,this.myDamageNum=0,this.rankList=[]}return e.prototype.parseMsg=function(e){try{this.isOpen=1==e.getByte(),this._lefttime=e.getInt(),this._lefttime=this._lefttime>0?1e3*this._lefttime+egret.getTimer():0;var t=e.getShort();t!=this.fightID&&(this.fightID=t),this.fightcount=e.getInt(),this.buycount=e.getInt(),this.myDamageNum=e.getLong()}catch(n){}},e.prototype.parseRankMsg=function(e){this.myRankNum=0,this.rankList=[];for(var t=e.getByte(),n=0;t>n;n++)this.rankList[n]=new CrossPVEBossRank,this.rankList[n].rank=n+1,this.rankList[n].parseMsg(e),this.rankList[n].playerData.id==DataManager.getInstance().playerManager.player.id&&(this.myRankNum=this.rankList[n].rank)},e.prototype.parseBuyMsg=function(e){this.fightcount=e.getInt(),this.buycount=e.getInt()},Object.defineProperty(e.prototype,"model",{get:function(){return JsonModelManager.instance.getModelkuafuboss()[this.fightID]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lefttime",{get:function(){return Math.max(0,Math.ceil((this._lefttime-egret.getTimer())/1e3))},enumerable:!0,configurable:!0}),e}();__reflect(CrossPVEBossData.prototype,"CrossPVEBossData");var CrossPVEBossRank=function(){function e(){this.playerData=new SimplePlayerData}return e.prototype.parseMsg=function(e){this.damageValue=e.getLong(),this.playerData.parseMsg(e)},e}();__reflect(CrossPVEBossRank.prototype,"CrossPVEBossRank");var DupInfo=function(){function e(e,t){this.attacknum=0,this.sweepNum=0,this.awardIndex=0,this.pass=0,this.diffcult=0,this.teamPassRecord=0,this.blessPassRecord=0,this._models=[],this.type=e,this.subtype=t,this.onUpdate()}return e.prototype.onUpdate=function(){this._models=[],this.diffcult=0;var e=JsonModelManager.instance.getModelcopy(),t=DataManager.getInstance().playerManager.player;if(this.type==DUP_TYPE.DUP_PERSONALLY)this._id||(this._id=DUP_TYPE.DUP_PERSONALLY,this._model=e[this._id]);else{for(var n in e){var a=e[n];this.type==a.type&&this.subtype==a.subType&&this._models.push(a)}this._models.sort(function(e,t){return e.lvlimit<t.lvlimit?-1:1}),this._id=null;for(var n in this._models){var a=this._models[n];if(Tool.isNumber(this._id)){if(t.coatardLv<a.lvlimit)break;this._id=a.id,this.diffcult++}else this._id=a.id,this.getOpenCondition()||this.diffcult++}this._model=e[this._id]}},e.prototype.parseDupinfoMsg=function(e){this.attacknum=e.getByte(),this.sweepNum=e.getByte()},e.prototype.parseAwardIndex=function(e){this.type==DUP_TYPE.DUP_SIXIANG?this.awardIndex=e.getShort():this.type==DUP_TYPE.DUP_ZHUFU&&(this.blessPassRecord=e.getShort(),this.awardIndex=e.getShort())},e.prototype.updatePersonRe=function(e){this.personDupPassRecord=e},e.prototype.upDateCaiLiaoRe=function(e){this.cailiaoPassRecord=e},e.prototype.upDateTeamRe=function(e){this.teamPassRecord=e},Object.defineProperty(e.prototype,"lefttimes",{get:function(){return Math.max(0,this.totalTimes-this.attacknum)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalTimes",{get:function(){var e=this._model.nums.split(";"),t=1;switch(this.type){case DUP_TYPE.DUP_CAILIAO:t=parseInt(e[DataManager.getInstance().playerManager.player.viplevel].split(",")[0]),t=t?0>t?99999:t:0;break;case DUP_TYPE.DUP_SIXIANG:var n=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG];n&&n.param>0&&(t+=MonthCardManager.getTeQuan(CARD_TYPE.LIFELONG,TEQUAN_TYPE.SIXIANG));break;case DUP_TYPE.DUP_ZHUFU:var n=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG];n&&n.param>0&&(t+=MonthCardManager.getTeQuan(CARD_TYPE.LIFELONG,TEQUAN_TYPE.ZHUFU));break;case DUP_TYPE.DUP_VIP_TEAM:break;default:t=parseInt(e[DataManager.getInstance().playerManager.player.viplevel].split(",")[0]),t=t?0>t?99999:t:0}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftSweepNum",{get:function(){return Math.max(0,this.totalSweepNum-this.sweepNum)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalSweepNum",{get:function(){var e=this._model.nums.split(";"),t=parseInt(e[DataManager.getInstance().playerManager.player.viplevel].split(",")[1]);return t?0>t?99999:t:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dupModel",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextModel",{get:function(){return this._models[this.diffcult]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gerenModel",{get:function(){return this.type==DUP_TYPE.DUP_PERSONALLY?JsonModelManager.instance.getModelgerenboss()[this.subtype]:null},enumerable:!0,configurable:!0}),e.prototype.onCheckLimit=function(){var e=this.getOpenCondition();return e?(GameCommon.getInstance().addAlert(e),!0):!1},e.prototype.getOpenCondition=function(){var e=0,t=this.type+"_"+this.subtype;switch(t){case DUP_TYPE.DUP_CAILIAO+"_1":e=FUN_TYPE.FUN_BAOSHIFUBEN;break;case DUP_TYPE.DUP_CAILIAO+"_2":e=FUN_TYPE.FUN_JINGMAIFUBEN;break;case DUP_TYPE.DUP_CAILIAO+"_3":e=FUN_TYPE.FUN_CHONGFUBEN;break;case DUP_TYPE.DUP_CAILIAO+"_5":e=FUN_TYPE.FUN_CUILIANFUBEN;break;case DUP_TYPE.DUP_CAILIAO+"_6":e=FUN_TYPE.FUN_RNUES_DUP;break;case DUP_TYPE.DUP_CAILIAO+"_9":e=FUN_TYPE.FUN_TIANSHU_LEVEL_DUP;break;case DUP_TYPE.DUP_CAILIAO+"_10":e=FUN_TYPE.FUN_XIANLV_EQUIP_DUP;break;case DUP_TYPE.DUP_TEAM+"_1":e=FUN_TYPE.FUN_DUP_ZUDUI}JsonModelManager.instance.getModelfunctionLv()[e];return FunDefine.isFunOpen(e)?"":FunDefine.getFunOpenDesc(e)},e}();__reflect(DupInfo.prototype,"DupInfo");var DUP_DIFFICULT;!function(e){e[e.NORMAL=1]="NORMAL",e[e.HARD=2]="HARD",e[e.BEST=3]="BEST"}(DUP_DIFFICULT||(DUP_DIFFICULT={}));var DupManager=function(){function e(){this.worldbossEnjoyNum=0,this.worldbossEnjoyRecoverTime=0,this.dupinfo_map={},this.dupinfo_typeMap={},this.worldbossFightTime={},this.xuezhanInfo=new XuezhanInfo,this.explorebossInfo={};var e=JsonModelManager.instance.getModelcopy();for(var t in e){var n,a=e[t];if(this.dupinfo_typeMap[a.type]||(this.dupinfo_typeMap[a.type]=new Array),DUP_TYPE.DUP_PERSONALLY==a.type)for(var i in JsonModelManager.instance.getModelgerenboss()){var o=JsonModelManager.instance.getModelgerenboss()[i];n=a.type+"_"+o.id,this.dupinfo_map[n]=new DupInfo(a.type,o.id),this.dupinfo_typeMap[a.type].push(this.dupinfo_map[n]),this.dupinfo_map[n].dupid=a.id}else n=a.type+"_"+a.subType,this.dupinfo_map[n]||(this.dupinfo_map[n]=new DupInfo(a.type,a.subType),this.dupinfo_typeMap[a.type].push(this.dupinfo_map[n]))}this.crossPVEBoss=new CrossPVEBossData}return e.prototype.parseDupinfo=function(e){var t=e.getByte();switch(t){case DUP_TYPE.DUP_PERSONALLY:for(var n in JsonModelManager.instance.getModelgerenboss()){var a=JsonModelManager.instance.getModelgerenboss()[n],i=this.dupinfo_map[t+"_"+a.id];i.attacknum=0}}for(var o=e.getShort(),r=e.getByte(),s=0;r>s;s++){var h=e.getByte(),l=t+"_"+h,g=this.dupinfo_map[l];g.pass=o,g.parseDupinfoMsg(e),g.parseAwardIndex(e)}switch(t){case DUP_TYPE.DUP_PERSONALLY:for(var c=e.getByte(),s=1;c>=s;s++){var l=t+"_"+s,g=this.dupinfo_map[l],p=e.getByte();g&&g.updatePersonRe(p)}break;case DUP_TYPE.DUP_VIP_TEAM:this.vipTeamTimes=e.getByte();break;case DUP_TYPE.DUP_CAILIAO:for(var c=e.getByte(),s=1;c>=s;s++){var l;l=4==s?t+"_"+(s+1):t+"_"+s;var g=this.dupinfo_map[l];if(g){var p=e.getByte();g.upDateCaiLiaoRe(p)}}break;case DUP_TYPE.DUP_TEAM:for(var c=e.getByte(),s=1;c>=s;s++){var l=t+"_1",p=e.getByte();if(g.diffcult==s){var g=this.dupinfo_map[l];if(!g)continue;g.upDateTeamRe(p);break}}break;case DUP_TYPE.DUP_LINGXING:DataManager.getInstance().fuLingManager.myDamageNum=e.getLong()}for(var u in this.dupinfo_typeMap)for(var d=this.dupinfo_typeMap[u],_=0;_<d.length;_++){var m=d[_];m.onUpdate()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseDupSweepNum=function(e){var t=e.getByte(),n=e.getByte(),a=JsonModelManager.instance.getModelcopy()[t];if(a){var i=this.getDupInfo(a.type,a.subType);(a.type==DUP_TYPE.DUP_CAILIAO||a.type==DUP_TYPE.DUP_TEAM)&&(i.attacknum=i.attacknum+1),i.sweepNum=n}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXuezhanInitMsg=function(e){this.xuezhanInfo.onParseXuezhanInitMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXuezhanBuffMsg=function(e){var t=e.getByte(),n=e.getShort();this.xuezhanInfo.selectbuffList.indexOf(t)>=0&&(this.xuezhanInfo.addXuezhanBuff(t),this.xuezhanInfo.xuezhanWaveNum=n),this.xuezhanInfo.selectbuffList=[0,0,0],this.xuezhanInfo.isSelectBuff=!1,this.xuezhanInfo.xuezhanStar=e.getShort(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXueZhanCueGetStar=function(){},e.prototype.parseXuezhanRewardMsg=function(e){this.xuezhanInfo.isRewardBox=!1,GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXuezhanSaodangMsg=function(e){var t=e.getShort(),n=e.getShort();if(this.xuezhanInfo.reviveNum=e.getByte(),this.xuezhanInfo.xuezhanWaveNum=t,DataManager.getInstance().dupManager.xuezhanInfo.onXuezhanSuccess(t,n),this.xuezhanInfo.isRewardBox=e.getBoolean(),this.xuezhanInfo.isSelectBuff=e.getBoolean(),this.xuezhanInfo.isSelectBuff)for(var a=0;a<this.xuezhanInfo.selectbuffList.length;a++)this.xuezhanInfo.selectbuffList[a]=e.getByte();this.xuezhanInfo.cleanBUff();for(var i=e.getByte(),a=0;i>a;a++)this.xuezhanInfo.addXuezhanBuff(e.getByte());GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.difuDupredPoint=function(){return this.xuezhanInfo.reviveNum>0},e.prototype.getDupInfo=function(e,t){return this.dupinfo_map[e+"_"+t]},e.prototype.getDupInfoByID=function(e){var t=JsonModelManager.instance.getModelcopy()[e];return this.getDupInfo(t.type,t.subType)},e.prototype.getDupInfolistByType=function(e){return this.dupinfo_typeMap[e]},Object.defineProperty(e.prototype,"xuezhanLayerNum",{get:function(){var e=0;return this.xuezhanInfo&&(e=Math.ceil(this.xuezhanInfo.xuezhanWaveNum/GameDefine.Xuezhan_LayerWaveNum)),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getXueZhanHistoryNum",{get:function(){var e=0;return this.xuezhanInfo&&this.xuezhanInfo.layerStars?Math.ceil(this.xuezhanInfo.layerStars.length/3):e},enumerable:!0,configurable:!0}),e.prototype.parseExploreInfo=function(e){var t=this.explorebossInfo.lifeNum;if(this.explorebossInfo.lifeNum=e.getShort(),this.explorebossInfo.leftRecover=e.getInt(),this.explorebossInfo.lifeMaxNum=e.getShort(),this.explorebossInfo.leftRecover=egret.getTimer()+1e3*this.explorebossInfo.leftRecover,GameCommon.getInstance().receiveMsgToClient(e),t>this.explorebossInfo.lifeNum){t-=this.explorebossInfo.lifeNum;var n=[];n.push({text:"消耗"+t+"体力值",style:{textColor:15086130}}),PromptPanel.getInstance().addPromptGain(n),n=null}},e.prototype.parseWorldBossInfo=function(e){},Object.defineProperty(e.prototype,"allpeoplebossData",{get:function(){return this._allpeopleData||(this._allpeopleData=new AllPeopleBossData),this._allpeopleData},enumerable:!0,configurable:!0}),e.prototype.parseAllPeopleBossMsg=function(e){this.allpeoplebossData.lefttimes=e.getShort(),this.allpeoplebossData.leftRecover=e.getInt();for(var t=e.getShort(),n=0;t>n;n++){this.allpeoplebossData.infos[n]||(this.allpeoplebossData.infos[n]=new AllPeopleBossInfo);var a=this.allpeoplebossData.infos[n];a.parseMessage(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXuezhanBossInfoMsg=function(e){for(var t=e.getShort(),n=0;t>n;n++){this.allpeoplebossData.xuezhanInfos[n]||(this.allpeoplebossData.xuezhanInfos[n]=new XuezhanBossInfo);var a=this.allpeoplebossData.xuezhanInfos[n];a.parseMessage(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseXianShanBossInfoMsg=function(e){var t=e.getShort();this.allpeoplebossData.xianshanInfos=[];for(var n=0;t>n;n++){var a=new XianShanBossInfo;a.parseMessage(e),a.rebirthTime>0&&(this.allpeoplebossData.xianshanInfos[n]=a)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onChangeXianShanBossList=function(){0==DataManager.getInstance().xiandanManager.bossState&&(this.allpeoplebossData.xianshanInfos.pop(),DataManager.getInstance().xiandanManager.bossSize=this.allpeoplebossData.xianshanInfos.length)},e.prototype.parseVipBossInfoMsg=function(e){for(var t=e.getShort(),n=0;t>n;n++){var a=new VipBossInfo;a.parseMessage(e),this.allpeoplebossData.vipbossInfos[a.id]=a}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onRemindAllPeopleBoss=function(e){if(FunDefine.isFunOpen(FUN_TYPE.FUN_GEREN_BOSS)){for(var t,n=e.getByte(),a=0;n>a;a++){var i=e.getShort(),o=JsonModelManager.instance.getModelquanminboss()[i],r=o.limitLevel<=DataManager.getInstance().playerManager.player.coatardLv;r&&this._allpeopleData.remindBossIds.indexOf(i)>=0&&(t=o);var s=this.allpeoplebossData.infos[i];s&&(s.isOpen=!0)}if(t&&GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG){var h=ModelManager.getInstance().getModelFigher(t.modelId);GameCommon.getInstance().onShowFuncTipsBar(FUNCTIP_TYPE.BOSS_REMIND,h.name+"刷新了")}}},e.prototype.onAllPeopleBossDead=function(e){var t=e.getShort(),n=this.allpeoplebossData.infos[t];n&&(n.isOpen=!1)},e.prototype.onAllPeopleBossFT=function(e){DataManager.getInstance().dupManager.allpeoplebossData.lefttimes=e.getShort()},e.prototype.onRemindXuezhanBoss=function(e){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG)for(var t=e.getByte(),n=0;t>n;n++){var a=(e.getShort(),void 0);switch(a){case BLESS_TYPE.RETINUE_CLOTHES:a=FUN_TYPE.FUN_HUANZHUANG;break;case BLESS_TYPE.RETINUE_HORSE:a=FUN_TYPE.FUN_FAZUO;break;case BLESS_TYPE.RETINUE_WEAPON:a=FUN_TYPE.FUN_LINGZHANG;break;case BLESS_TYPE.RETINUE_WING:a=FUN_TYPE.FUN_YUYI;break;case BLESS_TYPE.MAGIC:a=FUN_TYPE.FUN_BAOQI}if(FunDefine.isFunOpen(a)){GameCommon.getInstance().onShowFuncTipsBar(FUNCTIP_TYPE.BOSS_REMIND,"血战BOSS刷新了");break}}},e.prototype.onRemindVIPBoss=function(e){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG)for(var t=e.getByte(),n=0;t>n;n++){var a=e.getShort(),i=JsonModelManager.instance.getModelvipboss()[a];if(i.vip<=DataManager.getInstance().playerManager.player.viplevel){GameCommon.getInstance().onShowFuncTipsBar(FUNCTIP_TYPE.BOSS_REMIND,"仙尊BOSS刷新了");break}}},e.prototype.onRemindSamsaraBoss=function(){FunDefine.isFunOpen(FUN_TYPE.FUN_ZHUANSHENG_BOSS)&&GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&GameCommon.getInstance().onShowFuncTipsBar(FUNCTIP_TYPE.BOSS_REMIND,"境界BOSS已开启")},e.prototype.parseAllPeopleOtherFightMsg=function(e){var t=[FIGHT_SCENE.ALLPEOPLE_BOSS,FIGHT_SCENE.XUEZHAN_BOSS,FIGHT_SCENE.VIP_BOSS,FIGHT_SCENE.XIANSHAN_BOSS];if(t.indexOf(GameFight.getInstance().fightsceneTpye)>=0){for(var n=e.getByte(),a=0;n>a;a++)var i=this.allpeoplebossData.addOtherFightData(e);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.OTHERBODY_ENTER_SCENE),i)}else GameFight.getInstance().allpeopleOtherMsg=e},e.prototype.parseAllPeopleRemindMsg=function(e){var t=e.getShort();this.allpeoplebossData.remindBossIds=[];for(var n=0;t>n;n++)this.allpeoplebossData.remindBossIds[n]=e.getShort();GameCommon.getInstance().receiveMsgToClient(e)},Object.defineProperty(e.prototype,"samsarebossData",{get:function(){return this._samsarabossData||(this._samsarabossData=new SamsaraBossData),this._samsarabossData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mysteriousData",{get:function(){return this._mysteriousbossData||(this._mysteriousbossData=new SamsaraBossData),this._mysteriousbossData},enumerable:!0,configurable:!0}),e.prototype.requstSamsareBossInfoMsg=function(){var e=new Message(MESSAGE_ID.SAMSARA_BOSS_LISTINFO_MSG);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseSamsareBossInfoMsg=function(e){this.samsarebossData.rebornLefttime=e.getInt(),this.samsarebossData.openLefttime=e.getInt();for(var t=e.getShort(),n=0;t>n;n++){var a=e.getShort();this.samsarebossData.bossLifes[a]=[],this.samsarebossData.bossLifes[a][0]=e.getLong(),this.samsarebossData.bossLifes[a][1]=e.getLong()}this.samsarebossData.hasbackaward=e.getBoolean(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseSamsaraBossOhterFightMsg=function(e){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS){for(var t=e.getByte(),n=0;t>n;n++)var a=this.samsarebossData.parseOtherFightData(e);GameDispatcher.getInstance().dispatchEvent(new egret.Event(MESSAGE_ID.SAMSARA_BOSS_OTHERBODY_MSG.toString()),a)}},e.prototype.parseMyBossOhterFightMsg=function(e){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS){for(var t=e.getByte(),n=0;t>n;n++)var a=this.samsarebossData.parseOtherFightData(e);GameDispatcher.getInstance().dispatchEvent(new egret.Event(MESSAGE_ID.MYSTERIOUS_BOSS_OTHERBODY_MSG.toString()),a)}},e.prototype.parseFourinageAwardMsg=function(e){var t=this.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0];t.parseAwardIndex(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessDupAwardMsg=function(e){var t=this.getDupInfolistByType(DUP_TYPE.DUP_ZHUFU)[0];t.parseAwardIndex(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onJoinRoomSeccuss=function(){GameFight.getInstance().teamdupRoomDupId>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TeamDupReadyPanel")},e.prototype.onRequestDupInofMsg=function(e){var t=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.getDupAwardDesc=function(e){var t="";return t},e.prototype.getCurrChallengeID=function(){var e=this.getDupInfolistByType(DUP_TYPE.DUP_CHALLENGE)[0];return e?e.pass-1:0},e.prototype.getDupMaxTimesById=function(e){var t=JsonModelManager.instance.getModelcopy()[28],n=t.nums.split(";"),a=parseInt(n[DataManager.getInstance().playerManager.player.viplevel].split(",")[0]);return a=a?0>a?99999:a:0},Object.defineProperty(e.prototype,"vipteamLeftjoinTimes",{get:function(){var e=this.getDupMaxTimesById(28);return Math.max(0,e-DataManager.getInstance().dupManager.vipTeamTimes)},enumerable:!0,configurable:!0}),e.prototype.sendPVEBossInfoRequst=function(){var e=new Message(MESSAGE_ID.CROSS_PVEBOSS_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.sendPVEBossDmgRankRequst=function(e){var t=new Message(MESSAGE_ID.CROSS_PVEBOSS_RANK_MESSAGE);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseCrossPVEBossInfo=function(e){this.crossPVEBoss.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseCrossPVEBossRank=function(e){this.crossPVEBoss.parseRankMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseCrossPVEBossBuy=function(e){this.crossPVEBoss.parseBuyMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e}();__reflect(DupManager.prototype,"DupManager");var MyBossData=function(){function e(){this.bossLifes={},this._otherFightDatas=[]}return Object.defineProperty(e.prototype,"rebornLefttime",{get:function(){return Math.ceil((this._rebornLefttime-egret.getTimer())/1e3)},set:function(e){this._rebornLefttime=1e3*e+egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherFightDatas",{get:function(){return this._otherFightDatas},enumerable:!0,configurable:!0}),e.prototype.parseOtherFightData=function(e){var t;return this._otherFightDatas.length<=DupDefine.ALLPEOPLE_SHOWBODY_MAX&&(t=new OtherFightData,t.parseYewaiPVPMsg(e),this.addOhterFightData(t)),t},e.prototype.addOhterFightData=function(e){if(e.playerId!=DataManager.getInstance().playerManager.player.id){for(var t=!0,n=0;n<this._otherFightDatas.length;n++)if(this._otherFightDatas[n].playerId==e.playerId){this._otherFightDatas[n]=e,t=!1;break}t&&this._otherFightDatas.push(e)}},e.prototype.removeAllOtherFightData=function(){for(var e=this._otherFightDatas.length;e>=0;e--)this._otherFightDatas[e]=null,this._otherFightDatas.splice(e,1)},e.prototype.removeOneOhterFightData=function(e){for(var t=this._otherFightDatas.length-1;t>=0;t--){var n=this._otherFightDatas[t];e==n.playerId&&(this._otherFightDatas[t]=null,this._otherFightDatas.splice(t,1));break}},e.prototype.findOneOtherFightData=function(e){for(var t=this._otherFightDatas.length-1;t>=0;t--){var n=this._otherFightDatas[t];if(e==n.playerId)return n}},e}();__reflect(MyBossData.prototype,"MyBossData");var MYBOSS_STATE;!function(e){e[e.UNOPEN=0]="UNOPEN",e[e.FIGHTTING=1]="FIGHTTING",e[e.KILLED=2]="KILLED"}(MYBOSS_STATE||(MYBOSS_STATE={}));var SamsaraBossData=function(){function e(){this.bossLifes={},this._otherFightDatas=[]}return Object.defineProperty(e.prototype,"rebornLefttime",{get:function(){return Math.ceil((this._rebornLefttime-egret.getTimer())/1e3)},set:function(e){this._rebornLefttime=1e3*e+egret.getTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherFightDatas",{get:function(){return this._otherFightDatas},enumerable:!0,configurable:!0}),e.prototype.parseOtherFightData=function(e){var t;return this._otherFightDatas.length<=DupDefine.ALLPEOPLE_SHOWBODY_MAX&&(t=new OtherFightData,t.parseYewaiPVPMsg(e),this.addOhterFightData(t)),t},e.prototype.addOhterFightData=function(e){if(e.playerId!=DataManager.getInstance().playerManager.player.id){for(var t=!0,n=0;n<this._otherFightDatas.length;n++)if(this._otherFightDatas[n].playerId==e.playerId){this._otherFightDatas[n]=e,t=!1;break}t&&this._otherFightDatas.push(e)}},e.prototype.removeAllOtherFightData=function(){for(var e=this._otherFightDatas.length;e>=0;e--)this._otherFightDatas[e]=null,this._otherFightDatas.splice(e,1)},e.prototype.removeOneOhterFightData=function(e){for(var t=this._otherFightDatas.length-1;t>=0;t--){var n=this._otherFightDatas[t];e==n.playerId&&(this._otherFightDatas[t]=null,this._otherFightDatas.splice(t,1));break}},e.prototype.findOneOtherFightData=function(e){for(var t=this._otherFightDatas.length-1;t>=0;t--){var n=this._otherFightDatas[t];if(e==n.playerId)return n}},e}();__reflect(SamsaraBossData.prototype,"SamsaraBossData");var SAMSARABOSS_STATE;!function(e){e[e.UNOPEN=0]="UNOPEN",e[e.FIGHTTING=1]="FIGHTTING",e[e.KILLED=2]="KILLED"}(SAMSARABOSS_STATE||(SAMSARABOSS_STATE={}));var TeamDupData=function(){function e(e){this.playerdata=e}return Object.defineProperty(e.prototype,"playerId",{get:function(){return this.playerdata.playerId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerName",{get:function(){return this.playerdata.name},enumerable:!0,configurable:!0}),e.prototype.parseDamageMsg=function(e){this.damageNum=e.getLong()},e}();__reflect(TeamDupData.prototype,"TeamDupData");var WorldBossInfo=function(){function e(){this.worldBossBuyNum=0}return e.prototype.parseBossMsg=function(e){this.bossId=e.getInt(),this.modelId=e.getShort(),this.currHp=e.getInt(),this.maxHp=e.getInt(),this.lefttime=e.getInt(),this.lefttime=egret.getTimer()+1e3*this.lefttime;var t=0!=e.getByte();t&&(this.caller=new SimplePlayerData,this.caller.parseMsg(e)),this.isKilled=0!=e.getByte(),this.isKilled&&(this.killer=new SimplePlayerData,this.killer.parseMsg(e)),this.worldBossBuyNum=e.getInt()},e}();__reflect(WorldBossInfo.prototype,"WorldBossInfo");var XuezhanInfo=function(){function e(){}return e.prototype.onParseXuezhanInitMsg=function(e){if(this.addStar=0,this.isInit=!0,this.layerStars=[],this.hasBuffIDs=[],this.selectbuffList=[0,0,0],this.attrAddRates=GameCommon.getInstance().getAttributeAry(),this.xuezhanWaveNum=e.getShort(),this.xuezhanStar=e.getShort(),this.reviveNum=e.getByte(),this.isRewardBox=e.getBoolean(),this.isSelectBuff=e.getBoolean(),this.isSelectBuff)for(var t=0;t<this.selectbuffList.length;t++)this.selectbuffList[t]=e.getByte();for(var n=e.getShort(),t=0;n>t;t++){var a=e.getByte();this.addXuezhanBuff(a)}for(var i=e.getShort(),t=0;i>t;t++){var o=e.getByte();this.layerStars[t]=o}},e.prototype.addXuezhanBuff=function(e){this.hasBuffIDs.push(e);var t=JsonModelManager.instance.getModeldifubuff()[e];if(t){var n=String(t.effect).split(","),a=parseInt(n[0]),i=parseInt(n[1]);this.attrAddRates[a]+=i}},e.prototype.cleanBUff=function(){this.attrAddRates=GameCommon.getInstance().getAttributeAry()},e.prototype.onXuezhanSuccess=function(e,t){if(this.isInit){var n=t-this.xuezhanStar;if(n>0){var a=this.layerStars.length>=this.xuezhanWaveNum?this.layerStars[this.xuezhanWaveNum-1]:0;n>a&&(this.layerStars[this.xuezhanWaveNum-1]=n)}this.addStar=t-this.xuezhanStar,this.xuezhanStar=t,this.xuezhanWaveNum=e}},e.prototype.onChallengeNum=function(e,t,n,a,i){if(this.isInit){var o=t-this.xuezhanStar;if(o>0){var r=this.layerStars.length>=this.xuezhanWaveNum?this.layerStars[this.xuezhanWaveNum-1]:0;o>r&&(this.layerStars[this.xuezhanWaveNum-1]=o)}this.isRewardBox=a,this.isSelectBuff=i,this.addStar=t-this.xuezhanStar,this.xuezhanStar=t,this.xuezhanWaveNum=e,this.reviveNum=n}},e.prototype.onChangeInfo=function(e){var t=e.getShort(),n=e.getShort(),a=n-this.xuezhanStar;if(a>0){var i=this.layerStars.length>=this.xuezhanWaveNum?this.layerStars[this.xuezhanWaveNum-1]:0;a>i&&(this.layerStars[this.xuezhanWaveNum-1]=a)}if(this.xuezhanWaveNum=t,this.addStar=a,this.xuezhanStar=n,this.reviveNum=e.getByte(),this.isRewardBox=e.getBoolean(),this.isSelectBuff=e.getBoolean(),this.isSelectBuff)for(var o=0;o<this.selectbuffList.length;o++)this.selectbuffList[o]=e.getByte()},e}();__reflect(XuezhanInfo.prototype,"XuezhanInfo");var CelestialManager=function(){function e(){this.warehouse=[],this.currInfo=[],this._treasuretimes=0,this._treasureAwdIdx=0}return e.prototype.onSendCompoundMessage=function(e,t){var n=new Message(MESSAGE_ID.CELESTIAL_COMPOUND_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendUpgradeMessage=function(e,t){var n=new Message(MESSAGE_ID.CELESTIAL_UPGRADE_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendDecomposeMessage=function(e){var t=new Message(MESSAGE_ID.CELESTIAL_DECOMPOSE_MESSAGE);t.setShort(e.length);for(var n=0;n<e.length;n++)t.setInt(e[n]);GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onParseTreasureWeekAwardMsg=function(e){var t=e.getShort();t>0&&(this._treasuretimes=t),this._treasureAwdIdx=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e)},Object.defineProperty(e.prototype,"treasureTimes",{get:function(){return this._treasuretimes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treasureAwdIdx",{get:function(){return this._treasureAwdIdx},enumerable:!0,configurable:!0}),e.prototype.onSendTakeOutMessage=function(){var e=new Message(MESSAGE_ID.WAREHOUSE_TAKEOUT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseTakeOutMessage=function(e){for(var t=e.getShort(),n=0;t>n;n++)this.warehouse.shift()},e.prototype.onSendCelestiaTreasure=function(e){if(!GameFight.getInstance().checkBagIsFull()){var t=new Message(MESSAGE_ID.TREASURE_CELESTIAL_MEESAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onParseCelestiaTreasure=function(e){var t,n=[];DataManager.getInstance().playerManager.player.treasureFirst=e.getByte();for(var a=e.getByte(),i=0;a>i;i++)t=new AwardItem,t.parseMessage(e),n.push(t);var o=new TurnplateAwardParam;o.desc="寻宝获得以下奖励",o.titleSource="",o.itemAwards=n,o.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",o))},e.prototype.onParseCelestiaTreasureLog=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=new CelestiaLog,t.parseMessage(e),this.currInfo.push(t);this.onfilter()},e.prototype.onfilter=function(){for(;this.currInfo.length>10;)this.currInfo.shift()},e.prototype.getTextFlow=function(){for(var e,t=[],n="",a=0;a<this.currInfo.length;a++){e=this.currInfo[a];var i=GameCommon.getInstance().getThingModel(e.award.type,e.award.id,e.award.quality);if(i){t.push({text:e.name,style:{textColor:2661098}}),t.push({text:" 获得",style:{textColor:16777215}});var o=i.coatardLv+"阶";e.award.quality==GoodsQuality.Orange?n=" "+i.name+"("+o+Language.instance.getText("grade")+")":e.award.quality>=GoodsQuality.Red&&(n=i.coatardLv?" "+i.name+"("+o+")":" "+i.name),t.push({text:n,style:{textColor:GameCommon.getInstance().CreateNameColer(e.award.quality)}}),t.push({text:"\n",style:{}})}}return t.pop(),t},e.prototype.onParseWarehouseMessage=function(e){this.warehouse=[];for(var t,n=e.getShort(),a=0;n>a;a++)t=new AwardItem,t.parseMessage(e),this.warehouse[a]=t},e.prototype.checkEpicTierEquipPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_HONGZHUANG)?this.checkCelestiaPoint()?!0:this.checkOrangeEquipPoint()?!0:this.checkDepotPoint()?!0:DataManager.getInstance().dominateManager.checkDomPoint()?!0:!1:!1},e.prototype.checkTreasurePoint=function(){for(var e=JsonModelManager.instance.getModelxunbao()[1],t=e.box.split("#"),n=0;n<t.length;n++)if(!(this._treasureAwdIdx>n)){var a=t[n]?t[n].split(","):null;if(!a)break;var i=parseInt(a[0]);if(this._treasuretimes>=i)return!0}return!1},e.prototype.checkCelestiaPoint=function(){for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.checkJobCelestiaPoint(e))return!0;return this.checkCanClothGoldEquips()?!0:this.checkGoldDecomposePoint()?!0:!1},e.prototype.checkJobCelestiaPoint=function(e){void 0===e&&(e=0);for(var t=0;t<GameDefine.CELESTIAL_EQUIP_SLOTS.length;t++)if(this.checkJobCelestiaPointBySlot(t+2*MASTER_EQUIP_TYPE.SIZE,e))return!0;return!1},e.prototype.checkJobCelestiaPointBySlot=function(e,t){void 0===t&&(t=0);var n=DataManager.getInstance().playerManager.player.coatardLv,a=this.getPlayerData(t);if(!a)return!1;var i,o,r=a.getEquipBySlot(e),s=JsonModelManager.instance.getModeltianshenzhuangbei();if(r.model&&r.quality==GoodsQuality.Gold){if(i=s[r.model.coatardLv][0],null==i||i.coatardLv==i.next)return!1;o=s[i.next][0]}else o=s[GameDefine.MIN_GOLD_COATARD_LV][0];if(!o)return!1;if(o.coatardLv>n)return!1;var h=DataManager.getInstance().bagManager.getGoodsThingNumById(GameDefine.CELESTIAL_EQUIP_ADVANCE_CONS_ID);if(i){if(h>=o.costNum-i.costNum)return!0}else if(h>=o.costNum)return!0;return!1},e.prototype.checkOrangeEquipPoint=function(){return this.checkRoleOrangeEquipPoint()?!0:this.checkRedDecomposePoint()?!0:this.checkCanClothZhuxianEquips()?!0:FunDefine.checkQihunRedPoint()?!0:!1},e.prototype.checkRoleOrangeEquipPoint=function(){for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.checkJobOrangeEquipPoint(e))return!0;return!1},e.prototype.checkJobOrangeEquipPoint=function(e){void 0===e&&(e=0);var t=this.getPlayerData(e);if(!t)return!1;for(var n=0;n<GameDefine.Equip_Slot_Num;n++)if(this.checkJobOrangeEquipPointBySlot(n+GameDefine.Equip_Slot_Num))return!0;return!1},e.prototype.checkJobOrangeEquipPointBySlot=function(e,t){if(void 0===t&&(t=0),!FunDefine.isFunOpen(FUN_TYPE.FUN_HONGZHUANG))return!1;
var n=this.getPlayerData(t);if(!n)return!1;var a=DataManager.getInstance().bagManager.getGoodsThingById(OrangePanel.ITEM_ID),i=0;if(a&&(i=a.num),0>=i)return!1;var o=n.getEquipBySlot(e),r=0;if(o&&o.model){var s=o.model.coatardLv;if(s==DataManager.getInstance().playerManager.player.coatardLv)return!1;var h=JsonModelManager.instance.getModelhongzhuang()[s-1],l=JsonModelManager.instance.getModelhongzhuang()[s];if(!l)return!1;var g=h?h.hecheng:0;return r=l.hecheng-g,i>=r}var c=JsonModelManager.instance.getModelhongzhuang()[0];return c?(r=c.hecheng,i>=r):!1},e.prototype.checkCanClothZhuxianEquips=function(){var e=DataManager.getInstance().bagManager.getJobClothEquips(1).length;return e>0},e.prototype.checkCanClothGoldEquips=function(){var e=DataManager.getInstance().bagManager.getJobClothEquips(2).length;return e>0},e.prototype.checkRedDecomposePoint=function(){var e=DataManager.getInstance().bagManager.getAllRedEquip().length;return e>0},e.prototype.checkGoldDecomposePoint=function(){var e=DataManager.getInstance().bagManager.getAllGoldEquip().length;return e>0},e.prototype.checkDepotPoint=function(){var e=DataManager.getInstance().celestialManager.warehouse;return e&&e.length>0?!0:!1},e.prototype.getPlayerData=function(e){return DataManager.getInstance().playerManager.player.getPlayerData(e)},e}();__reflect(CelestialManager.prototype,"CelestialManager");var CelestiaLog=function(){function e(){}return e.prototype.parseMessage=function(e){this.name=e.getString(),this.award=new AwardItem,this.award.parseMessage(e)},e}();__reflect(CelestiaLog.prototype,"CelestiaLog");var EquipSlotThing=function(){function e(){this.infuseLv=0,this.infuseExp=0,this.intensifyLv=0,this.gemLv=0,this.zhLv=0,this.quenchingLv=0,this.quenchingExp=0}return e.prototype.parseEquipMessage=function(e){this.infuseLv=e.getInt(),this.infuseExp=e.getInt(),this.intensifyLv=e.getInt(),this.gemLv=e.getInt(),this.zhLv=e.getByte(),this.quenchingLv=e.getByte(),this.quenchingExp=e.getInt()},e.prototype.getGemLvByGemSlot=function(e){var t=Tool.toInt(this.gemLv/GameDefine.GEM_SLOT_NUM);return this.gemLv%GameDefine.GEM_SLOT_NUM>e&&t++,t},e}();__reflect(EquipSlotThing.prototype,"EquipSlotThing");var FourinageData=function(){function e(e){this.level=0,this.grade=0,this.type=e}return e.prototype.parseMsg=function(e){this.level=e.getShort(),this.grade=e.getShort()},Object.defineProperty(e.prototype,"power",{get:function(){var e=GameCommon.getInstance().getAttributeAry();if(this.level>0){var t=1;if(this.grade>0){var n=JsonModelManager.instance.getModelsixiangjinjie()[this.type][this.grade-1];t+=n.effect/GameDefine.GAME_ADD_RATIO}for(var a=JsonModelManager.instance.getModelsixiang()[this.type][this.level-1],i=0;i<ATTR_TYPE.SIZE;++i)a.attrAry[i]>0&&(e[i]+=Math.floor(a.attrAry[i]*t));return GameCommon.calculationFighting(e)}return 0},enumerable:!0,configurable:!0}),e}();__reflect(FourinageData.prototype,"FourinageData");var EscortData=function(){function e(){}return Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,0==this._quality&&(this._quality=1)},enumerable:!0,configurable:!0}),e.MAX_ESCORT_COUNT=3,e.MAX_REFRESH_COUNT=3,e.MAX_ROB_COUNT=5,e.MAX_SHOW_COUNT=7,e}();__reflect(EscortData.prototype,"EscortData");var EscortManager=function(){function e(){this.robList=[],this.log=[],this.hasNewInfo=!1,this.escort=new EscortData,this.record={},GameDispatcher.getInstance().addEventListener(GameEvent.GAME_ESCORT_DONE,this.onEscortDone,this)}return e.prototype.onEscortDone=function(e){var t=e.data,n=this.getIndexByRobID(t.id);-1!=n&&this.robList.splice(n,1)},e.prototype.parseAward=function(e){this.award=new EscortAward,this.award.onParseMessage(e)},e.prototype.parseRecord=function(e){this.log=[];for(var t,n=e.getShort(),a=0;n>a;a++)t=new EscortRecordbase,t.parseInfo(e),this.log.push(t)},e.prototype.parseRedPoint=function(e){this.hasNewInfo=0==e.getByte()},e.prototype.parseReceiveAward=function(e){this.award=null},e.prototype.getCountDown=function(){return this.escort.leftTime-Tool.toInt((egret.getTimer()-this.startTime)/1e3)},e.prototype.setPanel=function(e){this.panel=e},e.prototype.onCountDown=function(){var e=this.getCountDown();e>0?this.panel&&this.panel.onCountDown(e):(Tool.removeTimer(this.onCountDown,this),this.onSendEscortDone())},e.prototype.onSendEscortDone=function(){var e=new Message(MESSAGE_ID.ESCORT_ESCORT_DONE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendEscortAwardReceive=function(){var e=new Message(MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.getRandomCar=function(){var e=EscortData.MAX_SHOW_COUNT;this.filter=[];for(var t,n,a=this.robList.concat();e>0&&0!=a.length;)t=a.length,n=Math.floor(Math.random()*t),this.filter.push(a[n]),a.splice(n,1),e--;return this.filter},e.prototype.parseEscort=function(e){this.escort.quality=e.getByte(),this.escort.count=e.getShort(),this.escort.leftTime=e.getInt(),this.escort.cargo=e.getByte(),this.escort.hurted=e.getByte(),this.escort.rob=e.getShort(),this.escort.refresh=e.getShort(),1==this.escort.cargo&&(this.startTime=egret.getTimer(),Tool.addTimer(this.onCountDown,this))},e.prototype.parseDispatchMsg=function(e){this.escort.quality=e.getByte(),this.escort.count=e.getShort(),this.escort.leftTime=e.getInt(),this.escort.cargo=e.getByte(),this.escort.hurted=e.getByte(),this.escort.leftTime>0&&1==this.escort.cargo&&(this.startTime=egret.getTimer(),Tool.addTimer(this.onCountDown,this))},e.prototype.parseRefreshQualityMsg=function(e){this.escort.quality=e.getByte(),this.escort.refresh=e.getShort()},e.prototype.parseRobListMsg=function(e){var t;this.robList=[];var n,a,a=e.getShort();for(t=0;a>t;t++)n=new EscortRobData,n.parseMsg(e),this.robList.push(n),this.record[n.id]=n},e.prototype.getIndexByRobID=function(e){for(var t,n=-1,a=0;a<this.robList.length;a++)t=this.robList[a],t.id==e&&(n=a);return n},e.prototype.OnRobSomeOne=function(e){var t=-1;return t=this.getIndexByRobID(e),-1==t?!1:this.robList[t].isbeRob?!1:(this.robList[t].isbeRob=!0,this.robList.splice(t,1),this.escort.rob+=1,!0)},e.prototype.oneKeyDone=function(){Tool.removeTimer(this.onCountDown,this)},e.prototype.onSendRobSomeBody=function(e){this.robID=e;var t=new Message(MESSAGE_ID.ESCORT_ROB_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendRevengeSomeBody=function(e,t){this.revengeID=e,this.revengeTime=t;var n=new Message(MESSAGE_ID.ESCORT_REVENGE_MESSAGE);n.setInt(e),n.setInt(Math.floor(t/1e3)),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.getTextFlow=function(e){var t=new Array;switch(e.recordType){case 1:t.push({text:"开始护送",style:{textColor:15326899}}),t.push({text:GameDefine.EQUIP_QUALITE_NAME1[e.quality]+"衣仙女",style:{textColor:GameCommon.getInstance().CreateNameColer(e.quality)}});break;case 2:t.push({text:e.name,style:{textColor:16231950}}),t.push({text:"抢夺我的",style:{textColor:15326899}}),t.push({text:GameDefine.EQUIP_QUALITE_NAME1[e.quality]+"衣仙女",style:{textColor:GameCommon.getInstance().CreateNameColer(e.quality)}}),1==e.succeed?(t.push({text:" ",style:{}}),1==e.isDoneRevenge?t.push({text:"已复仇",style:{textColor:15086130}}):t.push({text:"复仇",style:{underline:!0,href:"event:text event triggered",textColor:2680872}})):(t.push({text:" ",style:{}}),t.push({text:"失败",style:{textColor:15086130}}));break;case 3:t.push({text:"我抢夺了",style:{textColor:15326899}}),t.push({text:e.name,style:{textColor:16231950}}),t.push({text:"仙女",style:{textColor:15326899}}),1==e.succeed?(t.push({text:" ",style:{}}),t.push({text:"成功",style:{textColor:2680872}})):(t.push({text:" ",style:{}}),t.push({text:"失败",style:{textColor:16777215}}))}return t},e.prototype.getShowSysRedpoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_DUJIE)?DataManager.getInstance().escortManager.getHasUnOpenLog()?!0:DataManager.getInstance().escortManager.getCanEscort()?!0:DataManager.getInstance().escortManager.getCanRobSomeBody()?!0:!1:!1},e.prototype.getHasUnOpenLog=function(){return DataManager.getInstance().escortManager.hasNewInfo},e.prototype.getCanEscort=function(){return DataManager.getInstance().escortManager.escort.count<EscortData.MAX_ESCORT_COUNT&&1!=DataManager.getInstance().escortManager.escort.cargo?!0:!1},e.prototype.getCanRobSomeBody=function(){return DataManager.getInstance().escortManager.escort.rob<EscortData.MAX_ROB_COUNT?!0:!1},e.prototype.getHasAwardReceive=function(){return null!=DataManager.getInstance().escortManager.award},e}();__reflect(EscortManager.prototype,"EscortManager");var EscortRecordbase=function(){function e(){this.isRead=!0}return e.prototype.parseInfo=function(e){this.recordType=e.getByte(),this.succeed=e.getByte(),this.revengeID=e.getInt(),this.name=e.getString(),this.quality=e.getByte(),this.time=e.getLong(),this.headId=e.getByte(),this.headFrameId=e.getByte(),this.power=e.getLong(),this.isDoneRevenge=e.getByte()},e.prototype.read=function(){this.isRead=!0},e}();__reflect(EscortRecordbase.prototype,"EscortRecordbase");var EscortAward=function(){function e(){}return e.prototype.onParseMessage=function(e){this.quality=e.getByte(),this.money=e.getInt(),this.rongyu=e.getInt(),this.soulNum=e.getInt();var t=e.getByte();this.log=[];for(var n,a=0;t>a;a++)n=new EscortRecordbase,n.parseInfo(e),this.log.push(n)},e}();__reflect(EscortAward.prototype,"EscortAward");var ForgeManager=function(){function e(){this.gemlotteryFreeTimes=0,this.gemLotteryLog=[]}return e.prototype.getRoleIntensifyPower=function(e){void 0===e&&(e=0);for(var t=0,n=0;n<GameDefine.Equip_Slot_Num;n++){var a=this.getEquipSlotThing(n);a.intensifyLv>0&&(t+=this.getSlotIntensifyPower(n))}return t},e.prototype.getSlotIntensifyPower=function(e){var t=this.getIntensifyAttr(e);return GameCommon.calculationFighting(t)},e.prototype.getRoleInfusePower=function(e){void 0===e&&(e=0);for(var t=0,n=0;n<GameDefine.Equip_Slot_Num;n++){var a=this.getEquipSlotThing(n);a.infuseLv>0&&(t+=this.getSlotInfulsePower(n))}return t},e.prototype.getSlotInfulsePower=function(e){var t=this.getInfuseModel(e);return t?GameCommon.calculationFighting(t.attrAry):0},e.prototype.getRoleGemPower=function(e){void 0===e&&(e=0);for(var t=0,n=0;n<GameDefine.Equip_Slot_Num;n++)t+=this.getSlotGemPower(n);return t},e.prototype.getSlotGemPower=function(e){var t=this.getEquipSlotThing(e);if(0==t.gemLv)return 0;for(var n=GoodsDefine.SLOT_GEMTYPE[t.slot],a=GameCommon.getInstance().getAttributeAry(),i=0;i<GameDefine.GEM_SLOT_NUM;i++){var o=n[i],r=t.getGemLvByGemSlot(i),s=JsonModelManager.instance.getModelbaoshi()[r-1];if(s){var h=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.FORGE),l=s.attrAry[o];a[o]+=l+Tool.toInt(l*h/GameDefine.GAME_ADD_RATIO)}}return GameCommon.calculationFighting(a)},e.prototype.getIntensifyAttr=function(e,t){void 0===t&&(t=-1);var n=GameCommon.getInstance().getAttributeAry();if(GameDefine.QIANGHUA_MAX>=t){if(0>t){var a=this.getEquipSlotThing(e);t=a.intensifyLv}for(var i=JsonModelManager.instance.getModelqianghua()[GoodsDefine.EQUIP_SLOT_TYPE[e]],o=0;o<ATTR_TYPE.SIZE;o++){var r=i.attrAry[o];n[o]=Tool.toInt(r*t+t*(t-1)*r/40)}}return n},e.prototype.getIntensifyCost=function(e,t){void 0===t&&(t=-1);var n=0;if(GameDefine.QIANGHUA_MAX>=t){if(0>t){var a=this.getEquipSlotThing(e);t=a.intensifyLv}var i=JsonModelManager.instance.getModelqianghua()[GoodsDefine.EQUIP_SLOT_TYPE[e]];n=i.cost.num+2*(t-1)}return n},e.prototype.getInfuseModel=function(e,t){void 0===t&&(t=-1);var n=this.getEquipSlotThing(e),a=-1==t?n.infuseLv:t,i=JsonModelManager.instance.getModelronghun()[GoodsDefine.EQUIP_SLOT_TYPE[e]][a-1];return i},e.prototype.getEquipSlotThing=function(e){return this.getPlayer().getPlayerData().getEquipSlotThings(e)},e.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},e.prototype.onParseGemLotteryFreeTimes=function(e){var t=e.getInt();this.gemlotteryFreeTimes=t>0?0:1,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GEM_LOTTERY_FREE))},e.prototype.onParseLotteryLog=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=(e.getString(),e.getString(),e.getString(),"");this.gemLotteryLog.push(a),this.gemLotteryLog.length>20&&this.gemLotteryLog.splice(0,1)}},e.prototype.onParseGemLottery=function(e){for(var t,n=[],a=e.getByte(),i=0;a>i;i++)t=new AwardItem,t.type=e.getByte(),t.id=e.getShort(),t.num=e.getInt(),n.push(t);var o=new TurnplateAwardParam;o.desc="恭喜您获得以下奖励",o.titleSource="",o.itemAwards=n,o.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TurnplateAwardPanel",o))},e.prototype.getCanForge=function(){return!1},e.prototype.getCanInfuse=function(){var e=!1;return e},e.prototype.getCanSmelt=function(){var e=!1;return e},e.prototype.onSendSmeltCommonMessage=function(e,t){var n=new Message(MESSAGE_ID.PLAYER_SMELT_COMMON_MESSAGE);n.setShort(t);for(var a in e)n.setShort(e[a].equipId);GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendSmeltSpecialMessage=function(e,t){var n=new Message(MESSAGE_ID.PLAYER_SMELT_SPECIAL_MESSAGE);n.setShort(t);for(var a in e)n.setShort(e[a].equipId);GameCommon.getInstance().sendMsgToServer(n)},e.prototype.getForgePointShow=function(){return this.getIntensifyPointShow()?!0:this.getInfusePointShow()?!0:this.getGemPointShow()?!0:this.checkQuenchingPoint()?!0:this.checkLianhuaPoint()?!0:!1},e.prototype.getIntensifyPointShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_QIANGHUA))return!1;for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.getJobIntensifyPointShow())return!0;return!1},e.prototype.getJobIntensifyPointShow=function(){var e=DataManager.getInstance().playerManager.player.getPlayerData(),t=(e.getEquipSlotThings(e.currIntensify.slot),JsonModelManager.instance.getModelqianghua()[GoodsDefine.EQUIP_SLOT_TYPE[e.currIntensify.slot]]),n=this.getIntensifyCost(e.currIntensify.slot);if(e.currIntensify.intensifyLv>=GameDefine.QIANGHUA_MAX)return!1;if(n>0){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id,t.cost.type);if(a>=n)return!0}return!1},e.prototype.getInfusePointShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_ZHULING))return!1;for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.getJobInfusePointShow())return!0;return!1},e.prototype.getJobInfusePointShow=function(){var e=JsonModelManager.instance.getModelronghun(),t=DataManager.getInstance().playerManager.player.getPlayerData(),n=t.getEquipSlotThings(t.currInfuseSoul.slot),a=e[GoodsDefine.EQUIP_SLOT_TYPE[t.currInfuseSoul.slot]][n.infuseLv];if(a){var i=DataManager.getInstance().bagManager.getGoodsThingNumById(a.cost.id,a.cost.type);if(i>=a.cost.num)return!0}return!1},e.prototype.getGemPointShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_BAOSHI))return!1;for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.getJobGemPointShow(e))return!0},e.prototype.getJobGemPointShow=function(e){void 0===e&&(e=0);var t=DataManager.getInstance().playerManager.player.getPlayerData(e),n=t.getEquipSlotThings(t.currGemInlay.slot),a=n.getGemLvByGemSlot(t.currGemInlay.slot),i=JsonModelManager.instance.getModelbaoshi()[a];if(i){var o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.cost.id,i.cost.type);if(o>=i.cost.num)return!0}return!1},e.prototype.checkQuenchingPoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_CUILIAN))return!1;for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.getJobQuenching())return!0;return!1},e.prototype.getJobQuenching=function(){for(var e=0;e<GameDefine.Equip_Slot_Num;e++)if(this.getJobQuenchingBySlot(e))return!0;return!1},e.prototype.checkLianhuaPoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_LIANHUA))return!1;for(var e=0;e<GameDefine.Equip_Slot_Num;e++)if(this.checkLianhuaPointBySlot(e))return!0},e.prototype.checkLianhuaPointBySlot=function(e){var t=DataManager.getInstance().playerManager.player.getPlayerData();if(!t)return!1;var n=GoodsDefine.EQUIP_SLOT_TYPE[e],a=t.getEquipSlotThings(e),i=JsonModelManager.instance.getModellianhua(),o=i[n][a.zhLv-1];if(o){var r=DataManager.getInstance().bagManager.getGoodsThingNumById(o.cost.id,o.cost.type);if(r>=o.cost.num)return!0}return!1},e.prototype.getJobQuenchingBySlot=function(e){var t=DataManager.getInstance().playerManager.player.getPlayerData();if(!t)return!1;var n=t.getEquipSlotThings(e),a=JsonModelManager.instance.getModelcuilian()[n.quenchingLv+1];if(!a)return!1;var i=DataManager.getInstance().bagManager.getGoodsThingNumById(GoodsDefine.ITEM_ID_CUILIAN,GOODS_TYPE.ITEM);return i>=a.costNum?!0:!1},e}();__reflect(ForgeManager.prototype,"ForgeManager");var GemManager=function(){function e(){}return e.prototype.onSendMessage=function(e,t,n){var a=new Message(MESSAGE_ID.GEM_INLAY_MESSAGE);a.setByte(e),a.setByte(t),a.setShort(n),GameCommon.getInstance().sendMsgToServer(a)},e.prototype.getSyntheticByType=function(e){var t=[];return t},e.prototype.onSendSyntheticMessage=function(e,t){var n=new Message(MESSAGE_ID.GEM_SYNTHETIC_MESSAGE);n.setShort(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.parseSynthetic=function(e){e.getShort()},e.prototype.getCanUpgradeByModelID=function(e){return!1},e.prototype.getCanUpgradeByType=function(e){return!1},e.prototype.getCanUpgrade=function(){for(var e=0;5>e;e++)if(DataManager.getInstance().gemManager.getCanUpgradeByType(e))return!0;return!1},e.prototype.getCanChangeAndUpgrade=function(){for(var e=0;8>e;e++)if(DataManager.getInstance().gemManager.getCanGemInlayByEquipSlot(e))return!0;return!1},e.prototype.getCanGemInlayByEquipSlot=function(e){return!1},e.prototype.getCanGemInlayByGemSlot=function(e,t){return!1},e.prototype.getCanChangeBySlot=function(e,t){var n,a=DataManager.getInstance().bagManager,i=a.getOneSeriesOBJGemByGemType(e);for(var o in i)if(n=i[o],n.modelId>t)return!0;return!1},e.prototype.getCanUpgradeBySlot=function(e,t){return!1},e}();__reflect(GemManager.prototype,"GemManager");var FriendManager=function(){function e(){this.isfirst=!0,this.hasNewApply=!1,this.ids=[],this.list={},this.list[FRIEND_LIST_TYPE.FRIEND]={},this.list[FRIEND_LIST_TYPE.BLACKLIST]={},this.list[FRIEND_LIST_TYPE.APPLY]={},this.recentContacts=[]}return e.prototype.onParseCaoYaoSend=function(e){for(var t=e.getByte(),n=!1,a=0;t>a;a++){var i=e.getInt();this.list[FRIEND_LIST_TYPE.FRIEND][i]&&(0==this.list[FRIEND_LIST_TYPE.FRIEND][i].isSendCaoYao&&(n=!0),this.list[FRIEND_LIST_TYPE.FRIEND][i].isSendCaoYao=!0)}n&&GameCommon.getInstance().addAlert("赠送成功")},e.prototype.onParseCaoYaoRefresh=function(e){e.getInt()},e.prototype.onParseCaoYaoGet=function(e){for(var t=e.getShort(),n=0;t>n;n++){var a=e.getInt();this.list[FRIEND_LIST_TYPE.FRIEND][a]&&(this.list[FRIEND_LIST_TYPE.FRIEND][a].isGetCaoYao=!1)}GameCommon.getInstance().addAlert("领取成功"),DataManager.getInstance().xiandanManager.yilingEnergy=e.getShort()},e.prototype.onParseFriendList=function(e){var t;this.currType=e.getByte();for(var n=this.list[this.currType]={},a=e.getByte(),i=0;a>i;i++)t=new FriendInfoBase,t.onParseMessage(e),n[t.player.id]=t,this.currType==FRIEND_LIST_TYPE.FRIEND&&(n[t.player.id].isGetCaoYao=e.getBoolean(),n[t.player.id].isSendCaoYao=e.getBoolean());this.currType==FRIEND_LIST_TYPE.APPLY&&(this.getList(FRIEND_LIST_TYPE.APPLY).length>0&&this.isfirst&&(this.isfirst=!1,this.hasNewApply=!0),0==this.getList(FRIEND_LIST_TYPE.APPLY).length&&(this.hasNewApply=!1))},e.prototype.onParseNewApply=function(e){this.hasNewApply=!0},e.prototype.getList=function(e){return GameCommon.getInstance().objToArray(this.list[e])},e.prototype.getObjListByType=function(e){return this.list[e]},e.prototype.onSendGetFriendMessage=function(e){var t=new Message(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendAddFriendMessage=function(e){var t=new Message(MESSAGE_ID.PLAYER_FRIEND_ADD_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendDelFriendMessage=function(e,t){var n=new Message(MESSAGE_ID.PLAYER_FRIEND_DEL_MESSAGE);n.setByte(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendShieldSomeBody=function(e){var t=new Message(MESSAGE_ID.PLAYER_FRIEND_SHIELD_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendApplyFriendMessage=function(e,t){void 0===t&&(t=-1);var n=new Message(MESSAGE_ID.PLAYER_FRIEND_APPLY_MESSAGE);n.setByte(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendSeachAddFriend=function(e){var t=new Message(MESSAGE_ID.PLAYER_FRIEND_SEARCH_MESSAGE);t.setString(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onParseSearch=function(e){var t=e.getByte();if(t>0){var n=new FriendInfoBase;n.onParseMessage(e),this.onSendAddFriendMessage(n.player.id)}},e.prototype.getOnlineTime=function(e){if(0>=e)return"|online";var t=Math.floor(e/86400);if(t>30&&(t=30),t>0)return t+"|day";var n=Math.floor(e/3600);if(n>0)return n+"|hour";var a=Math.floor(e/60);return 0==a&&a++,a>0?a+"|min":void 0},e.prototype.getOnlineStr=function(e){return"day"==e?"天前":"hour"==e?"小时前":"min"==e?"分钟前":"在线"},e.prototype.onShowRedPoint=function(e){this.hasNewApply=e},e.prototype.checkFriendRedPoint=function(){return this.hasNewApply},e.prototype.getIsInBlackList=function(e){var t,n=this.getObjListByType(FRIEND_LIST_TYPE.BLACKLIST);for(var a in n)if(t=n[a],t.player.id==e)return!0;return!1},e.prototype.clearRecentContacts=function(){this.recentContacts=[]},e.prototype.addRecentContacts=function(e,t){var n;for(var a in this.recentContacts)if(n=this.recentContacts[a],n.player.id==e.player.id)return t?void 0:void(n.order=GameCommon.addAndGetChatOrder());t||(e.order=GameCommon.addAndGetChatOrder()),this.recentContacts.push(e)},e.prototype.getRecentContacts=function(){return this.recentContacts},e.FRIEND_MAX=100,e.BLACKLIST_MAX=100,e}();__reflect(FriendManager.prototype,"FriendManager");var FriendInfoBase=function(){function e(e){this.passTime=0,this.order=0,this.isSendCaoYao=!1,this.isGetCaoYao=!1,this.player=e}return e.prototype.onParseMessage=function(e){this.player=new SimplePlayerData,this.player.parseMsg(e),this.passTime=e.getInt()},e}();__reflect(FriendInfoBase.prototype,"FriendInfoBase");var FRIEND_LIST_TYPE;!function(e){e[e.FRIEND=1]="FRIEND",e[e.BLACKLIST=2]="BLACKLIST",e[e.APPLY=3]="APPLY"}(FRIEND_LIST_TYPE||(FRIEND_LIST_TYPE={}));var FRIEND_APPLY_TYPE;!function(e){e[e.AGREE=1]="AGREE",e[e.REFUSE=2]="REFUSE"}(FRIEND_APPLY_TYPE||(FRIEND_APPLY_TYPE={}));var FuLingManager=function(){function e(){this.myDamageNum=0,this.allLingxingCfg=JsonModelManager.instance.getModellingxing()}return e.prototype.onGetLingXingCfg=function(){var e="";for(var t in this.allLingxingCfg){if(this.allLingxingCfg[t].max>DataManager.getInstance().playerManager.player.getPlayerData().fuling[6])return this.nextlingxingCfg=this.allLingxingCfg[t],this.lingxingCfg=this.allLingxingCfg[e],""==e?JsonModelManager.instance.getModellingxing()[1]:this.lingxingCfg;e=t}return this.allLingxingCfg[e]},e.prototype.getFulingpoint=function(){DataManager.getInstance().playerManager.player;return FunDefine.isFunOpen(FUN_TYPE.FUN_FULINGBOSS)?FunDefine.DupFulingbossPoint()?!0:this.getFulingDanPoint()?!0:!1:!1},e.prototype.getFulingDanPoint=function(){var e=JsonModelManager.instance.getModelfuling();for(var t in e){var n=GameCommon.getInstance().getThingModel(e[t].cost.type,e[t].cost.id),a=DataManager.getInstance().bagManager.getGoodsThingById(n.id),i=a?a.num:0;if(i>=e[t].cost.num)return!0}return!1},e.prototype.getFulingDupPoint=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_LINGXING,1);return e&&e.lefttimes>0?!0:!1},e}();__reflect(FuLingManager.prototype,"FuLingManager");var FunctionManager=function(){function e(){this.wanbaFoucs=!0,this.isFocusReward=!1,this.receives=[]}return e.prototype.parseShareInfo=function(e){this.shareDayNum=e.getByte(),this.shareNum=e.getByte();for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.receives.indexOf(a)<0&&this.receives.push(a)}this.cd=e.getInt(),this.cd=this.cd>0?1e3*this.cd+egret.getTimer():0},e.prototype.parseFocusInfo=function(e){this.isFocusReward=e.getBoolean()},e.prototype.sharePoint=function(){return this.shareDayNum<3&&0==this.cd?!0:!1},e.prototype.rewardPoint=function(e,t){return!1},e.prototype.getReceive=function(e){return 1==e?this.receive1:2==e?this.receive2:void 0},e}();__reflect(FunctionManager.prototype,"FunctionManager");var HintManager=function(){function e(){this.isCoolDown=!1,this.storageKey="HintManager",GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.levelUpdate,this)}return e.prototype.levelUpdate=function(e){var t=e.data;if(t)for(var n in JsonModelManager.instance.getModelfunctionLv()){var a=JsonModelManager.instance.getModelfunctionLv()[n];if(a.level==DataManager.getInstance().playerManager.player.level&&2==a.functionType){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("FunOpenPanel",a));break}}},e.prototype.getHintSystemByPriority=function(){if(!this.getIsNeedHintSystem())for(var e=GameDefine.HINT_PRIORITY,t=0;t<e.length;t++)if(this.getIsCanHint(e[t]))return void this.showObtainHintPanel(e[t])},e.prototype.changeCDstate=function(e){this.isCoolDown=e},e.prototype.getIsNeedHintSystem=function(){this.isCoolDown=!1;var e=egret.localStorage.getItem(this.storageKey);if(e){var t=Tool.formatZeroDate(new Date(Date.parse(e))).getTime(),n=Tool.formatZeroDate(new Date).getTime(),a=(n-t)/864e5;0==a?this.isCoolDown=!0:egret.localStorage.removeItem(this.storageKey)}return this.isCoolDown},e.prototype.shieldObtainHint=function(){var e=new Date;egret.localStorage.setItem(this.storageKey,e.toString()),this.isCoolDown=!0},e.prototype.getHintSystemByType=function(e){this.getIsNeedHintSystem()||this.getIsCanHint(e)&&this.showObtainHintPanel(e)},e.prototype.showObtainHintPanel=function(e){},e.prototype.getIsCanHint=function(e){var t;switch(e){case 13:if(!FunDefine.funOpenLevel(13))return!1;break;case 14:if(!FunDefine.funOpenLevel(14))return!1;break;case 15:if(!FunDefine.funOpenLevel(15))return!1;break;case 16:if(!FunDefine.funOpenLevel(16))return!1;break;case 17:if(!FunDefine.funOpenLevel(17))return!1}if(!t)return!1;var n=DataManager.getInstance().bagManager.getGoodsThingById(t.costId),a=n?n.num:0;return a>=t.costNum?!0:!1},e}();__reflect(HintManager.prototype,"HintManager");var BoxThing=function(e){function t(t){return void 0===t&&(t=GOODS_TYPE.BOX),e.call(this,t)||this}return __extends(t,e),t}(ItemThing);__reflect(BoxThing.prototype,"BoxThing");var DominateSlotInfo=function(){function e(){}return e.prototype.parseEquipMessage=function(e){this.lv=e.getShort(),this.tier=e.getShort()},e}();__reflect(DominateSlotInfo.prototype,"DominateSlotInfo");var DominateThing=function(e){function t(t){void 0===t&&(t=GOODS_TYPE.ITEM);var n=e.call(this,t)||this;return n.lv=0,n.tier=0,n.own=0,n}return __extends(t,e),t.prototype.parseEquipMessage=function(e){this.lv=e.getShort(),this.tier=e.getShort()},t}(ItemThing);__reflect(DominateThing.prototype,"DominateThing");var BossBody=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onRefreshData=function(){e.prototype.onRefreshData.call(this),this._moveTarget=null},t.prototype.onResetHeadInfo=function(){this.onShowOrHideHpBar(!1)},t.prototype.setMove=function(t){GameFight.getInstance().canBossMove?e.prototype.setMove.call(this,t):(this._moveTarget=null,this._movePaths=null)},t.prototype.onScaleHandler=function(){this._body&&(this._body.scaleX=1.3,this._body.scaleY=1.3)},t.prototype.onRepelEffect=function(e){},t.prototype.onDeathEffect=function(e){TweenLiteUtil.onHideTween(this)},t}(MonsterBody);__reflect(BossBody.prototype,"BossBody");var GemThing=function(e){function t(t){return void 0===t&&(t=GOODS_TYPE.GEM),e.call(this,t)||this}return __extends(t,e),t}(ItemThing);__reflect(GemThing.prototype,"GemThing");var CurvilinearBody=function(e){function t(t,n,a,i,o){var r=e.call(this)||this;return r.addChild(t),r.x=n.x,r.y=n.y,r.ptEnd=a,r.ptTop=new egret.Point,i=0>(i>100?100:i)?0:i,r.ptTop.x=n.x+(r.ptEnd.x-r.x)*i/100,r.ptTop.y=n.y-o,r}return __extends(t,e),Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(e){this.x=(1-e)*(1-e)*this.x+2*e*(1-e)*this.ptTop.x+e*e*this.ptEnd.x,this.y=(1-e)*(1-e)*this.y+2*e*(1-e)*this.ptTop.y+e*e*this.ptEnd.y},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){this.ptTop=null,this.ptEnd=null,this.removeChildren(),this.parent&&this.parent.removeChild(this)},t}(egret.DisplayObjectContainer);__reflect(CurvilinearBody.prototype,"CurvilinearBody");var RnuesThing=function(e){function t(t){return void 0===t&&(t=GOODS_TYPE.RNUES),e.call(this,t)||this}return __extends(t,e),t.prototype.parseItem1=function(e){var t=e.getShort(),n=e.getInt();this.onupdate(t,-1,n)},t}(ThingBase);__reflect(RnuesThing.prototype,"RnuesThing");var ServantEquipThing=function(e){function t(t){return void 0===t&&(t=GOODS_TYPE.SERVANT_EQUIP),e.call(this,t)||this}return __extends(t,e),t.prototype.parseMessage=function(e){this.equipId=e.getShort(),this.modelId=e.getShort(),this.quality=this.model.quality},Object.defineProperty(t.prototype,"addAttributes",{get:function(){return this._addAttributes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){var e=GameCommon.getInstance().getThingModel(this.type,this.modelId);return e},enumerable:!0,configurable:!0}),t}(EquipThing);__reflect(ServantEquipThing.prototype,"ServantEquipThing");var ServantEquipSlot=function(){function e(e,t){this.intensifyLv=0,this.type=e,this.slot=t}return e.prototype.parseMessage=function(e){this.intensifyLv=e.getShort()},e}();__reflect(ServantEquipSlot.prototype,"ServantEquipSlot");var DropBody=function(e){function t(t,n,a){var i=e.call(this)||this;return i._childOffY=0,i.layer=new egret.DisplayObjectContainer,i.layer.width=64,i.layer.height=64,i.addChild(i.layer),i.dropIcon=new eui.Image,i.dropIcon.width=32,i.dropIcon.height=32,i.dropIcon.horizontalCenter=0,i.dropIcon.y=10,i.layer.addChild(i.dropIcon),i.onUpdate(t,n,a),i}return __extends(t,e),t.prototype.onUpdate=function(e,t,n){this.model=GameCommon.getInstance().getThingModel(e,t,n),this.dropIcon.source=this.model.icon},t.prototype.onShowDropEffect=function(){if(this.model){var e="";switch(this.model.quality){case GoodsQuality.Blue:e="wupindiaoluo_lan";break;case GoodsQuality.Purple:e="wupindiaoluo_zi";break;case GoodsQuality.Orange:e="wupindiaoluo_cheng"}this._animUp?this._animUp.onUpdateRes(e+"_up",-1):(this._animUp=new Animation(e+"_up",-1),this._animUp.x=15,this._animUp.y=20),this.addChild(this._animUp),this._animDown?this._animDown.onUpdateRes(e+"_down",-1):(this._animDown=new Animation(e+"_down",-1),this._animDown.x=15,this._animDown.y=20),this.addChildAt(this._animDown,0)}},t.prototype.onDestyEffect=function(){this._animDown&&(this._animUp.onDestroy(),this._animDown.onDestroy())},Object.defineProperty(t.prototype,"childOffY",{get:function(){return this._childOffY},set:function(e){this.layer&&(this._childOffY=e,this.layer.y=this._childOffY)},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){this.parent&&this.parent.removeChild(this)},t}(egret.DisplayObjectContainer);__reflect(DropBody.prototype,"DropBody");var LegendManager=function(){function e(){}return e.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},e.prototype.getLegendItemPower=function(e,t){void 0===t&&(t=-1);var n=GameCommon.getInstance().getAttributeAry(),a=this.getPlayerData().getLegendBase(e),i=JsonModelManager.instance.getModelshenqi()[e][(-1==t?a.lv:t)-1];if(i)for(var o=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.GOD_ARTIFACT),r=0;r<ATTR_TYPE.SIZE;r++)n[r]=i.attrAry[r]+Tool.toInt(i.attrAry[r]*o/GameDefine.GAME_ADD_RATIO);return n},e.prototype.getLegendPower=function(){for(var e,t=GameCommon.getInstance().getAttributeAry(),n=1;n<=LegendDefine.Legend_Num;n++){e=this.getLegendItemPower(n);for(var a=0;a<ATTR_TYPE.SIZE;a++)t[a]+=e[a]
}return t},e.prototype.legendOnePower=function(e){var t,n;0==e.lv?(t=this.getLegendItemPower(e.index,1),n=JsonModelManager.instance.getModelshenqi()[e.index][0]):(t=this.getLegendItemPower(e.index,e.lv),n=JsonModelManager.instance.getModelshenqi()[e.index][e.lv-1]);var a=GameCommon.calculationFighting(t);return a+n.ewaizhanli},e.prototype.getAllCanLegendAdvance=function(){for(var e=1;6>e;e++)if(this.getCanLegendAdvance(e))return!0;return!1},e.prototype.getCanLegendAdvance=function(e){var t=DataManager.getInstance().playerManager.player.getLegendBase(e);if(!t)return!1;var n=0;1==t.activate&&(n=t.lv);var a=(e+"_"+t.lv,JsonModelManager.instance.getModelshenqi()[e][n]);if(a){var i=a.cost.num,o=DataManager.getInstance().bagManager.getGoodsThingById(a.cost.id),r=null!=o?o.num:0;if(a&&r>=i)return!0}return!1},e.prototype.updateVipGodArtifact=function(e,t){this.getPlayerData().vipgodArtifactDict[e]?this.getPlayerData().vipgodArtifactDict[e].lv=t:(this.getPlayerData().vipgodArtifactDict[e]=new LegendData,this.getPlayerData().vipgodArtifactDict[e].index=e,this.getPlayerData().vipgodArtifactDict[e].lv=t),this.getPlayerData().updataAttribute()},e.prototype.getVipActifactAttrByID=function(e){var t=GameCommon.getInstance().getAttributeAry(),n=this.getPlayerData().vipgodArtifactDict[e];if(n.lv>0)for(var a=JsonModelManager.instance.getModelvipshenqi()[e],i=0;i<ATTR_TYPE.SIZE;i++){var o=a.attrAry[i];o>0&&(t[i]=o*n.lv)}return t},e.prototype.getVipActifactAttrAry=function(){var e=GameCommon.getInstance().getAttributeAry();for(var t in this.getPlayerData().vipgodArtifactDict)for(var n=this.getVipActifactAttrByID(parseInt(t)),a=0;a<ATTR_TYPE.SIZE;a++){var i=n[a];i>0&&(e[a]+=i)}return e},e.prototype.getCostNumByID=function(e){var t=this.getPlayerData().vipgodArtifactDict[e],n=JsonModelManager.instance.getModelvipshenqi()[e];return n.cost.num+Tool.toInt(t.lv/4)},e.prototype.oncheckAllVipActifactRedP=function(){for(var e in JsonModelManager.instance.getModelvipshenqi())if(this.oncheckVipActifactRedP(parseInt(e)))return!0;return!1},e.prototype.oncheckVipActifactRedP=function(e){var t=this.getPlayerData().vipgodArtifactDict[e],n=JsonModelManager.instance.getModelvipshenqi()[e];if(t){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(n.cost.id),i=this.getCostNumByID(n.id);if(a>=i)return!0}else if(this.getPlayerData().viplevel>=n.id)return!0;return!1},e}();__reflect(LegendManager.prototype,"LegendManager");var LegendData=function(){function e(){this.activate=0,this.index=0,this.lv=0}return e}();__reflect(LegendData.prototype,"LegendData");var MagicManager=function(){function e(){this.maxTime=6,this.totalTime=72e5,this.turnMax=5,this.isNeedRecover=!1,this.onSendMessage()}return e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.PLAYER_MAGIC_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseMessage=function(e){this.currCanUpNum=e.getByte(),this.lastTime=e.getInt(),this.onStartCD(),this.currTierExp=e.getInt(),this.turnTime=e.getByte()},e.prototype.onSendUpdateMessage=function(){var e=new Message(MESSAGE_ID.PLAYER_MAGIC_UPGRADE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseUpdateMessage=function(e){DataManager.getInstance().playerManager.player.onParseMagicUpdate(e),this.currCanUpNum=e.getByte(),this.lastTime=e.getInt(),this.onStartCD()},e.prototype.onSendAdvanceMessage=function(){var e=new Message(MESSAGE_ID.PLAYER_MAGIC_ADVANCE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseAdvanceMessage=function(e){DataManager.getInstance().playerManager.player.onParseMagicAdvance(e),this.currTierExp=e.getInt()},e.prototype.onSendTurnplateMessage=function(){var e=new Message(MESSAGE_ID.PLAYER_MAGIC_TURNPLATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseTurnplateMessage=function(e){this.turnTime=e.getByte(),this.multipleIndex=e.getByte(),this.numIndex=e.getByte()},e.prototype.onStartCD=function(){this.isNeedRecover=!1,this.currCanUpNum<6?(this.isNeedRecover=!0,Tool.addTimer(this.onCountDown,this,1e3)):Tool.removeTimer(this.onCountDown,this,1e3)},e.prototype.onCountDown=function(){if(this.isNeedRecover&&(this.lastTime+=1e3,this.lastTime>=this.totalTime)){if(this.lastTime+=1,this.lastTime>=this.maxTime)return this.lastTime=this.maxTime,this.isNeedRecover=!1,void Tool.removeTimer(this.onCountDown,this,1e3);this.lastTime=0}this._CDOwner&&this._CDOwner.onCountDown()},Object.defineProperty(e.prototype,"CDOwner",{set:function(e){this._CDOwner=e},enumerable:!0,configurable:!0}),e.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},Object.defineProperty(e.prototype,"magicUpgradePower",{get:function(){var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][this.getPlayer().MagicLvExp];"1"==this.getPlayer().Magiclv&&(t=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][Number(this.getPlayer().magicLvExp)-1]),t&&(e=t.attrAry);var n=GameCommon.calculationFighting(e);return n*=this.getPlayer().playerDatas.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"magicAdvanceModel",{get:function(){var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];t&&(e=t.attrAry);var n=GameCommon.calculationFighting(e);return n*=this.getPlayer().playerDatas.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"magicAdvancePower",{get:function(){var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];t&&(e=t.attrAry);var n=GameCommon.calculationFighting(e);return n*=this.getPlayer().playerDatas.length},enumerable:!0,configurable:!0}),e.prototype.checkMagicUpgradePoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_FIGHTSPRITE))return!1;var e=DataManager.getInstance().magicManager;if(!e.currCanUpNum||0==e.currCanUpNum)return!1;var t=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][this.getPlayer().MagicNextLvKey];if(!t)var t=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().MagicNextlv][this.getPlayer().MagicLvKey];if(!t)return!1;var n=DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.GOLD);return n>=t.magicDef?!0:!1},e.prototype.checkMagicAdvancePoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_FIGHTSPRITE))return!1;var e=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicNextTierKey][this.getPlayer().MagicNextStar];if(!e)return!1;var t=DataManager.getInstance().bagManager.getGoodsThingNumById(e.cost.id);return t>=e.cost.num?!0:!1},e.prototype.checkMagicTurnplatePoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_FIGHTSPRITE))return!1;var e=DataManager.getInstance().magicManager;if(!Tool.isNumber(e.turnTime))return!1;if(e.turnMax<=e.turnTime)return!1;var t=JsonModelManager.instance.getModelfabaozhuanpan()[e.turnTime+1];if(t.cost.type!=GOODS_TYPE.GOLD)return!1;var n=DataManager.getInstance().playerManager.player.getICurrency(t.cost.type);return n>=t.cost.num?!0:!1},e.prototype.checkMainXyPoint=function(){return this.checkMagicTurnplatePoint()?!0:this.checkMagicAdvancePoint()?!0:this.checkMagicUpgradePoint()?!0:!1},e}();__reflect(MagicManager.prototype,"MagicManager");var Mailbase=function(){function e(){this.isOpen=!0,this.isReceived=!0,this.accessory=[]}return e.prototype.parseMail=function(e){var t;this.id=e.getInt(),this.sendTime=e.getString().split(".")[0],this.title=e.getString(),this.content=e.getString(),this.state=e.getByte();for(var n=e.getByte(),a=0;n>a;a++)t=new accessorybase,t.parseAccessory(e),this.accessory.push(t);var i;this.state>10?(i=Math.floor(this.state/10),this.isReceived=1!=i,i=this.state%10,this.isOpen=1!=i):(this.isOpen=!0,this.isReceived=!0),this.date=new Date(Date.parse(this.sendTime))},e}();__reflect(Mailbase.prototype,"Mailbase");var accessorybase=function(){function e(){this.quality=-1}return e.prototype.parseAccessory=function(e){this.type=e.getByte(),this.id=e.getShort(),this.type==GOODS_TYPE.YUANSHEN?this.lv=e.getByte():this.quality=e.getByte(),this.count=e.getInt()},e}();__reflect(accessorybase.prototype,"accessorybase");var MailManager=function(){function e(){this.mail={}}return e.prototype.parseMail=function(e){for(var t=e.getShort(),n=0;t>n;n++)this.parseMailNew(e)},e.prototype.parseMailRead=function(e){var t=e.getInt(),n=this.getMailByID(t);n&&(n.isOpen=!0)},e.prototype.parseMailAccessory=function(e){var t=e.getInt(),n=this.getMailByID(t);n&&(n.isReceived=!0,n.isOpen=!0)},e.prototype.parseMailAccessoryAll=function(e){for(var t,n,a=e.getShort(),i=0;a>i;i++)t=e.getInt(),n=this.getMailByID(t),n&&(n.isReceived=!0,n.isOpen=!0)},e.prototype.parseMailNew=function(e){var t=new Mailbase;t.parseMail(e),this.mail[t.id]=t},e.prototype.sortMail=function(){var e=[];for(var t in this.mail)e.push(this.mail[t]);return e=e.sort(function(e,t){return e.date>t.date?-1:1})},e.prototype.getMailByID=function(e){return this.mail[e]},e.prototype.getMailList=function(){return this.sortMail()},e.prototype.getCanShowMail=function(){var e,t=DataManager.getInstance().mailManager.mail;for(var n in t)if(e=t[n],!e.isOpen||!e.isReceived)return!0;return!1},e}();__reflect(MailManager.prototype,"MailManager");var MarryManager=function(){function e(){this.partnerId=0,this.partnerName="",this.partnerHead=0,this.partnerHeadIndex=0,this.marryId=0,this.divorceTime=0}return e.prototype.parseMsg=function(e){var t=e.getShort();this.marryDatas=[];for(var n=0;t>n;n++){var a=new MarryData;a.parseMsg(e),a.idx=n,this.marryDatas.push(a)}},e.prototype.parseMsgDivorce=function(e){this.marryId=e.getInt(),this.divorceTime=e.getByte(),DataManager.getInstance().playerManager.player.marriId=this.marryId},e.prototype.parseMsgAgreeDivorce=function(e){this.marryId=e.getInt(),DataManager.getInstance().playerManager.player.marriId=this.marryId},e.prototype.checkMarryTreePoint=function(){if(DataManager.getInstance().playerManager.player.marriId>0){if(this.checkMarryCooperationPoint())return!0;for(var e=0;e<MarryTreePanel.costItem.length;++e)if(this.checkMarryTreeItemPoint(MarryTreePanel.costItem[e]))return!0}return!1},e.prototype.checkMarryTreeItemPoint=function(e){var t=DataManager.getInstance().bagManager.getGoodsThingById(e);return t&&t.num>0?!0:!1},e.prototype.checkMarryCooperationPoint=function(){return DataManager.getInstance().playerManager.player.marriedTreeExp>0?!0:!1},e.prototype.divorcePoint=function(){return this.divorceTime>0||DataManager.getInstance().playerManager.player.marry_divorce>0?!0:!1},e}();__reflect(MarryManager.prototype,"MarryManager");var MarryData=function(){function e(){}return e.prototype.parseMsg=function(e){this.userdata=new SimplePlayerData,this.userdata.parseMsg(e),this.desc=e.getString(),this.cailiId=e.getByte(),this.lastTime=e.getLong()},e}();__reflect(MarryData.prototype,"MarryData");var FateBase=function(){function e(e){void 0===e&&(e=null),this.UID=0,this.modelID=0,this.lv=0,this.exp=0,e&&(this.modelID=e.id)}return e.prototype.parseInit=function(e,t){this.UID=e,this.modelID=t.getShort(),this.lv=t.getShort(),this.exp=t.getInt(),this.slot=t.getByte()+1},e.prototype.parseFate=function(e){this.UID=e.getInt(),this.modelID=e.getShort()},e.prototype.parseFateLv=function(e){this.parseFate(e),this.lv=e.getShort()},e.prototype.parseByModel=function(e){this.modelID=e.id},e.prototype.onUpdate=function(e){this.UID=e},Object.defineProperty(e.prototype,"model",{get:function(){var e=JsonModelManager.instance.getModelmingge()[this.modelID];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightValue",{get:function(){return GameCommon.calculationFighting(this.model.attrAry)},enumerable:!0,configurable:!0}),e.prototype.parseInit1=function(e,t){this.UID=e,this.modelID=t.getShort(),this.lv=t.getShort(),this.exp=t.getInt(),this.slot=t.getByte()+1},e}();__reflect(FateBase.prototype,"FateBase");var FateManager=function(){function e(){this.fateQueue={},this.currGain=[],this.isPackage=!1,this.curDataId=-1,this.idEquip=!1}return e.prototype.parseFate=function(e){for(var t=e.getShort(),n=0;t>n;n++)this.parseOnefate(e)},e.prototype.parseFateGain=function(e){var t,n=e.getInt(),a=e.getByte();1==a?(t=this.parseOnefate(e),GameCommon.getInstance().onGetFateAlert(t.model,n),t.slot=0,DataManager.getInstance().playerManager.player.fates[t.UID]=t):0==a&&this.delOneFate(e)},e.prototype.parseOnefate=function(e){var t=new FateBase,n=e.getInt();return t.parseInit(n,e),DataManager.getInstance().playerManager.player.fates[n]=t,t},e.prototype.delOneFate=function(e){var t=new FateBase,n=e.getInt();t.parseInit(n,e),this.deleteFate(t.UID)},e.prototype.delOnePsychByUID=function(e){delete this.fateQueue[e]},e.prototype.onSendPsychUpgrade=function(e,t){var n=new Message(MESSAGE_ID.PLAYER_PSYCH_UPGRADE_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendPsychEquip=function(e,t,n){var a=new Message(MESSAGE_ID.PLAYER_PSYCH_EQUIP_MESSAGE);a.setByte(e),a.setByte(t),a.setInt(n),GameCommon.getInstance().sendMsgToServer(a)},e.prototype.onSendDecomposeMessage=function(e){var t=e.length,n=new Message(MESSAGE_ID.PLAYER_PSYCH_DECOMPOSE_MESSAGE);n.setShort(t);for(var a=0;t>a;a++)n.setInt(e[a].UID);GameCommon.getInstance().sendMsgToServer(n)},e.prototype.getJobFatePower=function(){for(var e=0,t=0;t<GameDefine.Fate_Slot_Num;t++){var n=this.getFateBySlot(0,t);n.modelID>0&&(e+=this.getOnePsychByID(n.modelID,n.lv))}return e},e.prototype.getOnePsychByID=function(e,t){var n=0,a=JsonModelManager.instance.getModelmingge()[e];if(a){var i=JsonModelManager.instance.getModelminggelv()[t-1],o=[];for(var r in a.attrAry)if(a.attrAry[r]>0)switch(a.pinzhi){case 1:o.push(Tool.toInt(i.attrAry[r]*i.lv/100));break;case 2:o.push(Tool.toInt(i.attrAry[r]*i.lan/100));break;case 3:o.push(Tool.toInt(i.attrAry[r]*i.zi/100));break;case 4:o.push(Tool.toInt(i.attrAry[r]*i.cheng/100));break;case 5:o.push(Tool.toInt(i.attrAry[r]*i.hong/100))}else o.push(0);n=GameCommon.calculationFighting(o)}return n},e.prototype.getFateBySlot=function(e,t){return this.getPlayer().getPlayerData(e).getFateSlot(t)},e.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},e.prototype.getOneLvAllPsych=function(){var e,t=[],n=JsonModelManager.instance.getModelyuanshen();for(var a in n)e=n[a],1==e.lv&&t.push(e);return t},e.prototype.getNextModel=function(e){var t=JsonModelManager.instance.getModelyuanshen()[e];if(!t)return null;var n=t.lv+1,a=JsonModelManager.instance.getModelyuanshen();for(var i in a)if(a[i].lv==n&&a[i].type==t.type&&a[i].pinzhi==t.pinzhi)return a[i];return null},e.prototype.getFatePoint=function(){return DataManager.getInstance().dupManager.difuDupredPoint()?!0:this.getObtainPoint()?!0:this.getFatePackage()?!0:!1},e.prototype.getFatePackage=function(){if(this.getFateEquipPoint(-1))return!1;var e=DataManager.getInstance().playerManager.player.fates,t=0;for(var n in e)e[n]&&e[n].modelID>0&&(t+=1);return t>=2?!0:!1},e.prototype.getObtainPoint=function(){var e=JsonModelManager.instance.getModelchouqian()[DataManager.getInstance().playerManager.player.fateIndex+1],t=DataManager.getInstance().bagManager.getGoodsThingById(153),n=t?t.num:0;return n>=e.costNum?!0:!1},e.prototype.getFateEquipPoint=function(e){if(e&&e>=0)for(var t=e;e+8>t;t++){if(!(DataManager.getInstance().dupManager.getXueZhanHistoryNum>=GoodsDefine.FATE_UNLOCK[t]))return!1;if(this.getFateEquipPowerPoint(this.getPlayer().getPlayerData(0).fateThings[t],e))return!0}else for(var t=0;t<this.getPlayer().getPlayerData(0).fateThings.length;t++){if(!(DataManager.getInstance().dupManager.getXueZhanHistoryNum>=GoodsDefine.FATE_UNLOCK[t]))return!1;if(this.getFateEquipPowerPoint(this.getPlayer().getPlayerData(0).fateThings[t],Tool.toInt(t/7)))return!0}return!1},e.prototype.checkFateEquipProp=function(e,t,n){var a=DataManager.getInstance().playerManager.player.getPlayerData().fateThings,i=JsonModelManager.instance.getModelmingge()[t];switch(e){case 0:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o].modelID];if(r)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}break;case 1:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o+7].modelID];if(r)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}break;case 2:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o+14].modelID];if(r)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}}return!0},e.prototype.getFateEquipPowerPoint=function(e,t){var n=this.getPlayer().fates;if(DataManager.getInstance().dupManager.getXueZhanHistoryNum<GoodsDefine.FATE_UNLOCK[e.slot-1])return!1;for(var a in n)if(this.isEquip(t,n[a].modelID,e.slot-1))return!0;return!1},e.prototype.isEquip=function(e,t,n){var a=DataManager.getInstance().playerManager.player.getPlayerData().fateThings,i=JsonModelManager.instance.getModelmingge()[t];switch(e){case 0:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o].modelID];if(r&&o!=n)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}break;case 1:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o+7].modelID];if(r&&o+7!=n)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}break;case 2:for(var o=0;7>o;o++){var r=JsonModelManager.instance.getModelmingge()[a[o+14].modelID];if(r&&o+14!=n)for(var s in i.attrAry)if(i.attrAry[s]>0&&r.attrAry[s]==i.attrAry[s])return!1}}return!0},e.prototype.getCanChangeOrUpdateBySlot=function(e,t){return this.getCanChangePsychBySlot(e,t)?!0:!1},e.prototype.getCanChangePsychBySlot=function(e,t){var n=this.getPlayer().getPlayerData(e);if(!n)return!1;if(!this.getPlayer().getPsychIsUnlockBySlot(t))return!1;for(var a,i,o=[],r=0;r<GameDefine.Psych_Slot_Num;r++)a=n.getPsychBySlot(r),a.modelID>0&&(r==t&&(i=a),-1==o.indexOf(a.model.type)&&o.push(a.model.type));var s=DataManager.getInstance().psychManager.psychQueue;for(var h in s)if(a=s[h],a.model){if(-1==o.indexOf(a.model.type)&&!i)return!0;if(-1==o.indexOf(a.model.type)&&i&&i.fightValue<a.fightValue)return!0;if(i&&i.model.type==a.model.type&&i.fightValue<a.fightValue)return!0}return!1},e.prototype.getIsEquip=function(e){return DataManager.getInstance().playerManager.player.fates[e]?!1:!0},e.prototype.getCurExp=function(e,t){return e?this.getPlayer().getPlayerData().onGetFate(t)?this.getPlayer().getPlayerData().onGetFate(t):null:DataManager.getInstance().playerManager.player.fates[t]},e.prototype.deleteFate=function(e){this.getIsEquip(e)?this.getPlayer().getPlayerData().onCleanFate(e):DataManager.getInstance().playerManager.player.onCleanFate(e)},e}();__reflect(FateManager.prototype,"FateManager");var PetManager=function(){function e(){this.lottery_FreeTimes=0,this.isFirstLottery=!0,this.curRandomValue=[]}return e.prototype.getOneLvPets=function(){var e,t=[],n=JsonModelManager.instance.getModelchongwushengji();for(var a in n)e=n[a],1==e.lv&&t.push(e);return t},Object.defineProperty(e.prototype,"power",{get:function(){var e=0,t=DataManager.getInstance().playerManager.player.petData;return e+=t.powerNum,e*DataManager.getInstance().playerManager.player.playerDatas.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activatedNum",{get:function(){var e=0,t=DataManager.getInstance().playerManager.player.petData;return t.lv>0&&e++,e},enumerable:!0,configurable:!0}),e.prototype.onSendUpdateMessage=function(){var e=new Message(MESSAGE_ID.PET_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.sendRandomMessage=function(e,t){var n=new Message(MESSAGE_ID.PET_TRAIN_RANDOM_MESSAGE);n.setByte(e?1:0),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendUpgradeMessage=function(){var e=new Message(MESSAGE_ID.PET_UPGRADE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendLotteryLogMessage=function(){var e=new Message(MESSAGE_ID.PET_LOTTERY_LOG_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParsePetLogMsg=function(e){this.lottery_FreeTimes=e.getByte(),this.isFirstLottery=e.getBoolean(),this.lotteryLogs=[];for(var t=e.getByte(),n=0;t>n;n++){var a="",i=e.getString(),o=e.getByte(),r=e.getShort(),s=e.getByte(),h=(e.getInt(),GameCommon.getInstance().getThingModel(o,r,s));h&&(a="恭喜玩家[#16FCE8"+i+"] 召唤出了[#"+GameCommon.Quality_Color_String[h.quality]+h.name+"]宠物！"),this.lotteryLogs.push(a)}},e.prototype.onCheckPetRedPoint=function(){return this.onCheckPetCanUpdate()?!0:this.onCheckPetCanUpgrade()?!0:!1},e.prototype.onCheckPetCanUpdate=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_PET_GRADE))return!1;for(var e=1;e<=PetDefine.MAX_PET_NUM;e++){if(this.onCheckPetCanUpdateByID())return!0;if(this.onCheckPetCanActivate())return!0}return!1},e.prototype.onCheckPetCanActivateById=function(){return!1},e.prototype.onCheckPetCanActivate=function(){var e=DataManager.getInstance().playerManager.player.petData;return 0==e.lv&&this.onCheckPetCanActivateById()?!0:!1},e.prototype.onCheckPetCanUpdateByID=function(){var e=DataManager.getInstance().playerManager.player.petData;if(!e.nextModel)return!1;var t=DataManager.getInstance().bagManager.getGoodsThingNumById(e.nextModel.cost.id,e.nextModel.cost.type);return t>=e.nextModel.cost.num?!0:!1},e.prototype.onCheckPetCanUpgrade=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_PET_GRADE)&&this.onCheckPetCanUpgradeByID()?!0:!1},e.prototype.onCheckPetCanUpgradeByID=function(){var e,e=DataManager.getInstance().playerManager.player.petData;if(!e.nextGradeModel)return!1;var t=DataManager.getInstance().bagManager.getGoodsThingNumById(e.nextGradeModel.cost.id,e.nextGradeModel.cost.type);return t>=e.nextGradeModel.cost.num?!0:!1},e.prototype.onCheckPetRedPointByType=function(e,t){switch(e){case 0:return this.onCheckPetCanUpdateByID();case 1:return this.onCheckPetCanUpgradeByID()}return!1},e.prototype.onCheckPetHasFreeLottery=function(){return this.lottery_FreeTimes>0},e.prototype.onCheckLotteryRedPoint=function(){return this.onCheckPetHasFreeLottery()?!0:!1},e.prototype.parseRandomValue=function(e){for(var t=0;t<GameDefine.PET_ATTR.length;t++)this.curRandomValue[t]=e.getInt()},e.prototype.parsePetDanValue=function(e){},e.prototype.clear=function(){this.curRandomValue=[]},e.prototype.checkRedPoint=function(){if(FunDefine.isFunOpen(FUN_TYPE.FUN_DRAGONSOUL)){var e=DataManager.getInstance().bagManager.getGoodsThingNumById(GameDefine.PET_GOODS_ID);if(e>=GameDefine.LONGHUN_GOODS_NUM)return!0}return!1},e.prototype.getLonghunPower=function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=0;t<GameDefine.PET_ATTR.length;t++)e[t]=this.getPlayerData().longhunAttribute[t];return GameCommon.calculationFighting(e)},e.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},e}();__reflect(PetManager.prototype,"PetManager");var PetData=function(){function e(){this.lv=0,this.grade=0,this.tier=0,this.exp=0,this.isOutBound=!1,this.proArr=[0,0,0,0],this.gradeExp=0,this.gradeStar=0,this.danDic=[],this.danDic[0]=0,this.danDic[1]=0,this.danDic[2]=0}return e.prototype.onParseMessage=function(e){this.lv=e.getShort(),this.exp=e.getInt(),this.grade=e.getByte(),this.gradeStar=e.getByte(),this.gradeExp=e.getInt()},e.prototype.onParseLvMsg=function(e){this.lv=e.getShort(),this.exp=e.getInt()},e.prototype.onParseGradeMsg=function(e){this.grade=e.getByte(),this.gradeStar=e.getByte(),this.gradeExp=e.getInt()},Object.defineProperty(e.prototype,"model",{get:function(){return 0==this.lv?JsonModelManager.instance.getModelchongwushengji()[this.lv]:JsonModelManager.instance.getModelchongwushengji()[this.lv-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextModel",{get:function(){return this._nextModel&&this._nextModel.id==this.id+1||(this._nextModel=JsonModelManager.instance.getModelchongwushengji()[this.lv]),this._nextModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gradeModel",{get:function(){return JsonModelManager.instance.getModelchongwujinjie()[this.grade][this.gradeStar]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextGradeModel",{get:function(){return JsonModelManager.instance.getModelchongwujinjie()[this.grade][this.gradeStar+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"petAtt",{get:function(){var e=GameCommon.getInstance().getAttributeAry(),t=GameCommon.getInstance().getAttributeAry();if(this.lv>0)for(var n=0;n<ATTR_TYPE.SIZE;++n)e[n]+=this.model.attrAry[n];if(this.grade>0||this.gradeStar>0)for(var a=0;a<ATTR_TYPE.SIZE;a++)e[a]+=this.gradeModel.attrAry[a];for(var n=0;4>n;++n)e[n]+=this.proArr[n];for(var i=JsonModelManager.instance.getModelchongwuDan()[1],o=0;o<i.attrAry.length;++o)e[o]+=i.attrAry[o]*this.danDic[1],t[o]+=i.harm*this.danDic[1];for(var r=JsonModelManager.instance.getModelchongwuDan()[2],o=0;o<r.attrAry.length;++o)e[o]+=r.attrAry[o]*this.danDic[2],t[o]+=r.harm*this.danDic[2];for(var o=0;o<ATTR_TYPE.SIZE;++o)e[o]>0&&t[o]&&(e[o]+=Tool.toInt(t[o]*e[o]/GameDefine.GAME_ADD_RATIO));return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"powerNum",{get:function(){return GameCommon.calculationFighting(this.petAtt)},enumerable:!0,configurable:!0}),e}();__reflect(PetData.prototype,"PetData");var EffectBody=function(e){function t(t,n,a){void 0===n&&(n=null),void 0===a&&(a=1);var i=e.call(this)||this;i._isFlip=!1;var o=a>0?!0:!1;i._effectBody=new Animation(t,a,o),o&&i._effectBody.playFinishCallBack(i.onDestroy,i);var r;return r=n==Direction.LEFTUP||n==Direction.LEFT||n==Direction.LEFTDOWN?!0:!1,r!=i._isFlip&&(i._isFlip=r,i._effectBody.scaleX*=-1),i.addChild(i._effectBody),i}return __extends(t,e),t.prototype.onDestroy=function(){this.parent&&this.parent.removeChild(this),this._effectBody&&(this._effectBody.onDestroy(),this._effectBody=null,this.dispatchEvent(new egret.Event(Action_Event.BODY_EFFECT_DESTROY)))},Object.defineProperty(t.prototype,"currFrameTexture",{get:function(){return this._effectBody?this._effectBody.currFrameTexture:null},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(EffectBody.prototype,"EffectBody");var SkillEffectBody=function(e){function t(t,n,a){return void 0===n&&(n=null),void 0===a&&(a=1),e.call(this,t,n,a)||this}return __extends(t,e),t.prototype.onRePlay=function(e,t,n,a){void 0===t&&(t=null),void 0===n&&(n=null),void 0===a&&(a=null),this._effectBody&&(this._effectBody.playNum=e,t&&n&&this._effectBody.playFinishCallBack(t,n,a))},t}(EffectBody);__reflect(SkillEffectBody.prototype,"SkillEffectBody");var DamageData=function(){function e(){this.value=0,this.pojia=0,this.xishou=0,this.judge=-1,this.floatingRD=100,this.isDmgFalse=!1,this.damageFnt="herohpDown_fnt"}return e}();__reflect(DamageData.prototype,"DamageData");var EscortRobData=function(e){function t(){var t=e.call(this)||this;return t.quality=1,t.remainTime=0,t.isbeRob=!1,t}return __extends(t,e),t.prototype.parseMsg=function(t){if(e.prototype.parseMsg.call(this,t),this.quality=t.getByte(),this.remainTime=t.getInt(),this.id>0)this.face=new PlayerData(1,BODY_TYPE.PLAYER);else{this.face=new RobotData(1,BODY_TYPE.ROBOT);var n=GameCommon.powerChangeAttribute(this.fightvalue);this.face.onUpdateRobotInfo(n)}if(this.remainTime<=0){var a=JsonModelManager.instance.getModeldujie()[this.quality];this.remainTime=Tool.toInt(a.keeptime*Math.random()/2)}this.startTime=egret.getTimer()},t.prototype.getCountDown=function(){return this.remainTime-Tool.toInt((egret.getTimer()-this.startTime)/1e3)},t}(SimplePlayerData);__reflect(EscortRobData.prototype,"EscortRobData");var FashionData=function(){function e(){this._limitTime=-1}return e.prototype.parseMsg=function(e){this.id=e.getShort(),this.isWear=e.getBoolean(),this.limitTime=e.getLong(),this.level=e.getShort()},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._model=JsonModelManager.instance.getModelfashion()[this._id],this._skillInfo=new SkillInfo(this._model.skill,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._model.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"limitTime",{get:function(){return this._limitTime},set:function(e){this._limitTime=e>0?1e3*e+egret.getTimer():e},enumerable:!0,configurable:!0}),e.prototype.onResetSkill=function(){this._isUseSkill=!1},e.prototype.getSkill=function(){return this._isUseSkill?null:(this._isUseSkill=!0,this._skillInfo)},Object.defineProperty(e.prototype,"isUseSkill",{get:function(){return this._isUseSkill},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skillInfo",{get:function(){return this._skillInfo},enumerable:!0,configurable:!0}),e}();__reflect(FashionData.prototype,"FashionData");var MonsterData=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.patrolTime=0,a.randomPlTime=0,a.warnDist=0,a.groupId=0,a}return __extends(t,e),Object.defineProperty(t.prototype,"avatar",{get:function(){return this.model.avata},enumerable:!0,configurable:!0}),t.prototype.updateData=function(e,t){if(this._yewaiStageNum=0,e>FightDefine.PVE_BOSS_COMID&&e<=FightDefine.PVE_BOSS_COMID+FightDefine.PVE_BOSS_TOTALMODEL&&(this._yewaiStageNum=GameFight.getInstance().yewai_waveIndex),this.bodyType=t,this.modelid=e,this.model=ModelManager.getInstance().getModelFigher(this.modelid),this.model||Tool.throwException("缺少fightter数据！::::"+this.modelid),this.skills)for(var n=this.skills.length-1;n>=0;n--){var a=this.skills[n];a=null,this.skills.splice(n,1)}else this.skills=[];for(var i=this.model.skill.split(","),n=0;n<i.length;n++){var o=parseInt(i[n]);if(o){var a=new SkillInfo(o,n);this.skills.push(a)}}this.onRefreshProp(),this.onRebirth()},t.prototype.onRefreshProp=function(){if(this._yewaiStageNum>0){if(this._yewaiStageNum>FightDefine.PVE_BOSS_TOTALMODEL){var t=this._yewaiStageNum-FightDefine.PVE_BOSS_TOTALMODEL,n=ModelManager.getInstance().getModelFigher(FightDefine.PVE_BOSS_COMID+FightDefine.PVE_BOSS_TOTALMODEL);this.attributes[ATTR_TYPE.ATTACK]=Tool.toInt(n.attack+.78*Math.pow(t,2)+570*t),this.attributes[ATTR_TYPE.HP]=Tool.toInt(n.hp+50*Math.pow(t,2)+37969*t)}else this.attributes[ATTR_TYPE.ATTACK]=this.model.attack,this.attributes[ATTR_TYPE.HP]=this.model.hp;this.attributes[ATTR_TYPE.PHYDEF]=this.model.phyDef,this.attributes[ATTR_TYPE.MAGICDEF]=this.model.magicDef,this.attributes[ATTR_TYPE.HIT]=this.model.hit,this.attributes[ATTR_TYPE.DODGE]=this.model.dodge,this.attributes[ATTR_TYPE.BLOCK]=this.model.block,this.attributes[ATTR_TYPE.BREAK]=this.model.counter,this.attributes[ATTR_TYPE.CRIT]=this.model.crit,this.attributes[ATTR_TYPE.DUCT]=this.model.duct}else this.attributes[ATTR_TYPE.ATTACK]=this.model.attack,this.attributes[ATTR_TYPE.PHYDEF]=this.model.phyDef,this.attributes[ATTR_TYPE.MAGICDEF]=this.model.magicDef,this.attributes[ATTR_TYPE.HP]=this.model.hp,this.attributes[ATTR_TYPE.HIT]=this.model.hit,this.attributes[ATTR_TYPE.DODGE]=this.model.dodge,this.attributes[ATTR_TYPE.BLOCK]=this.model.block,this.attributes[ATTR_TYPE.BREAK]=this.model.counter,this.attributes[ATTR_TYPE.CRIT]=this.model.crit,this.attributes[ATTR_TYPE.DUCT]=this.model.duct;e.prototype.onRefreshProp.call(this)},t.prototype.onRebirth=function(){e.prototype.onRebirth.call(this),this.level=this.model.level;for(var t=0;t<this.skills.length;t++)this.skills[t].level=1;this.resetAllSkillCD(GameFight.getInstance().enemy_randomIndex),this.patrolPoint=null,this.warnDist=0},Object.defineProperty(t.prototype,"showAnimation",{get:function(){var e;return this.canShowAnimation&&(this.canShowAnimation=!1),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canPatrol",{get:function(){if(this.bodyType!=BODY_TYPE.MONSTER)return!1;
if(!GameFight.getInstance().canPatrol)return!1;if(0==this.randomPlTime)this.randomPlTime=2e3*Math.random();else if(egret.getTimer()-this.patrolTime<this.randomPlTime)return!1;this.patrolTime=egret.getTimer();var e=10*Math.random();return 2>e?!0:!1},enumerable:!0,configurable:!0}),t}(BodyData);__reflect(MonsterData.prototype,"MonsterData");var NpcData=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),Object.defineProperty(t.prototype,"modelId",{get:function(){return this.model.avata},enumerable:!0,configurable:!0}),t.prototype.updateData=function(t,n){e.prototype.updateData.call(this,t,n),this.name=this.model.name},t.prototype.onRefreshProp=function(){this.attributes[ATTR_TYPE.HP]=this.model.hp,e.prototype.onRefreshProp.call(this)},t}(BodyData);__reflect(NpcData.prototype,"NpcData");var OffLineExpData=function(){function e(){}return e}();__reflect(OffLineExpData.prototype,"OffLineExpData");var OffLineExpShareAwd=function(){function e(){}return e.prototype.parseMsg=function(e){this.exp=e.getInt(),this.offexpMix=e.getInt()},e}();__reflect(OffLineExpShareAwd.prototype,"OffLineExpShareAwd");var PetBodyData=function(e){function t(t){var n=e.call(this,t.playerId,BODY_TYPE.PET)||this;return n.playerData=t,n}return __extends(t,e),t.prototype.updateData=function(e,t){if(this.bodyType=t,!this.skills){this.skills=[];for(var n=0;n<SkillDefine.PET_SKILLS.length;n++){var a=SkillDefine.PET_SKILLS[n],i=new SkillInfo(a,n);i.level=1,this.skills.push(i)}}},Object.defineProperty(t.prototype,"playerData",{get:function(){return this._playerdata},set:function(e){this._playerdata=e,this._model=JsonModelManager.instance.getModelchongwujinjie()[this._playerdata.petGrade][0],this.name=GameCommon.getInstance().getNickname(this._playerdata.name)+"的宠物",this.onRefreshProp(),this.onRebirth()},enumerable:!0,configurable:!0}),t.prototype.onRefreshProp=function(){this._playerdata&&(this.attributes[ATTR_TYPE.HP]=100,this.attributes[ATTR_TYPE.ATTACK]=this._playerdata.attributes[ATTR_TYPE.ATTACK],this.attributes[ATTR_TYPE.HIT]=this._playerdata.attributes[ATTR_TYPE.HIT],this.attributes[ATTR_TYPE.CRIT]=this._playerdata.attributes[ATTR_TYPE.CRIT],this.attributes[ATTR_TYPE.BREAK]=this._playerdata.attributes[ATTR_TYPE.BREAK])},Object.defineProperty(t.prototype,"isDie",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"avata",{get:function(){return this._model.waixing1+""},enumerable:!0,configurable:!0}),t}(BodyData);__reflect(PetBodyData.prototype,"PetBodyData");var Player=function(){function e(){this.donate=0,this.savvy=0,this.vigour=0,this.rebirthLv=0,this.tlIntegral=0,this.shoppoint=0,this.id=-1,this.name="",this.headFrameIndex=1,this.loginCode=0,this.zhuanshengID=0,this.jianchiExp=0,this.jianchiLevel=0,this._vipExp=0,this.viplevel=0,this.remainExchageVigourTime=0,this.zhuxianIndex=0,this.treasureFirst=0,this.outBoundPetID=0,this._fateIndex=0,this.sendDesk=0,this.giftState=0,this.giftReward=[],this.chengjiuExp=0,this.chengjiuLvDict={},this.ringLvs=[],this.treeLv=0,this.treeExp=0,this.treeId=0,this.marriId=0,this.marriedTreeExp=0,this.marry_divorce=0,this.marryEquipSuitLvs=[],this.strongerDict=[],this.isUnionSkillInit=!1,this._isInitRefreshAttr=!0,this.figthPowerOld=0,this._playerdatas=[]}return e.prototype.parsePlayerMessage=function(e){this.id=e.getInt(),this.loginCode=e.getShort(),this.name=e.getString(),this.headIndex=e.getByte(),this.headFrameIndex=e.getByte(),this.zhuanshengID=e.getShort(),this.exp=e.getLong(),this.level=e.getShort(),this.money=e.getLong(),this.gold=e.getInt(),GameFight.getInstance().yewaiMapId=e.getShort(),GameFight.getInstance().yewai_waveIndex=e.getShort(),GameFight.getInstance().yewai_batch=e.getByte(),this.smelt=e.getInt(),this.legendQueue=[];for(var t=1;t<=LegendDefine.Legend_Num;t++)this.legendQueue[t]=new LegendData,this.legendQueue[t].index=t;this.parseLegend(e),this.parseJianchiUpdate(e),this.rongyu=e.getInt(),this.arena=e.getInt(),this.vipExp=e.getInt(),this.createTime=e.getLong(),this.currentTime=e.getLong(),this._serverDay=e.getShort(),this.signTime=egret.getTimer(),this.points=e.getInt(),DataManager.getInstance().psychManager.parsePsych(e),this.yewaiAwardWave=e.getShort(),this.noviceGuide=[];for(var n=e.getByte(),a=0;n>a;++a)this.noviceGuide.push(e.getByte());this.donate=e.getInt(),this.vigour=e.getInt(),this.shengwang=e.getInt(),this.tlIntegral=e.getInt(),this.shoppoint=e.getInt(),this.initMagicMessage(e),this.zhuxianIndex=e.getShort(),this.treasureFirst=e.getByte(),this.petData=new PetData;var i=e.getBoolean();if(i){this.petData.onParseMessage(e);for(var a=0;4>a;a++){var o=e.getLong();this.petData.proArr[a]=o}this.petData.danDic[1]=e.getShort(),this.petData.danDic[2]=e.getShort()}this.fateIndex=e.getByte(),this.fates=[];for(var r=e.getByte(),a=0;r>a;a++){var s=e.getInt();this.fates[s]=new FateBase,this.fates[s].parseInit(s,e),this.fates[s].slot=0}DataManager.getInstance().vipManager.onParseInit(e);var h=e.getShort(),l=e.getByte();this.xianDanRolls=[];for(var a=0;l>a;a++){var s=e.getShort();this.xianDanRolls[s]=new XianDanRollData,this.xianDanRolls[s].onParseXianDanInitMsg(s,e)}var g=e.getByte();this.xianDans=[];for(var a=0;g>a;a++){var s=e.getShort();this.xianDans[s]=new XianDanInfo,this.xianDans[s].onParseXianDanInitMsg(s,e)}DataManager.getInstance().xiandanManager.energy=e.getInt(),DataManager.getInstance().xiandanManager.yilingEnergy=e.getShort(),DataManager.getInstance().xiandanManager.curLayer=h,DataManager.getInstance().arenaManager.isWorship=e.getBoolean(),this.vipgodArtifactDict={};for(var c=e.getByte(),a=0;c>a;a++){var p=e.getByte();this.vipgodArtifactDict[p]=new LegendData,this.vipgodArtifactDict[p].index=p,this.vipgodArtifactDict[p].lv=e.getShort()}this.yueli=e.getInt(),this.parseHead(e),DataManager.getInstance().pvpManager.parseInit(e),this.zhangong=e.getInt(),this.chengjiuExp=e.getInt();for(var u=e.getShort(),a=0;u>a;a++)this.chengjiuLvDict[e.getShort()]=1;this.marriId=e.getInt(),this.marry_divorce=e.getByte(),this.marriedTreeExp=e.getInt(),this.parseMarrayTree(e);for(var d=e.getByte(),a=0;d>a;a++)this.ringLvs[a]=e.getInt();for(var _=e.getByte(),m=0;_>m;++m)this.marryEquipSuitLvs[m]=e.getInt();for(var E=e.getByte(),f=0;E>f;++f){var y=new StrongerData;y.type=e.getByte(),y.onParseLvMsg(e),this.strongerDict[y.type]=y}this.shareExp=e.getInt(),this.shareMasterId=e.getShort(),this.wxcolletion=e.getBoolean(),this.xinfaDataAry=[];for(var I=e.getByte(),a=0;I>a;a++)this.addPlayerData(e,a);this._playerdatas[0]&&this.petData.lv>0&&(this._playerdatas[0].petGrade=this.petData.grade),this._isInitRefreshAttr=!1,this.updataAttribute()},e.prototype.parseHead=function(e){this.headMap={};for(var t=e.getByte(),n=0;t>n;++n){var a=e.getByte();this.headMap[a]=e.getShort()}this.headFrameMap={},t=e.getByte();for(var n=0;t>n;++n){var a=e.getByte();this.headFrameMap[a]=e.getShort()}},e.prototype.parseHeadUp=function(e){var t=e.getByte();this.headMap[t]=e.getShort(),this.updataAttribute()},e.prototype.parseHeadFrameUp=function(e){var t=e.getByte();this.headFrameMap[t]=e.getShort(),this.updataAttribute()},e.prototype.getHeadLevel=function(e){return this.headMap[e]?this.headMap[e]:0},e.prototype.getHeadFrameLevel=function(e){return this.headFrameMap[e]?this.headFrameMap[e]:0},e.prototype.addPlayerData=function(e,t){var n=e.getByte();this.sex=e.getByte(),this._playerdatas[t]=new PlayerData(n+1,BODY_TYPE.SELF),this._playerdatas[t].index=t,this._playerdatas[t].name=this.name,this._playerdatas[t].sex=this.sex,this._playerdatas[t].headiconIdx=this.headIndex,this._playerdatas[t].headFrame=this.headFrameIndex,this._playerdatas[t].playerId=this.id;var a=JsonModelManager.instance.getModelzhuansheng()[this.zhuanshengID];this._zhuanshengLv=a.zhuansheng,this._duanweiLv=a.duanwei,this._playerdatas[t].coatardLv=this._zhuanshengLv,this.parsePlayerMsg(this.playerDatas[t],e)},e.prototype.parsePlayerMsg=function(e,t){for(var n=0;n<MASTER_EQUIP_TYPE.SIZE;n++){var a=t.getBoolean();a&&e.onInitEquip(t,n)}for(var n=0;n<MASTER_EQUIP_TYPE.SIZE;n++){var a=t.getBoolean();a&&e.onInitSeniorEquip(t,n)}for(var n=0;n<GameDefine.CELESTIAL_EQUIP_SLOTS.length;n++){var a=t.getBoolean();a&&e.onInitGoldEquip(t,n)}for(var i=t.getByte(),n=0;i>n;n++)this.updateOneISkill(e,n,t.getShort()),e.updateSkillGrade(n,t.getShort()),e.updateSkillSkin(n,t.getShort());for(var o=t.getByte(),n=0;o>n;n++)e.onInitDominate(t,n);for(var r=GameDefine.Equip_Slot_Num,n=0;r>n;n++)e.onInitEquipSlot(t,n);e.pulseLv=t.getShort();for(var n=0;n<Fourinages_Type.SIZE;n++){var s=new FourinageData(n);s.parseMsg(t),e.fourinages[n]=s}for(var n=0;n<BLESS_TYPE.SIZE;n++){var h=new BlessData(n);h.parseMsg(t),e.blessinfos[n]=h,e.parseBlessEquip(n,t),e.parseBlessEquipSlot(n,t);for(var l=t.getByte(),g=0;l>g;g++){var c=new BlessSkillData(n);c.parseMsg(t),e.blessSkillsDict[c.id]=c}for(var p=t.getByte(),g=0;p>g;g++)h.danDic[g]=t.getShort();e.blessWakeLevel[n]=t.getShort()}for(var u=t.getByte(),n=0;u>n;n++)e.onParsePsychEquip(t);for(var d=t.getByte(),n=0;d>n;n++){var _=new FashionData;_.parseMsg(t),e.fashionDatas[_.id]=_,_.isWear&&(e.fashionWearIds[_.type]=_.id),e.onUpdateFashionSkill(_)}e.titleId=t.getShort();var m=t.getByte();e.unionSkill2Array=[];for(var n=0;m>n;n++){var E=new UnionSkill2;E.parseMessage(t),e.unionSkill2Array.push(E)}for(var f=t.getByte(),n=0;f>n;n++)t.getShort();for(var n=0;n<GameDefine.LONGHUAN_ATTR.length;n++)e.longhunAttribute[n]=t.getLong();e.wuxingLevel=t.getShort(),e.qihun=t.getShort();for(var y in JsonModelManager.instance.getModeltujian()){var I=JsonModelManager.instance.getModeltujian()[y],v=new TuJianData(I);v.level=t.getShort(),e.tujianDataDict[v.id]=v}for(var S=t.getByte(),n=0;S>n;n++)e.onParseFateEquip(t);for(var T in this.legendQueue){var M=this.legendQueue[T].lv;M>0&&(this.getPlayerData().legendInfo[T]=M)}e.fulingParse(t),this.xinfaDataAry[e.index]||(this.xinfaDataAry[e.index]={});var A=this.xinfaDataAry[e.index];for(var P in JsonModelManager.instance.getModeltujian2()){var D=JsonModelManager.instance.getModeltujian2()[P],b=new PlayerXinfaData(D.id);b.level=t.getShort(),A[b.id]=b}for(var n=0;50>n;n++)this.getPlayerData().rnuesList[n]=t.getShort();for(var G=t.getByte(),n=0;G>n;n++){var C=t.getShort();this.getPlayerData().tianshuDict[C]||(this.getPlayerData().tianshuDict[C]=new TianshuData);var R=this.getPlayerData().tianshuDict[C];R.level=t.getInt(),R.lvExp=t.getInt(),R.grade=t.getInt()}e.yuanJieParse(t);for(var L=t.getByte(),N=0;L>N;N++){var w=new SkillEnchantData;w.paraseMsg(t),e.skillEnhantDict[w.id]=w}for(var O=t.getByte(),n=1;O>=n;n++){var B=t.getInt();e.taozhuangDict[n]=B}e.updateAppear()},e.prototype.onParseRunesMsg=function(e){for(var t=0;50>t;t++)this.getPlayerData().rnuesList[t]=e.getShort();this.updataAttribute()},e.prototype.onParseOpenRoleMsg=function(e){var t=e.getByte();this.playerDatas.length<=t;this._isInitRefreshAttr=!0,this.addPlayerData(e,t),this._isInitRefreshAttr=!1,this.updataAttribute()},Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"occupation",{get:function(){return this._playerdatas[0].occupation},enumerable:!0,configurable:!0}),e.prototype.getPlayerDataByOccp=function(e){void 0===e&&(e=0);var t;if(-1==e)t=this._playerdatas[0];else for(var n=0;n<this._playerdatas.length;n++)if(e==this._playerdatas[n].occupation){t=this._playerdatas[n];break}return t},e.prototype.getPlayerData=function(e){return void 0===e&&(e=0),this._playerdatas[e]},Object.defineProperty(e.prototype,"playerDatas",{get:function(){return this._playerdatas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expMax",{get:function(){return JsonModelManager.instance.getModellevelup()[this.level-1].exp},enumerable:!0,configurable:!0}),e.prototype.parseSkillUp=function(e){var t=e.getByte(),n=e.getByte(),a=e.getShort(),i=[];i[0]=t;for(var o=this._playerdatas[t].skills.length;o>0;--o)i[o]=this._playerdatas[t].skills[o-1].level;this.updateSkillUp(t,n,a),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e,i)},e.prototype.parseSkillUpAuto=function(e){for(var t=e.getByte(),n=0;n<this._playerdatas[t].skills.length;n++){var a=e.getShort();this.updateSkillUp(t,n,a)}this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.updateSkillUp=function(e,t,n){this._playerdatas[e].updateSkillLevel(t,n)},e.prototype.updateGradeSkill=function(e){var t=e.getByte(),n=e.getByte(),a=e.getShort();this._playerdatas[t].updateSkillGrade(n,a),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessInfo=function(e){var t=e.getByte(),n=e.getByte(),a=e.getBoolean(),i=this.getPlayerData().blessinfos[n];i.isBaoji=a;var o=new BlessData(n);o.level=i.level,o.grade=i.grade,o.exp=i.exp,o.isBaoji=i.isBaoji,i.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e,o),this.updataAttribute(),this.getPlayerData().updateAppear(),o.grade<i.grade&&(n==BLESS_TYPE.RETINUE_CLOTHES&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PET_ENJOIN_MAP)),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_AVATAR_UPDATE),{idx:t,blesstype:n}))},e.prototype.parseBlessEquip=function(e){var t=e.getByte(),n=e.getByte();this._playerdatas[t].parseBlessEquip(n,e),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessSkill=function(e){var t=e.getByte(),n=new BlessSkillData(e.getByte());n.parseMsg(e),this._playerdatas[t].blessSkillsDict[n.id]=n,this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessDan=function(e){var t=(e.getByte(),e.getByte()),n=e.getByte(),a=this.getPlayerData().blessinfos[t],i=e.getShort();a.danDic[n]=i,this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessJuexing=function(e){var t=e.getByte(),n=e.getByte(),a=e.getShort();this._playerdatas[t].blessWakeLevel[n]=a,this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseBlessEquipSlot=function(e){var t=(e.getByte(),e.getByte()),n=e.getByte(),a=this.getPlayerData().blessEquipSlotDict[t];a[n]&&a[n].parseMessage(e),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e,e.getBoolean())},e.prototype.parsInitiativeOneKeySkill=function(e){for(var t=e.getShort(),n=0;t>n;n++)e.getShort(),e.getShort();this.updataAttribute()},e.prototype.parsePassivityOneKeySkill=function(e){},e.prototype.parseLonghunChange=function(e){for(var t=e.getByte(),n=0;n<GameDefine.LONGHUAN_ATTR.length;n++)this._playerdatas[t].longhunAttribute[n]=e.getLong();this.updataAttribute(!0)},e.prototype.parseWuxing=function(e){var t=e.getByte();this._playerdatas[t].wuxingLevel=e.getShort()},e.prototype.parseQihun=function(e){var t=e.getByte();this._playerdatas[t].qihun=e.getShort()},e.prototype.parsrTujian=function(e){var t=e.getByte(),n=e.getShort(),a=e.getShort(),i=this._playerdatas[t].tujianDataDict[n];i&&(i.level=a,this.updataAttribute())},e.prototype.updateXinfa=function(e){var t=e.getByte(),n=this.xinfaDataAry[t],a=e.getShort(),i=n[a];i.level=e.getShort(),this.updataAttribute()},e.prototype.getXinfaDataDict=function(e){return void 0===e&&(e=0),this.xinfaDataAry[e]},e.prototype.updateOneISkill=function(e,t,n){e.updateSkillLevel(t,n)},e.prototype.updateZhuHunInfo=function(e,t,n){this.playerDatas[e].parseZhuHun(t,n)},e.prototype.updateHuanhuaInfo=function(e){},e.prototype.updateFourinageLevel=function(e){var t=e.getByte(),n=e.getByte(),a=this.getPlayerData(t);a.fourinages[n].level=e.getShort(),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.updateFourinageGrade=function(e){var t=e.getByte(),n=e.getByte(),a=this.getPlayerData(t);a.fourinages[n].grade=e.getShort(),this.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.initHuanhuaAvata=function(e){for(var t=[],n=e.getByte(),a=0;n>a;a++){var i=e.getByte(),o=e.getByte();t[i]=o}},e.prototype.parseIntensify=function(e){for(var t=this.getPlayerData(e.getByte()),n=e.getByte(),a=0;n>a;a++)t.parseIntensify(e.getByte(),e.getInt());this.updataAttribute()},e.prototype.parseInfuseSoul=function(e){for(var t=this.getPlayerData(e.getByte()),n=e.getByte(),a=0;n>a;a++)t.parseInfuseSoul(a,e.getInt(),e.getInt());this.updataAttribute()},e.prototype.parseZhunHun=function(e){this.updateZhuHunInfo(e.getByte(),e.getByte(),e.getByte()),this.updataAttribute()},e.prototype.parseGemInlay=function(e){for(var t=this.getPlayerData(e.getByte()),n=e.getByte(),a=0;n>a;a++)t.parseGemInlay(e.getByte(),e.getInt());this.updataAttribute()},e.prototype.parseQuenching=function(e){var t=this.getPlayerData(e.getByte());t.parseQuenching(e.getByte(),e.getByte(),e.getInt()),this.updataAttribute()},e.prototype.parseFuling=function(e){this.getPlayerData(0).fulingParse(e),this.updataAttribute()},e.prototype.parseYuanjie=function(e){this.getPlayerData(0).yuanJieParse(e),this.updataAttribute()},e.prototype.parseLegend=function(e){for(var t=e.getByte(),n=1;t>=n;n++){var a=e.getByte(),i=e.getShort();i>=1&&(this.legendQueue[a].activate=1),this.legendQueue[a].lv=i}},e.prototype.updateLegendInfo=function(e,t){t>=1&&(this.legendQueue[e].activate=1),this.legendQueue[e].lv=t,this.getPlayerData().legendInfo[e]=t},e.prototype.parseLegendActivate=function(e){this.updateLegendInfo(e.getByte(),1),this.updataAttribute()},e.prototype.parseLegendUpdate=function(e){this.updateLegendInfo(e.getByte(),e.getShort()),this.updataAttribute()},e.prototype.getLegendBase=function(e){return this.legendQueue[e]},e.prototype.isLegendActive=function(e){var t=this.getLegendBase(e);return null!=t&&t.lv>0?!0:!1},e.prototype.parsePulseUpdate=function(e){var t=this.getPlayerData(e.getByte());t.parsePulseUpdate(e),this.updataAttribute()},e.prototype.parseJianchiUpdate=function(e){this.jianchiLevel=e.getShort(),this.jianchiExp=e.getInt(),this.updataAttribute()},e.prototype.parseCoatard=function(e){this.zhuanshengID=e.getShort();var t=JsonModelManager.instance.getModelzhuansheng()[this.zhuanshengID];this._zhuanshengLv=t.zhuansheng,this._duanweiLv=t.duanwei;for(var n=0;n<this._playerdatas.length;n++)this._playerdatas[n].coatardLv=this._zhuanshengLv;DataManager.getInstance().bagManager.onupdateBestEquips(),this.updataAttribute(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_LEVEL_UPDATE),!0)},Object.defineProperty(e.prototype,"coatardLv",{get:function(){return this._zhuanshengLv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duanweiLv",{get:function(){return this._duanweiLv},enumerable:!0,configurable:!0}),e.prototype.updateUnionSkill=function(){this.isUnionSkillInit=!0,this.updataAttribute()},e.prototype.updateZhuxianTai=function(e){this.zhuxianIndex!=e&&(this.zhuxianIndex=e,this.updataAttribute())},e.prototype.getICurrency=function(e){var t=0;switch(e){case GOODS_TYPE.SHENGWANG:t=this.shengwang;break;case GOODS_TYPE.ANIMA:t=this.anima;break;case GOODS_TYPE.GOLD:t=this.money;break;case GOODS_TYPE.DIAMOND:t=this.gold;break;case GOODS_TYPE.SHOJIFEN:t=this.shoppoint;break;case GOODS_TYPE.RONGYU:t=this.rongyu;break;case GOODS_TYPE.ARENA:t=this.arena;break;case GOODS_TYPE.HUANQI:t=this.smelt;break;case GOODS_TYPE.ZHANGONG:t=this.zhangong;break;case GOODS_TYPE.YUELI:t=this.yueli;break;case GOODS_TYPE.SHAREEXP:t=this.shareExp}return t},e.prototype.getPlayerMaxHp=function(){for(var e=0,t=0;t<this._playerdatas.length;t++)e+=this._playerdatas[t].maxHp;return e},Object.defineProperty(e.prototype,"playerTotalPower",{get:function(){return this.figthPowerOld},enumerable:!0,configurable:!0}),e.prototype.riviseXianDan=function(e){var t=e.getInt(),n=e.getShort();if(10010==t){var a=0;if(this.xianDans[n]&&this.xianDans[n].havepill>0){this.xianDans[n].shiyongNum=e.getInt();var i=0;i=e.getInt(),a=i-this.xianDans[n].havepill,this.xianDans[n].havepill=i}else this.xianDans[n]=new XianDanInfo,this.xianDans[n].onParseXianDanInitMsg(n,e),a=this.xianDans[n].havepill;var o=JsonModelManager.instance.getModelxiandan()[n],r=new ModelThing(o,24);GameCommon.getInstance().onGetThingAlert(r,a,t)}else this.xianDans[n]=new XianDanInfo,this.xianDans[n].onParseXianDanInitMsg(n,e);DataManager.getInstance().xiandanManager.curDanId=n,DataManager.getInstance().xiandanManager.danBtnStatus=!0,this.updataAttribute()},Object.defineProperty(e.prototype,"fateIndex",{get:function(){return this._fateIndex},set:function(e){this._fateIndex=e},enumerable:!0,configurable:!0}),e.prototype.getOnlineGiftCountDown=function(){return this.onlineGiftTime+(egret.getTimer()-this.onlineGiftTimeStamp)/1e3},e.prototype.onParseRebirthLv=function(e){this.rebirthLv=e.getShort(),this.updataAttribute(),DataManager.getInstance().bagManager.onupdateBestEquips()},e.prototype.onParseDominateUpgrade=function(e){var t=this.getPlayerData(e.getByte());t.onParseDominateUpgrade(e),this.updataAttribute()},e.prototype.onParseDominateAdvance=function(e){var t=this.getPlayerData(e.getByte());t.onParseDominateAdvance(e),this.updataAttribute()},e.prototype.parseSmelt=function(e){this.smelt=e.getInt()},e.prototype.initMagicMessage=function(e){this.magicLv=e.getShort(),this.magicLvExp=e.getByte(),this.magicTier=e.getShort(),this.magicTierStar=e.getByte()},e.prototype.onParseMagicUpdate=function(e){this.magicLv=e.getShort(),this.magicLvExp=e.getByte(),this.updataAttribute()},e.prototype.onParseMagicAdvance=function(e){this.magicTier=e.getShort(),this.magicTierStar=e.getByte(),this.updataAttribute()},Object.defineProperty(e.prototype,"MagicLvKey",{get:function(){return this.magicLv+"_"+this.magicLvExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicLvExp",{get:function(){return""+this.magicLvExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicNextLvKey",{get:function(){var e=this.magicLv;if(0==e)return"1_1";var t=this.magicLvExp+1;return t>9&&(t=0,e+=1),e+"_"+t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicTierKey",{get:function(){return(this.magicTier<=0?1:this.magicTier)+"_"+this.magicTierStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Magiclv",{get:function(){return""+(this.magicLv<=0?1:this.magicLv)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicStar",{get:function(){return""+this.magicTierStar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicStarLv",{get:function(){return""+this.magicTier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicNextlv",{get:function(){var e=this.magicLv<=0?1:this.magicLv,t=this.magicLvExp+1;return t>10&&(t=0,e+=1),""+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicNextStar",{get:function(){var e=this.magicTierStar+1;return e>10&&(e=0),""+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MagicNextTierKey",{get:function(){var e=this.magicTier<=0?1:this.magicTier,t=this.magicTierStar+1;return t>10&&(t=0,e+=1),""+e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playerLevelDesc",{get:function(){return(this.rebirthLv>0?this.rebirthLv+"转":"")+this.level+"级"},enumerable:!0,configurable:!0}),e.prototype.onCheckRoleCanOpen=function(e){var t=!1;switch(e){case 0:t=!0;break;case 1:t=this.level>=80||this.viplevel>=2;break;case 2:t=this.rebirthLv>=4||this.viplevel>=4}return t},e.prototype.getPsychIsUnlockBySlot=function(e){var t=PsychDefine.UNLOCK_CONDITION[e];for(var n in t)switch(n){case"rebirth":if(this.coatardLv>=t[n])return!0;break;case"vip":if(this.viplevel>=t[n])return!0}return!1},Object.defineProperty(e.prototype,"vipExp",{get:function(){return this._vipExp},set:function(e){this._vipExp=e,this.viplevel=GameCommon.getInstance().getVipLevel(e)},enumerable:!0,configurable:!0}),e.prototype.onParsePsychEquip=function(e){var t=this.getPlayerData(e.getByte());t.onParsePsychEquip(e),this.updataAttribute()},e.prototype.onParsePsychUpgrade=function(e){var t=this.getPlayerData(e.getByte());t.onParsePsychEquip(e),this.updataAttribute()},e.prototype.onParseFateEquip=function(e){var t=this.getPlayerData(e.getByte());t.onParseFateEquip(e),this.updataAttribute()},e.prototype.onParseFateEquipRefresh=function(e){var t=this.getPlayerData(e.getByte());t.onParseFateEquip(e),this.updataAttribute()},e.prototype.onParseFateUpgrade=function(e){var t=(e.getShort(),e.getInt()),n=new FateBase;if(n.parseInit1(t,e),DataManager.getInstance().fateManager.idEquip){var a=this.getPlayerData();a.onPreseFateLvUp(n)}else n.slot=0,this.fates[t]=n;this.updataAttribute()},e.prototype.onGetFatelvUp=function(e,t){var n=[];for(var a in this.fates)t==JsonModelManager.instance.getModelmingge()[this.fates[a].modelID].pinzhi&&(a!=e.UID.toString()?n.push(Number(a)):(e.exp!=this.fates[a].exp||e.lv!=this.fates[a].lv||this.fates[a].modelID!=e.modelID||e.slot!=this.fates[a].slot)&&n.push(Number(a)));return n},e.prototype.onCleanFate=function(e){delete this.fates[e]},e.prototype.parseFashionctive=function(e){var t=e.getByte(),n=(e.getByte(),e.getByte()),a=e.getInt(),i=new FashionData;i.id=n,i.limitTime=a,i.level=1;var o=this.playerDatas[t];o.fashionDatas[n]=i,o.onUpdateFashionSkill(i),this.updataAttribute()},e.prototype.parseFasionShow=function(e){var t=e.getByte(),n=e.getByte(),a=e.getByte(),i=this.playerDatas[t];if(i.fashionWearIds[n]){var o=i.fashionWearIds[n],r=i.fashionDatas[o];r&&(r.isWear=!1)}if(a>0){var s=i.fashionDatas[a];s?(i.fashionWearIds[s.type]=a,s.isWear=!0,i.fashionWearIds[n]=a):delete i.fashionWearIds[n]}else delete i.fashionWearIds[n];this.getPlayerData().updateAppear()},e.prototype.parseFashionLvUp=function(e){var t=e.getByte(),n=(e.getByte(),e.getByte()),a=e.getShort(),i=this.playerDatas[t],o=i.fashionDatas[n];o&&(o.level=a),this.updataAttribute()},e.prototype.parseMarrayTree=function(e){this.treeId=e.getByte(),0!=this.treeId&&(this.treeLv=e.getShort(),this.treeExp=e.getInt()),this.updataAttribute()},e.prototype.getMarryRingAttributeAll=function(){var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModelhunjie();for(var n in t){var a=t[n],i=this.ringLvs[a.id-1];if(i>0)for(var o=a.attrAry,r=0;r<o.length;++r)e[r]+=o[r]*i}return e},e.prototype.getMarryRingAttribute=function(e,t){void 0===t&&(t=-1);var n=JsonModelManager.instance.getModelhunjie()[e];if(n){-1==t&&(t=this.ringLvs[e-1]);for(var a=GameCommon.getInstance().getAttributeAry(),i=n.attrAry,o=0;o<i.length;++o)a[o]=i[o]*t;return a}return null},e.prototype.getMarryEquipSuitAttrAll=function(){var e=GameCommon.getInstance().getAttributeAry(),t=JsonModelManager.instance.getModeljiehuntaozhuang();for(var n in t){var a=t[n],i=this.marryEquipSuitLvs[a.id-1];if(i>0)for(var o=a.attrAry,r=0;r<o.length;++r)e[r]+=o[r]*i}return e},e.prototype.getMarryEquipSuitAttr=function(e,t){void 0===t&&(t=-1);var n=JsonModelManager.instance.getModeljiehuntaozhuang()[e];if(n){(t=-1)&&(t=this.marryEquipSuitLvs[e-1]);for(var a=GameCommon.getInstance().getAttributeAry(),i=n.attrAry,o=0;o<i.length;++o)a[o]=i[o]*t;return a}return null},e.prototype.getMarryEquipSuitAttrTZDSewzl=function(){for(var e=DataManager.getInstance().ringManager,t=e.STRONGER_TYPES,n=0,a=0;a<t.length;++a){var i=a+1,o=e.getQHDSModels(i)[0];if(o){var r=JsonModelManager.instance.getModelteshuxiaoguo()[o.teshuxiaoguoId];r&&(n+=r.ewaizhanli)}}return n},e.prototype.parseRingLevelup=function(e){this.ringLvs[e.getShort()-1]=e.getInt(),this.updataAttribute()},e.prototype.parseMarryEquipSuitLevelup=function(e){this.marryEquipSuitLvs[e.getShort()-1]=e.getInt(),this.updataAttribute()},e.prototype.onParseTitle=function(e){DataManager.getInstance().titleManager.parseWear1(e),this.updataAttribute()},e.prototype.onParsePetUpdate=function(e){this.petData.onParseLvMsg(e),this._playerdatas[0]&&this.petData.lv>0&&(this._playerdatas[0].petGrade=this.petData.grade),this.updataAttribute()},e.prototype.onParsePetUpgrade=function(e){this.petData.onParseGradeMsg(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PET_ENJOIN_MAP)),this.updataAttribute()},e.prototype.parseTianshuLevelUpMsg=function(e){var t=(e.getByte(),e.getShort());this.getPlayerData().tianshuDict[t]||(this.getPlayerData().tianshuDict[t]=new TianshuData);var n=this.getPlayerData().tianshuDict[t],a=n.level;n.level=e.getInt(),n.lvExp=e.getInt(),a<n.level&&this.updataAttribute()},e.prototype.parseTianshuGradeMsg=function(e){var t=(e.getByte(),e.getShort()),n=this.getPlayerData().tianshuDict[t];n&&(n.grade=e.getInt(),this.updataAttribute())},e.prototype.updataAttribute=function(e){if(void 0===e&&(e=!1),!this._isInitRefreshAttr){for(var t=GameCommon.getInstance().getAttributeAry(),n=0,a=DataManager.getInstance().legendManager.getLegendPower(),i=0;9>i;++i)t[i]+=a[i];for(var i=1;6>i;++i)if(this.getLegendBase(i)&&this.getLegendBase(i).lv>0){var o=JsonModelManager.instance.getModelshenqi()[i][this.getLegendBase(i).lv-1];n+=o.ewaizhanli}if(this.magicLv>0&&this.magicLvExp>=0){var r=JsonModelManager.instance.getModelfabaoshengji()[this.Magiclv][this.magicLvExp];if("1"==this.Magiclv&&(r=JsonModelManager.instance.getModelfabaoshengji()[this.Magiclv][Number(this.magicLvExp)-1]),r)for(var i=0;i<ATTR_TYPE.SIZE;++i)t[i]+=r.attrAry[i]}if(this.magicTier>0&&this.magicTierStar>=0){var s=JsonModelManager.instance.getModelfabaojinjie()[this.MagicStarLv][this.MagicStar];if(s)for(var i=0;i<ATTR_TYPE.SIZE;++i)t[i]+=s.attrAry[i]}for(var h in DataManager.getInstance().titleManager.titleMap)for(var l=JsonModelManager.instance.getModelchenghao()[DataManager.getInstance().titleManager.titleMap[h].id],g=GameCommon.getInstance().getAttributeAry(l),c=DataManager.getInstance().titleManager.getTitleData(DataManager.getInstance().titleManager.titleMap[h].id),p=0;p<ATTR_TYPE.SIZE;++p)t[p]+=g[p]*c.lv;for(var u=(this.petData,this.petData.petAtt),p=0;p<ATTR_TYPE.SIZE;++p)t[p]+=u[p];var d=JsonModelManager.instance.getModelzhuansheng()[this.zhuanshengID];if(d){var _=[];d.duanweiShuxing.indexOf("#")>=0&&(_=d.duanweiShuxing.split("#"));for(var p=0;p<_.length;++p){var m=_[p].split(",");t[m[0]]+=Number(m[1])}}var E=this.getHeadAttribute();if(E)for(var i=0;i<E.length;++i)t[i]+=E[i];var f=this.getHeadFrameAttribute();if(f)for(var i=0;i<f.length;++i)t[i]+=f[i];for(var y=DataManager.getInstance().legendManager.getVipActifactAttrAry(),p=0;p<ATTR_TYPE.SIZE;++p){var I=y[p];I>0&&(t[p]+=I)}var v=JsonModelManager.instance.getModelzhuxiantai()[this.zhuxianIndex-1];if(v)for(var p=0;p<ATTR_TYPE.SIZE;++p){var I=v.shuxing[p];I>0&&(t[p]+=I)}for(var S=this.getMarryRingAttributeAll(),i=0;i<S.length;++i)t[i]+=S[i];var T=JsonModelManager.instance.getModelxiangsishu()[this.treeLv-1];if(T)for(var i=0;i<T.attrAry.length;++i)t[i]+=T.attrAry[i];for(var M=this.getMarryEquipSuitAttrAll(),i=0;i<M.length;++i)t[i]+=M[i];for(var A=this.getMarryEquipSuitAttrTZDSewzl(),P=0,i=0;i<this.playerDatas.length;++i)P+=this.playerDatas[i].updataAttributeFighting(t,n);P+=A,0!=this.figthPowerOld&&this.figthPowerOld!=P&&(e||!e&&this.figthPowerOld<P)&&PromptPanel.getInstance().fightingAnimShow(this.figthPowerOld,P),this.figthPowerOld=P,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_POWER_UPDATE))}},e.prototype.getHeadAttribute=function(e){if(void 0===e&&(e=null),this.headMap){var t=GameCommon.getInstance().getAttributeAry(),n=e;if(!n){var a=this.getHeadLevel(0);a>0&&(n=JsonModelManager.instance.getModeltouxiangshengji()[a-1])}if(n)for(var i=n.attrAry,o=0;o<i.length;++o)t[o]+=i[o];for(var r in this.headMap)if(parseInt(r)>0)for(var a=this.headMap[r],i=JsonModelManager.instance.getModeltouxiang()[r].attrAry,o=0;o<i.length;++o)t[o]+=i[o]*a;return t}return null},e.prototype.getHeadFrameAttribute=function(e){if(void 0===e&&(e=null),this.headFrameMap){var t=GameCommon.getInstance().getAttributeAry(),n=e;if(!n){var a=this.getHeadFrameLevel(0);a>0&&(n=JsonModelManager.instance.getModeltouxiangkuangshengji()[a-1])}if(n)for(var i=n.attrAry,o=0;o<i.length;++o)t[o]+=i[o];for(var r in this.headFrameMap)if(parseInt(r)>0)for(var a=this.headFrameMap[r],i=JsonModelManager.instance.getModeltouxiangkuang()[r].attrAry,o=0;o<i.length;++o)t[o]+=i[o]*a;
return t}return null},e.prototype.parseStronger=function(e){var t=e.getByte();if(this.strongerDict[t])this.strongerDict[t].onParseLvMsg(e);else{var n=new StrongerData;n.type=t,n.onParseLvMsg(e),this.strongerDict[t]=n}this.updataAttribute()},e.prototype.getCreateDisCurDay=function(){var e=this.currentTime-this.createTime;return parseInt((e/864e5).toString())},Object.defineProperty(e.prototype,"curServerTime",{get:function(){return this.currentTime+egret.getTimer()-this.signTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverDay",{get:function(){var e=Tool.toInt((egret.getTimer()-this.signTime)/864e5);return this._serverDay+e},enumerable:!0,configurable:!0}),e.prototype.parsePetChange=function(e){for(var t=0;4>t;t++)this.petData.proArr[t]=e.getLong();this.updataAttribute(!0)},e.prototype.parsePetDanChange=function(e){var t=DataManager.getInstance().playerManager.player.petData,n=e.getByte(),a=e.getShort();t.danDic[n]=a,this.updataAttribute(!0)},e.prototype.parsePetRandomValue=function(e){for(var t=0;4>t;t++)this.petData.proArr[t]=e.getInt()},e.prototype.parseFashionEtl=function(e){var t=e.getByte(),n=e.getShort();this.getPlayerData(t).taozhuangDict[n]=e.getInt(),this.updataAttribute(!0)},e}();__reflect(Player.prototype,"Player",["IPlayerInfo"]);var LevelData=function(){function e(){this.zsLevel=0,this.level=0}return e}();__reflect(LevelData.prototype,"LevelData");var FlyFontBody=function(e){function t(){var t=e.call(this)||this;return t.cusFlyInTime=0,t.flyDir=1,t.isMove=0,t.isFinish=!1,t.typeBmptxt=new egret.BitmapText,t.bitmapText=new egret.BitmapText,t.bitmapText.letterSpacing=-5,t.bitmapText.scaleX=.5,t.bitmapText.scaleY=.5,t}return __extends(t,e),t.prototype.initFont=function(e){this.damage=e;var t=-e.value,n=e.judge,a=FightDefine.JUDEGE_TXT.length>n&&n>=0?FightDefine.JUDEGE_TXT[n]:null;if(a){switch(n){case FightDefine.JUDGE_POJIA:case FightDefine.JUDGE_XISHOU:this.typeBmptxt.anchorOffsetY=15,this.typeBmptxt.anchorOffsetX=-70,this.typeBmptxt.scaleX=.6,this.typeBmptxt.scaleY=.6,n==FightDefine.JUDGE_POJIA?t=-e.pojia:n==FightDefine.JUDGE_XISHOU&&(t=-e.xishou);break;case FightDefine.JUDGE_MABI:case FightDefine.JUDGE_CHENMO:this.typeBmptxt.anchorOffsetY=80,this.typeBmptxt.anchorOffsetX=40,this.typeBmptxt.scaleX=1,this.typeBmptxt.scaleY=1,t=0;break;case FightDefine.JUDGE_FUHUO:this.typeBmptxt.anchorOffsetX=50,this.typeBmptxt.anchorOffsetY=0,this.typeBmptxt.scaleX=1,this.typeBmptxt.scaleY=1,t=0;break;default:this.typeBmptxt.anchorOffsetX=0,this.typeBmptxt.anchorOffsetY=40,this.typeBmptxt.scaleX=1,this.typeBmptxt.scaleY=1}this.typeBmptxt.font=RES.getRes("font_fight_green_fnt"),this.typeBmptxt.text=a,this.addChild(this.typeBmptxt)}var i=50;if(0!=t){var o="";t>=0?(o+="+"+t,this.bitmapText.font=RES.getRes("font_fight_green_fnt")):(o+=n==FightDefine.JUDGE_XISHOU?-t.toString():t.toString(),this.bitmapText.font=RES.getRes(e.damageFnt)),this.bitmapText.text=o,i=-(this.bitmapText.width/2*this.bitmapText.scaleX),this.bitmapText.x=i,this.addChild(this.bitmapText)}this.typeBmptxt&&(this.typeBmptxt.x=i-100),n==FightDefine.JUDGE_MABI||n==FightDefine.JUDGE_CHENMO?(this.scaleX=2,this.scaleY=2,this.alpha=1,this.targetScale=1,this.playFunc=this.onplaystyle2):n==FightDefine.JUDGE_FUHUO?(this.scaleX=1,this.scaleY=1,this.alpha=1,this.moveY=this.y-300,this.playFunc=this.onplaystyle3):(this.scaleX=1,this.scaleY=1,this.alpha=1,this.targetScale=n==FightDefine.JUDGE_CRIT?4:3,this.moveY="hero_damage_fnt2_fnt"==e.damageFnt?this.y+10:this.y-300,this.playFunc=this.onplaystyle1),this.cusFlyInTime=egret.getTimer()+1e3},t.prototype.play=function(){this.cusFlyInTime<egret.getTimer()&&(this.isFinish=!0),Tool.callback(this.playFunc,this)},t.prototype.onplaystyle1=function(){2==this.isMove&&(this.y>this.moveY&&(this.y-=2),this.alpha-=.01),0==this.isMove?this.scaleX<this.targetScale?(this.scaleX+=.4,this.scaleY+=.4):this.isMove=1:this.scaleX>=1.4?(this.scaleX-=.2,this.scaleY-=.2):this.isMove=2},t.prototype.onplaystyle2=function(){this.scaleX>this.targetScale?(this.scaleX-=.2,this.scaleY-=.2):this.alpha-=.02},t.prototype.onplaystyle3=function(){this.y>this.moveY&&(this.y-=6,this.alpha-=.01)},t.prototype.floatGC=function(){this.parent&&this.parent.removeChild(this),this.removeChildren(),this.isFinish=!1,this.isMove=0,this.damage=null},t}(egret.DisplayObjectContainer);__reflect(FlyFontBody.prototype,"FlyFontBody");var PlayerManager=function(){function e(){this.balance=0,this.verify=0,this.player=new Player,this.offlineData=new OffLineExpData,this.offlineAwdData=new OffLineExpShareAwd,this._funcRewardeds=[],this.coatardRewards=[]}return e.prototype.parseOpenRole=function(e){this.player.onParseOpenRoleMsg(e)},e.prototype.parsePlayerHead=function(e){this.player.headIndex=e.getByte(),GameCommon.getInstance().addAlert("头像替换成功！")},e.prototype.parsePlayerHeadFrame=function(e){this.player.headFrameIndex=e.getByte(),GameCommon.getInstance().addAlert("头像框替换成功！")},e.prototype.checkRedPointHead=function(){if(this.checkRedPointHeadUp())return!0;var e=JsonModelManager.instance.getModeltouxiang(),t=this.player;for(var n in e){var a=e[n];if((a.sex==t.sex||2==a.sex)&&this.checkRedPointHeadModel(a))return!0}return!1},e.prototype.checkRedPointHeadFrame=function(){if(this.checkRedPointHeadFrameUp())return!0;var e=JsonModelManager.instance.getModeltouxiang();this.player;for(var t in e)if(this.checkRedPointHeadModel(e[t]))return!0;return!1},e.prototype.checkRedPointHeadUp=function(){var e=this.player.getHeadLevel(0),t=JsonModelManager.instance.getModeltouxiangshengji()[e];return this.checkRedPointHeadModel(t)},e.prototype.checkRedPointHeadFrameUp=function(){var e=this.player.getHeadFrameLevel(0),t=JsonModelManager.instance.getModeltouxiangkuangshengji()[e];return this.checkRedPointHeadModel(t)},e.prototype.checkRedPointHeadModel=function(e){return e&&e.cost?DataManager.getInstance().bagManager.getGoodsThingNumById(e.cost.id,e.cost.type)>=e.cost.num:!1},e.prototype.parseClothEquip=function(e){var t=e.getByte(),n=this.player.getPlayerData(t),a=n.onupdateEquip(e);this.player.updataAttribute(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(e.getCmdId().toString()),a)},e.prototype.parseOffLineAwardMsg=function(e){var t=this.offlineAwdData.exp;if(this.offlineAwdData.parseMsg(e),t>0&&0==this.offlineAwdData.exp){var n=new TurnplateAwardParam;n.desc="恭喜获得",n.titleSource="",n.itemAwards=[new AwardItem(GOODS_TYPE.EXP,0,t)],n.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",n))}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseCurrencyMsg=function(e){var t=e.getByte();switch(t){case GOODS_TYPE.GOLD:this.parseBindMoney(e);break;case GOODS_TYPE.DIAMOND:this.parseGold(e);break;case GOODS_TYPE.SHENGWANG:this.parseShengwang(e);break;case GOODS_TYPE.ANIMA:this.parseAnima(e);break;case GOODS_TYPE.RONGYU:this.parseRongyu(e);break;case GOODS_TYPE.YUELI:this.parseYueli(e);break;case GOODS_TYPE.VIPEXP:this.parseVipExp(e),DataManager.getInstance().welfareManager.onSendMessage();break;case GOODS_TYPE.ARENA:this.parseArena(e);break;case GOODS_TYPE.POINTS:this.parsePoints(e);break;case GOODS_TYPE.DONATE:this.parseDonate(e);break;case GOODS_TYPE.SAVVY:this.parseSavvy(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.INSPECT_REDPOINT));break;case GOODS_TYPE.VIGOUR:this.parseVigour(e);break;case GOODS_TYPE.TLINTEGRAL:this.parsetlIntegral(e);break;case GOODS_TYPE.SHOJIFEN:this.parsetshopjifen(e);break;case GOODS_TYPE.HUANQI:this.parseHaunqi(e);break;case GOODS_TYPE.SHAREEXP:this.parseShareExp(e);break;case GOODS_TYPE.ZHANGONG:this.parseZhanGong(e)}},e.prototype.parseBindMoney=function(e){var t=e.getLong(),n=e.getShort(),a=t-this.player.money;if(this.player.money=t,!GameDefine.SHIELD_TXT_HINT&&(GameCommon.getInstance().receiveMsgToClient(e),a>0)){var i=GameCommon.getInstance().getThingModel(GOODS_TYPE.GOLD,0);GameCommon.getInstance().onGetThingAlert(i,a,n)}SDKManager.onMoneyUpdate(n,a,t)},e.prototype.parseGold=function(e){var t=e.getLong(),n=e.getShort(),a=t-this.player.gold;if(this.player.gold=t,GameCommon.getInstance().receiveMsgToClient(e),a>0){var i=GameCommon.getInstance().getThingModel(GOODS_TYPE.DIAMOND,0);GameCommon.getInstance().onGetThingAlert(i,a,n)}SDKManager.onDiamondUpdate(n,a,t)},e.prototype.parseShengwang=function(e){var t=e.getLong(),n=e.getShort(),a=t-this.player.shengwang;if(this.player.shengwang=t,GameCommon.getInstance().receiveMsgToClient(e),a>0){var i=GameCommon.getInstance().getThingModel(GOODS_TYPE.SHENGWANG,0);GameCommon.getInstance().onGetThingAlert(i,a,n)}},e.prototype.parseAnima=function(e){var t=e.getLong(),n=t-this.player.anima;if(this.player.anima=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.ANIMA,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseRongyu=function(e){var t=e.getLong(),n=t-this.player.rongyu;if(this.player.rongyu=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.RONGYU,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseYueli=function(e){var t=e.getLong(),n=t-this.player.yueli;if(this.player.yueli=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.YUELI,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseVipExp=function(e){var t=e.getLong(),n=t-this.player.vipExp;if(this.player.vipExp=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.VIPEXP,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseArena=function(e){var t=e.getLong(),n=e.getShort(),a=t-this.player.arena;if(this.player.arena=t,GameCommon.getInstance().receiveMsgToClient(e),a>0){var i=GameCommon.getInstance().getThingModel(GOODS_TYPE.ARENA,0);GameCommon.getInstance().onGetThingAlert(i,a,n)}},e.prototype.parsePoints=function(e){var t=e.getLong(),n=t-this.player.points;if(this.player.points=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.POINTS,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseDonate=function(e){var t=e.getLong(),n=t-this.player.donate;if(this.player.donate=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.DONATE,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseSavvy=function(e){var t=e.getLong(),n=t-this.player.savvy;if(this.player.savvy=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.SAVVY,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseVigour=function(e){var t=e.getLong(),n=t-this.player.vigour;if(this.player.vigour=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.VIGOUR,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parsetlIntegral=function(e){var t=e.getLong(),n=t-this.player.tlIntegral;if(this.player.tlIntegral=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.TLINTEGRAL,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parsetshopjifen=function(e){var t=e.getLong(),n=t-this.player.shoppoint;if(this.player.shoppoint=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.SHOJIFEN,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseHaunqi=function(e){var t=e.getLong(),n=t-this.player.smelt;if(this.player.smelt=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.HUANQI,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseShareExp=function(e){var t=e.getLong(),n=t-this.player.shareExp;if(this.player.shareExp=t,GameCommon.getInstance().receiveMsgToClient(e),t>0){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.SHAREEXP,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseZhanGong=function(e){var t=e.getLong(),n=t-this.player.zhangong;if(this.player.zhangong=t,GameCommon.getInstance().receiveMsgToClient(e),n>0){DataManager.getInstance().pvpManager.updatePvpExp(n);var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.ZHANGONG,0);GameCommon.getInstance().onGetThingAlert(a,n,0)}},e.prototype.parseExp=function(e){var t=e.getLong();this.player.exp=t;var n=e.getBoolean();if(n){var a=e.getShort();this.player.level=a,SDKManager.onLevelUp(this.player)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_LEVEL_UPDATE),n)},e.prototype.parseArtifactEquip=function(e){var t=new ServantEquipThing;t.parseMessage(e)},e.prototype.parseOffLineExp=function(e){this.offlineData.offTime=e.getLong(),this.offlineData.moneynum=e.getInt(),this.offlineData.exp=e.getInt(),this.offlineData.equinum=e.getShort(),this.offlineData.equinumdele=e.getInt(),this.offlineData.moneyRongLian=e.getInt(),this.offlineData.oldLevel=e.getShort(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkJueXingPoint=function(e){if(DataManager.getInstance().playerManager.player.getPlayerData().blessWakeLevel[e]>0)return!1;var t=DataManager.getInstance().blessManager.getBlessJueXingItemId(e);return DataManager.getInstance().bagManager.getGoodsThingNumById(t)>0},e.prototype.checkLingDanPoint=function(e,t){var n=DataManager.getInstance().blessManager.getblessDanModel(e,t);if(n){var a=DataManager.getInstance().bagManager.getGoodsThingById(JsonModelManager.instance.getModelitem()[n.cost.id].id);if(a&&a.num>=n.cost.num)return!0}return!1},e.prototype.parsePassSceneUpdate=function(e){DataManager.getInstance().playerManager.player.yewaiAwardWave=e.getShort(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkMountSkill=function(e){for(var t=DataManager.getInstance().blessManager.skillModels(e),n=0;n<t.length;n++)if(DataManager.getInstance().bagManager.getGoodsThingNumById(t[n].cost.id,t[n].cost.type)>=t[n].cost.num)return!0;return!1},e.prototype.checkMountQianghua=function(e,t){var n=this.player.getPlayerData().getBlessEquipSlot(e,t),a=JsonModelManager.instance.getModelmountEqianghua()[t][n.intensifyLv];if(!a)return!1;var i=DataManager.getInstance().playerManager.player.getICurrency(a.cost.type);return i>=a.cost.num?!0:!1},e.prototype.checkBlessUPCostMoney=function(e,t){void 0===t&&(t=-1);var n=DataManager.getInstance().blessManager,a=n.getPlayerBlessData(e),i=n.getBlessModelByData(a);if(!i||!n.getNextBlessModel(e,a.grade,a.level))return!1;if(-1==t)for(var o=0;o<i.costList.length;o++){var r=i.costList[o],s=DataManager.getInstance().bagManager.getGoodsThingById(r.id,r.type);if(s&&s.num>=r.num)return!0}else{var r=i.costList[t];if(r){var s=DataManager.getInstance().bagManager.getGoodsThingById(r.id,r.type);if(s&&s.num>=r.num)return!0}}return!1},e.prototype.checkBlessUPMain=function(e){var t=this.getBlessFunType(e);if(!FunDefine.isFunOpen(t))return!1;var n=DataManager.getInstance().blessManager,a=n.getPlayerBlessData(e);if(0==a.grade&&0==a.level)return!0;if(this.checkBlessUPCostMoney(e))return!0;if(this.chechFashionTaoZhuang(e))return!0;for(var i=0;i<BlessDefine.BLESS_SLOT_MAXNUM;i++)if(this.checkMountEquipRedPoint(e,i))return!0;if(this.checkMountSkill(e))return!0;for(var i=0;i<BlessDefine.BLESS_SLOT_MAXNUM;i++){if(this.checkJueXingPoint(e))return!0;if(this.checkLingDanPoint(e,0))return!0;if(this.checkLingDanPoint(e,1))return!0}return!1},e.prototype.checkMagicEquipPoint=function(e){for(var t=0;t<BlessDefine.BLESS_SLOT_MAXNUM;t++)if(this.checkMountEquipRedPoint(e,t))return!0;return!1},e.prototype.chechFashionTaoZhuang=function(e){var t=JsonModelManager.instance.getModelmounttaozhuang()[e];for(var n in t)if(this.chechFashionTaoZhuangOne(t[n]))return!0;return!1},e.prototype.chechFashionTaoZhuangOne=function(e){if(this.player.getPlayerData().taozhuangDict[e.id]<Constant.get(Constant.TAOZHUANG_MAX))if(this.player.getPlayerData().taozhuangDict[e.id]>0){if(DataManager.getInstance().bagManager.getGoodsThingNumById(e.cost.id,e.cost.type)>=e.cost.num)return!0}else{var t;e.fashionId.indexOf(",")>=0&&(t=e.fashionId.split(","));for(var n=0;n<t.length;n++){var a=JsonModelManager.instance.getModelfashion()[t[n]],i=this.player.getPlayerData().fashionDatas[a.id];if(!i||0==i.level)return!1}if(0==this.player.getPlayerData().taozhuangDict[e.id])return!0}return!1},e.prototype.getBlessFunType=function(e){switch(e){case BLESS_TYPE.HORSE:return FUN_TYPE.FUN_MOUNT;case BLESS_TYPE.CLOTHES:return FUN_TYPE.FUN_SHENZHUANG;case BLESS_TYPE.WEAPON:return FUN_TYPE.FUN_SHENBING;case BLESS_TYPE.WING:return FUN_TYPE.FUN_XIANYU;case BLESS_TYPE.MAGIC:return FUN_TYPE.FUN_FABAO}return 0},e.prototype.checkHasBossAward=function(){var e=GameFight.getInstance().yewai_waveIndex>this.player.yewaiAwardWave+GameDefine.Pass_Wave_Num?this.player.yewaiAwardWave+GameDefine.Pass_Wave_Num:0;return e>0},e.prototype.checkFashionRedPoint=function(){for(var e=0;e<BLESS_TYPE.SIZE;e++)if(this.checkFashionPointByType(e))return!0;return!1},e.prototype.checkFashionRedPointByTab=function(e){switch(e){case 0:for(var t=0;t<BLESS_TYPE.RETINUE_HORSE;t++)if(this.checkFashionPointByType(t))return!0;break;case 1:for(var t=BLESS_TYPE.RETINUE_HORSE;t<BLESS_TYPE.SIZE;t++)if(this.checkFashionPointByType(t))return!0}return!1},e.prototype.checkFashionPointByType=function(e){var t=JsonModelManager.instance.getModelfashion();for(var n in t){var a=JsonModelManager.instance.getModelfashion()[n];if(a.type==e&&this.checkFashionPointByID(a.id))return!0}return!1},e.prototype.checkFashionPointByID=function(e){var t=JsonModelManager.instance.getModelfashion()[e],n=this.player.getPlayerData().fashionDatas[e];if(n){var a=DataManager.getInstance().bagManager.getGoodsThingById(t.cost.id,t.cost.type);if(a&&a.num>=t.cost.num)return!0}return!1},e.prototype.checkMountEquipRedPoint=function(e,t){void 0===t&&(t=0);var n=DataManager.getInstance().playerManager.player,a=n.getPlayerData(),i=DataManager.getInstance().bagManager.getGoodsListByType(GOODS_TYPE.SERVANT_EQUIP);if(i)for(var o=0;o<i.length;++o){var r=i[o];if(r.model.blesstype==e&&!(n.coatardLv<r.model.coatardLv)&&r.model.part==t){var s=a.getBlessEquip(e,t);if(!s)return!0;if(r.model.pingfenValue>s.model.pingfenValue)return!0}}return!1},e.prototype.getFashionIDsByType=function(e){if(!this.fashionIdsByType){this.fashionIdsByType={};for(var t in JsonModelManager.instance.getModelfashion()){var n=JsonModelManager.instance.getModelfashion()[t];this.fashionIdsByType[n.type]||(this.fashionIdsByType[n.type]=[]);var a=this.fashionIdsByType[n.type];if(0==a.length)a.push(n.id);else{for(var i=!1,o=0;o<a.length;o++){var r=JsonModelManager.instance.getModelfashion()[a[o]];if(r.order>n.order){a.splice(o,0,n.id),i=!0;break}}i||a.push(n.id)}}}return this.fashionIdsByType[e]},e.prototype.checkDeskPoint=function(){return 0==this.player.sendDesk?!0:!1},e.prototype.checkZhuanShengPoint=function(){var e=JsonModelManager.instance.getModelzhuansheng()[this.player.zhuanshengID+1];return e&&this.player.level>=e.tiaojianLv&&GameFight.getInstance().yewai_waveIndex>=e.tiaojianGuanqia?!0:!1},e.prototype.checkWanBaVipPoint=function(){return this.player.wanbaVip?!0:!1},e.prototype.onSendTianshiAwardMsg=function(e){void 0===e&&(e=!0);var t=new Message(MESSAGE_ID.XYX_SHARE_EXP_MESSAGE);t.setBoolean(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseTianshiAwardMsg=function(e){e.getByte();this.tianshiInviteNum=e.getByte(),this.tianshiAwdNum=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseTianshiActivateMsg=function(e){DataManager.getInstance().playerManager.player.shareMasterId=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e),this.player.updataAttribute()},e.prototype.getTianshiAttrPlusByBlessType=function(e){return this.getTianshiAttrPlusByType(e)},e.prototype.getTianshiAttrPlusByType=function(e){var t=0;for(var n in JsonModelManager.instance.getModelshareMaster()){var a=JsonModelManager.instance.getModelshareMaster()[n];if(a.id>this.player.shareMasterId)break;a.type==e&&(t=a.allplus)}return t},e.prototype.oncheckTianshiRPoint=function(){var e=JsonModelManager.instance.getModelshareMaster()[this.player.shareMasterId+1];if(e)return e.exp<=this.player.shareExp?!0:e.friendNumMax>this.tianshiAwdNum&&this.tianshiInviteNum-this.tianshiAwdNum>0?!0:!1},e.prototype.parseFuncAwardedMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=e.getShort();this._funcRewardeds.indexOf(a)<0&&this._funcRewardeds.push(a)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getFunIsAwarded=function(e){return this._funcRewardeds.indexOf(e)>=0},e.prototype.parseCoatardRewardMessage=function(e){for(var t=e.getByte(),n=0;t>n;n++)this.coatardRewards[n]=e.getByte()},e.prototype.getCoatardRewardStatus=function(e){return e<this.coatardRewards.length?1==this.coatardRewards[e]:!1},e.prototype.receiveAllCoatard=function(){for(var e=0;e<this.coatardRewards.length;e++)if(0==this.coatardRewards[e])return!1;return!0},e.prototype.parseVerifyMessage=function(e){this.verify=e.getByte()},e.prototype.shenqiPoint=function(){if(DataManager.getInstance().activityManager.activity[ACTIVITY_BRANCH_TYPE.MONEYTAKEGODGIFT]){var e=DataManager.getInstance().newactivitysManager.shenqiData;if(e.isgoal&&!this.player.isLegendActive(e.round+1))return DataManager.getInstance().legendManager.getCanLegendAdvance(e.round+1)}return!1},e.prototype.getXinfaDataByID=function(e){var t=this.player.getXinfaDataDict();return t[e]},e.prototype.getXinfaOneAttrByID=function(e){var t=GameCommon.getInstance().getAttributeAry(),n=this.getXinfaDataByID(e);if(n.level>0)for(var a=JsonModelManager.instance.getModeltujian2()[e],i=0;i<ATTR_TYPE.SIZE;i++){var o=a.attrAry[i];o>0&&(t[i]=o*n.level)}return t},e.prototype.getAllXinfaAttrAry=function(){var e=GameCommon.getInstance().getAttributeAry();for(var t in this.player.getXinfaDataDict())for(var n=this.getXinfaOneAttrByID(parseInt(t)),a=0;a<ATTR_TYPE.SIZE;a++){var i=n[a];i>0&&(e[a]+=i)}return e},e.prototype.getoneXinfaUpCostByID=function(e){var t=this.getXinfaDataByID(e),n=JsonModelManager.instance.getModeltujian2()[e];return n.cost.num+Tool.toInt(t.level/4)},Object.defineProperty(e.prototype,"xinfaAddTotalExp",{get:function(){var e=0;for(var t in this.player.getXinfaDataDict()){var n=this.getXinfaDataByID(parseInt(t));if(n.level>0){var a=JsonModelManager.instance.getModeltujian2()[n.id];e+=a.exp*n.level}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xinfaAddLevel",{get:function(){for(var e=this.xinfaAddTotalExp,t=0,n=Constant.get(Constant.XINFA_MAX_NUM).split("#"),a=0;a<n.length;a++){var i=n[a].split(","),o=parseInt(i[0]);if(o>e)break;t++}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xinfaAddRatio",{get:function(){var e=0,t=this.xinfaAddLevel;if(t>0){var n=Constant.get(Constant.XINFA_MAX_NUM).split("#"),a=n[t-1].split(",");e=parseInt(a[1])}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xinfaUpExp",{get:function(){var e=this.xinfaAddLevel,t=Constant.get(Constant.XINFA_MAX_NUM).split("#"),n=t[e].split(",");return n[0]?parseInt(n[0]):0},enumerable:!0,configurable:!0}),e.prototype.onCheckOneXinfaRedPoint=function(e){var t=(this.getXinfaDataByID(e),JsonModelManager.instance.getModeltujian2()[e]),n=DataManager.getInstance().playerManager.getoneXinfaUpCostByID(e),a=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id);return a>=n?!0:!1},e.prototype.onCheckXinfaRedPoint=function(){for(var e in this.player.getXinfaDataDict())if(this.onCheckOneXinfaRedPoint(parseInt(e)))return!0;return!1},e.prototype.parseTianshuLevelUpMsg=function(e){this.player.parseTianshuLevelUpMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.oncheckTianshuRP=function(){return this.oncheckRPTianshuLevel()?!0:this.oncheckRPTianshuGrade()?!0:!1},e.prototype.oncheckRPTianshuLevel=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_TIANSHU))return!1;var e=JsonModelManager.instance.getModeltianshushengji();for(var t in e){var n=JsonModelManager.instance.getModeltianshushengji()[t];if(this.oncheckRPTianshuLevelById(n.id))return!0}return!1},e.prototype.oncheckRPTianshuLevelById=function(e){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_TIANSHU))return!1;var t=JsonModelManager.instance.getModeltianshushengji()[e];if(t.tiaojian>0){var n=this.player.getPlayerData().tianshuDict[e-1];if(!n||n.level<t.tiaojian)return!1}var a=0,i=DataManager.getInstance().bagManager.getGoodsThingById(t.cost.id);return i&&(a=i.num),a>0},e.prototype.parseTianshuUpgradeMsg=function(e){this.player.parseTianshuGradeMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.oncheckRPTianshuGrade=function(){var e=JsonModelManager.instance.getModeltianshushengji();for(var t in e){var n=JsonModelManager.instance.getModeltianshushengji()[t];if(this.oncheckRPTianshuGradeById(n.id))return!0}return!1},e.prototype.oncheckRPTianshuGradeById=function(e){var t=JsonModelManager.instance.getModeltianshushengji()[e];if(t.tiaojian>0){var n=this.player.getPlayerData().tianshuDict[e-1];if(!n||n.level<t.tiaojian)return!1}var a=JsonModelManager.instance.getModeltianshutupo()[e],i=0,o=DataManager.getInstance().bagManager.getGoodsThingById(a.cost.id);return o&&(i=o.num),i>0},e}();__reflect(PlayerManager.prototype,"PlayerManager");var RetinueBodyData=function(e){function t(t){var n=e.call(this,t.playerId,BODY_TYPE.RETINUE)||this;return n.playerData=t,n}return __extends(t,e),t.prototype.updateData=function(e,t){this.bodyType=t,this.skills=[];for(var n=0;n<SkillDefine.Retinue_Skills.length;n++){var a=SkillDefine.Retinue_Skills[n],i=new SkillInfo(a,n);i.level=1,this.skills.push(i)}},Object.defineProperty(t.prototype,"playerData",{get:function(){return this._playerdata},set:function(e){this._playerdata=e,this.onRefreshProp(),this.onRebirth()},enumerable:!0,configurable:!0}),t.prototype.onRefreshProp=function(){this._playerdata&&(this.attributes[ATTR_TYPE.HP]=100,this.attributes[ATTR_TYPE.ATTACK]=this._playerdata.attributes[ATTR_TYPE.ATTACK],this.attributes[ATTR_TYPE.HIT]=this._playerdata.attributes[ATTR_TYPE.HIT],this.attributes[ATTR_TYPE.CRIT]=this._playerdata.attributes[ATTR_TYPE.CRIT],this.attributes[ATTR_TYPE.BREAK]=this._playerdata.attributes[ATTR_TYPE.BREAK])},Object.defineProperty(t.prototype,"isDie",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cloth_res",{get:function(){var e="";if(this._playerdata){var t=this._playerdata.getAppearID(BLESS_TYPE.RETINUE_CLOTHES);t=0>t?0:t,e="sc_cloth"+t}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weapon_res",{get:function(){var e="";if(this._playerdata){var t=this._playerdata.getAppearID(BLESS_TYPE.RETINUE_WEAPON);t=0>t?0:t,e="sc_weapon"+t}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mount_Res",{get:function(){var e="";if(this._playerdata){var t=this._playerdata.getAppearID(BLESS_TYPE.RETINUE_HORSE);t=0>t?0:t,e="sc_mount"+t}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wing_res",{get:function(){var e="";if(this._playerdata){var t=this._playerdata.getAppearID(BLESS_TYPE.RETINUE_WING);t>=0&&(e="sc_wing"+t)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"magic_res",{get:function(){var e="";if(this._playerdata){var t=this._playerdata.getAppearID(BLESS_TYPE.MAGIC);t>=0&&(e="sc_magic"+t)}return e},enumerable:!0,configurable:!0}),t}(BodyData);__reflect(RetinueBodyData.prototype,"RetinueBodyData");var RobotData=function(e){function t(t,n){void 0===n&&(n=BODY_TYPE.ROBOT);var a=e.call(this,t,n)||this;return a.level=DataManager.getInstance().playerManager.player.level,a}return __extends(t,e),t.prototype.onRefreshProp=function(){},t.prototype.onupdateLevel=function(e){},t.prototype.onUpdateOnlyAppear=function(e){this.attributes=[1,1,1,1,1,1,1,1,1,1],this.titleId=e.titleId,this.sex=e.sex,this.setAppear(e)},t.prototype.onUpdateRobotInfo=function(e){this.attributes=e,this.sex=Math.round(1*Math.random());var t=DataManager.getInstance().playerManager.player,n=t.getPlayerData(),a=this.figthPower/t.playerTotalPower,i=0,o=0;.6>a?(i=-2,o=-1):.85>a?(i=-1,o=-1):.95>a?(i=0,o=-1):1.05>=a?(i=0,o=0):(i=1,o=1);for(var r=0;r<BLESS_TYPE.SIZE;r++){var s=Math.round(Math.random()*o)+i,h=0,l=n.fashionSkils[r];if(l){var g=DataManager.getInstance().playerManager.getFashionIDsByType(r),c=g.indexOf(l);h=c+s,h>0&&(h=g[Math.min(g.length-1,h)])}if(h>0){var p=JsonModelManager.instance.getModelfashion()[h];this._appears[r]=p?p.waixing1:GameDefine.PLAYER_DEFUALT_AVATAR[r]}else this._appears[r]=GameDefine.PLAYER_DEFUALT_AVATAR[r]}},t}(PlayerData);__reflect(RobotData.prototype,"RobotData");var FuncBody=function(e){function t(t){var n=e.call(this)||this;n.id=t;var a=JsonModelManager.instance.getModelfunctionLv()[t];return n.icon=new eui.Image,n.icon.source=a.icon,n.addChild(n.icon),n}return __extends(t,e),t.prototype.onDestroy=function(){this.removeChildren(),this.parent&&this.parent.removeChild(this),this.icon=null},t}(egret.DisplayObjectContainer);__reflect(FuncBody.prototype,"FuncBody");var PsychBase=function(){function e(e){void 0===e&&(e=null),this.UID=0,this.modelID=0,this.currLv=0,this.lock=0,this.seletced=!1,e&&(this.modelID=e.id)}return e.prototype.parseInit=function(e){this.slot=e.getByte(),this.modelID=e.getShort()},e.prototype.parsePsych=function(e){this.UID=e.getInt(),this.modelID=e.getShort()},e.prototype.parsePsychUpgrade=function(e){this.parsePsych(e),this.currLvUp=e.getShort()},e.prototype.parseByModel=function(e){this.modelID=e.id},e.prototype.onUpdate=function(e){this.UID=e.UID,this.modelID=e.modelID,this.slot=e.slot},Object.defineProperty(e.prototype,"model",{get:function(){var e=JsonModelManager.instance.getModelyuanshen()[this.modelID];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightValue",{get:function(){return GameCommon.calculationFighting(this.model.attrAry)},enumerable:!0,configurable:!0}),e}();__reflect(PsychBase.prototype,"PsychBase");var PsychManager=function(){function e(){this.psychQueue={},this.currGain=[]}return e.prototype.parsePsych=function(e){for(var t=e.getShort(),n=0;t>n;n++)this.parseOnePsych(e)},e.prototype.parsePsychGain=function(e){for(var t,n=e.getInt(),a=e.getByte(),i=e.getByte(),o=0;i>o;o++)1==a?(t=this.parseOnePsych(e),GameCommon.getInstance().onGetPsychAlert(t.model,n)):0==a&&this.delOnePsych(e)},e.prototype.parseOnePsych=function(e){var t=new PsychBase;return t.parsePsych(e),this.psychQueue[t.UID]?this.psychQueue[t.UID].onUpdate(t):this.psychQueue[t.UID]=t,this.psychQueue[t.UID]},e.prototype.delOnePsych=function(e){var t=new PsychBase;t.parsePsych(e),this.delOnePsychByUID(t.UID)},e.prototype.delOnePsychByUID=function(e){delete this.psychQueue[e]},e.prototype.onSendPsychUpgrade=function(e,t){var n=new Message(MESSAGE_ID.PLAYER_PSYCH_UPGRADE_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendPsychEquip=function(e,t,n){var a=new Message(MESSAGE_ID.PLAYER_PSYCH_EQUIP_MESSAGE);a.setByte(e),a.setByte(t),a.setInt(n),GameCommon.getInstance().sendMsgToServer(a)},e.prototype.onSendDecomposeMessage=function(e){var t=e.length,n=new Message(MESSAGE_ID.PLAYER_PSYCH_DECOMPOSE_MESSAGE);n.setShort(t);for(var a=0;t>a;a++)n.setInt(e[a].UID);GameCommon.getInstance().sendMsgToServer(n)},e.prototype.getJobPsychPower=function(e){for(var t=0,n=0;n<GameDefine.Psych_Slot_Num;n++){var a=this.getPsychBySlot(e,n);a.modelID>0&&(t+=this.getOnePsychByID(a.modelID))}return t},e.prototype.getOnePsychByID=function(e){var t=0,n=JsonModelManager.instance.getModelyuanshen()[e];return n&&(t=GameCommon.calculationFighting(n.attrAry)),t},e.prototype.getPsychBySlot=function(e,t){return this.getPlayer().getPlayerData(e).getPsychBySlot(t)},e.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player
},e.prototype.getOneLvAllPsych=function(){var e,t=[],n=JsonModelManager.instance.getModelyuanshen();for(var a in n)e=n[a],1==e.lv&&t.push(e);return t},e.prototype.getNextModel=function(e){var t=JsonModelManager.instance.getModelyuanshen()[e];if(!t)return null;var n=t.lv+1,a=JsonModelManager.instance.getModelyuanshen();for(var i in a)if(a[i].lv==n&&a[i].type==t.type&&a[i].pinzhi==t.pinzhi)return a[i];return null},e.prototype.getIndexPsychPoint=function(e){return this.getCanChangePsych(e)?!0:this.getCanUpgradePsych(e)?!0:!1},e.prototype.getCanChangePsych=function(e){for(var t=0;t<GameDefine.Psych_Slot_Num;t++)if(this.getCanChangePsychBySlot(e,t))return!0;return!1},e.prototype.getCanChangeOrUpdateBySlot=function(e,t){return this.getCanChangePsychBySlot(e,t)?!0:this.getCanUpgradePsychBySlot(e,t)?!0:!1},e.prototype.getCanChangePsychBySlot=function(e,t){var n=this.getPlayer().getPlayerData(e);if(!n)return!1;if(!this.getPlayer().getPsychIsUnlockBySlot(t))return!1;for(var a,i,o=[],r=0;r<GameDefine.Psych_Slot_Num;r++)a=n.getPsychBySlot(r),a.modelID>0&&(r==t&&(i=a),-1==o.indexOf(a.model.type)&&o.push(a.model.type));var s=DataManager.getInstance().psychManager.psychQueue;for(var h in s)if(a=s[h],a.model){if(-1==o.indexOf(a.model.type)&&!i)return!0;if(-1==o.indexOf(a.model.type)&&i&&i.fightValue<a.fightValue)return!0;if(i&&i.model.type==a.model.type&&i.fightValue<a.fightValue)return!0}return!1},e.prototype.getCanUpgradePsych=function(e){for(var t=0;t<GameDefine.Psych_Slot_Num;t++)if(this.getCanUpgradePsychBySlot(e,t))return!0;return!1},e.prototype.getCanUpgradePsychBySlot=function(e,t){var n=this.getPlayer().getPlayerData(e);if(!n)return!1;if(!this.getPlayer().getPsychIsUnlockBySlot(t))return!1;var a=n.getPsychBySlot(t);if(a.modelID<=0)return!1;var i=this.getNextModel(a.modelID);if(!i)return!1;var o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.cost.id,i.cost.type);return o>=i.cost.num?!0:!1},e}();__reflect(PsychManager.prototype,"PsychManager");var PulseManager=function(){function e(){}return e.prototype.getPulsePower=function(e){var t,n=GameCommon.getInstance().getAttributeAry();t=JsonModelManager.instance.getModeljingmai()[e];for(var a=0;a<n.length;a++)n[a]=null!=t?t.attrAry[a]:0;return n},e.prototype.pulsePower=function(e){void 0===e&&(e=0);var t=DataManager.getInstance().playerManager.player.getPlayerData(e).pulseLv,n=JsonModelManager.instance.getModeljingmai()[t];return n?GameCommon.calculationFighting(n.attrAry):0},e.prototype.getJobCanPulseUpgrade=function(e){void 0===e&&(e=0);var t=DataManager.getInstance().playerManager.player.getPlayerData(e);if(!t)return!1;var n=t.pulseLv,a=JsonModelManager.instance.getModeljingmai()[n+1];if(a){var i=DataManager.getInstance().bagManager.getGoodsThingNumById(a.cost.id,a.cost.type);if(a.cost.num<=i)return!0}return!1},e.prototype.getCanPulseUpgrade=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_PULSE))return!1;for(var e=0;e<GameDefine.Max_Role_Num;e++)if(this.getJobCanPulseUpgrade(e))return!0;return!1},e}();__reflect(PulseManager.prototype,"PulseManager");var RebirthManager=function(){function e(){this.record={},this.onInitExchangeInfo()}return e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendExchangeVigourMessage=function(){var e=new Message(MESSAGE_ID.VIGOUR_EXCHANGE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseVigourExchange=function(e){this.record[0].surplusNum=e.getByte(),DataManager.getInstance().playerManager.player.remainExchageVigourTime=this.record[0].surplusNum;e.getInt()},e.prototype.onInitExchangeInfo=function(){for(var e,t=[GOODS_TYPE.SHOW,GOODS_TYPE.BOX,GOODS_TYPE.BOX],n=[1,1,2],a=t.length,i=0;a>i;i++)e=new VigourExchange(t[i],n[i]),this.record[i]=e},e}();__reflect(RebirthManager.prototype,"RebirthManager");var VigourExchange=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.type=e,this.modelID=t}return e.prototype.parseMessage=function(e){},e}();__reflect(VigourExchange.prototype,"VigourExchange");var RedPointManager=function(){function e(){}return e.createPoint=function(e){for(var t,n=[],a=0;e>a;a++)t=new redPoint,n.push(t);return n},e.prototype.onCheck=function(e){switch(e){case MESSAGE_ID.GAME_FIGHT_START_MSG:case MESSAGE_ID.GAME_FIGHT_RESULT_MSG:case MESSAGE_ID.GAME_TICK_MESSAGE:break;default:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_REDPOINT_TRIGGER),new redPointTrigger(null))}},e}();__reflect(RedPointManager.prototype,"RedPointManager");var redPoint=function(){function e(){this.id=(new egret.HashObject).hashCode,this.x=0,this.y=0}return e.prototype.register=function(e,t,n,a){void 0===a&&(a=null);for(var i=[],o=4;o<arguments.length;o++)i[o-4]=arguments[o];e&&this.addRedPointImg(e,t),this.target=n,a&&this.addTriggerFuc.apply(this,[n,a].concat(i))},e.prototype.addTriggerFuc=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];this.target=e,this.func=t,this.param=n,this.checkPoint()},e.prototype.addRedPointImg=function(e,t){e.getChildByName("redPoint")?(this.point!=e.getChildByName("redPoint")&&(this.point=e.getChildByName("redPoint")),this.point.x=t.x,this.point.y=t.y,this.point.visible=!1):(this.point=new eui.Image,this.point.x=t.x,this.point.y=t.y,this.point.source="public_redPoint_png",this.point.name="redPoint",this.point.touchEnabled=!1,this.point.visible=!1,e.addChild(this.point))},e.prototype.checkPointAll=function(){if(this.redPointChild){for(var e=!1,t=0;t<this.redPointChild.length;++t)this.redPointChild[t].checkPointAll()&&(e=!0);return this.point.visible=e,e}return this.checkPoint()},e.prototype.checkPoint=function(e){void 0===e&&(e=!1);for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!this.target||!this.func)return!1;var a=!1;if(e)this.target[this.func]&&(a=(o=this.target)[this.func].apply(o,t));else if(this.target[this.func]){var i=this.param.length;switch(i){case 0:a=this.target[this.func]();break;case 1:a=this.target[this.func](this.param[0]);break;case 2:a=this.target[this.func](this.param[0],this.param[1]);break;case 3:a=this.target[this.func](this.param[0],this.param[1],this.param[2]);break;case 4:a=this.target[this.func](this.param[0],this.param[1],this.param[2],this.param[3]);break;case 5:a=this.target[this.func](this.param[0],this.param[1],this.param[2],this.param[3],this.param[4]);break;case 6:a=this.target[this.func](this.param[0],this.param[1],this.param[2],this.param[3],this.param[4],this.param[5]);break;default:throw"传参个数超界"}}return this.point&&(this.point.visible=a),a;var o},e.prototype.delRedPoint=function(){this.target.contains(this.point)&&(this.target.removeChild(this.point),this.point=null),this.func=null},e}();__reflect(redPoint.prototype,"redPoint");var redPointTrigger=function(){function e(e,t){void 0===t&&(t=-1),this.systemID=e,this.redpoint_type=t}return e}();__reflect(redPointTrigger.prototype,"redPointTrigger");var Server=function(){function e(){}return e}();__reflect(Server.prototype,"Server");var SERVER_STATE;!function(e){e[e.NEW=0]="NEW",e[e.HOT=1]="HOT",e[e.MAINTAIN=2]="MAINTAIN"}(SERVER_STATE||(SERVER_STATE={}));var ServerManager=function(){function e(){}return e.prototype.parseServerList=function(e){var t=window.gamesdk;if(this.serverArray=new Array,e.getBoolean()){for(var n=e.getShort(),a=e.getShort(),i=e.getByte(),o=new Array,r=e.getShort(),s=0;r>s;++s)o.push(e.getShort());for(var s=1;n>=s;++s){var h;if(2==i)h=SERVER_STATE.MAINTAIN;else{for(var l=!0,g=0;g<o.length;++g)o[g]==s&&(h=SERVER_STATE.MAINTAIN,l=!1);l&&(h=s>a?SERVER_STATE.NEW:SERVER_STATE.HOT)}this.serverArray.push(this.createServer(s,t.serverName+s+"服",h))}}else for(var r=e.getShort(),s=0;r>s;++s)this.serverArray.push(this.parseServer(e));this.serverLoginedArray=new Array;for(var r=e.getByte(),s=0;r>s;++s){var c=this.getServerById(e.getShort());c&&this.serverLoginedArray.push(c)}},e.prototype.parseServer=function(e){var t=new Server;t.id=e.getShort(),t.name=e.getString();var n=e.getBoolean();return n?t.state=SERVER_STATE.NEW:t.state=SERVER_STATE.HOT,t},e.prototype.createServer=function(e,t,n){var a=new Server;return a.id=e,a.name=t,a.state=n,a},e.prototype.getServerById=function(e){for(var t in this.serverArray)if(e==this.serverArray[t].id)return this.serverArray[t];return null},e.prototype.onLoginSDKStatistics=function(){this.isCreateRole&&SDKManager.onCreateRole(DataManager.getInstance().playerManager.player),SDKManager.onEnterGame(DataManager.getInstance().playerManager.player)},e}();__reflect(ServerManager.prototype,"ServerManager");var ShenTongManager=function(){function e(){this.shentongMinQulity=-1,this.shentongSlotInfos=[],this.shentongBags=[];for(var e=0;e<GameDefine.Shentong_MaxSlot;e++)this.shentongSlotInfos.push(new ShenTongSlotInfo(e))}return e.prototype.onCheckShentongRed=function(){return!1},e.prototype.onParseInitBagMsg=function(e){},e.prototype.onParseAddBagMsg=function(e){},e.prototype.onParseRemoveBagMsg=function(e){},e.prototype.onParseInitSlotMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++)this.onUpdateSlot(n,e)},e.prototype.onParseUpdateSlotMsg=function(e){},e.prototype.onUpdateSlot=function(e,t){},e.prototype.parseLevelUpMsg=function(e){var t=e.getByte(),n=this.shentongSlotInfos[t];n.level=e.getShort(),n.exp=e.getShort(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_SHENTONG_SLOT_UPDATE),t),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUpgradeMsg=function(e){var t=e.getByte(),n=this.shentongSlotInfos[t];n.grade=e.getShort(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.PLAYER_SHENTONG_SLOT_UPDATE),t),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getShentongNumByModelId=function(e){return this._shentongBagNumByModelId[e]?this._shentongBagNumByModelId[e]:0},e.prototype.getCanShowRedPoint=function(){return!1},e}();__reflect(ShenTongManager.prototype,"ShenTongManager");var ShenTongSlotInfo=function(){function e(e){this.slotID=e}return e.prototype.parseInfo=function(e){this.modelID=e.getShort(),this.level=e.getShort(),this.exp=e.getShort(),this.grade=e.getShort()},e}();__reflect(ShenTongSlotInfo.prototype,"ShenTongSlotInfo");var ShenTongItem=function(){function e(){}return e.prototype.parseInfo=function(e){this.id=e.getShort(),this.shentongID=e.getShort()},e}();__reflect(ShenTongItem.prototype,"ShenTongItem");var ShopManager=function(){function e(){this.discountMap={},this.restrictionBuy={},this.goodsclassify()}return e.prototype.goodsclassify=function(){this.classify={};var e,t=JsonModelManager.instance.getModelshop();for(var n in t)e=t[n],this.classify[e.shopType]||(this.classify[e.shopType]=[]),this.classify[e.shopType].push(e)},e.prototype.onParseDiscountMsg=function(e){this.discountMap={};for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte(),i=e.getByte();this.discountMap[a]=i}for(var o=e.getShort(),n=0;o>n;n++){var r=e.getInt(),s=e.getInt();this.restrictionBuy[r]=s}},e.prototype.getGoodsByTye=function(e){return this.classify[e]},e}();__reflect(ShopManager.prototype,"ShopManager");var BuffInfo=function(){function e(e,t){this._startTime=0,this.model=JsonModelManager.instance.getModelbuff()[e],this.level=t,this.attributes=DataManager.getInstance().skillManager.getBuffAttr(this.model.id),this._startTime=1e3*this.model.time+egret.getTimer()}return Object.defineProperty(e.prototype,"isOver",{get:function(){return this._startTime<=egret.getTimer()},enumerable:!0,configurable:!0}),e}();__reflect(BuffInfo.prototype,"BuffInfo");var BUFF_TYPE;!function(e){e[e.ADD_ATTR=1]="ADD_ATTR"}(BUFF_TYPE||(BUFF_TYPE={}));var SkillEnchantData=function(){function e(){this.id=0,this.level=0,this.grade=0}return e.prototype.paraseMsg=function(e){this.id=e.getByte(),this.level=e.getInt(),this.grade=e.getInt()},e}();__reflect(SkillEnchantData.prototype,"SkillEnchantData");var SkillEnchantManager=function(){function e(){}return Object.defineProperty(e.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),e.prototype.parseLevelMsg=function(e){var t=(e.getByte(),e.getShort()),n=e.getInt();this.playerData.skillEnhantDict[t]||(this.playerData.skillEnhantDict[t]=new SkillEnchantData);var a=this.playerData.skillEnhantDict[t];a.level=n,DataManager.getInstance().playerManager.player.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseGradeMsg=function(e){var t=(e.getByte(),e.getShort()),n=e.getInt();if(this.playerData.skillEnhantDict[t]){var a=this.playerData.skillEnhantDict[t];a.grade=n,DataManager.getInstance().playerManager.player.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e)}},e.prototype.parseSkinMsg=function(e){var t=(e.getByte(),e.getByte()),n=e.getShort(),a=this.playerData.getSkillInfoById(t);a&&(this.playerData.skillEnhantDict[n]||0==n)&&(a.styleNum=n,GameCommon.getInstance().receiveMsgToClient(e))},e.prototype.onSendActiveMsg=function(e){var t=new Message(MESSAGE_ID.SKILLENCHANT_ACTIVE_MESSAGE);t.setByte(0),t.setShort(e),t.setByte(1),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendLevelUpMsg=function(e,t){void 0===t&&(t=1);var n=new Message(MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE);n.setByte(0),n.setShort(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendGradeMsg=function(e){var t=new Message(MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE);t.setByte(0),t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendClothSkinMsg=function(e,t){var n=new Message(MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE);n.setByte(0),n.setByte(t),n.setShort(e),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.checkSkillEnhantRedp=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_SKILL)?this.checkSkillEnhantUplevelRed()?!0:this.checkSkillEnhantUpGradeRed()?!0:!1:!1},e.prototype.checkSkillEnhantUplevelRed=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_SKILL))return!1;for(var e in JsonModelManager.instance.getModelxinfaLv()){var t=JsonModelManager.instance.getModelxinfaLv()[e];if(this.checkSkillEnhantUplevelByIDRed(t.id))return!0}return!1},e.prototype.checkSkillEnhantUplevelByIDRed=function(e){var t=JsonModelManager.instance.getModelxinfaLv()[e],n=this.playerData.skillEnhantDict[e],a=n?n.level:0;if(0==a){if(!t.jihuocost)return!0;var i=GameCommon.parseAwardItem(t.jihuocost),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.id);if(o>=i.num)return!0}else{var r=4e3+100*a,o=DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.FAHUN);if(o>=r)return!0}return!1},e.prototype.checkSkillEnhantUpGradeRed=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_SKILL))return!1;for(var e in JsonModelManager.instance.getModelxinfaLv()){var t=JsonModelManager.instance.getModelxinfaLv()[e];if(this.checkSkillEnhantUpGradeByRed(t.id))return!0}return!1},e.prototype.checkSkillEnhantUpGradeByRed=function(e){var t=this.playerData.skillEnhantDict[e];if(!t)return!1;var n=JsonModelManager.instance.getModelxinfajinjie()[e],a=DataManager.getInstance().bagManager.getGoodsThingNumById(n.cost.id);return a>=n.cost.num?!0:!1},e}();__reflect(SkillEnchantManager.prototype,"SkillEnchantManager");var SkillInfo=function(){function e(e,t,n){void 0===n&&(n=0),this.attackCount=1,this.styleNum=0,this.stampTime=0,this.type=0,this._lvAddDamage=null,this._lvEwaiDamage=null,this._level=0,this._grade=1,this._eftclass=null,this.id=e,this._index=t,this.model=JsonModelManager.instance.getModelskill()[this.id],this.model||Tool.throwException("缺少技能数据！"),this.type=n,this.addDamage=this.model.ewai}return Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level!=e&&(this._level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"grade",{get:function(){return this._grade},set:function(e){this._grade!=e&&(this._grade=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e.prototype.getName=function(e){void 0===e&&(e=0);var t=e>0?e:this._grade;return Language.instance.getText("skillname_"+this.id+"_"+t)},e.prototype.getIcon=function(e){void 0===e&&(e=0);e>0?e:this._grade;return"skillicon_"+this.id+"_1_png"},e.prototype.getSkillNameIcon=function(e){return void 0===e&&(e=0),"zi_skill_"+this.id+"_png"},Object.defineProperty(e.prototype,"isSkillCD",{get:function(){return this.stampTime>=egret.getTimer()},enumerable:!0,configurable:!0}),e.prototype.usestart=function(){this.stampTime=egret.getTimer()+this.model.cd},e.prototype.reset=function(){this.stampTime=0},e.prototype.setSkillCD=function(e){this.stampTime=egret.getTimer()+e},e.prototype.isDist=function(e){return e<=this.model.dist},e.prototype.getBaseDamage=function(){return(this.model.valueBase+(this._lvEwaiDamage?this._lvEwaiDamage:0))/1e4},e.prototype.getExtraDamage=function(){return this._lvAddDamage?this._lvAddDamage:0},Object.defineProperty(e.prototype,"addDamage",{set:function(e){this._lvAddDamage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratioDamage",{set:function(e){this._lvEwaiDamage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectClass",{get:function(){if(null==this._eftclass){this._eftclass="";var e=this.model.effect2.match(/\[#.*?]/g);e&&e.length>0&&(this._eftclass=e[0].slice(2,e[0].length-1))}return this._eftclass},enumerable:!0,configurable:!0}),e}();__reflect(SkillInfo.prototype,"SkillInfo");var SKILL_HURT_TYPE;!function(e){e[e.PHY_HURT=0]="PHY_HURT",e[e.MAGIC_HURT=1]="MAGIC_HURT"}(SKILL_HURT_TYPE||(SKILL_HURT_TYPE={}));var SkillManager=function(){function e(){}return e.prototype.getCanUpgrade=function(e){var t=DataManager.getInstance().skillManager.getUpgradeConsumeInfo(e);return 0==t[0]?!1:t[0]<=t[1]?!0:!1},e.prototype.getDesc=function(e){var t=e.model.disc;return t=t.replace("$","<font color=0x00FF00>"+e.getExtraDamage()+"</font>")},e.prototype.getUpgradeConsumeInfo=function(e){var t,n=0;t=6;var a=DataManager.getInstance().skillManager.getOwnGoodsNum(t);return[n,a]},e.prototype.getCanUpgradeAll=function(){for(var e=!1,t=0;t<GameDefine.InitiativeSkill.length;t++)if(e=DataManager.getInstance().skillManager.getCanUpgrade(GameDefine.InitiativeSkill[t]))return!0;for(var t=0;t<GameDefine.PassivitySkill.length;t++)if(e=DataManager.getInstance().skillManager.getCanUpgrade(GameDefine.PassivitySkill[t]))return!0;return!1},e.prototype.getCanUpgradeInitiative=function(){for(var e=!1,t=0;t<GameDefine.InitiativeSkill.length;t++)if(e=DataManager.getInstance().skillManager.getCanUpgrade(GameDefine.InitiativeSkill[t]))return!0;return!1},e.prototype.getCanUpgradePassivity=function(){for(var e=!1,t=0;t<GameDefine.PassivitySkill.length;t++)if(e=DataManager.getInstance().skillManager.getCanUpgrade(GameDefine.PassivitySkill[t]))return!0;return!1},e.prototype.getOwnGoodsNum=function(e){var t=DataManager.getInstance().bagManager.getGoodsThingById(e),n=t?t.num:0;return n},e.prototype.getSkillModelCost=function(e,t){if(10001>e){var n=JsonModelManager.instance.getModelskilldmg()[t];return n?n.cost.num:-1}return 0},e.prototype.calculateOneKeyUpgrade=function(e){var t,n,a,i={},o=0;0==e?(a=6,t=GameDefine.InitiativeSkill):1==e&&(a=2,t=GameDefine.PassivitySkill);var r=DataManager.getInstance().skillManager.getOwnGoodsNum(a);if(0==r)return[r,i];var s=0,h=!1;do{if(s==t.length){if(s=0,!h)break;h=!1}var l=DataManager.getInstance().playerManager.player.getPlayerData().getSkillInfoById(t[s]),g=l.level;i[t[s]]&&(g+=i[t[s]]),n=this.getSkillModelCost(t[s],g),n>0&&r>=o+n&&(o+=n,i[t[s]]?i[t[s]]+=1:i[t[s]]=1,h=!0),s++}while(r>=o);return[o,i]},e.prototype.checkSkillUpGrade=function(e){var t,n=DataManager.getInstance().playerManager.player,a=n.getPlayerData(),i=a.getSkillInfoById(e),o=JsonModelManager.instance.getModelskilltupo()[e];for(var r in o)if(o[r].tupoLv==i.grade+1){t=o[r];break}return!t||t.jingjie>n.coatardLv?!1:t.cost.num>this.getOwnGoodsNum(t.cost.id)?!1:!0},e.prototype.checkSkillUp=function(e){var t=DataManager.getInstance().playerManager.player,n=t.getPlayerData(),a=n.getSkillInfoById(e);if(a.model.lv>=t.level)return!1;if(a.level>=t.level)return!1;var i=this.getSkillModelCost(e,a.level),o=t.getICurrency(GOODS_TYPE.YUELI);return i>0&&o>=i?!0:!1},e.prototype.checkMainSkillUp=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_SKILL))return!1;for(var e=DataManager.getInstance().playerManager.player.playerDatas,t=0;t<e.length;++t)for(var n=e[t],a=0;a<n.skills.length;++a){var i=n.skills[a];if(this.checkSkillUp(i.id))return!0;if(this.checkSkillUpGrade(i.id))return!0}return!1},e.prototype.getSkillUpLevelMax=function(e){var t=ModelManager.getInstance().getModelLength("skilldmg"),n=DataManager.getInstance().playerManager.player;return n.level<e.model.lv?0:Math.min(n.level,t)},e.prototype.getBuffAttr=function(e){var t=JsonModelManager.instance.getModelbuff()[e];if(!t)return[];for(var n=GameCommon.getInstance().getAttributeAry(),a=t.buffAdd.split("#"),i=0;i<a.length;i++){var o=a[i].split(","),r=parseInt(o[0]),s=parseInt(o[1]);n[r]=s}for(var h=t.buffMul.split("#"),i=0;i<h.length;i++){var l=h[i].split(","),r=ATTR_TYPE.SIZE+parseInt(l[0]),g=parseInt(l[1]);n[r]=g}return n},e}();__reflect(SkillManager.prototype,"SkillManager");var StrongerMonterManager=function(){function e(){this._strongerInfoDict={},this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_FEI_JIAN]="getCurType0Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_SHEN_BING]="getCurType1Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_SHEN_ZHUANG]="getCurType2Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_BAO_QI]="getCurType3Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_XIAN_YU]="getCurType4Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA]="getCurType5Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING]="getCurType6Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI]="getCurType7Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN]="getCurType8Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA]="getCurType9Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG]="getCurType12Value",this._strongerInfoDict[STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL]="getCurType13Value"}return e.prototype.getStrongerValue=function(e){return this[this._strongerInfoDict[e]]()},e.prototype.getStrongerPlusAtt=function(e){var t=GameCommon.getInstance().getAttributeAry(),n=this.getJiHuoModelByType(Number(e));if(!n)return t;if(0==n.plusType)for(var a=0;a<ATTR_TYPE.SIZE;a++){var i=GameDefine.getAttrPlusKey(a+ATTR_TYPE.SIZE);n&&n[i]&&(t[a]=t[a]+n[i])}return t},e.prototype.getStrongerAtt=function(e){var t=GameCommon.getInstance().getAttributeAry(),n=(GameCommon.getInstance().getAttributeAry(),this.getJiHuoModelByType(Number(e)));if(!n)return t;for(var a=0;a<ATTR_TYPE.SIZE;++a)n.attrAry[a]>0&&(t[a]+=n.attrAry[a]);return t},Object.defineProperty(e.prototype,"allPlusAtt",{get:function(){var e=GameCommon.getInstance().getAttributeAry();for(var t in this._strongerInfoDict){var n=this.getCurModelByType(parseInt(t));if(n)for(var a=0;a<n.attrAry.length;a++){var i=GameDefine.getAttrPlusKey(a+ATTR_TYPE.SIZE);n&&n[i]&&1==n.plusType&&(e[a]=e[a]+n[i])}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeAry",{get:function(){var e=GameCommon.getInstance().getAttributeAry();for(var t in this._strongerInfoDict){var n=this.getCurModelByType(parseInt(t));if(n)for(var a=0;a<n.attrAry.length;a++)n.attrAry[a]>0&&(e[a]+=n.attrAry[a])}return e},enumerable:!0,configurable:!0}),e.prototype.getCurType13Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n];for(var i in a.tianshuDict){var o=a.tianshuDict[i];o&&(e+=o.level)}}return e},e.prototype.getCurType0Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n],i=a.blessinfos[BLESS_TYPE.HORSE];i&&(e+=i.grade)}return e},e.prototype.getCurType1Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n],i=a.blessinfos[BLESS_TYPE.WEAPON];i&&(e+=i.grade)}return e},e.prototype.getCurType2Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n],i=a.blessinfos[BLESS_TYPE.CLOTHES];i&&(e+=i.grade)}return e},e.prototype.getCurType3Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n],i=a.blessinfos[BLESS_TYPE.MAGIC];i&&(e+=i.grade)}return e},e.prototype.getCurType4Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n],i=a.blessinfos[BLESS_TYPE.WING];i&&(e+=i.grade)}return e},e.prototype.getCurType5Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<GameDefine.Equip_Slot_Num;i++){var o=a.getEquipSlotThings(i);o&&(e+=o.intensifyLv)}return e},e.prototype.getCurType6Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<GameDefine.Equip_Slot_Num;i++){var o=a.getEquipSlotThings(i);o&&(e+=o.infuseLv)}return e},e.prototype.getCurType7Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<GameDefine.Equip_Slot_Num;i++){var o=a.getEquipSlotThings(i);o&&(e+=o.gemLv)}return e},e.prototype.getCurType8Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<GameDefine.Equip_Slot_Num;i++){var o=a.getEquipSlotThings(i);o&&(e+=o.quenchingLv)}return e},e.prototype.getCurType9Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<GameDefine.Equip_Slot_Num;i++){var o=a.getEquipSlotThings(i);o&&(e+=o.zhLv)}return e},e.prototype.getCurType10Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n];e+=a.pulseLv}return e},e.prototype.getCurType11Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=t[n];e+=Math.floor(a.wuxingLevel/5)}return e},e.prototype.getCurType12Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++)for(var a=t[n],i=0;i<Fourinages_Type.SIZE;i++){var o=a.fourinages[i];o&&(e+=o.level)}return e},e.prototype.getCurType14Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=(t[n],DataManager.getInstance().playerManager.player.petData);e+=a.lv}return e},e.prototype.getCurType15Value=function(){for(var e=0,t=DataManager.getInstance().playerManager.player.playerDatas,n=0;n<t.length;n++){var a=(t[n],DataManager.getInstance().playerManager.player.petData);e+=10*a.grade+a.gradeStar}return e},e.prototype.getCurNumByType=function(e){var t=this[this._strongerInfoDict[e]]();return t},e.prototype.getNextMuBiao=function(e){if(DataManager.getInstance().playerManager.player.strongerDict[e]&&this.getJiHuoModelByType(e)&&DataManager.getInstance().playerManager.player.strongerDict[e].lv==this.getJiHuoModelByType(e).mubiao){if(!this.getCurModelByType(e))return this.getCurNumByType(e);if(this.getCurModelByType(e).mubiao==this.getCurNumByType(e)&&this.getCurNumByType(e)>this.getJiHuoModelByType(e).mubiao)return this.getCurNumByType(e)}var t=this.getNextModelByType(e);return t?t.mubiao:this.getCurModelByType(e).mubiao},e.prototype.getPoint=function(e){var t=this.getCurModelByType(e),n=(this.getNextModelByType(e),this.getStrongerValue(e));if(t&&n>=t.mubiao){if(!DataManager.getInstance().playerManager.player.strongerDict[e])return!0;if(DataManager.getInstance().playerManager.player.strongerDict[e].lv<t.mubiao)return!0}return!1},e.prototype.getJiHuoModelByType=function(e){var t=0;DataManager.getInstance().playerManager.player.strongerDict[e]&&(t=DataManager.getInstance().playerManager.player.strongerDict[e].lv);var n,a=JsonModelManager.instance.getModelqianghuadashi()[e];for(var i in a){var o=a[i];if(o.mubiao>t)return n;n=o}return n},e.prototype.getCurModelByType=function(e){void 0===e&&(e=STRONGER_MONSTER_TYPE.STRONGER_FEI_JIAN);var t,n=this[this._strongerInfoDict[e]](),a=JsonModelManager.instance.getModelqianghuadashi()[e];for(var i in a){var o=a[i];if(o.mubiao>n)return t;t=o}return t},e.prototype.getNoActPro=function(e,t){var n,a=(this[this._strongerInfoDict[e]](),JsonModelManager.instance.getModelqianghuadashi()[e]);for(var i in a){var o=a[i];if(o.mubiao>=t)return n?n.attrAry:o.attrAry;n=o}return n.attrAry},e.prototype.getNextModelByType=function(e){var t=this[this._strongerInfoDict[e]](),n=JsonModelManager.instance.getModelqianghuadashi()[e];for(var a in n){var i=n[a];if(i.mubiao>t)return i}return null},e}();__reflect(StrongerMonterManager.prototype,"StrongerMonterManager");var StrongerData=function(){function e(){this.lv=0}return e.prototype.onParseLvMsg=function(e){this.lv=e.getShort()},e}();__reflect(StrongerData.prototype,"StrongerData");var STRONGER_MONSTER_TYPE;!function(e){e[e.STRONGER_FEI_JIAN=0]="STRONGER_FEI_JIAN",e[e.STRONGER_SHEN_BING=1]="STRONGER_SHEN_BING",e[e.STRONGER_SHEN_ZHUANG=2]="STRONGER_SHEN_ZHUANG",e[e.STRONGER_BAO_QI=3]="STRONGER_BAO_QI",e[e.STRONGER_XIAN_YU=4]="STRONGER_XIAN_YU",e[e.STRONGER_QIANG_HUA=5]="STRONGER_QIANG_HUA",e[e.STRONGER_ZHU_LING=6]="STRONGER_ZHU_LING",e[e.STRONGER_BAO_SHI=7]="STRONGER_BAO_SHI",e[e.STRONGER_CUI_LIAN=8]="STRONGER_CUI_LIAN",e[e.STRONGER_LIAN_HUA=9]="STRONGER_LIAN_HUA",e[e.STRONGER_SI_XIANG=12]="STRONGER_SI_XIANG",e[e.STRONGER_TIANSHU_LEVEL=13]="STRONGER_TIANSHU_LEVEL",e[e.STRONGER_EQUIPSUIT_1=16]="STRONGER_EQUIPSUIT_1",e[e.STRONGER_EQUIPSUIT_2=17]="STRONGER_EQUIPSUIT_2",e[e.STRONGER_EQUIPSUIT_3=18]="STRONGER_EQUIPSUIT_3",e[e.STRONGER_EQUIPSUIT_4=19]="STRONGER_EQUIPSUIT_4",e[e.STRONGER_EQUIPSUIT_5=20]="STRONGER_EQUIPSUIT_5",e[e.STRONGER_CHALLENGE_PASS=100]="STRONGER_CHALLENGE_PASS",e[e.STRONGER_TUJIAN_SUIT=101]="STRONGER_TUJIAN_SUIT"}(STRONGER_MONSTER_TYPE||(STRONGER_MONSTER_TYPE={}));var TaskManager=function(){function e(){this._currTaskCount=0,this._chengjius=JsonModelManager.instance.getModelchengjiu(),this._chengjiuLvs=JsonModelManager.instance.getModelchengjiuLv(),this.coatardTasks={},this.taskmodelsDict={},this.lvTasks=[],this.powerTasks=[]}return e.prototype.getCurTask=function(e,t){var n=JsonModelManager.instance.getModelchengjiuMubiao()[e],a=0;for(var i in n){if(a==t)return n[i];a+=1}},e.prototype.parseInitCoatardTaskMsg=function(e){this.coatardTasks={};for(var t=e.getByte(),n=0;t>n;n++){var a=new TaskChainData;a.parseMsg(e),this.coatardTasks[a.taskId]=a;var i=DataManager.getInstance().taskManager.getCurTask(a.model.id,a.count);i?a.maxnum=i.mubiao:a.maxnum=0}GameDispatcher.getInstance().dispatchEvent(new egret.Event(MESSAGE_ID.REBIRTH_TASK_INIT_MSG.toString()))},Object.defineProperty(e.prototype,"currTaskCount",{get:function(){return this._currTaskCount},enumerable:!0,configurable:!0}),e.prototype.parseUpdateCoatardTaskMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=void 0,i=new TaskChainData;if(i.parseMsg(e),this.coatardTasks[i.model.id]){a=this.coatardTasks[i.model.id],a.progress=i.progress,a.count=i.count;var o=DataManager.getInstance().taskManager.getCurTask(a.model.id,a.count);o?a.maxnum=o.mubiao:a.maxnum=0}}DataManager.getInstance().playerManager.player.chengjiuExp=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseTaskDailyInitMsg=function(e){var t=JsonModelManager.instance.getModeltaskDaily(),n=e.getByte();for(var a in t){if(0==n)break;var i=t[a];i.dailytaskPro=e.getShort(),n--}},e.prototype.parseTaskDailyUpdateMsg=function(e){var t=e.getByte(),n=JsonModelManager.instance.getModeltaskDaily()[t];
n&&(n.dailytaskPro=e.getShort()),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getChengJiuPoint=function(){for(var e in this._chengjius){var t=DataManager.getInstance().taskManager.coatardTasks[this._chengjius[e].id],n=DataManager.getInstance().taskManager.getCurTask(t.model.id,t.count);if(n&&t.progress>=n.mubiao)return!0}return this.getChengJiuLvPoint()?!0:!1},e.prototype.getChengJiuLvPoint=function(){for(var e in this._chengjiuLvs)if(this._chengjiuLvs[e].exp<=DataManager.getInstance().playerManager.player.chengjiuExp&&!DataManager.getInstance().playerManager.player.chengjiuLvDict[this._chengjiuLvs[e].lv])return!0;return!1},e.prototype.getchengjiuLevel=function(e){var t,n=JsonModelManager.instance.getModelchengjiuLv();if(t=n[0],e<t.exp)return 0;for(var a in n)e>=n[a].exp&&(t=n[a]);return t.lv},e.prototype.parseTaskChainMsg=function(e){this.guideTaskData||(this.guideTaskData=new GuideTaskData),this.guideTaskData.onParseMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.sendTaskChainCompleteMsg=function(){if(this.guideTaskData&&this.guideTaskData.model){var e=new Message(MESSAGE_ID.TASK_CHAIN_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},e}();__reflect(TaskManager.prototype,"TaskManager");var TaskChainData=function(){function e(){this.isAct=0}return e.prototype.parseMsg=function(e){this.taskId=e.getShort(),this.progress=e.getLong(),this.count=e.getByte(),this._model=JsonModelManager.instance.getModelchengjiu()[this.taskId]},Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e}();__reflect(TaskChainData.prototype,"TaskChainData");var TaskEvnetData=function(){function e(){}return e}();__reflect(TaskEvnetData.prototype,"TaskEvnetData");var GuideTaskData=function(){function e(){this._progress=0}return e.prototype.onParseMsg=function(e){var t=e.getShort();this._progress=e.getLong(),this.status=e.getByte(),2!=this.status?this._model=JsonModelManager.instance.getModelxinshourenwu()[t]:this._model=null},Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFinish",{get:function(){return this._model?this._progress>=this._model.param:!1},enumerable:!0,configurable:!0}),e}();__reflect(GuideTaskData.prototype,"GuideTaskData");var TianGongManager=function(){function e(){}return e.prototype.getMainBtnRedShow=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_JINGJIE)?this.getTabCoatardTaskPoint()?!0:this.getTabJianChiRedShow()?!0:DataManager.getInstance().dragonSoulManager.checkRedPoint()?!0:DataManager.getInstance().legendManager.oncheckAllVipActifactRedP()?!0:DataManager.getInstance().playerManager.onCheckXinfaRedPoint()?!0:!1:!1},e.prototype.getTabCoatardTaskPoint=function(){var e=0,t=DataManager.getInstance().taskManager.coatardTasks;for(var n in t){var a=t[n];if(a.progress>=a.maxnum&&0!=a.maxnum)return!0;e+=a.count}DataManager.getInstance().playerManager.player.coatardLv;return!1},e.prototype.getTabJianChiRedShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_JIANCHI))return!1;var e=JsonModelManager.instance.getModeljianchi(),t=DataManager.getInstance().playerManager.player,n=t.jianchiExp,a=t.jianchiLevel,i=0;for(var o in e){var r=e[o];if(i>=a&&n>=r.exp)return!0;++i}return!1},e.prototype.getTabLegendRedShow=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_SHENQI))return!1;for(var e=DataManager.getInstance().legendManager,t=1;t<=LegendDefine.Legend_Num;t++)if(e.getCanLegendAdvance(t))return!0;return!1},e}();__reflect(TianGongManager.prototype,"TianGongManager");var TianshuData=function(){function e(){this.level=0,this.lvExp=0,this.grade=0}return e}();__reflect(TianshuData.prototype,"TianshuData");var TitleData=function(){function e(){this.lv=1}return e}();__reflect(TitleData.prototype,"TitleData");var TitleManager=function(){function e(){this.titleMap={},this.isInit=!1,this.curTitleId=0,this.titleViewArray=new Array;for(var e in JsonModelManager.instance.getModelchenghao()){var t=JsonModelManager.instance.getModelchenghao()[e];this.titleViewArray.push(t)}}return e.prototype.getTitleArray=function(e){return this.sortTitle(),0==e?this.titleViewLimitArray.concat(this.titleView4EverArray):this.titleView4EverArray},e.prototype.parseList=function(e){for(var t=e.getByte(),n=0;t>n;++n){var a=new TitleData;a.id=e.getShort(),a.time=e.getInt(),a.stamp=egret.getTimer(),a.lv=e.getShort(),this.titleMap[a.id]=a}this.isInit&&DataManager.getInstance().playerManager.player.updataAttribute(),this.isInit=!0},e.prototype.parseWear=function(e){var t=e.getByte(),n=e.getShort();this.takeOffTitle(n),DataManager.getInstance().playerManager.player.playerDatas[t].titleId=n},e.prototype.parseWear1=function(e){var t=new TitleData;t.id=e.getShort(),t.time=e.getInt(),t.stamp=egret.getTimer(),t.lv=e.getShort(),this.titleMap[t.id]=t},e.prototype.getTitlePoint=function(e){if(void 0===e&&(e=4),!FunDefine.isFunOpen(FUN_TYPE.FUN_TITLE))return!1;for(var t in this.getModelLv()){var n=this.getModelLv()[t];if((4==e||n.type==e)&&n.cost.id){var a=DataManager.getInstance().bagManager.getGoodsThingById(n.cost.id,n.cost.type),i=a?a.num:0;if(i>0)return!0}}return!1},e.prototype.getModelLv=function(){if(!this.allLvTitleCfgs){this.allLvTitleCfgs=[];for(var e in JsonModelManager.instance.getModelchenghao())-1==JsonModelManager.instance.getModelchenghao()[e].time&&this.allLvTitleCfgs.push(JsonModelManager.instance.getModelchenghao()[e])}return this.allLvTitleCfgs},e.prototype.isTitleActive=function(e){return this.titleMap[e]?!0:!1},e.prototype.sortTitle=function(){this.titleView4EverArray=new Array,this.titleViewLimitArray=new Array;for(var e=0;e<this.titleViewArray.length;e++)this.isTitleActive(this.titleViewArray[e].id)?this.titleViewLimitArray.push(this.titleViewArray[e]):this.titleView4EverArray.push(this.titleViewArray[e])},e.prototype.getTitleData=function(e){return this.titleMap[e]},e.prototype.getTitleCountDown=function(e){var t=this.getTitleData(e);if(t&&t.time>=0){var n=t.time-(egret.getTimer()-t.stamp)/1e3,a=JsonModelManager.instance.getModelchenghao()[e];if(n>0||-1==a.time)return n;this.removeTitleData(e)}return 0},e.prototype.onCheckTitleTimeOut=function(){for(var e in this.titleMap)this.getTitleCountDown(parseInt(e))},e.prototype.removeTitleData=function(e){this.takeOffTitle(e),delete this.titleMap[e]},e.prototype.takeOffTitle=function(e){for(var t=0;t<DataManager.getInstance().playerManager.player.playerDatas.length;++t)DataManager.getInstance().playerManager.player.playerDatas[t].titleId==e&&(DataManager.getInstance().playerManager.player.playerDatas[t].titleId=0)},e}();__reflect(TitleManager.prototype,"TitleManager");var TopRankBase=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.parseMessage=function(e){this.parseMsg(e),this.rank=e.getInt(),this.info1=GameCommon.getInstance().getFormatNumberShow(e.getLong()),this.info2=GameCommon.getInstance().getFormatNumberShow(e.getInt())},t}(SimplePlayerData);__reflect(TopRankBase.prototype,"TopRankBase");var TOPRankGiftManager=function(){function e(){this.onGetZero()}return e.prototype.parseMessage=function(e){this.day=e.getInt(),this.getModelData(),this.onGetZero(),this.day>6&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN))},e.prototype.onGetZero=function(){var e=new Date;e.getTime();e.setHours(23),e.setMinutes(59),e.setSeconds(59),this.zero=e.getTime()},e.prototype.getCountDown=function(){return Math.round((this.zero-(new Date).getTime())/1e3)},e.prototype.getModelData=function(){this.tabs=[]},e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.TOPRANK_GIFT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e}();__reflect(TOPRankGiftManager.prototype,"TOPRankGiftManager");var TopRankManager=function(){function e(){this.myRanks={},this.lists={},this.outline1st={},this.isAddCoolDown=!1,this.lastRankType=e.RANK_SIMPLE_TYPE_MAPSTAGE,this.lastDataList=[],this.mapStageList=[],this.mapStageMy=0,this.dekaronList=[],this.dekaronMy=0}return e.prototype.getTabInfo=function(e){return this.lists[e]},e.prototype.parseMessage=function(e){for(var t,n=e.getByte(),a=e.getInt(),i=e.getInt(),o=e.getShort(),r=[],s=0;o>s;s++)t=new TopRankBase,t.parseMessage(e),r.push(t);if(this.myRanks[n]=i,this.lists[n]=r,a>0?this.isAddCoolDown||(this.remainTime=a,this.isAddCoolDown=!0,Tool.addTimer(this.onCountDown,this)):(this.remainTime=0,this.onCountDown()),0!=o){var h=new PlayerAppears;h.parseMsg(e),this.outline1st[n]=h.appears[0]}},e.prototype.parseSimpleMessage=function(t){this.lastRankType=t.getByte();for(var n=t.getBoolean(),a=t.getShort(),i=[],o=0;a>o;o++){var r=new TopRankSimple;r.parseMessage(t),i.push(r)}var s=t.getShort();this.lastRankType==e.RANK_SIMPLE_TYPE_MAPSTAGE?(this.mapStageMy=s,this.mapStageList=i,this.lastDataList=this.mapStageList):this.lastRankType==e.RANK_SIMPLE_TYPE_DEKARON&&(this.dekaronMy=s,this.dekaronList=i,this.lastDataList=this.dekaronList),this.lastRankType!=e.RANK_SIMPLE_TYPE_DABIAO&&n&&(TopRankSimplePanel.NAME2_VISIBLE=!0,TopRankSimplePanel.ADD_STR="关",GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankSimplePanel"))},e.prototype.topzaoyulistdate=function(e){this.zaoyuList=[],this.myRanks[TOPRANK_TYPE.FIELD_PVP]=e.getShort();for(var t=e.getShort(),n=0;t>n;n++){var a=new TopRankBase;if(a.rank=n+1,a.id=e.getInt(),a.info1=e.getInt(),a.name=e.getString(),a.level=e.getShort(),a.rebirthLv=e.getShort(),a.viplevel=e.getByte(),0==n){var i=new PlayerAppears;i.parseMsg(e),this.outline1st[TOPRANK_TYPE.FIELD_PVP]=i.appears[0]}this.zaoyuList.push(a)}},e.prototype.otherMessage=function(e){this.otherindex=new Otherindex,this.otherindex.otherid=e.getInt(),this.otherindex.othername=e.getString(),this.otherindex.otherzhuan=e.getShort(),this.otherindex.otherlv=e.getShort(),this.otherindex.othervip=e.getInt(),this.otherindex.zhangongLv=e.getInt();var t=e.getByte();this.otherindex.Otherplayerarr=[];for(var n=0;t>n;n++){var a=new Otherplayer;a.teshu=[],a.occupation=e.getByte(),a.sex=e.getByte(),this.otherindex.attributes=[];for(var i=0;i<ATTR_TYPE.SIZE;i++)this.otherindex.attributes.push(e.getLong());a.figthPower=e.getLong(),a.equipdatearr=[];for(var o=0;o<2*GameDefine.Equip_Slot_Num+4;o++){var r=new Equipdate;r.isequip=e.getBoolean();var s=new EquipThing;1==r.isequip&&s.parseEquipMessage(e),a.equipdatearr.push(s)}a.equipgroovearr=[];for(var h=0;h<GameDefine.Equip_Slot_Num;h++){var l=new Equipgroove;l.zhuling=e.getInt(),l.zhulingExp=e.getInt(),l.qianghua=e.getInt(),l.baoshi=e.getInt(),l.zhuhun=e.getByte(),l.quenchingLv=e.getByte(),l.quenchingExp=e.getInt(),a.equipgroovearr.push(l)}a.blessStardata=[],a.blessstagedata=[],a.blessPowerdata=[];for(var g=0;g<BLESS_TYPE.SIZE;g++)a.blessStardata[g]=e.getShort(),a.blessstagedata[g]=e.getShort(),a.blessPowerdata[g]=e.getLong();this.otherindex.Otherplayerarr.push(a)}var c=new PlayerAppears;c.parseMsg(e),this.otherindex.appearData=c.appears},e.prototype.otherindexdate=function(){return this.otherindex},e.prototype.onCountDown=function(){if(this.remainTime-=1,this.remainTime<=0){this.isAddCoolDown&&Tool.removeTimer(this.onCountDown,this),this.isAddCoolDown=!1;for(var e in this.lists)delete this.lists[e]}},e.RANK_SIMPLE_TYPE_MAPSTAGE=1,e.RANK_SIMPLE_TYPE_DEKARON=2,e.RANK_SIMPLE_TYPE_DABIAO=3,e.RANK_SIMPLE_TYPE_FESTIVAL_TARGET=4,e.RANK_SIMPLE_TYPE_FESTIVAL_PAYTARGET=5,e.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN=6,e.RANK_SIMPLE_TYPE_CONSUME=7,e.RANK_SIMPLE_TYPE_CROSSPAY=8,e.RANK_SIMPLE_TYPE_CONSUMEITEM=9,e.RANK_SIMPLE_TYPE_LABA=100,e.RANK_SIMPLE_TYPE_UNIONDUP=999,e}();__reflect(TopRankManager.prototype,"TopRankManager");var Otherindex=function(){function e(){}return e}();__reflect(Otherindex.prototype,"Otherindex");var Otherplayer=function(){function e(){}return e}();__reflect(Otherplayer.prototype,"Otherplayer");var Equipdate=function(){function e(){}return e}();__reflect(Equipdate.prototype,"Equipdate");var Equipdes=function(){function e(){}return e}();__reflect(Equipdes.prototype,"Equipdes");var Equipgroove=function(){function e(){}return e}();__reflect(Equipgroove.prototype,"Equipgroove");var Zhuzaidate=function(){function e(){}return e}();__reflect(Zhuzaidate.prototype,"Zhuzaidate");var TopRankSimple=function(){function e(){}return e.prototype.parseMessage=function(e){this.rank=e.getShort(),this.name=e.getString(),this.vip=e.getByte(),this.value=e.getInt(),this.fighting=e.getLong()},e}();__reflect(TopRankSimple.prototype,"TopRankSimple");var TuJianData=function(){function e(e){this._model=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this._model.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrAry",{get:function(){var e=GameCommon.getInstance().getAttributeAry();if(this._model)for(var t=0;t<ATTR_TYPE.SIZE;t++)e[t]=this._model.attrAry[t]*this.level;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextAttrAty",{get:function(){var e=GameCommon.getInstance().getAttributeAry();if(this._model)for(var t=0;t<ATTR_TYPE.SIZE;t++)e[t]=this._model.attrAry[t]*(this.level+1);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"costNum",{get:function(){return this._model&&GameDefine.Tujian_MAX_Lv>this.level?this._model.cost.num+Tool.toInt(this.level/5):0},enumerable:!0,configurable:!0}),e}();__reflect(TuJianData.prototype,"TuJianData");var TuJianManager=function(){function e(){}return e}();__reflect(TuJianManager.prototype,"TuJianManager");var UnionBattleInfo=function(){function e(){this.canJoin=!1,this.myStarCount=0,this.myScore=0}return e.prototype.onParseGroupMsg=function(e){this.joinUnions=[],this.canJoin=!1,this.state=e.getByte(),this.timecount=e.getLong()+egret.getTimer();var t=e.getBoolean();if(this.myUnionFightInfo=null,1==t&&this.state!=UNIONBATTLE_STATE.NOT){for(var n=e.getByte(),a=0;n>a;a++){var i=new FightUnionInfo;i.roundCount=e.getByte(),i.unionId=e.getInt(),i.name=e.getString(),i.state=e.getByte(),i.buffCount=e.getByte(),i.badgesIndex=e.getByte(),i.level=e.getShort(),this.joinUnions.push(i),i.name==DataManager.getInstance().unionManager.unionInfo.info.name&&(this.myUnionFightInfo=i)}this.canJoin=1==e.getByte()}},e.prototype.onParseJoinUnionBattle=function(e){var t=e.getByte();t>this.myScore&&(this.myStarCount=1,this.myScore=100)},e.prototype.onParseDepotMsg=function(e){this.depotThings=[];for(var t=e.getByte(),n=0;t>n;n++){var a=e.getShort(),i=e.getInt();i>0&&this.depotThings.push(new AwardItem(GOODS_TYPE.BOX,a,i))}},e.prototype.onParseRankMsg=function(e){this.rankDatas=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new UnionBattleRank;a.rank=n+1,a.onParse(e),a.scoreCount>0&&a.starCount>0&&this.rankDatas.push(a)}},e.prototype.getUnionFightInfoById=function(e){for(var t,n=0;n<this.joinUnions.length;n++)if(e==this.joinUnions[n].unionId){t=this.joinUnions[n];break}return t},e}();__reflect(UnionBattleInfo.prototype,"UnionBattleInfo");var FightUnionInfo=function(){function e(){this.buffCount=0}return e}();__reflect(FightUnionInfo.prototype,"FightUnionInfo");var UnionBattleLog=function(){function e(){}return e.prototype.parseLogMsg=function(e){this.logdesc="";e.getString(),e.getString(),e.getByte(),e.getByte(),e.getInt()},e}();__reflect(UnionBattleLog.prototype,"UnionBattleLog");var UnionBattleRank=function(){function e(){}return e.prototype.onParse=function(e){this.name=e.getString(),this.starCount=e.getShort(),this.scoreCount=e.getInt()},e.prototype.onParseGeren=function(e){this.name=e.getString(),this.starCount=e.getShort(),this.scoreCount=e.getInt()},e}();__reflect(UnionBattleRank.prototype,"UnionBattleRank");var UNIONBATTLE_STATE;!function(e){e[e.NOT=0]="NOT",e[e.READY=1]="READY",e[e.FIGHT=2]="FIGHT",e[e.RESULT=3]="RESULT"}(UNIONBATTLE_STATE||(UNIONBATTLE_STATE={}));var UNIONBATTLE_RESULT;!function(e){e[e.UNRESULT=0]="UNRESULT",e[e.WIN=1]="WIN",e[e.LOSE=2]="LOSE"}(UNIONBATTLE_RESULT||(UNIONBATTLE_RESULT={}));var UnionInfo=function(){function e(){this.name="",this.level=0,this.badgesIndex=0,this.memberCount=0,this.applyLevel=0,this.xuanyan="",this.wangName="",this.rebirthLv=0}return e.prototype.parseMsg=function(e){this.id=e.getInt(),this.name=e.getString(),this.wangName=e.getString(),this.level=e.getShort(),this.badgesIndex=e.getByte(),this.memberCount=e.getShort(),this.xuanyan=e.getString(),this.applyLevel=e.getShort()},e}();__reflect(UnionInfo.prototype,"UnionInfo");var UnionMemberInfo=function(){function e(){this.offLineTime=0,this.receiveSize=0,this.playerdata=new SimplePlayerData,this.receiveId=[],this.receiveNum=[]}return e.prototype.parseMsg=function(e){if(this.playerdata.parseMsg(e),this.postion=e.getByte(),this.donate=e.getInt(),this.offLineTime=e.getInt(),this.receiveSize=e.getByte(),this.receiveSize>0)for(var t=0;t<this.receiveSize;t++)this.receiveId[t]=e.getShort(),this.receiveNum[this.receiveId[t]]=e.getShort()},e}();__reflect(UnionMemberInfo.prototype,"UnionMemberInfo");var MyUnionData=function(){function e(){this.noticeStr="",this.tributeNum=0,this.tributeVipNum=0,this.turnplateNum=0,this.isImpeachment=0,this.info=new UnionInfo,this.unionMemberList=[]}return e.prototype.parseMsg=function(e){this.info.id=e.getInt(),this.info.name=e.getString(),this.info.wangName=e.getString(),this.info.level=e.getShort(),this.unionExp=e.getInt(),this.info.badgesIndex=e.getByte(),this.info.memberCount=e.getShort(),this.info.xuanyan=e.getString(),this.noticeStr=e.getString(),this.info.applyLevel=e.getShort(),this.autoAdopt=e.getBoolean(),this.tributeNum=e.getByte(),this.tributeVipNum=e.getByte(),this.turnplateNum=e.getByte()},e.prototype.parseMemberList=function(e){for(var t=this.unionMemberList.length-1;t>=0;t--)this.unionMemberList[t]=null,this.unionMemberList.splice(t,1);for(var n=e.getShort(),t=0;n>t;t++){var a=new UnionMemberInfo;a.parseMsg(e),this.unionMemberList.push(a),a.playerdata.id==DataManager.getInstance().playerManager.player.id&&(this.selfData=a)}this.isImpeachment=e.getByte()},e.prototype.parseMemberPostion=function(e,t){for(var n=this.unionMemberList.length-1;n>=0;n--){var a=this.unionMemberList[n];if(a.playerdata.id==e){a.postion=t;break}}},e.prototype.onDeleteMember=function(e){for(var t=this.unionMemberList.length-1;t>=0;t--){var n=this.unionMemberList[t];if(n.playerdata.id==e){var a=n.playerdata.name;return n=null,this.unionMemberList.splice(t,1),a}}return""},e.prototype.getUnionLevelModel=function(){return JsonModelManager.instance.getModelguildLv()[this.info.level-1]},e.prototype.addUnionExp=function(e){var t=this.getUnionLevelModel();this.unionExp+=e,t.exp<=this.unionExp&&JsonModelManager.instance.getModelguildLv()[this.info.level]&&(this.info.level=this.info.level+1,this.unionExp=this.unionExp-t.exp)},e.prototype.onDestroy=function(){for(var e=this.unionMemberList.length-1;e>=0;e--)this.unionMemberList[e]=null,this.unionMemberList.splice(e,1);this.unionMemberList=null,this.info=null,this.selfData=null,this.unionExp=null,this.noticeStr=null,this.autoAdopt=null},e}();__reflect(MyUnionData.prototype,"MyUnionData");var UnionManager=function(){function e(){this.applyPageNum=1,this.applyPageTotal=1,this.joinCDTime=0,this.record=[],this.beforeBossPointTime=0,this.applyUnionList=[],this.unionSkills={},this.unionLogs=[],this.tasks={};var e,t=JsonModelManager.instance.getModelguildTask();for(var n in t)e=new UnionTask,this.tasks[n]=e,e.id=parseInt(n)}return Object.defineProperty(e.prototype,"unionInfo",{get:function(){return this._selfUnionInfo},enumerable:!0,configurable:!0}),e.prototype.parseUnionInfoMsg=function(e){var t=e.getBoolean();t?(this._selfUnionInfo||(this._selfUnionInfo=new MyUnionData),this._selfUnionInfo.parseMsg(e)):this.onDestroyUnionInfo(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionListMsg=function(e){if(this.applyUnionList.length>0)for(var t=this.applyUnionList.length-1;t>=0;t--)this.applyUnionList[t]=null,this.applyUnionList.splice(t,1);this.applyPageNum=e.getShort(),this.applyPageTotal=e.getShort();for(var n=e.getByte(),t=0;n>t;t++)this.applyUnionList[t]=new UnionInfo,this.applyUnionList[t].parseMsg(e);GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionMemberMsg=function(e){this._selfUnionInfo&&this._selfUnionInfo.parseMemberList(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionXuanyanMsg=function(e){this._selfUnionInfo&&(this._selfUnionInfo.info.xuanyan=e.getString(),GameCommon.getInstance().addAlert("仙盟宣言修改成功")),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionNoticeMsg=function(e){this._selfUnionInfo&&(this._selfUnionInfo.noticeStr=e.getString(),GameCommon.getInstance().addAlert("仙盟公告修改成功")),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionAutoAdoptMsg=function(e){if(this._selfUnionInfo){this._selfUnionInfo.autoAdopt=e.getBoolean();var t=this._selfUnionInfo.autoAdopt?"开启":"关闭";GameCommon.getInstance().addAlert("已"+t+"仙盟自动审核")}},e.prototype.parseUnionLevelLimitMsg=function(e){this._selfUnionInfo&&(this._selfUnionInfo.info.applyLevel=e.getShort(),GameCommon.getInstance().addAlert("仙盟限制等级修改为"+this._selfUnionInfo.info.applyLevel+"级"))},e.prototype.parsePostionUpdateMsg=function(e){if(this._selfUnionInfo){var t=e.getInt(),n=e.getByte();this._selfUnionInfo.parseMemberPostion(t,n),GameCommon.getInstance().addAlert("职位修改成功")}},e.prototype.parseDeleteMember=function(e){if(this._selfUnionInfo){var t=e.getInt(),n=this._selfUnionInfo.onDeleteMember(t);GameCommon.getInstance().addAlert("您已将"+n+"踢出仙盟")}},e.prototype.parseUnionTribute=function(e){if(this._selfUnionInfo){var t=e.getByte(),n=e.getByte(),a=e.getByte();this._selfUnionInfo.tributeNum=n,this._selfUnionInfo.tributeVipNum=a;var i=JsonModelManager.instance.getModelguildShangxiang()[t];this._selfUnionInfo.addUnionExp(i.guildExp)}},e.prototype.onDestroyUnionInfo=function(){this._selfUnionInfo&&(this._selfUnionInfo.onDestroy(),this._selfUnionInfo=null,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_CLOSE),"UnionMainCityPanel"),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_CLOSE),"UnionHallPanel"),GameCommon.getInstance().addAlert("您已退出仙盟"))},e.prototype.parseRunALotteryMessage=function(e){var t,n=[];this._selfUnionInfo.turnplateNum=e.getByte();for(var a=e.getByte(),i=0;a>i;i++)t=new AwardItem,t.parseMessage(e),n.push(t);var o=new TurnplateAwardParam;o.desc="转盘获得以下奖励",o.titleSource="",o.itemAwards=n,o.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TurnplateAwardPanel",o))},e.prototype.parseUpdateUnionSkill2=function(e){var t=e.getByte(),n=e.getByte(),a=e.getShort(),i=e.getInt(),o=DataManager.getInstance().playerManager.player.playerDatas[t].getUnionSkill2(n);o?(o.level=a,o.exp=i):(o=new UnionSkill2,o.id=n,o.level=a,o.exp=i,DataManager.getInstance().playerManager.player.playerDatas[t].unionSkill2Array.push(o)),DataManager.getInstance().playerManager.player.updateUnionSkill(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseUnionLog=function(e){if(this.unionLogs.length>0)for(var t=this.unionLogs.length-1;t>=0;t--)this.unionLogs[t]=null,this.unionLogs.splice(t,1);for(var n="72bdf7",a=e.getByte(),t=0;a>t;t++){var i="",o=e.getByte();switch(o){case UnionLog_Type.JOIN:var r=Tool.getHtmlColorStr(e.getString(),n);i=r+"加入仙盟";break;case UnionLog_Type.QUIT:var r=Tool.getHtmlColorStr(e.getString(),n);i=r+"退出仙盟";break;case UnionLog_Type.DELETE:var r=Tool.getHtmlColorStr(e.getString(),n),s=Tool.getHtmlColorStr(e.getString(),n);i=r+"被"+s+"踢出仙盟";break;case UnionLog_Type.TRIBUTE:var r=Tool.getHtmlColorStr(e.getString(),n),h=e.getByte(),l=JsonModelManager.instance.getModelguildShangxiang()[h],g=GameCommon.getInstance().getThingModel(l.cost.type,l.cost.id),c="<font color='#"+GameCommon.Quality_Color_String[g.quality]+"'>"+l.cost.num+g.name+"</font>";i=r+"消耗"+c+"进行了一次仙盟上香";break;case UnionLog_Type.APPOINT:var r=Tool.getHtmlColorStr(e.getString(),n),s=Tool.getHtmlColorStr(e.getString(),n),p=UnionDefine.Union_Postions[e.getByte()];i=r+"被"+s+"任命为"+p;break;case UnionLog_Type.LEVELUP:i="您的仙盟已升到"+e.getByte()+"级";break;case UnionLog_Type.ASSIGN:var r=Tool.getHtmlColorStr(e.getString(),n),s=Tool.getHtmlColorStr(e.getString(),n),u=e.getShort(),d=e.getShort(),_=GameCommon.getInstance().getThingModel(GOODS_TYPE.BOX,u),m=Tool.getHtmlColorStr(_.name+"*"+d,GameCommon.Quality_Color_String[_.quality]);i=r+"将"+m+"分配给"+s;break;case UnionLog_Type.IMPEACHMENT:var r=Tool.getHtmlColorStr(e.getString(),n),s=Tool.getHtmlColorStr(e.getString(),n);i=r+"被"+s+"弹劾盟主职位"}i&&this.unionLogs.unshift(i)}},e.prototype.onReqUnionInfoMsg=function(){var e=new Message(MESSAGE_ID.UNION_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.initUnionInfo||(this.initUnionInfo=!0)},e.prototype.onReqUnionMember=function(){var e=new Message(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onReqUnionPrizeRecord=function(){var e=new Message(MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseUnionPrizeRecord=function(e){this.record=[];for(var t,n=e.getByte(),a=0;n>a;a++)t=new UnionPrizeLog,t.parseMessage(e),this.record.push(t)},e.prototype.onSendTaskMessage=function(){var e=new Message(MESSAGE_ID.UNION_TASK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseUnionTaskMessage=function(e){for(var t=e.getByte(),n=1;t>=n;n++){var a=e.getByte();this.tasks[a].param=e.getByte()}},e.prototype.getUnionTaskData=function(){var e,t,n=[],a=JsonModelManager.instance.getModelguildTask();for(var i in this.tasks)e=this.tasks[i],e.sortKey=e.id,t=a[e.id],e.param>=t.count&&(e.sortKey+=100),n.push(e);return e=new UnionTask,e.id=0,e.param=this._selfUnionInfo.tributeNum,e.sortKey=0,e.param>=10&&(e.sortKey+=100),n.push(e),n=n.sort(function(e,t){return e.sortKey<t.sortKey?-1:1})},e.prototype.onParseTaskUpdateMessage=function(e){var t=e.getByte();this.tasks[t].param=e.getByte()},e.prototype.getTextFlow=function(e){void 0===e&&(e=-1);var t=this.record.concat();if(e>0)for(;t.length>e;)t.shift();for(var n,a=[],i=0;i<t.length;i++){n=t[i];var o=GameCommon.getInstance().getThingModel(n.type,n.id);o&&(a.push({text:n.playerName,style:{textColor:2661098}}),a.push({text:" 获得",style:{textColor:16777215}}),a.push({text:o.name,style:{textColor:GameCommon.getInstance().CreateNameColer(o.quality)}}),a.push({text:"\n",style:{}}))}return a.pop(),a},e.prototype.onParseUnionBossInfo=function(e){this.unionbossTime=e.getInt(),this.unionbossTime=this.unionbossTime>0?1e3*this.unionbossTime+egret.getTimer():0,this.unionbossCount=e.getByte()},e.prototype.onParseUnionBossList=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte(),i=JsonModelManager.instance.getModelguildBoss()[a];i&&(i.unionBossStatus=e.getByte())}},e.prototype.getCheerAttrAddRate=function(e){return e>UnionDefine.Union_Max_CheerNum?UnionDefine.Union_Max_CheerNum:e},Object.defineProperty(e.prototype,"unionbattleInfo",{get:function(){return this._unionbattleInfo||(this._unionbattleInfo=new UnionBattleInfo),this._unionbattleInfo},enumerable:!0,configurable:!0}),e.prototype.onParseUnionGroupInfoMsg=function(e){this._selfUnionInfo&&(this.unionbattleInfo.onParseGroupMsg(e),GameCommon.getInstance().receiveMsgToClient(e))},e.prototype.onParseUnionDepotMsg=function(e){this.unionbattleInfo.onParseDepotMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onParseUnionBattleRankMsg=function(e){this.unionbattleInfo.onParseRankMsg(e),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkUnionBossRedPoint=function(){if(!this.unionInfo)return!1;if(0==this.unionbossCount)return!1;var e=!1;for(var t in JsonModelManager.instance.getModelguildBoss()){var n=JsonModelManager.instance.getModelguildBoss()[t];if(n.unionBossStatus==UNION_BOSS_STATUS.REBORN){e=!0;break}}if(!e&&this.beforeBossPointTime-egret.getTimer()<1e3){var a=new Message(MESSAGE_ID.UNION_BOSS_INFO_MESSAGE);return GameCommon.getInstance().sendMsgToServer(a),this.beforeBossPointTime=this.unionbossTime,!1}return!0},e.prototype.parseSummonMessage=function(e){this.countDown=e.getLong(),this.durTime=e.getLong(),this.isMSBReward=e.getBoolean(),DataManager.getInstance().dupManager.mysteriousData.rebornLefttime=e.getInt(),this.isOldBig=e.getBoolean()},e.prototype.checkUnionBossPoint=function(){return this.checkUnionBossDupPoint()?!0:this.checkMyBossRedPoint()?!0:!1},e.prototype.checkUnionBossDupPoint=function(){if(!this.unionInfo)return!1;if(this.isInitDupBossPoint){if(this.getUnionLv()>=2&&DataManager.getInstance().unionManager.unionbossCount>0&&JsonModelManager.instance.getModelguildBoss()[1].unionBossStatus!=UNION_BOSS_STATUS.CLOSE)return!0}else{var e=new Message(MESSAGE_ID.UNION_BOSS_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.isInitDupBossPoint=!0}return!1},e.prototype.checkUnionDupPoint=function(){if(!this.unionInfo)return!1;if(this.isInitDupPoint){if(this.hasDupPassAward)return!0;var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_UNION)[0];if(e&&e.leftSweepNum>0)return!0}else{var t=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);t.setByte(DUP_TYPE.DUP_UNION),GameCommon.getInstance().sendMsgToServer(t),this.isInitDupPoint=!0}return!1},e.prototype.checkMyBossRedPoint=function(){var e=!1,t=DataManager.getInstance().unionManager.countDown,n=DataManager.getInstance().unionManager.isMSBReward,a=DataManager.getInstance().unionManager.isOldBig;return e=0>=t?a:n},e.prototype.checkUnionSkillRedPoint=function(){if(!this.unionInfo)return!1;for(var e=0;e<DataManager.getInstance().playerManager.player.playerDatas.length;e++)for(var t=1;t<=UnionDefine.Union_Skill_Max;t++)if(this.checkUnionSkillOnePoint(e,t))return!0;return!1},e.prototype.checkUnionSkillOneAllPoint=function(e){if(!this.unionInfo)return!1;if(!DataManager.getInstance().playerManager.player.getPlayerData(e))return!1;for(var t=1;t<=UnionDefine.Union_Skill_Max;t++)if(this.checkUnionSkillOnePoint(e,t))return!0;return!1},e.prototype.checkUnionSkillOnePoint=function(e,t){if(!this.unionInfo)return!1;var n=DataManager.getInstance().playerManager.player.getPlayerData(e).getUnionSkill2(t),a=n?n.level+1:1,i=JsonModelManager.instance.getModelguildSkill()[t][a-1];return i&&i.costList[0].num<=DataManager.getInstance().playerManager.player.donate&&i.costList[1].num<=DataManager.getInstance().playerManager.player.money?!0:!1},e.prototype.checkTributeRedPoint=function(){if(this.unionInfo){var e=JsonModelManager.instance.getModelguildShangxiang()[1];if(10-this.unionInfo.tributeNum>0&&DataManager.getInstance().playerManager.player.money>=e.cost.num)return!0}return!1},e.prototype.checkUnionRedPoint=function(){if(this.initUnionInfo){if(this.checkUnionSkillRedPoint())return!0;if(this.checkTributeRedPoint())return!0}else this.onReqUnionInfoMsg();return!1},e.prototype.getUnionLv=function(){return this._selfUnionInfo?this._selfUnionInfo.info.level:0},e}();__reflect(UnionManager.prototype,"UnionManager");var UnionPrizeLog=function(){function e(){}return e.prototype.parseMessage=function(e){this.playerName=e.getString(),this.type=e.getByte(),this.id=e.getShort()},e}();__reflect(UnionPrizeLog.prototype,"UnionPrizeLog");var UnionTask=function(){function e(){this.id=0,this.param=0}return e.prototype.onParseMessage=function(e){this.id=e.getByte(),this.param=e.getByte()},e}();__reflect(UnionTask.prototype,"UnionTask");var UnionLog_Type;!function(e){e[e.JOIN=1]="JOIN",e[e.QUIT=2]="QUIT",e[e.DELETE=3]="DELETE",e[e.TRIBUTE=4]="TRIBUTE",e[e.APPOINT=5]="APPOINT",e[e.LEVELUP=6]="LEVELUP",e[e.BOSS=7]="BOSS",e[e.ASSIGN=8]="ASSIGN",e[e.IMPEACHMENT=9]="IMPEACHMENT"}(UnionLog_Type||(UnionLog_Type={}));var UNION_BOSS_STATUS;!function(e){e[e.REBORN=1]="REBORN",e[e.FIGTHING=2]="FIGTHING",e[e.DEATH=3]="DEATH",e[e.CLOSE=4]="CLOSE"
}(UNION_BOSS_STATUS||(UNION_BOSS_STATUS={}));var UnionSkill2=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getByte(),this.level=e.getShort(),this.exp=e.getInt()},e}();__reflect(UnionSkill2.prototype,"UnionSkill2");var YewaiPvPManager=function(){function e(){this.pvpfightterInfos=[]}return e.prototype.onParsePVPOhterInfoMsg=function(e){this.prestige=e.getInt(),this.myrankNum=e.getShort(),this._resetTime=e.getInt()+egret.getTimer(),this.pvpfightterInfos=[];for(var t=e.getByte(),n=0;t>n;n++)this.pvpfightterInfos[n]=new OtherFightData,this.pvpfightterInfos[n].parseYewaiPVPMsg(e);GameCommon.getInstance().receiveMsgToClient(e)},Object.defineProperty(e.prototype,"resetTime",{get:function(){return Math.max(0,Math.ceil((this._resetTime-egret.getTimer())/1e3))},enumerable:!0,configurable:!0}),e.prototype.checkEncounterPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_YEWAIPVP)&&this.pvpfightterInfos&&this.pvpfightterInfos.length>0?!0:!1},e}();__reflect(YewaiPvPManager.prototype,"YewaiPvPManager");var ActivityDefine=function(){function e(){}return e.CLIENT_ORIGIN_ACTID=1e4,e.DayIcons=["newactivity_diyitian_png","newactivity_diertian_png","newactivity_disantian_png","newactivity_disitian_png","newactivity_diwutian_png","newactivity_diliutian_png","newactivity_diqitian_png"],e.LIUYI_ZHUANPAN_AWARD=["firstReward","secondReward","thirdReward","forthReward"],e.GIFTTOP="5,0,150000#0,401,1,6#3,74,3#2,5,1#3,69,3#3,73,3#3,72,1#3,19,1",e}();__reflect(ActivityDefine.prototype,"ActivityDefine");var ACTIVITY_BRANCH_TYPE;!function(e){e[e.DABIAOJIANGLI=1]="DABIAOJIANGLI",e[e.SIGN_EVERYDAY=2]="SIGN_EVERYDAY",e[e.LOGON_ADD=3]="LOGON_ADD",e[e.LOGON_LIMIT=4]="LOGON_LIMIT",e[e.CHONGBANG_LIBAO=5]="CHONGBANG_LIBAO",e[e.YAOQIANSHU=6]="YAOQIANSHU",e[e.XIANGOULIBAO=7]="XIANGOULIBAO",e[e.GUANQIAXIANFENG=8]="GUANQIAXIANFENG",e[e.VIP_XIANGOU2=9]="VIP_XIANGOU2",e[e.LEIJICHONGZHI=10]="LEIJICHONGZHI",e[e.PERSONAL_GOAL=11]="PERSONAL_GOAL",e[e.INVEST=12]="INVEST",e[e.GIFTFORPAY=13]="GIFTFORPAY",e[e.MONEYTAKEGODGIFT=14]="MONEYTAKEGODGIFT",e[e.ZHUANPANACTIVITY=15]="ZHUANPANACTIVITY",e[e.WUYITEHUILIBAO=17]="WUYITEHUILIBAO",e[e.WUYIACTIVITY=18]="WUYIACTIVITY",e[e.OPENSERVER_LEICHONG=19]="OPENSERVER_LEICHONG",e[e.LIUYIACTIVITDANCHONG=20]="LIUYIACTIVITDANCHONG",e[e.LIUYI_MISSION=21]="LIUYI_MISSION",e[e.HEFU_MISSION=22]="HEFU_MISSION",e[e.HEFU_PAYGIFT=23]="HEFU_PAYGIFT",e[e.HEFU_TREASURE=24]="HEFU_TREASURE",e[e.HEFU_LEGEND=25]="HEFU_LEGEND",e[e.ZHIZUN_XIANGOU=26]="ZHIZUN_XIANGOU",e[e.LIANXU_LEICHONG=27]="LIANXU_LEICHONG",e[e.WX_PAYGIFT=28]="WX_PAYGIFT",e[e.NEWGODGIFT=29]="NEWGODGIFT",e[e.CONSUME_ITEM=30]="CONSUME_ITEM",e[e.CONSUME_RANK=31]="CONSUME_RANK",e[e.TIANZUNZHONGCHOU=32]="TIANZUNZHONGCHOU",e[e.LEICHONGLABA=33]="LEICHONGLABA",e[e.WEEKENDSHAREGIFT=34]="WEEKENDSHAREGIFT",e[e.ZHONGQIULEICHONG=35]="ZHONGQIULEICHONG",e[e.FESTIVAL_WORDCOLLECTION=36]="FESTIVAL_WORDCOLLECTION",e[e.FESTIVAL_SHOP=37]="FESTIVAL_SHOP",e[e.JUEXINGDAN=38]="JUEXINGDAN",e[e.ACT_666SHENQI2=39]="ACT_666SHENQI2",e[e.ACT_666SHENQI2_DUIHUAN=40]="ACT_666SHENQI2_DUIHUAN",e[e.ACT_RONGLIAN=41]="ACT_RONGLIAN",e[e.ACT_SHENQICHOUQIAN=42]="ACT_SHENQICHOUQIAN",e[e.YUEKA=1e4]="YUEKA",e[e.CDKEY=10001]="CDKEY",e[e.NOTICE=10002]="NOTICE",e[e.COATARD=10003]="COATARD",e[e.FUND=10004]="FUND",e[e.VIPZHUANPAN=10005]="VIPZHUANPAN",e[e.YIYUANLIBAO=10006]="YIYUANLIBAO",e[e.CROSS_PAYRANK=10007]="CROSS_PAYRANK",e[e.CONSUMEITEM_RANK=10008]="CONSUMEITEM_RANK",e[e.CONSUMEITEM_TURNPLATE=10009]="CONSUMEITEM_TURNPLATE",e[e.TEHUILIBAO=1001]="TEHUILIBAO",e[e.HONGBAOFANLI=6e3]="HONGBAOFANLI",e[e.DENGLUJIANGLI=5e3]="DENGLUJIANGLI",e[e.CHONGZHISHENGYAN=8e3]="CHONGZHISHENGYAN",e[e.TREASURE_RANK=1e4]="TREASURE_RANK",e[e.WISHINGWELL=11e3]="WISHINGWELL",e[e.VIPTLSHOP=12e3]="VIPTLSHOP",e[e.TREASURE_RANK2=14e3]="TREASURE_RANK2",e[e.SEVENDAYPAY=15e3]="SEVENDAYPAY",e[e.FESTIVAL_LOGIN=16e3]="FESTIVAL_LOGIN",e[e.FESTIVAL_FAVORABLE=17e3]="FESTIVAL_FAVORABLE",e[e.FESTIVAL_TARGET=2e4]="FESTIVAL_TARGET",e[e.FESTIVAL_WISHING_WELL=19e3]="FESTIVAL_WISHING_WELL",e[e.WEEKEND_FAVORABLE=21e3]="WEEKEND_FAVORABLE",e[e.WEEKEND_WISHING_WELL=22e3]="WEEKEND_WISHING_WELL",e[e.FESTIVAL_TARGET_PAY=23e3]="FESTIVAL_TARGET_PAY",e[e.FESTIVAL_LOGIN2=24e3]="FESTIVAL_LOGIN2",e[e.FESTIVAL_FAVORABLE2=25e3]="FESTIVAL_FAVORABLE2",e[e.FESTIVAL_TARGET2=28e3]="FESTIVAL_TARGET2",e[e.WANBA_PRIVILEGE_GIFT=3e4]="WANBA_PRIVILEGE_GIFT",e[e.FESTIVAL_FUDAI=31e3]="FESTIVAL_FUDAI"}(ACTIVITY_BRANCH_TYPE||(ACTIVITY_BRANCH_TYPE={}));var ACTIVITY_TYPE;!function(e){e[e.ACTIVITY_HALL=1]="ACTIVITY_HALL",e[e.ACTIVITY_DENGLUJIANGLI=2]="ACTIVITY_DENGLUJIANGLI",e[e.ACTIVITY_CHONGZHISHENGYAN=3]="ACTIVITY_CHONGZHISHENGYAN",e[e.ACTIVITY_FULIDATING=4]="ACTIVITY_FULIDATING",e[e.ACTIVITY_CHONGZHI=5]="ACTIVITY_CHONGZHI",e[e.ACTIVITY_TREASURE_RANK=6]="ACTIVITY_TREASURE_RANK",e[e.ACTIVITY_VIPTLSHOP=7]="ACTIVITY_VIPTLSHOP",e[e.ACTIVITY_SEVENPAY=8]="ACTIVITY_SEVENPAY",e[e.ACTIVITY_FESTIVAL=9]="ACTIVITY_FESTIVAL",e[e.ACTIVITY_WEEKEND=10]="ACTIVITY_WEEKEND",e[e.ACTIVITY_PLAY_CAFE=11]="ACTIVITY_PLAY_CAFE",e[e.ACTIVITY_TARGET_MAIN=12]="ACTIVITY_TARGET_MAIN",e[e.ACTIVITY_VIP_XIANGOU=13]="ACTIVITY_VIP_XIANGOU",e[e.ACTIVITY_WANBA_FOCUS=14]="ACTIVITY_WANBA_FOCUS",e[e.ACTIVITY_WANBA_DESK=15]="ACTIVITY_WANBA_DESK",e[e.ACTIVITY_YIYUANLIBAO=16]="ACTIVITY_YIYUANLIBAO",e[e.ACTIVITY_SHARE=17]="ACTIVITY_SHARE",e[e.ACTIVITY_FOCUS=18]="ACTIVITY_FOCUS",e[e.ACTIVITY_SHENQI=19]="ACTIVITY_SHENQI",e[e.ACTIVITY_WANBA_VIPTEQUAN=20]="ACTIVITY_WANBA_VIPTEQUAN",e[e.ACTIVITY_WUYi=21]="ACTIVITY_WUYi",e[e.ACTIVITY_VIP_ZHUANPAN=22]="ACTIVITY_VIP_ZHUANPAN",e[e.VERIFY_GIFT=23]="VERIFY_GIFT",e[e.OPENSERVER_LEICHONG=24]="OPENSERVER_LEICHONG",e[e.ACTIVITY_YUGAO=25]="ACTIVITY_YUGAO",e[e.ACTIVITY_SHOP=26]="ACTIVITY_SHOP",e[e.ACTIVITY_TREASURE=27]="ACTIVITY_TREASURE",e[e.ACTIVITY_HEFU=28]="ACTIVITY_HEFU",e[e.WANBA_XQBL=29]="WANBA_XQBL",e[e.LIANXU_LEICHONG=30]="LIANXU_LEICHONG",e[e.ACTIVITY_GODWEAPON=31]="ACTIVITY_GODWEAPON",e[e.ACTIVITY_CONSUME=32]="ACTIVITY_CONSUME",e[e.ACTIVITY_TUANGOU=33]="ACTIVITY_TUANGOU",e[e.ACTIVITY_ZHUANPAN=34]="ACTIVITY_ZHUANPAN",e[e.ACTIVITY_FESTIVALFULLMOON=35]="ACTIVITY_FESTIVALFULLMOON",e[e.ACTIVITY_JUEXINGDAN=36]="ACTIVITY_JUEXINGDAN",e[e.ACTIVITY_666=37]="ACTIVITY_666",e[e.ACTIVITY_SMELT=38]="ACTIVITY_SMELT",e[e.ACTIVITY_SHENQICHOUQIAN=39]="ACTIVITY_SHENQICHOUQIAN",e[e.FANGKUAI_GENGDUOYOUXI=3001]="FANGKUAI_GENGDUOYOUXI",e[e.VIP_SERVICE=3004]="VIP_SERVICE",e[e.WXGAME_FIRST_SHARE=3002]="WXGAME_FIRST_SHARE",e[e.WXGAME_INVITE=3003]="WXGAME_INVITE",e[e.WXGAME_SHARE=3005]="WXGAME_SHARE",e[e.WXGAME_COLLECTION=3006]="WXGAME_COLLECTION"}(ACTIVITY_TYPE||(ACTIVITY_TYPE={}));var BlessDefine=function(){function e(){}return e.BLESS_STARS_MAX=10,e.BLESS_SLOT_MAXNUM=8,e.BLESS_SKILL_BASIC=20,e.BLESS_SKILL_MAX=1e3,e.BLESS_BIGITEM_LIMIT=4,e.BLESS_UPDAN_NORMALTYPE=1,e.BLESS_UPDAN_SUPERTYPE=2,e.BLESS_UPDAN_MAXGRADE=[0,4,7],e.BLESS_NAME=["飞剑","神兵","神装","法宝","仙羽","法座","幻装","灵弓","羽翼","宝器"],e.BLESS_DESC_MIN=[1,1,1,2,3,4,4,5,5,6,6,7,7,8,8,9],e.BLESS_DESC_MAX=[1,2,3,4,5,5,6,6,7,7,8,8,9,9,10,10],e}();__reflect(BlessDefine.prototype,"BlessDefine");var BLESS_TYPE;!function(e){e[e.HORSE=0]="HORSE",e[e.WEAPON=1]="WEAPON",e[e.CLOTHES=2]="CLOTHES",e[e.MAGIC=3]="MAGIC",e[e.WING=4]="WING",e[e.RETINUE_HORSE=5]="RETINUE_HORSE",e[e.RETINUE_CLOTHES=6]="RETINUE_CLOTHES",e[e.RETINUE_WEAPON=7]="RETINUE_WEAPON",e[e.RETINUE_WING=8]="RETINUE_WING",e[e.RING=9]="RING",e[e.SIZE=5]="SIZE"}(BLESS_TYPE||(BLESS_TYPE={}));var BLESS_TAB_TYPE;!function(e){e[e.LINGSHOU=0]="LINGSHOU",e[e.SHENGBING=1]="SHENGBING",e[e.SHENZHUANG=2]="SHENZHUANG",e[e.GUANGHUAN=3]="GUANGHUAN",e[e.XIANYU=4]="XIANYU"}(BLESS_TAB_TYPE||(BLESS_TAB_TYPE={}));var MagicBody=function(e){function t(){var t=e.call(this)||this;return t.MOVING_TIME=800,t._followDist=0,t._followTotalTime=0,t._followTime=0,t._action=ACTION.STAND,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this._data=e,this.onChangeBody()},enumerable:!0,configurable:!0}),t.prototype.onChangeBody=function(){if(this._data&&this._data.magic_res){var e=void 0,t=-1;switch(this._action){case ACTION.ATTACK:t=1,e=LoadManager.getInstance().getMagicResUrl(this._data.magic_res,"attack");break;default:e=LoadManager.getInstance().getMagicResUrl(this._data.magic_res,"")}this._body?this._body.onUpdateRes(e,t,null):(this._body=new BodyAnimation(e,t,null),this._body.scaleX=this._body.scaleY=.7,this.addChild(this._body)),t>0&&this._body.playFinishCallBack(this.bodyPlayFinish,this)}else this._body&&(this._body.onDestroy(),this._body=null)},t.prototype.bodyPlayFinish=function(){this._action==ACTION.ATTACK&&(this._action=ACTION.STAND,this.onChangeBody())},t.prototype.setRandomMove=function(e){this._action!=ACTION.ATTACK&&(this.setMovePoint([e]),this.moveSpeed=GameDefine.MAGIC_Move_Speed)},t.prototype.setFollowPaths=function(e){this.setMovePoint([e]);var t=this.getDistToTarget();this._followTotalTime=Math.ceil(t/this.MOVING_TIME),this._followTime=0,this._followDist=this.getDistToTarget()},t.prototype.onStop=function(){this.stopMove()},t.prototype.stopMove=function(){e.prototype.stopMove.call(this),this._followTime=0,this._followTotalTime=0},t.prototype.onAttack=function(){this._action=ACTION.ATTACK,this.onChangeBody();var e=this.movePaths&&this.movePaths.length>0?this.movePaths[this.movePaths.length-1]:this.moveTarget;e&&(this.x=e.x,this.y=e.y,this.onStop())},t.prototype.onMove=function(){var t=40;this._followTotalTime>0&&this._followDist>0&&(this._followTime=Math.min(this._followTotalTime,this._followTime+t),this.moveSpeed=this._followDist/this._followTime),e.prototype.logicMove.call(this,t)},Object.defineProperty(t.prototype,"isMoving",{get:function(){return this.isMove()},enumerable:!0,configurable:!0}),t.prototype.refreshBodyHeight=function(e){this._body&&(this._body.y=e-this._data.model.high-30)},Object.defineProperty(t.prototype,"bodyVisible",{set:function(e){this._body&&(this._body.visible=e)},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){this._body&&(this._body.onDestroy(),this._body=null)},t}(BaseBody);__reflect(MagicBody.prototype,"MagicBody");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,a){function i(e){t.call(a,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(a))}var r=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(a,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl(LoadManager.resourceRootUrl+"gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(a,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var h=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(a,generateJSON.paths[e])},this):RES.getResByUrl(h,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(a,generateJSON.paths[e])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(a,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Constant=function(){function e(){}return e.get=function(e){try{var t=JsonModelManager.instance.getModelconstant(),n=t[e];return n.value}catch(a){Tool.throwException("读取常量"+e+"出错！")}},e.FASION_SKILL_TYPE_ORDER="FASION_SKILL_TYPE_ORDER",e.YIYUANLIBAO="YIYUANLIBAO",e.FATE_GOD_COST="FATE_GOD_COST",e.ESCORT_SHUAXIN="ESCORT_SHUAXIN",e.CREATE_GANG_DIAMOND="CREATE_GANG_DIAMOND",e.LADDER_BUFF_PRICE="LADDER_BUFF_PRICE",e.GANG_WAR_BUFF_DIAMOND_COST="GANG_WAR_BUFF_DIAMOND_COST",e.REIN_CALL_BACK="REIN_CALL_BACK",e.SHOP_PLAYER_REFRESH="SHOP_PLAYER_REFRESH",e.FASHION_SKILL_CD="FASHION_SKILL_CD",e.YIJIANZHULING_LV="YIJIANZHULING_LV",e.YIJIANBAOSHI_LV="YIJIANBAOSHI_LV",e.YIJIANJINGMAI_LV="YIJIANJINGMAI_LV",e.YIJIANCHONGWU_LV="YIJIANCHONGWU_LV",e.ARENA_FIGHT_BUY_PRICE="ARENA_FIGHT_BUY_PRICE",e.SEARCH_CHALLENGE_DIAMOND="SEARCH_CHALLENGE_DIAMOND",e.KUAFU_FIGHT_NUM="KUAFU_FIGHT_NUM",e.KUAFU_FIGHT_BUY_PRICE="KUAFU_FIGHT_BUY_PRICE",e.ARENA_REWARD_POINT_SUCC="ARENA_REWARD_POINT_SUCC",e.ARENA_REWARD_POINT_FAIL="ARENA_REWARD_POINT_FAIL",e.CROSSARENA_REWARD_POINT_SUCC="CROSSARENA_REWARD_POINT_SUCC",e.CROSSARENA_REWARD_POINT_FAIL="CROSSARENA_REWARD_POINT_FAIL",e.FIELD_PVP_REWARD_SUCC="FIELD_PVP_REWARD_SUCC",e.FIELD_PVP_REWARD_FAIL="FIELD_PVP_REWARD_FAIL",e.KUAFU_MOBAI="KUAFU_MOBAI",e.KUAFU_BOSS_HUIHE="KUAFU_BOSS_HUIHE",e.KUAFU_BOSS_NUM="KUAFU_BOSS_NUM",e.KUAFU_BOSS_TIME="KUAFU_BOSS_TIME",e.KUAFU_BOSS_BUY="KUAFU_BOSS_BUY",e.XINFA_MAX_NUM="XINFA_MAX_NUM",e.WXGAME_INVITE_FIREND="haoyouyaoqing",e.WXGAME_FIRSTAWD="FIRSTSHAREREWARDS",e.LEIJIXIAOHAO_SCORE="LEIJIXIAOHAO_SCORE",e.LEIJIXIAOHAO_ZHUANPAN="LEIJIXIAOHAO_SHOW",e.FEASTSHOP_REFRESH_MONEY="FEASTSHOP_REFRESH_MONEY",e.FEASTSHOP_OPEN_MONEY="FEASTSHOP_OPEN_MONEY",e.FANGKUAIWAN_HIDE_SHARE="FANGKUAIWAN_HIDE_SHARE",e.FANGKUAIWAN_SHARE_TITLE="FANGKUAIWAN_SHARE_TITLE",e.FANGKUAIWAN_SHARE_PIC="FANGKUAIWAN_SHARE_PIC",e.FANGKUAIWAN_SHARE_QUERY="FANGKUAIWAN_SHARE_QUERY",e.FANGKUAIWAN_IOS_HIDE_PANEL="FANGKUAIWAN_IOS_HIDE_PANEL",e.XYX_MOREGAME_SWITCH="XYX_MOREGAME_SWITCH",e.XYX_CUSTOMSERVICE_SWITCH="XYX_CUSTOMSERVICE_SWITCH",e.XYX_SHOUCANGYOUXI_SWITCH="XYX_SHOUCANGYOUXI_SWITCH",e.BLESS_WAKE_UP_ITEM="BLESS_WAKE_UP_ITEM",e.BLESS_WAKE_UP_PERCENT="BLESS_WAKE_UP_PERCENT",e.TAOZHUANG_MAX="TAOZHUANG_MAX",e.WELCOME_REWARDS="WELCOME_REWARDS",e.VIP_POWER="VIP_POWER",e.RENAME_COST="RENAME_COST",e}();__reflect(Constant.prototype,"Constant");var DupDefine=function(){function e(){}return e.AllPEOPLE_MAX_TIMES=10,e.ALLPEOPLE_SHOWBODY_MAX=20,e.UnionDup_Limit_Time=60,e.TeamDup_Limit_Time=180,e.VipTeam_Limit_Time=180,e.MarryTeam_Limit_Time=180,e.UnionDup_Derate_Rate=20,e.SixiangDup_Npc_Id=188,e.SixiangDup_Drops_Id=[10,11,12,13],e.BlessDup_WarnDist=500,e.BLESSDUP_POINTS=[103,107,111,115,119,123,127,235,239,243,247,251,255,259,367,371,375,379,383,387,391,499,503,507,511,515,519,523,576,631,635,639,643,647,651,655,763,767,771,775,779,783,787,895,899,903,907,911,915,919],e}();__reflect(DupDefine.prototype,"DupDefine");var DUP_TYPE;!function(e){e[e.DUP_PERSONALLY=1]="DUP_PERSONALLY",e[e.DUP_CAILIAO=2]="DUP_CAILIAO",e[e.DUP_CHALLENGE=3]="DUP_CHALLENGE",e[e.DUP_UNION=4]="DUP_UNION",e[e.DUP_SIXIANG=5]="DUP_SIXIANG",e[e.DUP_ZHUFU=6]="DUP_ZHUFU",e[e.DUP_TEAM=7]="DUP_TEAM",e[e.DUP_DIFU=8]="DUP_DIFU",e[e.DUP_XIANSHAN=9]="DUP_XIANSHAN",e[e.DUP_VIP_TEAM=10]="DUP_VIP_TEAM",e[e.DUP_BLESS=11]="DUP_BLESS",e[e.DUP_LINGXING=12]="DUP_LINGXING",e[e.DUP_MARRY=13]="DUP_MARRY",e[e.DUP_MARRY_EQUIP_SUIT_BOSS=14]="DUP_MARRY_EQUIP_SUIT_BOSS"}(DUP_TYPE||(DUP_TYPE={}));var CAILIAO_SUBTYPE;!function(e){e[e.GEM=1]="GEM",e[e.PULSE=2]="PULSE",e[e.PET_LEVEL=3]="PET_LEVEL",e[e.PET_GRADE=4]="PET_GRADE",e[e.CUILIAN=5]="CUILIAN"}(CAILIAO_SUBTYPE||(CAILIAO_SUBTYPE={}));var FightDefine=function(){function e(){}return e.getXgDeathCount=function(){for(var t=0;t<e.YEWAI_XG_DEATHCOUNT.length;t++){var n=e.YEWAI_XG_DEATHCOUNT[t][0];if(n>=GameFight.getInstance().yewaiMapId)return e.YEWAI_XG_DEATHCOUNT[t][1]}return 0},e.getFightJudge=function(t,n,a,i,o,r){return 0>t?-1:n>t?e.JUDGE_MABI:n+a>t?e.JUDGE_CHENMO:n+a+i>t?e.JUDGE_DODGE:n+a+i+o>t?e.JUDGE_CRIT:n+a+i+o+r>t?e.JUDGE_BLOCK:-1},e.Player_ReStart_Delay=[0,0,0],e.Follow_Dictance=[150,300,150],e.Pet_Follow_Dist=333,e.ATTACT_ORDER=[0,2,1],e.FIGHT_RESULT_FAIL=0,e.FIGHT_RESULT_SUCCESS=1,e.FIGHT_RESULT_TIE=2,e.FIGHT_NOT_SERVERREUSLT=-1,e.STORY_TALK_DISTANCE=180,e.TREASURE_TALK_DISTANCE=100,e.PVE_FIRST_MAPID=1,e.PVE_MONSTER_NUM=[[10,3],[30,5],[99999,7]],e.PVE_BOSS_NUM=1,e.PVE_MONSTER_COMID=200,e.PVE_BOSS_COMID=1e3,e.PVE_BOSS_TOTALMODEL=500,e.TOTAL_MONSTER_MODELNUM=18,e.PVP_MAX_NUM=4,e.ALLPEOPLE_REBORN_CD=20,e.SAMSARA_REBORN_CD=60,e.MABI_EFFECT_CD=1e4,e.CHENMO_EFFECT_CD=1e4,e.ladderBuffEffect=[5,10,15,25,35,35],e.BASE_RATIO=1,e.ATTACK_RATIO=.05,e.CRIT_RATIO=2,e.BLOCK_RATIO=.5,e.JUDGE_DODGE=0,e.JUDGE_CRIT=1,e.JUDGE_BLOCK=2,e.JUDGE_MABI=3,e.JUDGE_CHENMO=4,e.JUDGE_POJIA=5,e.JUDGE_XISHOU=6,e.JUDGE_FUHUO=7,e.JUDGE_DUODUAN=1e3,e.JUDEGE_TXT=["闪","暴","招","晕","默","破","吸","活"],e.FIGHT_HP_FACTOR=.4,e.FIGHT_ATTACK_FACTOR=4,e.FIGHT_PHYDEF_FACTOR=2,e.FIGHT_MAGICDEF_FACTOR=2,e.FIGHT_HIT_FACTOR=100,e.FIGHT_DODGE_FACTOR=100,e.FIGHT_BLOCK_FACTOR=50,e.FIGHT_BREAK_FACTOR=50,e.FIGHT_CRIT_FACTOR=50,e.FIGHT_DUCT_FACTOR=50,e.PVPFIGHT_DAMAGE_RATE=5,e.ALLPEOPLE_FIGHT_ROUND=4,e.YEWAI_XG_DEATHCOUNT=[[99999,4]],e}();__reflect(FightDefine.prototype,"FightDefine");var ATTR_TYPE;!function(e){e[e.HP=0]="HP",e[e.ATTACK=1]="ATTACK",e[e.PHYDEF=2]="PHYDEF",e[e.MAGICDEF=3]="MAGICDEF",e[e.HIT=4]="HIT",e[e.DODGE=5]="DODGE",e[e.CRIT=6]="CRIT",e[e.DUCT=7]="DUCT",e[e.BLOCK=8]="BLOCK",e[e.BREAK=9]="BREAK",e[e.SIZE=10]="SIZE"}(ATTR_TYPE||(ATTR_TYPE={}));var TASK_TYPE;!function(e){e[e.Talk=1]="Talk"}(TASK_TYPE||(TASK_TYPE={}));var COLLECTION;!function(e){e[e.Treasure=1]="Treasure"}(COLLECTION||(COLLECTION={}));var TASK_EVENT;!function(e){e[e.COMPLETE=0]="COMPLETE",e[e.Monster_Fight=1]="Monster_Fight",e[e.Treasure=2]="Treasure",e[e.Treasure_PVP=3]="Treasure_PVP",e[e.Talk=4]="Talk",e[e.PVP_Fight=5]="PVP_Fight"}(TASK_EVENT||(TASK_EVENT={}));var FIGHT_SCENE;!function(e){e[e.YEWAI_XG=0]="YEWAI_XG",e[e.YEWAI_BOSS=1]="YEWAI_BOSS",e[e.DUP=2]="DUP",e[e.YEWAIPVP=3]="YEWAIPVP",e[e.ALLPEOPLE_BOSS=4]="ALLPEOPLE_BOSS",e[e.XUEZHAN_BOSS=5]="XUEZHAN_BOSS",e[e.VIP_BOSS=6]="VIP_BOSS",e[e.SAMSARA_BOSS=7]="SAMSARA_BOSS",e[e.LODDER_ARENA=8]="LODDER_ARENA",e[e.UNION_BOSS=9]="UNION_BOSS",e[e.ESCORT=10]="ESCORT",e[e.UNION_BATTLE=11]="UNION_BATTLE",e[e.SERVER_ARENA=12]="SERVER_ARENA",e[e.EXPLORE_BOSS=13]="EXPLORE_BOSS",e[e.THRONE=14]="THRONE",e[e.REVENGE=15]="REVENGE",e[e.LOCAL_ARENA=16]="LOCAL_ARENA",e[e.MYSTERIOUS_BOSS=17]="MYSTERIOUS_BOSS",e[e.DIFU_DUP=18]="DIFU_DUP",e[e.XIANSHAN_BOSS=19]="XIANSHAN_BOSS",e[e.CROSS_PVE_BOSS=20]="CROSS_PVE_BOSS"}(FIGHT_SCENE||(FIGHT_SCENE={}));var FunDefine=function(){function e(){}return e.getXYXFuncIsOpen=function(e){switch(Constant.get(e)){case"RELEASE":return DataManager.isRelease;case"TRIAL":return!DataManager.isRelease;case"OPEN":return!0;case"ALLCLOSE":return!1;default:return!1}},e.getGuideModels=function(e){var t=JsonModelManager.instance.getModelxinshou(),n=[];for(var a in t){var i=t[a];i.jackaroo==e&&n.push(i)}return n},e.funOpenLevel=function(e){var t=JsonModelManager.instance.getModelfunctionLv()[e];return t?t.days>0?LevelDefine.getLevelByOpenDay(t.days):t.level>0?t.level:t.pvpLv>0?t.pvpLv:LevelDefine.getLevelByCoatardlv(t.jingjie):0},e.isFunOpen=function(t){var n=JsonModelManager.instance.getModelfunctionLv()[t];if(n){if(n.isAct>0){var a=JsonModelManager.instance.getModelactivityGroup();for(var i in a){var o=a[i];if(o.panel==n.param&&o.level>DataManager.getInstance().playerManager.player.level)return!1}return DataManager.getInstance().activityManager.getActIsOpen(n.isAct)}return n.logic==e.LOGIC_OR?n.jingjie>0&&n.jingjie<=DataManager.getInstance().playerManager.player.coatardLv?!0:n.level>0&&n.level<=DataManager.getInstance().playerManager.player.level?!0:n.guanqia>0&&n.guanqia<=GameFight.getInstance().yewai_waveIndex?!0:n.pvpLv>0&&n.pvpLv<=DataManager.getInstance().pvpManager.getCurrLevel()?!0:n.days>0&&this.checkLoginCondition(n.days)?!0:n.vip>0&&n.vip<=DataManager.getInstance().playerManager.player.viplevel?!0:!1:n.jingjie>DataManager.getInstance().playerManager.player.coatardLv?!1:n.level>DataManager.getInstance().playerManager.player.level?!1:n.guanqia>GameFight.getInstance().yewai_waveIndex?!1:n.pvpLv>DataManager.getInstance().pvpManager.getCurrLevel()?!1:this.checkLoginCondition(n.days)?n.vip>DataManager.getInstance().playerManager.player.viplevel?!1:!0:!1}return!0},e.onIsLockandErrorHint=function(t){var n=DataManager.getInstance().playerManager.player,a=JsonModelManager.instance.getModelfunctionLv()[t];if(a&&!this.isFunOpen(t)){if(a.isAct>0)PromptPanel.getInstance().addPromptError(Language.instance.getText("activity","unopen"));else{var i=a.logic==e.LOGIC_OR?"OR":"AND",o=a.logic==e.LOGIC_OR?2:1,r=[];a.jingjie>n.coatardLv&&r.length<o&&r.push(Language.instance.getText("coatard_level"+a.jingjie)),0!=a.vip&&n.viplevel<a.vip&&r.length<o&&r.push(Language.instance.parseInsertText("vipkaiqi",a.vip)),a.level>n.level&&r.length<o&&r.push(Language.instance.parseInsertText("dengjikaiqi",a.level)),0!=a.guanqia&&GameFight.getInstance().yewai_waveIndex<a.guanqia&&r.length<o&&r.push(Language.instance.parseInsertText("zhangjiedadao",a.guanqia)),0!=a.days&&!this.checkLoginCondition(a.days)&&r.length<o&&r.push(Language.instance.parseInsertText("dijitian",a.days)),0!=a.pvpLv&&a.pvpLv>DataManager.getInstance().pvpManager.getCurrLevel()&&r.push("战功"+a.pvpLv+"级");for(var s="",h=0;h<r.length;h++)h>0&&(s+=Language.instance.getText(i)),s+=Language.instance.getText(r[h]);s+=Language.instance.getText("open"),PromptPanel.getInstance().addPromptError(s)}return!0}return!1},e.getFunOpenDesc=function(e){var t="",n=JsonModelManager.instance.getModelfunctionLv()[e];return n&&(n.jingjie>0?t=Language.instance.getText("coatard_level"+n.jingjie,"jingjie","open"):0!=n.guanqia?t=Language.instance.parseInsertText("dijiguan",n.guanqia)+Language.instance.getText("open"):n.level>0?t=n.level+Language.instance.getText("level","open"):0!=n.days&&(t=Language.instance.parseInsertText("dijitian",n.days)+Language.instance.getText("open"))),t},e.checkLoginCondition=function(e){if(0!=e){var t=DataManager.getInstance().playerManager.player,n=Tool.formatZeroDate(new Date(DataManager.getInstance().playerManager.player.createTime)).getTime(),a=Tool.formatZeroDate(new Date(t.currentTime+(egret.getTimer()-t.signTime))).getTime(),i=(a-n)/864e5+1;if(e>i)return!1}return!0},e.checkFunOpenRedPoint=function(){var e=JsonModelManager.instance.getModelfunctionLv();for(var t in e){var n=e[t];if(n.functionType>0&&this.isFunOpen(n.id)&&!DataManager.getInstance().playerManager.getFunIsAwarded(n.id))return!0}return!1},e.DupFulingbossPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_FULINGBOSS))return!1;var t=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_LINGXING,1),n=t?t.lefttimes:0;return n>0?!0:!1},e.DupZhuXianBossTimes=function(){if(!e.isFunOpen(FUN_TYPE.FUN_BLESSDUP))return!1;var t=DataManager.getInstance().newactivitysManager.blessTp,n=JsonModelManager.instance.getModelpeishiboss()[t];if(n){var a=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_BLESS,n.id),i=a?a.lefttimes:0;if(i>0)return!0}return!1},e.DupCailiaoHasTimes=function(){DataManager.getInstance().playerManager.player;if(!e.isFunOpen(FUN_TYPE.FUN_DUP_CAILIAO))return!1;for(var t=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_CAILIAO),n=0;n<t.length;n++){var a=t[n];switch(a.subtype){case 1:if(a.diffcult>0&&a.lefttimes>0)return!0;break;case 2:if(a.diffcult>0&&a.lefttimes>0)return!0;break;case 5:if(a.diffcult>0&&a.lefttimes>0)return!0;break;default:if(a.lefttimes>0)return!0}}return!1},e.DupChallengeHasTimes=function(){if(!this.getDupHasTimes(DUP_TYPE.DUP_CHALLENGE))return!1;var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_CHALLENGE)[0],t=JsonModelManager.instance.getModelzhuxiantai()[e.pass];if(!t)return!1;var n=ModelManager.getInstance().getModelFigher(t.fightId);return t&&DataManager.getInstance().playerManager.player.getPlayerData().figthPower>=n.power?!0:!1},e.BlessDupRedPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_DUP_ZHUFU))return!1;var t=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_ZHUFU)[0];return t.awardIndex<t.pass-1?!0:this.getDupHasTimes(DUP_TYPE.DUP_ZHUFU)?!0:!1},e.SixiangDupRedPoint=function(){if(this.getDupHasTimes(DUP_TYPE.DUP_SIXIANG))return!0;for(var e,t=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0],n=ModelManager.getInstance().getModelLength("sixiangfuben"),a=t.awardIndex+1;n>=a;a++){var i=JsonModelManager.instance.getModelsixiangfuben()[a];if(i.firstRewards){e=i;break}}return e&&e.id<=t.pass?!0:!1},e.getDupHasTimes=function(t){if(!e.isFunOpen(FUN_TYPE.FUN_DUP_ZUDUI))return!1;var n=0;switch(t){case DUP_TYPE.DUP_CAILIAO:n=FUN_TYPE.FUN_DUP_CAILIAO;break;case DUP_TYPE.DUP_CHALLENGE:n=FUN_TYPE.FUN_DUP_TIAOZHAN;break;case DUP_TYPE.DUP_SIXIANG:n=FUN_TYPE.FUN_DUP_SIXIANG;break;case DUP_TYPE.DUP_TEAM:n=FUN_TYPE.FUN_DUP_ZUDUI;break;case DUP_TYPE.DUP_ZHUFU:n=FUN_TYPE.FUN_DUP_ZHUFU}if(this.isFunOpen(n)){var a=0;switch(t){case DUP_TYPE.DUP_CHALLENGE:a=FUN_TYPE.FUN_DUP_TIAOZHAN;break;case DUP_TYPE.DUP_ZHUFU:a=FUN_TYPE.FUN_DUP_ZHUFU;break;case DUP_TYPE.DUP_TEAM:a=FUN_TYPE.FUN_DUP_ZUDUI;break;case DUP_TYPE.DUP_SIXIANG:a=FUN_TYPE.FUN_DUP_SIXIANG}if(0==a)return!1;if(!e.isFunOpen(a))return!1;var i=DataManager.getInstance().dupManager.getDupInfolistByType(t)[0];return i.lefttimes>0?!0:!1}},e.getGerenBossRedPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_GEREN_BOSS))return!1;var t=JsonModelManager.instance.getModelgerenboss();for(var n in t){var a=t[n];if(this.getPersonallyBossHasTimes(a.id))return!0}return!1},e.getPersonallyBossHasTimes=function(e){var t=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_PERSONALLY,e);if(t)return t.gerenModel.jingjie>DataManager.getInstance().playerManager.player.coatardLv?!1:t&&t.lefttimes>0?!0:!1},e.checkMagicRed=function(){return e.isFunOpen(FUN_TYPE.FUN_FABAO)&&e.checkMagicUpRed()?!0:!1},e.checkMagicUpRed=function(){return!1},e.getTabRolePoint=function(){return this.getRoleEquipPoint()?!0:this.getWuxingRedPoint()?!0:!1},e.getRoleEquipPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_EQUIP))return!1;if(DataManager.getInstance().legendManager.getAllCanLegendAdvance())return!0;for(var t=0;t<DataManager.getInstance().playerManager.player.playerDatas.length;t++)if(this.getJobEquipPoint(DataManager.getInstance().playerManager.player.getPlayerData(t).occupation))return!0;return!1},e.getJobEquipPoint=function(e){var t=DataManager.getInstance().bagManager.getJobClothEquips(0);return t.length>0?!0:!1},e.getRebirthPoint=function(){if(this.getCanRebirth())return!0;var e=DataManager.getInstance().rebirthManager;for(var t in e.record)if(this.getOneTypeRebirthPoint(parseInt(t)))return!0;return!1},e.getOneTypeRebirthPoint=function(e){var t=DataManager.getInstance().rebirthManager,n=DataManager.getInstance().playerManager.player,a=t.record[e],i=0;switch(a.type){case GOODS_TYPE.SHOW:if(i=DataManager.getInstance().playerManager.player.remainExchageVigourTime,n.level>LevelDefine.ZS_ORIGIN_LEVEL&&i>0)return!0;break;case GOODS_TYPE.BOX:var o=DataManager.getInstance().bagManager.getGoodsThingNumById(a.modelID,a.type),r=DataManager.getInstance().bagManager.getUseLimitNumByID(a.modelID),s=JsonModelManager.instance.getModelbox()[a.modelID];if(i=s.useMax-r,o>0&&i>0)return!0}return!1},e.getCanRebirth=function(){return!1},e.setBlessPillLock=function(e,t,n,a,i,o,r,s){if(void 0===a&&(a="lock"),void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=1),void 0===s&&(s=1),e){var h=n.getChildByName(a);h&&n.removeChild(h)}else if(null==n.getChildByName(a)){var l=new eui.Component;l.x=i,l.y=o,l.name=a,l.scaleX=r,l.scaleY=s,l.touchEnabled=!1,n.addChild(l);var g=new eui.Image;g.source="public_fun_lock_png",l.addChild(g);var c=new eui.Label;c.text=Language.instance.parseInsertText("jiekaiqi",t),c.fontFamily="SimHei",c.textColor=16777215,c.size=20,c.bold=!1,c.strokeColor=0,c.stroke=0,c.alpha=1,c.anchorOffsetX=c.width/2,c.anchorOffsetY=c.height/2,c.x=57,c.y=70,l.addChild(c),g.name=t.toString(),g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBlessPillLockClick,this)}},e.getGemLotteryRed=function(){return DataManager.getInstance().forgeManager.gemlotteryFreeTimes>0?!0:!1},e.onBlessPillLockClick=function(e){var t=e.currentTarget;PromptPanel.getInstance().addPromptError(Language.instance.parseInsertText("jiekaiqi",t.name))},e.getPsychPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_YUANSHEN))return!1;for(var t=DataManager.getInstance().psychManager,n=0;n<GameDefine.Max_Role_Num;n++)if(t.getIndexPsychPoint(n))return!0;return!1},e.checkSixiangPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_SIXIANG))return!1;for(var t=0;t<Fourinages_Type.SIZE;t++)if(this.checkSixiangUplevelBySlot(t))return!0;return!1},e.checkSixiangUplevelBySlot=function(t,n){if(void 0===n&&(n=0),!e.isFunOpen(FUN_TYPE.FUN_SIXIANG))return!1;var a=DataManager.getInstance().playerManager.player.getPlayerData(n);if(!a)return!1;var i=a.fourinages[t].level,o=JsonModelManager.instance.getModelsixiang()[t],r=o[i];if(!r)return!1;var s=DataManager.getInstance().bagManager.getGoodsThingNumById(r.cost.id,r.cost.type);return s>=r.cost.num?!0:!1},e.getJobBetterEquip=function(e){var t=DataManager.getInstance().bagManager.getJobClothEquips(0);return t.length>0?t[0]:null},e.getWuxingRedPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_WUXING))return!1;var t=DataManager.getInstance().playerManager.player,n=t.getPlayerData().wuxingLevel,a=JsonModelManager.instance.getModelwuxing(),i=(a[n],a[n+1]);return i&&t.getICurrency(i.cost.type)>=i.cost.num?!0:!1},e.checkTujianRedPointByClass=function(e){var t=JsonModelManager.instance.getModeltujian()[e];if(!t)return!1;var n=DataManager.getInstance().playerManager.player.getPlayerData().tujianDataDict[e],a=n?n.level:0;if(GameDefine.Tujian_MAX_Lv<=a)return!1;var i=t.cost.num+Tool.toInt(a/5),o=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id,t.cost.type);return o>=i?!0:!1},e.checkTujianRedPointByType=function(e){var t=JsonModelManager.instance.getModeltujian();for(var n in t){var a=t[n];if(a.type==e&&this.checkTujianRedPointByClass(a.id))return!0}return!1},e.checkTujianRedPointAll=function(){var e=JsonModelManager.instance.getModeltujian();for(var t in e){var n=e[t];if(this.checkTujianRedPointByClass(n.id))return!0}return!1},e.checkYewaiBossPoint=function(){if(GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)return!1;if(GameSetting.getLocalSetting(GameSetting.YEWAI_AUTO_FIGHT))return!1;var e=(GameFight.getInstance().fightScene,GameFight.getInstance().fightScene.rushData.progress),t=Math.min(e,GameFight.getInstance().yewai_batch);return t>=e},e.getQianghuaCanGuide=function(){if(GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)return!1;GameFight.getInstance().fightScene;return DataManager.getInstance().forgeManager.getIntensifyPointShow()},e.getRonglianCanGuide=function(){if(GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)return!1;var e=(GameFight.getInstance().fightScene,DataManager.getInstance().bagManager.getEquipListCanSmelt());return e.length>=5?!0:!1},e.getSkillCanGuide=function(){if(GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)return!1;for(var e=(GameFight.getInstance().fightScene,DataManager.getInstance().playerManager.player.getPlayerData()),t=0;t<e.skills.length;++t){var n=e.skills[t];if(DataManager.getInstance().skillManager.checkSkillUp(n.id))return!0}return!1},e.getClothCanGuide=function(){if(GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)return!1;GameFight.getInstance().fightScene;return this.getRoleEquipPoint()},e.checkNeedMountGuide=function(){var e=DataManager.getInstance().blessManager.getPlayerBlessData(BLESS_TYPE.HORSE);return 0==e.grade},e.checkQihunRedPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_QIHUN))return!1;var t=DataManager.getInstance().playerManager.player,n=t.getPlayerData().qihun,a=JsonModelManager.instance.getModelqihun(),i=(a[n],a[n+1]);if(i&&i.coatardLimit<=t.coatardLv){var o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.cost.id,i.cost.type);if(o>=i.cost.num)return!0}return!1},e.getAllPeopleBossRedPoint=function(){if(!e.isFunOpen(FUN_TYPE.FUN_QUANMIN_BOSS))return!1;if(DataManager.getInstance().dupManager.allpeoplebossData.lefttimes<=0)return!1;var t,n,a=JsonModelManager.instance.getModelquanminboss();for(var i in a)if(n=a[i],!(n.limitLevel>DataManager.getInstance().playerManager.player.coatardLv)&&(t=DataManager.getInstance().dupManager.allpeoplebossData.infos[n.id],t&&t.isOpen))return!0;return!1},e.getSamsaraBossBackAwdRPoint=function(){return DataManager.getInstance().dupManager.samsarebossData.hasbackaward&&e.isFunOpen(FUN_TYPE.FUN_ZHUANSHENG_BOSS)
},e.getCrossServerPoint=function(){return this.getCrossArenaPoint()?!0:this.getCrossPVEBOSSPoint()?!0:!1},e.getCrossArenaPoint=function(){return e.isFunOpen(FUN_TYPE.FUN_SERVERFIGHT_ARENA)&&DataManager.getInstance().arenaManager.arenaData.isOpen?DataManager.getInstance().arenaManager.arenaData.fightCount>0:!1},e.getCrossPVEBOSSPoint=function(){return e.isFunOpen(FUN_TYPE.FUN_SERVERPVEBOSS)&&DataManager.getInstance().dupManager.crossPVEBoss.isOpen?DataManager.getInstance().dupManager.crossPVEBoss.fightcount>0:!1},e.FUN_GUIDE_TESTIDS=[],e.LOGIC_OR=0,e.LOGIC_AND=1,e.isLadderOpen=!1,e.isSamsaraOpen=!1,e}();__reflect(FunDefine.prototype,"FunDefine");var FUN_TYPE;!function(e){e[e.FUN_HUANZHUANG=14e3]="FUN_HUANZHUANG",e[e.FUN_LINGZHANG=15e3]="FUN_LINGZHANG",e[e.FUN_BAOQI=16e3]="FUN_BAOQI",e[e.FUN_YUYI=17e3]="FUN_YUYI",e[e.FUN_FAZUO=18e3]="FUN_FAZUO",e[e.FUN_PVE=1]="FUN_PVE",e[e.FUN_ROLE=2]="FUN_ROLE",e[e.FUN_SKILL=3]="FUN_SKILL",e[e.FUN_PULSE=4]="FUN_PULSE",e[e.FUN_SIXIANG=5]="FUN_SIXIANG",e[e.FUN_FASHION=6]="FUN_FASHION",e[e.FUN_TITLE=7]="FUN_TITLE",e[e.FUN_EQUIP=8]="FUN_EQUIP",e[e.FUN_SHENZHUANG=9]="FUN_SHENZHUANG",e[e.FUN_SHENBING=10]="FUN_SHENBING",e[e.FUN_FABAO=11]="FUN_FABAO",e[e.FUN_XIANYU=12]="FUN_XIANYU",e[e.FUN_MOUNT=13]="FUN_MOUNT",e[e.FUN_QIANGHUA=14]="FUN_QIANGHUA",e[e.FUN_BAOSHI=15]="FUN_BAOSHI",e[e.FUN_ZHULING=16]="FUN_ZHULING",e[e.FUN_LIANHUA=17]="FUN_LIANHUA",e[e.FUN_CUILIAN=18]="FUN_CUILIAN",e[e.FUN_EQUIPBAG=19]="FUN_EQUIPBAG",e[e.FUN_ITEMBAG=20]="FUN_ITEMBAG",e[e.FUN_EQUIP_SMELT=21]="FUN_EQUIP_SMELT",e[e.FUN_BLESS_SMELT=22]="FUN_BLESS_SMELT",e[e.FUN_JINGJIE=23]="FUN_JINGJIE",e[e.FUN_JIANCHI=24]="FUN_JIANCHI",e[e.FUN_SHENQI=25]="FUN_SHENQI",e[e.FUN_GEREN_BOSS=26]="FUN_GEREN_BOSS",e[e.FUN_QUANMIN_BOSS=27]="FUN_QUANMIN_BOSS",e[e.FUN_ZHUANSHENG_BOSS=28]="FUN_ZHUANSHENG_BOSS",e[e.FUN_YEWAIPVP=29]="FUN_YEWAIPVP",e[e.FUN_DUJIE=30]="FUN_DUJIE",e[e.FUN_LADDER=31]="FUN_LADDER",e[e.FUN_ARENA=32]="FUN_ARENA",e[e.FUN_DUP_CAILIAO=33]="FUN_DUP_CAILIAO",e[e.FUN_DUP_ZHUFU=34]="FUN_DUP_ZHUFU",e[e.FUN_DUP_ZUDUI=35]="FUN_DUP_ZUDUI",e[e.FUN_DUP_TIAOZHAN=36]="FUN_DUP_TIAOZHAN",e[e.FUN_DUP_SIXIANG=37]="FUN_DUP_SIXIANG",e[e.FUN_DUP_XUEZHAN=38]="FUN_DUP_XUEZHAN",e[e.FUN_HONGZHUANG=39]="FUN_HONGZHUANG",e[e.FUN_SHANGGU=40]="FUN_SHANGGU",e[e.FUN_ANJIN=41]="FUN_ANJIN",e[e.FUN_PET_LEVEL=42]="FUN_PET_LEVEL",e[e.FUN_PET_GRADE=43]="FUN_PET_GRADE",e[e.FUN_UNION_HALL=44]="FUN_UNION_HALL",e[e.FUN_SHOP_SHENMI=51]="FUN_SHOP_SHENMI",e[e.FUN_SHOP_JIFEN=52]="FUN_SHOP_JIFEN",e[e.FUN_SHOP_PUTONG=53]="FUN_SHOP_PUTONG",e[e.FUN_SHOP_RONGYU=54]="FUN_SHOP_RONGYU",e[e.FUN_BAOSHIFUBEN=55]="FUN_BAOSHIFUBEN",e[e.FUN_JINGMAIFUBEN=56]="FUN_JINGMAIFUBEN",e[e.FUN_CUILIANFUBEN=57]="FUN_CUILIANFUBEN",e[e.FUN_CHONGFUBEN=58]="FUN_CHONGFUBEN",e[e.FUN_BLESS_EQUIP=59]="FUN_BLESS_EQUIP",e[e.FUN_BLESS_EQUIP_QIANGHUA=60]="FUN_BLESS_EQUIP_QIANGHUA",e[e.FUN_YUANSHEN=61]="FUN_YUANSHEN",e[e.FUN_DRAGONSOUL=62]="FUN_DRAGONSOUL",e[e.FUN_FIGHTSPRITE=63]="FUN_FIGHTSPRITE",e[e.FUN_LOTTERY=64]="FUN_LOTTERY",e[e.FUN_XUEZHANBOSS=69]="FUN_XUEZHANBOSS",e[e.FUN_WUXING=70]="FUN_WUXING",e[e.FUN_TOPRANK=71]="FUN_TOPRANK",e[e.FUN_MONTHCARD=72]="FUN_MONTHCARD",e[e.FUN_QIHUN=73]="FUN_QIHUN",e[e.FUN_ZHUANPAN=74]="FUN_ZHUANPAN",e[e.FUN_UNION_BOSS_FAM=75]="FUN_UNION_BOSS_FAM",e[e.FUN_UNION_BOSS_SUMMON=76]="FUN_UNION_BOSS_SUMMON",e[e.FUN_VIP_GIFTSHOP=78]="FUN_VIP_GIFTSHOP",e[e.FUN_XIANSHAN=81]="FUN_XIANSHAN",e[e.FUN_VIPTEAM=83]="FUN_VIPTEAM",e[e.FUN_SERVERFIGHT_ARENA=84]="FUN_SERVERFIGHT_ARENA",e[e.FUN_SERVERPVEBOSS=85]="FUN_SERVERPVEBOSS",e[e.FUN_FULINGBOSS=86]="FUN_FULINGBOSS",e[e.FUN_BLESSDUP=88]="FUN_BLESSDUP",e[e.FUN_RNUES=89]="FUN_RNUES",e[e.FUN_RNUES_DUP=90]="FUN_RNUES_DUP",e[e.FUN_SHENGWANGSHOP=96]="FUN_SHENGWANGSHOP",e[e.FUN_TIANSHU_LEVEL_DUP=99]="FUN_TIANSHU_LEVEL_DUP",e[e.FUN_TIANSHU=100]="FUN_TIANSHU",e[e.FUN_TIANSHU_TUPO=101]="FUN_TIANSHU_TUPO",e[e.FUN_YUANJIE=102]="FUN_YUANJIE",e[e.FUN_WUTAN=103]="FUN_WUTAN",e[e.FUN_SKILLENCHANT=104]="FUN_SKILLENCHANT",e[e.FUN_XIANFENG=105]="FUN_XIANFENG",e[e.FUN_ZHANGONG_RECORD=106]="FUN_ZHANGONG_RECORD",e[e.FUN_JUBAOPEN=107]="FUN_JUBAOPEN",e[e.FUN_CHONGBANG=108]="FUN_CHONGBANG",e[e.FUN_SHENQI_CHOUQIAN=109]="FUN_SHENQI_CHOUQIAN",e[e.FUN_XIANLV_EQUIP_DUP=117]="FUN_XIANLV_EQUIP_DUP",e[e.FUN_MARRY=118]="FUN_MARRY",e[e.FUN_MARRY_DUP=119]="FUN_MARRY_DUP",e[e.FUN_MARRY_EQUIP_SUIT_DUP=120]="FUN_MARRY_EQUIP_SUIT_DUP",e[e.FUN_MARRY_EQUIP_SUIT_BOSS=121]="FUN_MARRY_EQUIP_SUIT_BOSS",e[e.FUN_OPENFUNC=1001]="FUN_OPENFUNC"}(FUN_TYPE||(FUN_TYPE={}));var ARTIFACT_TYPE;!function(e){e[e.HORSE=0]="HORSE",e[e.WEAPON=1]="WEAPON",e[e.CLOTHES=2]="CLOTHES",e[e.WING=3]="WING",e[e.MAGIC=4]="MAGIC"}(ARTIFACT_TYPE||(ARTIFACT_TYPE={}));var GameDefine=function(){function e(){}return e.getAttrPlusKey=function(e){return this.ATTR_OBJ_KEYS[e-this.ATTR_OBJ_KEYS.length]+"plus"},e.GAME_STAGE_WIDTH=600,e.GAME_STAGE_HEIGHT=1080,e.Define_Move_Speed=250,e.Attack_Move_Speed=100,e.XG_Move_Speed=50,e.PET_Move_Speed=50,e.MAGIC_Move_Speed=50,e.Jackaroo_Move_Speed=400,e.CHONGFENG_SPEED=1200,e.PLAYER_JUMP_DIST=1200,e.Cover_Alpha_Value=.6,e.Max_Role_Num=1,e.WEEK_DAY=7,e.JACKAROO_AVATAR=[11],e.JACKAROO_GUIDE_NUM=3,e.PLAYER_DEFUALT_AVATAR=[0,0,0,-1,-1],e.SMELT_EQUIPS_NUM=50,e.ATTR_OBJ_KEYS=["hp","attack","phyDef","magicDef","hit","dodge","crit","duct","block","counter"],e.GAME_ADD_RATIO=1e4,e.Max_Role_Head=6,e.MASSAGE_FAIL_MAX=3,e.Equip_Slot_Num=10,e.Equip_Cuilian_Max=10,e.QIANGHUA_MAX=1e3,e.GEM_SLOT_NUM=5,e.Dominate_Slot_Num=4,e.Psych_Slot_Num=7,e.Tujian_MAX_Lv=50,e.OPEN_AutoFight_Wave=7,e.UnionDup_Boss_Node=148,e.LADDER_FIGHTCOUNT_MAX=12,e.Local_Arena_Enemy_Max=5,e.Arena_Enemy_Max=4,e.Xuezhan_LayerWaveNum=3,e.Xuezhan_Dupid=12,e.Xuezhan_Attr_Icons=["gong","fang","xue","ming","shan","zhao","po","bao","ren"],e.VIP_BOX_ID=32,e.Dir_All_Ary=[Direction.DOWN,Direction.LEFT,Direction.LEFTDOWN,Direction.LEFTUP,Direction.RIGHT,Direction.RIGHTDOWN,Direction.RIGHTUP,Direction.UP],e.Attr_Name=[],e.Attr_FontName=["生命","攻击","物防","法防","命中","闪避","暴击","抗暴","招架","破招"],e.BlessName=["飞剑","神兵","神装","法宝","仙羽"],e.Attr_After_Color=5963665,e.InitiativeSkill=[1,2,3,4],e.PassivitySkill=[10001,10002,10003,10009,10008,10006,10007,10004,10005],e.Explore_Monsters=[16018,16019,16020,16021,16022,16023,16024,16025],e.Enjoy_WorldBoss_Num=20,e.WorldBoss_PlayerNum=5,e.WorldBoss_CD_Time=3e4,e.WorldBoss_RankMax=10,e.BodyChat_ShowTime=5e3,e.Shentong_MaxSlot=8,e.Shentong_Open_XZLevel=[1,3,4,5,6,8,10,12],e.Domiante_IDs=[15,16,17,18],e.Domiante_decomposeNum=5,e.Domiante_decomposeID=19,e.Dominate_Slot_func=[73,74,75,76],e.Domiante_Advance_needID=20,e.Domiante_Advance_needNum=20,e.Domiante_Advance_add=1.25,e.Chinese_Number_Ary=["","一","二","三","四","五","六","七","八","九"],e.Chinese_Company_Ary=["零","十","百","千","万","十万","百万","千万","亿"],e.ShenTong_MaxNum=8,e.ShenTong_Restore_Qulity=[4e3,1e4,2e4,4e4,8e4,16e4],e.MAX_PULSE=8,e.MAX_TIER=9,e.MAX_ACUPOINT=10,e.HINT_PRIORITY=[13,14,15,16,17],e.PSYCH_OPEN_LV=[35,35,40,45,50,60,70,80,90,100],e.FORGE_SMELT_QUALITY_VALUE=[10,15,20,40],e.SHIELD_TXT_HINT=!1,e.FANGKUAI_FIRST_SHARE_LV=20,e.CELESTIAL_EQUIP_SLOTS=[20,21,22,23],e.CELESTIAL_EQUIP_ADVANCE_CONS_ID=141,e.RED_TAB_BTN_POS=new egret.Point(50,5),e.RED_MAIN_POS=new egret.Point(55,5),e.RED_TAB_POS=new egret.Point(80,-10),e.RED_BTN_POS=new egret.Point(145,-10),e.RED_BTN_POS_YELLOW_LITTLE=new egret.Point(151,-10),e.RED_BTN_SIXIANG=new egret.Point(50,15),e.RED_CRICLE_STAGE_PRO=new egret.Point(50,5),e.RED_EQUIP_SLOT=new egret.Point(125,8),e.RED_TUJIAN_SLOT=new egret.Point(140,10),e.RED_BTN_ACTIVITY_POS=new egret.Point(153,0),e.RED_MAIN_II_POS=new egret.Point(35,0),e.RED_MAIN_BTN_POS=new egret.Point(65,-10),e.RED_GOODSINSTANCE_POS=new egret.Point(80,-5),e.RED_ROLE_EQUIP_BOTTOM_POS=new egret.Point(60,15),e.RED_FASHION_ITEM_POS=new egret.Point(70,-5),e.Pass_Wave_Num=10,e.EQUIP_QUALITE_NAME=["白色","绿色","蓝色","紫色","橙色","诛仙","伏魔"],e.EQUIP_QUALITE_NAME1=["白","绿","蓝","紫","橙","红","暗金"],e.UNION_TURNPLATE_GAINID=17,e.DISCOUNT_GOODS=["零折","一折","二折","三折","四折","五折","六折","七折","八折","九折"],e.LONGHUAN_ATTR=[0,1,2,3],e.LONGHUN_GOODS_ID=56,e.LONGHUN_GOODS_NUM=5,e.LONGHUN_DIAMOND_NUM=20,e.EQUIP_SMELTS=[50,100,200,400,1e3,0,0],e.ALL_SMELTS_VIPLEVEL=4,e.PET_ATTR=[0,1,2,3],e.PET_GOODS_ID=468,e.PET_GOODS_NUM=5,e.PET_DIAMOND_NUM=500,e.FULING_ATTR=[0,1,2,3,6,7],e.WUXIN_NUM=5,e.YUANJIE_ATTR=[0,1,2,3],e.UNION_TURNPLATE_SHOW="3,73,1#3,72,1#3,69,1#3,19,1#2,2,5#2,14,5#2,1,100",e.MIN_GOLD_COATARD_LV=6,e.Fate_Slot_Num=21,e.ZHUANSHENG_PLUS=[0,500,1e3,2e3,4e3],e}();__reflect(GameDefine.prototype,"GameDefine");var SEX_TYPE;!function(e){e[e.MALE=0]="MALE",e[e.FEMALE=1]="FEMALE"}(SEX_TYPE||(SEX_TYPE={}));var NpcBody=function(e){function t(){var t=e.call(this)||this;return t.waitIntervalId=-1,t}return __extends(t,e),t.prototype.onInitBodyHead=function(){e.prototype.onInitBodyHead.call(this),this.bodyHead.hpProBarSkinName(skins.Npc_HpProBar_Skin)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){egret.superSetter(t,this,"data",e)},enumerable:!0,configurable:!0}),t.prototype.onRefreshData=function(){e.prototype.onRefreshData.call(this)},t.prototype.updateAction=function(){this.onChangeBody()},t.prototype.updateDirection=function(){},t.prototype.onChangeBody=function(){if(this._data&&this._data.modelId){var e=LoadManager.getInstance().getNpcResUrl(this._data.modelId,this.actionName);this._body?this._body.onUpdateRes(e,this._actionPlayNum,null):(this._body=new BodyAnimation(e,this._actionPlayNum,null),this.bodyLayer.addChildAt(this._body,PLAYER_LAYER.BODY))}},t.prototype.onScaleHandler=function(e){this._body&&(this._body.scaleX=Tool.isNumber(e)?e:1,this._body.scaleY=Tool.isNumber(e)?e:1)},t.prototype.onBodyWaiting=function(e,t,n,a,i){void 0===a&&(a=""),void 0===i&&(i=skins.HpProgressBar1),this.waitBar||(this.waitBar=new eui.Component,this.waitBar.skinName=skins.BodyHead,this.topLayer.addChild(this.waitBar),this.waitBar.x=this.bodyHead.x,this.waitBar.y=this.bodyHead.y,this.waitBar.hpBar.maximum=100,this.bodyHead.visible=!1),this.waitIntervalId>=0&&(egret.clearTimeout(this.waitIntervalId),this.waitIntervalId=-1),this.waitBar.nameLabel.text=a,this.waitBar.hpBar.skinName=i,this.waitBar.hpBar.slideDuration=0,this.waitBar.hpBar.value=0,this.waitBar.hpBar.slideDuration=e,this.waitBar.hpBar.value=100,this.waitIntervalId=Tool.callbackTime(this.onWaitComplete,this,e,t,n)},t.prototype.onWaitComplete=function(e,t){this.waitBar&&(this.waitBar.removeChildren(),this.waitBar.parent&&this.waitBar.parent.removeChild(this.waitBar),this.waitBar=null),this.bodyHead.visible=!0,egret.clearTimeout(this.waitIntervalId),this.waitIntervalId=-1,Tool.callback(e,t)},t.prototype.onReset=function(){e.prototype.onReset.call(this),this.scaleX=1,this.scaleY=1},t}(ActionBody);__reflect(NpcBody.prototype,"NpcBody");var NPC_BODY_TYPE;!function(e){e[e.NONE=0]="NONE",e[e.JACKAROO1=1]="JACKAROO1",e[e.JACKAROO2=2]="JACKAROO2",e[e.JACKAROO3=3]="JACKAROO3",e[e.SIXIANG=3]="SIXIANG"}(NPC_BODY_TYPE||(NPC_BODY_TYPE={}));var HallActivityDefine=function(){function e(){}return e.ACTIVITY_ICON={1e4:"hall_btn_cdKey_png",1:"hall_btn_totalRecharge_png",2:"hall_btn_rebate_png",3:"hall_btn_invest_png",4:"hall_btn_tlShop_png",5:"hall_btn_turnplate_png",6:"hall_btn_tlGift_png",8:"hall_btn_vipTLGift_png",9:"hall_btn_vipTLShop_png"},e}();__reflect(HallActivityDefine.prototype,"HallActivityDefine");var LegendDefine=function(){function e(){}return e.getLegendRatio=function(e,t){var n=0,a=JsonModelManager.instance.getModelshenqi()[e][t-1];return a&&(n=a.gailv),n},e.getLegendEffect=function(e,t){var n=0,a=JsonModelManager.instance.getModelshenqi()[e][t-1];return a&&(n=a.xiaoguo),n},e.getLegendDesc=function(e,t,n){var a=new Array,i=JsonModelManager.instance.getModelshenqi()[e][t];if(n){if(!i)return a;switch(e){case 1:a.push({text:"每一次攻击有"}),a.push({text:Tool.toInt(i.gailv/100).toString(),style:{textColor:65280}}),a.push({text:"%的概率造成对方眩晕，持续"}),a.push({text:(i.xiaoguo/1e3).toString(),style:{textColor:65280}}),a.push({text:"秒"});break;case 2:a.push({text:"死亡后自动复活，恢复最大生命值的"}),a.push({text:Tool.toInt(i.xiaoguo/100).toString(),style:{textColor:65280}}),a.push({text:"%"});break;case 3:a.push({text:"直接忽视对方防御，对其额外造成自身攻击力"}),a.push({text:(i.xiaoguo/100).toString(),style:{textColor:65280}}),a.push({text:"%的伤害"});break;case 4:a.push({text:"增加一层护盾状态，有效吸收对方"}),a.push({text:(i.xiaoguo/100).toString(),style:{textColor:65280}}),a.push({text:"%的伤害"});break;case 5:a.push({text:"每一次攻击有"}),a.push({text:Tool.toInt(i.gailv/100).toString(),style:{textColor:65280}}),a.push({text:"%的概率造成对方沉默，只能释放基础剑法持续"}),a.push({text:(i.xiaoguo/1e3).toString(),style:{textColor:65280}}),a.push({text:"秒"})}}else{var o="",r=void 0,s=void 0;if(i?(r=i.xiaoguo,s=i.gailv):(i=JsonModelManager.instance.getModelshenqi()[e][0],r=0,s=0),i)switch(e){case 1:o="每一次攻击有"+Tool.toInt(s/100)+"%的概率造成对方眩晕，持续"+r/1e3+"秒";break;case 2:o="死亡后自动复活，恢复最大生命值的"+Tool.toInt(r/100)+"%";break;case 3:o="直接忽视对方防御，对其额外造成自身攻击力"+r/100+"%的伤害";break;case 4:o="增加一层护盾状态，有效吸收对方"+r/100+"%的伤害";break;case 5:o="每一次攻击有"+Tool.toInt(s/100)+"%的概率造成对方沉默，只能释放基础剑法持续"+r/1e3+"秒"}a.push({text:o})}return a},e.getLegendDescByType=function(e,t,n,a){void 0===a&&(a=0);var i="";switch(e){case 1:i="每一次攻击有"+Tool.toInt(t/100)+"%的概率造成对方眩晕，持续"+n/1e3+"秒";break;case 2:i="死亡后自动复活，恢复最大生命值的"+Tool.toInt(n/100)+"%";break;case 3:i="直接忽视对方防御，对其额外造成自身攻击力"+n/100+"%的伤害";break;case 4:i="增加一层护盾状态，有效吸收对方"+n/100+"%的伤害";break;case 5:i="每一次攻击有"+Tool.toInt(t/100)+"%的概率造成对方沉默，只能释放基础剑法持续"+n/1e3+"秒";break;case 6:i="战斗开启时，会瞬间降低目标"+n/100+"%生命值";break;case 7:i="仙侣幻化镜像同时释放技能，对目标造成攻击力"+a/100+"%的伤害";break;case 8:i="仙侣开启嗜血状态，瞬间提高"+a/100+"%攻击力造成大幅度伤害";break;case 9:i="仙侣有"+n/100+"%概率造成对方眩晕，同时会降低对方眩晕"+a/100+"%概率";break;case 10:i="永久提高"+n/100+"%经验和"+a/100+"%金币产出"}return i},e.Legend_Num=5,e}();__reflect(LegendDefine.prototype,"LegendDefine");var ARTIFACT_TYPE;!function(e){e[e.ARTIFACT_MB=1]="ARTIFACT_MB",e[e.ARTIFACT_FH=2]="ARTIFACT_FH",e[e.ARTIFACT_PJ=3]="ARTIFACT_PJ",e[e.ARTIFACT_HD=4]="ARTIFACT_HD",e[e.ARTIFACT_CM=5]="ARTIFACT_CM",e[e.ARTIFACT_KX=6]="ARTIFACT_KX",e[e.ARTIFACT_FS=7]="ARTIFACT_FS",e[e.ARTIFACT_SX=8]="ARTIFACT_SX",e[e.ARTIFACT_KY=9]="ARTIFACT_KY",e[e.ARTIFACT_JY=10]="ARTIFACT_JY"}(ARTIFACT_TYPE||(ARTIFACT_TYPE={}));var LevelDefine=function(){function e(){}return e.getLevelByCoatardlv=function(e){return 0==e?0:void 0},e.getLevelByOpenDay=function(e){return e<this.DAY_TO_LEVEL.length?this.DAY_TO_LEVEL[e]:this.DAY_TO_LEVEL[this.DAY_TO_LEVEL.length-1]},e.ZS_ORIGIN_LEVEL=80,e.MAX_LEVEL_LIANHUA=10,e.DAY_TO_LEVEL=[0,0,100,150,170,190,210,230,250,270,275],e}();__reflect(LevelDefine.prototype,"LevelDefine");var NameDefine=function(){function e(){}return e.getRandomPlayerName=function(e,t){var n=this.surnameArray[Math.floor(Math.random()*this.surnameArray.length)];return n+=t==SEX_TYPE.MALE?this.maleNameArray[Math.floor(Math.random()*this.maleNameArray.length)]:this.femaleNameArray[Math.floor(Math.random()*this.femaleNameArray.length)],e&&(n="S"+SDKManager.loginInfo.serverId+"."+n),n},e.surnameArray=["安陵","白","百里","柏","柏侯","包","鲍","北宫","北山","北唐","毕","卜","蔡","曹","岑","常","车","陈","程","仇","崔","澹台","邓","狄","第五","丁","东方","东郭","东门","董","窦","独孤","端木","段","樊","范","方","房","费","封","冯","符","傅","高","公门","公孙","公羊","公冶","宫","龚","顾","管","韩","郝","何","贺","赫连","洪","侯","呼延","华","皇甫","惠","霍","吉","即墨","纪","贾","江","姜","蒋","解","经","景","柯","孔","雷","黎","李","连","廉","粱","凌","令狐","刘","柳","卢","鲁","陆","罗","骆","吕","马","孟","苗","闵","莫","牧","慕容","穆","南宫","聂","宁","欧阳","潘","庞","裴","彭","亓官","齐","祁","钱","乔","秦","邱","秋","裘","任","荣","阮","上官","邵","申屠","沈","施","石","史","司空","司寇","司马","司徒","宋","苏","孙","太史","汤","唐","陶","田","童","拓跋","万","汪","王","韦","卫","尉迟","魏","温","闻人","翁","巫","吴","伍","武","西门","席","夏","夏侯","鲜于","向","项","萧","谢","邢","徐","许","轩辕","薛","荀","严","阎","颜","燕","杨","姚","叶","尹","应","尤","于","余","俞","虞","宇文","元","袁","翟","詹","张","章","长孙","赵","甄","郑","钟离","周","朱","诸葛","卓","子书","邹","祖","左"],e.maleNameArray=["傲天","百川","半雪","薄云","碧空","别鹤","伯光","伯乾","伯云","博文","博云","搏云","不凡","不言","不语","沧海","辰逸","成风","成云","乘风","乘云","冲虚","仇天","酬海","处机","传宗","吹雪","春秋","道天","顶天","定江","东白","动流","断秋","断天","飞阁","非笑","风华","风云","枫竹","峰穹","复天","孤风","谷雪","光豪","广陵","归农","归真","过云","寒枫","寒松","行空","豪英","昊强","昊天","浩澜","浩南","浩天","浩宇","皓岚","皓天","皓轩","鹤轩","痕沙","恒天","弘文","红血","花雨","华隆","辉耀","家洛","嘉懿","简斋","剑愁","剑风","剑峰","剑清","剑通","剑心","剑影","瑾瑜","进博","晋鹏","景岳","敬侠","靖仇","靖琪","靖易","靖元","九霄","君浩","俊楠","峻熙","骏雄","开山","开天","开宇","空空","黎昕","连碧","连虎","灵竹","留香","龙耀","鹭洋","洛书","梦白","觅云","灭龙","明辉","明轩","冥幽","铭魂","牧云","慕白","南青","南松","南天","破敌","破天","绮凡","千酬","千秋","青寒","青侯","青书","青桐","青雄","清泉","清扬","清云","擎苍","擎宇","秋白","秋魂","人杰","睿渊","若风","若剑","三少","三问","三笑","善均","善朋","绍辉","神通","声谷","晟睿","士萧","士霄","世倌","世魁","世平","世章","水云","司朋","思归","思豪","松风","松年","松溪","太冲","天保","天丞","天川","天德","天风","天恒","天宏","天磊","天禄","天奇","天寿","天抒","天问","天星","铁心","图南","万仇","万里","万天","万亭","忘忧","惟忠","维侠","伟祺","伟泽","温侯","文博","文冲","文昊","文龙","问天","我行","无敌","无极","无忌","无剑","无缺","无施","无血","小凡","小邪","小鱼","晓风","笑白","笑天","信凌","星武","修杰","旭尧","玄风","玄天","寻欢","烟客","延豹","延龙","延庆","炎彬","炎武","遥心","野牧","烨磊","一刀","一雷","一鸣","一笑","毅山","懿轩","迎松","幼南","雨泽","元霸","元鹤","元龙","远峰","远锋","远玄","苑博","越彬","越泽","云奇","云翼","泽洋","长青","召重","兆和","哲瀚","正德","志平","致远","中则","仲英","追命","子轩","子云","紫霄","道之","万声","疾","隶","败","三德","人达","剑心","万天","威","沅","悲","一德","人英","剑成","祥","翎","羿","老九","人杰","剑封","绝山","誉","戎","储","老五","人雄","万言","绝义","枫","擎","靳","老四","元龙","绝悟","沧海","凛","荆","汲","十三","成威","绝施","万仇","涛","丑","邴","如豹","成协","乘风","万怨","卿","坤","糜","连虎","不评","乘云","万恶","豁","耷","松","似狮","老三","世开","恶天","焱","磬","井","大楚","广山","剑鬼","灭龙","虔","函","富","定帮","不言","远锋","剑身","契","翰","乌","伟帮","追命","远望","无敌","罡","遥","焦","大有","难敌","远山","半鬼","鸿","萧","奎","高烽","难破","广缘","行天","胜","嚣","稀","自中","难摧","天与","浩天","鹰","骁","班","天川","难胜","天抒","天寿","卿","鲂","仰","大开","德地","天奇","无血","城","剑","伊","傀儡","德天","半仙","聋五","康","筮","栾","羊青","世平","一鸣","如花","阁","勒","厉","牛青","世德","文龙","三问","穆","炳","戎","开山","世立","元正","非笑","扬","斩","天德","中恶","浩阑","蓝血","垣","颤","铁身","延恶","士晋","无招","师","孱","老黑","百川","铸海","无极","翼","续","半邪","世倌","人龙","鬼神","秋","岩","半山","连碧","伯云","满天","傥","奄","一江","岱周","老头","飞扬","乞","箴","十八","行恶","剑通","行恶","剑通","致远","俊驰","雨泽","烨磊","晟睿","天佑","文昊","修洁","黎昕","远航","旭尧","鸿涛","伟祺","荣轩","越泽","浩宇","瑾瑜","皓轩","擎苍","擎宇","志泽","子轩","睿渊","弘文","哲瀚","雨泽","博超"],e.femaleNameArray=["傲晴","傲珊","闭月","碧彤","冰洁","冰旋","冰颜","不二","不悔","不乐","涔雨","嫦曦","朝雪","沉鱼","萃愁","翠锦","丹妗","淡烟","尔岚","凡英","梵音","芳茵","飞飞","飞凤","非烟","菲青","菲音","凤凰","凤灵","凤翎","芙碧","芙蓉","孤烟","孤雁","莞冉","涫涫","寒云","红棉","红袖","欢馨","幻然","幻雪","幻嫣","荟闲","惠茜","惠心","佳琦","蛟凤","婕珍","瑾萱","璟雯","婧琪","靖瑶","静宸","静琪","静香","静璇","九真","绝音","珺瑶","可馨","可秀","兰若","阑香","阑悦","蓝翎","乐菱","乐姗","黎云","莉姿","怜梦","琳琼","灵儿","灵煌","灵珊","灵素","灵芸","玲珑","凌菲","凌薇","翎雪","绫栾","曼玉","美萱","媚颜","梦洁","梦璐","梦琪","梦清","梦瑶","妙芹","妙彤","敏颖","明梅","鸣凤","茗茗","茗玉","冥茗","莫言","沐卉","慕灵","慕青","沛菡","沛玲","沛珊","萍影","淇倩","琪涵","琦巧","绮罗","倩如","倩雪","芹雁","青荷","青莲","青青","青婴","青竹","清涟","清颜","蓉茜","柔心","如冰","如娆","如萱","如雪","如音","茹雪","茹嫣","睿婕","若冰","若兰","若兮","若颜","桑榆","衫盈","珊珊","珊菀","善斓","善若","笙馨","诗琪","诗茵","姝烟","淑颖","双双","双英","姒香","素阴","素影","太清","太英","檀雅","婷冉","彤倩","桐竹","宛儿","菀柳","惋清","婉婷","绾绾","唯雪","文馨","文秀","雯青","问晴","溪灵","熙雯","香寒","香茹","香怡","香雨","湘颜","襄馨","向珊","小仙","小小","晓芙","晓亦","笑怡","心兰","芯情","欣妍","新柔","歆瑶","馨蕊","馨彤","秀姝","绣连","雪慧","雪雁","血茗","雅芙","雅静","雅琳","亚男","娅楠","嫣媚","嫣然","妍思","颜凤","艳资","雁姝","妖妖","夜阑","夜蓉","依娜","怡香","怡心","以蕊","易烟","莺语","瑛凝","荧仙","荧荧","盈盈","莹冰","莹芝","颖遥","优璇","佑怡","羽馨","雨寒","雨嘉","雨婷","语兰","语琴","语蓉","语嫣","玉兰","玉珍","钰彤","煜婷","元霜","沅芷","月婵","玥怡","芸熙","芸萱","芸遥","芸遥","韵寒","真真","筝凡","芷青","芷若","稚晴","洙云","珠妍","姿倩","紫翠","紫寒","紫霜","紫烟","紫伊","紫衣","醉蓝","邑","乾","绯","擎汉","豪英","剑愁","一笑","逊","蹇","涔","酬海","成败","冥幽","天问","剑","臻","复天","忘幽","士萧","山河","凡","珩","严青","成危","中道","仇天","嵩","达","鹤","不斜","成风","道天","一斩","豪","烙","鞅","不可","成仁","道消","不二","裘","冥","霸","不正","无施","道罡","无剑","匪","惮","寇","无声","不斜","不凡","断天","戾","雍","博","百招","靖仇","不尤","远侵","瑛","鑫","匕","千万","若风","千筹","一刀","铭","靖","弼","随阴","若剑","断秋","碧空","霆","紊","碧","一手","若之","断缘","仇血","驳","钧","捕","三毒","亿先","子骞","鹏涛","炎彬","鹤轩","越彬","风华","靖琪","明辉","伟诚","明轩","健柏","修杰","志泽","弘文","峻熙","嘉懿","煜城","懿轩","烨伟","苑博","熠彤","鸿煊","博涛","烨霖","烨华","煜祺","智宸","正豪","明杰","立诚","立轩","立辉","峻熙","弘文","熠彤","鸿煊","烨霖","鑫鹏","天思","聪展","鹏笑","愚志","强炫","明雪","松思","源智","渊思","晓啸","天宇","浩然","文轩","振家","乐驹","晓博","文博","昊焱","立果","金鑫","锦程","嘉熙","鹏飞","子默","思远","浩轩","语堂","聪健","问旋","白易","问筠","听白","代桃","冷之","盼秋","秋寒","慕蕊","海亦","初晴","盼旋","幼旋","尔蓝","沛山","代丝","觅松","夜白","冷安","醉薇","凡梦","尔曼","念波","问安","雅阳","友绿","诗云","飞风","寄灵","书芹","访琴","谷波","妙海","从安","之玉","雨珍","冰安","秋白","南风","醉山","初彤","凝海","映波","平文","青文","寻菡","沛白","平灵","芷烟","白易","尔阳","怜烟","谷槐","楷瑞","建辉","晋鹏","天磊","绍辉","泽洋","鑫磊","鹏煊","昊强","伟宸"],e}();__reflect(NameDefine.prototype,"NameDefine");var PetDefine=function(){function e(){}return e.MAX_PET_NUM=10,e}();__reflect(PetDefine.prototype,"PetDefine");var PsychDefine=function(){function e(){}return e.SYCEE=50,e.GOLD_PSYCH=3,e.PROD=30,e.BAG_MAX=30,e.PSYCH_SLOT_LOCK=["5转或VIP7","6转或VIP8","7转或VIP9","8转或VIP10","9转或VIP11","10转或VIP12","11转或VIP13"],e.UNLOCK_CONDITION=[{rebirth:5,vip:1},{rebirth:6,vip:2},{rebirth:7,vip:3},{rebirth:8,vip:4},{rebirth:9,vip:5},{rebirth:10,vip:6},{rebirth:11,vip:7}],e}();__reflect(PsychDefine.prototype,"PsychDefine");var RandomDefine=function(){function e(){}return e.FIGHT_RANDOM=[[7560,4636,7038,6232,4627,9518,11,5352,5330,2325,1742,9696,2813,1990,8433,8924,1108,2068,1432,2503],[1892,6324,2407,6966,2988,8162,5673,8332,9751,1061,7264,1714,6275,295,8224,1532,6608,6150,8064,8480],[6693,9994,9252,7748,5564,2767,6384,2294,7182,6231,9622,2118,2142,8743,1039,7461,1158,6157,9805,7341],[7972,6984,7805,6981,4035,8915,4929,2567,5565,8139,1019,4084,6864,2688,6234,2279,8790,8192,1642,117],[1639,59,6671,9315,3376,9934,4301,1472,6109,3421,8752,603,7776,4466,5254,3991,9941,6389,9342,7460],[9915,7747,7842,460,8940,7290,6423,2190,7020,5,5241,3731,1036,5469,5434,8353,9318,5555,1145,5023],[8323,5738,3215,8043,3262,6074,7932,9642,4411,4080,1200,3385,4103,9061,2992,5297,1499,1940,5534,6441],[2371,2617,6225,6528,8078,2014,2354,607,5051,1591,1217,2902,4858,2382,3503,8261,5313,9874,7709,1622],[1182,2554,3551,8784,9648,6390,7213,7759,9364,1763,2237,5724,4138,4179,7129,3224,5980,1823,9109,1657],[9823,3121,3406,7409,4e3,6420,2577,8564,3430,6843,8492,7204,419,7112,7984,220,9264,1852,2743,2789],[3952,5788,5987,1603,4599,99,8585,5266,7315,7298,1732,7201,3378,4143,6575,5400,4461,5794,7623,1131],[9701,9601,5995,7373,2923,9326,3791,478,7314,368,8988,6286,5713,5845,433,175,8648,6649,960,1165],[1795,9736,5789,1431,7475,6867,1850,7109,5095,7371,8081,8547,7716,2656,2734,626,6183,2202,6546,6945],[7301,8386,8070,8887,6828,4614,5310,4450,4303,1724,9571,6698,9670,2994,8549,4739,2167,7956,8884,8441],[7335,9719,6170,5490,5824,7520,6437,8211,6447,7731,342,9186,740,3259,851,9983,4755,5991,5811,1014],[955,1746,4530,5462,4395,2823,9156,3048,3193,8929,6285,142,1723,2600,3670,1471,2882,1483,7118,3182],[1469,5554,2081,6387,9522,2682,6106,7773,6886,4701,1787,5250,5733,8578,7676,6402,9930,6100,2779,9943],[5067,7861,7099,7778,7468,3639,3975,3946,7822,4769,3810,8515,7596,2130,5498,7123,5931,5290,1330,7122],[8613,9970,7261,5940,7451,5272,5214,3134,6084,5416,9027,7876,5566,6597,2450,8766,9673,7757,519,5503],[5425,4418,6375,2026,7189,7254,4671,2792,2822,1530,4265,5972,8539,507,9506,9202,1679,1332,6956,8861],[4693,4721,8163,5497,3032,8490,2580,6178,5396,3238,2747,5642,9924,3797,3102,7438,2821,5002,2925,1956],[9746,5170,5062,1289,7003,1328,487,609,5527,2710,137,4369,4098,3234,4984,2865,3714,5365,1255,7321],[7553,9403,9702,7406,9480,734,7992,369,662,3737,624,3292,8474,5577,9005,2513,153,300,9893,5716],[3820,1738,7262,9952,5530,6467,4484,7051,8288,3003,6351,2856,7603,663,4736,3451,7522,4062,1544,9718],[9891,1458,8247,5134,2107,2738,7302,6401,1134,4654,1676,6680,3335,6461,9253,5218,7396,4072,1886,2369],[5491,7999,5371,1094,6114,6664,8964,3388,9756,6667,479,6001,8328,8789,3760,8130,8406,3755,3024,7572],[9727,4469,3413,8705,4207,4232,2052,458,2694,9821,5532,2984,7442,1344,71,2954,7609,4886,5211,89],[54,5552,888,6418,3323,1136,8617,835,4727,235,2787,853,3239,2964,8071,3277,9961,7897,448,5019],[5430,4226,3640,9277,1538,2973,8011,5545,1828,2275,2693,7446,7825,7646,3423,2881,3359,5108,4016,8499],[5138,5300,463,6576,7746,1096,7655,5030,6894,1059,3085,6490,894,5885,5042,4679,5774,9843,9495,8524],[6012,7039,5901,6836,3260,1719,9559,4890,1644,895,4316,9092,1564,423,3356,2322,6871,7942,1970,8278],[9286,6833,9503,8761,7828,9516,5482,1351,3734,9455,4391,2850,2305,5127,3090,7044,6987,8950,8709,9624],[8509,1573,3465,7524,7219,7939,2211,879,4924,8596,2307,125,6007,5862,9204,7166,8400,3518,1035,1434],[4194,7274,9137,8655,9731,3112,5444,188,7837,1587,7004,5360,64,4013,575,3186,514,881,8466,8015],[1196,6651,3532,761,1597,7395,8472,2863,3616,6093,3437,5778,5760,9755,6066,6586,8178,6032,9907,827],[2337,7366,1751,9856,5377,7079,564,365,2239,5142,2247,4152,3426,3140,8253,7397,9595,7535,3187,3508],[5682,1407,3459,3767,4677,6569,781,22,9039,2731,2021,5857,3928,6780,4592,6090,5661,6185,9882,4297],[7216,3138,9210,5013,6855,2362,5791,6913,1917,1586,8404,5385,2908,5730,4938,5193,595,7911,4661,8997],[1862,7948,6521,9845,9675,6468,3819,5167,7982,8116,3486,3404,2451,4145,6392,3540,7428,8817,9564,797],[8695,5881,6107,2034,6879,161,3448,1599,2661,9757,6400,5244,9864,3197,9654,637,80,2103,2676,7629],[5077,5446,1386,1015,1111,8835,5677,6255,7514,2739,9373,3307,1190,2829,8859,6172,641,6851,4083,5976],[2502,7632,6778,6822,8734,5120,503,680,1881,5775,3629,4025,262,4757,5521,1233,2581,6272,5777,1259],[181,3056,9415,5921,1949,1287,9780,2762,4941,2953,4595,5213,8196,2330,3476,7866,8772,6034,6891,9020],[9803,2105,7184,2368,7245,452,1858,8715,7521,9804,8030,4029,6271,2260,4383,6735,7597,2266,6623,7796],[3204,2982,8763,6523,4983,215,5659,893,146,2170,9155,4807,4934,9829,5133,6706,2864,8665,6217,3992],[5312,7,6491,6972,3199,2319,6147,2284,9707,1445,7918,1939,4321,6050,9813,6805,7332,5806,9167,8615],[9914,8157,3774,1308,9177,6781,9285,900,4835,6616,7978,8260,4735,9468,1008,7125,8271,6344,7960,8023],[7789,2749,3653,5920,5150,8831,9801,6024,844,7530,5097,2621,7734,8378,4069,2229,351,8954,1613,1144],[8966,6,8491,1777,9993,8033,8074,5319,9423,1153,7588,1002,8936,1928,2309,9904,2729,9110,2611,2010],[8965,3422,5341,1199,6369,6424,9087,2781,5802,9942,2126,7467,7967,9327,4320,7325,1883,4719,6096,7419],[4422,7237,7849,7235,5027,9940,2579,1647,3434,3136,1716,1737,1279,8481,31,2573,5014,8570,1931,4447],[9458,352,3543,606,496,3304,279,1500,9194,1293,7130,7095,1073,3877,4557,2940,2759,4307,3391,9640],[7277,7697,9625,3937,6567,4005,3167,7923,5546,2226,4940,1220,447,6722,6174,940,2100,1274,6974,4833],[6489,1863,8357,6821,9166,5427,8994,3026,1759,8832,1058,1945,7280,2067,1404,9577,9084,4583,3216,1065],[5137,7529,5280,3487,2587,6175,3371,9619,5898,9621,1839,8094,179,92,6727,1174,7852,2690,1670,1754],[7108,6740,5822,455,6269,6193,2966,2203,6213,2334,1730,2631,157,5776,6040,4715,3939,2742,9260,7986],[2054,8339,1045,9448,5693,2826,912,2699,2329,8847,217,7186,7209,3473,3390,6181,673,7977,3397,1879],[5947,1097,1827,1055,3281,5010,6372,2069,2264,6099,636,8137,2991,3612,978,4786,1607,6049,120,15],[7668,4698,5919,4643,2163,6139,2460,2833,3131,2714,9412,6155,6940,3491,4966,9152,1162,2871,3967,3835],[5050,5914,5639,1549,3881,6219,7050,1913,9591,4244,2283,6228,8419,218,6763,3615,4387,1985,4964,1236],[4379,6184,395,5047,6562,803,8537,4457,7227,8878,1167,3901,427,5191,2492,1103,839,3707,2520,9371],[4976,5145,4936,7951,475,9434,8857,1420,4994,8022,3499,5236,6404,6326,7928,4458,7481,6267,5106,5203],[8299,1610,3129,1226,9766,1934,1997,8259,2365,8118,345,5650,23,9036,2546,6846,7833,750,935,9067],[6958,4802,7412,2686,6993,4921,3710,767,8557,286,1130,4603,9514,7248,3550,8012,8880,6059,7782,9900],[1856,2799,4270,492,9045,8395,7868,2755,9104,2039,91,9226,3785,684,8942,551,5703,1016,7595,2287],[3800,3627,7242,5538,9849,8529,8668,9215,6023,8636,3062,5368,4776,9979,7305,7637,806,5369,7336,243],[6885,9419,3468,5204,2378,1473,3010,812,2152,1700,887,9474,1419,3393,5056,7721,1300,5944,4754,4057],[3033,376,3573,7636,8190,3864,4448,992,6884,8091,4191,4618,5946,1987,9258,8493,5281,2664,5101,6345],[9647,8635,9587,4259,9637,2810,7764,3249,1388,8391,178,7494,201,5913,76,917,7161,7893,9963,1518],[7317,9378,4542,8802,2510,3899,7404,4607,5359,5764,1996,4605,6696,465,6518,263,604,4330,3483,5288],[5977,3174,6878,3377,8922,9826,187,3839,8559,969,6283,3704,1673,3657,675,4901,8048,7695,5587,5418],[5853,9294,4794,1953,3566,2540,1280,8295,7260,957,102,2442,340,1148,758,6721,735,9057,37,1709],[6800,6075,9632,2788,6308,5086,8049,18,8166,3935,1529,9658,653,1566,3387,8322,4347,5603,6076,9402],[529,4033,8234,7628,8498,777,2394,9410,860,8985,4171,7157,5148,6785,5060,8541,1921,4192,5625,1224],[4673,9586,4314,1779,4147,3958,7961,5615,7985,7084,6338,7581,3299,5299,7499,1817,2358,1620,5974,6699],[7641,9584,6453,7792,5484,2484,2999,4512,5159,2097,2987,6398,8947,9536,3464,3237,7669,7307,5610,2259],[3521,2267,4522,9228,4575,7542,3739,7239,4943,1026,8318,3510,520,3574,3367,1235,151,6767,36,3579],[7531,9683,849,3788,2406,5304,2411,4224,8010,2753,9764,5823,1696,1541,2133,3245,4644,6092,8654,4110],[8392,985,3985,9056,6448,156,8214,8577,2756,3290,8017,3440,6803,8913,6065,1627,2471,2176,7954,1659],[8222,2031,8442,2541,9548,5223,4269,4914,6333,728,9046,5381,2754,3953,3347,1187,7032,1290,6064,5366],[865,6527,7612,4977,3412,8697,7854,8707,6229,7901,4912,4415,2071,7060,2556,9946,5655,643,7934,8201],[7165,8267,9831,8535,5220,2494,905,6659,68,7767,1557,7306,5912,7115,8876,7229,4357,7914,1490,4257],[2353,9540,8867,7351,1230,8496,2843,1462,6548,7478,1178,6176,5221,1609,2877,9143,9050,3805,2149,1633],[7589,4263,4099,2113,5124,2763,9066,782,9822,3560,8830,7378,7285,667,5908,7350,5548,9060,2485,6899],[5870,8699,390,9320,4993,7832,9078,6203,9427,7343,5970,9593,5135,2959,7874,5996,530,8969,5557,7005],[7885,7293,359,8662,4564,8717,4112,526,7155,5045,3648,9370,6129,4724,7197,4166,4860,9132,74,5415],[7064,8106,5392,7830,1142,5468,328,8055,4815,4508,629,3272,9544,779,1660,4073,8670,1450,5878,7873],[6036,6274,2548,2159,2395,268,6733,307,4905,1455,7550,5345,3635,9257,3702,6123,121,3698,4902,4889],[8154,107,4972,4668,926,2697,1789,4291,5496,8471,2276,538,7418,2311,79,1634,2153,4176,6411,222],[3039,5210,4545,8764,2383,8641,8117,5112,2374,776,1335,1370,8385,6665,4586,8101,189,9742,6207,9451],[7263,9107,7608,2466,4140,3570,9212,7728,4475,472,6582,5692,5690,5549,7730,4697,7249,7795,9136,4488],[3436,1247,1666,717,4197,1756,311,2890,9739,2544,6814,8487,7931,9463,5018,2360,5559,1569,1556,4911],[4690,4803,7308,2511,8840,6057,3113,778,9234,4092,4849,2208,1507,8031,9851,7781,2509,2814,3400,6454],[7953,4489,4075,9391,3843,1608,4880,7686,9305,434,6818,2370,7088,9933,3703,1484,7077,828,2092,9001],[616,6571,9542,4856,1271,2435,2285,967,6299,7504,2632,9795,5398,5726,7656,1242,5162,6037,2013,8838],[1812,4173,6412,7516,6035,1050,437,9248,7196,8177,8020,7509,5380,3362,4672,3924,6564,2086,8454,2701],[3019,3854,9003,7594,45,8785,4340,9113,5155,9784,7536,7052,6290,8456,977,9698,4066,6197,7429,3641],[1957,2938,4271,2768,9669,2110,8708,373,3469,3987,2835,9185,5052,4774,3411,415,8373,2422,7436,7491],[6703,833,1390,8458,2830,2501,9810,8769,5804,8519,8955,3927,1197,4399,3133,4377,3565,5076,8160,6816],[4235,2525,51,5754,7028,6791,682,1841,9462,5467,1095,9486,7358,6774,5558,4070,6144,9380,7568,8765],[8181,3959,3990,2199,601,1410,4756,4243,14,1477,5240,1033,4568,2044,3759,5091,1509,3178,5172,2114],[4211,7244,5399,6870,5783,2846,8780,6301,7567,379,3159,3568,8320,1166,2968,3467,7205,2662,5331,3042],[5523,152,6131,5185,9877,267,4413,495,75,3015,9869,5436,6386,3079,9608,26,5257,2037,3718,413],[6906,5021,9450,6997,5560,2711,1251,3622,7061,7996,4947,2795,4778,608,7654,4199,12,9094,4773,1347],[9334,9222,3072,9777,396,9289,3040,6786,1655,4225,9761,8334,7940,9272,9363,4068,1151,539,7899,848],[9015,6182,8793,8351,3485,2517,3934,8286,8872,9613,3520,5670,2215,2352,5827,8335,7148,8105,9899,4317],[7116,9218,6463,3365,9580,9927,7817,4310,3752,6486,6273,2764,2657,6621,9867,9472,8494,3675,1e4,8362],[4449,2571,4686,8745,5721,4792,523,8912,5709,3471,549,5668,8625,1229,5842,1762,8587,6278,2531,9772],[528,3682,4563,2819,5652,543,5301,5069,2265,5117,275,6766,2074,6295,7383,7246,9029,6371,3209,9384],[3971,5607,2586,7779,5154,9820,4354,8180,688,1306,8864,1988,9131,8215,7023,3849,3143,707,8313,9497],[9175,97,3726,8738,3567,1792,2842,2400,2622,5183,4551,8891,9014,5978,9616,5932,4784,8914,2817,5567],[7379,4960,3634,5237,702,9633,9351,3964,6980,8749,2647,4951,509,9225,6647,5370,2649,1617,8308,9844],[8158,5448,6112,6697,1750,9589,1505,3092,9074,699,8768,698,2872,4054,66,3623,1155,4897,5429,2627],[1493,6287,5676,4118,8540,2575,386,8512,6537,2310,6356,9133,3872,4787,3120,840,4289,5568,4200,5743],[4680,6509,9261,7231,5293,2308,8108,9456,4255,2705,3066,4478,4922,5401,2361,892,7590,9165,7450,5059],[9991,9291,7664,4939,4982,9266,3481,163,8407,8875,330,9392,5907,3770,1531,3871,6747,4433,2403,5083],[1378,4598,6199,8819,5332,1092,1834,5180,416,1964,7780,6732,9249,6327,109,8873,659,545,9449,4032],[512,7503,1099,792,261,3620,8927,877,7945,5718,8771,2087,1543,2569,9105,9998,4218,4555,9267,3240],[757,2381,7900,9498,7142,9174,3059,4351,3006,4881,2453,6634,5519,9767,8713,9890,3818,2990,2459,8621],[6790,7488,2078,2866,348,5175,84,53,3475,4436,5779,9628,7495,2135,7202,1215,3816,2157,3278,30],[5897,8333,9865,6594,9329,6646,2138,2328,2746,1982,7256,3161,4720,8901,165,3948,1900,2125,7251,7840],[7259,2635,3433,5403,3911,9884,216,7726,5166,6362,2175,4959,6121,4239,8013,9797,8956,4477,1069,6500],[6545,7348,3057,3771,4359,8801,1890,7444,1681,4613,8869,6847,5292,9147,1527,6444,9127,9651,4836,3380],[6221,2860,4382,2590,8673,3403,1076,5613,3960,9338,9639,1579,5528,8571,3279,7599,1240,9556,3716,360],[6555,5190,9301,6973,8984,6817,8527,5275,3012,3743,8756,1319,122,5316,4822,8103,8434,770,9501,8435],[7070,2367,2393,6350,8986,668,6625,5695,5759,2530,9306,5524,3286,3794,9686,6758,5640,4215,2278,2121],[1161,817,5458,1244,691,4426,5186,2995,3515,4326,3979,6730,8344,8042,3808,9852,9775,4139,3655,8710],[5807,2191,3432,9470,1062,9726,3811,9665,5672,7114,1054,3609,8939,5504,7340,3208,3336,4444,9992,7048],[7968,6230,184,7602,5048,425,1078,2760,1668,6859,169,8982,8731,9262,7150,2944,1734,5696,6806,2974],[3301,320,1041,127,5406,9237,5481,2993,9108,308,6310,3442,2582,4932,9478,2584,4702,1602,2027,1052],[4429,4878,7955,6939,2909,7233,8356,7806,4036,6656,5969,1922,5049,1375,2740,5388,2253,8579,5492,3291],[4550,1394,5317,8047,4485,1392,3672,9615,8207,6916,8381,1368,8432,7926,7138,614,5082,9980,1275,3060],[9236,9484,4854,2695,9033,9101,147,908,1460,9811,5637,2879,9018,3071,8504,389,4750,8690,3719,9505],[6348,6590,5268,3608,6148,9931,5447,4954,5423,4348,8126,1012,3253,6432,9404,2496,4827,4416,8583,6220],[9481,9217,7324,5945,7582,9431,4037,5832,786,4828,6426,5309,5057,4559,3273,1618,7107,2009,2089,8439],[5715,6861,1783,5079,6779,3276,7981,9527,6141,3049,4242,1077,7279,3496,6321,1820,110,6520,3999,567],[8354,3801,72,8470,983,207,1575,3342,8823,2461,6593,8460,7690,6410,2893,1177,5302,1869,6687,6358],[3366,6292,1553,4971,3313,6985,4852,4370,2620,5122,6675,841,3957,5229,7694,5269,210,6216,4655,1320],[108,5011,7583,2551,5200,9588,8899,3099,2402,7375,8372,4684,5168,6241,1421,3973,9967,9748,8917,6813],[3462,9295,271,8216,5899,3886,6469,829,8312,7980,762,578,5246,8125,9529,7300,1766,9247,1487,52],[6905,3585,372,6256,9304,7768,5489,3506,1749,4664,9847,3572,8960,7265,1589,2282,6408,6365,1975,3108],[6661,3047,83,7410,2245,1146,8932,8868,2963,4746,9680,2332,8370,7617,1214,9330,1211,2327,7124,3337],[4064,221,5510,2165,9372,418,7722,5922,4577,8431,226,9988,3539,6865,7169,9753,3729,3792,7724,1265],[5440,2280,1342,5927,669,3867,8522,3984,9366,3150,7361,1068,4604,5578,5460,8896,6028,5535,9352,2448],[5883,6898,6845,3526,9195,780,4184,6677,5835,4349,9953,9209,4502,9219,5861,1163,3919,9198,6631,6725],[3417,744,1467,3314,3257,2625,6583,8546,3660,1708,2192,5087,2615,3333,1605,8346,7434,9920,7561,4480],[3325,5003,439,493,245,6025,8952,4328,2117,5179,2574,6789,1571,9638,8254,5265,6029,7921,2297,7707],[4476,4574,8021,1998,8908,9929,8973,5720,4973,8889,6748,7439,95,1027,1435,8774,6910,3145,4432,6135],[8262,7534,3588,1707,9923,6982,2053,6977,9467,6368,8513,5298,1305,9170,9697,3044,7271,4817,3504,2883],[3414,3073,2828,2915,5207,8684,7002,1464,2800,6060,3654,1727,5512,5507,7292,715,1318,745,7744,8258],[3795,4306,5686,815,6252,7402,4888,9561,134,6619,8361,9187,3885,1604,4518,3829,889,6513,3831,9255],[1855,568,7322,5674,3857,4823,8228,1457,8068,4373,8329,3041,6481,5286,7611,3583,3068,2607,2807,5259],[3727,1965,8566,2614,424,572,630,2035,6414,7791,81,291,7752,891,6638,4533,1902,5955,5634,3309],[5829,8894,7512,7857,9040,2120,4305,1680,8465,7607,4279,3080,8403,5307,2853,5004,8563,7253,5879,4624],[6142,2072,7812,3782,4617,8938,5518,6929,3744,1348,2164,8796,9791,8906,2055,4537,7295,7826,9103,8923],[104,6690,4431,364,246,7569,4650,2221,5020,7389,8488,1272,9072,8428,4300,7564,869,3761,1234,552],[7220,2455,2564,6473,8592,8812,9168,7958,456,8750,4766,8231,8225,2338,335,824,5322,5039,3274,6835],[9041,3222,9e3,1563,3845,8131,101,4276,4135,4722,469,4991,5477,9524,256,6055,7653,3599,1423,2978],[4053,3269,9017,6137,3680,476,8996,5247,6946,561,2722,8897,8732,5483,8429,4867,7770,4044,129,1776],[8598,7670,1774,6430,5848,5675,5657,3860,332,6044,5860,8426,7333,6971,7171,9909,6081,6428,3407,5192],[8905,4167,9054,7831,8065,8572,4826,9792,5934,9389,32,9323,6325,3339,2366,2783,6936,4187,819,5611],[4371,4452,2246,8365,7802,2236,1842,9006,3732,7465,831,1359,4343,7452,2495,7908,5098,6022,6536,1908],[3118,8895,5839,1887,4356,2683,4396,2357,8360,553,6566,8664,3956,5622,2286,2262,1311,9256,1391,6994],[8018,3643,8301,540,6681,8611,5354,7090,6615,645,7925,2106,2914,5874,9692,6156,2499,4659,194,1884],[1960,1315,7469,3169,323,7605,4742,1898,1545,4532,1904,7455,445,4883,4584,5089,3084,3205,3181,7890],[5068,3780,3590,9725,2386,3514,5208,6282,7715,9382,96,8279,6788,6989,2051,1397,5073,4245,811,9095],[2012,8510,5099,2943,6662,4163,7916,4785,4046,9316,2602,2873,7701,2350,440,7688,3873,9581,2182,2849],[1857,5404,5837,3192,7882,8658,1379,6783,4286,6413,8088,9504,7783,9964,5081,4580,1747,3392,1946,3611],[6263,3153,7082,2942,7829,7257,1106,9636,2415,4441,7991,5556,7054,2715,4779,1672,9627,2527,5449,9416],[7218,2028,7330,2273,2641,5582,6019,63,6320,6695,3875,278,4620,9115,6637,3008,8671,8337,3370,8302],[4017,8239,4332,2769,2070,5529,3384,5739,5916,9716,7712,5959,9956,4470,8851,2784,9712,7357,4741,1722],[5515,8576,3569,4710,9511,7554,9339,34,1721,7449,8825,337,2958,5942,6249,6280,4796,5389,5663,8054],[1064,3882,252,8902,4601,3750,4656,3077,2318,350,9251,4855,429,6892,4417,7965,7947,5094,5602,3203],[2841,4945,1808,2761,8941,7750,6764,3554,5765,7971,4906,8983,2291,1992,5729,6896,1753,9245,5937,7417],[6823,7633,9759,7540,5889,9972,2928,970,759,6856,4622,4825,9832,6708,1430,2184,1745,4009,7698,8584],[5450,5130,8518,3673,5514,1286,640,9114,3678,3211,2831,6211,7111,2975,5735,5699,7062,1474,9037,8165],[8093,556,4962,4641,5680,3944,3853,9183,2642,7809,7498,4319,4464,3995,1911,5264,4154,9922,8696,6264],[8503,1682,4514,2179,1276,7665,4217,4051,5989,5113,3284,8343,4988,6908,7838,4900,1362,6357,9128,7740],[4223,4177,1072,8413,4078,5194,1567,6443,8650,6782,1448,689,9995,488,973,2091,4526,5951,936,374],[1109,3509,1918,3055,2038,1901,1570,818,2591,8451,6930,513,6043,7526,1593,4567,5954,2790,3441,6115],[2443,6921,3107,6247,4916,8398,5979,1079,5278,7610,417,4695,7017,599,610,9409,4455,9239,1951,8978],[774,2888,3172,718,1191,1301,4487,1937,3500,1771,8e3,420,1976,6711,3340,4408,2996,2977,9824,6245],[1042,3980,676,4566,6741,143,4162,4594,8704,4390,1414,3856,3160,3974,991,4869,3883,1085,7673,4397],[7312,7018,4420,8574,6950,6166,1614,764,2423,6809,754,5819,8275,5990,2392,9063,8918,2986,7273,8730],[2905,8672,4546,9657,3798,5975,3188,8155,953,4961,4857,7143,7803,9523,7580,8294,1185,4600,2046,1325],[1691,7043,8863,7359,3379,687,5338,5727,383,491,8245,752,7145,7989,8169,4777,7289,7811,3582,2301],[7600,5009,3395,4087,9653,4438,486,5685,62,5596,9275,5012,9031,6435,2533,518,1216,1447,2444,2243],[7316,2808,1830,2003,9485,644,9499,3217,6332,1822,9596,2618,73,6011,1260,3564,855,3637,7800,6508],[994,6316,2477,8073,8348,3226,1636,4127,3561,1853,807,4847,1288,258,4442,3190,2744,9917,6502,7943],[4483,27,5426,6670,3768,9150,9328,9966,5575,4808,3668,5887,4838,2200,5592,521,8963,9694,5305,880],[2288,2606,4928,5199,2727,9207,3038,597,2302,8469,2868,4646,4023,9838,9241,4712,4681,2446,633,2109],[1465,9129,3094,2296,3687,7555,441,2112,525,8594,4228,5261,2197,3996,2429,5231,1712,2084,6743,8120],[8210,6624,7867,830,6962,1093,5964,6918,3589,3711,559,3110,4318,8777,9898,9414,8026,1383,7160,9799],[7527,3455,4578,2629,7211,8204,2553,4482,924,9650,8202,6328,6212,4427,5324,9630,2596,3146,8623,7661],[7368,5629,1340,5273,997,1396,9949,4608,1043,555,7081,7430,948,4372,4161,8680,4260,565,3918,4930],[9743,9887,6300,4633,8886,9770,5070,3576,5815,356,3868,1283,287,6668,5470,7356,132,2166,6794,7370],[9089,3862,6515,7210,6194,5061,8059,1650,7470,3597,1046,5414,6654,239,3748,5751,6924,4091,6848,8543],[6559,5036,590,9691,1559,498,993,6650,1502,4258,9307,2599,5274,6850,600,4096,4055,6542,5348,2927],[7878,5432,5540,4034,7445,1687,2718,7532,8604,7100,9070,176,4108,2364,5509,3803,8502,5356,4799,531],[9240,826,2933,3200,3555,4588,9509,5270,1720,966,6551,6753,471,5813,3168,1437,5717,4726,8874,6983],[9634,9679,1752,4493,654,3334,9230,7175,2006,7820,1782,2765,6876,7339,6409,1387,9885,7846,4536,6544],[2712,7034,5140,1213,906,4089,6014,4114,6729,2514,647,6020,6592,6421,2885,8866,106,5826,2341,9344],[5115,6487,6258,9873,8479,763,7762,8076,9100,3547,1385,2932,1492,6904,6361,88,9437,1761,3361,7180],[8195,7425,4434,536,6600,1444,6750,4423,1381,3180,5618,2235,2870,1740,7e3,7131,1926,9629,9073,3652],[309,1649,6151,3383,571,7794,3490,6119,3109,527,2214,8844,4758,2549,4008,459,8977,5993,7132,401],[998,7076,9932,7074,2957,1138,7902,4843,537,736,6738,3982,9454,6077,8651,5648,8104,5986,8340,2463],[6742,490,846,2630,4287,3586,1168,8317,6802,8280,5351,6033,4254,4088,8798,847,1522,4268,1656,4095],[9407,355,8602,4649,8417,6102,4919,6483,4094,3479,986,5654,7601,8892,4344,1263,2104,9508,5755,7281],[5376,872,5473,9048,8132,6759,4745,1895,4202,4172,3061,5459,8217,3563,9815,366,3587,3766,798,1086],[1011,2472,7464,5948,1294,2108,1868,5938,4689,1524,8675,7146,5407,6456,4678,3,9910,9176,522,3230],[1326,1508,9798,6784,3156,504,1081,6364,4781,6240,6556,5090,393,6133,363,8700,5058,334,4220,8273],[7387,5065,5103,6862,8086,8530,6552,9424,9841,923,3360,9607,7863,3720,9081,2670,8355,1580,1030,8910],[3372,6869,8776,9188,4556,1577,3978,3105,5152,1765,3793,1683,2750,8991,438,1915,9545,3773,8102,1705],[8987,5419,8393,9242,6890,7456,3571,8806,2692,8551,6224,6541,6317,9911,3458,5849,7864,1514,273,8167],[7334,5936,3447,4767,8242,1517,6775,7657,3020,8489,343,432,3373,6496,7313,4019,5283,6477,5638,2023],[8706,7443,4589,5311,8027,4010,6673,9016,7904,1395,2794,8725,4323,3241,8226,8331,3122,3324,1846,7243],[2597,3695,2516,3017,3231,1944,2748,9573,3175,2025,5189,7126,3171,2917,534,2498,7415,9274,3295,2209],[3225,2390,1773,8517,995,6259,8976,93,2504,9069,6927,1277,627,4341,3826,173,8098,9012,1488,9473],[9154,6874,4628,3575,1594,6416,2777,2946,1576,2838,2950,1491,5915,8206,4042,2696,925,6209,6002,3644],[5379,1298,7844,9223,8045,8607,4393,4267,3246,5238,1744,7976,7880,4031,6266,3887,1334,2412,2248,3890],[2634,5547,4572,9090,2181,8614,1905,9676,5961,3031,6180,6955,6009,3601,298,5198,3196,5873,6858,3746],[87,6097,9947,9476,9153,4949,9830,4003,8467,4331,5708,8044,4501,7889,5598,2195,3742,1971,870,5570],[1991,8241,8759,8218,2143,9816,7391,941,375,1568,5443,2603,4548,7591,7970,7421,724,3297,5893,799],[6776,198,7723,9530,6911,9068,113,7729,1480,6798,3270,8237,7365,1296,9950,7362,3523,6724,731,8326],[9579,863,3812,2123,5258,8920,8420,318,3189,933,3283,2255,3431,1903,6660,1547,4451,8006,4028,4002],[1803,370,264,1697,570,5784,9379,1208,9085,4764,1506,2351,4059,9076,4273,563,7756,9531,8268,2639],[1741,9858,4974,1029,9833,4865,9144,4570,480,8303,4946,8007,4953,1804,5232,6159,8833,8402,6636,1324],[2490,9555,1888,2774,602,3036,9863,920,4374,6953,3427,6512,7448,9837,594,5943,6359,825,4876,9238],[3162,8136,1758,7987,5461,2534,9928,3352,8612,9148,7501,6645,8248,9477,2151,5353,5126,8666,3489,8688],[5732,9299,4365,6988,4670,3512,8172,3650,2653,6825,8221,8028,9013,7247,5129,8560,3947,1e3,2424,8109],[972,9021,2029,9125,4376,9421,6688,9708,5635,9009,5601,3232,7075,2050,1864,996,9047,2056,1809,9546],[4541,5474,9534,3898,9064,4443,6e3,1009,4368,4256,5361,9436,1961,9433,3915,6054,3070,5367,5911,9892],[8975,5820,4185,4958,8293,1641,7763,5329,8958,1694,6506,4762,1044,1995,2961,5420,6719,5465,7158,8016],[4367,1999,4121,3416,7329,3580,6152,8811,747,1550,2326,6942,5445,6812,726,1361,150,4090,3321,8552],[4247,1739,6538,1427,7579,9984,904,3075,6883,1877,4248,1889,9340,115,3850,7634,1129,2935,8345,1715],[2667,4445,9986,7573,4895,9614,6254,2008,8265,4558,2820,6086,5493,8152,7480,4907,9408,3028,8500,4832],[8397,9357,8948,8464,1101,1516,1551,3962,428,6008,3610,70,6587,144,2434,8256,3807,9086,5662,678],[1037,7618,1310,4516,3147,951,2847,9552,6200,2397,7906,858,3662,5397,319,8900,4772,2419,3513,7414],[4048,8904,3681,9532,4283,701,2751,1952,1847,2242,2077,6470,3399,5209,6329,4663,4725,2168,4334,789],[9974,2568,2290,1013,2320,6561,17,7063,6318,9745,4597,8998,8550,5868,40,7476,4280,1800,2616,984],[1466,3945,6305,9774,8591,9159,8001,1441,3701,5747,1032,1479,3804,3210,4168,5363,9119,4389,3998,1303],[5542,41,6495,2146,4561,9682,7225,1468,9322,8853,60,3838,7388,6516,7021,4842,3626,3088,2441,8837],[1826,8729,576,7895,5828,7381,6340,9268,2129,3364,6395,1924,2189,3439,5985,8422,8141,7071,2663,1981],[3201,9438,9276,3923,2349,921,2508,7562,9711,4694,622,1574,9353,8882,3348,1363,6015,7511,6479,1135],[9303,7692,5216,1125,4937,1874,859,4761,2565,3951,6307,4602,344,3870,3218,3332,5719,3914,2778,6888],[130,483,7203,111,1954,1192,8368,1384,3477,6832,9730,1262,430,5762,9521,4159,1932,4278,1958,7427],[9585,7258,6558,6880,1625,2289,6396,1735,464,2741,5749,6682,5378,3647,7240,8089,2154,5362,8981,897],[8911,1417,5543,6397,299,867,9173,3067,8135,949,8083,4345,3124,2454,5219,5e3,4765,6996,3429,2951],[9042,450,1475,9729,8287,6807,5800,5334,4986,4201,7477,2005,2638,7250,6235,3320,3004,5144,3725,6330],[6572,4743,8156,8883,6534,7557,6588,8095,3368,2906,533,4216,2065,38,3965,5580,254,6868,9583,5902],[7616,8128,8660,4153,1885,8849,3435,7199,1876,9740,7506,5960,4392,7753,6407,746,5600,9765,6563,6354],[6341,2929,8285,4119,2225,8931,1684,5308,4294,6640,9383,69,1525,7352,5736,586,3847,8194,6063,1601],[7907,4494,4851,7537,666,2532,6399,8799,9397,5181,2578,2775,7207,1256,1688,7198,2083,4342,981,3895],[251,1225,5478,9806,388,9763,3636,5452,3764,4304,7007,3976,5412,907,6195,7304,2892,7041,796,2691],[213,6070,4783,3428,6154,7327,6309,2948,2212,7377,8468,8186,5753,285,1520,3905,8127,3963,3941,5541],[2213,3535,2677,5892,5105,8208,1282,4957,2420,4149,7490,6920,3198,3144,1285,3932,1284,6168,2899,2543],[8146,8257,3758,6978,3247,4230,3322,3802,8808,5346,3618,4210,6388,1486,2137,9976,3762,6169,3594,7671],[961,3930,2134,664,2669,8298,9385,5678,5856,1612,8627,938,8685,5550,6854,532,7458,7091,6853,5737],[501,1343,4018,3728,8974,8056,4122,9459,3243,7761,4107,7604,6760,3214,562,7735,2539,7156,783,3142],[3089,9771,4717,9140,5339,5411,6754,5766,2713,296,3326,3880,1496,2355,6912,7328,613,1674,444,9216],[6158,7318,257,5387,696,8401,1933,4660,5074,5666,9162,7119,6686,9106,3009,3148,1028,8038,1801,5900],[6943,6250,769,7541,6810,7283,6574,3460,9590,8380,6143,756,3603,5488,7574,6337,9644,4868,4151,7372],[1871,6610,3493,2700,1087,8748,7702,303,6674,1156,3993,8266,9948,6954,9439,9612,8140,5464,5973,3738],[4846,5679,4315,4503,1916,4249,1400,9396,2845,9270,7949,7463,4770,1692,2666,4058,931,9652,9367,7860],[86,6672,7551,9441,6510,1729,8741,7754,3507,6360,2802,9704,223,1202,2594,2210,7046,2922,8040,6434],[913,6804,3525,2836,7525,6797,4665,90,8951,4996,9578,7152,2227,7462,6938,1669,7487,8036,4521,542],[6746,6373,9288,3852,683,4474,547,1768,2432,7232,9273,3858,4845,8450,3534,6046,3463,1600,6068,7282],[9842,7969,5233,9083,5631,4425,8277,1872,1678,3598,3330,2333,3446,5958,9693,82,4997,8484,7685,4525],[1223,6573,7630,1113,2528,3081,4027,9445,6460,2099,5093,5591,982,6533,9513,7221,1439,9737,9526,1424],[1521,7818,5347,9172,4460,6067,333,2132,9802,8800,2702,2136,4134,2560,7320,6415,2785,3842,2150,6827],[7586,4956,8907,3117,4691,589,5394,1623,8145,4253,3354,8720,9817,7223,8652,8898,6801,5583,9926,9022],[2585,9631,9203,6554,4821,850,7687,3344,612,3497,9903,9430,3357,1463,1930,1266,516,3903,9317,4975],[3769,4129,4288,4771,9475,3382,8692,9376,2733,8495,4699,646,7995,7103,9656,9400,1248,6720,3444,8626],[7192,5035,9163,7738,7696,962,1565,557,7042,1875,8061,5251,1760,5227,6440,1249,1910,1536,7269,5044],[9897,4277,5852,4903,3495,8718,8415,2476,1089,8447,9487,2033,1349,392,5608,5016,2770,8096,5801,2482],[5808,3449,3242,9399,4540,6268,1449,4198,1194,5100,2452,5624,9043,7471,4410,7615,2155,3833,1204,8501],[5451,1628,5799,7704,4630,8161,8440,7337,2380,2563,7543,3522,1352,4729,8855,6382,2317,6657,358,9452],[7952,8995,1018,4696,2373,3683,9794,6113,9075,6125,6134,2900,910,8032,8283,3164,9325,1122,7619,2724],[3605,9659,1870,9978,1860,8459,1596,6532,6581,9052,5536,8060,7810,1848,3202,6314,9442,2299,5584,5846],[515,4097,5041,6187,2665,5336,8850,1038,6466,1843,5277,661,8213,8733,2776,5803,1561,5792,6214,5314],[1882,3184,976,1896,8797,1631,5205,5830,2704,7284,7176,6539,9358,1548,7217,7374,9550,135,3078,5595],[336,4133,1307,639,3389,2147,9432,6761,3502,5375,5705,1090,6381,9825,1790,5890,2654,9611,3154,7659],[7871,1482,7266,990,6378,2732,6663,7482,9733,6053,8324,9346,5653,3712,9280,9868,4128,8150,9062,6336],[9575,9182,2497,3037,8661,1246,5131,9635,4295,5793,138,7714,4585,2536,9211,2254,9293,9722,4705,7693],[5785,7255,1010,8736,6837,9617,6642,399,1686,9888,329,349,625,4209,9297,3607,3135,9079,4635,1209],[1371,5080,2233,8508,9809,2131,7643,7922,5230,6004,4631,7194,8848,6975,3817,8292,768,4504,3776,648],[3350,2876,1124,5561,7703,136,4942,5903,5876,6223,7236,2303,346,7179,9655,6482,6006,9710,314,5588],[6251,3375,8545,49,1665,1854,8935,5787,7549,6768,1270,6530,2612,4704,6260,6391,9345,2557,3922,8159],[9906,3402,3986,3679,8803,6164,1374,3749,7013,7938,2139,1461,8236,5818,6599,9336,3972,8019,4830,2610],[7407,9724,1380,1088,2062,5015,554,2421,1699,1619,9604,642,5075,2219,4407,6189,1403,9703,975,1533],[3275,7435,1258,6549,1020,9460,2500,2252,6684,7631,5609,1784,3661,7049,3157,8694,4862,3305,7626,3488],[5242,305,772,5326,6226,2430,4499,6315,3527,8097,133,5476,1350,4336,755,1333,5866,47,1495,9178],[322,8436,6188,9350,8066,4402,5224,785,670,6860,6755,1438,3894,9649,6021,4050,6419,511,632,6620],[7528,1206,2036,19,3126,468,7929,6462,7029,9562,7030,2060,185,4189,367,4467,4560,3676,9479,6027],[1443,7133,2970,2335,8846,6206,5104,8921,5933,2972,7677,3874,943,577,8737,1504,6612,6161,5831,1264],[5107,9510,2281,10,868,6394,4061,240,387,5599,6887,6480,6704,3223,8663,158,6186,55,442,5315],[6244,617,4221,5537,6773,9464,6606,4935,5508,9735,2550,5905,6238,3401,2889,5643,473,5855,4879,2115],[9685,1969,7870,6165,3472,4505,7508,8595,1837,1805,9783,6937,2101,9193,1651,579,6923,5153,3625,7072],[5886,7593,7681,4535,1778,2185,8807,4155,6531,1994,6080,9551,3346,6709,2464,9812,7930,2177,3308,5704],[8726,2522,1066,1452,3669,1799,4978,6819,9846,4106,1175,4266,6047,8050,3116,4925,7808,7966,4931,7944],[1572,3418,4638,2791,2220,6218,8462,5187,6543,7711,3343,7486,9229,2216,3453,2687,2782,2920,5276,5078],[9388,7909,2343,8993,5001,620,7104,8805,6222,9426,8605,3536,3016,4378,6429,5006,7344,9954,2685,7993],[2312,8409,2032,8350,8842,1141,1114,5156,6726,2605,6934,6484,8080,4325,3840,443,1891,7771,8854,4403],[3821,8919,5965,1412,3e3,50,3501,3319,6852,1119,8336,9857,9387,1426,1100,8794,4222,5479,1757,4990],[3311,2862,3595,7228,5971,5226,3046,8123,5202,6179,5710,4131,1704,7185,6999,7303,2256,710,7975,7699],[3484,1354,281,1813,103,3908,297,878,8200,6529,2098,3306,3779,9752,9102,4579,8310,7515,8133,5296],[5164,8723,8548,2773,9668,7009,9603,8573,9671,8416,911,324,4985,8683,5291,3381,7066,2598,2174,3316],[145,2480,8170,6346,1664,2593,2388,3954,1835,4101,862,8618,7390,5917,7937,4047,3086,5054,5143,1786],[5475,3029,1053,7059,3633,1948,875,5858,6501,1157,7457,2576,1406,8390,9781,4970,5850,2315,4612,3538],[9191,1171,3913,274,4587,4164,5084,4490,3544,8315,7879,866,5328,8338,4753,6607,708,979,1955,1440],[7994,5571,4831,6465,6658,854,6126,6796,1091,6643,8347,5725,1317,8306,6526,9738,3813,8871,6734,1137],[8453,9989,9312,5188,3558,7144,5343,9908,9254,8153,5176,8174,4302,685,7484,3345,1966,4513,7801,5869],[3733,7816,2344,6488,4596,2673,6153,9971,7850,6949,9916,3815,2049,2321,1675,6088,706,7167,1851,6715],[8885,5593,8112,8282,3756,77,5005,2241,4111,5114,6385,4908,9135,183,2552,5909,2234,7376,524,462],[4515,3553,9447,7592,4193,3103,795,1807,9141,3581,4703,6167,2650,312,1920,4593,1912,4380,6882,4840],[2258,3663,6132,5544,6875,2851,9997,2998,5812,621,8816,1231,8203,9643,7510,5551,6585,7755,5173,5263],[8628,8352,4544,751,6215,8553,7154,5671,57,5633,5714,7174,1245,4213,5029,3452,3751,4335,5930,3505],[5123,3787,7737,7807,8586,2171,5438,1624,8246,7545,9347,738,2985,289,3111,9618,4875,362,2898,6901],[7140,842,6018,2257,9610,9871,6666,9572,9097,2447,2346,466,8300,8534,2240,9444,3906,9343,8646,2488],[4126,697,380,7836,8762,2178,4864,2085,9341,4394,8375,6312,1238,6752,3659,247,6442,3082,6503,3097],[766,8092,2483,9600,3351,1698,6589,2745,9919,2082,9750,2601,7069,1936,1331,1528,1003,8374,7888,4619],[227,1632,9568,2475,3988,5111,7667,8824,4529,6525,2609,7674,2640,8427,2726,2608,4524,9620,7394,1075],[5925,5768,9401,44,9283,914,3658,2717,1972,4262,8526,8881,8689,2238,7719,5924,3022,5769,3961,9645],[1582,3021,9706,7187,4576,6691,5382,3106,2456,7134,902,9709,2020,481,9024,4398,2545,2962,5225,7891],[9321,5781,5573,6648,7127,4552,4683,8463,7666,5617,8062,1429,378,6992,3981,3315,7137,4562,5421,2222],[5816,9754,9171,3638,2251,5619,4948,8443,886,3938,8946,8148,8528,8075,7727,6436,3983,4747,5604,7813],[2674,7055,5157,9180,3456,722,739,6700,3035,8893,5306,8452,253,8003,5586,3149,6580,5222,5163,8039],[2538,6163,5614,1080,6322,7288,1770,6433,384,16,2223,8388,8405,8934,6756,3593,2336,5494,9870,7392],[9139,9362,2719,4685,1047,7905,8321,6363,8173,2398,6591,4100,7627,2910,9760,5667,164,8053,7896,2250],[1511,5184,9488,3531,3130,1358,5563,8760,882,7085,885,3293,814,7973,7624,7016,7720,9405,8,2043],[8229,3312,7346,4642,8009,1798,5008,1115,5505,5196,4160,3528,8925,9088,3950,8264,1925,1252,2437,2180],[9789,1222,9189,6196,6204,2566,8856,1180,3693,6641,3809,2387,1341,5428,1693,1671,4327,3466,2218,3778],[9684,8149,1454,1304,4806,2684,4236,4375,4892,4188,544,6970,7997,6605,9044,7164,6104,2,5771,280],[5935,8686,6062,6331,9786,4760,6613,5217,406,3863,7135,9130,9298,4581,2359,5904,3310,7959,1497,4237],[9879,9201,2274,3268,9913,2537,1051,9435,4511,8739,4872,2331,6718,8930,7355,5017,5391,9808,1646,6108],[4626,3925,8751,3064,6596,5744,8437,8227,1663,2449,2672,5585,1539,7065,9164,8384,8212,4873,457,9259],[8810,2815,9354,2045,9935,2804,8034,8485,4927,9996,6379,8244,5239,9284,8858,2399,9592,8642,2458,4640],[6257,8367,5063,4468,7920,3267,8959,5433,1098,4824,5844,4891,9138,4174,5689,7691,4547,4086,3827,3014],[3163,9192,2827,3394,8645,3664,7036,412,3258,5701,7105,5405,7853,9096,5746,24,3363,4284,4104,7642],[6872,7078,67,6633,6578,2592,5116,1638,1389,4313,8890,5480,1442,1560,5136,2040,1968,5486,2059,1947],[6826,7733,4419,3942,3236,2703,8698,2414,6998,8818,704,5836,3100,6626,974,8414,3602,6237,7910,8376],[6824,2919,8775,5410,7393,3926,208,5984,1232,3931,6302,2187,2348,9872,3545,3649,6757,3206,2249,259],[128,2224,2160,5487,7483,816,25,7847,8533,9002,3834,3631,4711,1718,7183,9080,2439,8408,2680,1706],[5102,2140,9955,9969,347,6417,1159,6737,6795,6281,7546,4751,8171,4004,6547,7056,3353,454,408,7497],[5797,6335,5992,7031,1513,5092,3721,3104,8716,8100,3005,4992,4527,5594,9660,861,4713,5981,5358,6485],[2771,2119,8341,6716,4981,3252,8383,681,8399,5160,1546,1552,105,255,2636,391,6248,2377,9905,131],[585,2648,8638,9558,3754,5500,8281,1253,2e3,3341,1728,5463,2396,4296,8970,5282,741,7784,1355,3955],[9569,7962,35,3034,4024,1143,2194,7892,5741,3093,8681,7927,8358,4308,1942,5782,7507,7401,6347,5616],[4459,968,5303,965,8057,3425,1984,8606,7364,8079,9157,4219,7869,4229,4063,1585,8580,8197,5773,8004],[1653,5840,9962,890,4473,3119,7437,9348,9574,5267,9517,6262,2079,4839,6455,3656,3091,2716,4688,118],[6353,2469,4519,1346,199,6306,8782,6101,5471,6376,5821,1373,42,9827,2418,6005,7859,9714,4324,9836],[9818,4472,4709,1120,5279,6577,2869,4180,1425,6655,9549,196,7684,193,3689,9099,852,7647,1844,2518],[5752,1299,720,4495,9973,4707,7638,3152,4275,3530,9960,8411,937,6475,1281,6297,9038,3651,4497,5294],[5517,5605,7459,4506,9281,1023,4137,2904,1989,9117,1629,4381,5968,5525,928,7326,5516,619,638,3917],[1402,2295,7093,3263,4850,896,6731,6990,5814,1254,4404,1526,1711,5691,3002,8425,8233,2269,6136,9010],[9912,4299,8191,6907,9560,587,166,5037,250,9337,8555,5612,1824,4206,3494,7974,192,2080,8610,5620],[2698,8377,1436,2145,6499,4338,9368,6051,5576,6504,1512,2102,4125,8747,2521,8804,508,8778,2428,3155],[8852,6058,4884,6094,3606,2644,8424,506,9461,4859,9375,2720,1894,1899,6652,3705,8944,3642,4590,8870],[7652,7037,5028,5597,162,4675,8412,3621,7706,4150,244,2884,3765,4979,7096,4020,3828,4430,5364,5882],[9411,1743,3688,2306,1393,4874,5956,7577,4329,9936,8841,944,3969,8568,7649,4116,9111,9537,9377,8943],[2465,8903,4214,2660,4141,3832,980,631,7149,903,2934,9120,2965,3288,7539,7342,2019,650,3498,3213],[202,7173,1832,7408,1710,4471,5658,9855,9093,1470,5569,7128,5880,6339,2939,6909,4980,4740,3604,4531],[5711,6739,9418,7294,573,7622,2708,2651,4539,7012,3876,9700,8477,6098,4309,174,6952,6039,3474,9269],[9179,3869,3855,733,6493,6959,1836,3128,9428,5923,1515,302,9547,3083,1643,4113,6839,7797,5963,5864],[3823,5589,8712,2976,6995,6003,874,6201,7790,6319,8754,2384,8674,4645,1401,9224,8179,793,6277,4012],[3789,411,2047,1128,9689,9098,3783,6439,9889,1838,7881,8599,2090,4178,9466,800,3450,315,5758,197],[5177,2806,1228,4549,3338,665,33,2413,9678,4052,3233,172,13,8787,3349,451,729,9880,4233,8909],[6494,1979,2263,1849,499,2467,4877,3030,1021,7252,9662,1781,2207,8311,2655,1677,4797,1422,1978,8121],[3747,3775,4510,4385,2969,6276,3287,9051,4120,9602,6045,2840,1542,5841,3355,2230,7086,190,9440,4401],[6540,8740,8182,7311,5697,3630,9492,9681,6289,5439,8475,2340,4782,2659,9663,3173,9417,3069,4021,6149],[558,711,3878,9507,2878,4085,3137,7208,6745,3628,2024,377,8972,5178,2857,1713,114,4117,8962,4056],[4841,46,7614,3884,4065,6192,8669,6702,5838,5875,8637,4182,236,1769,2960,2122,3076,6124,1621,8077],[2801,1690,9160,214,446,3784,9206,7862,1302,7513,191,6787,206,5034,7045,9945,9834,6242,9124,1962],[6116,5967,4708,6265,4652,1428,2457,2709,1409,4714,9728,5522,9854,5453,4462,709,7121,2595,2952,182],[6799,9469,9762,3408,5628,791,5395,8593,725,8979,3814,7272,9861,794,1057,6951,2094,4730,9968,9011],[7195,9565,5256,3977,7117,4181,8814,1132,6030,1725,2293,4498,2803,1360,371,2589,4718,1105,5700,4744],[4428,8677,4060,8953,9883,5770,8107,6960,4030,6595,916,2515,5748,6602,7276,4995,959,9035,7680,4001],[7170,8767,8556,5372,341,6313,6707,5574,8232,3123,583,500,9265,3300,1416,8240,2874,8562,5767,3989],[3445,8544,5320,4507,9695,7190,7725,7120,3696,8582,9881,5851,808,7774,7887,8597,7040,5007,5327,8701],[9082,743,592,2410,233,695,1485,6961,7473,5118,8005,596,7349,6349,1025,1006,7136,2523,7662,3591],[3902,7014,2555,7578,4130,3537,4353,876,9214,6279,1510,494,4763,9393,1056,3745,9902,6083,6298,313],[6793,4424,7403,7496,9231,8616,2057,9146,3409,2261,8305,9990,2524,7068,9496,381,7700,4844,593,1935],[7268,1535,7793,8565,3183,2292,4789,8633,9246,5151,1203,9690,7309,8933,4666,277,327,3562,2728,3836],[7645,6367,4251,7416,3542,8219,230,788,4362,8567,4509,4246,9999,4290,7946,2839,1993,634,6957,2947],[2588,2158,8111,1923,1558,1372,5884,3470,7319,2535,7689,1772,1590,8687,6111,857,9609,426,112,4926],[8455,7519,8396,1775,742,2409,7663,7296,7420,234,6118,1405,7001,6089,2076,2127,8949,546,1150,242],[2645,4606,8860,9699,58,171,5384,8968,6694,119,4360,9026,8999,2675,5435,5627,2205,4421,1821,8757],[1818,5763,9181,3271,6422,9134,9840,5344,9965,5894,898,6669,952,2507,9807,5043,228,2300,2173,9553],[6427,1652,9557,6653,139,2417,5863,3577,4634,7598,989,8309,7222,8175,3665,727,7650,6570,8223,9220],[4571,6919,5072,9390,1611,7224,7010,8926,6246,7027,8676,9443,4950,6072,8423,5877,1806,3848,4790,2912],[7924,569,8622,5698,773,5895,1938,9233,4611,3151,9142,6565,4969,956,3825,7841,3282,6723,615,7518],[6877,909,1366,505,9896,9425,6603,8349,7621,9749,1974,8746,535,5712,4853,566,1861,8371,7745,2967],[9525,6091,8888,4014,2431,6840,2725,2931,224,9925,3578,1689,4285,6941,3533,7858,100,1193,9300,5456],[65,7988,6917,9032,5966,9361,6071,3127,8724,628,2668,4528,5149,9145,6311,7345,5988,1127,2385,8678],[7919,8506,3730,6863,2356,3708,692,8379,7777,9939,8643,1024,8446,1005,7640,4621,5499,7565,4165,2061],[7708,5825,4081,7957,3671,4837,822,6560,5506,3549,8693,5040,3194,2206,3949,2468,7824,6459,7843,5891],[6968,2623,1336,9489,9313,7101,9311,7011,3516,7964,679,8516,2015,4240,1959,8185,5817,7323,6857,7786],[2707,1537,1661,3221,5038,8119,4965,6474,5918,2339,1183,4816,6145,3054,5681,6355,4520,1695,6323,4819],[2201,5843,6632,8421,4312,9987,6498,5761,5950,4728,5872,8129,1814,7775,3851,467,9287,8124,6928,7479],[4737,248,61,8272,5295,9582,4813,8110,6261,9395,8476,4998,6243,7558,4748,2832,1523,672,6683,9446],[1083,1067,6601,5409,4870,7432,2162,5649,43,8992,1040,2949,8238,958,2111,1017,2880,7544,1793,5383],[2979,9386,1977,1907,9664,1239,1367,2489,1291,7386,6714,2875,3722,9566,9200,7083,9567,149,9049,8290],[8284,229,9901,436,3866,8755,9894,1840,3592,8113,4657,9058,3896,5669,361,2427,6120,5088,8366,5022],[3195,1184,9859,2926,9457,6963,2041,5745,9429,7291,1071,6629,2204,1169,3280,6202,9053,5539,5983,1170],[1555,7053,7035,1865,1210,3865,1794,9985,9543,4,7787,6522,148,1102,7177,1201,9500,407,5245,8795],[9319,5520,7785,873,3115,8603,8046,1592,3098,9030,611,3717,1205,3713,4409,435,7799,760,177,4616],[560,8735,7983,686,2391,7933,8144,5146,9860,2345,9937,5066,3677,2093,8569,6744,4045,3740,5687,7092],[1147,3374,7648,7683,8014,1658,3219,4169,2156,5442,5888,700,4272,6712,8845,9606,4074,9422,1345,9394],[5795,5373,284,6701,6679,2921,485,5957,6964,5215,2796,1685,4910,9705,6705,1084,4863,5847,9413,1941],[8189,2007,9282,6976,598,2766,7660,6770,5809,1243,9787,3709,9184,4361,5053,1578,1919,7936,3879,8164],[8820,21,4144,2613,4439,231,7275,4311,5289,9921,9314,8418,2859,4022,5165,6476,9491,8770,8235,8792],[6604,8187,4952,7153,339,947,5437,9290,7426,2075,5723,9773,6866,1726,2048,2244,3994,4810,3410,4923],[2758,6969,160,6450,950,9356,9720,3753,4811,2894,7369,7163,294,2347,2854,3997,5929,3141,1662,3596],[8728,6438,8525,8143,9278,3600,801,5024,9034,3327,5260,9158,7678,7241,732,7168,9271,9112,8249,3114],[5997,9324,821,3763,7576,2058,2416,4820,7998,2519,9023,2812,1833,2628,3694,5501,9768,7080,9199,3645],[4738,8063,5651,5284,2671,9235,4252,7382,2314,2304,293,1312,721,5688,8967,2981,8791,8561,6138,8783],[7405,316,4491,5171,5796,4812,8369,8753,9528,3025,2272,9862,6553,2011,2462,4676,3796,748,6304,4848],[9623,2440,4658,4591,836,6078,325,4682,6614,6915,8786,1369,9332,6893,6692,915,4554,3777,7500,9597],[1376,3125,4882,331,4752,5728,7433,8634,939,813,3419,3043,4333,6233,7106,623,7024,690,5734,7384],[168,9793,5147,618,1049,2363,8644,98,2478,5683,2323,4132,2911,8449,8538,6013,6947,5337,4768,410],[7206,1339,656,6678,1164,6110,5422,5645,2547,4915,4292,9465,8822,2643,901,7815,3920,1802,3053,8532],[4446,7363,9741,1364,1598,5393,8989,713,6239,1780,6127,9876,2757,7915,3699,1498,2001,6370,5386,6056],[3511,1399,1476,3013,7718,4049,6458,2811,7705,8183,5953,8624,4894,1218,5128,4115,4909,9420,5854,2018],[9310,3438,8608,6967,8656,8387,2997,3063,3248,5055,6343,4405,7710,6366,5441,4700,403,3624,4366,4632],[7552,2124,5195,7159,2481,6926,477,4749,9744,8721,7606,5941,5248,7505,1267,9004,7453,4274,5212,1273],[5402,78,2583,2816,272,2232,2426,591,8657,4205,1398,8554,9126,5109,7489,7620,4648,484,2042,9493],[8438,7006,9677,5553,4261,4967,6736,3517,8647,1584,3074,7743,2088,7883,6628,1181,3910,2652,8252,398],[4667,2809,1189,1815,635,283,2438,1446,7400,5253,5235,2983,6191,4038,6405,7215,5031,2572,7848,2389],[3933,4241,5357,2793,802,7089,6772,1048,4337,8722,8619,9723,5949,9169,7766,2188,5139,4364,9151,6270],[971,1501,8521,2404,7935,3940,9279,402,4039,141,2721,1973,8937,8990,2689,5906,7538,123,8168,6838],[8834,1123,155,1269,2658,9116,2798,3396,5865,4989,5350,1179,4041,2193,7094,3058,301,2772,5424,4517],[9866,292,1626,1353,8090,4899,9360,6965,6765,5742,7380,6535,9717,2558,3132,5750,7385,8536,8558,1748],[1413,4734,6471,4800,7898,3229,6689,4918,9570,6644,8727,4136,232,1703,2004,871,7739,9918,922,4788],[6935,3007,474,4040,5646,5952,7585,1791,6016,820,671,2529,4043,1133,204,899,8134,3331,1195,56],[5349,5046,7941,5466,3191,3685,9800,5085,1241,8184,5998,3892,4662,9778,5579,1785,2379,9453,9975,4208],[3691,7058,9850,180,7821,3298,9641,2095,2144,9292,1829,8575,6511,317,9374,8971,3692,3420,489,804],[2924,461,5285,3166,7819,5684,1188,5656,7022,7181,7025,2824,7141,8389,9626,8072,8314,517,8297,3772],[6598,1323,8024,8325,5664,8828,9335,8067,2408,3897,6472,1615,5581,9055,4565,9359,3799,9814,94,7474],[5249,7679,3781,7493,8382,4809,9599,6830,1022,3255,7533,7886,1278,3859,3179,3548,8609,8742,8916,6844],[5910,290,9302,3613,9541,9025,9149,3806,8087,1481,4440,140,730,1867,237,1451,2372,1866,6897,2903],[9959,5158,2955,5455,4026,2270,449,2148,7454,6922,1983,2491,784,3065,8781,7644,4412,1357,4481,9667],[6777,1110,394,2063,4146,270,5182,6227,7517,3861,1154,6925,3697,2891,7447,2855,3909,5707,6991,1845],[6507,9490,2505,6932,1250,6052,4358,2186,4465,1534,3101,2852,8058,8649,2169,1637,400,3646,405,8316],[6210,7563,2198,9065,9,1819,6618,7814,2780,4123,7440,1873,5318,9349,7238,1004,5962,3207,5590,9123],[3824,932,7193,574,5632,5454,3735,4793,1540,3254,1,8630,7441,2526,7466,1943,1963,6374,1583,4731],[8220,2971,4195,6284,987,5780,4968,2405,4629,8639,3023,7884,7015,1702,7950,4093,9208,7297,8711,8826],[6403,6685,1219,963,7912,4804,3822,8653,8879,3741,8198,4238,6717,3524,3674,2493,3519,1731,288,3921],[4156,8085,823,6190,6524,8188,4674,856,4435,1606,7008,422,8505,6849,3706,6903,7287,657,9848,4437],[7672,9019,5262,9672,1297,8115,5161,2706,8821,2937,1811,2425,652,4015,3296,3317,1313,6728,2002,8497],[9981,6293,8084,2941,4363,4293,5413,9028,1788,3943,5513,4692,6568,4186,4388,7278,6449,7360,3096,8142],[482,3546,582,8659,276,4212,6902,7087,8600,9576,5982,6622,6617,9646,2681,9263,5287,8410,4105,6431],[4543,4102,7492,8980,6162,4534,3841,5032,8779,170,3177,4486,4885,3584,7299,4871,703,3690,810,7431],[4814,3415,1640,2897,5096,8199,1329,9944,6713,3256,9213,6171,6751,3244,4798,269,929,8122,5255,6352],[3266,1327,7338,5641,2736,1082,1825,6492,5374,357,5355,9502,2626,3617,883,9598,326,3251,7834,1453],[8304,5502,3715,2980,5665,9554,282,5340,2858,7033,7639,3480,1581,7845,9243,1717,7566,3045,4196,2436],[2887,6820,946,1478,5531,9308,8138,581,988,4322,884,4250,4904,6881,5772,8486,930,7267,4148,5252],[5417,2376,964,6944,9674,1382,6303,1906,7367,9776,4067,1117,9605,4158,7855,2161,3968,7713,6294,4623],[1140,304,1929,1831,211,7613,945,4079,9538,843,9161,8209,6630,1316,7559,5731,6140,1595,6771,3285],[7765,805,5321,310,771,2619,6841,8945,8250,5335,7212,6831,737,9118,4944,9715,7742,4861,2512,1810],[3736,1494,7772,9071,7270,3457,5859,3900,8041,5896,321,7230,8836,832,3893,6873,3614,266,7903,219],[7398,5994,4071,9519,1257,3757,7571,421,1456,2231,4637,1321,2679,5572,8511,4281,4898,7485,7399,9196],[712,241,3443,3461,2401,2737,6895,5694,8640,8307,2022,1914,6173,3405,5810,1648,605,6236,8877,3724],[2989,1268,2936,8430,3176,6208,6069,4538,8099,2474,3303,1121,3541,5201,9982,6205,6584,5999,6128,6451],[453,7097,6393,9007,2907,6497,154,7963,8029,7760,8243,548,8691,7913,7139,9666,9309,1063,7098,4124],[5867,8531,8601,238,1149,6627,7877,1212,8758,1459,6914,6010,2633,2313,5169,48,4523,4227,1176,265],[6425,1186,6792,8589,1980,3790,9539,9788,6478,4780,9398,7424,7979,8703,7110,918,7310,8829,5234,4647],[4175,1322,7658,8025,7057,4999,1126,5756,2861,9355,6557,1173,9839,3170,5606,3051,1337,3386,5511,3052],[3185,1356,1107,3212,6842,1227,1645,7865,4190,8330,9205,4386,7827,2298,4733,4339,5333,4500,1736,9661],[8327,8069,2730,4203,8813,4350,3027,7798,5636,3686,2016,124,588,2637,790,7751,6334,4355,3482,6676],[6579,1060,4183,2128,5472,354,5243,3632,2678,5798,8839,1207,4346,4917,5121,7188,5119,5706,1411,5805],[6105,3289,6146,2797,5132,7682,8289,7354,3556,6031,1118,2624,8520,5025,5495,9077,4920,8744,4609,9958],[28,8581,1878,3265,6457,9008,6889,1034,9369,2096,4887,4006,5197,8082,7732,7788,9796,3318,649,5026],[4007,723,5647,3095,1112,9853,9819,8002,1237,834,1292,864,5740,225,9886,1338,2433,3302,5323,4082],[934,9828,6834,5928,584,7191,8632,3700,3846,5834,3139,8620,1172,1635,942,7717,7102,8961,8274,3011],[9782,7769,7856,8478,9688,2956,6829,9594,1314,3684,7047,2918,2116,7162,5644,8702,7851,1767,7502,5526],[5408,5271,6609,4639,4569,4454,2486,4582,3559,3667,7804,9296,1377,3844,6038,4282,5939,3912,4142,2141],[4805,7067,5871,1070,6130,4963,3970,7990,658,9091,6710,2268,4955,502,6079,1198,6639,7214,9250,2375],[8394,6085,9977,3830,9790,4077,2867,6931,6811,2196,186,8269,9190,5125,3018,397,8631,6177,7917,2271],[7556,6082,8296,1562,1733,580,2073,3329,2930,116,8590,787,167,6377,2561,677,5702,1764,7073,3492],[8251,404,409,837,1152,2030,6042,749,4456,6160,4406,2562,5141,2834,4896,2723,3424,4384,3916,8827],[1309,8714,6073,5485,353,1160,1007,714,4011,5110,4801,8514,2886,3454,4893,8151,209,4818,5325,8667],[4651,809,260,1001,4400,5833,3529,385,4553,3557,3552,431,9779,9059,3087,8445,8359,1909,4829,5390],[4732,6635,5533,9895,9365,8843,8051,2445,5926,7019,2228,694,9483,1588,2470,3904,9333,4204,8461,6061],[382,8114,7547,5342,470,2479,8276,7353,5457,775,4076,8176,2542,1408,203,8482,4625,7875,8291,2017],[3786,7584,4479,4866,2848,1967,9713,5626,3165,3228,3619,6288,3888,5623,2945,8957,29,7625,6517,5431],[9406,9951,7026,4791,2506,1630,6017,8052,7587,8542,8588,7523,9122,5630,4573,3398,3227,7839,845,3929],[7548,5064,8008,7234,9227,7675,4795,8263,7736,2217,3050,674,2172,6505,1074,6087,8037,8523,4669,3369],[5722,660,8682,1415,1927,7651,3264,1221,2316,9938,4610,1654,919,2559,2646,3328,4109,6380,1796,1433],[9244,1139,4716,9221,2805,3907,7570,2896,1031,1667,4653,6445,126,8457,3158,8364,200,6446,6749,8815],[8809,414,2901,838,5206,6296,2818,4414,2183,550,8342,7172,8483,6291,2604,7151,6198,7749,4463,8865],[1261,85,4723,7178,8719,655,6406,9197,1701,212,1816,8230,9535,6815,9121,3235,195,9721,5660,4687],[753,9875,2277,5621,3358,9747,3936,3294,2837,39,2913,6550,9878,159,7113,2752,4615,306,3891,3261],[2473,4298,4706,7835,5071,2570,9687,6762,7758,765,7823,1616,2786,2342,999,4913,7741,9381,9533,8205],[5228,8679,6041,249,6342,6026,5562,2825,7200,9512,693,4775,9520,4933,8035,954,3220,4834,3666,1104],[3250,4987,8363,5757,6611,8319,8255,20,8773,6117,6769,9563,6048,4264,1950,7472,6519,1755,9732,7575],[5790,8928,7147,9232,8507,9515,6933,6900,6452,8448,1859,1295,6383,1893,3889,5786,6122,9758,4231,1503],[2324,2064,6986,4759,8193,9494,2916,2844,1554,4352,1489,4453,5033,4234,9957,3837,705,497,6103,7347],[1418,6095,8270,1365,7226,6808,7286,6979,6514,4496,4170,8473,2487,9471,9482,6948,7331,1519,3478,205],[9331,9835,8629,1986,4492,8788,7422,8444,927,338,2735,9769,7872,7411,6464,716,7635,541,9734,9785],[1880,719,6253,7413,2895,2066,3966,510,651,3001,4157,8862,7423,1797,5174,7894,1897,1116,3723,8147]],e
}();__reflect(RandomDefine.prototype,"RandomDefine");var RechargeDefine=function(){function e(){}return e.recharge_gear=[10,20,50,100,200,500,1e3,2e3],e}();__reflect(RechargeDefine.prototype,"RechargeDefine");var RedPointDefine=function(){function e(){}return e.getBoolean=function(){return!1},e.SYS1=(new egret.HashObject).hashCode,e.SYS2=(new egret.HashObject).hashCode,e}();__reflect(RedPointDefine.prototype,"RedPointDefine");var SHOP_TYPE;!function(e){e[e.DAOJU=0]="DAOJU",e[e.JIFEN=1]="JIFEN",e[e.RONGYU=2]="RONGYU",e[e.ARENA=3]="ARENA",e[e.SHENGWANG=4]="SHENGWANG",e[e.TURNPLATE=5]="TURNPLATE",e[e.YAOQIANSHU1=6]="YAOQIANSHU1",e[e.YAOQIANSHU2=7]="YAOQIANSHU2"}(SHOP_TYPE||(SHOP_TYPE={}));var ShopDefine=function(){function e(){}return e.openDefaultShopView=function(t){void 0===t&&(t=0);var n=new ShopParam(e.SHOP_TYPES,t);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ShopPanel",n))},e.SHOP_NAMEs=["普通商店","积分商店","战功商店","功勋商店","跨服商店","神秘商店","摇钱树","摇钱树"],e.SHOP_TYPES=[SHOP_TYPE.TURNPLATE,SHOP_TYPE.JIFEN],e}();__reflect(ShopDefine.prototype,"ShopDefine");var SkillDefine=function(){function e(){}return e.getSkillFighting=function(e,t){var n=0;n=e*this.SKILL_POWER_BASIC;for(var a=0;t>a;a++)n+=this.SKILL_GRADE_FIGHTING[a];return n},e.getSkillSeriesCount=function(t){switch(t){case e.COMMON_SKILL_ID:return 3;default:return 1}},Object.defineProperty(e,"FASHION_SKILL_CD",{get:function(){return Tool.isNumber(this._fashionSkillCD)||(this._fashionSkillCD=parseInt(Constant.get(Constant.FASHION_SKILL_CD))),this._fashionSkillCD},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FASION_SKILL_ORDER",{get:function(){if(!this._fashionSkillOrder){this._fashionSkillOrder=[];for(var e=Constant.get(Constant.FASION_SKILL_TYPE_ORDER).split(","),t=0;t<e.length;t++)this._fashionSkillOrder.push(parseInt(e[t]))}return this._fashionSkillOrder},enumerable:!0,configurable:!0}),e.MAX_ATKCOUNT=100,e.Attack_Action_Max=3,e.MALE_SKILL1_START_IDX=7,e.FAMALE_SKILL1_START_IDX=1,e.SKILL_RELEASE_ARY=[5,4,3,2,1,1,1,1,2,1,3,4,1,5,2,1,1,1,3,2,1,4,1,1,2,1,5,3,1,2,1,4,1,1,2,3,1,1,1,5,2,4,1,3,1,2,1,1,1,1,2,4,5,2,4,1,3,1,2,1,1,1,1,2,4,5,2,1,1,1,3,4,2,1,1,1,1,2,5,4,2,1,3,1,1,2,1,1,1,4,3,5,3,1,4,2,1,1,1,1,3,2,1,1],e.SKILL_RELEASE_SIZE=13,e.PET_SKILLS=[6],e.Retinue_Skills=[6],e.CHONGFENG_SKILL_ID=0,e.COMMON_SKILL_ID=1,e.DRAWBACK_DISTANCE=10,e.SKILL_NUM=5,e.SKIN_NUM=3,e.SKILL_GRADE_MAX=5,e.SKILL_POWER_BASIC=100,e.SKILL_GRADE_FIGHTING=[0,4e3,6e3,1e4,2e4],e}();__reflect(SkillDefine.prototype,"SkillDefine");var TLGiftDefine=function(){function e(){}return e.title=["坐骑升阶","神兵升阶","神装升阶","仙羽升阶","法宝升阶"],e.system=["坐骑","神兵","神装","仙羽","法宝"],e}();__reflect(TLGiftDefine.prototype,"TLGiftDefine");var TOPRankGiftDefine=function(){function e(){}return e.title=["等级提升","战力飞跃","坐骑进阶","神兵进阶","神装进阶","仙羽进阶","法宝进阶"],e}();__reflect(TOPRankGiftDefine.prototype,"TOPRankGiftDefine");var UnionDefine=function(){function e(){}return e.TAB_HALL=0,e.TAB_BOSS=1,e.TAB_DUP=2,e.TAB_BATTLE=3,e.Union_Badges_IconNum=4,e.Union_Badges_ColorNum=4,e.Union_Skill_Level=3,e.Union_Trunplate_Level=2,e.Union_Skill_Max=5,e.Union_Postions=["","盟主","副盟主","长老","护法","盟众"],e.Union_Postion_Icons=["","wang_title_png","fubang_title_png","zhanglao_title_png","hufa_title_png","bangzhong_title_png"],e.Union_Boss_Max=5,e.Union_Max_CheerNum=10,e.Union_Dup_AwardWave=5,e.Union_Battle_JoinMax=4,e.UNION_BATTLE_OVER_TIME=15e3,e.UNION_BATTLE_READY_TIME=15,e.UNIONBATTLE_SCORE_MAX=60,e.UNIONBATTLE_REBORN_TIME=60,e.UNIONBATTLE_LIFE_TIMES=3,e.UNIONBATTLE_BUFF_MAX=5,e.UNIONBATTLE_RUNTIME=5e3,e}();__reflect(UnionDefine.prototype,"UnionDefine");var UNION_POSTION;!function(e){e[e.WANG=1]="WANG",e[e.FUBANG=2]="FUBANG",e[e.ZHANGLAO=3]="ZHANGLAO",e[e.HUFA=4]="HUFA",e[e.BANGZHONG=5]="BANGZHONG"}(UNION_POSTION||(UNION_POSTION={}));var VipDefine=function(){function e(){}return e.MAX_VIPLEVEL=15,e.VIP_START_LEVEL=6,e}();__reflect(VipDefine.prototype,"VipDefine");var GameEvent=function(){function e(){}return e.QUERY_BALANCE_SUCCESS="game.query.balance.success",e.GAME_SDK_LOGIN_OK="game.sdk.login.success",e.GAME_SDK_LOGIN_FAIL="game.sdk.login.fail",e.GAME_JSON_PARSE_OK="game.json.parse.complete",e.GAME_RELOGIN_EVENT="game.player.relogin.event",e.GAME_JACKAROO_COMPLETE="game.jackaroo.complete.event",e.WXGAME_ONSHOW_EVENT="wxgame.onshow.event",e.WXGAME_ONHIDE_EVENT="wxgame.onhide.event",e.SCENE_ENTER_SUCCESS="game_scene_load_success",e.ANIMATION_LOAD_COMPLETE="game_animation_load_complete",e.ANIMATION_FRAMEGROUP_COMPLETE="game_animation_framegroup_complete",e.GAME_EARTHQUAKE_STRAT="game_earthquake",e.GAME_GOTO_BOSS_WAVE="game_goto_boss_wave",e.GAME_YEWAI_FIGHT_UPDATE="game_yewaifight_update",e.GAME_SET_AUTO_FIGHT="game_set_auto_fight",e.GAME_CLOSE_RESULT_VIEW="game_close_result_view",e.NPCTALK_SELECTED_ANSWER="game_npc_selected_answer",e.SHIELD_OTHERBODY_EVENT="game_otherbody_shield_event",e.LADDER_FIGHT_START_EVENT="ladder_arena_figth_start_event",e.OTHERBODY_ENTER_SCENE="game_ohterbody_enter_scene_event",e.PET_ENJOIN_MAP="game_pet_enjoin_map_event",e.PLAYER_AVATAR_UPDATE="game_player_avatar_update",e.MODULE_WINDOW_OPEN="game_module_window_open",e.MODULE_WINDOW_CLOSE="game_module_window_close",e.MODULE_WINDOW_OPEN_WITH_PARAM="game_module_window_open_with_param",e.MODULE_GOTYPE_OPEN_WINDOW="game_module_gotype_open_window",e.MODULE_WINDOW_ALLREMOVED="game_module_window_allremoved",e.LOADING_OPEN="game_loading_open",e.LOADING_CLOSE="game_loading_close",e.PLAYER_LEVEL_UPDATE="player_level_update",e.PLAYER_POWER_UPDATE="player_powervalue_update",e.PLAYER_SHENTONG_ADD="player_shentong_add",e.PLAYER_SHENTONG_REMOVE="player_shentong_remove",e.PLAYER_SHENTONG_SLOT_UPDATE="player_shentong_slot_update",e.GAME_BAG_UPDATE="game_bag_update",e.GAME_OBTAINHINT_SHOW="game_obtainhint_show_event",e.NET_EVENT_ERROR="netEventError",e.GAME_PULSE_ACTIVATED="activatedback",e.GAME_SHOP_BUYGOODS="game_shop_buy_goods",e.GAME_PSYCH_SELECTED="game_psych_selected",e.GAME_REDPOINT_TRIGGER="game_redpoint_trigger",e.GAME_PSYCH_ONEKEYDEVOUR="game_psych_onekeydevour",e.GAME_PSYCH_UPDATE="game_psych_update",e.GAME_PSYCH_LOCK="game_psych_lock",e.GAME_PSYCH_EQUIP="game_psych_equip",e.GAME_PSYCH_REPLACE="game_psych_replace",e.GAME_ROB_ESCORT="game_rob_escort",e.GAME_ESCORT_DONE="game_escort_done",e.GAME_ESCORT_AWARD="game_escort_award",e.GAME_TOUCH_TASK_BACK="game_touch_task_back",e.PULSE_UP_FAIL_EVENET="game_pulse_up_fail_evenet",e.GAME_PVP_BOTHFIGHTER_INFO="game_pvp_bothfighter_info",e.BLESS_OPEN_CHANGE_ARTIFACT="bless_open_change_artifact",e.NOVICE_GUIDE_EVENT="novice_guide_event",e.GAME_SEVDAY_CLOSE="game_sevday_close",e.GAME_REDPOINT_TRIGGER_DONE="game_redpoint_trigger_done",e.GAME_OPEN_PANEL_EVENT="game_open_panel_event",e.GAME_CHECKACTIVITY_BTN="game_checkactivity_btn",e.SDK_SHARE_INFO_UPDATE="sdk_share_info_update",e.GEM_LOTTERY_FREE="gem_lottery_free_times",e.SYSTEM_CHAT_BROADCAST="system_chat_broadcast",e.SYSTEM_CHAT_BROADCAST_UPDATEMAINVIEW="system_chat_broadcast_updatemainview",e.MAIN_GIFT_COOLDOWN="main_gift_cooldown",e.INSPECT_REDPOINT="inspect_redPoint",e.LIEMING_DOWN="lieming.down",e.LIEMING_EQUIP="lieming.equip",e.LIEMING_LVUP="lieming.lvup",e.SQ_TAB_REFRESH="sq.tab.refresh",e.XIANDAN_TAB_REFRESH="xiandan.tab.refresh",e.WANBAVIP_MAX="wanbavip.max",e.XIANSHAN_REFRESH="xianshan.refresh",e.MAGIC_HUANHUA="magic.huanhua",e}();__reflect(GameEvent.prototype,"GameEvent");var GameMessageEvent=function(e){function t(t,n){var a=e.call(this,t,!1,!1)||this;return a.message=n,a}return __extends(t,e),t}(egret.Event);__reflect(GameMessageEvent.prototype,"GameMessageEvent");var AllPeopleBossFight=function(e){function t(t){var n=e.call(this,t)||this;return n.RANK_SHOW_NUM=4,n.currBossHp=0,n.beforeBossHp=0,n.curXianShanId=0,n.xsBossId=0,n.intervalTime=1e3,n.timerRunTime=500,n.currRunTime=0,n.currDamageNum=0,n.selfRankDamage=0,n.selfRank=-1,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.OTHERBODY_ENTER_SCENE,this.onResAddOtherFightBodyMsg,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS?(GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_BOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_PK_MESSAGE.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_PVP_REVIVE.toString(),this.onResReborn,this),this.fight_info_bar.snatch_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSnatch,this)):this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS?(GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_OTHERPK_MSG.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_REBORN_MSG.toString(),this.onResReborn,this),this.fight_info_bar.snatch_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSnatch,this)):this._scenetype==FIGHT_SCENE.VIP_BOSS?(GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPBOSS_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPBOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPBOSS_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPBOSS_OTHERPK_MSG.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPBOSS_REBORN_MSG.toString(),this.onResReborn,this),this.fight_info_bar.snatch_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSnatch,this)):this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS&&(GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_PILL_TOP_MESSAGE.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_PILL_REWARD_MESSAGE.toString(),this.onResFightResult,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_PILL_FIGHT_MESSAGE.toString(),this.onXianShanResFightUpdateMsg,this))},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.OTHERBODY_ENTER_SCENE,this.onResAddOtherFightBodyMsg,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_BOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_OTHERPK_MSG.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_REBORN_MSG.toString(),this.onResReborn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_PK_MESSAGE.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_PVP_REVIVE.toString(),this.onResReborn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPBOSS_FIGHT_UPDATE_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPBOSS_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPBOSS_RANK_INFO_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPBOSS_OTHERPK_MSG.toString(),this.onResOtherPKMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPBOSS_REBORN_MSG.toString(),this.onResReborn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_PILL_FIGHT_MESSAGE.toString(),this.onXianShanResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_PILL_REWARD_MESSAGE.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_PILL_TOP_MESSAGE.toString(),this.onResRankMsg,this),this.fight_info_bar.snatch_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSnatch,this)},t.prototype.onParseFightMsg=function(t){if(e.prototype.onParseFightMsg.call(this,t),this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS){this.curXianShanId=t.getInt();var n=t.getShort();this.currBossHp=t.getLong(),GameFight.getInstance().allpeopleBossId=n;var a=JsonModelManager.instance.getModelxianshanzhaohuan()[n];return this.xsBossId=a.modelId,this.mainscene.getModuleLayer().showorhideDupRebornBar(!0),this.beforeBossHp=this.currBossHp,void this.onSwitchMap(a.map)}var i=t.getShort();GameFight.getInstance().allpeopleBossId=i,this.currBossHp=t.getLong(),this.beforeBossHp=this.currBossHp;var o=0;if(this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS){var r=JsonModelManager.instance.getModelquanminboss()[i];o=r.map,this.mainscene.getModuleLayer().showorhideDupRebornBar(!0)}else if(this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS){var s=JsonModelManager.instance.getModelxuezhanboss()[i];o=s.map,this.mainscene.getModuleLayer().showorhideDupRebornBar(!0)}else if(this._scenetype==FIGHT_SCENE.VIP_BOSS){var h=JsonModelManager.instance.getModelvipboss()[i];o=h.map,this.mainscene.getModuleLayer().showorhideDupRebornBar(!0)}this.onSwitchMap(o)},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.AllPeopleInfoBarSkin,DataManager.IS_PC_Game?this.fight_info_bar.x=Globar_Pos.x:this.fight_info_bar.width=size.width,this.fight_info_bar.y=size.height-200),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.fightInfos={},this.mainscene.heroBody.isDamageFalse=!0;var t,n=DataManager.getInstance().dupManager.allpeoplebossData,a=0;if(this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS){this.fight_info_bar.currentState="pk";var i=JsonModelManager.instance.getModelquanminboss()[GameFight.getInstance().allpeopleBossId];a=i.modelId,t=i.rewards[0]}else if(this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS){this.fight_info_bar.currentState="pk";var o=void 0;for(var r in n.xuezhanInfos)if(o=n.xuezhanInfos[r],o.id==GameFight.getInstance().allpeopleBossId){a=o.bossID;break}t=o.model.rewards[0]}else if(this._scenetype==FIGHT_SCENE.VIP_BOSS){this.fight_info_bar.currentState="pk";var o=n.vipbossInfos[GameFight.getInstance().allpeopleBossId];a=o.model.modelId,t=o.model.rewards[0]}else if(this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS){this.fight_info_bar.currentState="xianshan";var o=void 0;for(var r in n.xianshanInfos)if(o=n.xianshanInfos[r],o.id==GameFight.getInstance().allpeopleBossId){a=this.xsBossId;break}t=o.model.rewards[0]}this.fight_info_bar.other_probar.slideDuration=0,this.fight_info_bar.other_probar.maximum=100,this.fight_info_bar.show_award_icon.onUpdate(t.type,t.id,0,t.quality,t.num);var s=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId);if(this.monsterBody=this.mainscene.getBodyManager().onCreateMapBody(a,[s],BODY_TYPE.BOSS),this.monsterBody.isDamageFalse=!0,this.monsterBody.ignoreDist=!0,this.monsterBody.onClearTargets(),GameFight.getInstance().allpeopleOtherMsg)for(var h=GameFight.getInstance().allpeopleOtherMsg.getByte(),l=0;h>l;l++){var g=DataManager.getInstance().dupManager.allpeoplebossData.addOtherFightData(GameFight.getInstance().allpeopleOtherMsg);this.onCreateOtherFightBody(g,this.mainscene.mapInfo.getGridNearByNode(s,1,1))}else for(var l=0;l<DataManager.getInstance().dupManager.allpeoplebossData.otherFightDatas.length;l++)this.onCreateOtherFightBody(DataManager.getInstance().dupManager.allpeoplebossData.otherFightDatas[l],this.mainscene.mapInfo.getGridNearByNode(s,1,1));this.monsterBody.hp=this.currBossHp,Tool.addTimer(this.onTimerDown,this,this.timerRunTime),this.mainscene.getModuleLayer().onShowBossHpBar(this.monsterBody.data),GameFight.getInstance().allpeopleOtherMsg=null},t.prototype.onXianShanResFightUpdateMsg=function(e){var t=e.message;t.getInt();this.beforeBossHp=Math.max(0,this.currBossHp-this.currDamageNum),this.monsterBody.hp=this.beforeBossHp,this._status=FIGHT_STATUS.Fighting,this.currBossHp=t.getLong(),this.currDamageNum=0,this.beforeBossHp<=0&&(this.mainscene.getBodyManager().fightPause=!0,this.mainscene.getModuleLayer().onUpdateBossHpBar(0,this.monsterBody.data.maxHp))},t.prototype.onResFightUpdateMsg=function(e){var t=e.message;t.getShort();this.beforeBossHp=Math.max(0,this.currBossHp-this.currDamageNum),this.monsterBody.hp=this.beforeBossHp,this._status=FIGHT_STATUS.Fighting,this.currBossHp=t.getLong(),this.currDamageNum=0,this.beforeBossHp<=0&&(this.mainscene.getBodyManager().fightPause=!0,this.mainscene.getModuleLayer().onUpdateBossHpBar(0,this.monsterBody.data.maxHp))},t.prototype.onResAddOtherFightBodyMsg=function(e){var t=e.data;t&&this.onCreateOtherFightBody(t,[this.getRandomRebornNode()])},t.prototype.onCreateOtherFightBody=function(e,t){if(!(this.getOhterBodysById(e.playerId).length>0))for(var n=0;n<e.appears.length;n++){var a=new RobotData(n+1,BODY_TYPE.PLAYER);a.playerId=e.playerId,a.name=e.playerName,a.coatardLv=e.reinLv,a.onUpdateOnlyAppear(e.appears[n]);var i=this.mainscene.getBodyManager().onCreateOtherPlayer(a,t);i&&(i.isDamageFalse=!0,i.onAddEnemyBodyList([this.monsterBody]),i.onShowOrHideHpBar(!1),this.monsterBody.onAddEnemyBodyList([i]))}},t.prototype.onResOtherPKMsg=function(e){var t=this.mainscene.heroBody.data;if(!t.isDie){var n=e.message,a=(n.getShort(),new AllPeoplePKInfo);a.parseInfo(n);var i=new AllPeoplePKInfo;i.parseInfo(n),this.fightInfos[a.playerId+"vs"+i.playerId]=a,this.fightInfos[i.playerId+"vs"+a.playerId]=i;var o=GameFight.getInstance().onParsePVPEnemyMsg(n,!1)[0],r=this.getOhterBodysById(o.playerId)[0];r?r.data.hasArtifactEft||(r.data.hasArtifactEft=!0,r.data=o):(r=this.mainscene.getBodyManager().onCreateOtherPlayer(o,[this.getRandomRebornNode()]),r.data.hasArtifactEft=!0),r.isDamageFalse=!0,r.onRefreshShield();var s,h;a.playerId==this.player.id?(s=this.mainscene.heroBody.data,this.isPk||s.onRestHpInfo(a.startHp,a.totalHp),h=r.data,h.onRestHpInfo(i.startHp,i.totalHp),GameCommon.getInstance().addAlert(Language.instance.parseInsertText("allpeople_alert_2",o.name))):(s=r.data,s.onRestHpInfo(a.startHp,a.totalHp),h=this.mainscene.heroBody.data,this.isPk||h.onRestHpInfo(i.startHp,i.totalHp),GameCommon.getInstance().addAlert(Language.instance.parseInsertText("allpeople_alert_1",o.name))),this.mainscene.heroBody.data.shieldValue>0&&this.mainscene.heroBody.data.currentHp<this.mainscene.heroBody.data.maxHp&&(this.mainscene.heroBody.data.shieldValue=0,this.mainscene.heroBody.removeShieldAnim()),r.data.shieldValue>0&&r.data.currentHp<r.data.maxHp&&(r.data.shieldValue=0,r.removeShieldAnim());var l,g=0;l=0,g=a.playerId==this.player.id?FightDefine.ALLPEOPLE_FIGHT_ROUND:a.endHp>0?FightDefine.ALLPEOPLE_FIGHT_ROUND:FightDefine.ALLPEOPLE_FIGHT_ROUND-1,h.reborncount>0&&0==i.leftReborn&&(l=Tool.toInt(i.totalHp*h.rebornEffect/GameDefine.GAME_ADD_RATIO),l<i.endHp&&(l=0)),i.startHp>i.endHp?a.attackNum=Math.ceil((i.startHp+h.shieldValue+(l-i.endHp))/g):a.attackNum=0,l=0,g=i.playerId==this.player.id?FightDefine.ALLPEOPLE_FIGHT_ROUND:i.endHp>0?FightDefine.ALLPEOPLE_FIGHT_ROUND:FightDefine.ALLPEOPLE_FIGHT_ROUND-1,s.reborncount>0&&0==a.leftReborn&&(l=Tool.toInt(a.totalHp*s.rebornEffect/GameDefine.GAME_ADD_RATIO),l<a.endHp&&(l=0)),a.startHp>a.endHp?i.attackNum=Math.ceil((a.startHp+s.shieldValue+(l-a.endHp))/FightDefine.ALLPEOPLE_FIGHT_ROUND):i.attackNum=0,this.mainscene.getBodyManager().addEmenyBodyToAry(r),this.mainscene.heroBody.currTarget=r,r.onClearTargets(),r.onAddEnemyBodyList(this.mainscene.heroBodys),r.onShowOrHideHpBar(!0),!this.fightOhterData&&this.rankDamages&&this.rankDamages[0]&&(this.fightOhterData=this.rankDamages[0])}},Object.defineProperty(t.prototype,"isPk",{get:function(){return this.fightOhterData?!0:!1},enumerable:!0,configurable:!0}),t.prototype.getOhterBodysById=function(e){for(var t=[],n=0;n<this.mainscene.getBodyManager().otherPlayerBodys.length;n++){var a=this.mainscene.getBodyManager().otherPlayerBodys[n];a.data.playerId==e&&t.push(a)}return t},t.prototype.getRandomRebornNode=function(){var e=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),t=this.mainscene.mapInfo.getGridListByDistance(e,2),n=t[Math.floor(Math.random()*t.length)];return n=n?n:e},t.prototype.onTimerDown=function(){this.currRunTime+=this.timerRunTime,this.onUpdateBossHp(),this.currRunTime>=this.intervalTime?this.onSendFightInfo2Server():this.onUpdateRank()},t.prototype.onUpdateBossHp=function(){if(this.monsterBody){var e=this.beforeBossHp-this.currBossHp,t=0;t=Math.max(0,this.beforeBossHp-Math.ceil(e*(this.currRunTime/this.intervalTime))-this.currDamageNum),this.mainscene.getModuleLayer().onUpdateBossHpBar(t,this.monsterBody.data.maxHp),0==t&&this.onSendFightInfo2Server()}},t.prototype.onSendFightInfo2Server=function(){if(this.fightStatus==FIGHT_STATUS.Fighting){this._status=FIGHT_STATUS.Requset;var e=void 0;if(this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS)e=MESSAGE_ID.ALLPEOPLE_FIGHT_UPDATE_MSG;else if(this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS)e=MESSAGE_ID.XUEZHANBOSS_FIGHT_UPDATE_MSG;else if(this._scenetype==FIGHT_SCENE.VIP_BOSS)e=MESSAGE_ID.VIPBOSS_FIGHT_UPDATE_MSG;else if(this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS){e=MESSAGE_ID.BOSS_PILL_FIGHT_MESSAGE;var t=new Message(e);return t.setInt(this.curXianShanId),t.setLong(this.currDamageNum),GameCommon.getInstance().sendMsgToServer(t),void(this.currRunTime=0)}var n=new Message(e);n.setShort(GameFight.getInstance().allpeopleBossId),n.setLong(this.currDamageNum),GameCommon.getInstance().sendMsgToServer(n),this.currRunTime=0}},t.prototype.onKillTargetHandle=function(){},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);if(this.monsterBody===t&&a){if(!this.monsterBody||!n)return;for(var i=this.monsterBody.data.targets.length-1;i>=0;i--){var o=this.monsterBody.data.targets[i];o.data.isDie&&this.monsterBody.onRemoveTarget(o)}0==this.monsterBody.data.targets.length&&this.monsterBody.onAddEnemyBodyList(this.mainscene.heroBodys),this.fightStatus==FIGHT_STATUS.Fighting&&(this.currDamageNum+=n.value,this.selfRankDamage+=n.value,this.onUpdateBossHp()),t.addFlyFont(n)}else if(t.data.bodyType==BODY_TYPE.PLAYER&&e.data.bodyType==BODY_TYPE.SELF||t.data.bodyType==BODY_TYPE.SELF&&e.data.bodyType==BODY_TYPE.PLAYER){var r=e,s=t,h=this.fightInfos[r.data.playerId+"vs"+s.data.playerId];if(!h)return;var l=this.fightInfos[s.data.playerId+"vs"+r.data.playerId],g=s.data.shieldValue,c=Math.max(0,h.attackNum-s.data.shieldValue),p=Math.max(0,s.data.shieldValue-h.attackNum),u=s.data.currentHp-c;if(n.xishou=Math.max(0,g-s.data.shieldValue),s.data.shieldValue>0&&0==p&&s.removeShieldAnim(),s.data.shieldValue=p,s.hp=u,s.data.currentHp<=0)if(s.data.reborncount>0){s.data.reborncount=0;var d=Tool.toInt(l.totalHp*s.data.rebornEffect/GameDefine.GAME_ADD_RATIO);s.hp=Math.max(1,0>=u?d+u:d),s.onPlayRebornAnim()}else l.endHp>0?s.hp=l.endHp:(s.data.playerId==this.mainscene.heroBody.data.playerId?GameCommon.getInstance().addAlert(Language.instance.parseInsertText("allpeople_alert_4",r.data.name)):GameCommon.getInstance().addAlert(Language.instance.parseInsertText("allpeople_alert_3",s.data.name)),r.hp=h.endHp,s.onDeath(),!this.fightOhterData||this.fightOhterData.playerId!=s.data.playerId&&this.fightOhterData.playerId!=r.data.playerId||(this.fightOhterData=null),this.onPkFinishHandle(r,s));var _=this.fight_info_bar.other_probar;if(this.fightOhterData){var m=void 0;if(r.data.playerId==this.fightOhterData.playerId?m=r:s.data.playerId==this.fightOhterData.playerId&&(m=s),m){var E=Tool.toInt(m.data.currentHp/m.data.maxHp*100);0==E&&(E=m.data.currentHp>0?1:0),_.value=E,_.hp_label.text=E+"%"}}t.addFlyFont(n)}},t.prototype.onPkFinishHandle=function(e,t){if(delete this.fightInfos[e.data.playerId+"vs"+t.data.playerId],delete this.fightInfos[t.data.playerId+"vs"+e.data.playerId],this.rankDamages&&this.rankDamages[0]){var n=this.fight_info_bar.other_probar;n.playerHead.setHead(this.rankDamages[0].headidx,this.rankDamages[0].headFrame),n.name_lab.text=this.rankDamages[0].playerName,n.value=this.rankDamages[0].hpPercent,n.hp_label.text=this.rankDamages[0].hpPercent+"%"}},t.prototype.onFinishFight=function(e){},t.prototype.onResRankMsg=function(e){var t=e.message;this.selfRankDamage=t.getInt(),this.selfRank=-1,this.rankDamages=[];for(var n=t.getShort(),a=0;n>a;a++){var i=new BossDamageParam;i.index=a+1,i.playerId=t.getInt(),i.playerName=t.getString(),i.headidx=t.getByte(),i.headFrame=t.getByte(),i.damageNum=t.getInt(),i.isFight=1==t.getByte(),i.unionID=t.getInt(),i.hpPercent=t.getByte(),this.rankDamages.push(i),i.playerId==this.player.id&&(this.selfRank=a)}this.onUpdateRank(!1)},t.prototype.onUpdateRank=function(e){if(void 0===e&&(e=!0),this.rankDamages){if(this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS||this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS||this._scenetype==FIGHT_SCENE.VIP_BOSS){var t,n=this.fight_info_bar.other_probar;this.fightOhterData||(t=this.rankDamages[0],t?(n.visible=!0,this.fight_info_bar.snatch_btn.visible=t.playerId!=DataManager.getInstance().playerManager.player.id,n.playerHead.setHead(t.headidx,t.headFrame),n.name_lab.text=t.playerName,n.value=t.hpPercent,n.hp_label.text=t.hpPercent+"%"):(n.visible=!1,this.fight_info_bar.snatch_btn.visible=!1))}}},t.prototype.onSnatch=function(){this.rankDamages&&this.rankDamages[0]&&GameFight.getInstance().sendBossFightPkRequset(this.rankDamages[0].playerId)},t.prototype.onResReborn=function(e){var t=e.message,n=t.getInt();if(n>0)this.mainscene.getModuleLayer().onShowSamsaraReborn(n);else{this.mainscene.getModuleLayer().onHideSamsaraReborn(),this.mainscene.onupdateHero();var a=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(a),this.mainscene.heroBody.isDamageFalse=!0}},t.prototype.onResFightResult=function(t){e.prototype.onFinishFight.call(this,i),this.monsterBody&&(this.mainscene.getModuleLayer().onUpdateBossHpBar(0,this.monsterBody.data.maxHp),this.monsterBody.onDeath()),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime);var n=new DupWinParam,a=t.message,i=a.getByte();if(i==FightDefine.FIGHT_RESULT_SUCCESS){var o=a.getString();n.resultParam=o,n.dropList=GameFight.getInstance().onParseDropItems(a),this.mainscene.getBodyManager().onPlayDropEffect(n.dropList),Tool.callbackTime(this.onOpenResultPanel,this,2e3,n)}else this.onCloseResultView();this.fightOhterData=null,this.onUpdateRank()},t.prototype.onOpenResultPanel=function(e){this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS?e.specialDesc=Language.instance.getText("quanmin_teshushuoming"):this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS?e.specialDesc=Language.instance.getText("xuezhan_teshushuoming"):this._scenetype==FIGHT_SCENE.VIP_BOSS?e.specialDesc=Language.instance.getText("xuezhan_teshushuoming"):this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS&&(e.specialDesc=Language.instance.getText("xianshanboss_teshushuoming")),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",e))},Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.onCloseResultView=function(){this.mainscene.onReturnYewaiScene(),this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XianDanMainViewPanel")},t.prototype.onEnterSuccessScene=function(){var t=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onDeath=function(){for(var e=this.mainscene.heroBody.data.targets,t=0;t<e.length;t++)if(e[t].data.bodyType==BODY_TYPE.PLAYER||e[t].data.bodyType==BODY_TYPE.ROBOT){var n=e[t];n.onClearTargets(),n.onAddEnemyBodyList([this.monsterBody]),n.currTarget=this.monsterBody,this.mainscene.getBodyManager().removeEmenyBodyToAry(n),n.onShowOrHideHpBar(!1),this.onPkFinishHandle(this.mainscene.heroBody,n)}this.mainscene.getModuleLayer().onShowSamsaraReborn(FightDefine.ALLPEOPLE_REBORN_CD),this.mainscene.getBodyManager().refreshShieldOtherBody(),this.fightOhterData=null},t.prototype.onFightWin=function(){},t.prototype.onFightLose=function(){},t.prototype.onQuitScene=function(){if(GameFight.getInstance().fightsceneTpye==this.sceneTpye){var e;if(this._scenetype==FIGHT_SCENE.ALLPEOPLE_BOSS)e=MESSAGE_ID.ALLPEOPLE_BOSS_LEAVE_MSG;else if(this._scenetype==FIGHT_SCENE.XUEZHAN_BOSS)e=MESSAGE_ID.XUEZHANBOSS_LEAVE_MSG;else if(this._scenetype==FIGHT_SCENE.VIP_BOSS)e=MESSAGE_ID.VIPBOSS_LEAVE_MSG;else if(this._scenetype==FIGHT_SCENE.XIANSHAN_BOSS){var t=new Message(MESSAGE_ID.BOSS_PILL_QUIT_MESSAGE);return t.setInt(this.curXianShanId),GameCommon.getInstance().sendMsgToServer(t),void this.mainscene.onReturnYewaiScene()}var n=new Message(e);n.setShort(GameFight.getInstance().allpeopleBossId),GameCommon.getInstance().sendMsgToServer(n),this.mainscene.onReturnYewaiScene()}},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),DataManager.getInstance().dupManager.allpeoplebossData.removeAllOtherFightData(),this.monsterBody=null,GameFight.getInstance().allpeopleBossId=null,this.rankDamages=null,this.fightOhterData=null,this.fightInfos=null,this.mainscene.getModuleLayer().showorhideDupRebornBar(!1)},t}(BaseFightScene);__reflect(AllPeopleBossFight.prototype,"AllPeopleBossFight");var PetBody=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInitBodyHead=function(){e.prototype.onInitBodyHead.call(this),this.onShowOrHideHpBar(!1)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){egret.superSetter(t,this,"data",e)},enumerable:!0,configurable:!0}),t.prototype.onRefreshData=function(){this.onResetHeadInfo(),this.onUpdateHeadPos(),this.onUpdateAvatar()},t.prototype.updateAction=function(){this.onChangeBody()},t.prototype.updateDirection=function(){this.onChangeBody()},t.prototype.onChangeBody=function(){if(this._data){var e=LoadManager.getInstance().getPetResUrl(this.data.avata,this.actionName,this.getDirectionFrame());this._body?this._body.onUpdateRes(e,this._actionPlayNum,this.getDirectionFrame()):(this._body=new BodyAnimation(e,this._actionPlayNum,this.getDirectionFrame()),this.bodyLayer.addChildAt(this._body,PLAYER_LAYER.BODY),this._body.visible=this._bodyVisible)}},t.prototype.onAttack=function(){this.data.getCanUseSkill(),e.prototype.onAttack.call(this)},t.prototype.setFollowPaths=function(e){this.x=e.x,this.y=e.y,this.setMove([Tool.randomPosByDistance(e.x,e.y,300)]),1==this.alpha&&(this.alpha=0,egret.Tween.get(this).to({alpha:1},500))
},t.prototype.onResetHeadInfo=function(){this.bodyHead.bodyName=this.data.name,this.bodyHead.nameColor=this.data.playerData.bodyType==BODY_TYPE.SELF?5620991:16773120},t.prototype.onUpdateHeadPos=function(){this.bodyHead.x=-75,this.bodyHead.y=-100},t.prototype.onRestHpInfo=function(e,t){void 0===t&&(t=0)},Object.defineProperty(t.prototype,"hp",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bodyVisible",{set:function(e){egret.superSetter(PlayerBody,this,"bodyVisible",e),this._body&&(this._body.visible=e),this.onshoworhideShodow(e)},enumerable:!0,configurable:!0}),t.prototype.onReset=function(){egret.Tween.removeTweens(this),e.prototype.onReset.call(this)},t}(ActionBody);__reflect(PetBody.prototype,"PetBody");var CrossPVEBossFight=function(e){function t(t){var n=e.call(this,t)||this;n.LiveRound=0,n.currRound=0,n.timerRunTime=500;var a=Constant.get(Constant.KUAFU_BOSS_TIME).split(",");return n.totalTime=3600*(parseInt(a[1])-parseInt(a[0])),n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime)},Object.defineProperty(t.prototype,"PVEBossData",{get:function(){return DataManager.getInstance().dupManager.crossPVEBoss},enumerable:!0,configurable:!0}),t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t);var n=t.getShort();return this.model=JsonModelManager.instance.getModelkuafuboss()[n],this.model?(this.upDamage=t.getLong(),this.totalDamage=t.getLong(),this.startDamage=Math.max(0,this.totalDamage-this.upDamage),void this.onSwitchMap(this.model.map)):void GameCommon.getInstance().addAlert("error_tips_10006")},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.CrossPVEBossFightBar,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=size.height-198);var t=this.model.rewards[0];this.fight_info_bar.yulan_goods.onUpdate(t.type,t.id,null,t.quality),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.mainscene.heroBody.isDamageFalse=!0;var t=this.model.modelId,n=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId);this.monsterBody=this.mainscene.getBodyManager().onCreateMapBody(t,[n],BODY_TYPE.BOSS),this.monsterBody.isDamageFalse=!0,this.monsterBody.ignoreDist=!0,this.monsterBody.onClearTargets(),this.mainscene.getModuleLayer().onShowBossHpBar(this.monsterBody.data);var a=this.mainscene.mapInfo.getGridListByDistance(n,1);this.robots=[];for(var i=Math.round(2*Math.random())+2,o=0;i>o;o++){var r=this.mainscene.getBodyManager().onCreateFakerPlayerToSnece(.8,1.2,a,"");r.isDamageFalse=!0,r.onAddEnemyBodyList([this.monsterBody]),this.robots.push(r)}this.LiveRound=parseInt(Constant.get(Constant.KUAFU_BOSS_HUIHE));var s=this.LiveRound;this.mainscene.heroBody.data.reborncount>0&&(s+=2),this.oneDamage=Tool.toInt(this.upDamage/s),this.currRound=0,this.fight_info_bar.curr_damage_lab.text="0",this.fight_info_bar.total_damage_lab.text=(this.totalDamage-this.upDamage).toString(),this.fight_info_bar.live_left_lab.text="BOSS响指倒计时：10",Tool.addTimer(this.onTimerDown,this,this.timerRunTime),Tool.callbackTime(this.onShowBossSpeak,this,1e3,"当我打起这个响指时,你们这帮蝼蚁将灰飞烟灭...")},t.prototype.onShowBossSpeak=function(e){this.monsterBody.bodySpeak(e)},t.prototype.onTimerDown=function(){this.fight_info_bar.lefttime_lab.text=Language.instance.getText("shengyushijian")+"："+GameCommon.getInstance().getTimeStrForSec2(this.PVEBossData.lefttime,!1),this.PVEBossData.lefttime<=0&&this.monsterBody&&(this.monsterBody.data.onRestHpInfo(0,this.totalTime),this.monsterBody.onDeath()),this.onUpdateBossHP()},t.prototype.onUpdateBossHP=function(){this.mainscene.getModuleLayer().onUpdateBossHpBar(this.PVEBossData.lefttime,this.totalTime)},t.prototype.onBodyHurtHanlder=function(e,t,n){if(e.data.bodyType==BODY_TYPE.SELF){this.currRound++;var a=this.currRound*this.oneDamage;if(this.fight_info_bar.curr_damage_lab.text=Math.min(this.upDamage,a).toString(),this.fight_info_bar.total_damage_lab.text=Math.min(this.totalDamage,this.startDamage+a).toString(),this.LiveRound>this.currRound){var i=Math.ceil(10*(this.LiveRound-this.currRound)/this.LiveRound);this.fight_info_bar.live_left_lab.text="BOSS响指倒计时："+i}else if(this.fight_info_bar.live_left_lab.text="BOSS响指来袭",this.monsterBody.currTarget||(this.monsterBody.onAddEnemyBodyList([this.mainscene.heroBody]),this.monsterBody.currTarget=this.mainscene.heroBody),this.LiveRound==this.currRound||this.currRound==this.LiveRound+2){this.monsterBody.data.getCanUseSkill(),this.monsterBody.onAttack(),this.onShowBossAtkEffect(),this.robots&&(this.onShowBossSpeak("再见了，蝼蚁们！"),this.onKillAllRobots());var o=new DamageData;o.attacker=t,o.scenetype=FIGHT_SCENE.CROSS_PVE_BOSS,o.value=this.mainscene.heroBody.data.maxHp+this.mainscene.heroBody.data.shieldValue,o.fromDire=e.checkFace(e.x,e.y),e.onHurt(o)}}},t.prototype.onShowBossAtkEffect=function(){for(var e=new egret.Point(this.monsterBody.x,this.monsterBody.y-this.monsterBody.data.model.high/2),t=[0,90,180,270],n=0;n<t.length;n++){var a=GameCommon.getInstance().addAnimation("kf_pveboss_skill",e,this.mainscene.heroBody.parent,1);a.rotation=t[n]}e=null},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t),this.fight_info_bar.curr_damage_lab.text=this.upDamage.toString(),this.fight_info_bar.total_damage_lab.text=this.totalDamage.toString(),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),this.mainscene.getModuleLayer().onHideBossHpBar(),Tool.callbackTime(this.onResultWinHandler,this,1e3)},t.prototype.onResultWinHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ServerPVEBossDmgView",new ServerPVEBossDmgParam(this.model.id,this.upDamage,11)))},t.prototype.onKillAllRobots=function(){if(this.robots){for(var e=this.robots.length-1;e>=0;e--)this.mainscene.getBodyManager().onDestroyOhterOne(this.robots[e],!1),this.robots[e]=null;this.robots=null}},t.prototype.onEnterSuccessScene=function(){var t=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),n=this.mainscene.mapInfo.getGridListByDistance(t,2),a=n[Math.floor(Math.random()*n.length)];a=a?a:t;var i=this.mainscene.mapInfo.getXYByGridIndex(a.nodeId);this.mainscene.setHeroMapPostion(i),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onCloseResultView=function(){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_SERVERPVEBOSS)},t.prototype.onDestroyScene=function(){this.monsterBody=null,this.onKillAllRobots(),e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(CrossPVEBossFight.prototype,"CrossPVEBossFight");var DiFuDupFight=function(e){function t(t){var n=e.call(this,t)||this;return n._rerult=0,n._leftDupTime=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_RESULT_MESSAGE.toString(),this.onFightResult,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_RESULT_MESSAGE.toString(),this.onFightResult,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t);var n=t.getBoolean(),a=t.getByte();if(this._rerult=t.getByte(),this.dupStar=a,!n)return void this.onQuitScene();GameFight.getInstance().onEnterDupSuccess(26);var i=JsonModelManager.instance.getModelcopy()[26],o=i.subType;this._dupinfo=DataManager.getInstance().dupManager.getDupInfo(i.type,o),GameFight.getInstance().dupfight_waveIndex=o,this.onSwitchMap(this._dupinfo.dupModel.mapid)},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.DupInfoBarSkin,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=size.height-198),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.fightDrops=[],this.currPointIndex=0;var t=0;this.fight_info_bar.currentState="gerenboss";var n=this.fight_info_bar.geren_reward_grp;n.removeChildren(),this.difuCfg=JsonModelManager.instance.getModeldifu()[DataManager.getInstance().dupManager.xuezhanInfo.xuezhanWaveNum],this.rewards=GameCommon.getInstance().onParseAwardItemstr(this.difuCfg["reward"+this.dupStar]);for(var a=0;a<this.rewards.length;a++){var i=GameCommon.getInstance().createGoodsIntance(this.rewards[a]);n.addChild(i)}this.onFightHandler(),t>0?this.onStartDupTimer(t):this._leftDupTime=egret.getTimer()},t.prototype.onFightHandler=function(){if(this.onUpdateDupWave(),0!=this._rushData.refreshNum){this.mainscene.getBodyManager().onRushMonster(this._rushData);for(var e=100*this.difuCfg["nandu"+this.dupStar],t=this.mainscene.heroBody.data.targets[0],n=0;n<=ATTR_TYPE.MAGICDEF;n++)t.data.attributes[n]&&(t.data.attributes[n]+=Math.floor(t.data.attributes[n]*(e-GameDefine.GAME_ADD_RATIO)/GameDefine.GAME_ADD_RATIO))}},t.prototype.onStartDupTimer=function(e){this._leftDupTime=1e3*e+egret.getTimer(),e>0&&Tool.addTimer(this.onTimerHandler,this,1e3)},t.prototype.onStopDupTimer=function(){Tool.removeTimer(this.onTimerHandler,this,1e3)},t.prototype.onTimerHandler=function(){this.fight_info_bar.lefttime_lab.text=Language.instance.getText("shengyushijian")+"："+GameCommon.getInstance().getTimeStrForSec2(this.lefttime,!1),this.lefttime<=0&&this.onFightLose()},Object.defineProperty(t.prototype,"lefttime",{get:function(){return Math.max(0,Math.ceil((this._leftDupTime-egret.getTimer())/1e3))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTime",{get:function(){return Math.ceil((egret.getTimer()-this._leftDupTime)/1e3)},enumerable:!0,configurable:!0}),t.prototype.onFinishFight=function(t){if(this._status!=FIGHT_STATUS.Result){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.XUEZHAN_RESULT_MESSAGE);n.setByte(t),GameCommon.getInstance().sendMsgToServer(n),this.onStopDupTimer()}},t.prototype.onFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):n==FightDefine.FIGHT_RESULT_FAIL&&(DataManager.getInstance().dupManager.xuezhanInfo.onChangeInfo(t),this.onResultLoseHandler())},t.prototype.onResultWinHandler=function(e){var t=GameFight.getInstance().fightDupId;JsonModelManager.instance.getModelcopy()[t];DataManager.getInstance().dupManager.xuezhanInfo.onChangeInfo(e);var n=new DupWinParam;n.dupinfo=null,n.dropList=this.rewards;for(var a=this.fightDrops.length-1;a>=0;a--)n.dropList.unshift(this.fightDrops.shift());Tool.callbackTime(this.onOpenResultPanel,this,1e3,n)},t.prototype.onBodyHurtHanlder=function(t,n,a){var i=GameFight.getInstance().onCheckBodyIsHero(t.data);if(i){var o=t.data.targets;if(o.indexOf(n)<0)return;var r=1==this._rerult;t.hp<=10&&r&&(n.hp=0,t.hp=10,n.onDeath())}else if(n.data.bodyType==BODY_TYPE.SELF){var r=1==this._rerult;n.hp<=10&&(r||(n.hp=0,t.hp=10,t.onDeath()))}e.prototype.onBodyHurtHanlder.call(this,t,n,a)},t.prototype.onOpenResultPanel=function(e){var t="",n="";e.resultParam=t,e.specialDesc=n,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",e))},t.prototype.onResultLoseHandler=function(){this.isQuit||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null))},t.prototype.onTouchLeaveBtn=function(){var e=[{text:"中途退出则为失败，消耗一次复活次数，是否退出？"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onQuitScene,this)))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingMainPanel",0))},t.prototype.onKillTargetHandle=function(){e.prototype.onKillTargetHandle.call(this),this.onFightWin()},t.prototype.onEnterSuccessScene=function(){var t,n=DataManager.getInstance().dupManager.xuezhanLayerNum;Math.max(1,(n-1)*GameDefine.Xuezhan_LayerWaveNum+1);t=this.mainscene.mapInfo.getXYByGridIndex(this.mainscene.mapInfo.bronNodeId),this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onQuitScene=function(){this.isQuit=!0,this.onFightLose(),this.mainscene.onReturnYewaiScene()},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),this.isQuit=null,this.onStopDupTimer()},t.prototype.getRandomRebornNode=function(){var e=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),t=this.mainscene.mapInfo.getGridListByDistance(e,2),n=t[Math.floor(Math.random()*t.length)];return n=n?n:e},t.prototype.onUpdateDupWave=function(){this._rushData.monsterId=this.difuCfg.fightId,this._rushData.refreshGrid=this.difuCfg.point,this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_DUP_XUEZHAN},t}(BaseFightScene);__reflect(DiFuDupFight.prototype,"DiFuDupFight");var DupFight=function(e){function t(t){var n=e.call(this,t)||this;return n.sixiangRushPoints=[309,520,563,353],n.teamRushCount=0,n.LiveRound=0,n.currRound=0,n.timerRunTime=500,n._leftDupTime=0,n._teamheartSign=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_FIGHT_DUP_RESULT.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_SIXIANG_PROGRESS_MSG.toString(),this.onReciveSixiangResultMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TEAMDUP_TEAMDAMAGE_MESSAGE.toString(),this.onTeamDupUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TEAMDUP_DROPGOODS_MESSAGE.toString(),this.onReciveTeamdupDropMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TEAMDUP_QUITSCENE_MESSAGE.toString(),this.onTeamDupTimeout,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_FIGHT_DUP_RESULT.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_SIXIANG_PROGRESS_MSG.toString(),this.onReciveSixiangResultMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TEAMDUP_TEAMDAMAGE_MESSAGE.toString(),this.onTeamDupUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TEAMDUP_DROPGOODS_MESSAGE.toString(),this.onReciveTeamdupDropMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TEAMDUP_QUITSCENE_MESSAGE.toString(),this.onTeamDupTimeout,this),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t);var n=t.getByte();this.enterdupId=t.getInt();var a=t.getBoolean();if(!a)return void this.onQuitScene();GameFight.getInstance().onEnterDupSuccess(n);var i,o=JsonModelManager.instance.getModelcopy()[n];if(o.type==DUP_TYPE.DUP_PERSONALLY)i=t.getByte();else if(o.type==DUP_TYPE.DUP_TEAM||o.type==DUP_TYPE.DUP_VIP_TEAM||o.type==DUP_TYPE.DUP_MARRY||o.type==DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS){this.teamdupDatas=[],this.teamOwnerId=t.getInt();for(var r=t.getByte(),s=0;r>s;s++){var h=GameFight.getInstance().onParsePVPEnemyMsg(t),l=h[0];this.teamdupDatas.push(new TeamDupData(l))}this.teamdupDatas.push(new TeamDupData(this.mainscene.heroBody.data)),i=o.subType}else o.type==DUP_TYPE.DUP_LINGXING?(this.lingxingCopyModel=o,this.upDamage=t.getLong(),this.totalDamage=t.getLong(),this.startDamage=Math.max(0,this.totalDamage-this.upDamage),i=o.subType):i=o.subType;switch(this._dupinfo=DataManager.getInstance().dupManager.getDupInfo(o.type,i),this._dupinfo.dupModel.type){case DUP_TYPE.DUP_PERSONALLY:GameFight.getInstance().dupfight_waveIndex=i;break;case DUP_TYPE.DUP_CAILIAO:case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:case DUP_TYPE.DUP_VIP_TEAM:GameFight.getInstance().dupfight_waveIndex=n;break;case DUP_TYPE.DUP_CHALLENGE:GameFight.getInstance().dupfight_waveIndex=this._dupinfo.pass;break;case DUP_TYPE.DUP_UNION:GameFight.getInstance().dupfight_waveIndex=this._dupinfo.pass-1,this.unionPassed=t.getBoolean(),GameFight.getInstance().unionCheerNum=t.getShort();break;case DUP_TYPE.DUP_ZHUFU:GameFight.getInstance().dupfight_waveIndex=this._dupinfo.pass;break;case DUP_TYPE.DUP_SIXIANG:GameFight.getInstance().dupfight_waveIndex=1;break;case DUP_TYPE.DUP_XIANSHAN:GameFight.getInstance().dupfight_waveIndex=this._dupinfo.pass;break;case DUP_TYPE.DUP_BLESS:GameFight.getInstance().dupfight_waveIndex=this._dupinfo.pass}this.onSwitchMap(this._dupinfo.dupModel.mapid)},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.DupInfoBarSkin,DataManager.IS_PC_Game?this.fight_info_bar.x=Globar_Pos.x:this.fight_info_bar.width=size.width,this.fight_info_bar.y=size.height-this.fight_info_bar.height),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.fightDrops=[],this.currPointIndex=0;var t=0;switch(this._dupinfo.dupModel.type){case DUP_TYPE.DUP_PERSONALLY:this.fight_info_bar.currentState="gerenboss";var n=this.fight_info_bar.geren_reward_grp;n.removeChildren();var a=JsonModelManager.instance.getModelgerenboss()[GameFight.getInstance().dupfight_waveIndex],i=GameCommon.getInstance().onParseAwardItemstr(a.show);i=GameCommon.getInstance().concatAwardAry([i,a.rewards]);for(var o=0;o<i.length;o++){var r=GameCommon.getInstance().createGoodsIntance(i[o]);n.addChild(r)}break;case DUP_TYPE.DUP_CAILIAO:this.fight_info_bar.currentState="cailiao";var s=this._dupinfo.nextModel,h=this._dupinfo.dupModel.rewards[0];if(this.fight_info_bar.cailiao_awd_item.onUpdate(h.type,h.id,0,h.quality,h.num),s){var l=Language.instance.getText("coatard_level"+s.lvlimit,"jingjie"),g="[#ecd6a2"+l+"]"+Language.instance.getText("kaiqixiayinandu");this.fight_info_bar.cailiao_tisheng_lab.text=Language.instance.getText("chanchutisheng"),this.fight_info_bar.cailiao_limit_lab.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml(g))}else this.fight_info_bar.cailiao_tisheng_lab.text="",this.fight_info_bar.cailiao_limit_lab.text="";break;case DUP_TYPE.DUP_ZHUFU:this.fight_info_bar.currentState="blessdup",this.blessRushCount=0;var c=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex];this.blessLeftCount=c.maxNum,this.fight_info_bar.bless_pro_bar.maximum=c.maxNum,this.fight_info_bar.bless_pro_bar.value=0,this.fight_info_bar.bless_pro_bar.labelDisplay.visible=!1,this.fight_info_bar.bless_pronum_lab.text="0/"+c.maxNum;for(var p=c.numReward.split("#"),u=0;3>u;u++)if(p.length>u){this.fight_info_bar["bless_awd_grp"+u].visible=!0;var d=Math.min(c.maxNum,parseInt(p[u]));this.fight_info_bar["bless_awdstage_lab"+u].text=d+Language.instance.getText("kill")}else this.fight_info_bar["bless_awd_grp"+u].visible=!1;t=c.maxTimes,GameFight.getInstance().onSendBlessDupProgressMsg(0);break;case DUP_TYPE.DUP_UNION:t=DupDefine.UnionDup_Limit_Time;break;case DUP_TYPE.DUP_CHALLENGE:this.fight_info_bar.currentState="tiaozhan";var _=this.fight_info_bar.tiaozhan_reward_grp;_.removeChildren();var m=JsonModelManager.instance.getModelzhuxiantai()[this._dupinfo.pass];if(m)for(var E=0;E<m.rewards.length;E++){var f=m.rewards[E],y=GameCommon.getInstance().createGoodsIntance(f);y.onUpdate(f.type,f.id,0,f.quality,f.num),_.addChild(y)}this.playBossIncomeAnim();break;case DUP_TYPE.DUP_SIXIANG:this.fight_info_bar.currentState="sixiang";var I=this.fight_info_bar.sixiang_awd_grp;if(0==I.numChildren)for(var v=0;v<DupDefine.SixiangDup_Drops_Id.length;v++){var S=new AwardItem(GOODS_TYPE.ITEM,DupDefine.SixiangDup_Drops_Id[v]),T=GameCommon.getInstance().createGoodsIntance(S);T.num_label.text="0",I.addChild(T)}else for(var M=0;M<I.numChildren;M++){var A=I.getChildAt(M);A.num_label.text="0"}this.sixiangNpcBody=this.mainscene.getBodyManager().onCreateMapBody(DupDefine.SixiangDup_Npc_Id,[this.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId)],BODY_TYPE.NPC,!1);break;case DUP_TYPE.DUP_TEAM:this.fight_info_bar.currentState="teamdup",this.teamRushCount=0,this._teamheartSign=0,this.teamdupOthers=[];for(var P="",D="",u=0;u<this.teamdupDatas.length;u++){var b=this.teamdupDatas[u].playerdata,G=u+1;if(P+=G+" "+GameCommon.getInstance().getNickname(b.name)+"\n",D+="0\n",this.fight_info_bar.teamdup_name_lab.text=P,this.fight_info_bar.teamdup_dmgnum_lab.text=D,b.playerId!=DataManager.getInstance().playerManager.player.id){var C=this.mainscene.getBodyManager().onCreateOtherPlayer(b,[this.getRandomRebornNode()]);this.teamdupOthers.push(C)}}var R=Math.max(1,this._dupinfo.diffcult);this.fight_info_bar.teamdup_dropdec_lab.text=Language.instance.getText("zuduifuben_drop_diff"+R),t=DupDefine.TeamDup_Limit_Time,this.startTeamdupHeart();break;case DUP_TYPE.DUP_VIP_TEAM:this.fight_info_bar.currentState="vipteam",this.teamRushCount=0,this._teamheartSign=0,this.teamdupOthers=[];for(var P="",D="",u=0;u<this.teamdupDatas.length;u++){var b=this.teamdupDatas[u].playerdata,G=u+1;if(P+=G+" "+GameCommon.getInstance().getNickname(b.name)+"\n",D+="0\n",this.fight_info_bar.teamdup_name_lab.text=P,this.fight_info_bar.teamdup_dmgnum_lab.text=D,b.playerId!=DataManager.getInstance().playerManager.player.id){var C=this.mainscene.getBodyManager().onCreateOtherPlayer(b,[this.getRandomRebornNode()]);this.teamdupOthers.push(C)}}this.fight_info_bar.teamdup_dropdec_lab.text="诛仙礼包",t=DupDefine.VipTeam_Limit_Time,this.startTeamdupHeart();break;case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:this.fight_info_bar.currentState="marry",this.teamRushCount=0,this._teamheartSign=0,this.teamdupOthers=[];for(var P="",D="",u=0;u<this.teamdupDatas.length;u++){var b=this.teamdupDatas[u].playerdata,G=u+1;if(P+=G+" "+GameCommon.getInstance().getNickname(b.name)+"\n",D+="0\n",this.fight_info_bar.teamdup_name_lab.text=P,b.playerId!=DataManager.getInstance().playerManager.player.id){var C=this.mainscene.getBodyManager().onCreateOtherPlayer(b,[this.getRandomRebornNode()]);this.teamdupOthers.push(C)}}this.fight_info_bar.teamdup_dropdec_lab.text="仙缘礼包",t=DupDefine.MarryTeam_Limit_Time,this.startTeamdupHeart();break;case DUP_TYPE.DUP_XIANSHAN:this.fight_info_bar.currentState="tiaozhan";var L=this.fight_info_bar.tiaozhan_reward_grp;L.removeChildren(),this.playBossIncomeAnim();break;case DUP_TYPE.DUP_BLESS:this.fight_info_bar.currentState="gerenboss";var N=this.fight_info_bar.geren_reward_grp;N.removeChildren();for(var w=JsonModelManager.instance.getModelpeishiboss()[DataManager.getInstance().newactivitysManager.blessTp],O=GameCommon.getInstance().onParseAwardItemstr(w.show),B=0;B<O.length;B++){var r=GameCommon.getInstance().createGoodsIntance(O[B]);N.addChild(r)}break;case DUP_TYPE.DUP_LINGXING:this.fight_info_bar.currentState="lingxingBoss";var U=[];Constant.get("FULING_BOSS_GAINID").indexOf("#")>=0&&(U=Constant.get("FULING_BOSS_GAINID").split("#"));for(var k="",x=0;1>x;x++){var H=U[U.length-1].split(",");k+="3,"+H[1]+",1"}var F=GameCommon.getInstance().onParseAwardItemstr(k),Y=F[0];this.fight_info_bar.yulan_goods.onUpdate(Y.type,Y.id,null,Y.quality);var W=parseInt(Constant.get("FULING_BOSS_MODEL_ID")),V=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId);this.fulingBossBody=this.mainscene.getBodyManager().onCreateMapBody(W,[V],BODY_TYPE.BOSS),this.fulingBossBody.isDamageFalse=!0,this.fulingBossBody.ignoreDist=!0,this.fulingBossBody.onClearTargets(),this.mainscene.getModuleLayer().onShowBossHpBar(this.fulingBossBody.data),this.currRound=0,this.LiveRound=parseInt(Constant.get("FULING_BOSS_HUIHE"));var j=this.LiveRound;return this.mainscene.heroBody.data.reborncount>0&&(j+=2),this.oneDamage=Tool.toInt(this.upDamage/j),this.fight_info_bar.curr_damage_lab.text="0",this.fight_info_bar.live_left_lab.text="倒计时：10",Tool.addTimer(this.onTimerDown,this,this.timerRunTime),void Tool.callbackTime(this.onShowBossSpeak,this,1e3,"灰飞烟灭...")}this.onFightHandler(),t>0?this.onStartDupTimer(t):this._leftDupTime=egret.getTimer()},t.prototype.onTimerDown=function(){},t.prototype.onFightHandler=function(){if(this.onUpdateDupWave(),0!=this._rushData.refreshNum){switch(this._dupinfo.dupModel.type){case DUP_TYPE.DUP_UNION:if(this.mainscene.onPauseBodys(this.mainscene.heroBodys,!0),this.unionNpcBody)this.unionNpcBody.data.onRebirth();else{var e=new RushEnemyData;e.monsterId=DupDefine.SixiangDup_Npc_Id,e.refreshGrid=this.mainscene.mapInfo.bronNodeId,this.unionNpcBody=this.mainscene.getBodyManager().onRushNpcToScene(e,NPC_BODY_TYPE.SIXIANG)}if(this.unionBoossBody=this.mainscene.getBodyManager().onCreateMapBody(this.rushData.monsterId,[this.mapInfo.getNodeModelByIndex(GameDefine.UnionDup_Boss_Node)],BODY_TYPE.BOSS),this.unionBoossBody.isDamageFalse=!0,this.unionPassed){var t=Math.ceil(this.unionBoossBody.data.currentHp*(100-DupDefine.UnionDup_Derate_Rate)/100);this.unionBoossBody.data.onRestHpInfo(t,t),this.unionBoossBody.onRefreshData()}if(this.unionBoossBody.onAddEnemyBodyList([this.unionNpcBody]),this.unionBossAtkTime=0,this.mainscene.getModuleLayer().onShowBossHpBar(this.unionBoossBody.data),this.mainscene.getModuleLayer().onUpdateBossHpBar(this.unionBoossBody.data.currentHp,this.unionBoossBody.data.maxHp),GameFight.getInstance().unionCheerNum>0)for(var n=DataManager.getInstance().unionManager.getCheerAttrAddRate(GameFight.getInstance().unionCheerNum),a=0;a<this.mainscene.heroBodys.length;a++){var i=this.mainscene.heroBodys[a].data,o=Math.ceil(i.currentHp*(100+n)/100);i.onRestHpInfo(o,o),this.mainscene.heroBodys[a].onRefreshData()}break;case DUP_TYPE.DUP_ZHUFU:for(var r=void 0,s=[],h=0;h<this._rushData.refreshNum;h++){if(0==s.length)for(var l=0;l<DupDefine.BLESSDUP_POINTS.length;l++)s.push(DupDefine.BLESSDUP_POINTS[l]);r=s[Math.floor(Math.random()*s.length)];var g=this.mapInfo.getNodeModelByIndex(r),c=this.mainscene.getBodyManager().onCreateMapBody(this._rushData.monsterId,[g],BODY_TYPE.MONSTER);c.data.warnDist=DupDefine.BlessDup_WarnDist}var p=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex];this.blessdupRushTime=1e3*p.rushTime+egret.getTimer(),this.blessdupMsgStemp=0;break;case DUP_TYPE.DUP_SIXIANG:GameFight.getInstance().onSendSixiangDupResultMsg(0);var u=new eui.Component;u.skinName=skins.FightWavePromptBarSkin,u.part_num_lab.text=Language.instance.parseInsertText("dijibo",GameFight.getInstance().dupfight_waveIndex),this.mainscene.getModuleLayer().addToMainview(u),u.x=-500,u.y=size.height-460,egret.Tween.get(u).to({x:0},600,egret.Ease.backInOut),Tool.callbackTime(function(e){e.parent&&e.parent.removeChild(e),egret.Tween.removeTweens(e),e=null},this,1500,u),this.sixiangNpcBody.data.onRebirth();break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:this.mainscene.getBodyManager().onRushMonster(this.rushData);for(var a=0;a<this.teamdupOthers.length;a++){var d=this.teamdupOthers[a];d.isDamageFalse=this._rushData.isBoss,d.onClearTargets(),d.onAddEnemyBodyList(this.mainscene.heroBody.data.targets)}for(var a=0;a<this.mainscene.heroBody.data.targets.length;a++){var _=this.mainscene.heroBody.data.targets[a];_.isDamageFalse=!0}this.mainscene.heroBody.isDamageFalse=this._rushData.isBoss;break;default:this.mainscene.getBodyManager().onRushMonster(this.rushData)}this._rushData&&this._rushData.isBoss&&this.mainscene.onupdateHero()}},t.prototype.onSixiangRushMonster=function(){this.sixiangLeftTime=this.rushData.limittime,this.sixiangAtkTime=0,this.mainscene.getBodyManager().onRushMonster(this.rushData);for(var e=0;e<this.mainscene.heroBody.data.targets.length;e++){var t=this.mainscene.heroBody.data.targets[e];t.isDamageFalse=!0,t.onAddEnemyBodyList([this.sixiangNpcBody]),this._rushData.isBoss?(this.mainscene.getModuleLayer().onShowBossHpBar(t.data),this.mainscene.getModuleLayer().onUpdateBossHpBar(t.data.currentHp,t.data.maxHp)):this.mainscene.getModuleLayer().onHideBossHpBar()}},t.prototype.onStartDupTimer=function(e){this._leftDupTime=1e3*e+egret.getTimer(),e>0&&Tool.addTimer(this.onTimerHandler,this,1e3)},t.prototype.onStopDupTimer=function(){Tool.removeTimer(this.onTimerHandler,this,1e3)},t.prototype.onTimerHandler=function(){switch(this.fight_info_bar.lefttime_lab.text=Language.instance.getText("shengyushijian")+"："+GameCommon.getInstance().getTimeStrForSec2(this.lefttime,!1),this._dupinfo.dupModel.type){case DUP_TYPE.DUP_UNION:this.mainscene.heroBody.data.isStop&&this.unionNpcBody.distanceToSelf(this.unionBoossBody)<400&&this.mainscene.onPauseBodys(this.mainscene.heroBodys,!1);break;case DUP_TYPE.DUP_ZHUFU:this.blessdupMsgStemp++;var e=this.blessdupRushTime-egret.getTimer();0>=e&&this.lefttime>0&&this.mainscene.heroBody.data.targets.length<60?this.onFightWin():this.blessdupMsgStemp>5&&(this.blessdupMsgStemp=0,GameFight.getInstance().onSendBlessDupProgressMsg(1,this.blessLeftCount))}this.lefttime<=0&&this.onFightLose()},Object.defineProperty(t.prototype,"lefttime",{get:function(){return Math.max(0,Math.ceil((this._leftDupTime-egret.getTimer())/1e3))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useTime",{get:function(){return Math.ceil((egret.getTimer()-this._leftDupTime)/1e3)},enumerable:!0,configurable:!0}),t.prototype.startTeamdupHeart=function(){Tool.addTimer(this.onTeamDupHeart,this,1e3)},t.prototype.stopTeamdupHeart=function(){Tool.removeTimer(this.onTeamDupHeart,this,1e3)},t.prototype.onTeamDupHeart=function(){this._teamheartSign<egret.getTimer()&&this.sendTeamDupHeartMsg()},t.prototype.sendTeamDupHeartMsg=function(e){if(void 0===e&&(e=0),this._status==FIGHT_STATUS.Fighting){this._teamheartSign=egret.getTimer()+1e3;var t=new Message(MESSAGE_ID.TEAMDUP_TEAMDAMAGE_MESSAGE);t.setByte(this.teamRushCount),t.setLong(e),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onFinishFight=function(t){if(this._status!=FIGHT_STATUS.Result){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.GAME_FIGHT_DUP_RESULT);n.setByte(t),n.setInt(this.enterdupId),GameCommon.getInstance().sendMsgToServer(n),this.onStopDupTimer()}},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):n==FightDefine.FIGHT_RESULT_FAIL&&this.onResultLoseHandler(),this.stopTeamdupHeart()
},t.prototype.onReciveSixiangResultMsg=function(e){var t=e.message,n=t.getBoolean();if(!n){var a=GameFight.getInstance().onParseDropItems(t),i=this.fight_info_bar.sixiang_awd_grp;this.mainscene.getBodyManager().onPlayDropEffect(a);for(var o in a)for(var r=0;r<i.numChildren;r++){var s=a[o],h=i.getChildAt(r),l=h.model;if(l.id==s.id){var g=s.num+parseInt(h.num_label.text);h.num_label.text=g+"";break}}this.fightDrops=GameCommon.getInstance().concatAwardAry([this.fightDrops,a])}this.onSixiangRushMonster()},t.prototype.onTeamDupUpdateMsg=function(e){var t=(DataManager.getInstance().playerManager.player,e.message),n=!1,a=t.getLong(),i=t.getByte();i>this.teamRushCount&&(this.teamRushCount=i,n=!0);for(var o,r=t.getByte(),s=0;r>s;s++){var h=(t.getInt(),t.getString());for(var l in this.teamdupDatas)if(o=this.teamdupDatas[l],o.playerName==h){o.parseDamageMsg(t);break}}if(this._rushData.isBoss){this.teamdupDatas.sort(function(e,t){return e.damageNum>t.damageNum?-1:e.damageNum==t.damageNum?0:1});for(var g="",c="",p=0;p<this.teamdupDatas.length;p++){o=this.teamdupDatas[p];var u=p+1;g+=u+" "+GameCommon.getInstance().getNickname(o.playerName)+"\n",c+=GameCommon.getInstance().getFormatNumberShow(o.damageNum)+"\n"}this.fight_info_bar.teamdup_name_lab.text=g,this.fight_info_bar.teamdup_dmgnum_lab.text=c}if(n){this.mainscene.getModuleLayer().onHideBossHpBar(),this.mainscene.heroBody.data.targets.length>0&&this.mainscene.getBodyManager().onDestroyAllHeroTarget();for(var d=0;d<this.teamdupOthers.length;d++){var _=this.teamdupOthers[d];_.onClearTargets()}Tool.callbackTime(this.onFightWin,this,2e3)}else{var m=this.mainscene.heroBody.currTarget;m&&(m.hp=a,0>=a?m.onDeath():this.mainscene.getModuleLayer().onUpdateBossHpBar(a,m.data.maxHp))}},t.prototype.onReciveTeamdupDropMsg=function(e){var t=e.message,n=GameFight.getInstance().onParseDropItems(t);this.mainscene.getBodyManager().onPlayDropEffect(n),this.fightDrops=GameCommon.getInstance().concatAwardAry([this.fightDrops,n])},t.prototype.onResultWinHandler=function(e){var t,n,a=GameFight.getInstance().fightDupId,i=JsonModelManager.instance.getModelcopy()[a];i.type==DUP_TYPE.DUP_PERSONALLY?(t=e.getShort(),n=t):(t=i.subType,n=e.getShort());var o=DataManager.getInstance().dupManager.getDupInfo(i.type,t);o.pass=n,o.dupModel.type==DUP_TYPE.DUP_CHALLENGE&&DataManager.getInstance().playerManager.player.updateZhuxianTai(n);var r=new DupWinParam;r.dupinfo=o,r.dropList=GameFight.getInstance().onParseDropItems(e);for(var s=this.fightDrops.length-1;s>=0;s--)r.dropList.unshift(this.fightDrops.shift());Tool.callbackTime(this.onOpenResultPanel,this,1e3,r)},t.prototype.onOpenResultPanel=function(e){var t="",n="",a=0;switch(this._dupinfo.type){case DUP_TYPE.DUP_CAILIAO:var i=this._dupinfo.nextModel;if(i){var o=Language.instance.getText("coatard_level"+i.lvlimit,"jingjie");"[#ecd6a2"+o+"]"+Language.instance.getText("kaiqixiayinandu")}t=Language.instance.getText("tongguan","time")+"："+GameCommon.getInstance().getTimeStrForSec2(this.useTime,!1);break;case DUP_TYPE.DUP_ZHUFU:var r=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex],s=r.maxNum-this.blessLeftCount;t=Language.instance.getText("current2","jisha")+"："+s+"/"+r.maxNum,this.blessLeftCount<=0?(r=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex+1],r?(n=Language.instance.getText("gongxitongguan","！","\n","dup","open"),n+="[#ecd6a2"+Language.instance.parseInsertText("dijizhang",r.id)+"],",n+=Language.instance.getText("nadutisheng","jianglitisheng")):n=Language.instance.getText("current","dadao","zuigaonandu")):n=Language.instance.getText("jisha",r.maxNum,"zhiguai","kaiqixiayinandu");break;case DUP_TYPE.DUP_SIXIANG:n=Language.instance.getText("gongxitongguan"),a=ModelManager.getInstance().getModelLength("sixiangfuben"),t=Language.instance.parseInsertText("bencijishaboshu",GameFight.getInstance().dupfight_waveIndex-1);for(var h=GameFight.getInstance().dupfight_waveIndex;a>h;h++){var l=JsonModelManager.instance.getModelsixiangfuben()[h];if(l.firstRewards){var g=GameCommon.getInstance().getModelThingByParam(l.firstRewards);n=Language.instance.parseInsertText("tongguankeerwaihuode",l.id)+g.name;break}}break;case DUP_TYPE.DUP_CHALLENGE:n=Language.instance.getText("gongxitongguan"),t=Language.instance.getText("gongxitongguan")+Language.instance.parseInsertText("dijiguan",GameFight.getInstance().dupfight_waveIndex),a=ModelManager.getInstance().getModelLength("zhuxiantai");for(var c=void 0,h=GameFight.getInstance().dupfight_waveIndex;a>h;h++){var p=JsonModelManager.instance.getModelzhuxiantai()[h];for(var u in p.rewards){var d=p.rewards[u];if(d.id==GoodsDefine.ITEM_ID_CZSP){c=GameCommon.getInstance().getThingModel(d.type,d.id);break}}if(c){n=Language.instance.parseInsertText("tongguankeerwaihuode",p.id)+c.name;break}}break;case DUP_TYPE.DUP_TEAM:for(var _=void 0,m=void 0,h=0;h<this.teamdupDatas.length;h++)if(_=h+1,m=this.teamdupDatas[h],m.playerId==DataManager.getInstance().playerManager.player.id){t=Language.instance.getText("wodepaiming",_," ","dps",m.damageNum);break}var E=JsonModelManager.instance.getModelzuduifuben()[GameFight.getInstance().dupfight_waveIndex],f=GameCommon.getInstance().getModelThingByParam(E.viprewards);n=Language.instance.parseInsertText("MPVkedejiangli",f.name);break;case DUP_TYPE.DUP_VIP_TEAM:for(var y=void 0,h=0;h<this.teamdupDatas.length;h++)if(y=this.teamdupDatas[h],y.playerId==this.teamOwnerId){t=Language.instance.getText("zhaohuanzhe","：",y.playerName);break}break;case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:for(var I=void 0,h=0;h<this.teamdupDatas.length;h++)if(I=this.teamdupDatas[h],I.playerId==this.teamOwnerId){t=Language.instance.getText("zhaohuanzhe","：",I.playerName);break}break;case DUP_TYPE.DUP_XIANSHAN:n=Language.instance.getText("gongxitongguan"),DataManager.getInstance().xiandanManager.curLayer=DataManager.getInstance().xiandanManager.curLayer+1;break;case DUP_TYPE.DUP_BLESS:n=Language.instance.getText("gongxitongguan");break;case DUP_TYPE.DUP_LINGXING:n=Language.instance.getText("gongxitongguan")}e.resultParam=t,e.specialDesc=n,this._dupinfo.dupModel.type==DUP_TYPE.DUP_SIXIANG?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SixiangDupResultPanel",e)):GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",e))},t.prototype.onResultLoseHandler=function(){this.isQuit||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null))},t.prototype.onCloseResultView=function(e){GameFight.getInstance().canContiuneDup(this._dupinfo.id)?GameFight.getInstance().onSendEnterDupMsg(this._dupinfo.id):(this.mainscene.onReturnYewaiScene(),this._rushData.back_goType>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this._rushData.back_goType))},t.prototype.onBodyHurtHanlder=function(t,n,a){var i=GameFight.getInstance().onCheckBodyIsHero(t.data);switch(this._dupinfo.type){case DUP_TYPE.DUP_ZHUFU:if(i){var o=this.mainscene.heroBody.data.targets;if(o.indexOf(n)<0)return;0==n.data.targets.length&&n.onAddEnemyBodyList(this.mainscene.heroBodys)}break;case DUP_TYPE.DUP_UNION:if(e.prototype.onBodyHurtHanlder.call(this,t,n,a),!i&&this.unionNpcBody&&n===this.unionNpcBody){0==this.unionBossAtkTime&&(this.unionBossAtkTime=this.lefttime+1);var r=Math.floor((this.unionBossAtkTime-this.lefttime)/this.unionBossAtkTime*n.data.maxHp),s=n.data.maxHp-r;s<n.data.currentHp&&(n.hp=s)}break;case DUP_TYPE.DUP_SIXIANG:if(i)this._rushData.isBoss&&this.mainscene.getModuleLayer().onUpdateBossHpBar(n.data.currentHp,n.data.maxHp);else if(this.sixiangNpcBody&&n===this.sixiangNpcBody){var h=this.sixiangAtkTime?egret.getTimer()-this.sixiangAtkTime:500;this.sixiangAtkTime=egret.getTimer(),this.sixiangLeftTime=Math.max(0,this.sixiangLeftTime-h);var l=this.sixiangNpcBody.data,g=Math.floor(this.sixiangLeftTime/this.rushData.limittime*l.maxHp);g<l.currentHp&&(this.sixiangNpcBody.hp=g),0>=g&&this.onFightLose()}break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:e.prototype.onBodyHurtHanlder.call(this,t,n,a),i&&this._rushData.isBoss&&(this.sendTeamDupHeartMsg(a.value),n.addFlyFont(a));break;case DUP_TYPE.DUP_LINGXING:if(t.data.bodyType==BODY_TYPE.SELF){this.currRound++;var c=this.currRound*this.oneDamage;if(this.fight_info_bar.curr_damage_lab.text=Math.min(this.upDamage,c).toString(),n.hp=n.data.maxHp-this.oneDamage*this.currRound,n.data.onRestHpInfo(n.data.maxHp-this.oneDamage*this.currRound,0),this.mainscene.getModuleLayer().onUpdateBossHpBar(n.data.currentHp,n.data.maxHp),this.LiveRound>this.currRound){var p=Math.ceil(10*(this.LiveRound-this.currRound)/this.LiveRound);this.fight_info_bar.live_left_lab.text="倒计时："+p}else if(this.fight_info_bar.live_left_lab.text="灰飞烟灭！",this.fulingBossBody.currTarget||(this.fulingBossBody.onAddEnemyBodyList([this.mainscene.heroBody]),this.fulingBossBody.currTarget=this.mainscene.heroBody),this.LiveRound==this.currRound||this.currRound==this.LiveRound+2){this.fulingBossBody.data.getCanUseSkill(),this.fulingBossBody.onAttack(),this.onShowBossAtkEffect(),this.onShowBossSpeak("灰飞烟灭！");var u=new DamageData;u.attacker=n,u.scenetype=FIGHT_SCENE.DUP,u.value=this.mainscene.heroBody.data.maxHp+this.mainscene.heroBody.data.shieldValue,u.fromDire=t.checkFace(t.x,t.y),t.onHurt(u)}}default:e.prototype.onBodyHurtHanlder.call(this,t,n,a)}},t.prototype.onShowBossSpeak=function(e){this.fulingBossBody.bodySpeak(e)},t.prototype.onShowBossAtkEffect=function(){for(var e=new egret.Point(this.fulingBossBody.x,this.fulingBossBody.y-this.fulingBossBody.data.model.high/2),t=[0,90,180,270],n=0;n<t.length;n++){var a=GameCommon.getInstance().addAnimation("kf_pveboss_skill",e,this.mainscene.heroBody.parent,1);a.rotation=t[n]}e=null},t.prototype.onKillTargetHandle=function(){switch(e.prototype.onKillTargetHandle.call(this),this._dupinfo.dupModel.type){case DUP_TYPE.DUP_ZHUFU:this._status==FIGHT_STATUS.Fighting&&(this.blessLeftCount=Math.max(this.blessLeftCount-1,0),this.onupdateBlessProInfo(),0==this.blessLeftCount&&this.onFightWin());break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:for(var t=0;t<this.teamdupOthers.length;t++)for(var n=this.teamdupOthers[t],a=n.data.targets.length-1;a>=0;a--){var i=n.data.targets[a];(!i||i.data.isDie)&&n.onRemoveTarget(i)}}},t.prototype.onupdateBlessProInfo=function(){for(var e=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex],t=e.maxNum-this.blessLeftCount,n=e.numReward.split("#"),a=0;3>a;a++)if(n.length>a){var i=Math.min(e.maxNum,parseInt(n[a]));this.fight_info_bar["bless_box_img"+a].source=i>t?"jianchi_box_2_png":"jianchi_box_1_png"}this.fight_info_bar.bless_pro_bar.value=t,this.fight_info_bar.bless_pronum_lab.text=t+"/"+e.maxNum},t.prototype.onEnterSuccessScene=function(){var t;switch(this._dupinfo.dupModel.type){case DUP_TYPE.DUP_CAILIAO:case DUP_TYPE.DUP_CHALLENGE:case DUP_TYPE.DUP_UNION:case DUP_TYPE.DUP_ZHUFU:case DUP_TYPE.DUP_SIXIANG:case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:case DUP_TYPE.DUP_XIANSHAN:case DUP_TYPE.DUP_BLESS:t=this.mainscene.mapInfo.getXYByGridIndex(this.mainscene.mapInfo.bronNodeId);break;case DUP_TYPE.DUP_PERSONALLY:var n=this._dupinfo.gerenModel,a=this.mainscene.mapInfo.getNodeModelByIndex(n.point),i=this.mainscene.mapInfo.getGridListByDistance(a,3),o=i[Math.floor(Math.random()*i.length)];t=this.mainscene.mapInfo.getXYByGridIndex(o.nodeId);break;case DUP_TYPE.DUP_LINGXING:var a=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),i=this.mainscene.mapInfo.getGridListByDistance(a,2),o=i[Math.floor(Math.random()*i.length)];t=this.mainscene.mapInfo.getXYByGridIndex(o.nodeId)}this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){var e=!1;GameFight.getInstance().fightDupId;switch(this._dupinfo.type){case DUP_TYPE.DUP_CAILIAO:e=this._rushData.isBoss,e||this.currPointIndex++;break;case DUP_TYPE.DUP_ZHUFU:e=0==this.blessLeftCount,e&&GameFight.getInstance().onSendBlessDupProgressMsg(1,0);break;case DUP_TYPE.DUP_SIXIANG:GameFight.getInstance().dupfight_waveIndex++,e=JsonModelManager.instance.getModelsixiangfuben()[GameFight.getInstance().dupfight_waveIndex]?!1:!0,GameFight.getInstance().onSendSixiangDupResultMsg();break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:this._rushData.isBoss?this.currPointIndex=0:this.currPointIndex++;var t=JsonModelManager.instance.getModelzuduifuben()[GameFight.getInstance().dupfight_waveIndex];e=t.point.split("#").length==this.teamRushCount;break;case DUP_TYPE.DUP_PERSONALLY:case DUP_TYPE.DUP_CHALLENGE:case DUP_TYPE.DUP_XIANSHAN:case DUP_TYPE.DUP_BLESS:case DUP_TYPE.DUP_UNION:e=!0;break;case DUP_TYPE.DUP_LINGXING:return this.fight_info_bar.curr_damage_lab.text=this.upDamage.toString(),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),this.mainscene.getModuleLayer().onHideBossHpBar(),void Tool.callbackTime(this.onFinishFight,this,1e3)}e?this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS):this.onFightHandler()},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onTouchLeaveBtn=function(){if(this._dupinfo.type==DUP_TYPE.DUP_TEAM||this._dupinfo.type==DUP_TYPE.DUP_VIP_TEAM||this._dupinfo.type==DUP_TYPE.DUP_MARRY||this._dupinfo.type==DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS){var e=[{text:Language.instance.getText("zhongtutuichushuoming")}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onQuitScene,this)))}else this.onQuitScene()},t.prototype.onTeamDupTimeout=function(){GameCommon.getInstance().addAlert("error_tips_10003"),this.mainscene.onReturnYewaiScene()},t.prototype.onQuitScene=function(){if(this.isQuit=!0,GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.DUP)if(this._dupinfo.type==DUP_TYPE.DUP_TEAM||this._dupinfo.type==DUP_TYPE.DUP_VIP_TEAM||this._dupinfo.type==DUP_TYPE.DUP_MARRY||this._dupinfo.type==DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS)GameFight.getInstance().onSendQuitTeamDupMsg(),this.mainscene.onReturnYewaiScene();else if(this._dupinfo.type==DUP_TYPE.DUP_LINGXING){var e=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);e.setByte(DUP_TYPE.DUP_LINGXING),GameCommon.getInstance().sendMsgToServer(e),this.mainscene.onReturnYewaiScene()}else this.onFightLose(),this.mainscene.onReturnYewaiScene()},t.prototype.onDistroyUnionDupBody=function(){this.unionBoossBody&&(BodyFactory.instance.onRecovery(this.unionBoossBody),this.unionBoossBody=null),this.unionNpcBody&&(BodyFactory.instance.onRecovery(this.unionNpcBody),this.unionNpcBody=null)},t.prototype.onDestroyScene=function(){switch(e.prototype.onDestroyScene.call(this),this._dupinfo.dupModel.type){case DUP_TYPE.DUP_UNION:this.onDistroyUnionDupBody(),GameFight.getInstance().unionCheerNum=0;break;case DUP_TYPE.DUP_SIXIANG:this.sixiangNpcBody&&(this.sixiangNpcBody.onDestroy(),this.sixiangNpcBody=null);break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:this.stopTeamdupHeart(),this.teamdupDatas=null,this.teamdupOthers=null,this.teamOwnerId=null}this.isQuit=null,this.onStopDupTimer()},t.prototype.getRandomRebornNode=function(){var e=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),t=this.mainscene.mapInfo.getGridListByDistance(e,2),n=t[Math.floor(Math.random()*t.length)];return n=n?n:e},t.prototype.onUpdateDupWave=function(){switch(this._rushData.back_goType=0,this._dupinfo.dupModel.type){case DUP_TYPE.DUP_CAILIAO:var e=JsonModelManager.instance.getModelcailiaofuben()[GameFight.getInstance().dupfight_waveIndex],t=e.point.split(",");this._rushData.isBoss=this.currPointIndex==t.length-1,this._rushData.monsterId=this._rushData.isBoss?e.bossId:e.monsterId,this._rushData.refreshGrid=parseInt(t[this.currPointIndex]),this._rushData.refreshNum=this._rushData.isBoss?1:e.num,this._rushData.back_goType=FUN_TYPE.FUN_DUP_CAILIAO;break;case DUP_TYPE.DUP_CHALLENGE:var n=JsonModelManager.instance.getModelzhuxiantai()[GameFight.getInstance().dupfight_waveIndex];this._rushData.isBoss=!0,this._rushData.monsterId=n.fightId,this._rushData.refreshGrid=n.point,this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_DUP_TIAOZHAN;break;case DUP_TYPE.DUP_PERSONALLY:var a=this._dupinfo.gerenModel;this._rushData.isBoss=!0,this._rushData.monsterId=a.bossId,this._rushData.refreshGrid=a.point,this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_GEREN_BOSS;break;case DUP_TYPE.DUP_UNION:var i=JsonModelManager.instance.getModelguildfuben()[GameFight.getInstance().dupfight_waveIndex];this._rushData.isBoss=!0,this._rushData.monsterId=i.fightId,this._rushData.refreshGrid=GameDefine.UnionDup_Boss_Node,this._rushData.refreshNum=1;break;case DUP_TYPE.DUP_ZHUFU:var o=JsonModelManager.instance.getModelzhufuzhifuben()[GameFight.getInstance().dupfight_waveIndex],r=Math.min(o.rushNum,o.maxNum-this.blessRushCount);this._rushData.monsterId=o.monsterId,this._rushData.refreshGrid=this.mainscene.mapInfo.bronNodeId,this._rushData.refreshNum=r,this._rushData.back_goType=FUN_TYPE.FUN_DUP_ZHUFU,this.blessRushCount+=r;break;case DUP_TYPE.DUP_SIXIANG:var s=JsonModelManager.instance.getModelsixiangfuben()[GameFight.getInstance().dupfight_waveIndex];this._rushData.monsterId=s.fighterId,this._rushData.refreshGrid=this.sixiangRushPoints[Math.floor(Math.random()*this.sixiangRushPoints.length)],this._rushData.refreshNum=s.Num,this._rushData.isBoss=1==s.Num,this._rushData.limittime=1e3*s.time,this._rushData.back_goType=FUN_TYPE.FUN_DUP_SIXIANG;break;case DUP_TYPE.DUP_TEAM:case DUP_TYPE.DUP_VIP_TEAM:case DUP_TYPE.DUP_MARRY:case DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS:var h=JsonModelManager.instance.getModelzuduifuben()[GameFight.getInstance().dupfight_waveIndex],l=h.point.split("#")[this.teamRushCount].split(",");this._rushData.isBoss=!0,this._rushData.monsterId=parseInt(h.bossId.split(",")[this.teamRushCount]),this._rushData.refreshNum=1,this._rushData.refreshGrid=parseInt(l[this.currPointIndex]),this._dupinfo.dupModel.type==DUP_TYPE.DUP_VIP_TEAM?this._rushData.back_goType=FUN_TYPE.FUN_VIPTEAM:this._dupinfo.dupModel.type==DUP_TYPE.DUP_MARRY?this._rushData.back_goType=FUN_TYPE.FUN_MARRY_DUP:this._dupinfo.dupModel.type==DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS?this._rushData.back_goType=FUN_TYPE.FUN_MARRY_EQUIP_SUIT_DUP:this._rushData.back_goType=FUN_TYPE.FUN_DUP_ZUDUI;break;case DUP_TYPE.DUP_XIANSHAN:var g=JsonModelManager.instance.getModelxianshan()[DataManager.getInstance().xiandanManager.curLayer];this._rushData.isBoss=!0,this._rushData.monsterId=g.fightId,this._rushData.refreshGrid=g.point,this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_XIANSHAN;break;case DUP_TYPE.DUP_BLESS:var c=JsonModelManager.instance.getModelpeishiboss()[DataManager.getInstance().newactivitysManager.blessTp];this._rushData.isBoss=!0,this._rushData.monsterId=c.bossId,this._rushData.refreshGrid=c.point,this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_BLESSDUP;break;case DUP_TYPE.DUP_LINGXING:this._rushData.isBoss=!0,this._rushData.monsterId=Constant.get("FULING_BOSS_MODEL_ID"),this._rushData.refreshGrid=Number(Constant.get("FULING_BOSS_BORN")),this._rushData.refreshNum=1,this._rushData.back_goType=FUN_TYPE.FUN_FULINGBOSS}},Object.defineProperty(t.prototype,"TickInterval",{get:function(){return!this._dupinfo||this._dupinfo.dupModel.type!=DUP_TYPE.DUP_TEAM&&this._dupinfo.dupModel.type!=DUP_TYPE.DUP_VIP_TEAM&&this._dupinfo.dupModel.type!=DUP_TYPE.DUP_MARRY&&this._dupinfo.dupModel.type!=DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS?5e3:1e3},enumerable:!0,configurable:!0}),t}(BaseFightScene);__reflect(DupFight.prototype,"DupFight");var EscortFight=function(e){function t(t){var n=e.call(this,t)||this;return n.Escort_MapId=10017,n.Self_rebronNode=62,n.Enemy_rebronNode=17,n._rerult=0,n.gameNum=1,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_ROB_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_ROB_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this.quality=t.getByte(),this.gameNum=t.getShort(),this._rerult=t.getByte(),this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),this.onSwitchMap(this.Escort_MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onKillTargetHandle=function(){this.onResFightResult()},t.prototype.onFinishFight=function(e){},t.prototype.onResFightResult=function(){DataManager.getInstance().escortManager.escort.rob=this.gameNum,this._rerult==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler():this.onResultLoseHandler()},t.prototype.onResultWinHandler=function(){for(var e,t=this.quality,n=JsonModelManager.instance.getModeldujie()[t],a=new DupWinParam,i=GameCommon.getInstance().onParseAwardItemstr(n.jiangli),o=0;o<i.length;o++){var r=i[o];e=new AwardItem(r.type,r.id,.1*r.num,r.quality),a.dropList.push(e)}a.resultParam=GameCommon.getInstance().readStringToHtml(Language.instance.parseInsertText("chenggongqiangduo",this.enemyDatas[0].name,"[#"+GameCommon.Quality_Color_String[t]+n.name+"]")),a.specialDesc=Language.instance.getText("qiangduoxiannv_teshu"),Tool.callbackTime(this.onOpenResultPanel,this,1e3,a)},t.prototype.onOpenResultPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",e))},t.prototype.onResultLoseHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DupLosePanel")},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_DUJIE)},t.prototype.onDeath=function(){this.onResFightResult()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,this.anim&&(this.anim.onDestroy(),this.anim=null),e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(EscortFight.prototype,"EscortFight");var FIGHT_STATUS;!function(e){e[e.Loading=0]="Loading",e[e.Enter=1]="Enter",e[e.Requset=2]="Requset",e[e.Fighting=3]="Fighting",e[e.Result=4]="Result",e[e.Leave=5]="Leave"}(FIGHT_STATUS||(FIGHT_STATUS={}));var LadderFight=function(e){function t(t){var n=e.call(this,t)||this;return n.Ladderarena_MapId=10009,n.Self_rebronNode=62,n.Enemy_rebronNode=17,n.currHeroHp=0,n.resultHp=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},Object.defineProperty(t.prototype,"ladderData",{get:function(){return DataManager.getInstance().arenaManager.ladderArenaData},enumerable:!0,configurable:!0}),t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this.currHeroHp=this.ladderData.heroHpNum,this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),this.enemyDatas[0].bodyType==BODY_TYPE.PLAYER?this.resultHp=t.getLong():this.enemyDatas[0].bodyType==BODY_TYPE.ROBOT&&(this.resultHp=this.currHeroHp),this.mainscene.getBodyManager().fightPause=!0,GameDispatcher.getInstance().addEventListener(GameEvent.LADDER_FIGHT_START_EVENT,this.onEnterLadderMap,this),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LadderReadyPanel",this.enemyDatas[0]))},t.prototype.onEnterLadderMap=function(){GameDispatcher.getInstance().removeEventListener(GameEvent.LADDER_FIGHT_START_EVENT,this.onEnterLadderMap,this),this.onSwitchMap(this.Ladderarena_MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.mainscene.heroBody.hp=this.currHeroHp,this.enemyDatas&&(this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode),this.mainscene.heroBody.data.shieldValue=this.ladderData.heroShieldNum,this.mainscene.heroBody.data.reborncount=this.ladderData.heroRebornNum)},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.ARENE_LADDERARENE_RESULT_MESSAGE);n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):this.onResultLoseHandler()},t.prototype.onResultWinHandler=function(e){Tool.callbackTime(this.onShowWinPanel,this,1e3,e)},t.prototype.onShowWinPanel=function(e){var t=(e.getByte(),e.getInt(),new LadderArenaParam);t.result=FightDefine.FIGHT_RESULT_SUCCESS,t.hpValue=this.resultHp,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ArenaWinPanel",t))},t.prototype.onResultLoseHandler=function(){var e=new LadderArenaParam;e.result=FightDefine.FIGHT_RESULT_FAIL,e.hpValue=this.resultHp,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ArenaWinPanel",e))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_LADDER)},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);if(a){var i=e.data.targets;if(i.indexOf(t)<0)return;var o=this.resultHp>0;if(o)return;for(var r=!0,s=0;s<e.data.targets.length;s++)if(!e.data.targets[s].data.isDie){r=!1;break}r&&(t.hp=10,e.hp=0,e.onDeath())}else if(t.data.bodyType==BODY_TYPE.SELF){var o=this.resultHp>0;if(!o)return;t.data.isDie&&(t.hp=this.resultHp,e.hp=0,e.onDeath())}},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(LadderFight.prototype,"LadderFight");var LocalArenaFight=function(e){function t(t){var n=e.call(this,t)||this;return n.MapId=10019,n.Self_rebronNode=62,n.Enemy_rebronNode=17,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_FIGHT_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_FIGHT_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){this.targetRank=t.getInt(),this.fightResult=t.getByte(),this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),e.prototype.onParseFightMsg.call(this,t),this.onSwitchMap(this.MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onBodyHurtHanlder=function(e,t,n){},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):n==FightDefine.FIGHT_RESULT_FAIL&&this.onResultLoseHandler()},t.prototype.onFinishFight=function(t){if(this._status!=FIGHT_STATUS.Result){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.ARENE_FIGHT_RESULT_MESSAGE);n.setInt(this.targetRank),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)}},t.prototype.onResultWinHandler=function(e){var t={},n=Constant.get(Constant.ARENA_REWARD_POINT_SUCC);t.award=GameCommon.getInstance().onParseAwardItemstr(n),t.oldRank=e.getInt(),t.newRank=e.getInt(),Tool.callbackTime(function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LocalArenaWinPanel",e))},this,1e3,t)},t.prototype.onResultLoseHandler=function(){var e=Constant.get(Constant.ARENA_REWARD_POINT_FAIL);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("YewaiPVPLosePanel",GameCommon.getInstance().onParseAwardItemstr(e)))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_ARENA)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(LocalArenaFight.prototype,"LocalArenaFight");var MysBossFight=function(e){function t(t){var n=e.call(this,t)||this;return n.RANK_SHOW_NUM=4,n.bossMaxHp=0,n.currBossHp=0,n.beforeBossHp=0,n.intervalTime=1e3,n.timerRunTime=500,n.currRunTime=0,n.currDamageNum=0,n.targetLiveTime=0,n.targetMaxHp=0,n.targetHpValue=0,n.targetIsSelf=!1,n.bossStartAttTime=0,n.selfRankDamage=0,n.selfRank=-1,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_OTHERBODY_MSG.toString(),this.onResAddOtherFightBodyMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT_INFO.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_TARGET_MESSAGE.toString(),this.onResBossAttackTargetMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_TOP_MESSAGE.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_REVIVE_MESSAGE.toString(),this.onResReborn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_QUIT_MESSAGE.toString(),this.onResOhterLeaveMsg,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),this.fight_info_bar.loop_award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopSamsaraAward,this)
},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_OTHERBODY_MSG.toString(),this.onResAddOtherFightBodyMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT_INFO.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_TARGET_MESSAGE.toString(),this.onResBossAttackTargetMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_TOP_MESSAGE.toString(),this.onResRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_REVIVE_MESSAGE.toString(),this.onResReborn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_QUIT_MESSAGE.toString(),this.onResOhterLeaveMsg,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),this.fight_info_bar.loop_award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopSamsaraAward,this)},t.prototype.onLoopSamsaraAward=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MysteriousRewardsPanel")},t.prototype.countDown=function(){this.durationTime=this.durationTime-1e3;var e=this.fight_info_bar.loop_award_label;e.text="剩余时间："+GameCommon.getInstance().getTimeStrForSec2(this.durationTime/1e3,!1),this.durationTime<6e4&&(e.textColor=16711680),this.durationTime<0||(this.intervalId=Tool.callbackTime(this.countDown,this,1e3))},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),GameFight.getInstance().mysteriousbossId=t.getShort(),this.bossMaxHp=t.getLong(),this.currBossHp=t.getLong(),this.beforeBossHp=this.currBossHp;var n=JsonModelManager.instance.getModelzhaohuanboss()[GameFight.getInstance().mysteriousbossId];this.onSwitchMap(n.map),this.mainscene.getModuleLayer().showorhideDupRebornBar(!0)},t.prototype.onInitFightInfoBar=function(){e.prototype.onInitFightInfoBar.call(this),this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.MysBossInfoBarSkin,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=size.height-198),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),this.fight_info_bar.loop_award_btn.visible=!1,this.fight_info_bar.loop_award_label.visible=!0,this.durationTime=DataManager.getInstance().unionManager.durTime+1e3,this.intervalId&&egret.clearTimeout(this.intervalId),this.countDown(),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.mainscene.heroBody.isDamageFalse=!0;var t=JsonModelManager.instance.getModelzhaohuanboss()[GameFight.getInstance().mysteriousbossId],n=GameCommon.parseAwardItem(t.yulan);this.fight_info_bar.show_award_icon.onUpdate(n.type,n.id,0,n.quality,n.num);var a=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId);this.monsterBody=this.mainscene.getBodyManager().onCreateMapBody(t.modelId,[a],BODY_TYPE.BOSS),this.monsterBody.isDamageFalse=!0,this.monsterBody.onHideHeadBar(!1);for(var i=0;i<DataManager.getInstance().dupManager.mysteriousData.otherFightDatas.length;i++)this.onCreateOtherFightBody(DataManager.getInstance().dupManager.mysteriousData.otherFightDatas[i],this.mainscene.mapInfo.getGridNearByNode(a,2,2));this.monsterBody.data.onRestHpInfo(this.currBossHp,this.bossMaxHp),this.mainscene.getModuleLayer().onUpdateBossHpBar(this.currBossHp,this.bossMaxHp),Tool.addTimer(this.onTimerDown,this,this.timerRunTime),GameFight.getInstance().mysteriousTargetMsg&&this.onResBossAttackTargetMsg(),this.mainscene.getModuleLayer().onShowBossHpBar(this.monsterBody.data)},t.prototype.onResFightUpdateMsg=function(e){var t=e.message,n=t.getShort();n==GameFight.getInstance().mysteriousbossId&&(this.isFightOver=0==t.getByte(),this.beforeBossHp=Math.max(0,this.currBossHp-this.currDamageNum),this._status=FIGHT_STATUS.Fighting,this.currBossHp=t.getLong(),this.currDamageNum=0,this.currRunTime=0,this.monsterBody.data.onRestHpInfo(this.beforeBossHp))},t.prototype.onResAddOtherFightBodyMsg=function(e){var t=e.data;t&&this.onCreateOtherFightBody(t,[this.getRandomRebornNode()])},t.prototype.onCreateOtherFightBody=function(e,t){if(!(this.getOhterBodysById(e.playerId).length>0))for(var n=0;n<e.appears.length;n++){var a=new RobotData(n+1,BODY_TYPE.PLAYER);a.playerId=e.playerId,a.name=e.playerName,a.coatardLv=e.reinLv,a.onUpdateOnlyAppear(e.appears[n]);var i=this.mainscene.getBodyManager().onCreateOtherPlayer(a,t);i&&(i.isDamageFalse=!0,i.onAddEnemyBodyList([this.monsterBody]),i.onShowOrHideHpBar(!1))}},t.prototype.getRandomRebornNode=function(){var e=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),t=this.mainscene.mapInfo.getGridListByDistance(e,3),n=t[Math.floor(Math.random()*t.length)];return n=n?n:e},t.prototype.onTimerDown=function(){this.currRunTime+=this.timerRunTime,this.onUpdateBossHp(),this.currRunTime>=this.intervalTime?this.onSendFightInfo2Server():this.onUpdateRank()},t.prototype.onUpdateBossHp=function(){if(this.monsterBody){var e=this.beforeBossHp-this.currBossHp,t=0;t=Math.max(0,this.beforeBossHp-Math.ceil(e*(this.currRunTime/this.intervalTime))-this.currDamageNum),this.mainscene.getModuleLayer().onUpdateBossHpBar(t,this.bossMaxHp),0==t&&this.onSendFightInfo2Server()}},t.prototype.onSendFightInfo2Server=function(){if(this.isFightOver&&this.currBossHp<=0)return void(this.currBossHp<=0?this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS):this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL));if(this.fightStatus==FIGHT_STATUS.Fighting){this._status=FIGHT_STATUS.Requset;var e=new Message(MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT_INFO);e.setShort(GameFight.getInstance().mysteriousbossId),e.setLong(this.currDamageNum),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);a&&this.monsterBody===t?this.fightStatus==FIGHT_STATUS.Fighting&&(this.currDamageNum+=n.value,this.selfRankDamage+=n.value,this.onUpdateBossHp(),this.monsterBody.addFlyFont(n)):e===this.monsterBody&&t.data.bodyType==BODY_TYPE.PLAYER?this.onBossAttack(t):t.data.bodyType==BODY_TYPE.SELF&&e===this.monsterBody&&this.onBossAttack(t)},t.prototype.onResBossAttackTargetMsg=function(){if(GameFight.getInstance().mysteriousTargetMsg){var e=GameFight.getInstance().mysteriousTargetMsg;GameFight.getInstance().mysteriousTargetMsg=null;var t=e.getInt();this.targetIsSelf=DataManager.getInstance().playerManager.player.id==t;var n=e.getString(),a=JsonModelManager.instance.getModelzhuansheng()[e.getShort()],i=a.zhuansheng;if(this.targetMaxHp=e.getInt(),this.targetHpValue=e.getInt(),this.targetLiveTime=1e3*e.getInt(),this.bossStartAttTime=egret.getTimer(),this.monsterBody.data.targets.length>0){var o=this.monsterBody.data.targets[0].data;if(o&&o.playerId!=t)if(o.bodyType!=BODY_TYPE.SELF)this.onUpdateOtherTargetHp(this.monsterBody.data.targets,0,this.targetMaxHp);else for(var r=0;r<this.mainscene.heroBodys.length;r++)this.mainscene.heroBodys[r].data.onRestHpInfo(0),this.mainscene.heroBodys[r].onDeath()}this.monsterBody.onClearTargets();var s;if(this.targetIsSelf){var h=DataManager.getInstance().playerManager.player;this.mainscene.onupdateHero(),s=this.mainscene.heroBody.data,this.monsterBody.onAddEnemyBodyList(this.mainscene.heroBodys),this.mainscene.getModuleLayer().onShowOhterHpBar(this.mainscene.heroBody.data,DataManager.getInstance().playerManager.player.headIndex,DataManager.getInstance().playerManager.player.headFrameIndex),this.mainscene.getModuleLayer().onUpdateOtherHpBar(h.getPlayerMaxHp(),h.getPlayerMaxHp()),this.selfLiveTimes=[];for(var l=this.targetLiveTime,r=0;r<this.mainscene.heroBodys.length;r++){var g=this.mainscene.heroBodys[r].data;r==this.mainscene.heroBodys.length-1?this.selfLiveTimes.push(l):(this.selfLiveTimes.push(Math.floor(g.maxHp/h.getPlayerMaxHp()*this.targetLiveTime)),l-=this.selfLiveTimes[r])}}else{var c=this.getOhterBodysById(t);if(0==c.length){var p=new OtherFightData;p.playerId=t,p.playerName=n,p.reinLv=i,p.parseAppears(e),DataManager.getInstance().dupManager.mysteriousData.addOhterFightData(p);var u=this.mainscene.mapInfo.getNodeModelByXY(this.monsterBody.x,this.monsterBody.y),d=this.mainscene.mapInfo.getGridNearByNode(u);this.onCreateOtherFightBody(p,d),c=this.getOhterBodysById(t)}this.monsterBody.onAddEnemyBodyList(c),s=c[c.length-1].data,this.onUpdateOtherTargetHp(c,this.targetHpValue,this.targetMaxHp);var _=DataManager.getInstance().dupManager.mysteriousData.findOneOtherFightData(s.playerId);this.mainscene.getModuleLayer().onShowOhterHpBar(s,_.headIndex,_.headFrame)}}},t.prototype.getOhterBodysById=function(e){for(var t=[],n=0;n<this.mainscene.getBodyManager().otherPlayerBodys.length;n++){var a=this.mainscene.getBodyManager().otherPlayerBodys[n];a.data.playerId==e&&t.push(a)}return t},t.prototype.onResOhterLeaveMsg=function(e){var t=e.message,n=t.getInt();this.onOtherLeaveHandler(this.getOhterBodysById(n),n)},t.prototype.onOtherLeaveHandler=function(e,t){if(e.length>0){for(var n=e.length-1;n>=0;n--)this.mainscene.getBodyManager().onDestroyOhterOne(e[n],!1);DataManager.getInstance().dupManager.mysteriousData.removeOneOhterFightData(t)}},t.prototype.onBossAttack=function(e){var t=Math.ceil(egret.getTimer()-this.bossStartAttTime);if(this.targetIsSelf&&e.data.bodyType==BODY_TYPE.SELF){var n=new DamageData,a=Tool.toInt(e.data.maxHp*e.data.shieldEffect/GameDefine.GAME_ADD_RATIO),i=Tool.toInt(e.data.maxHp*e.data.rebornEffect/GameDefine.GAME_ADD_RATIO),o=e.data.maxHp+a+i,r=this.selfLiveTimes[e.data.occupation],s=o-Math.ceil(Math.min(1,t/r)*o),h=o-a-e.data.maxHp;h>s&&e.data.reborncount>0?(e.data.reborncount>0&&(e.data.reborncount=0,e.onPlayRebornAnim()),n.value=e.data.currentHp-s,e.hp=s):(n.value=e.data.currentHp+e.data.shieldValue-(s-i),e.hp=Math.min(e.data.maxHp,s-i));var l=Math.max(0,a-(o-s));l>0?(n.xishou=Math.max(0,e.data.shieldValue-l),e.data.shieldValue=l):(n.xishou=e.data.shieldValue,e.data.shieldValue>0&&(e.removeShieldAnim(),e.data.shieldValue=0)),n.attacker=this.monsterBody,n.value=Math.max(0,e.data.currentHp-s),n.fromDire=this.monsterBody.checkFace(e.x,e.y),e.addFlyFont(n);for(var g=0,c=0;c<this.mainscene.heroBodys.length;c++)g+=this.mainscene.heroBodys[c].data.currentHp;this.mainscene.getModuleLayer().onUpdateOtherHpBar(g,DataManager.getInstance().playerManager.player.getPlayerMaxHp()),e.data.currentHp<=0&&(this.bossStartAttTime=egret.getTimer(),this.monsterBody.onRemoveTarget(e))}else{var s=this.targetMaxHp-Math.floor(Math.min(1,t/this.targetLiveTime)*this.targetMaxHp);this.onUpdateOtherTargetHp(this.monsterBody.data.targets,s,this.targetMaxHp)}},t.prototype.onUpdateOtherTargetHp=function(e,t,n){for(var a,i=e.length,o=Math.floor(n/i),r=this.monsterBody.data.targets.length,s=0;i>s;s++){var h=s+1,l=t-(e.length-h)*o;l=l>o?o:0>l?0:l;var g=e[s];g.data.onRestHpInfo(l,o),a=g.data.playerId,g.data.isDie&&(g.parent&&g.parent.removeChild(g),r--)}this.mainscene.getModuleLayer().onUpdateOtherHpBar(t,n),Tool.isNumber(a)&&0==r&&(this.onOtherLeaveHandler(this.monsterBody.data.targets,a),this.monsterBody.onClearTargets())},t.prototype.onResRankMsg=function(e){var t=e.message;this.selfRankDamage=t.getLong(),this.selfRank=-1,this.rankDamages=[];for(var n=t.getShort(),a=0;n>a;a++){var i=new BossDamageParam;i.playerId=t.getInt(),i.playerName=t.getString(),i.damageNum=t.getLong(),i.index=a+1,this.rankDamages.push(i),i.playerId==DataManager.getInstance().playerManager.player.id&&(this.selfRank=a)}this.onUpdateRank(!1)},t.prototype.onUpdateRank=function(e){if(void 0===e&&(e=!0),this.rankDamages){if(e){var t=DataManager.getInstance().playerManager.player;if(0==this.rankDamages.length){var n=new BossDamageParam;n.index=1,n.playerId=t.id,n.playerName=t.name,n.damageNum=this.selfRankDamage,this.rankDamages.push(n)}else{if(this.selfRank>=0)this.rankDamages[this.selfRank].damageNum=this.selfRankDamage;else{var n;n=this.rankDamages.length>=5?this.rankDamages[this.rankDamages.length-1]:new BossDamageParam,n.playerId=t.id,n.playerName=t.name,n.damageNum=this.selfRankDamage}this.rankDamages.sort(function(e,t){return t.damageNum-e.damageNum})}for(var a=0;a<this.rankDamages.length;a++){var i=this.rankDamages[a];i.index=a+1,i.playerId==DataManager.getInstance().playerManager.player.id&&(this.selfRank=a)}}for(var o="",r="",s=0;s<this.RANK_SHOW_NUM;s++){var h=this.rankDamages[s];h&&(o+=h.index+" "+GameCommon.getInstance().getNickname(h.playerName)+"\n",r+=GameCommon.getInstance().getFormatNumberShow(h.damageNum)+"\n")}this.fight_info_bar.dmg_name_lab.text=o,this.fight_info_bar.dmg_value_lab.text=r;var l=this.selfRank>=0&&this.selfRank<10?this.selfRank+1+"":Language.instance.getText("weishangbang");this.fight_info_bar.self_dmginfo_lab.text=Language.instance.getText("wodepaiming")+"："+l,this.fight_info_bar.slef_dmg_value_lab.text=Language.instance.getText("dps")+"："+GameCommon.getInstance().getFormatNumberShow(this.selfRankDamage)}},t.prototype.onEnterSuccessScene=function(){var t=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onFinishFight=function(t){this._status!=FIGHT_STATUS.Result&&(Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),e.prototype.onFinishFight.call(this,t),t==FightDefine.FIGHT_RESULT_FAIL?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null)):t==FightDefine.FIGHT_RESULT_SUCCESS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("MyBossKillPanel",new SamsaraBossKillLogParam(GameFight.getInstance().mysteriousbossId,11,!0))),this.mainscene.getBodyManager().onDestroyAllHeroTarget())},t.prototype.onDeath=function(){this.mainscene.getModuleLayer().onShowSamsaraReborn(FightDefine.SAMSARA_REBORN_CD)},t.prototype.onResReborn=function(e){var t=e.message,n=t.getInt();if(n>0)this.mainscene.getModuleLayer().onShowSamsaraReborn(n);else{this.mainscene.getModuleLayer().onHideSamsaraReborn(),this.mainscene.onupdateHero();var a=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(a)}},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),DataManager.getInstance().dupManager.mysteriousData.removeAllOtherFightData(),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),this.monsterBody=null,GameFight.getInstance().mysteriousbossId=null,this.rankDamages=null,this.isFightOver=!1,this.mainscene.getModuleLayer().onHideOhterHpBar(),this.mainscene.getModuleLayer().onDamageRankBar(!1),this.mainscene.getModuleLayer().showorhideDupRebornBar(!1),GameFight.getInstance().mysteriousTargetMsg=null},t.prototype.onCloseResultView=function(){this.mainscene.onReturnYewaiScene()},t}(BaseFightScene);__reflect(MysBossFight.prototype,"MysBossFight");var RevengeFight=function(e){function t(t){var n=e.call(this,t)||this;return n.Escort_MapId=10019,n.Self_rebronNode=64,n.Enemy_rebronNode=11,n._rerult=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_REVENGE_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_REVENGE_RESULT_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this._rerult=t.getByte(),this.quality=t.getByte(),this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),this.onSwitchMap(this.Escort_MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.ESCORT_REVENGE_RESULT_MESSAGE);n.setInt(DataManager.getInstance().escortManager.revengeID),n.setInt(Math.floor(DataManager.getInstance().escortManager.revengeTime/1e3)),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):this.onResultLoseHandler()},t.prototype.onResultWinHandler=function(e){for(var t,n=e.getByte(),a=JsonModelManager.instance.getModeldujie()[n],i=new DupWinParam,o=GameCommon.getInstance().onParseAwardItemstr(a.jiangli),r=0;r<o.length;r++){var s=o[r];t=new AwardItem(s.type,s.id,.1*s.num,s.quality),i.dropList.push(t)}i.resultParam=GameCommon.getInstance().readStringToHtml(Language.instance.parseInsertText("chenggongqiangduo",this.enemyDatas[0].name,"[#"+GameCommon.Quality_Color_String[n]+a.name+"]")),i.specialDesc=Language.instance.getText("qiangduoxiannv_teshu"),Tool.callbackTime(this.onOpenResultPanel,this,1e3,i)},t.prototype.onOpenResultPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",e))},t.prototype.onResultLoseHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DupLosePanel")},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_DUJIE)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(RevengeFight.prototype,"RevengeFight");var SamsaraBossFight=function(e){function t(t){var n=e.call(this,t)||this;return n.RANK_SHOW_NUM=4,n.bossMaxHp=0,n.currBossHp=0,n.beforeBossHp=0,n.intervalTime=1e3,n.timerRunTime=500,n.currRunTime=0,n.currDamageNum=0,n.targetLiveTime=0,n.targetMaxHp=0,n.targetHpValue=0,n.targetIsSelf=!1,n.bossStartAttTime=0,n.selfRankDamage=0,n.selfRank=-1,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.SAMSARA_BOSS_OTHERBODY_MSG.toString(),this.onResAddOtherFightBodyMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_FIGHT_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_TARGET_MSG.toString(),this.onResBossAttackTargetMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_RANK_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_REBORN_MSG.toString(),this.onResReborn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_OTHERLEAVE_MSG.toString(),this.onResOhterLeaveMsg,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),this.fight_info_bar.loop_award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopSamsaraAward,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.SAMSARA_BOSS_OTHERBODY_MSG.toString(),this.onResAddOtherFightBodyMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_FIGHT_MSG.toString(),this.onResFightUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_TARGET_MSG.toString(),this.onResBossAttackTargetMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_RANK_MSG.toString(),this.onResRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_REBORN_MSG.toString(),this.onResReborn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_OTHERLEAVE_MSG.toString(),this.onResOhterLeaveMsg,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this),this.fight_info_bar.loop_award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopSamsaraAward,this)},t.prototype.onLoopSamsaraAward=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SamsaraAwardPanel")},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),GameFight.getInstance().samsarabossId=t.getShort(),this.bossMaxHp=t.getLong(),this.currBossHp=t.getLong(),this.beforeBossHp=this.currBossHp;var n=JsonModelManager.instance.getModelboss()[GameFight.getInstance().samsarabossId];this.onSwitchMap(n.map),this.mainscene.getModuleLayer().showorhideDupRebornBar(!0)},t.prototype.onInitFightInfoBar=function(){e.prototype.onInitFightInfoBar.call(this),this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.SamsaraInfoBarSkin,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=size.height-198),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.mainscene.heroBody.isDamageFalse=!0;var t=JsonModelManager.instance.getModelboss()[GameFight.getInstance().samsarabossId],n=GameCommon.parseAwardItem(t.yulan);this.fight_info_bar.show_award_icon.onUpdate(n.type,n.id,0,n.quality,n.num);var a=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId);this.monsterBody=this.mainscene.getBodyManager().onCreateMapBody(t.modelId,[a],BODY_TYPE.BOSS),this.monsterBody.isDamageFalse=!0,this.monsterBody.onHideHeadBar(!1);for(var i=0;i<DataManager.getInstance().dupManager.samsarebossData.otherFightDatas.length;i++)this.onCreateOtherFightBody(DataManager.getInstance().dupManager.samsarebossData.otherFightDatas[i],this.mainscene.mapInfo.getGridNearByNode(a,2,2));this.monsterBody.data.onRestHpInfo(this.currBossHp,this.bossMaxHp),this.mainscene.getModuleLayer().onUpdateBossHpBar(this.currBossHp,this.bossMaxHp),Tool.addTimer(this.onTimerDown,this,this.timerRunTime),GameFight.getInstance().samsaraTargetMsg&&this.onResBossAttackTargetMsg(),this.mainscene.getModuleLayer().onShowBossHpBar(this.monsterBody.data)},t.prototype.onResFightUpdateMsg=function(e){var t=e.message,n=t.getShort();n==GameFight.getInstance().samsarabossId&&(this.isFightOver=0==t.getByte(),this.beforeBossHp=Math.max(0,this.currBossHp-this.currDamageNum),this._status=FIGHT_STATUS.Fighting,this.currBossHp=t.getLong(),this.currDamageNum=0,this.currRunTime=0,this.monsterBody.data.onRestHpInfo(this.beforeBossHp))},t.prototype.onResAddOtherFightBodyMsg=function(e){var t=e.data;t&&this.onCreateOtherFightBody(t,[this.getRandomRebornNode()])},t.prototype.onCreateOtherFightBody=function(e,t){if(!(this.getOhterBodysById(e.playerId).length>0))for(var n=0;n<e.appears.length;n++){var a=new RobotData(n+1,BODY_TYPE.PLAYER);a.playerId=e.playerId,a.name=e.playerName,a.coatardLv=e.reinLv,a.onUpdateOnlyAppear(e.appears[n]);var i=this.mainscene.getBodyManager().onCreateOtherPlayer(a,t);i&&(i.isDamageFalse=!0,i.onAddEnemyBodyList([this.monsterBody]),i.onShowOrHideHpBar(!1))}},t.prototype.getRandomRebornNode=function(){var e=this.mainscene.mapInfo.getNodeModelByIndex(this.mainscene.mapInfo.bronNodeId),t=this.mainscene.mapInfo.getGridListByDistance(e,3),n=t[Math.floor(Math.random()*t.length)];return n=n?n:e},t.prototype.onTimerDown=function(){this.currRunTime+=this.timerRunTime,this.onUpdateBossHp(),this.currRunTime>=this.intervalTime?this.onSendFightInfo2Server():this.onUpdateRank()},t.prototype.onUpdateBossHp=function(){if(this.monsterBody){var e=this.beforeBossHp-this.currBossHp,t=0;t=Math.max(0,this.beforeBossHp-Math.ceil(e*(this.currRunTime/this.intervalTime))-this.currDamageNum),this.mainscene.getModuleLayer().onUpdateBossHpBar(t,this.bossMaxHp),0==t&&this.onSendFightInfo2Server()}},t.prototype.onSendFightInfo2Server=function(){if(this.isFightOver&&this.currBossHp<=0)return void(this.currBossHp<=0?this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS):this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL));if(this.fightStatus==FIGHT_STATUS.Fighting){this._status=FIGHT_STATUS.Requset;var e=new Message(MESSAGE_ID.SAMSARA_BOSS_FIGHT_MSG);e.setShort(GameFight.getInstance().samsarabossId),e.setLong(this.currDamageNum),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);a&&this.monsterBody===t?this.fightStatus==FIGHT_STATUS.Fighting&&(this.currDamageNum+=n.value,this.selfRankDamage+=n.value,this.onUpdateBossHp(),this.monsterBody.addFlyFont(n)):e===this.monsterBody&&t.data.bodyType==BODY_TYPE.PLAYER?this.onBossAttack(t):t.data.bodyType==BODY_TYPE.SELF&&e===this.monsterBody&&this.onBossAttack(t)},t.prototype.onResBossAttackTargetMsg=function(){if(GameFight.getInstance().samsaraTargetMsg){var e=GameFight.getInstance().samsaraTargetMsg;GameFight.getInstance().samsaraTargetMsg=null;var t=e.getInt();this.targetIsSelf=DataManager.getInstance().playerManager.player.id==t;var n=e.getString(),a=JsonModelManager.instance.getModelzhuansheng()[e.getShort()],i=a.zhuansheng;if(this.targetMaxHp=e.getInt(),this.targetHpValue=e.getInt(),this.targetLiveTime=1e3*e.getInt(),this.bossStartAttTime=egret.getTimer(),this.monsterBody.data.targets.length>0){var o=this.monsterBody.data.targets[0].data;if(o&&o.playerId!=t)if(o.bodyType!=BODY_TYPE.SELF)this.onUpdateOtherTargetHp(this.monsterBody.data.targets,0,this.targetMaxHp);else for(var r=0;r<this.mainscene.heroBodys.length;r++)this.mainscene.heroBodys[r].data.onRestHpInfo(0),this.mainscene.heroBodys[r].onDeath()}this.monsterBody.onClearTargets();var s;if(this.targetIsSelf){var h=DataManager.getInstance().playerManager.player;this.mainscene.onupdateHero(),s=this.mainscene.heroBody.data,this.monsterBody.onAddEnemyBodyList(this.mainscene.heroBodys),this.mainscene.getModuleLayer().onShowOhterHpBar(this.mainscene.heroBody.data,DataManager.getInstance().playerManager.player.headIndex,DataManager.getInstance().playerManager.player.headFrameIndex),this.mainscene.getModuleLayer().onUpdateOtherHpBar(h.getPlayerMaxHp(),h.getPlayerMaxHp()),this.selfLiveTimes=[];for(var l=this.targetLiveTime,r=0;r<this.mainscene.heroBodys.length;r++){var g=this.mainscene.heroBodys[r].data;r==this.mainscene.heroBodys.length-1?this.selfLiveTimes.push(l):(this.selfLiveTimes.push(Math.floor(g.maxHp/h.getPlayerMaxHp()*this.targetLiveTime)),l-=this.selfLiveTimes[r])}}else{var c=this.getOhterBodysById(t);if(0==c.length){var p=new OtherFightData;p.playerId=t,p.playerName=n,p.reinLv=i,p.parseAppears(e),DataManager.getInstance().dupManager.samsarebossData.addOhterFightData(p);var u=this.mainscene.mapInfo.getNodeModelByXY(this.monsterBody.x,this.monsterBody.y),d=this.mainscene.mapInfo.getGridNearByNode(u);this.onCreateOtherFightBody(p,d),c=this.getOhterBodysById(t)}this.monsterBody.onAddEnemyBodyList(c),s=c[c.length-1].data,this.onUpdateOtherTargetHp(c,this.targetHpValue,this.targetMaxHp);var _=DataManager.getInstance().dupManager.samsarebossData.findOneOtherFightData(s.playerId);this.mainscene.getModuleLayer().onShowOhterHpBar(s,_.headIndex,_.headFrame)}}},t.prototype.getOhterBodysById=function(e){for(var t=[],n=0;n<this.mainscene.getBodyManager().otherPlayerBodys.length;n++){var a=this.mainscene.getBodyManager().otherPlayerBodys[n];a.data.playerId==e&&t.push(a)}return t},t.prototype.onResOhterLeaveMsg=function(e){var t=e.message,n=t.getInt();this.onOtherLeaveHandler(this.getOhterBodysById(n),n)},t.prototype.onOtherLeaveHandler=function(e,t){if(e.length>0){for(var n=e.length-1;n>=0;n--)this.mainscene.getBodyManager().onDestroyOhterOne(e[n],!1);DataManager.getInstance().dupManager.samsarebossData.removeOneOhterFightData(t)}},t.prototype.onBossAttack=function(e){var t=Math.ceil(egret.getTimer()-this.bossStartAttTime);if(this.targetIsSelf&&e.data.bodyType==BODY_TYPE.SELF){var n=new DamageData,a=Tool.toInt(e.data.maxHp*e.data.shieldEffect/GameDefine.GAME_ADD_RATIO),i=Tool.toInt(e.data.maxHp*e.data.rebornEffect/GameDefine.GAME_ADD_RATIO),o=e.data.maxHp+a+i,r=this.selfLiveTimes[e.data.occupation],s=o-Math.ceil(Math.min(1,t/r)*o),h=o-a-e.data.maxHp;h>s&&e.data.reborncount>0?(e.data.reborncount>0&&(e.data.reborncount=0,e.onPlayRebornAnim()),n.value=e.data.currentHp-s,e.hp=s):(n.value=e.data.currentHp+e.data.shieldValue-(s-i),e.hp=Math.min(e.data.maxHp,s-i));var l=Math.max(0,a-(o-s));l>0?(n.xishou=Math.max(0,e.data.shieldValue-l),e.data.shieldValue=l):(n.xishou=e.data.shieldValue,e.data.shieldValue>0&&(e.removeShieldAnim(),e.data.shieldValue=0)),n.attacker=this.monsterBody,n.value=Math.max(0,e.data.currentHp-s),n.fromDire=this.monsterBody.checkFace(e.x,e.y),e.addFlyFont(n);for(var g=0,c=0;c<this.mainscene.heroBodys.length;c++)g+=this.mainscene.heroBodys[c].data.currentHp;this.mainscene.getModuleLayer().onUpdateOtherHpBar(g,DataManager.getInstance().playerManager.player.getPlayerMaxHp()),e.data.currentHp<=0&&(this.bossStartAttTime=egret.getTimer(),this.monsterBody.onRemoveTarget(e))}else{var s=this.targetMaxHp-Math.floor(Math.min(1,t/this.targetLiveTime)*this.targetMaxHp);this.onUpdateOtherTargetHp(this.monsterBody.data.targets,s,this.targetMaxHp)}},t.prototype.onUpdateOtherTargetHp=function(e,t,n){for(var a,i=e.length,o=Math.floor(n/i),r=this.monsterBody.data.targets.length,s=0;i>s;s++){var h=s+1,l=t-(e.length-h)*o;l=l>o?o:0>l?0:l;var g=e[s];g.data.onRestHpInfo(l,o),a=g.data.playerId,g.data.isDie&&(g.parent&&g.parent.removeChild(g),r--)}this.mainscene.getModuleLayer().onUpdateOtherHpBar(t,n),Tool.isNumber(a)&&0==r&&(this.onOtherLeaveHandler(this.monsterBody.data.targets,a),this.monsterBody.onClearTargets())},t.prototype.onResRankMsg=function(e){var t=e.message;this.selfRankDamage=t.getLong(),this.selfRank=-1,this.rankDamages=[];for(var n=t.getShort(),a=0;n>a;a++){var i=new BossDamageParam;i.playerId=t.getInt(),i.playerName=t.getString(),i.damageNum=t.getLong(),i.index=a+1,this.rankDamages.push(i),i.playerId==DataManager.getInstance().playerManager.player.id&&(this.selfRank=a)}this.onUpdateRank(!1)},t.prototype.onUpdateRank=function(e){if(void 0===e&&(e=!0),this.rankDamages){if(e){var t=DataManager.getInstance().playerManager.player;if(0==this.rankDamages.length){var n=new BossDamageParam;n.index=1,n.playerId=t.id,n.playerName=t.name,n.damageNum=this.selfRankDamage,this.rankDamages.push(n)}else{if(this.selfRank>=0)this.rankDamages[this.selfRank].damageNum=this.selfRankDamage;else{var n;n=this.rankDamages.length>=5?this.rankDamages[this.rankDamages.length-1]:new BossDamageParam,n.playerId=t.id,n.playerName=t.name,n.damageNum=this.selfRankDamage}this.rankDamages.sort(function(e,t){return t.damageNum-e.damageNum})}for(var a=0;a<this.rankDamages.length;a++){var i=this.rankDamages[a];i.index=a+1,i.playerId==DataManager.getInstance().playerManager.player.id&&(this.selfRank=a)}}for(var o="",r="",s=0;s<this.RANK_SHOW_NUM;s++){var h=this.rankDamages[s];h&&(o+=h.index+" "+GameCommon.getInstance().getNickname(h.playerName)+"\n",r+=GameCommon.getInstance().getFormatNumberShow(h.damageNum)+"\n")}this.fight_info_bar.dmg_name_lab.text=o,this.fight_info_bar.dmg_value_lab.text=r;var l=this.selfRank>=0&&this.selfRank<10?this.selfRank+1+"":Language.instance.getText("weishangbang");this.fight_info_bar.self_dmginfo_lab.text=Language.instance.getText("wodepaiming")+"："+l,this.fight_info_bar.slef_dmg_value_lab.text=Language.instance.getText("dps")+"："+GameCommon.getInstance().getFormatNumberShow(this.selfRankDamage)
}},t.prototype.onEnterSuccessScene=function(){var t=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onFinishFight=function(t){this._status!=FIGHT_STATUS.Result&&(Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),e.prototype.onFinishFight.call(this,t),t==FightDefine.FIGHT_RESULT_FAIL?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null)):t==FightDefine.FIGHT_RESULT_SUCCESS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SamsaraBossKillLogPanel",new SamsaraBossKillLogParam(GameFight.getInstance().samsarabossId,11,!0))),this.mainscene.getBodyManager().onDestroyAllHeroTarget())},t.prototype.onDeath=function(){this.mainscene.getModuleLayer().onShowSamsaraReborn(FightDefine.SAMSARA_REBORN_CD)},t.prototype.onResReborn=function(e){var t=e.message,n=t.getInt();if(n>0)this.mainscene.getModuleLayer().onShowSamsaraReborn(n);else{this.mainscene.getModuleLayer().onHideSamsaraReborn(),this.mainscene.onupdateHero();var a=this.mainscene.mapInfo.getXYByGridIndex(this.getRandomRebornNode().nodeId);this.mainscene.setHeroMapPostion(a)}},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),DataManager.getInstance().dupManager.samsarebossData.removeAllOtherFightData(),Tool.removeTimer(this.onTimerDown,this,this.timerRunTime),this.monsterBody=null,GameFight.getInstance().samsarabossId=null,this.rankDamages=null,this.isFightOver=!1,this.mainscene.getModuleLayer().onHideOhterHpBar(),this.mainscene.getModuleLayer().onDamageRankBar(!1),this.mainscene.getModuleLayer().showorhideDupRebornBar(!1),GameFight.getInstance().samsaraTargetMsg=null},t.prototype.onCloseResultView=function(){this.mainscene.onReturnYewaiScene()},t}(BaseFightScene);__reflect(SamsaraBossFight.prototype,"SamsaraBossFight");var ServerCrossAraneFight=function(e){function t(t){var n=e.call(this,t)||this;return n.MapId=10019,n.Self_rebronNode=62,n.Enemy_rebronNode=17,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){this.fightResult=t.getByte(),this.oldRank=t.getByte(),this.newRank=t.getByte(),this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),GameFight.getInstance().fight_randomIndex=Math.abs(DataManager.getInstance().playerManager.player.id-this.enemyDatas[0].playerId)%RandomDefine.FIGHT_RANDOM.length,GameFight.getInstance().hero_randomIndex=DataManager.getInstance().playerManager.player.id%RandomDefine.FIGHT_RANDOM[GameFight.getInstance().fight_randomIndex].length,GameFight.getInstance().enemy_randomIndex=Math.max(0,this.enemyDatas[0].playerId)%RandomDefine.FIGHT_RANDOM[GameFight.getInstance().fight_randomIndex].length,e.prototype.onParseFightMsg.call(this,t),this.onSwitchMap(this.MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);if(a){var i=e.data.targets;if(i.indexOf(t)<0)return;if(this.fightResult)return;for(var o=!0,r=0;r<e.data.targets.length;r++)if(!e.data.targets[r].data.isDie){o=!1;break}o&&(t.hp=10,e.hp=0,e.onDeath())}else if(t.data.bodyType==BODY_TYPE.SELF){if(!this.fightResult)return;t.data.isDie&&(t.hp=10,e.hp=0,e.onDeath())}},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t),this.fightResult==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler():this.onResultLoseHandler()},t.prototype.onResultWinHandler=function(){var e={},t=Constant.get(Constant.CROSSARENA_REWARD_POINT_SUCC);e.award=GameCommon.getInstance().onParseAwardItemstr(t),e.oldRank=this.oldRank,e.newRank=this.newRank,Tool.callbackTime(function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LocalArenaWinPanel",e))},this,1e3,e)},t.prototype.onResultLoseHandler=function(){var e=Constant.get(Constant.CROSSARENA_REWARD_POINT_FAIL);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("YewaiPVPLosePanel",GameCommon.getInstance().onParseAwardItemstr(e)))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_SERVERFIGHT_ARENA)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(ServerCrossAraneFight.prototype,"ServerCrossAraneFight");var UnionBattleFight=function(e){function t(t){var n=e.call(this,t)||this;return n.MapId=10023,n.Map_A_Node=233,n.Map_B_Node=235,n.Map_AEnter_Node=225,n.Map_BEnter_Node=243,n.Map_Match_Node=234,n.MemberA_Pos_Ary=[223,295,154,298],n.WitnessA_Pos_Ary=[194,302],n.MemberB_Pos_Ary=[209,281,170,314],n.WitnessB_Pos_Ary=[203,311],n.fightTotalTime=0,n.fightLefttime=0,n.readyLefttime=0,n.winnerId=0,n.rebornTime=0,n.deathTimes=0,n.fightPosition=0,n.playRunTime=0,n.stampTime=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_FIGHT_MESSAGE.toString(),this.onReciveFightMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_FIGHTRESULT_MESSAGE.toString(),this.onResFightResult,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_BUYBUFF_MESSAGE.toString(),this.onReciveBuyBuffMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_COMEIN_MESSAGE.toString(),this.onReciveComeinMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.reciveChatMsg,this),this.btn_fight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoinBattle,this),this.guwu_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openInspireView,this),this.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendChatMsg,this),Tool.addTimer(this.onFightTimeDown,this,10)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_FIGHT_MESSAGE.toString(),this.onReciveFightMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_FIGHTRESULT_MESSAGE.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_BUYBUFF_MESSAGE.toString(),this.onReciveBuyBuffMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_COMEIN_MESSAGE.toString(),this.onReciveComeinMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.reciveChatMsg,this),this.btn_fight.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoinBattle,this),this.guwu_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openInspireView,this),this.btn_send.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendChatMsg,this),Tool.removeTimer(this.onFightTimeDown,this,50)},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.UnionBattleFightSkin,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=0,this.fight_info_bar.height=size.height,this.union_badges_A=this.fight_info_bar.union_badges_A,this.union_badges_B=this.fight_info_bar.union_badges_B,this.xianhun_probar_A=this.fight_info_bar.xianhun_probar_A,this.xianhun_probar_B=this.fight_info_bar.xianhun_probar_B,this.xianhun_lab_A=this.fight_info_bar.xianhun_lab_A,this.xianhun_lab_B=this.fight_info_bar.xianhun_lab_B,this.unionA_name_lab=this.fight_info_bar.unionA_name_lab,this.unionB_name_lab=this.fight_info_bar.unionB_name_lab,this.unionA_level_lab=this.fight_info_bar.unionA_level_lab,this.unionB_level_lab=this.fight_info_bar.unionB_level_lab,this.ready_bar_A=this.fight_info_bar.ready_bar_A,this.ready_bar_B=this.fight_info_bar.ready_bar_B,this.readytimeA_lab=this.fight_info_bar.readytimeA_lab,this.readytimeB_lab=this.fight_info_bar.readytimeB_lab,this.player_bar_A=this.fight_info_bar.player_bar_A,this.player_bar_B=this.fight_info_bar.player_bar_B,this.btn_fight=this.fight_info_bar.fight_btn,this.guwu_btn=this.fight_info_bar.guwu_btn,this.playerA_Hp_Lab=this.player_bar_A.hp_label,this.playerB_Hp_Lab=this.player_bar_B.hp_label,this.fight_rule_lab=this.fight_info_bar.fight_rule_lab,this.inspire_times_lab=this.fight_info_bar.inspire_times_lab,this.unionA_inspireinfo_lab=this.fight_info_bar.unionA_inspireinfo_lab,this.unionB_inspireinfo_lab=this.fight_info_bar.unionB_inspireinfo_lab,this.minChat_lab=this.fight_info_bar.minChat_lab,this.label_input=this.fight_info_bar.label_input,this.chatwicket=this.fight_info_bar.chatwicket,this.btn_send=this.fight_info_bar.btn_send,this.chat_scroller=this.fight_info_bar.chat_scroller,this.reborn_time_lab=this.fight_info_bar.reborn_time_lab,this.life_lefttimes_lab=this.fight_info_bar.life_lefttimes_lab),this.player_bar_A.visible=!1,this.player_bar_B.visible=!1,this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},Object.defineProperty(t.prototype,"heroPlayer",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myUnionData",{get:function(){return DataManager.getInstance().unionManager.unionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myBattleInfo",{get:function(){return 1==this.fightPosition?this.unionA_FightInfo:2==this.fightPosition?this.unionB_FightInfo:null},enumerable:!0,configurable:!0}),t.prototype.parseBattleLogStr=function(e,t){return(n=Language.instance).parseInsertText.apply(n,["unionbattle_notice"+e].concat(t));var n},t.prototype.addOneBattleLog=function(e,t){var n=new ChatBase(CHANNEL.SYS);n.content=this.parseBattleLogStr(e,t),this.addBattleChatText([n])},t.prototype.addBattleChatText=function(e){if(void 0===e&&(e=null),e)for(var t=0;t<e.length;t++){var n=e[t];this.battleChats.push(n),this.battleChats.length>100&&this.battleChats.shift()}for(var a,i=[],o=[],t=0;t<this.battleChats.length;t++)switch(a=this.battleChats[t],a.type){case CHANNEL.GUILD:i.push({text:"[仙盟]",style:{textColor:13511409}}),i.push({text:"["+UnionDefine.Union_Postions[a.job]+"]",style:{textColor:13511409}}),i.push({text:GameCommon.getInstance().getNickname(a.player.name)+":",style:{textColor:2661098}}),i.push({text:a.content,style:{textColor:16777215}}),i.push({text:"\n",style:{}});break;case CHANNEL.SYS:a.content=GameCommon.getInstance().readStringToHtml(a.content),i.push({text:"[系统]",style:{textColor:16756257}}),o=(new egret.HtmlTextParser).parser(a.content);for(var r=0;r<o.length;r++)i.push(o[r]);i.push({text:"\n",style:{}})}this.minChat_lab.textFlow=i,this.checkNotBottom()||setTimeout(this.adjustBar.bind(this),50)},t.prototype.adjustBar=function(){this.chat_scroller.stopAnimation(),this.chat_scroller.viewport.scrollV=Math.max(this.chat_scroller.viewport.contentHeight-this.chat_scroller.viewport.height,0)},t.prototype.checkNotBottom=function(){return this.chat_scroller.viewport.contentHeight>this.chat_scroller.viewport.height&&this.chat_scroller.viewport.scrollV<this.chat_scroller.viewport.contentHeight-this.chat_scroller.viewport.height-50?!0:!1},t.prototype.reciveChatMsg=function(e){if(DataManager.getInstance().chatManager.currType==CHANNEL.GUILD){var t=e.message;t.type==CHANNEL.GUILD&&this.addBattleChatText([t])}},t.prototype.onSendChatMsg=function(){var e=this.label_input.text,t=new Message(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE);t.setByte(CHANNEL.GUILD),t.setString(e),t.setInt(-1),GameCommon.getInstance().sendMsgToServer(t),this.label_input.text=""},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this.battleChats=[],this.unionA_memberDatas={},this.unionB_memberDatas={},this.unionA_members=[],this.unionB_members=[],this.readyLefttime=1e3*t.getByte()+egret.getTimer(),this.fightPosition=0;var n,a=DataManager.getInstance().unionManager.unionbattleInfo,i=t.getInt();this.unionA_FightInfo=a.getUnionFightInfoById(i),this.unionA_FightInfo.score=t.getByte(),this.myUnionData.info.id==this.unionA_FightInfo.unionId&&(this.fightPosition=1),n=t.getByte();for(var o=0;n>o;o++)this.parseEnterMember(t,i);var r=t.getInt();this.unionB_FightInfo=a.getUnionFightInfoById(r),this.unionB_FightInfo.score=t.getByte(),this.myUnionData.info.id==this.unionB_FightInfo.unionId&&(this.fightPosition=2),n=t.getByte();for(var o=0;n>o;o++)this.parseEnterMember(t,r);this.rebornTime=1e3*t.getInt()+egret.getTimer(),this.deathTimes=t.getByte();for(var s=t.getByte(),o=0;s>o;o++){var h=t.getString(),l=h.split("#"),g=this.parseBattleLogStr(parseInt(l[0]),l[1].split(",")),c=new ChatBase(CHANNEL.SYS);c.content=g,this.battleChats.push(c)}this.onSwitchMap(this.MapId)},t.prototype.onReciveComeinMsg=function(e){var t=e.getInt();this.parseEnterMember(e,t)},t.prototype.parseEnterMember=function(e,t){var n=e.getInt(),a=e.getString(),i=e.getByte(),o=new PlayerAppears;o.parseMsg(e);var r;t==this.unionA_FightInfo.unionId?this.unionA_memberDatas[n]||(r=new PlayerData(1,BODY_TYPE.PLAYER),r.playerId=n,r.name=a+"·"+UnionDefine.Union_Postions[i],r.index=0,r.sex=o.appears[0].sex,r.setAppear(o.appears[0]),this.unionA_memberDatas[n]=r):t==this.unionB_FightInfo.unionId&&(this.unionB_memberDatas[n]||(r=new PlayerData(1,BODY_TYPE.PLAYER),r.playerId=n,r.name=a+"·"+UnionDefine.Union_Postions[i],r.index=0,r.sex=o.appears[0].sex,r.setAppear(o.appears[0]),this.unionB_memberDatas[n]=r))},t.prototype.onUpdateScore=function(){var e=UnionDefine.UNIONBATTLE_SCORE_MAX-this.unionB_FightInfo.score;this.xianhun_lab_A.text=Language.instance.getText("unionbattle_score")+":"+e+"/"+UnionDefine.UNIONBATTLE_SCORE_MAX;var t=UnionDefine.UNIONBATTLE_SCORE_MAX-this.unionA_FightInfo.score;this.xianhun_lab_B.text=Language.instance.getText("unionbattle_score")+":"+t+"/"+UnionDefine.UNIONBATTLE_SCORE_MAX,this.xianhun_probar_A.value=e,this.xianhun_probar_B.value=t},t.prototype.onUpdatePlayerHead=function(){var e=0;this.unionA_Fighter?(e=this.getHpPercent(this.fighterA_CurHp,this.fighterA_MaxHp),this.player_bar_A.playerHead.setHead(this.unionA_Fighter.data.headiconIdx,this.unionA_Fighter.data.headFrame),this.player_bar_A.name_lab.text=this.unionA_Fighter.data.name,this.player_bar_A.maximum=100,this.player_bar_A.value=e,this.playerA_Hp_Lab.text=e+"%",this.ready_bar_A.visible=!1,this.player_bar_A.visible||(this.player_bar_A.visible=!0)):(this.player_bar_A.visible=!1,this.ready_bar_A.visible=!0),this.unionB_Fighter?(this.ready_bar_B.visible=!1,e=this.getHpPercent(this.fighterB_CurHp,this.fighterB_MaxHp),this.player_bar_B.playerHead.setHead(this.unionB_Fighter.data.headiconIdx,this.unionB_Fighter.data.headFrame),this.player_bar_B.name_lab.text=this.unionB_Fighter.data.name,this.player_bar_B.maximum=100,this.player_bar_B.value=e,this.playerB_Hp_Lab.text=e+"%",this.player_bar_B.visible||(this.player_bar_B.visible=!0)):(this.player_bar_B.visible=!1,this.ready_bar_B.visible=!0)},t.prototype.onReciveFightMsg=function(){var e=GameFight.getInstance().unionbattlePkMsg,t=this.isInit;if(GameFight.getInstance().unionbattlePkMsg&&!this.isFightting){var n=t||this.unionA_Fighter?!1:!0,a=t||this.unionB_Fighter?!1:!0;this.unionA_PlayerName=null,this.unionB_PlayerName=null;var i=e.getLong(),o=e.getShort();this.fightTotalTime=Math.min(500*o,UnionDefine.UNION_BATTLE_OVER_TIME-1e3);for(var r=e.getByte(),s=0;r>s;s++){var h=e.getInt(),l=e.getLong(),g=e.getLong(),c=e.getLong(),p=e.getByte(),u=GameFight.getInstance().onParsePVPEnemyMsg(e,!1)[0];this.unionA_FightInfo.unionId==h?(this.unionA_PlayerName=u.name,this.fighterA_MaxHp=c,this.fighterA_CurHp=l,this.fighterA_EndHp=g,this.A_End_RebornNum=p):this.unionB_FightInfo.unionId==h&&(this.unionB_PlayerName=u.name,this.fighterB_MaxHp=c,this.fighterB_CurHp=l,this.fighterB_EndHp=g,this.B_End_RebornNum=p),this.onCreateFightBody(h,u)}this.onUpdatePlayerHead(),this.unionA_Fighter&&this.unionB_Fighter&&t?(i+=this.fightTotalTime,this.fightLefttime=Math.max(0,i-this.heroPlayer.curServerTime+egret.getTimer())):this.fightLefttime=0;var d,_;if(this.unionA_Fighter){if(_=n?this.Map_AEnter_Node:this.Map_A_Node,!this.unionA_Fighter.parent)if(this.unionA_Fighter.data.playerId==this.heroPlayer.getPlayerData().playerId)d=this.mapInfo.getGridRdXYByIndex(_),this.mainscene.setHeroMapPostion(d);else{var m=this.mapInfo.getNodeModelByIndex(_);this.mainscene.getBodyManager().setOtherPlayerPos(this.unionA_Fighter,[m])}if(n){d=this.mainscene.mapInfo.getXYByGridIndex(this.Map_A_Node),this.unionA_Fighter.setMove([d]),this.onCameraFollow(this.unionA_Fighter,this.unionA_FightInfo.unionId);var E=this.getJobNameByPlayerId(this.unionA_Fighter.data.playerId,this.unionA_members);this.memberSpeak(this.unionA_Fighter,this.unionA_members,E),this.witnessSpeak(this.unionA_Fighter,this.unionA_witness)}else this.unionA_Fighter.direction=Direction.RIGHT}if(this.unionB_Fighter){if(_=a?this.Map_BEnter_Node:this.Map_B_Node,!this.unionB_Fighter.parent)if(this.unionB_Fighter.data.playerId==this.heroPlayer.getPlayerData().playerId)d=this.mapInfo.getGridRdXYByIndex(_),this.mainscene.setHeroMapPostion(d);else{var m=this.mapInfo.getNodeModelByIndex(_);this.mainscene.getBodyManager().setOtherPlayerPos(this.unionB_Fighter,[m])}if(a){d=this.mainscene.mapInfo.getXYByGridIndex(this.Map_B_Node),this.unionB_Fighter.setMove([d]),this.onCameraFollow(this.unionB_Fighter,this.unionB_FightInfo.unionId);var E=this.getJobNameByPlayerId(this.unionB_Fighter.data.playerId,this.unionB_members);this.memberSpeak(this.unionB_Fighter,this.unionB_members,E),this.witnessSpeak(this.unionB_Fighter,this.unionB_witness)}else this.unionB_Fighter.direction=Direction.LEFT}this.unionB_Fighter&&this.unionA_Fighter&&(this.fighterA_EndHp>0?this.winnerId=this.unionA_Fighter.data.playerId:this.winnerId=this.unionB_Fighter.data.playerId,this.onPlayPKFight(t)),GameFight.getInstance().unionbattlePkMsg=null}},t.prototype.onCreateFightBody=function(e,t){this.unionA_FightInfo.unionId==e?(t.playerId==this.heroPlayer.getPlayerData().playerId?(this.unionA_Fighter||(this.mainscene.heroBody.data.onRebirth(),this.mainscene.heroBody.onRefreshData()),this.unionA_Fighter=this.mainscene.heroBody):this.unionA_Fighter?(t.onRebirth(),t.shieldValue=this.unionA_Fighter.data.shieldValue,t.reborncount=this.unionA_Fighter.data.reborncount,this.unionA_Fighter.data=t):this.unionA_Fighter=this.mainscene.getBodyManager().onCreateOtherPlayer(t),this.unionA_Fighter.data.shieldValue>0&&this.fighterA_CurHp<this.fighterA_MaxHp&&(this.unionA_Fighter.data.shieldValue=0,this.unionA_Fighter.removeShieldAnim()),this.unionA_Fighter.onShowOrHideHpBar(!1)):this.unionB_FightInfo.unionId==e&&(t.playerId==this.heroPlayer.getPlayerData().playerId?(this.unionB_Fighter||(this.mainscene.heroBody.data.onRebirth(),this.mainscene.heroBody.onRefreshData()),this.unionB_Fighter=this.mainscene.heroBody):this.unionB_Fighter?(t.onRebirth(),t.shieldValue=this.unionB_Fighter.data.shieldValue,t.reborncount=this.unionB_Fighter.data.reborncount,this.unionB_Fighter.data=t):this.unionB_Fighter=this.mainscene.getBodyManager().onCreateOtherPlayer(t),this.unionB_Fighter.data.shieldValue>0&&this.fighterB_CurHp<this.fighterB_MaxHp&&(this.unionB_Fighter.data.shieldValue=0,this.unionB_Fighter.removeShieldAnim()),this.unionB_Fighter.onShowOrHideHpBar(!1)),this.onUpdatePlayerHead()},t.prototype.onCameraFollow=function(e,t){if(this.playRunTime=UnionDefine.UNIONBATTLE_RUNTIME+egret.getTimer(),!this.followBody){if(this.fightPosition>0){if(1==this.fightPosition&&!this.unionA_Fighter)return;if(2==this.fightPosition&&!this.unionB_Fighter)return}this.followBody=e,this.updateMemberBodys(t),this.onFightTimeDown()}},t.prototype.getJobNameByPlayerId=function(e,t){var n="";for(var a in t){var i=t[a];if(e==i.playerId){n=i.name;break}}return n},Object.defineProperty(t.prototype,"isFightting",{get:function(){return this.winnerId>0},enumerable:!0,configurable:!0}),t.prototype.onFightTimeDown=function(){if(this.stampTime<egret.getTimer()){switch(this._status){case FIGHT_STATUS.Requset:var e=Math.max(0,Math.ceil((this.readyLefttime-egret.getTimer())/1e3)),t=null;if(UnionDefine.UNIONBATTLE_LIFE_TIMES>this.deathTimes){switch(this.fightPosition){case 1:t=this.unionA_Fighter?!0:!1;break;case 2:t=this.unionB_Fighter?!0:!1}null!=t&&(t?this.btn_fight.enabled&&(this.btn_fight.enabled=!1,this.btn_fight.label=Language.instance.getText("unionbattle_wait")):(this.btn_fight.enabled||(this.btn_fight.enabled=!0),this.btn_fight.label=Language.instance.parseInsertText("unionbattle_join",e)))}else this.btn_fight.enabled&&(this.btn_fight.enabled=!1,this.btn_fight.label=Language.instance.getText("error_tips_10002"));this.ready_bar_A.visible&&(this.readytimeA_lab.text=e+"S"),this.ready_bar_B.visible&&(this.readytimeB_lab.text=e+"S");break;case FIGHT_STATUS.Fighting:if(!this.isFightting)break;if(this.fightLefttime<=0)break;var n=Math.max(0,this.fightLefttime-egret.getTimer()),a=0,i=this.A_Lost_HP-Tool.toInt(this.A_Lost_HP*(n/this.fightTotalTime)),o=this.fighterA_CurHp+this.A_Shield_Num-i;0>=o&&(this.unionA_Fighter.data.reborncount>0&&(this.unionA_Fighter.data.reborncount=0,this.unionA_Fighter.onPlayRebornAnim()),o=Math.max(0,this.A_Reborn_Num+o)),a=this.getHpPercent(o,this.fighterA_MaxHp),this.player_bar_A.value=a,this.playerA_Hp_Lab.text=a+"%",this.unionA_Fighter.data.shieldValue>0&&100>a&&(this.unionA_Fighter.data.shieldValue=0,this.unionA_Fighter.removeShieldAnim());var r=this.B_Lost_HP-Tool.toInt(this.B_Lost_HP*(n/this.fightTotalTime)),s=this.fighterB_CurHp+this.B_Shield_Num-r;0>=s&&(this.unionB_Fighter.data.reborncount>0&&(this.unionB_Fighter.data.reborncount=0,this.unionB_Fighter.onPlayRebornAnim()),s=Math.max(0,this.B_Reborn_Num+s)),a=this.getHpPercent(s,this.fighterB_MaxHp),this.player_bar_B.value=a,this.playerB_Hp_Lab.text=a+"%",this.unionB_Fighter.data.shieldValue>0&&100>a&&(this.unionB_Fighter.data.shieldValue=0,this.unionB_Fighter.removeShieldAnim()),(0==o||0==s||0==n)&&this.onOverPKFight()}if(this.rebornTime>0&&this.fightPosition>0){var n=Math.floor((this.rebornTime-egret.getTimer())/1e3);if(n>=0){var h=GameCommon.getInstance().getTimeStrForSec1(n);this.reborn_time_lab.text=Language.instance.getText("shengyu","fuhuoshijian")+"："+h}else this.rebornTime=0,this.reborn_time_lab.text="";this.updateFightBtnStatus()}this.stampTime=egret.getTimer()+500}if(this.playRunTime>0){var l=Math.ceil((this.playRunTime-egret.getTimer())/1e3);l>0&&this.followBody?this.followBody.data.playerId!=DataManager.getInstance().playerManager.player.id&&this.mainscene.getMapLayer().onCameraFollowForBody(this.followBody):(this.playRunTime=0,this.followBody=null,this.mainscene.getMapLayer().onCameraFollowForBody(null),this._status==FIGHT_STATUS.Fighting&&(this.unionA_Fighter.onAddEnemyBodyList([this.unionB_Fighter]),this.unionB_Fighter.onAddEnemyBodyList([this.unionA_Fighter])))}},Object.defineProperty(t.prototype,"deathCount",{set:function(e){if(this.deathTimes=e,this.fightPosition>0){var t=Math.max(0,UnionDefine.UNIONBATTLE_LIFE_TIMES-e);this.life_lefttimes_lab.text=Language.instance.getText("shengyu","fuhuocishu")+"："+t+"/"+UnionDefine.UNIONBATTLE_LIFE_TIMES}else this.life_lefttimes_lab.text=""},enumerable:!0,configurable:!0}),t.prototype.onResFightResult=function(e){var t=e.message,n=t.getInt(),a=t.getByte(),i=t.getInt(),o=t.getByte();if(n==this.unionA_FightInfo.unionId?(this.unionA_FightInfo.score=a,this.unionB_FightInfo.score=o):i==this.unionA_FightInfo.unionId&&(this.unionA_FightInfo.score=o,this.unionB_FightInfo.score=a),this._status=FIGHT_STATUS.Requset,this.guwu_btn.visible=this.fightPosition>0,this.updateFightBtnStatus(),this.onUpdateScore(),this.unionA_PlayerName||this.unionB_PlayerName)if(this.unionA_PlayerName&&this.unionB_PlayerName){var r=["",""];this.unionA_Fighter?(r[0]=this.unionA_FightInfo.name+"的"+this.unionA_PlayerName,r[1]=this.unionB_FightInfo.name+"的"+this.unionB_PlayerName,this.unionB_PlayerName=null):(r[0]=this.unionB_FightInfo.name+"的"+this.unionB_PlayerName,r[1]=this.unionA_FightInfo.name+"的"+this.unionA_PlayerName,this.unionA_PlayerName=null),this.addOneBattleLog(UnionBattle_Log.FIGHT_RESULT,r)}else this.unionA_PlayerName?this.unionB_PlayerName||this.addOneBattleLog(UnionBattle_Log.ENEMY_NULL,[this.unionB_FightInfo.name]):this.addOneBattleLog(UnionBattle_Log.ENEMY_NULL,[this.unionA_FightInfo.name]);else this.addOneBattleLog(UnionBattle_Log.NOBODY_FIGHT,[]);this.onOverPKFight();var s=0;this.unionA_FightInfo.score>=UnionDefine.UNIONBATTLE_SCORE_MAX?s=1:this.unionB_FightInfo.score>=UnionDefine.UNIONBATTLE_SCORE_MAX&&(s=2),s>0?(this.player_bar_A.visible=!1,this.player_bar_B.visible=!1,Tool.callbackTime(this.onResultHandler,this,2e3,s)):(this.onUpdatePlayerHead(),this.readyLefttime=1e3*UnionDefine.UNION_BATTLE_READY_TIME+egret.getTimer(),this.onFightTimeDown())},t.prototype.onStartFight=function(){this._status=FIGHT_STATUS.Requset,this.mainscene.getBodyManager().fightPause=!1,this.mainscene.heroBody.isDamageFalse=!0,this.isInit=!0;var e=this.unionA_FightInfo.badgesIndex,t=this.unionB_FightInfo.badgesIndex,n=this.unionA_FightInfo.level,a=this.unionB_FightInfo.level,i=0,o=0;i=Tool.toInt(e/UnionDefine.Union_Badges_ColorNum)+1,this.union_badges_A.badges_bg.source="union_badges_bg"+i+"_png",o=e%UnionDefine.Union_Badges_IconNum+1,this.union_badges_A.badges_icon.source="union_badges_icon"+o+"_png",this.unionA_name_lab.text=this.unionA_FightInfo.name,this.unionA_level_lab.text=Language.instance.getText("dengji")+"："+n,i=Tool.toInt(t/UnionDefine.Union_Badges_ColorNum)+1,this.union_badges_B.badges_bg.source="union_badges_bg"+i+"_png",o=t%UnionDefine.Union_Badges_IconNum+1,this.union_badges_B.badges_icon.source="union_badges_icon"+o+"_png",this.unionB_name_lab.text=this.unionB_FightInfo.name,this.unionB_level_lab.text=Language.instance.getText("dengji")+"："+a,this.reborn_time_lab.text="",this.xianhun_probar_A.maximum=UnionDefine.UNIONBATTLE_SCORE_MAX,this.xianhun_probar_B.maximum=UnionDefine.UNIONBATTLE_SCORE_MAX,this.guwu_btn.visible=this.fightPosition>0,this.chatwicket.visible=this.fightPosition>0,this.fight_rule_lab.text=0==this.fightPosition?Language.instance.getText("unionbattle_rule_2"):Language.instance.getText("unionbattle_rule_1"),this.deathCount=this.deathTimes,this.updateFightBtnStatus(),this.onUpdateInsprite(),this.onUpdateScore(),this.onUpdatePlayerHead(),this.initWitnessBodys();for(var r=DataManager.getInstance().chatManager.chat[CHANNEL.GUILD].concat(),s=0;10>=s;s++){var h=r[s];if(!h)break;this.battleChats.unshift(h)}this.addBattleChatText(),GameFight.getInstance().unionbattlePkMsg&&this.onReciveFightMsg(),this.isInit=!1},t.prototype.onReciveBuyBuffMsg=function(e){var t=e.message,n=t.getInt(),a=t.getByte(),i=t.getString(),o=DataManager.getInstance().unionManager.unionbattleInfo.getUnionFightInfoById(n);o&&(o.buffCount=a),this.onUpdateInsprite(),this.addOneBattleLog(UnionBattle_Log.BUY_BUFF,[o.name+"的"+i])},t.prototype.onUpdateInsprite=function(){this.myBattleInfo&&(this.inspire_times_lab.text=Language.instance.getText("yiguwu")+":"+this.myBattleInfo.buffCount+"/"+UnionDefine.UNIONBATTLE_BUFF_MAX),this.unionA_inspireinfo_lab.text=Language.instance.getText("inspire",this.unionA_FightInfo.buffCount,"level"," ","attr1_name","+",20*this.unionA_FightInfo.buffCount,"%"),this.unionB_inspireinfo_lab.text=Language.instance.getText("inspire",this.unionB_FightInfo.buffCount,"level"," ","attr1_name","+",20*this.unionB_FightInfo.buffCount,"%")},t.prototype.openInspireView=function(){this.myBattleInfo&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionInspirePanel",this.myBattleInfo.buffCount))},t.prototype.onBodyHurtHanlder=function(e,t,n){if(e==this.unionA_Fighter||t==this.unionA_Fighter||e==this.unionB_Fighter||t==this.unionB_Fighter){if(0==this.fightLefttime&&(this.fightLefttime=egret.getTimer()+this.fightTotalTime),t.data.shieldValue>0){var a=t.data.shieldValue;Math.max(0,n.value-t.data.shieldValue);t.data.shieldValue=Math.max(0,t.data.shieldValue-n.value),n.xishou=Math.max(0,a-t.data.shieldValue)}Math.max(0,this.fightLefttime-egret.getTimer());t.addFlyFont(n)}},t.prototype.onPlayPKFight=function(e){void 0===e&&(e=!1),this._status=FIGHT_STATUS.Fighting,this.unionA_Fighter.isDamageFalse=!0,this.unionB_Fighter.isDamageFalse=!0,this.A_Lost_HP=0,this.A_Reborn_Num=0,this.A_Shield_Num=this.unionA_Fighter.data.shieldValue,this.unionA_Fighter.data.reborncount>0&&(this.A_Reborn_Num=Tool.toInt(this.fighterA_MaxHp*this.unionA_Fighter.data.rebornEffect/GameDefine.GAME_ADD_RATIO)),this.fighterA_CurHp-this.fighterA_EndHp>0&&(this.A_Lost_HP+=this.unionA_Fighter.data.shieldValue,this.A_Reborn_Num>0&&0==this.A_End_RebornNum?(this.fighterA_EndHp>this.A_Reborn_Num&&(this.A_Reborn_Num=this.fighterA_EndHp),this.A_Lost_HP+=this.fighterA_CurHp+(this.A_Reborn_Num-this.fighterA_EndHp)):this.A_Lost_HP+=this.fighterA_CurHp-this.fighterA_EndHp),this.B_Lost_HP=0,this.B_Reborn_Num=0,this.B_Shield_Num=this.unionB_Fighter.data.shieldValue,this.unionB_Fighter.data.reborncount>0&&(this.B_Reborn_Num=Tool.toInt(this.fighterB_MaxHp*this.unionB_Fighter.data.rebornEffect/GameDefine.GAME_ADD_RATIO)),this.fighterB_CurHp-this.fighterB_EndHp>0&&(this.B_Lost_HP+=this.unionB_Fighter.data.shieldValue,this.B_Reborn_Num>0&&0==this.B_End_RebornNum?(this.fighterB_EndHp>this.B_Reborn_Num&&(this.B_Reborn_Num=this.fighterB_EndHp),this.B_Lost_HP+=this.fighterB_CurHp+(this.B_Reborn_Num-this.fighterB_EndHp)):this.B_Lost_HP+=this.fighterB_CurHp-this.fighterB_EndHp),this.guwu_btn.visible=!1,this.updateFightBtnStatus(),e?(this.unionA_Fighter.onAddEnemyBodyList([this.unionB_Fighter]),this.unionB_Fighter.onAddEnemyBodyList([this.unionA_Fighter])):(Tool.callbackTime(this.figtherSpeak,this,Math.floor(2e3*Math.random()+3e3),this.unionA_Fighter),Tool.callbackTime(this.figtherSpeak,this,Math.floor(2e3*Math.random()+3e3),this.unionB_Fighter))},t.prototype.onOverPKFight=function(){if(this.isFightting){this.unionA_Fighter.onClearTargets(),this.mainscene.getBodyManager().playStandForPlayer(this.unionA_Fighter),this.unionB_Fighter.onClearTargets(),this.mainscene.getBodyManager().playStandForPlayer(this.unionB_Fighter);var e=this.unionA_Fighter&&this.unionA_Fighter.data.playerId,t=this.unionB_Fighter&&this.unionB_Fighter.data.playerId,n=0;e!=this.winnerId&&(e!=this.heroPlayer.id?this.mainscene.getBodyManager().onDestroyOhterOne(this.unionA_Fighter,!1):(this.onPutHeroMatchPosition(),this.deathCount=this.deathTimes+1,this.rebornTime=egret.getTimer()+1e3*UnionDefine.UNIONBATTLE_REBORN_TIME),this.unionA_Fighter=null,this.fighterA_CurHp=0,this.fighterA_EndHp=0,this.fighterB_CurHp=this.fighterB_EndHp,this.player_bar_A.value=0,this.playerA_Hp_Lab.text="0%",n=this.getHpPercent(this.fighterB_CurHp,this.fighterB_MaxHp),this.player_bar_B.value=n,this.playerB_Hp_Lab.text=n+"%"),t!=this.winnerId&&(t!=this.heroPlayer.id?this.mainscene.getBodyManager().onDestroyOhterOne(this.unionB_Fighter,!1):(this.onPutHeroMatchPosition(),this.deathCount=this.deathTimes+1,this.rebornTime=egret.getTimer()+1e3*UnionDefine.UNIONBATTLE_REBORN_TIME),this.unionB_Fighter=null,this.fighterB_CurHp=0,this.fighterB_EndHp=0,this.fighterA_CurHp=this.fighterA_EndHp,this.player_bar_B.value=0,this.playerB_Hp_Lab.text="0%",n=this.getHpPercent(this.fighterA_CurHp,this.fighterA_MaxHp),this.player_bar_A.value=n,this.playerA_Hp_Lab.text=n+"%"),this.winnerId=0,this.fightLefttime=0
}},t.prototype.getHpPercent=function(e,t){var n=Math.min(100,Math.floor(e/t*100));return e>0&&(n=Math.max(n,1)),n},t.prototype.onPutHeroMatchPosition=function(){var e=this.mapInfo.getGridRdXYByIndex(this.Map_Match_Node);this.mainscene.heroBody.x=e.x,this.mainscene.heroBody.y=e.y,this.mainscene.onRemoveHero(this.mainscene.heroBody)},t.prototype.updateFightBtnStatus=function(){if(0==this.fightPosition)this.btn_fight.visible&&(this.btn_fight.visible=!1);else{var e=Math.floor((this.rebornTime-egret.getTimer())/1e3),t=0>e&&this._status!=FIGHT_STATUS.Fighting;t!=this.btn_fight.visible&&(this.btn_fight.visible=t)}},t.prototype.onJoinBattle=function(){if(this.fightPosition>0&&!this.isFightting){var e=new Message(MESSAGE_ID.UNION_BATTLE_FIGHT_MESSAGE);GameFight.getInstance().parseFightRandom(e),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onEnterSuccessScene=function(){this.onPutHeroMatchPosition(),e.prototype.onEnterSuccessScene.call(this)},t.prototype.initWitnessBodys=function(){var e,t,n=[Direction.RIGHTDOWN,Direction.RIGHTUP];this.unionA_witness=[];for(var a=0;a<this.WitnessA_Pos_Ary.length;a++)t=this.mapInfo.getNodeModelByIndex(this.WitnessA_Pos_Ary[a]),e=this.mainscene.getBodyManager().onCreateFakerPlayerToSnece(.6,1.2,[t],""),e.direction=n[a],e.onShowOrHideHpBar(!1),this.unionA_witness.push(e);n=[Direction.LEFTDOWN,Direction.LEFTUP],this.unionB_witness=[];for(var a=0;a<this.WitnessB_Pos_Ary.length;a++)t=this.mapInfo.getNodeModelByIndex(this.WitnessB_Pos_Ary[a]),e=this.mainscene.getBodyManager().onCreateFakerPlayerToSnece(.6,1.2,[t],""),e.direction=n[a],e.onShowOrHideHpBar(!1),this.unionB_witness.push(e)},t.prototype.updateMemberBodys=function(e){var t,n,a;if(e==this.unionA_FightInfo.unionId){var i=[];for(var o in this.unionA_memberDatas){var r=this.unionA_memberDatas[o];i.push(r)}for(var s=0;s<this.MemberA_Pos_Ary.length&&0!=i.length;s++){var h=Math.floor(Math.random()*i.length);n=i[h],i.splice(h,1),n.playerId!=this.unionA_Fighter.data.playerId&&(a=this.unionA_members[s],a?(a.data.onRebirth(),a.data=n):(t=this.mapInfo.getNodeModelByIndex(this.MemberA_Pos_Ary[s]),a=this.mainscene.getBodyManager().onCreateOtherPlayer(n,[t]),this.unionA_members.push(a)),a.onShowOrHideHpBar(!1))}for(var s=0;s<this.unionA_witness.length;s++)a=this.unionA_witness[s],a.data.onRebirth(),a.onShowOrHideHpBar(!1)}else if(e==this.unionB_FightInfo.unionId){var l=[];for(var o in this.unionB_memberDatas){var r=this.unionB_memberDatas[o];l.push(r)}for(var s=0;s<this.MemberB_Pos_Ary.length&&0!=l.length;s++){var h=Math.floor(Math.random()*l.length);n=l[h],l.splice(h,1),n.playerId!=this.unionB_Fighter.data.playerId&&(a=this.unionB_members[s],a?(a.data.onRebirth(),a.data=n):(t=this.mapInfo.getNodeModelByIndex(this.MemberB_Pos_Ary[s]),a=this.mainscene.getBodyManager().onCreateOtherPlayer(n,[t]),this.unionB_members.push(a)),a.onShowOrHideHpBar(!1))}for(var s=0;s<this.unionB_witness.length;s++)a=this.unionB_witness[s],a.data.onRebirth(),a.onShowOrHideHpBar(!1)}},t.prototype.memberSpeak=function(e,t,n){var a=9,i=Math.ceil(Math.random()*a);if(t.length>0){var o=t[Math.floor(Math.random()*t.length)],r=GameCommon.getInstance().readStringToHtml(Language.instance.parseInsertText("bangzhong_"+i,n));o.bodySpeak(r)}},t.prototype.witnessSpeak=function(e,t){var n=8,a=Math.ceil(Math.random()*n),i=t[Math.floor(Math.random()*t.length)],o=GameCommon.getInstance().readStringToHtml(Language.instance.parseInsertText("luren_"+a,e.data.name));i.bodySpeak(o)},t.prototype.figtherSpeak=function(e){if(e){var t=6,n=Math.ceil(Math.random()*t),a=GameCommon.getInstance().readStringToHtml(Language.instance.getText("duizhan_"+n));e.bodySpeak(a)}},t.prototype.onResultHandler=function(e){var t=new UnionBattleResultParam;if(this.fightPosition>0){var n=Math.round(Math.sqrt(UnionDefine.Union_Battle_JoinMax)),a=this.myBattleInfo.roundCount;if(this.fightPosition==e)if(a>=n){t.resultParam=Language.instance.getText("unionbattle_champion_result");var i=JsonModelManager.instance.getModelguildreward()[1];t.awardList=GameCommon.getInstance().onParseAwardItemstr(i.tongyongReward),t.specialAwdList=GameCommon.getInstance().onParseAwardItemstr(i.cangkuReward)}else t.contiuneDesc=Language.instance.getText("unionbattle_win_result");else{for(var o=[],r=DataManager.getInstance().unionManager.unionbattleInfo,s=0;s<r.joinUnions.length;s++){var h=r.joinUnions[s];h.roundCount==this.myBattleInfo.roundCount&&o.push(h)}for(var l=Tool.toInt(o.length/2)+1,g=1,c=0;c<o.length;c++){var h=o[c];if(h.name==this.myUnionData.info.name)break;g++}g=Math.max(l,g),t.resultParam=Language.instance.parseInsertText("unionbattle_lost_result",g);var i=JsonModelManager.instance.getModelguildreward()[g];i&&(t.awardList=GameCommon.getInstance().onParseAwardItemstr(i.tongyongReward),t.specialAwdList=GameCommon.getInstance().onParseAwardItemstr(i.cangkuReward))}}else{var p=1==e?this.unionA_FightInfo.name:this.unionB_FightInfo.name;t.contiuneDesc=Language.instance.parseInsertText("unionbattle_witness_result",p)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionBattleResultPanel",t))},t.prototype.onDeath=function(){},t.prototype.onFightWin=function(){},t.prototype.onFightLose=function(){},t.prototype.onTouchLeaveBtn=function(){var e=[{text:Language.instance.getText("unionbattle_quit_desc")}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onQuitScene,this)))},t.prototype.onQuitScene=function(){if(GameFight.getInstance().fightsceneTpye==this.sceneTpye){var e=new Message(MESSAGE_ID.UNION_BATTLE_QUIT_MESSAGE);e.setInt(this.unionA_FightInfo.unionId),GameCommon.getInstance().sendMsgToServer(e),this.mainscene.onReturnYewaiScene()}},t.prototype.onDestroyScene=function(){this.unionA_FightInfo=null,this.unionB_FightInfo=null,this.unionA_Fighter=null,this.unionB_Fighter=null,this.unionA_memberDatas=null,this.unionB_memberDatas=null,this.unionA_members=null,this.unionB_members=null,this.unionA_witness=null,this.unionB_witness=null,this.battleChats=null,GameFight.getInstance().unionbattlePkMsg=null,this.winnerId=0,e.prototype.onDestroyScene.call(this)},Object.defineProperty(t.prototype,"TickInterval",{get:function(){return 1e3},enumerable:!0,configurable:!0}),t}(BaseFightScene);__reflect(UnionBattleFight.prototype,"UnionBattleFight");var UnionBattle_Log;!function(e){e[e.FIGHT_RESULT=1]="FIGHT_RESULT",e[e.BUY_BUFF=2]="BUY_BUFF",e[e.ENEMY_NULL=3]="ENEMY_NULL",e[e.NOBODY_FIGHT=4]="NOBODY_FIGHT"}(UnionBattle_Log||(UnionBattle_Log={}));var UnionBossFight=function(e){function t(t){var n=e.call(this,t)||this;return n.currBossHp=0,n.beforeBossHp=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BOSS_RESUTL_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BOSS_RESUTL_MESSAGE.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this.currBossId=t.getByte(),this.onSwitchMap(this.unionbossModel.mapid)},Object.defineProperty(t.prototype,"unionbossModel",{get:function(){return JsonModelManager.instance.getModelguildBoss()[this.currBossId]},enumerable:!0,configurable:!0}),t.prototype.onStartFight=function(){this.mainscene.heroBody.isDamageFalse=!1;var t,n=0;n=this.unionbossModel.bossId,t=this.unionbossModel.rewards[0],this.fight_info_bar.currentState="gerenboss";var a=this.fight_info_bar.geren_reward_grp;a.removeChildren();for(var i=this.unionbossModel.rewards,o=0;o<i.length;o++){var r=GameCommon.getInstance().createGoodsIntance(i[o]);a.addChild(r)}e.prototype.onStartFight.call(this),this.onUpdateDupWave(),this.rushData&&this.mainscene.getBodyManager().onRushMonster(this.rushData)},t.prototype.onInitFightInfoBar=function(){this.fight_info_bar||(this.fight_info_bar=new eui.Component,this.fight_info_bar.skinName=skins.DupInfoBarSkin,this.fight_info_bar.x=Globar_Pos.x,this.fight_info_bar.y=size.height-this.fight_info_bar.height),this.mainscene.getModuleLayer().addToMainview(this.fight_info_bar),e.prototype.onInitFightInfoBar.call(this)},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.UNION_BOSS_RESUTL_MESSAGE);n.setByte(this.currBossId),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();n==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler(t):n==FightDefine.FIGHT_RESULT_FAIL&&this.onResultLoseHandler()},t.prototype.onResultWinHandler=function(e){var t=new DupWinParam;t.dropList=this.unionbossModel.rewards;e.getByte();t.resultParam="",t.specialDesc="",Tool.callbackTime(function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",t))},this,1e3)},t.prototype.onResultLoseHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel")},t.prototype.onEnterSuccessScene=function(){this.currPointIndex=0;var t;t=this.mainscene.mapInfo.getXYByGridIndex(this.mainscene.mapInfo.bronNodeId),this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.currPointIndex++,this.isLast?this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS):this.onStartFight()},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onTouchLeaveBtn=function(){var e=[{text:"是否确认退出副本？"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onQuitScene,this)))},t.prototype.onQuitScene=function(){this.onFightLose(),this.mainscene.onReturnYewaiScene()},t.prototype.onUpdateDupWave=function(){if(this.unionbossModel&&this.unionbossModel.point.length>this.currPointIndex){var e=this.unionbossModel.point.split(",");if(this.isLast=e.length-1==this.currPointIndex,this._rushData.isBoss=this.isLast&&this.unionbossModel.bossId>0,this._rushData.monsterId=this._rushData.isBoss?this.unionbossModel.bossId:this.unionbossModel.monsterId,this._rushData.refreshGrid=Number(e[this.currPointIndex]),0==this._rushData.refreshGrid)return void(this._rushData=null);this._rushData.refreshNum=this._rushData.isBoss?1:this.unionbossModel.num}else this._rushData=null},t}(BaseFightScene);__reflect(UnionBossFight.prototype,"UnionBossFight");var WuTanFight=function(e){function t(t){var n=e.call(this,t)||this;return n.MapId=10019,n.Self_rebronNode=225,n.Enemy_rebronNode=243,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this)},t.prototype.onParseFightMsg=function(t){this.fightResult=t.getByte(),this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t),e.prototype.onParseFightMsg.call(this,t),this.onSwitchMap(this.MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onBodyHurtHanlder=function(e,t,n){},t.prototype.onFinishFight=function(t){this._status!=FIGHT_STATUS.Result&&(e.prototype.onFinishFight.call(this,t),this.fightResult==FightDefine.FIGHT_RESULT_SUCCESS?this.onResultWinHandler():this.onResultLoseHandler())},t.prototype.onResultWinHandler=function(){GameCommon.getInstance().addAlert("挑战成功"),DataManager.getInstance().wuTanManager.setWuTanUp(),Tool.callbackTime(function(){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_WUTAN)},this,2e3)},t.prototype.onResultLoseHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupLosePanel",null))},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){this.enemyDatas=null,e.prototype.onDestroyScene.call(this)},t}(BaseFightScene);__reflect(WuTanFight.prototype,"WuTanFight");var YewaiBossFight=function(e){function t(t){var n=e.call(this,t)||this;return n.YEWAIBOSS_MAP_ID=10018,n.HERO_SHOW_NODE=1207,n.BOSS_SHOW_NODE=840,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_FIGHT_START_MSG.toString(),this.onReceiveFightMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_FIGHT_RESULT_MSG.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_FIGHT_RESULT_MSG.toString(),this.onResFightResult,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_FIGHT_START_MSG.toString(),this.onReceiveFightMsg,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t),this.onUpdateYewaiWave(),this.onSwitchMap(this.YEWAIBOSS_MAP_ID)},t.prototype.onFinishFight=function(e){this._status=FIGHT_STATUS.Result;var t=new Message(MESSAGE_ID.GAME_FIGHT_RESULT_MSG);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.onResFightResult=function(e){if(this._status==FIGHT_STATUS.Result){var t=e.message,n=t.getByte();if(n==FightDefine.FIGHT_RESULT_SUCCESS){GameFight.getInstance().yewaiMapId=t.getShort(),GameFight.getInstance().yewai_waveIndex=t.getShort(),GameFight.getInstance().yewai_batch=t.getByte();var a=GameFight.getInstance().onParseDropItems(t);this.mainscene.getBodyManager().onPlayDropEffect(a),Tool.callbackTime(this.onResultWinHandler,this,1e3,a)}else n==FightDefine.FIGHT_RESULT_FAIL&&this.onResultLoseHandler()}},t.prototype.onResultWinHandler=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("YewaiFieldWinPanel",e))},t.prototype.onResultLoseHandler=function(){this.mainscene.onReturnYewaiScene()},t.prototype.onEnterSuccessScene=function(){var t=this.mainscene.mapInfo.getXYByGridIndex(this.HERO_SHOW_NODE);this.mainscene.setHeroMapPostion(t),e.prototype.onEnterSuccessScene.call(this)},t.prototype.onStartFight=function(){GameFight.getInstance().onSendCommonFightMsg(!0)},t.prototype.onReceiveFightMsg=function(e){var t=e.message,n=t.getBoolean();if(n){this.mainscene.getBodyManager().fightPause=!1,this._status=FIGHT_STATUS.Fighting,this.onUpdateYewaiWave();var a=BodyFactory.instance.createMonsterBody(this._rushData.monsterId,BODY_TYPE.BOSS),i=this.mainscene.mapInfo.getXYByGridIndex(this._rushData.refreshGrid);a.direction=Direction.DOWN,this.mainscene.getBodyManager().addEmenyBodyToAry(a,i)}else this.mainscene.onReturnYewaiScene()},t.prototype.onDeath=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_SET_AUTO_FIGHT),!1),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("RevivePanel",null)),this.onFightLose()},t.prototype.onFightWin=function(){GameFight.getInstance().onCheckStoyTalk()?GameFight.getInstance().isFightEndStory=!0:this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onCloseResultView=function(){this.mainscene.onReturnYewaiScene()},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this)},t.prototype.onQuitScene=function(){this.onFightLose()},t.prototype.onUpdateYewaiWave=function(){this._rushData.monsterId=FightDefine.PVE_BOSS_COMID+GameFight.getInstance().yewai_waveIndex%FightDefine.PVE_BOSS_TOTALMODEL+1,this._rushData.refreshGrid=this.BOSS_SHOW_NODE,this._rushData.refreshNum=FightDefine.PVE_BOSS_NUM},t}(BaseFightScene);__reflect(YewaiBossFight.prototype,"YewaiBossFight");var YewaiPVEFight=function(e){function t(t){var n=e.call(this,t)||this;return n.Rush_Monster_Ary=[[3,200],[3,250],[3,300]],n._resultTime=0,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_FIGHT_START_MSG.toString(),this.onReceiveFightMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_FIGHT_RESULT_MSG.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_JACKAROO_COMPLETE,this.onStartFight,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_FIGHT_START_MSG.toString(),this.onReceiveFightMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_FIGHT_RESULT_MSG.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_JACKAROO_COMPLETE,this.onStartFight,this)},t.prototype.onReceiveFightMsg=function(e){var t=e.message,n=t.getBoolean();if(n){this._status=FIGHT_STATUS.Fighting;var a=1==t.getByte();if(a)return;this.onUpdateYewaiWave();var i=this.mainscene.heroBody.data.skillStampTime-egret.getTimer();Tool.callbackTime(this.onRushMonster,this,i>0?i+200:0)}else Tool.log("receive message2001: PVE-Fight is Fail!"),this.mainscene.gameworld.setAlertDisconnect(Language.ALERT_DISCONNECT_3)},t.prototype.onRequsetYewaiFight=function(){GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&this.fightStatus!=FIGHT_STATUS.Fighting&&this.fightStatus!=FIGHT_STATUS.Requset&&(this._status=FIGHT_STATUS.Requset,GameFight.getInstance().onSendCommonFightMsg(!1))},t.prototype.onErrorHanlder=function(){this._status=FIGHT_STATUS.Result,Tool.callbackTime(this.onRequsetYewaiFight,this,1e3,!1)},t.prototype.onRushMonster=function(){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG){var e,t,n=FightDefine.getXgDeathCount(),a=this.mainscene.mapInfo.getXYByGridIndex(this._rushData.refreshGrid);this.mainscene.heroBody.onJump(a,!0);for(var i=0;i<this.Rush_Monster_Ary.length;i++)for(var o=this.Rush_Monster_Ary[i][0],r=this.Rush_Monster_Ary[i][1],s=0;o>s;s++){e=BodyFactory.instance.createMonsterBody(this._rushData.monsterId,BODY_TYPE.MONSTER),e.direction=Direction.DOWN,n>0&&e.setDeathCount(n,n),t=Tool.randomPosByDistance(a.x,a.y,r),this.mainscene.getBodyManager().addEmenyBodyToAry(e,t);var h=t.x,l=t.y,g=-Math.atan2(a.y-l,a.x-h)*(180/Math.PI);g=0>g?360+g:g,t=Tool.getPosByRadiiAndAngle(h,l,g,Tool.randomInt(100,150)),e.setWalkOn([t]),e.isDamageFalse=!0,e.ignoreDist=!0,e.onAddEnemyBodyList(this.mainscene.heroBodys)}}},t.prototype.onFinishFight=function(e){if(e==FightDefine.FIGHT_RESULT_SUCCESS){if(this._resultTime>egret.getTimer())return void this.onErrorHanlder();if(this._status==FIGHT_STATUS.Requset||this._status==FIGHT_STATUS.Leave)return;if(this.mainscene.heroBody.data.targets.length>0)return}this._status=FIGHT_STATUS.Result;var t=new Message(MESSAGE_ID.GAME_FIGHT_RESULT_MSG);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t),this._resultTime=egret.getTimer()+3e3},t.prototype.onResFightResult=function(e){var t=e.message,n=t.getByte();if(n==FightDefine.FIGHT_RESULT_SUCCESS){this.currPointIndex++;var a=this.stageModels.length,i=(this.currPointIndex+1)%(2*a-1);0==i?i=1:i>a&&(i=2*a-i),i-=1,0==i&&(this.currPointIndex=0),this.curstageModel=this.stageModels[i],this.oldMapId=GameFight.getInstance().yewaiMapId;GameFight.getInstance().yewai_waveIndex;GameFight.getInstance().yewaiMapId=t.getShort(),GameFight.getInstance().yewai_waveIndex=t.getShort(),GameFight.getInstance().yewai_batch=t.getByte();var o=GameFight.getInstance().onParseDropItems(t);this.mainscene.getBodyManager().onPlayDropEffect(o);var r=!1;this.rushData.progress<=GameFight.getInstance().yewai_batch&&!GameFight.getInstance().isteamdupReady&&(r=GameSetting.getLocalSetting(GameSetting.YEWAI_AUTO_FIGHT)),this.fightStatus==FIGHT_STATUS.Result&&(r?this.mainscene.onEnterYewaiBoss():this.onRequsetYewaiFight())}else if(n==FightDefine.FIGHT_RESULT_FAIL){if(this.mainscene.onCheckPlayerFail()){var s=this.mainscene.mapInfo.getXYByGridIndex(this.curstageModel.monterFightNodes[0]);this.mainscene.setHeroMapPostion(s)}this.onRequsetYewaiFight()}},t.prototype.onShowWinPanel=function(e){GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&this.mainscene.getModuleLayer().onShowPassProceedsView()},t.prototype.onReceiveNearOhterMsg=function(){},t.prototype.onBodyHurtHanlder=function(e,t,n){var a=GameFight.getInstance().onCheckBodyIsHero(e.data);if(a);else if(e.data.bodyType!=BODY_TYPE.MONSTER&&e.data.bodyType!=BODY_TYPE.BOSS)for(var i=0;i<this.mainscene.getBodyManager().otherPlayerBodys.length;i++){for(var o=this.mainscene.getBodyManager().otherPlayerBodys[i],r=o.data.targets.length-1;r>=0;r--){var s=o.data.targets[r];s.hp=s.data.currentHp-1,s.data.isDie&&(o.onRemoveTarget(s),BodyFactory.instance.onRecovery(s))}0==o.data.targets.length&&this.onRushOhterEmeny(o)}},t.prototype.onCreatePVPOtherPlayer=function(){if(this.mainscene.getBodyManager().onDestroyOtherBodys(),this.curstageModel)try{for(var e=void 0,t=this.mainscene.mapInfo,n=DataManager.getInstance().yewaipvpManager,a=1,i=0;a>i;i++){var o=n.pvpfightterInfos[i],r=void 0,s=t.getNodeModelByIndex(this.curstageModel.monterFightNodes[this.curstageModel.monterFightNodes.length-1]);if(!s)break;var h=t.getGridNearByNode(s,2,2);if(!h)break;if(o&&o.appears){var l=Math.floor(Math.random()*o.appears.length);r=new RobotData(l+1,BODY_TYPE.PLAYER),r.playerId=o.playerId,r.name=o.playerName,r.onUpdateOnlyAppear(o.appears[l]),e=this.mainscene.getBodyManager().onCreateOtherPlayer(r,h)}else e=this.mainscene.getBodyManager().onCreateFakerPlayerToSnece(.7,.8,h),e.data.playerId=-1;e.isDamageFalse=!0,e.onHideHeadBar(!1),this.onRushOhterEmeny(e)}}catch(g){SDKManager.getChannel()==EChannel.CHANNEL_LOCAL&&Tool.throwException("更新野外其他玩家出错！")}},t.prototype.onRushOhterEmeny=function(e){var t=this.mainscene.mapInfo.getNodeModelByXY(e.x,e.y),n=this.monsterID;this.mainscene.getBodyManager().onCreateOhterEnemyList(e,n,1,t)},t.prototype.onEnterSuccessScene=function(){e.prototype.onEnterSuccessScene.call(this),this.startWave=1;var t=JsonModelManager.instance.getModelmap();for(var n in t){var a=t[n];if(a.nextid==this.mainscene.mapInfo.mapId){this.startWave=this.startWave+a.boshu;break}}if(this.stageModels)for(var i=this.stageModels.length-1;i>=0;i--)this.stageModels[i]=null,this.stageModels.splice(i,1);else this.stageModels=[];ModelManager.getInstance().parseXmlToModel(this.stageModels,ModelYewaiWave,this.mainscene.mapInfo.fightId+"_fight_xml"),this.currPointIndex=0,this.curstageModel=this.stageModels[this.currPointIndex];var o;GameFight.getInstance().isJackaroo?(o=this.mainscene.mapInfo.getXYByGridIndex(509),this.mainscene.setHeroMapPostion(o),this.mainscene.heroBody.onshoworhideShodow(!1)):(o=this.mainscene.mapInfo.getXYByGridIndex(this.curstageModel.monterFightNodes[0]),this.mainscene.setHeroMapPostion(o),this.onRequestPVPFightterInfoMsg())},t.prototype.onStartFight=function(){GameFight.getInstance().isJackaroo?(GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_YEWAI_FIGHT_UPDATE)),GameFight.getInstance().onJackarooHandler()):this.onRequsetYewaiFight(),this.mainscene.getBodyManager().fightPause=!1},t.prototype.onCraeteLoadRes=function(t){e.prototype.onCraeteLoadRes.call(this,t)},t.prototype.onRequestPVPFightterInfoMsg=function(){},t.prototype.onDeath=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_SET_AUTO_FIGHT),!1),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("RevivePanel",null))},t.prototype.onFightWin=function(){GameFight.getInstance().onCheckStoyTalk()?GameFight.getInstance().isFightEndStory=!0:this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.mainscene.getBodyManager().onDestroyAllHeroTarget(),this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),this._status==FIGHT_STATUS.Fighting&&this.onFinishFight(FightDefine.FIGHT_RESULT_TIE)},t.prototype.onQuitScene=function(){},t.prototype.onUpdateYewaiWave=function(){this._rushData.progress=this.mapInfo.yewaiprogress,this._curMonsterID=this.monsterID,this._rushData.monsterId=this._curMonsterID,this._rushData.refreshGrid=this.curstageModel.monterFightNodes[0];for(var e=0;e<FightDefine.PVE_MONSTER_NUM.length;e++){var t=FightDefine.PVE_MONSTER_NUM[e][0];if(t>=GameFight.getInstance().yewaiMapId){this._rushData.refreshNum=FightDefine.PVE_MONSTER_NUM[e][1];break}}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_YEWAI_FIGHT_UPDATE))},Object.defineProperty(t.prototype,"monsterID",{get:function(){return FightDefine.PVE_MONSTER_COMID+Math.floor((GameFight.getInstance().yewai_waveIndex-1)/5)%FightDefine.TOTAL_MONSTER_MODELNUM},enumerable:!0,configurable:!0}),t}(BaseFightScene);__reflect(YewaiPVEFight.prototype,"YewaiPVEFight");var YewaiPVPFight=function(e){function t(t){var n=e.call(this,t)||this;return n.MapId=10019,n.Self_rebronNode=62,n.Enemy_rebronNode=17,n}return __extends(t,e),t.prototype.registFightMessage=function(){e.prototype.registFightMessage.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YEWAIPVP_FIHGT_RESULT_MSG.toString(),this.onResFightResult,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.removeFightMessage=function(){e.prototype.removeFightMessage.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.YEWAIPVP_FIHGT_RESULT_MSG.toString(),this.onResFightResult,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CLOSE_RESULT_VIEW,this.onCloseResultView,this)},t.prototype.onParseFightMsg=function(t){e.prototype.onParseFightMsg.call(this,t);var n=t.getBoolean();n?this.enemyDatas=GameFight.getInstance().onParsePVPEnemyMsg(t):this.mainscene.onReturnYewaiScene(),this.onSwitchMap(this.MapId)},t.prototype.onStartFight=function(){e.prototype.onStartFight.call(this),this.enemyDatas&&this.mainscene.getBodyManager().onInitAreraScene(this.enemyDatas,this.Self_rebronNode,this.Enemy_rebronNode)},t.prototype.onBodyHurtHanlder=function(e,t,n){},t.prototype.onFinishFight=function(t){e.prototype.onFinishFight.call(this,t);var n=new Message(MESSAGE_ID.YEWAIPVP_FIHGT_RESULT_MSG);n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onResFightResult=function(e){var t,n=e.message,a=n.getByte(),i=n.getInt(),o=n.getByte();t=a==FightDefine.FIGHT_RESULT_SUCCESS?GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.FIELD_PVP_REWARD_SUCC)):GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.FIELD_PVP_REWARD_FAIL)),t.push(new AwardItem(GOODS_TYPE.EXP,0,i)),t.push(new AwardItem(GOODS_TYPE.SHOW,0,o));for(var r=n.getByte(),s=0;r>s;s++){var h=n.getShort(),l=n.getByte(),g=new AwardItem(GOODS_TYPE.MASTER_EQUIP,h,1,l);t.push(g)}a>0?this.onResultWinHandler(t):this.onResultLoseHandler(t)},t.prototype.onResultWinHandler=function(e){this.mainscene.getBodyManager().onPlayDropEffect(e),Tool.callbackTime(function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("YewaiFieldWinPanel",e))},this,2e3)},t.prototype.onResultLoseHandler=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("YewaiPVPLosePanel",e))},t.prototype.onCloseResultView=function(e){this.mainscene.onReturnYewaiScene(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_YEWAIPVP)},t.prototype.onDeath=function(){this.onFightLose()},t.prototype.onFightWin=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_SUCCESS)},t.prototype.onFightLose=function(){this.onFinishFight(FightDefine.FIGHT_RESULT_FAIL)},t.prototype.onQuitScene=function(){},t.prototype.onDestroyScene=function(){e.prototype.onDestroyScene.call(this),this.mainscene.getBodyManager().onDestroyAllHeroTarget()},t}(BaseFightScene);__reflect(YewaiPVPFight.prototype,"YewaiPVPFight");var GameDispatcher=function(e){function t(){var t=e.call(this)||this;return t.eventDispatcher=new egret.EventDispatcher(null),t}return __extends(t,e),t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.dispatchEvent=function(e,t){return void 0===t&&(t=null),e.data=t,this.eventDispatcher.dispatchEvent(e)},t.prototype.hasEventListener=function(e){return this.eventDispatcher.hasEventListener(e)},t.prototype.willTrigger=function(e){return this.eventDispatcher.willTrigger(e)},t.prototype.removeEventListener=function(e,t,n,a){void 0===a&&(a=!1),this.eventDispatcher.removeEventListener(e,t,n,a)},t.prototype.addEventListener=function(e,t,n,a,i){void 0===a&&(a=!1),void 0===i&&(i=0),this.eventDispatcher.addEventListener(e,t,n,a,i)},t}(egret.DisplayObjectContainer);__reflect(GameDispatcher.prototype,"GameDispatcher");var GameSetting=function(){function e(){}return e.setLocalSave=function(t,n){var a="";switch(typeof n){case"boolean":a=n?"$TRUE":"$FALSE";break;case"number":a=n.tostring();break;case"string":a=n}a&&window.localStorage.setItem(e.getLoaclKey(t),a)},e.getLocalSetting=function(t){if(!t)return"";var n=window.localStorage.getItem(e.getLoaclKey(t));return n?"$TRUE"==n?!0:"$FALSE"==n?!1:Tool.isNumber(parseInt(n))&&"0"!=n[0]?parseInt(n):n:""},e.getLoaclKey=function(e){return DataManager.getInstance().playerManager.player.id+":"+e},e.LOGIN_ACCOUNTS="GAME_LOGIN_ACCOUNT",e.YEWAI_AUTO_FIGHT="GAME_YEWAI_AUTOFIGHT_SET",e.SOUND_MUTE="GAME_SOUND_MUTE",e.WX_OPENID="WX_OPENID",e.WX_SESSION_KEY="WX_SESSION_KEY",e.WX_SHARE_RANDOMSTR="WX_SHARE_RANDOMSTR",e}();__reflect(GameSetting.prototype,"GameSetting");var GameWorld=function(e){function t(){var t=e.call(this)||this;return t.state=GAME_STATE.GAME_STATE_LOGIN,t.LoginSuccsess=!1,t.isloginin=!1,t.loadingFakerPro=0,t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.onRegistEvent(),t.init(),t}return __extends(t,e),t.prototype.onRegistEvent=function(){this.addEventListener(GameEvent.NET_EVENT_ERROR,this.netErrorHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SDK_LOGIN_OK,this.onSDKLoginSuccess,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SDK_LOGIN_FAIL,this.onSDKLoginFail,this),this.startLoadingConfig()},t.prototype.init=function(){SDKManager.init(),this.httpManager=new HttpManager(this);var e=SDKManager.loginInfo.url;this.httpManager.setUrl(e+"/"),SDKManager.loginInfo.url=ChannelDefine.getUrl(SDKManager.loginInfo.channel),this.messageReceive=new MessageReceive(this),this.requestManager=new RequestManager(this),this.requestManager.start(),this.gamescene=new MainScene(this),GameCommon.getInstance().setGameWorld(this),this.sceneLayer=new egret.DisplayObjectContainer,this.promptLayer=new egret.DisplayObjectContainer,this.addChild(this.sceneLayer),this.addChild(this.promptLayer),this.promptLayer.addChild(PromptPanel.getInstance()),this.onResize()
},t.prototype.onResize=function(){if(this.promptLayer.x=Globar_Pos.x,DataManager.IS_PC_Game)try{this.gamescene.getModuleLayer().onStageResize(),this.gamescene.getMapLayer().onResizeLayer()}catch(e){}},t.prototype.onAddToStage=function(e){this.state==GAME_STATE.GAME_STATE_LOGIN?this.startGame():this.enterGame()},t.prototype.startGame=function(){this.state=GAME_STATE.GAME_STATE_LOGIN,this.createGameScene()},t.prototype.loginServer=function(){this.state=GAME_STATE.GAME_STATE_SERVER,this.createGameScene()},t.prototype.createRole=function(){this.state=GAME_STATE.GAME_STATE_CREATE,this.createGameScene()},t.prototype.enterGame=function(){this.LoginSuccsess?this.sendEnterGameMsg():(this.state=GAME_STATE.GAME_STATE_PLAY,this.createGameScene())},t.prototype.reciveEnterGameMsg=function(){this.isloginin=!1,this.LoginSuccsess?(this.gamescene.onReloadMainScene(),this.gamescene.parent||(this.sceneLayer.removeChildren(),this.sceneLayer.addChild(this.gamescene))):this.onGameloadGroupLoading()},t.prototype.loginRecord=function(e){if(SDKManager.loginInfo.channel==EChannel.CHANNEL_WXGAMEBOX){var t=SDKManager.loginInfo,n={account:t.account,channelId:t.channel,subChannel:t.subChannel,platform:t.platform,createTime:e.createTime,playerId:e.id,serverId:t.serverId};SDKManager.loginInfo.url;var a=SDKManager.loginInfo.url+"/LOGIN";HttpUtil.sendPostStringRequest(a,null,this,JSON.stringify(n))}},t.prototype.sendEnterGameMsg=function(){var e=SDKManager.loginInfo,t=new Message(MESSAGE_ID.ENTER_GAME_MESSAGE);t.setShort(e.channel),t.setShort(e.subChannel),t.setString(e.account),t.setShort(e.serverId),t.setByte(e.platform),t.setString(e.adFrom?e.adFrom.adFrom:""),t.setString(e.adFrom?e.adFrom.spid:""),this.requestManager.addMessage(t)},t.prototype.onStartLoadFakerAction=function(){this.loadingFakerPro=0,GameLoadingUIByGroup.getInstance().bar.value=0,this.addEventListener(egret.Event.ENTER_FRAME,this.onLoadingEnterFrame,this)},t.prototype.onLoadingEnterFrame=function(e){this.loadingFakerPro<95?this.loadingFakerPro+=10:this.loadingFakerPro+=0,GameLoadingUIByGroup.getInstance().bar.value=this.loadingFakerPro},t.prototype.onCloseLoadFakerAction=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onLoadingEnterFrame,this)},t.prototype.createGameScene=function(){switch(this.sceneLayer.removeChildren(),this.state){case GAME_STATE.GAME_STATE_LOGIN:var e=new GameLogin(this);DataManager.IS_PC_Game&&(e.x=Globar_Pos.x),this.sceneLayer.addChild(e);break;case GAME_STATE.GAME_STATE_SERVER:var t=new SelectServer(this);DataManager.IS_PC_Game&&(t.x=Globar_Pos.x),this.sceneLayer.addChild(t),SDKManager.onCompleteSDK();break;case GAME_STATE.GAME_STATE_CREATE:var n=new CreateRole(this);DataManager.IS_PC_Game&&(n.x=Globar_Pos.x),this.sceneLayer.addChild(n);break;case GAME_STATE.GAME_STATE_PLAY:this.promptLayer.visible=!1,GameLoadingUIByGroup.getInstance().onShow(this.sceneLayer),GameLoadingUIByGroup.getInstance().playRoleEnter(),this.onReadConfigZip(),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_JSON_PARSE_OK,this.readConfigZipComplete,this),this.onStartLoadFakerAction()}},t.prototype.onGameloadGroupLoading=function(){var e=[],t=this.getInitLoadURLList();GameLoadingUIByGroup.getInstance().onInputLoadText("正在努力载入游戏资源，快给程序哥哥加个鸡腿！"),GameLoadingUIByGroup.getInstance().onstartLoad("gameload",this.onGameloadGroupLoaded,this,e,t,0,100)},t.prototype.onGameloadGroupLoaded=function(){GameLoadingUIByGroup.getInstance().onInputLoadText("资源载入成功！载入游戏场景中，为您开启全新仙侠世界！"),GameDispatcher.getInstance().addEventListener(GameEvent.SCENE_ENTER_SUCCESS,this.onEnterMainScene,this),this.gamescene.onStarGame()},t.prototype.onEnterMainScene=function(){GameDispatcher.getInstance().removeEventListener(GameEvent.SCENE_ENTER_SUCCESS,this.onEnterMainScene,this),this.sceneLayer.addChild(this.gamescene),GameLoadingUIByGroup.getInstance().close(),this.LoginSuccsess=!0,this.promptLayer.visible=!0,GameLoadingUIByGroup.getInstance().destoryPlayerEnter(),LoadManager.getInstance().removeloadAllUIImage(),this.gamescene.onInitRequestMsg()},t.prototype.sendMessage=function(e){this.isloginin||this.requestManager.addMessage(e)},t.prototype.receiveMessage=function(e){this.messageReceive.receiveMessage(e)},t.prototype.dispatchGameEvent=function(t){e.prototype.dispatchEvent.call(this,t)},t.prototype.setUrl=function(e,t){var n="";platform.isLocalTest()?(n=e+":"+t,n=Tool.isIPUrl(e)?"http://"+n:"https://"+n):n="https://jpsx-login.szfyhd.com/port/"+e+":"+t,this.httpManager.setUrl(n)},t.prototype.getInitLoadURLList=function(){var e=(SDKManager.loginInfo,[]);return e},t.prototype.setAlertDisconnect=function(e){this.warnAlterView||(this.warnAlterView=new AlertDisconnect),this.warnAlterView.parent||(DataManager.IS_PC_Game&&(this.warnAlterView.x=Globar_Pos.x),this.warnAlterView.onShowAlert(e),this.addChild(this.warnAlterView)),this.gamescene.stopFightRun()},t.prototype.reloadingOpen=function(){this._reloadView||(this._reloadView=new AlertReLogin(this)),this._reloadView.onShow(this)},t.prototype.reloadingClose=function(){this._reloadView&&this._reloadView.onClose()},t.prototype.netErrorHandler=function(e){var t=e.data,n=MessageErrorManager.getInstance().errorMsgHandler(t.getCmdId());n==MESSAGE_ERROR.CLOSE?this.setAlertDisconnect(Language.ALERT_DISCONNECT_1):n==MESSAGE_ERROR.AGAIN&&(MessageErrorManager.getInstance().requsetFailTimes>=GameDefine.MASSAGE_FAIL_MAX?this.setAlertDisconnect(Language.ALERT_DISCONNECT_3):(MessageErrorManager.getInstance().requsetFailTimes++,this.sendMessage(t))),t=null},t.prototype.sendLogin=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a;return __generator(this,function(i){switch(i.label){case 0:return this.isloginin=!0,[4,platform.getOption()];case 1:return e=i.sent(),t=e&&e.query?e.query:null,n=SDKManager.loginInfo,a=new Message(MESSAGE_ID.GAME_LOGON_MESSAGE,!1),a.setShort(n.channel),a.setShort(n.subChannel),a.setString(n.account),a.setByte(n.platform),a.setString(n.adFrom?n.adFrom.adFrom:""),platform.isLocalTest()?a.setString("0"):a.setString(DataManager.isRelease?"0":"1"),t&&t.inviteSrever&&Tool.isNumber(parseInt(t.inviteSrever))?a.setShort(parseInt(t.inviteSrever)):a.setShort(0),this.requestManager.addMessage(a),[2]}})})},t.prototype.sendSelectServer=function(e){var t=SDKManager.loginInfo;t.serverId=e;var n=new Message(MESSAGE_ID.SELECT_SERVER_MESSAGE,!1);n.setShort(t.channel),n.setShort(t.subChannel),n.setString(t.account),n.setShort(t.serverId),n.setByte(t.platform),platform.isLocalTest()?n.setString("0"):n.setString(DataManager.isRelease?"0":"1"),this.requestManager.addMessage(n)},t.prototype.sendLoginServerMsg=function(){var e=SDKManager.loginInfo,t=new Message(MESSAGE_ID.LOGIN_SERVER_MESSAGE);t.setShort(e.channel),t.setShort(e.subChannel),t.setString(e.account),t.setShort(e.serverId),t.setByte(e.platform),this.requestManager.addMessage(t),Tool.log("登录游戏成功")},t.prototype.sendCreateRoleMsg=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,a,i,o;return __generator(this,function(r){switch(r.label){case 0:return[4,platform.getOption()];case 1:return n=r.sent(),a=n&&n.query?n.query:null,i=SDKManager.loginInfo,o=new Message(MESSAGE_ID.CREATE_ROLE_MESSAGE),o.setShort(i.channel),o.setShort(i.subChannel),o.setString(i.account),o.setShort(i.serverId),o.setByte(i.platform),o.setString(e),o.setByte(0),o.setByte(t),o.setString(i.adFrom?i.adFrom.adFrom:""),o.setString(i.adFrom?i.adFrom.spid:""),o.setInt(a&&a.invitePlayerID?a.invitePlayerID:0),this.requestManager.addMessage(o),[2]}})})},t.prototype.onSDKLoginSuccess=function(){this.isloginin||(this.sendLogin(),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SDK_LOGIN_OK,this.onSDKLoginSuccess,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SDK_LOGIN_FAIL,this.onSDKLoginFail,this))},t.prototype.onSDKLoginFail=function(e){this.isloginin||(GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SDK_LOGIN_OK,this.onSDKLoginSuccess,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SDK_LOGIN_FAIL,this.onSDKLoginFail,this),this.setAlertDisconnect(e.data))},t.prototype.startLoadingConfig=function(){this._configIsLoaded||Tool.getResAsync("config_bin",function(){this._configIsLoaded=!0,this.state==GAME_STATE.GAME_STATE_PLAY&&this.onReadConfigZip()},this)},t.prototype.onReadConfigZip=function(){if(this._configIsLoaded&&!ModelManager.getInstance().configJson){ModelManager.getInstance().configJson={},window.jsonfileCount=0;var e=new JSZip;try{e.loadAsync(RES.getRes("config_bin"),{checkCRC32:!0}).then(function(e){for(var t in e.files)window.jsonfileCount++;var n=function(t){e.files[t].async("string").then(function(e){ModelManager.getInstance().configJson[t]=JSON.parse(e),window.jsonfileCount--,0==window.jsonfileCount&&GameDispatcher.getInstance().dispatchEventWith(GameEvent.GAME_JSON_PARSE_OK)})};for(var t in e.files)n(t)},this)}catch(t){alert("zip read fail!!!!! ")}e=null,RES.destroyRes("config_bin")}},t.prototype.readConfigZipComplete=function(){GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_JSON_PARSE_OK,this.readConfigZipComplete,this),this.sendEnterGameMsg()},t.prototype.getGameScene=function(){return this.gamescene},t}(egret.DisplayObjectContainer);__reflect(GameWorld.prototype,"GameWorld");var GAME_STATE;!function(e){e[e.GAME_STATE_LOGIN=0]="GAME_STATE_LOGIN",e[e.GAME_STATE_SERVER=1]="GAME_STATE_SERVER",e[e.GAME_STATE_CREATE=2]="GAME_STATE_CREATE",e[e.GAME_STATE_PLAY=3]="GAME_STATE_PLAY"}(GAME_STATE||(GAME_STATE={}));var JsonModelManager=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.getMap=function(e){return ModelManager.getInstance().onCreateModelHashMap(e)},e.prototype.getModelarenaRankReward=function(){return this.getMap("arenaRankReward")},e.prototype.getModelarenaReward=function(){return this.getMap("arenaReward")},e.prototype.getModelbaoshi=function(){return this.getMap("baoshi")},e.prototype.getModelboss=function(){return this.getMap("boss")},e.prototype.getModelbossConfig=function(){return this.getMap("bossConfig")},e.prototype.getModelbossrewards=function(){return this.getMap("bossrewards")},e.prototype.getModelbox=function(){return this.getMap("box")},e.prototype.getModelbuff=function(){return this.getMap("buff")},e.prototype.getModelcailiaofuben=function(){return this.getMap("cailiaofuben")},e.prototype.getModelcdkey=function(){return this.getMap("cdkey")},e.prototype.getModelchenghao=function(){return this.getMap("chenghao")},e.prototype.getModelchengjiu=function(){return this.getMap("chengjiu")},e.prototype.getModelchengjiuLv=function(){return this.getMap("chengjiuLv")},e.prototype.getModelchengjiuMubiao=function(){return this.getMap("chengjiuMubiao")},e.prototype.getModelchongwuDan=function(){return this.getMap("chongwuDan")},e.prototype.getModelchongwujinjie=function(){return this.getMap("chongwujinjie")},e.prototype.getModelchongwupeiyang=function(){return this.getMap("chongwupeiyang")},e.prototype.getModelchongwushengji=function(){return this.getMap("chongwushengji")},e.prototype.getModelchongzhishengyan=function(){return this.getMap("chongzhishengyan")},e.prototype.getModelchouqian=function(){return this.getMap("chouqian")},e.prototype.getModelconstant=function(){return this.getMap("constant")},e.prototype.getModelcopy=function(){return this.getMap("copy")},e.prototype.getModelcuilian=function(){return this.getMap("cuilian")},e.prototype.getModeldifu=function(){return this.getMap("difu")},e.prototype.getModeldifubuff=function(){return this.getMap("difubuff")},e.prototype.getModeldingshihuodong=function(){return this.getMap("dingshihuodong")},e.prototype.getModeldujie=function(){return this.getMap("dujie")},e.prototype.getModelequipment=function(){return this.getMap("equipment")},e.prototype.getModelfabaojinjie=function(){return this.getMap("fabaojinjie")},e.prototype.getModelfabaoshengji=function(){return this.getMap("fabaoshengji")},e.prototype.getModelfabaozhuanpan=function(){return this.getMap("fabaozhuanpan")},e.prototype.getModelfashion=function(){return this.getMap("fashion")},e.prototype.getModelfeastShopBox=function(){return this.getMap("feastShopBox")},e.prototype.getModelfengce=function(){return this.getMap("fengce")},e.prototype.getModelfenxiang=function(){return this.getMap("fenxiang")},e.prototype.getModelfirstPay=function(){return this.getMap("firstPay")},e.prototype.getModelfuling=function(){return this.getMap("fuling")},e.prototype.getModelfunctionLv=function(){return this.getMap("functionLv")},e.prototype.getModelgain=function(){return this.getMap("gain")},e.prototype.getModelgerenboss=function(){return this.getMap("gerenboss")},e.prototype.getModelgongfa=function(){return this.getMap("gongfa")},e.prototype.getModelguanqiakaiqi=function(){return this.getMap("guanqiakaiqi")},e.prototype.getModelguildBoss=function(){return this.getMap("guildBoss")},e.prototype.getModelguildfuben=function(){return this.getMap("guildfuben")},e.prototype.getModelguildLv=function(){return this.getMap("guildLv")},e.prototype.getModelguildreward=function(){return this.getMap("guildreward")},e.prototype.getModelguildShangxiang=function(){return this.getMap("guildShangxiang")},e.prototype.getModelguildSkill=function(){return this.getMap("guildSkill")},e.prototype.getModelguildspecialreward=function(){return this.getMap("guildspecialreward")},e.prototype.getModelguildTask=function(){return this.getMap("guildTask")},e.prototype.getModelhongzhuang=function(){return this.getMap("hongzhuang")},e.prototype.getModelhunjie=function(){return this.getMap("hunjie")},e.prototype.getModelitem=function(){return this.getMap("item")},e.prototype.getModeljianchi=function(){return this.getMap("jianchi")},e.prototype.getModeljiehuntaozhuang=function(){return this.getMap("jiehuntaozhuang")},e.prototype.getModeljingjie=function(){return this.getMap("jingjie")},e.prototype.getModeljingmai=function(){return this.getMap("jingmai")},e.prototype.getModelkuafuboss=function(){return this.getMap("kuafuboss")},e.prototype.getModelkuafubossrewards=function(){return this.getMap("kuafubossrewards")},e.prototype.getModelkuafujingjichang=function(){return this.getMap("kuafujingjichang")},e.prototype.getModelkuafureward=function(){return this.getMap("kuafureward")},e.prototype.getModellevelup=function(){return this.getMap("levelup")},e.prototype.getModellianhua=function(){return this.getMap("lianhua")},e.prototype.getModellingxing=function(){return this.getMap("lingxing")},e.prototype.getModellonghun=function(){return this.getMap("longhun")},e.prototype.getModellvyaoqing=function(){return this.getMap("lvyaoqing")},e.prototype.getModelmail=function(){return this.getMap("mail")},e.prototype.getModelmap=function(){return this.getMap("map")},e.prototype.getModelmingge=function(){return this.getMap("mingge")},e.prototype.getModelminggelv=function(){return this.getMap("minggelv")},e.prototype.getModelmountDan=function(){return this.getMap("mountDan")},e.prototype.getModelmountEqianghua=function(){return this.getMap("mountEqianghua")},e.prototype.getModelmountEquipment=function(){return this.getMap("mountEquipment")},e.prototype.getModelmountparam=function(){return this.getMap("mountparam")},e.prototype.getModelmountSkill=function(){return this.getMap("mountSkill")},e.prototype.getModelmounttaozhuang=function(){return this.getMap("mounttaozhuang")},e.prototype.getModelpay=function(){return this.getMap("pay")},e.prototype.getModelpeishiboss=function(){return this.getMap("peishiboss")},e.prototype.getModelPVPLV=function(){return this.getMap("PVPLV")},e.prototype.getModelqianghua=function(){return this.getMap("qianghua")},e.prototype.getModelqianghuadashi=function(){return this.getMap("qianghuadashi")},e.prototype.getModelqihun=function(){return this.getMap("qihun")},e.prototype.getModelquanminboss=function(){return this.getMap("quanminboss")},e.prototype.getModelronghun=function(){return this.getMap("ronghun")},e.prototype.getModelshanggutaozhuang=function(){return this.getMap("shanggutaozhuang")},e.prototype.getModelshareMaster=function(){return this.getMap("shareMaster")},e.prototype.getModelshenmishop=function(){return this.getMap("shenmishop")},e.prototype.getModelshenqi=function(){return this.getMap("shenqi")},e.prototype.getModelshop=function(){return this.getMap("shop")},e.prototype.getModelshow=function(){return this.getMap("show")},e.prototype.getModelsixiang=function(){return this.getMap("sixiang")},e.prototype.getModelsixiangfuben=function(){return this.getMap("sixiangfuben")},e.prototype.getModelsixiangjinjie=function(){return this.getMap("sixiangjinjie")},e.prototype.getModelskill=function(){return this.getMap("skill")},e.prototype.getModelskilldmg=function(){return this.getMap("skilldmg")},e.prototype.getModelskilltupo=function(){return this.getMap("skilltupo")},e.prototype.getModelstory=function(){return this.getMap("story")},e.prototype.getModeltaskDaily=function(){return this.getMap("taskDaily")},e.prototype.getModeltaskhuodong=function(){return this.getMap("taskhuodong")},e.prototype.getModeltehuilibao2=function(){return this.getMap("tehuilibao2")},e.prototype.getModelteshuxiaoguo=function(){return this.getMap("teshuxiaoguo")},e.prototype.getModeltext=function(){return this.getMap("text")},e.prototype.getModeltianshenzhuangbei=function(){return this.getMap("tianshenzhuangbei")},e.prototype.getModeltianshushengji=function(){return this.getMap("tianshushengji")},e.prototype.getModeltianshutupo=function(){return this.getMap("tianshutupo")},e.prototype.getModeltips=function(){return this.getMap("tips")},e.prototype.getModeltouxiang=function(){return this.getMap("touxiang")},e.prototype.getModeltouxiangkuang=function(){return this.getMap("touxiangkuang")},e.prototype.getModeltouxiangkuangshengji=function(){return this.getMap("touxiangkuangshengji")},e.prototype.getModeltouxiangshengji=function(){return this.getMap("touxiangshengji")},e.prototype.getModelttjjc=function(){return this.getMap("ttjjc")},e.prototype.getModelttre=function(){return this.getMap("ttre")},e.prototype.getModeltujian=function(){return this.getMap("tujian")},e.prototype.getModeltujian2=function(){return this.getMap("tujian2")},e.prototype.getModeltujiantaozhuang=function(){return this.getMap("tujiantaozhuang")},e.prototype.getModelvip=function(){return this.getMap("vip")},e.prototype.getModelvipboss=function(){return this.getMap("vipboss")},e.prototype.getModelvipshenqi=function(){return this.getMap("vipshenqi")},e.prototype.getModelvipShopXianShi=function(){return this.getMap("vipShopXianShi")},e.prototype.getModelwutan=function(){return this.getMap("wutan")},e.prototype.getModelwuxing=function(){return this.getMap("wuxing")},e.prototype.getModelxiandan=function(){return this.getMap("xiandan")},e.prototype.getModelxiangsishu=function(){return this.getMap("xiangsishu")},e.prototype.getModelxianshan=function(){return this.getMap("xianshan")},e.prototype.getModelxianshanzhaohuan=function(){return this.getMap("xianshanzhaohuan")},e.prototype.getModelxinfajinjie=function(){return this.getMap("xinfajinjie")},e.prototype.getModelxinfaLv=function(){return this.getMap("xinfaLv")},e.prototype.getModelxinshou=function(){return this.getMap("xinshou")},e.prototype.getModelxinshourenwu=function(){return this.getMap("xinshourenwu")},e.prototype.getModelxuezhanboss=function(){return this.getMap("xuezhanboss")},e.prototype.getModelxunbao=function(){return this.getMap("xunbao")},e.prototype.getModelxunbaobang=function(){return this.getMap("xunbaobang")},e.prototype.getModelxunbaobang2=function(){return this.getMap("xunbaobang2")},e.prototype.getModelxuyuanchi=function(){return this.getMap("xuyuanchi")},e.prototype.getModelxuyuanchi2=function(){return this.getMap("xuyuanchi2")},e.prototype.getModelyuanjie=function(){return this.getMap("yuanjie")},e.prototype.getModelyuanjielv=function(){return this.getMap("yuanjielv")},e.prototype.getModelyuanshen=function(){return this.getMap("yuanshen")},e.prototype.getModelyueka=function(){return this.getMap("yueka")},e.prototype.getModelzaoyubang=function(){return this.getMap("zaoyubang")},e.prototype.getModelzhanwen=function(){return this.getMap("zhanwen")},e.prototype.getModelzhaohuanboss=function(){return this.getMap("zhaohuanboss")},e.prototype.getModelzhaohuanrewards=function(){return this.getMap("zhaohuanrewards")},e.prototype.getModelzhenghun=function(){return this.getMap("zhenghun")},e.prototype.getModelzhuanpanvip=function(){return this.getMap("zhuanpanvip")},e.prototype.getModelzhuansheng=function(){return this.getMap("zhuansheng")},e.prototype.getModelzhuanshengrewards=function(){return this.getMap("zhuanshengrewards")},e.prototype.getModelzhufuzhifuben=function(){return this.getMap("zhufuzhifuben")},e.prototype.getModelzhuxiantai=function(){return this.getMap("zhuxiantai")},e.prototype.getModelzuduifuben=function(){return this.getMap("zuduifuben")},e.prototype.getModelactivity=function(){return this.getMap("activity")},e.prototype.getModelactivityFunction=function(){return this.getMap("activityFunction")},e.prototype.getModelactivityGroup=function(){return this.getMap("activityGroup")},e.prototype.getModelactivityjuexingdan=function(){return this.getMap("activityjuexingdan")},e.prototype.getModelactivityxianlvlaba=function(){return this.getMap("activityxianlvlaba")},e.prototype.getModelactivityxianlvshenqi=function(){return this.getMap("activityxianlvshenqi")},e.prototype.getModelchongbanglibao=function(){return this.getMap("chongbanglibao")},e.prototype.getModeldabiaohuodong=function(){return this.getMap("dabiaohuodong")},e.prototype.getModeldabiaorewards=function(){return this.getMap("dabiaorewards")},e.prototype.getModeldanbichongzhi=function(){return this.getMap("danbichongzhi")},e.prototype.getModeldanbichongzhi2=function(){return this.getMap("danbichongzhi2")},e.prototype.getModeldenglu=function(){return this.getMap("denglu")},e.prototype.getModeldenglu2=function(){return this.getMap("denglu2")},e.prototype.getModeldengluhuodong=function(){return this.getMap("dengluhuodong")},e.prototype.getModelfeastjizi=function(){return this.getMap("feastjizi")},e.prototype.getModelfeastShopRound=function(){return this.getMap("feastShopRound")},e.prototype.getModelfeastzhuanpan=function(){return this.getMap("feastzhuanpan")},e.prototype.getModelfund=function(){return this.getMap("fund")},e.prototype.getModelguanqiaxianfeng=function(){return this.getMap("guanqiaxianfeng")},e.prototype.getModelhefuchongzhi=function(){return this.getMap("hefuchongzhi")},e.prototype.getModelhefuleichong=function(){return this.getMap("hefuleichong")},e.prototype.getModelhefuzhuanpan=function(){return this.getMap("hefuzhuanpan")},e.prototype.getModelinvest=function(){return this.getMap("invest")},e.prototype.getModelkaifuduihuan=function(){return this.getMap("kaifuduihuan")},e.prototype.getModelkaifuleichong=function(){return this.getMap("kaifuleichong")},e.prototype.getModelkaifuTask=function(){return this.getMap("kaifuTask")},e.prototype.getModelkuafuchongzhi=function(){return this.getMap("kuafuchongzhi")},e.prototype.getModelkuafuxiaohao=function(){return this.getMap("kuafuxiaohao")},e.prototype.getModellabahuodong=function(){return this.getMap("labahuodong")},e.prototype.getModellabapaihangbang=function(){return this.getMap("labapaihangbang")},e.prototype.getModelleichonghaoli=function(){return this.getMap("leichonghaoli")},e.prototype.getModelleijichongzhi=function(){return this.getMap("leijichongzhi")},e.prototype.getModelleijixiaohao=function(){return this.getMap("leijixiaohao")},e.prototype.getModelleijixiaohaopaihang=function(){return this.getMap("leijixiaohaopaihang")},e.prototype.getModellianxuleichong=function(){return this.getMap("lianxuleichong")},e.prototype.getModelqiandao=function(){return this.getMap("qiandao")},e.prototype.getModelshenqichouqian=function(){return this.getMap("shenqichouqian")},e.prototype.getModelshenqileichong=function(){return this.getMap("shenqileichong")},e.prototype.getModelshenqileichong2=function(){return this.getMap("shenqileichong2")},e.prototype.getModeltaskhefu=function(){return this.getMap("taskhefu")},e.prototype.getModeltaskround=function(){return this.getMap("taskround")},e.prototype.getModeltehuilibaohuodong=function(){return this.getMap("tehuilibaohuodong")},e.prototype.getModeltuangouhuodong=function(){return this.getMap("tuangouhuodong")},e.prototype.getModelxiangoulibao=function(){return this.getMap("xiangoulibao")},e.prototype.getModelxiangoulibao2=function(){return this.getMap("xiangoulibao2")},e.prototype.getModelxiangoulibao3=function(){return this.getMap("xiangoulibao3")},e.prototype.getModelxianlvpaihang=function(){return this.getMap("xianlvpaihang")},e.prototype.getModelyaoqianshu=function(){return this.getMap("yaoqianshu")},e.prototype.getModelzhoumofenxiang=function(){return this.getMap("zhoumofenxiang")},e.prototype.getModelzhuanpanhuodong=function(){return this.getMap("zhuanpanhuodong")},e}();__reflect(JsonModelManager.prototype,"JsonModelManager");var ModelarenaRankReward=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelarenaRankReward.prototype,"ModelarenaRankReward");var ModelarenaReward=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelarenaReward.prototype,"ModelarenaReward");var Modelbaoshi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelbaoshi.prototype,"Modelbaoshi");var Modelboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelboss.prototype,"Modelboss");var ModelbossConfig=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelbossConfig.prototype,"ModelbossConfig");var Modelbossrewards=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelbossrewards.prototype,"Modelbossrewards");var Modelbox=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelbox.prototype,"Modelbox");var Modelbuff=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelbuff.prototype,"Modelbuff");var Modelcailiaofuben=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelcailiaofuben.prototype,"Modelcailiaofuben");var Modelcdkey=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelcdkey.prototype,"Modelcdkey");var Modelchenghao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchenghao.prototype,"Modelchenghao");var Modelchengjiu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchengjiu.prototype,"Modelchengjiu");var ModelchengjiuLv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelchengjiuLv.prototype,"ModelchengjiuLv");var ModelchengjiuMubiao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelchengjiuMubiao.prototype,"ModelchengjiuMubiao");var ModelchongwuDan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelchongwuDan.prototype,"ModelchongwuDan");var Modelchongwujinjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchongwujinjie.prototype,"Modelchongwujinjie");var Modelchongwupeiyang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchongwupeiyang.prototype,"Modelchongwupeiyang");var Modelchongwushengji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchongwushengji.prototype,"Modelchongwushengji");var Modelchongzhishengyan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchongzhishengyan.prototype,"Modelchongzhishengyan");var Modelchouqian=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchouqian.prototype,"Modelchouqian");var Modelconstant=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelconstant.prototype,"Modelconstant");var Modelcopy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelcopy.prototype,"Modelcopy");var Modelcuilian=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelcuilian.prototype,"Modelcuilian");var Modeldifu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldifu.prototype,"Modeldifu");var Modeldifubuff=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldifubuff.prototype,"Modeldifubuff");var Modeldingshihuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldingshihuodong.prototype,"Modeldingshihuodong");var Modeldujie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldujie.prototype,"Modeldujie");var Modelequipment=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelequipment.prototype,"Modelequipment");var Modelfabaojinjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfabaojinjie.prototype,"Modelfabaojinjie");var Modelfabaoshengji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfabaoshengji.prototype,"Modelfabaoshengji");var Modelfabaozhuanpan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfabaozhuanpan.prototype,"Modelfabaozhuanpan");var Modelfashion=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfashion.prototype,"Modelfashion");var ModelfeastShopBox=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelfeastShopBox.prototype,"ModelfeastShopBox");var Modelfengce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfengce.prototype,"Modelfengce");var Modelfenxiang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfenxiang.prototype,"Modelfenxiang");var Modelfighter=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfighter.prototype,"Modelfighter");var ModelfirstPay=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelfirstPay.prototype,"ModelfirstPay");
var Modelfuling=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfuling.prototype,"Modelfuling");var ModelfunctionLv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelfunctionLv.prototype,"ModelfunctionLv");var Modelgain=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelgain.prototype,"Modelgain");var Modelgerenboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelgerenboss.prototype,"Modelgerenboss");var Modelgongfa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelgongfa.prototype,"Modelgongfa");var Modelguanqiakaiqi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelguanqiakaiqi.prototype,"Modelguanqiakaiqi");var ModelguildBoss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelguildBoss.prototype,"ModelguildBoss");var Modelguildfuben=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelguildfuben.prototype,"Modelguildfuben");var ModelguildLv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelguildLv.prototype,"ModelguildLv");var Modelguildreward=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelguildreward.prototype,"Modelguildreward");var ModelguildShangxiang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelguildShangxiang.prototype,"ModelguildShangxiang");var ModelguildSkill=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelguildSkill.prototype,"ModelguildSkill");var Modelguildspecialreward=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelguildspecialreward.prototype,"Modelguildspecialreward");var ModelguildTask=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelguildTask.prototype,"ModelguildTask");var Modelhongzhuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelhongzhuang.prototype,"Modelhongzhuang");var Modelhunjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelhunjie.prototype,"Modelhunjie");var Modelitem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelitem.prototype,"Modelitem");var Modeljianchi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeljianchi.prototype,"Modeljianchi");var Modeljiehuntaozhuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeljiehuntaozhuang.prototype,"Modeljiehuntaozhuang");var Modeljingjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeljingjie.prototype,"Modeljingjie");var Modeljingmai=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeljingmai.prototype,"Modeljingmai");var Modelkuafuboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafuboss.prototype,"Modelkuafuboss");var Modelkuafubossrewards=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafubossrewards.prototype,"Modelkuafubossrewards");var Modelkuafujingjichang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafujingjichang.prototype,"Modelkuafujingjichang");var Modelkuafureward=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafureward.prototype,"Modelkuafureward");var Modellevelup=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellevelup.prototype,"Modellevelup");var Modellianhua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellianhua.prototype,"Modellianhua");var Modellingxing=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellingxing.prototype,"Modellingxing");var Modellonghun=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellonghun.prototype,"Modellonghun");var Modellvyaoqing=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellvyaoqing.prototype,"Modellvyaoqing");var Modelmail=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmail.prototype,"Modelmail");var Modelmap=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmap.prototype,"Modelmap");var Modelmingge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmingge.prototype,"Modelmingge");var Modelminggelv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelminggelv.prototype,"Modelminggelv");var Modelmount0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount0.prototype,"Modelmount0");var Modelmount1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount1.prototype,"Modelmount1");var Modelmount2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount2.prototype,"Modelmount2");var Modelmount3=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount3.prototype,"Modelmount3");var Modelmount4=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount4.prototype,"Modelmount4");var ModelmountDan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelmountDan.prototype,"ModelmountDan");var ModelmountEqianghua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelmountEqianghua.prototype,"ModelmountEqianghua");var ModelmountEquipment=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelmountEquipment.prototype,"ModelmountEquipment");var Modelmountparam=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmountparam.prototype,"Modelmountparam");var ModelmountSkill=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelmountSkill.prototype,"ModelmountSkill");var Modelmounttaozhuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmounttaozhuang.prototype,"Modelmounttaozhuang");var Modelpay=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelpay.prototype,"Modelpay");var Modelpeishiboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelpeishiboss.prototype,"Modelpeishiboss");var ModelPVPLV=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelPVPLV.prototype,"ModelPVPLV");var Modelqianghua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelqianghua.prototype,"Modelqianghua");var Modelqianghuadashi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelqianghuadashi.prototype,"Modelqianghuadashi");var Modelqihun=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelqihun.prototype,"Modelqihun");var Modelquanminboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelquanminboss.prototype,"Modelquanminboss");var Modelronghun=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelronghun.prototype,"Modelronghun");var Modelshanggutaozhuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshanggutaozhuang.prototype,"Modelshanggutaozhuang");var ModelshareMaster=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelshareMaster.prototype,"ModelshareMaster");var Modelshenmishop=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshenmishop.prototype,"Modelshenmishop");var Modelshenqi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshenqi.prototype,"Modelshenqi");var Modelshop=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshop.prototype,"Modelshop");var Modelshow=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshow.prototype,"Modelshow");var Modelsixiang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelsixiang.prototype,"Modelsixiang");var Modelsixiangfuben=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelsixiangfuben.prototype,"Modelsixiangfuben");var Modelsixiangjinjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelsixiangjinjie.prototype,"Modelsixiangjinjie");var Modelskill=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelskill.prototype,"Modelskill");var Modelskilldmg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelskilldmg.prototype,"Modelskilldmg");var Modelskilltupo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelskilltupo.prototype,"Modelskilltupo");var Modelstory=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelstory.prototype,"Modelstory");var ModeltaskDaily=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModeltaskDaily.prototype,"ModeltaskDaily");var Modeltaskhuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltaskhuodong.prototype,"Modeltaskhuodong");var Modeltehuilibao2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltehuilibao2.prototype,"Modeltehuilibao2");var Modelteshuxiaoguo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelteshuxiaoguo.prototype,"Modelteshuxiaoguo");var Modeltext=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltext.prototype,"Modeltext");var Modeltianshenzhuangbei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltianshenzhuangbei.prototype,"Modeltianshenzhuangbei");var Modeltianshushengji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltianshushengji.prototype,"Modeltianshushengji");var Modeltianshutupo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltianshutupo.prototype,"Modeltianshutupo");var Modeltips=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltips.prototype,"Modeltips");var Modeltouxiang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltouxiang.prototype,"Modeltouxiang");var Modeltouxiangkuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltouxiangkuang.prototype,"Modeltouxiangkuang");var Modeltouxiangkuangshengji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltouxiangkuangshengji.prototype,"Modeltouxiangkuangshengji");var Modeltouxiangshengji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltouxiangshengji.prototype,"Modeltouxiangshengji");var Modelttjjc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelttjjc.prototype,"Modelttjjc");var Modelttre=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelttre.prototype,"Modelttre");var Modeltujian=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltujian.prototype,"Modeltujian");var Modeltujian2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltujian2.prototype,"Modeltujian2");var Modeltujiantaozhuang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltujiantaozhuang.prototype,"Modeltujiantaozhuang");var Modelvip=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelvip.prototype,"Modelvip");var Modelvipboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelvipboss.prototype,"Modelvipboss");var Modelvipshenqi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelvipshenqi.prototype,"Modelvipshenqi");var ModelvipShopXianShi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelvipShopXianShi.prototype,"ModelvipShopXianShi");var Modelwutan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelwutan.prototype,"Modelwutan");var Modelwuxing=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelwuxing.prototype,"Modelwuxing");var Modelxiandan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxiandan.prototype,"Modelxiandan");var Modelxiangsishu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxiangsishu.prototype,"Modelxiangsishu");var Modelxianshan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxianshan.prototype,"Modelxianshan");var Modelxianshanzhaohuan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxianshanzhaohuan.prototype,"Modelxianshanzhaohuan");var Modelxinfajinjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxinfajinjie.prototype,"Modelxinfajinjie");var ModelxinfaLv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelxinfaLv.prototype,"ModelxinfaLv");var Modelxinshou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxinshou.prototype,"Modelxinshou");var Modelxinshourenwu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxinshourenwu.prototype,"Modelxinshourenwu");var Modelxuezhanboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxuezhanboss.prototype,"Modelxuezhanboss");var Modelxunbao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxunbao.prototype,"Modelxunbao");var Modelxunbaobang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxunbaobang.prototype,"Modelxunbaobang");var Modelxunbaobang2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxunbaobang2.prototype,"Modelxunbaobang2");var Modelxuyuanchi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxuyuanchi.prototype,"Modelxuyuanchi");var Modelxuyuanchi2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxuyuanchi2.prototype,"Modelxuyuanchi2");var Modelyuanjie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelyuanjie.prototype,"Modelyuanjie");var Modelyuanjielv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelyuanjielv.prototype,"Modelyuanjielv");var Modelyuanshen=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelyuanshen.prototype,"Modelyuanshen");var Modelyueka=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelyueka.prototype,"Modelyueka");var Modelzaoyubang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzaoyubang.prototype,"Modelzaoyubang");var Modelzhanwen=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhanwen.prototype,"Modelzhanwen");var Modelzhaohuanboss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhaohuanboss.prototype,"Modelzhaohuanboss");var Modelzhaohuanrewards=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhaohuanrewards.prototype,"Modelzhaohuanrewards");var Modelzhenghun=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhenghun.prototype,"Modelzhenghun");var Modelzhuanpanvip=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhuanpanvip.prototype,"Modelzhuanpanvip");var Modelzhuansheng=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhuansheng.prototype,"Modelzhuansheng");var Modelzhuanshengrewards=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhuanshengrewards.prototype,"Modelzhuanshengrewards");var Modelzhufuzhifuben=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhufuzhifuben.prototype,"Modelzhufuzhifuben");var Modelzhuxiantai=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhuxiantai.prototype,"Modelzhuxiantai");var Modelzuduifuben=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzuduifuben.prototype,"Modelzuduifuben");var Modelactivity=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelactivity.prototype,"Modelactivity");var ModelactivityFunction=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelactivityFunction.prototype,"ModelactivityFunction");var ModelactivityGroup=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelactivityGroup.prototype,"ModelactivityGroup");var Modelactivityjuexingdan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelactivityjuexingdan.prototype,"Modelactivityjuexingdan");var Modelactivityxianlvlaba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelactivityxianlvlaba.prototype,"Modelactivityxianlvlaba");var Modelactivityxianlvshenqi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelactivityxianlvshenqi.prototype,"Modelactivityxianlvshenqi");var Modelchongbanglibao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelchongbanglibao.prototype,"Modelchongbanglibao");var Modeldabiaohuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldabiaohuodong.prototype,"Modeldabiaohuodong");var Modeldabiaorewards=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldabiaorewards.prototype,"Modeldabiaorewards");var Modeldanbichongzhi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldanbichongzhi.prototype,"Modeldanbichongzhi");var Modeldanbichongzhi2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldanbichongzhi2.prototype,"Modeldanbichongzhi2");var Modeldenglu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldenglu.prototype,"Modeldenglu");var Modeldenglu2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldenglu2.prototype,"Modeldenglu2");var Modeldengluhuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeldengluhuodong.prototype,"Modeldengluhuodong");var Modelfeastjizi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfeastjizi.prototype,"Modelfeastjizi");var ModelfeastShopRound=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelfeastShopRound.prototype,"ModelfeastShopRound");var Modelfeastzhuanpan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfeastzhuanpan.prototype,"Modelfeastzhuanpan");var Modelfund=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelfund.prototype,"Modelfund");var Modelguanqiaxianfeng=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelguanqiaxianfeng.prototype,"Modelguanqiaxianfeng");var Modelhefuchongzhi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelhefuchongzhi.prototype,"Modelhefuchongzhi");var Modelhefuleichong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelhefuleichong.prototype,"Modelhefuleichong");var Modelhefuzhuanpan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelhefuzhuanpan.prototype,"Modelhefuzhuanpan");var Modelinvest=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelinvest.prototype,"Modelinvest");var Modelkaifuduihuan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkaifuduihuan.prototype,"Modelkaifuduihuan");var Modelkaifuleichong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkaifuleichong.prototype,"Modelkaifuleichong");var ModelkaifuTask=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(ModelkaifuTask.prototype,"ModelkaifuTask");var Modelkuafuchongzhi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafuchongzhi.prototype,"Modelkuafuchongzhi");var Modelkuafuxiaohao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelkuafuxiaohao.prototype,"Modelkuafuxiaohao");var Modellabahuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellabahuodong.prototype,"Modellabahuodong");var Modellabapaihangbang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellabapaihangbang.prototype,"Modellabapaihangbang");var Modelleichonghaoli=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelleichonghaoli.prototype,"Modelleichonghaoli");var Modelleijichongzhi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelleijichongzhi.prototype,"Modelleijichongzhi");var Modelleijixiaohao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelleijixiaohao.prototype,"Modelleijixiaohao");var Modelleijixiaohaopaihang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelleijixiaohaopaihang.prototype,"Modelleijixiaohaopaihang");var Modellianxuleichong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modellianxuleichong.prototype,"Modellianxuleichong");var Modelqiandao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelqiandao.prototype,"Modelqiandao");var Modelshenqichouqian=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshenqichouqian.prototype,"Modelshenqichouqian");var Modelshenqileichong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshenqileichong.prototype,"Modelshenqileichong");var Modelshenqileichong2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelshenqileichong2.prototype,"Modelshenqileichong2");var Modeltaskhefu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltaskhefu.prototype,"Modeltaskhefu");var Modeltaskround=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltaskround.prototype,"Modeltaskround");var Modeltehuilibaohuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltehuilibaohuodong.prototype,"Modeltehuilibaohuodong");var Modeltuangouhuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modeltuangouhuodong.prototype,"Modeltuangouhuodong");var Modelxiangoulibao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxiangoulibao.prototype,"Modelxiangoulibao");var Modelxiangoulibao2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxiangoulibao2.prototype,"Modelxiangoulibao2");var Modelxiangoulibao3=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxiangoulibao3.prototype,"Modelxiangoulibao3");var Modelxianlvpaihang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelxianlvpaihang.prototype,"Modelxianlvpaihang");var Modelyaoqianshu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelyaoqianshu.prototype,"Modelyaoqianshu");var Modelzhoumofenxiang=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhoumofenxiang.prototype,"Modelzhoumofenxiang");var Modelzhuanpanhuodong=function(e){function t(){return null!==e&&e.apply(this,arguments)||this
}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelzhuanpanhuodong.prototype,"Modelzhuanpanhuodong");var PlayerBody=function(e){function t(){var t=e.call(this)||this;return t.ctGhostTime=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){egret.superSetter(t,this,"data",e)},enumerable:!0,configurable:!0}),t.prototype.onResetHeadInfo=function(){e.prototype.onResetHeadInfo.call(this),this.data.bodyType!=BODY_TYPE.SELF&&GameFight.getInstance().isPVPFightScene?this.bodyHead.hpProBarSkinName(skins.HpProgressBar2):this.bodyHead.hpProBarSkinName(skins.HpProgressBar1),this.onRefreshLevelShow()},t.prototype.onRefreshLevelShow=function(){this.data.coatardLv},t.prototype.onRefreshData=function(){this._mountOffY=-45,this.onCheckDeath(),this.onResetHeadInfo(),this.onChangeTitleBody(),this.onRefreshShield(),this.onCheckRetinue()},t.prototype.onCheckRetinue=function(){this.createMagic(),this.createPets()},t.prototype.onRefreshShield=function(){this.data.shieldValue>0?this._shieldAnim||(this._shieldAnim=new EffectBody("hudunEffect",null,-1),this._shieldAnim.y=-(this.data.model.high/2)+this.mountOffY,this.addEffectToSprite(this._shieldAnim,this,"TOP")):this.removeShieldAnim()},t.prototype.onUpdateAvatar=function(){e.prototype.onUpdateAvatar.call(this)},t.prototype.updateAction=function(){e.prototype.updateAction.call(this),this.onChangeBody(),this.onChangeMountBody(),this.onChangeWeaponBody(),this.onChangeWingBody(),this.refreshBodyHeight()},t.prototype.onChangeBody=function(){if(this.data&&this.data.cloth_res){var e=this.actionName;if(e){var t=LoadManager.getInstance().getClothResUrl(this.data.cloth_res,e,this.getDirectionFrame());this._body?this._body.onUpdateRes(t,this._actionPlayNum,this.getDirectionFrame()):this._body=new BodyAnimation(t,this._actionPlayNum,this.getDirectionFrame())}else this._body&&this._body.onUpdateRes(ChannelDefine.cdnUrl+"resource/model/model_action_null",0,null);this._body&&this.addLayerOrder(this._body,PLAYER_LAYER.BODY)}},t.prototype.onChangeWeaponBody=function(){if(this.data&&this.data.weapon_res){var e=this.actionName;if(this.data.sex==SEX_TYPE.MALE)switch(e){case"stand":e+="Nan";break;case"attack1":e="attack7";break;case"attack2":e="attack8";break;case"attack3":e="attack9";break;case"attack5":e=""}if(e&&6!=this._atkAcitonIdx){var t=LoadManager.getInstance().getWeaponResUrl(this.data.weapon_res,e,this.getDirectionFrame());this._weaponBody?this._weaponBody.onUpdateRes(t,this._actionPlayNum,this.getDirectionFrame()):this._weaponBody=new BodyAnimation(t,this._actionPlayNum,this.getDirectionFrame());var n=PLAYER_LAYER.WEAPON;(this.direction==Direction.DOWN||this.direction==Direction.LEFTUP||this.direction==Direction.LEFT||this.direction==Direction.LEFTDOWN)&&(n=PLAYER_LAYER.MOUNT+1),this.addLayerOrder(this._weaponBody,n)}else this._weaponBody&&this._weaponBody.onUpdateRes(ChannelDefine.cdnUrl+"resource/model/model_action_null",0,null)}else this._weaponBody&&(this._weaponBody.onDestroy(),this._weaponBody=null)},t.prototype.onChangeWingBody=function(){if(this.data&&this.data.wing_res){var e="ride_stand";if(this._action==ACTION.JUMP)this._wingBody&&this._wingBody.onUpdateRes(ChannelDefine.cdnUrl+"resource/model/model_action_null",0,null);else{var t=LoadManager.getInstance().getWingResUrl(this.data.wing_res,e,this.getDirectionFrame());t!=this._wingResName&&(this._wingResName=t,this._wingBody?this._wingBody.onUpdateRes(t,-1,this.getDirectionFrame()):this._wingBody=new BodyAnimation(t,-1,this.getDirectionFrame()));var n=PLAYER_LAYER.WING;(this.direction==Direction.DOWN||this.direction==Direction.RIGHTDOWN||this.direction==Direction.LEFTDOWN)&&(n=PLAYER_LAYER.MOUNT+1),this.addLayerOrder(this._wingBody,n)}}else this._wingBody&&(this._wingBody.onDestroy(),this._wingBody=null)},t.prototype.onHideWing=function(e){this._wingBody&&(this._wingBody.visible=!e)},t.prototype.showWingEffect=function(){this._wingBody&&(this._wingBody.visible=!0,this._wingBody.alpha=0,egret.Tween.get(this._wingBody).to({alpha:1},500).call(function(){this._wingBody&&egret.Tween.removeTweens(this._wingBody)},this))},t.prototype.onChangeMountBody=function(){var e;if(this.data){var t="stand";e=LoadManager.getInstance().getFeijianUrl(this.data.feijian_Res,t,this.getDirectionFrame())}e?(this._mountBody?this._mountBody.onUpdateRes(e,-1,this.getDirectionFrame()):this._mountBody=new BodyAnimation(e,-1,this.getDirectionFrame()),this.addLayerOrder(this._mountBody,PLAYER_LAYER.MOUNT)):this._mountBody&&(this._mountBody.onDestroy(),this._mountBody=null)},t.prototype.onHideRide=function(e){this._mountBody&&(this._mountBody.visible=!e)},t.prototype.showRideEffect=function(){this._mountBody&&(this._mountBody.visible=!0,this._mountBody.alpha=0,egret.Tween.get(this._mountBody).to({alpha:1},500).call(function(){this._mountBody&&egret.Tween.removeTweens(this._mountBody)},this))},t.prototype.refreshBodyHeight=function(){var e=this._mountOffY;this._action==ACTION.ATTACK&&5==this._atkAcitonIdx&&(e=this._mountOffY-30),this._body&&this._body.y!=this._mountOffY&&(this._body.y=this._mountOffY),this._weaponBody&&this._weaponBody.y!=this._mountOffY&&(this._weaponBody.y=this._mountOffY),this._wingBody&&this._wingBody.y!=e&&(this._wingBody.y=e),this._magicBody&&this._magicBody.refreshBodyHeight(this._mountOffY),this.onUpdateHeadPos()},t.prototype.onChangeTitleBody=function(){var e;this.data&&(e=JsonModelManager.instance.getModelchenghao()[this.data.titleId]),e?this._titlebody?this._titlebody.onupdate(e):(this._titlebody=new TitleBody(e),this.bodyHead.addTitleToHead(this._titlebody)):this._titlebody&&(this._titlebody.onDestroy(),this._titlebody=null)},t.prototype.onUpdateHeadPos=function(){if(this.data){var e=this._mountOffY;this._action==ACTION.ATTACK&&5==this._atkAcitonIdx&&(e=this._mountOffY-30),this.bodyHead.x=-this.bodyHead.width/2,this.bodyHead.y=e-this.data.model.high-30}},t.prototype.setMove=function(t){if(e.prototype.setMove.call(this,t),t){var n=t.length>0?t[t.length-1]:this.moveTarget;if(this._magicBody&&n){var a=Tool.randomPosByDistance(n.x,n.y,60);this._magicBody.setFollowPaths(a)}this._petbody&&n&&!this.isPlayJump&&this._petbody.setFollowPaths(n)}},t.prototype.onJump=function(t,n){if(void 0===n&&(n=!1),t&&!this.isPlayJump){for(var a=this.selfPoint,i=this.data.useSkill?this.data.useSkill.model.dist:0;egret.Point.distance(a,t)>GameDefine.PLAYER_JUMP_DIST+i;){var o=Tool.getPosByTwoPoint(a.x,a.y,t.x,t.y,GameDefine.PLAYER_JUMP_DIST);this._jumpPoints||(this._jumpPoints=[]),this._jumpPoints.push(o),a=o}this.isPlayJump?(this._jumpPoints.push(t),this.onHideRide(!0),n&&(this.walkOn=!0),this.onInitJump(),e.prototype.onJump.call(this,t,n)):this.playChagre([t],n)}},t.prototype.onInitJump=function(){if(this.isPlayJump){var e=this._jumpPoints.shift();0==this._jumpPoints.length?(this.onFinishJump(),this.playChagre([e],this.walkOn)):(this.setMove([e]),this._jumpDist=this.getDistToTarget(),this._jumpFrameCount=0,this._jumpFrameTime=0)}},t.prototype.onJumpHandler=function(){if(!(egret.getTimer()-this.walkLogicTime<20)){this.moveSpeed=1.2*this._jumpDist;var t=250-this._dt*this._jumpFrameCount;if(t>0?this.childOffY=Math.ceil(this.childOffY-t/10):this.childOffY=Math.min(0,this.childOffY+20),egret.getTimer()-this._jumpFrameTime>=60&&this._jumpFrameCount>=0&&this._jumpFrameCount<=6){this._body&&this._body.gotoAndStop(this._jumpFrameCount),this._weaponBody&&this._weaponBody.gotoAndStop(this._jumpFrameCount),this._jumpFrameTime=egret.getTimer();var n=new egret.DisplayObjectContainer;this.modelGhostHandler(this._body,n),this.modelGhostHandler(this._weaponBody,n),this.modelGhostHandler(this._wingBody,n),n.scaleX=this.bodyLayer.scaleX,n.scaleY=this.bodyLayer.scaleY,n.alpha=.8,this.addEffectToSprite(n,this.parent,"BOTTOM"),n.x=this.x,n.y=this.y,TweenLiteUtil.onHideTween(n,this.disposeGhoseHandler,this),this._jumpFrameCount++}this.walkLogicTime=egret.getTimer(),e.prototype.logicMove.call(this,this._dt)}},t.prototype.onFinishJump=function(){this.showRideEffect(),this.showWingEffect(),e.prototype.onFinishJump.call(this)},t.prototype.onAttack=function(){e.prototype.onAttack.call(this),this._petbody&&this.hurtBody&&(this._petbody.onAddEnemyBodyList(this.data.targets),this._petbody.currTarget=this.hurtBody,this._petbody.onAttack(),this._petbody.onClearTargets())},t.prototype.playChagre=function(e,t){void 0===t&&(t=!1),this._isChagre||(this._isChagre=!0,this.moveSpeed=GameDefine.CHONGFENG_SPEED,this._retinuebody&&(this._retinuebody.moveSpeed=GameDefine.CHONGFENG_SPEED)),this.onActionReset(),t?this.setWalkOn(e):this.setMove(e),this.data.bodyType==BODY_TYPE.SELF&&0==this.ctGhostTime&&(this.ctGhostTime=egret.getTimer()+100)},t.prototype.overChagre=function(){this._isChagre=!1,this.ctGhostTime=0,this.moveSpeed=GameDefine.Define_Move_Speed},Object.defineProperty(t.prototype,"isChagre",{get:function(){return this._isChagre},enumerable:!0,configurable:!0}),t.prototype.onCreateGhost=function(){if(!(this.ctGhostTime-egret.getTimer()>0)){this.ctGhostTime=egret.getTimer()+100;var e=new egret.DisplayObjectContainer;this.modelGhostHandler(this._mountBody,e),this.modelGhostHandler(this._wingBody,e),this.modelGhostHandler(this._body,e),this.modelGhostHandler(this._weaponBody,e),e.scaleX=this.bodyLayer.scaleX,e.scaleY=this.bodyLayer.scaleY,e.alpha=.8,this.addEffectToSprite(e,this.parent,"BOTTOM"),e.x=this.x,e.y=this.y,TweenLiteUtil.onHideTween(e,this.disposeGhoseHandler,this)}},t.prototype.modelGhostHandler=function(e,t){if(e){var n=e.currFrameTexture;if(n){var a=new egret.Bitmap(n);a.x=e.x+e.currFrameData.x,a.y=e.y+e.currFrameData.y,t.addChild(a)}}},t.prototype.disposeGhoseHandler=function(e){for(var t=e.numChildren-1;t>=0;t--){var n=e.getChildAt(t);e.removeChild(n),n=null}e.parent&&e.parent.removeChild(e),e=null},t.prototype.onClearTargets=function(){e.prototype.onClearTargets.call(this),this._retinuebody&&this._retinuebody.onClearTargets()},t.prototype.createPets=function(){this._data&&this._data.petGrade>=0?this._petbody?this._petbody.data.playerData=this._data:this._petbody=BodyFactory.instance.createPetBody(this._data):this._petbody&&this.removePetBody()},t.prototype.removePetBody=function(){this._petbody&&(BodyFactory.instance.onRecovery(this._petbody),this._petbody=null)},Object.defineProperty(t.prototype,"petBody",{get:function(){return this._petbody},enumerable:!0,configurable:!0}),t.prototype.createRetinue=function(){var e=this.data.getAppearID(BLESS_TYPE.RETINUE_CLOTHES);return 0>e?void this.removeRetinue():void(this._retinuebody?this._retinuebody.onRefreshData():this._retinuebody=BodyFactory.instance.createRetinueBody(this.data))},t.prototype.removeRetinue=function(){this._retinuebody&&(BodyFactory.instance.onRecovery(this._retinuebody),this._retinuebody=null)},Object.defineProperty(t.prototype,"retinuebody",{get:function(){return this._retinuebody},enumerable:!0,configurable:!0}),t.prototype.createMagic=function(){var e=this.data.getAppearID(BLESS_TYPE.MAGIC);return 0>e?void this.removeMagic():(this._magicBody||(this._magicBody=new MagicBody),void(this._magicBody.data=this.data))},t.prototype.removeMagic=function(){this._magicBody&&(this._magicBody.onDestroy(),this._magicBody=null)},Object.defineProperty(t.prototype,"magicbody",{get:function(){return this._magicBody},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDamageFalse",{get:function(){return this._isDamageFalse},set:function(e){this._isDamageFalse=e,this._retinuebody&&(this._retinuebody.isDamageFalse=e)},enumerable:!0,configurable:!0}),t.prototype.onHurt=function(t){e.prototype.onHurt.call(this,t),this.data.shieldValue<=0&&this.removeShieldAnim()},t.prototype.removeShieldAnim=function(){this._shieldAnim&&(this._shieldAnim.onDestroy(),this._shieldAnim=null)},t.prototype.allBodyStop=function(){this._body&&this._body.onStop(),this._weaponBody&&this._weaponBody.onStop(),this._mountBody&&this._mountBody.onStop(),this._wingBody&&this._wingBody.onStop()},Object.defineProperty(t.prototype,"bodyVisible",{set:function(e){egret.superSetter(t,this,"bodyVisible",e),this._body&&(this._body.visible=e),this._weaponBody&&(this._weaponBody.visible=e),this._mountBody&&(this._mountBody.visible=e),this._wingBody&&(this._wingBody.visible=e),this._titlebody&&(this._titlebody.visible=e),this._retinuebody&&(this._retinuebody.bodyVisible=e),this._petbody&&(this._petbody.bodyVisible=e),this.onshoworhideShodow(e),this.onHideHeadBar(e)},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._mountBody&&(this._mountBody.onDestroy(),this._mountBody=null),this._weaponBody&&(this._weaponBody.onDestroy(),this._weaponBody=null,this._wingResName=null),this._wingBody&&(this._wingBody.onDestroy(),this._wingBody=null),this._titlebody&&(this._titlebody.onDestroy(),this._titlebody=null),this.removeRetinue(),this.removeMagic()},Object.defineProperty(t.prototype,"mountType",{get:function(){return MOUNT_TYPE.STAND_MOUNT},enumerable:!0,configurable:!0}),t.prototype.onReset=function(){e.prototype.onReset.call(this),this.overChagre(),this.removeShieldAnim(),this.onShowOrHideHpBar(!0)},t}(ActionBody);__reflect(PlayerBody.prototype,"PlayerBody");var PLAYER_LAYER;!function(e){e[e.MOUNT=0]="MOUNT",e[e.BODY=1]="BODY",e[e.WEAPON=2]="WEAPON",e[e.WING=3]="WING"}(PLAYER_LAYER||(PLAYER_LAYER={}));var MESSAGE_ID;!function(e){e[e.ERROR_TIP_MESSAGE=400]="ERROR_TIP_MESSAGE",e[e.GAME_TICK_MESSAGE=99]="GAME_TICK_MESSAGE",e[e.GAME_LOGON_MESSAGE=101]="GAME_LOGON_MESSAGE",e[e.SELECT_SERVER_MESSAGE=102]="SELECT_SERVER_MESSAGE",e[e.LOGIN_SERVER_MESSAGE=103]="LOGIN_SERVER_MESSAGE",e[e.CREATE_ROLE_MESSAGE=104]="CREATE_ROLE_MESSAGE",e[e.ENTER_GAME_MESSAGE=105]="ENTER_GAME_MESSAGE",e[e.PLAYER_MESSAGE=106]="PLAYER_MESSAGE",e[e.TIMEOUT_MESSAGE=110]="TIMEOUT_MESSAGE",e[e.PLAYER_CURRENCY_UPDATE=107]="PLAYER_CURRENCY_UPDATE",e[e.PLAYER_EXP_UPDATE=108]="PLAYER_EXP_UPDATE",e[e.NOVICE_GUIDE_UPDATE=109]="NOVICE_GUIDE_UPDATE",e[e.REPEAT_LOGIN_MESSAGE=114]="REPEAT_LOGIN_MESSAGE",e[e.OFFLINE_EXP_REWARD=115]="OFFLINE_EXP_REWARD",e[e.PASS_SCENE_REWARD=117]="PASS_SCENE_REWARD",e[e.RECEIVE_ONLINE_GIFT=118]="RECEIVE_ONLINE_GIFT",e[e.LOGIN_BAN_MESSAGE=119]="LOGIN_BAN_MESSAGE",e[e.OPT_PLAYER_HEAD_MESSAGE=121]="OPT_PLAYER_HEAD_MESSAGE",e[e.OPT_PLAYER_HEAD_NAME_MESSAGE=123]="OPT_PLAYER_HEAD_NAME_MESSAGE",e[e.OFFLINE_EXP_SHARE_COMPLETE=124]="OFFLINE_EXP_SHARE_COMPLETE",e[e.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE=120]="OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE",e[e.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE=133]="OPT_PLAYER_HEAD_FRAME_UP_MESSAGE",e[e.OPT_PLAYER_HEAD_UP_MESSAGE=134]="OPT_PLAYER_HEAD_UP_MESSAGE",e[e.OPEN_PLAYER_MESSAGE=201]="OPEN_PLAYER_MESSAGE",e[e.OTHER_MESSAGE=131]="OTHER_MESSAGE",e[e.GOODS_LIST_MESSAGE=301]="GOODS_LIST_MESSAGE",e[e.GOODS_LIST_ADD_MESSAGE=302]="GOODS_LIST_ADD_MESSAGE",e[e.GOODS_LIST_USE_MESSAGE=303]="GOODS_LIST_USE_MESSAGE",e[e.GAME_CLOTHEQUIP_MESSAGE=304]="GAME_CLOTHEQUIP_MESSAGE",e[e.GOODS_ARTIFACT_EQUIP_MESSAGE=305]="GOODS_ARTIFACT_EQUIP_MESSAGE",e[e.USE_HORSE_ORDER_MESSAGE=306]="USE_HORSE_ORDER_MESSAGE",e[e.USE_WEAPON_ORDER_MESSAGE=307]="USE_WEAPON_ORDER_MESSAGE",e[e.USE_CLOTHES_ORDER_MESSAGE=308]="USE_CLOTHES_ORDER_MESSAGE",e[e.USE_WING_ORDER_MESSAGE=309]="USE_WING_ORDER_MESSAGE",e[e.USE_MAGIC_ORDER_MESSAGE=310]="USE_MAGIC_ORDER_MESSAGE",e[e.USE_LADDER_ORDER_MESSAGE=311]="USE_LADDER_ORDER_MESSAGE",e[e.USE_EXPLORE_ORDER_MESSAGE=312]="USE_EXPLORE_ORDER_MESSAGE",e[e.USE_ESCORT_PASS_ORDER_MESSAGE=313]="USE_ESCORT_PASS_ORDER_MESSAGE",e[e.USE_ESCORT_ROB_ORDER_MESSAGE=314]="USE_ESCORT_ROB_ORDER_MESSAGE",e[e.USE_BOSS_DEKARON_ORDER_MESSAGE=315]="USE_BOSS_DEKARON_ORDER_MESSAGE",e[e.GOODS_LIMIT_LIST_MESSAGE=316]="GOODS_LIMIT_LIST_MESSAGE",e[e.GOODS_LIMIT_ADD_MESSAGE=317]="GOODS_LIMIT_ADD_MESSAGE",e[e.USE_ARENA_ORDER_MESSAGE=318]="USE_ARENA_ORDER_MESSAGE",e[e.FOURINAGE_UPLEVEL_MESSAGE=331]="FOURINAGE_UPLEVEL_MESSAGE",e[e.FOURINAGE_UPUPGRADE_MESSAGE=332]="FOURINAGE_UPUPGRADE_MESSAGE",e[e.TITLE_LIST_MESSAGE=365]="TITLE_LIST_MESSAGE",e[e.TITLE_WEAR_MESSAGE=366]="TITLE_WEAR_MESSAGE",e[e.TITLE_JIHUO_MESSAGE=367]="TITLE_JIHUO_MESSAGE",e[e.FASHIONSETL_ACT_MESSAGE=368]="FASHIONSETL_ACT_MESSAGE",e[e.FASHIONSETL_UPLV_MESSAGE=369]="FASHIONSETL_UPLV_MESSAGE",e[e.GAME_FIGHT_START_MSG=2001]="GAME_FIGHT_START_MSG",e[e.GAME_FIGHT_RESULT_MSG=2002]="GAME_FIGHT_RESULT_MSG",e[e.GAME_FIGHT_DUP_ENTER=2003]="GAME_FIGHT_DUP_ENTER",e[e.GAME_FIGHT_DUP_RESULT=2004]="GAME_FIGHT_DUP_RESULT",e[e.GAME_DUP_INFO_MESSAGE=2005]="GAME_DUP_INFO_MESSAGE",e[e.GAME_DUP_BUYNUM_MESSAGE=2006]="GAME_DUP_BUYNUM_MESSAGE",e[e.GAME_DUP_SWEEP_MESSAGE=2007]="GAME_DUP_SWEEP_MESSAGE",e[e.GAME_BLESSDUP_PROGRESS_MSG=3006]="GAME_BLESSDUP_PROGRESS_MSG",e[e.GAME_SIXIANG_PROGRESS_MSG=3007]="GAME_SIXIANG_PROGRESS_MSG",e[e.GAME_SIXIANG_REWARD_MSG=333]="GAME_SIXIANG_REWARD_MSG",e[e.GAME_BLESSDUP_REWARD_MSG=334]="GAME_BLESSDUP_REWARD_MSG",e[e.TEAMDUP_CREATETEAM_MESSAGE=2301]="TEAMDUP_CREATETEAM_MESSAGE",e[e.TEAMDUP_JOINTEAM_MESSAGE=2302]="TEAMDUP_JOINTEAM_MESSAGE",e[e.TEAMDUP_LEAVETEAM_MESSAGE=2303]="TEAMDUP_LEAVETEAM_MESSAGE",e[e.TEAMDUP_READYINFO_MESSAGE=2304]="TEAMDUP_READYINFO_MESSAGE",e[e.TEAMDUP_TEAMDAMAGE_MESSAGE=2305]="TEAMDUP_TEAMDAMAGE_MESSAGE",e[e.TEAMDUP_QUITSCENE_MESSAGE=2306]="TEAMDUP_QUITSCENE_MESSAGE",e[e.TEAMDUP_DROPGOODS_MESSAGE=2307]="TEAMDUP_DROPGOODS_MESSAGE",e[e.YEWAIPVP_FIGHTTER_INFO_MSG=2801]="YEWAIPVP_FIGHTTER_INFO_MSG",e[e.YEWAIPVP_FIND_FIGHTTER_MSG=2802]="YEWAIPVP_FIND_FIGHTTER_MSG",e[e.PAIHANGBANG_ZAOYUBANG_MESSAGE=2803]="PAIHANGBANG_ZAOYUBANG_MESSAGE",e[e.YEWAIPVP_FIGHT_LOG_MSG=2804]="YEWAIPVP_FIGHT_LOG_MSG",e[e.YEWAIPVP_FIGHT_PK_MSG=2805]="YEWAIPVP_FIGHT_PK_MSG",e[e.YEWAIPVP_FIHGT_RESULT_MSG=2806]="YEWAIPVP_FIHGT_RESULT_MSG",e[e.ALLPEOPLE_BOSS_LISTINFO_MSG=730]="ALLPEOPLE_BOSS_LISTINFO_MSG",e[e.ALLPEOPLE_BOSS_ENTER_MSG=731]="ALLPEOPLE_BOSS_ENTER_MSG",e[e.ALLPEOPLE_BOSS_LEAVE_MSG=732]="ALLPEOPLE_BOSS_LEAVE_MSG",e[e.ALLPEOPLE_BOSS_RESULT_MSG=733]="ALLPEOPLE_BOSS_RESULT_MSG",e[e.ALLPEOPLE_FIGHT_UPDATE_MSG=734]="ALLPEOPLE_FIGHT_UPDATE_MSG",e[e.ALLPEOPLE_RANK_INFO_MSG=735]="ALLPEOPLE_RANK_INFO_MSG",e[e.ALLPEOPLE_REBORN_NOTICE_MSG=736]="ALLPEOPLE_REBORN_NOTICE_MSG",e[e.ALLPEOPLE_SET_REMIND_MSG=737]="ALLPEOPLE_SET_REMIND_MSG",e[e.ALLPEOPLE_OTHERBODY_MSG=738]="ALLPEOPLE_OTHERBODY_MSG",e[e.ALLPEOPLE_PK_MESSAGE=739]="ALLPEOPLE_PK_MESSAGE",e[e.ALLPEOPLE_PVP_REVIVE=7391]="ALLPEOPLE_PVP_REVIVE",e[e.ALLPEOPLE_DEAD_MSG=754]="ALLPEOPLE_DEAD_MSG",e[e.ALLPEOPLE_FT_MSG=755]="ALLPEOPLE_FT_MSG",e[e.XUEZHANBOSS_LISTINFO_MSG=1600]="XUEZHANBOSS_LISTINFO_MSG",e[e.XUEZHANBOSS_ENTER_MSG=1601]="XUEZHANBOSS_ENTER_MSG",e[e.XUEZHANBOSS_LEAVE_MSG=1602]="XUEZHANBOSS_LEAVE_MSG",e[e.XUEZHANBOSS_RESULT_MSG=1603]="XUEZHANBOSS_RESULT_MSG",e[e.XUEZHANBOSS_FIGHT_UPDATE_MSG=1604]="XUEZHANBOSS_FIGHT_UPDATE_MSG",e[e.XUEZHANBOSS_RANK_INFO_MSG=1605]="XUEZHANBOSS_RANK_INFO_MSG",e[e.XUEZHANBOSS_REBORN_NOTICE_MSG=1606]="XUEZHANBOSS_REBORN_NOTICE_MSG",e[e.XUEZHANBOSS_SET_REMIND_MSG=1607]="XUEZHANBOSS_SET_REMIND_MSG",e[e.XUEZHANBOSS_OTHERBODY_MSG=1608]="XUEZHANBOSS_OTHERBODY_MSG",e[e.XUEZHANBOSS_OTHERPK_MSG=1609]="XUEZHANBOSS_OTHERPK_MSG",e[e.XUEZHANBOSS_OTHERPK_FINISH_MSG=1610]="XUEZHANBOSS_OTHERPK_FINISH_MSG",e[e.XUEZHANBOSS_REBORN_MSG=1611]="XUEZHANBOSS_REBORN_MSG",e[e.VIPBOSS_LISTINFO_MSG=1650]="VIPBOSS_LISTINFO_MSG",e[e.VIPBOSS_ENTER_MSG=1651]="VIPBOSS_ENTER_MSG",e[e.VIPBOSS_LEAVE_MSG=1652]="VIPBOSS_LEAVE_MSG",e[e.VIPBOSS_RESULT_MSG=1653]="VIPBOSS_RESULT_MSG",e[e.VIPBOSS_FIGHT_UPDATE_MSG=1654]="VIPBOSS_FIGHT_UPDATE_MSG",e[e.VIPBOSS_RANK_INFO_MSG=1655]="VIPBOSS_RANK_INFO_MSG",e[e.VIPBOSS_REBORN_NOTICE_MSG=1656]="VIPBOSS_REBORN_NOTICE_MSG",e[e.VIPBOSS_SET_REMIND_MSG=1657]="VIPBOSS_SET_REMIND_MSG",e[e.VIPBOSS_OTHERBODY_MSG=1658]="VIPBOSS_OTHERBODY_MSG",e[e.VIPBOSS_OTHERPK_MSG=1659]="VIPBOSS_OTHERPK_MSG",e[e.VIPBOSS_OTHERPK_FINISH_MSG=1660]="VIPBOSS_OTHERPK_FINISH_MSG",e[e.VIPBOSS_REBORN_MSG=1661]="VIPBOSS_REBORN_MSG",e[e.SAMSARA_BOSS_LISTINFO_MSG=740]="SAMSARA_BOSS_LISTINFO_MSG",e[e.SAMSARA_BOSS_ENTER_MSG=741]="SAMSARA_BOSS_ENTER_MSG",e[e.SAMSARA_BOSS_FIGHT_MSG=742]="SAMSARA_BOSS_FIGHT_MSG",e[e.SAMSARA_BOSS_TARGET_MSG=743]="SAMSARA_BOSS_TARGET_MSG",e[e.SAMSARA_BOSS_RANK_MSG=744]="SAMSARA_BOSS_RANK_MSG",e[e.SAMSARA_BOSS_OTHERBODY_MSG=745]="SAMSARA_BOSS_OTHERBODY_MSG",e[e.SAMSARA_BOSS_REBORN_MSG=746]="SAMSARA_BOSS_REBORN_MSG",e[e.SAMSARA_BOSS_KILLLOG_MSG=747]="SAMSARA_BOSS_KILLLOG_MSG",e[e.SAMSARA_BOSS_REMIND_MSG=748]="SAMSARA_BOSS_REMIND_MSG",e[e.SAMSARA_BOSS_OTHERLEAVE_MSG=749]="SAMSARA_BOSS_OTHERLEAVE_MSG",e[e.SAMSARA_BOSS_BACKAWD_MSG=850]="SAMSARA_BOSS_BACKAWD_MSG",e[e.EXPLOREBOSS_BOSS_INIT=7500]="EXPLOREBOSS_BOSS_INIT",e[e.EXPLOREBOSS_BOSS_RANK=7510]="EXPLOREBOSS_BOSS_RANK",e[e.EXPLOREBOSS_BOSS_FIGHTENTER=7520]="EXPLOREBOSS_BOSS_FIGHTENTER",e[e.EXPLOREBOSS_BOSS_FIGHTRESULT=7530]="EXPLOREBOSS_BOSS_FIGHTRESULT",e[e.EXPLOREBOSS_LIFE_MSG=7540]="EXPLOREBOSS_LIFE_MSG",e[e.EXPLOREBOSS_ENTER_MSG=7550]="EXPLOREBOSS_ENTER_MSG",e[e.EXPLOREBOSS_EXPLORETASK_MSG=7560]="EXPLOREBOSS_EXPLORETASK_MSG",e[e.EXPLOREBOSS_FINISH_MSG=7570]="EXPLOREBOSS_FINISH_MSG",e[e.EXPLOREBOSS_LEAVE_MSG=7580]="EXPLOREBOSS_LEAVE_MSG",e[e.SKILL_UP_MESSAGE=501]="SKILL_UP_MESSAGE",e[e.SKILL_UP_AUTO_MESSAGE=502]="SKILL_UP_AUTO_MESSAGE",e[e.SKILL_UPGRADE_MESSAGE=503]="SKILL_UPGRADE_MESSAGE",e[e.GONGFA_DATE_MESSAGE=555]="GONGFA_DATE_MESSAGE",e[e.GEM_LOTTERY_MESSAGE=563]="GEM_LOTTERY_MESSAGE",e[e.GEM_LOTTERY_LOGS_MESSAGE=564]="GEM_LOTTERY_LOGS_MESSAGE",e[e.BLESS_UP_MESSAGE=601]="BLESS_UP_MESSAGE",e[e.BLESS_HORSE_UP_MESSAGE=1601]="BLESS_HORSE_UP_MESSAGE",e[e.BLESS_HORSE_GROW_MESSAGE=606]="BLESS_HORSE_GROW_MESSAGE",e[e.BLESS_HORSE_APTITUDE_MESSAGE=607]="BLESS_HORSE_APTITUDE_MESSAGE",e[e.BLESS_WEAPON_GROW_MESSAGE=608]="BLESS_WEAPON_GROW_MESSAGE",e[e.BLESS_WEAPON_APTITUDE_MESSAGE=609]="BLESS_WEAPON_APTITUDE_MESSAGE",e[e.MOUNT_UP_PILL_MESSAGE=610]="MOUNT_UP_PILL_MESSAGE",e[e.BLESS_CLOTHES_APTITUDE_MESSAGE=611]="BLESS_CLOTHES_APTITUDE_MESSAGE",e[e.BLESS_WING_GROW_MESSAGE=612]="BLESS_WING_GROW_MESSAGE",e[e.BLESS_WING_APTITUDE_MESSAGE=613]="BLESS_WING_APTITUDE_MESSAGE",e[e.BLESS_MAGIC_GROW_MESSAGE=614]="BLESS_MAGIC_GROW_MESSAGE",e[e.BLESS_MAGIC_APTITUDE_MESSAGE=615]="BLESS_MAGIC_APTITUDE_MESSAGE",e[e.BLESS_COUNT_DOWN_MESSAGE=616]="BLESS_COUNT_DOWN_MESSAGE",e[e.BLESS_HORSE_UP_PILL_MESSAGE=617]="BLESS_HORSE_UP_PILL_MESSAGE",e[e.BLESS_WEAPON_UP_PILL_MESSAGE=618]="BLESS_WEAPON_UP_PILL_MESSAGE",e[e.BLESS_CLOTHES_UP_PILL_MESSAGE=619]="BLESS_CLOTHES_UP_PILL_MESSAGE",e[e.BLESS_EQUIP_MESSAGE=620]="BLESS_EQUIP_MESSAGE",e[e.BLESS_EQUIP_SLOT_MESSAGE=621]="BLESS_EQUIP_SLOT_MESSAGE",e[e.BLESS_UP_SKILL_MESSAGE=630]="BLESS_UP_SKILL_MESSAGE",e[e.BLESS_UP_DAN_MESSAGE=631]="BLESS_UP_DAN_MESSAGE",e[e.BLESS_WAKE_UP_MESSAGE=632]="BLESS_WAKE_UP_MESSAGE",e[e.PLAYER_INTENSIFY_MESSAGE=551]="PLAYER_INTENSIFY_MESSAGE",e[e.PLAYER_INFUSE_SOUL_MESSAGE=550]="PLAYER_INFUSE_SOUL_MESSAGE",e[e.PLAYER_SMELT_SPECIAL_MESSAGE=552]="PLAYER_SMELT_SPECIAL_MESSAGE",e[e.PLAYER_SMELT_COMMON_MESSAGE=554]="PLAYER_SMELT_COMMON_MESSAGE",e[e.PLAYER_ZHUHUN_MESSAGE=553]="PLAYER_ZHUHUN_MESSAGE",e[e.PLAYER_LEGEND_ACTIVATE_MESSAGE=651]="PLAYER_LEGEND_ACTIVATE_MESSAGE",e[e.PLAYER_LEGEND_UPGRADE_MESSAGE=652]="PLAYER_LEGEND_UPGRADE_MESSAGE",e[e.VIPGOD_ARTIFACT_ACTIVATE_MESSAGE=656]="VIPGOD_ARTIFACT_ACTIVATE_MESSAGE",e[e.VIPGOD_ARTIFACT_UPGRADE_MESSAGE=657]="VIPGOD_ARTIFACT_UPGRADE_MESSAGE",e[e.PLAYER_PULSE_UPGRADE_MESSAGE=660]="PLAYER_PULSE_UPGRADE_MESSAGE",e[e.PLAYER_QIHUN_UPGRADE_MESSAGE=665]="PLAYER_QIHUN_UPGRADE_MESSAGE",e[e.PLAYER_BUY_SHOP_GOODS_MESSAGE=801]="PLAYER_BUY_SHOP_GOODS_MESSAGE",e[e.PLAYER_SHENMISHOP_GOODS_MESSAGE=160]="PLAYER_SHENMISHOP_GOODS_MESSAGE",e[e.PLAYER_SHENMISHOP_BUY_MESSAGE=161]="PLAYER_SHENMISHOP_BUY_MESSAGE",e[e.PLAYER_SHENMISHOP_UPDATE_MESSAGE=162]="PLAYER_SHENMISHOP_UPDATE_MESSAGE",e[e.SHOP_DISCOUNT_INFO_MESSAGE=800]="SHOP_DISCOUNT_INFO_MESSAGE",e[e.ARENE_LADDERARENE_UPDATE_MESSAGE=700]="ARENE_LADDERARENE_UPDATE_MESSAGE",e[e.ARENE_LADDERARENE_FIGHT_MESSAGE=701]="ARENE_LADDERARENE_FIGHT_MESSAGE",e[e.ARENE_LADDERARENE_RESULT_MESSAGE=702]="ARENE_LADDERARENE_RESULT_MESSAGE",e[e.ARENE_LADDERARENE_INSPIRE_MESSAGE=703]="ARENE_LADDERARENE_INSPIRE_MESSAGE",e[e.ARENE_LADDERARENE_RANK_MESSAGE=704]="ARENE_LADDERARENE_RANK_MESSAGE",e[e.ARENE_CROSS_INFO_UPDATE_MESSAGE=2101]="ARENE_CROSS_INFO_UPDATE_MESSAGE",e[e.ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE=2102]="ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE",e[e.ARENE_CROSS_FIGHT_ENTER_MESSAGE=2103]="ARENE_CROSS_FIGHT_ENTER_MESSAGE",e[e.ARENE_CROSS_RANK_UPDATE_MESSAGE=2104]="ARENE_CROSS_RANK_UPDATE_MESSAGE",e[e.ARENE_CROSS_RANK_HISTROY_MESSAGE=2105]="ARENE_CROSS_RANK_HISTROY_MESSAGE",e[e.ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE=2106]="ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE",e[e.ARENE_CROSS_WORSHIP_MESSAGE=2107]="ARENE_CROSS_WORSHIP_MESSAGE",e[e.ARENE_INFO_UPDATE_MESSAGE=2201]="ARENE_INFO_UPDATE_MESSAGE",e[e.ARENE_REFRESH_ENEMYLIST_MESSAGE=2202]="ARENE_REFRESH_ENEMYLIST_MESSAGE",e[e.ARENE_FIGHT_ENTER_MESSAGE=2203]="ARENE_FIGHT_ENTER_MESSAGE",e[e.ARENE_RANK_UPDATE_MESSAGE=2204]="ARENE_RANK_UPDATE_MESSAGE",e[e.ARENE_RANK_HISTROY_MESSAGE=2205]="ARENE_RANK_HISTROY_MESSAGE",e[e.ARENE_FIGHT_RESULT_MESSAGE=2206]="ARENE_FIGHT_RESULT_MESSAGE",e[e.ARENE_BUY_FIGHTCOUNT_MESSAGE=2207]="ARENE_BUY_FIGHTCOUNT_MESSAGE",e[e.ARENA_BATTLE_SWEEP=2208]="ARENA_BATTLE_SWEEP",e[e.ARENE_FIRST_AWARD_MESSAGE=2209]="ARENE_FIRST_AWARD_MESSAGE",e[e.ESCORT_REVENGE_MESSAGE=708]="ESCORT_REVENGE_MESSAGE",e[e.ESCORT_REVENGE_RESULT_MESSAGE=709]="ESCORT_REVENGE_RESULT_MESSAGE",e[e.ESCORT_DETAIL_MESSAGE=710]="ESCORT_DETAIL_MESSAGE",e[e.ESCORT_DISPATCH_MESSAGE=711]="ESCORT_DISPATCH_MESSAGE",e[e.ESCORT_ROB_MESSAGE=712]="ESCORT_ROB_MESSAGE",e[e.ESCORT_REFRESH_QUALITY_MESSAGE=713]="ESCORT_REFRESH_QUALITY_MESSAGE",e[e.ESCORT_ROBLIST_MESSAGE=714]="ESCORT_ROBLIST_MESSAGE",e[e.ESCORT_ROB_RESULT_MESSAGE=715]="ESCORT_ROB_RESULT_MESSAGE",e[e.ESCORT_ESCORT_DONE=716]="ESCORT_ESCORT_DONE",e[e.ESCORT_ESCORT_RECORD=717]="ESCORT_ESCORT_RECORD",e[e.ESCORT_REDPOINT_MESSAGE=718]="ESCORT_REDPOINT_MESSAGE",e[e.ESCORT_AWARD_RECEIVE_MESSAGE=719]="ESCORT_AWARD_RECEIVE_MESSAGE",e[e.ORANGE_MIX_MESSAGE=720]="ORANGE_MIX_MESSAGE",e[e.ORANGE_UPGRADE_MESSAGE=721]="ORANGE_UPGRADE_MESSAGE",e[e.ORANGE_RES_MESSAGE=722]="ORANGE_RES_MESSAGE",e[e.CELESTIAL_COMPOUND_MESSAGE=723]="CELESTIAL_COMPOUND_MESSAGE",e[e.CELESTIAL_UPGRADE_MESSAGE=724]="CELESTIAL_UPGRADE_MESSAGE",e[e.CELESTIAL_DECOMPOSE_MESSAGE=725]="CELESTIAL_DECOMPOSE_MESSAGE",e[e.TREASURE_CELESTIAL_MEESAGE=726]="TREASURE_CELESTIAL_MEESAGE",e[e.TREASURE_CELESTIAL_LOG_MEESAGE=727]="TREASURE_CELESTIAL_LOG_MEESAGE",e[e.WAREHOUSE_TAKEOUT_MESSAGE=728]="WAREHOUSE_TAKEOUT_MESSAGE",e[e.WAREHOUSE_MESSAGE=729]="WAREHOUSE_MESSAGE",e[e.TREASURE_WEEK_AWARD_MESSAGE=3008]="TREASURE_WEEK_AWARD_MESSAGE",e[e.ACTIVITY_CONSUMEITEM_MESSAGE=3009]="ACTIVITY_CONSUMEITEM_MESSAGE",e[e.ACTIVTIY_CONSUMEITEM_RANK_MSG=3013]="ACTIVTIY_CONSUMEITEM_RANK_MSG",e[e.ACTIVITY_CONSUME_TURNPLATE_MSG=3014]="ACTIVITY_CONSUME_TURNPLATE_MSG",e[e.TASK_CHAIN_UPDATE_MESSAGE=901]="TASK_CHAIN_UPDATE_MESSAGE",e[e.TASK_CHAIN_REWARD_MESSAGE=902]="TASK_CHAIN_REWARD_MESSAGE",e[e.TASK_DAILY_INIT_MESSAGE=903]="TASK_DAILY_INIT_MESSAGE",e[e.TASK_DAILY_UPDATE_MESSAGE=904]="TASK_DAILY_UPDATE_MESSAGE",e[e.JIANCHI_INFO_UPDATE_MESSAGE=905]="JIANCHI_INFO_UPDATE_MESSAGE",e[e.JIANCHI_LEVELUP_MESSEAGE=906]="JIANCHI_LEVELUP_MESSEAGE",e[e.SHARE_INFO_MESSAGE=921]="SHARE_INFO_MESSAGE",e[e.SHARE_COMPLETE_MESSAGE=922]="SHARE_COMPLETE_MESSAGE",e[e.SHARE_REWARD_MESSAGE=923]="SHARE_REWARD_MESSAGE",e[e.FOCUS_REWARD_MESSAGE=924]="FOCUS_REWARD_MESSAGE",e[e.WXGAME_SHARE_LEVEL_MESSAGE=925]="WXGAME_SHARE_LEVEL_MESSAGE",e[e.WXGAME_INVITE_FRIEND_MSG=926]="WXGAME_INVITE_FRIEND_MSG",e[e.XYX_IOS_CHARGE_MESSAGE=927]="XYX_IOS_CHARGE_MESSAGE",e[e.XYX_SHARE_EXP_MESSAGE=930]="XYX_SHARE_EXP_MESSAGE",e[e.XYX_SHARE_MASTER_MESSAGE=931]="XYX_SHARE_MASTER_MESSAGE",e[e.SHARE_REWARD2_MESSAGE=929]="SHARE_REWARD2_MESSAGE",e[e.XYX_COLLECTION_MESSAGE=932]="XYX_COLLECTION_MESSAGE",e[e.PLAYER_MAIL_MESSAGE=810]="PLAYER_MAIL_MESSAGE",e[e.PLAYER_MAIL_READ_MESSAGE=811]="PLAYER_MAIL_READ_MESSAGE",e[e.PLAYER_MAIL_GET_ACCESSORY_MESSAGE=812]="PLAYER_MAIL_GET_ACCESSORY_MESSAGE",e[e.PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE=813]="PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE",e[e.PLAYER_MAIL_NEW_MESSAGE=814]="PLAYER_MAIL_NEW_MESSAGE",e[e.PLAYER_CHAT_RECEIVE_MESSAGE=820]="PLAYER_CHAT_RECEIVE_MESSAGE",e[e.PLAYER_CHAT_SEND_MESSAGE=821]="PLAYER_CHAT_SEND_MESSAGE",e[e.PLAYER_BROADCAST_MESSAGE=822]="PLAYER_BROADCAST_MESSAGE",e[e.PLAYER_INVESTTURNPLATE_MESSAGE=823]="PLAYER_INVESTTURNPLATE_MESSAGE",e[e.PLAYER_PSYCH_UPGRADE_MESSAGE=680]="PLAYER_PSYCH_UPGRADE_MESSAGE",e[e.PLAYER_PSYCH_EQUIP_MESSAGE=681]="PLAYER_PSYCH_EQUIP_MESSAGE",e[e.PLAYER_PSYCH_PROPHECY_MESSAGE=682]="PLAYER_PSYCH_PROPHECY_MESSAGE",e[e.PLAYER_PSYCH_GAIN_MESSAGE=683]="PLAYER_PSYCH_GAIN_MESSAGE",e[e.PLAYER_PSYCH_DECOMPOSE_MESSAGE=684]="PLAYER_PSYCH_DECOMPOSE_MESSAGE",e[e.UNION_INFO_MESSAGE=1101]="UNION_INFO_MESSAGE",e[e.UNION_LIST_MESSAGE=1102]="UNION_LIST_MESSAGE",e[e.UNION_CREATE_MESSAGE=1103]="UNION_CREATE_MESSAGE",e[e.UNION_SEARCH_MESSAGE=1104]="UNION_SEARCH_MESSAGE",e[e.UNION_CHANGE_XUYAN_MESSAGE=1105]="UNION_CHANGE_XUYAN_MESSAGE",e[e.UNION_CHANGE_NOTICE_MESSAGE=1106]="UNION_CHANGE_NOTICE_MESSAGE",e[e.UNION_CHANGE_LVLIMIT_MESSAGE=1107]="UNION_CHANGE_LVLIMIT_MESSAGE",e[e.UNION_CHANGE_AUTOADOPT_MESSAGE=1108]="UNION_CHANGE_AUTOADOPT_MESSAGE",e[e.UNION_MEMBER_LIST_MESSAGE=1109]="UNION_MEMBER_LIST_MESSAGE",e[e.UNION_APPLY_JOIN_MESSAGE=1110]="UNION_APPLY_JOIN_MESSAGE",e[e.UNION_POSTION_MESSAGE=1111]="UNION_POSTION_MESSAGE",e[e.UNION_DELETE_MEMBER_MESSAGE=1112]="UNION_DELETE_MEMBER_MESSAGE",e[e.UNION_DISSOLVED_MESSAGE=1113]="UNION_DISSOLVED_MESSAGE",e[e.UNION_QUIT_MESSAGE=1114]="UNION_QUIT_MESSAGE",e[e.UNION_REVIEW_LIST_MESSAGE=1115]="UNION_REVIEW_LIST_MESSAGE",e[e.UNION_REVIEW_OPERATION_MESSAGE=1116]="UNION_REVIEW_OPERATION_MESSAGE",e[e.UNION_TRIBUTE_MESSAGE=1117]="UNION_TRIBUTE_MESSAGE",e[e.UNION_TURNPLATE_FILT_MESSAGE=1119]="UNION_TURNPLATE_FILT_MESSAGE",e[e.UNION_LOG_MESSAGE=1121]="UNION_LOG_MESSAGE",e[e.UNION_SKILL2_UPGRADE_MESSAGE=1122]="UNION_SKILL2_UPGRADE_MESSAGE",e[e.UNION_PRIZE_RECORD_MESSAGE=1123]="UNION_PRIZE_RECORD_MESSAGE",e[e.UNION_TASK_MESSAGE=1124]="UNION_TASK_MESSAGE",e[e.UNION_TASK_UPDATE_MESSAGE=1125]="UNION_TASK_UPDATE_MESSAGE",e[e.UNION_DUP_REWARD_MESSAGE=1126]="UNION_DUP_REWARD_MESSAGE",e[e.UNION_DUP_RANK_MESSAGE=1127]="UNION_DUP_RANK_MESSAGE",e[e.UNION_DUP_ZHUWEI_MESSAGE=1128]="UNION_DUP_ZHUWEI_MESSAGE",e[e.UNION_IMPEACHMENT_MESSAGE=1129]="UNION_IMPEACHMENT_MESSAGE",e[e.UNION_BOSS_INFO_MESSAGE=1131]="UNION_BOSS_INFO_MESSAGE",e[e.UNION_BOSS_LIST_MESSAGE=1132]="UNION_BOSS_LIST_MESSAGE",e[e.UNION_BOSS_FIGHT_MESSAGE=1133]="UNION_BOSS_FIGHT_MESSAGE",e[e.UNION_BOSS_RESUTL_MESSAGE=1134]="UNION_BOSS_RESUTL_MESSAGE",e[e.UNION_REVIEW_AGREE_ALL=1135]="UNION_REVIEW_AGREE_ALL",e[e.MYSTERIOUS_BOSS_INFO=1136]="MYSTERIOUS_BOSS_INFO",e[e.MYSTERIOUS_BOSS_FIGHT=1137]="MYSTERIOUS_BOSS_FIGHT",e[e.MYSTERIOUS_BOSS_OTHERBODY_MSG=1138]="MYSTERIOUS_BOSS_OTHERBODY_MSG",e[e.MYSTERIOUS_BOSS_FIGHT_INFO=1139]="MYSTERIOUS_BOSS_FIGHT_INFO",e[e.BOSS_MYSTERIOUS_TOP_MESSAGE=1150]="BOSS_MYSTERIOUS_TOP_MESSAGE",e[e.BOSS_MYSTERIOUS_REVIVE_MESSAGE=1151]="BOSS_MYSTERIOUS_REVIVE_MESSAGE",e[e.BOSS_MYSTERIOUS_TARGET_MESSAGE=1152]="BOSS_MYSTERIOUS_TARGET_MESSAGE",e[e.BOSS_MYSTERIOUS_QUIT_MESSAGE=1153]="BOSS_MYSTERIOUS_QUIT_MESSAGE",e[e.BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE=1154]="BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE",e[e.UNION_BATTLE_GROUPINFO_MESSAGE=1140]="UNION_BATTLE_GROUPINFO_MESSAGE",e[e.UNION_BATTLE_ENJOIN_MESSAGE=1141]="UNION_BATTLE_ENJOIN_MESSAGE",e[e.UNION_BATTLE_FIGHT_MESSAGE=1142]="UNION_BATTLE_FIGHT_MESSAGE",e[e.UNION_BATTLE_FIGHTRESULT_MESSAGE=1143]="UNION_BATTLE_FIGHTRESULT_MESSAGE",e[e.UNION_BATTLE_RANK_MESSAGE=1144]="UNION_BATTLE_RANK_MESSAGE",e[e.UNION_BATTLE_ALLOT_MESSAGE=1145]="UNION_BATTLE_ALLOT_MESSAGE",e[e.UNION_BATTLE_DEPOT_MESSAGE=1146]="UNION_BATTLE_DEPOT_MESSAGE",e[e.UNION_BATTLE_BUYBUFF_MESSAGE=1147]="UNION_BATTLE_BUYBUFF_MESSAGE",e[e.UNION_BATTLE_QUIT_MESSAGE=1148]="UNION_BATTLE_QUIT_MESSAGE",e[e.UNION_BATTLE_COMEIN_MESSAGE=1149]="UNION_BATTLE_COMEIN_MESSAGE",e[e.XUEZHAN_INIT_MESSAGE=2010]="XUEZHAN_INIT_MESSAGE",e[e.XUEZHAN_FIGHT_MESSAGE=2011]="XUEZHAN_FIGHT_MESSAGE",e[e.XUEZHAN_RESULT_MESSAGE=2012]="XUEZHAN_RESULT_MESSAGE",e[e.XUEZHAN_BUFF_MESSAGE=2013]="XUEZHAN_BUFF_MESSAGE",e[e.XUEZHAN_REWARD_MESSAGE=2014]="XUEZHAN_REWARD_MESSAGE",e[e.XUEZHAN_SAODANG_MESSAGE=2015]="XUEZHAN_SAODANG_MESSAGE",e[e.CROSS_PVEBOSS_INFO_MESSAGE=2151]="CROSS_PVEBOSS_INFO_MESSAGE",e[e.CROSS_PVEBOSS_RANK_MESSAGE=2152]="CROSS_PVEBOSS_RANK_MESSAGE",e[e.CROSS_PVEBOSS_FIGHT_MESSAGE=2153]="CROSS_PVEBOSS_FIGHT_MESSAGE",e[e.CROSS_PVEBOSS_COUNTBUY_MESSAGE=2154]="CROSS_PVEBOSS_COUNTBUY_MESSAGE",e[e.TEST_FIGHTING_MESSAGE=1]="TEST_FIGHTING_MESSAGE",e[e.ACTIVITY_MESSAGE=1e3]="ACTIVITY_MESSAGE",e[e.ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE=1001]="ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE",e[e.ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE=1002]="ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE",e[e.ACTIVITY_SEVDAY_MESSAGE=1003]="ACTIVITY_SEVDAY_MESSAGE",e[e.ACTIVITY_COATARD_REWARD=1004]="ACTIVITY_COATARD_REWARD",e[e.SHENTONG_INIT_BAG_MESSAGE=1201]="SHENTONG_INIT_BAG_MESSAGE",e[e.SHENTONG_LOTTERY_MESSAGE=1202]="SHENTONG_LOTTERY_MESSAGE",e[e.SHENTONG_ADD_MESSAGE=1203]="SHENTONG_ADD_MESSAGE",e[e.SHENTONG_INIT_SLOT_MESSAGE=1204]="SHENTONG_INIT_SLOT_MESSAGE",e[e.SHENTONG_LEARN_MESSAGE=1205]="SHENTONG_LEARN_MESSAGE",e[e.SHENTONG_UPLEVEL_MESSAGE=1206]="SHENTONG_UPLEVEL_MESSAGE",e[e.SHENTONG_UPGRADE_MESSAGE=1207]="SHENTONG_UPGRADE_MESSAGE",e[e.SHENTONG_REMOVE_MESSAGE=1208]="SHENTONG_REMOVE_MESSAGE",e[e.HUANHUA_ACTIVATE_MESSMAGE=653]="HUANHUA_ACTIVATE_MESSMAGE",e[e.HUANHUA_CHANGE_MESSAGE=654]="HUANHUA_CHANGE_MESSAGE",e[e.GAME_TOPRANK_INFO_MESSAGE=130]="GAME_TOPRANK_INFO_MESSAGE",e[e.GAME_TOPRANK_SIMPLE_MESSAGE=132]="GAME_TOPRANK_SIMPLE_MESSAGE",e[e.ACTIVITY_MONTHCARD_MESSAGE=135]="ACTIVITY_MONTHCARD_MESSAGE",e[e.MONTHLY_CARD_REWARD=136]="MONTHLY_CARD_REWARD",e[e.RECHAREG_RECORD_MESSAGE=140]="RECHAREG_RECORD_MESSAGE",e[e.DAILY_WELFARE_MESSAGE=141]="DAILY_WELFARE_MESSAGE",e[e.REBATE_TO_BUY_MESSAGE=142]="REBATE_TO_BUY_MESSAGE",e[e.INVEST_TO_BUY_MESSAGE=143]="INVEST_TO_BUY_MESSAGE",e[e.INVEST_TO_OBTAIN_MESSAGE=144]="INVEST_TO_OBTAIN_MESSAGE",e[e.TURNPLATE_FILT_MESSAGE=145]="TURNPLATE_FILT_MESSAGE",e[e.TLSHOP_TO_BUY_MESSAGE=146]="TLSHOP_TO_BUY_MESSAGE",e[e.TLGIFT_TO_OBTAIN_MESSAGE=147]="TLGIFT_TO_OBTAIN_MESSAGE",e[e.TOPRANK_GIFT_MESSAGE=148]="TOPRANK_GIFT_MESSAGE",e[e.VIPTLGIFT_TO_BUY_MESSAGE=149]="VIPTLGIFT_TO_BUY_MESSAGE",e[e.VIPTLSHOP_TO_BUY_MESSAGE=150]="VIPTLSHOP_TO_BUY_MESSAGE",e[e.CASHCOW_LOTTERY_MESSAGE=151]="CASHCOW_LOTTERY_MESSAGE",e[e.COLLECTWORD_EXCHANGE_MESSAGE=152]="COLLECTWORD_EXCHANGE_MESSAGE",e[e.TLDOGZ_EXCHANGE_MESSAGE=153]="TLDOGZ_EXCHANGE_MESSAGE",e[e.ACT_RONGLIAN_DUIHUAN=154]="ACT_RONGLIAN_DUIHUAN",e[e.SPRINGTLSHOP_TO_BUY_MESSAGE=155]="SPRINGTLSHOP_TO_BUY_MESSAGE",e[e.INVESTTURNPLATE_LOTTERY_MESSAGE=156]="INVESTTURNPLATE_LOTTERY_MESSAGE",e[e.SPATBLOOD_BUY_MESSAGE=157]="SPATBLOOD_BUY_MESSAGE",e[e.ONEREBATEST_BUY_MESSAGE=158]="ONEREBATEST_BUY_MESSAGE",e[e.ONEREBATEST_RECEIVE_MESSAGE=159]="ONEREBATEST_RECEIVE_MESSAGE",e[e.XIANGOULIBAO_BUY_MESSAGE=163]="XIANGOULIBAO_BUY_MESSAGE",e[e.CHONGJILIBAO_BUY_MESSAGE=164]="CHONGJILIBAO_BUY_MESSAGE",e[e.DABIAOJIANGLI_BUY_MESSAGE=165]="DABIAOJIANGLI_BUY_MESSAGE",e[e.DABIAOPAIHANG_DATE_MESSAGE=166]="DABIAOPAIHANG_DATE_MESSAGE",e[e.LOGON_REWARD_MESSAGE=167]="LOGON_REWARD_MESSAGE",e[e.SIGN_REWARD_MESSAGE=168]="SIGN_REWARD_MESSAGE",e[e.PLAYER_CHONGZHI_LINGQV_MESSAGE=169]="PLAYER_CHONGZHI_LINGQV_MESSAGE",e[e.YAOQIANSHU_YAOQIAN=170]="YAOQIANSHU_YAOQIAN",e[e.YAOQIANSHU_LINGJIANG=171]="YAOQIANSHU_LINGJIANG",e[e.TREASURE_RANK_LIST_MESSAGE=172]="TREASURE_RANK_LIST_MESSAGE",e[e.WISHINGWELL_ADVANCE_MESSAGE=173]="WISHINGWELL_ADVANCE_MESSAGE",e[e.ACTIVITY_FUDAI_MESSAGE=185]="ACTIVITY_FUDAI_MESSAGE",e[e.LIMIT_SIGN_REWARD_MESSAGE=186]="LIMIT_SIGN_REWARD_MESSAGE",e[e.VIP_XIANGOULIBAO_BUY_MESSAGE=187]="VIP_XIANGOULIBAO_BUY_MESSAGE",e[e.ZHIZUN_XIANGOULIBAO_BUY_MESSAGE=188]="ZHIZUN_XIANGOULIBAO_BUY_MESSAGE",e[e.FUNCTION_REWARD_MESSAGE=190]="FUNCTION_REWARD_MESSAGE",e[e.ACTIVITY_XIANFENG=191]="ACTIVITY_XIANFENG",e[e.THRONE_INFO_MESSAGE=760]="THRONE_INFO_MESSAGE",e[e.THRONE_OCCUPY_INFO_MESSAGE=761]="THRONE_OCCUPY_INFO_MESSAGE",e[e.THRONE_OCCUPY_LEAVE_MESSAGE=763]="THRONE_OCCUPY_LEAVE_MESSAGE",e[e.THRONE_OCCUPY_OBTAIN_MESSAGE=764]="THRONE_OCCUPY_OBTAIN_MESSAGE",e[e.THRONE_OCCUPY_PK_MESSAGE=765]="THRONE_OCCUPY_PK_MESSAGE",e[e.THRONE_OCCUPY_PK_RESULT_MESSAGE=766]="THRONE_OCCUPY_PK_RESULT_MESSAGE",e[e.UPDATE_BAG_UPPERLIMIT=111]="UPDATE_BAG_UPPERLIMIT",e[e.UPDATA_BAG_USELIMIT=112]="UPDATA_BAG_USELIMIT",e[e.GEM_INLAY_MESSAGE=560]="GEM_INLAY_MESSAGE",e[e.GEM_SYNTHETIC_MESSAGE=561]="GEM_SYNTHETIC_MESSAGE",e[e.GEM_UPGRADE_MESSAGE=562]="GEM_UPGRADE_MESSAGE",e[e.DOMINATE_UPGRADE_MESSAGE=351]="DOMINATE_UPGRADE_MESSAGE",e[e.DOMINATE_ADVANCE_MESSAGE=352]="DOMINATE_ADVANCE_MESSAGE",e[e.DOMINATE_DECOMPOSE_MESSAGE=353]="DOMINATE_DECOMPOSE_MESSAGE",e[e.FASHION_ACTIVE_MESSAGE=361]="FASHION_ACTIVE_MESSAGE",e[e.FASHION_SHOW_MESSAGE=362]="FASHION_SHOW_MESSAGE",e[e.FASHION_UPLEVEL_MESSAGE=363]="FASHION_UPLEVEL_MESSAGE",e[e.EXCHANGE_HZSP_MESSAGE=371]="EXCHANGE_HZSP_MESSAGE",e[e.PLAYER_MAGIC_MESSAGE=602]="PLAYER_MAGIC_MESSAGE",e[e.PLAYER_MAGIC_UPGRADE_MESSAGE=603]="PLAYER_MAGIC_UPGRADE_MESSAGE",e[e.PLAYER_MAGIC_ADVANCE_MESSAGE=604]="PLAYER_MAGIC_ADVANCE_MESSAGE",e[e.PLAYER_MAGIC_TURNPLATE_MESSAGE=605]="PLAYER_MAGIC_TURNPLATE_MESSAGE",e[e.PLAYER_FRIEND_LIST_MESSAGE=1301]="PLAYER_FRIEND_LIST_MESSAGE",e[e.PLAYER_FRIEND_ADD_MESSAGE=1302]="PLAYER_FRIEND_ADD_MESSAGE",e[e.PLAYER_FRIEND_APPLY_MESSAGE=1303]="PLAYER_FRIEND_APPLY_MESSAGE",e[e.PLAYER_FRIEND_SHIELD_MESSAGE=1304]="PLAYER_FRIEND_SHIELD_MESSAGE",e[e.PLAYER_FRIEND_DEL_MESSAGE=1305]="PLAYER_FRIEND_DEL_MESSAGE",e[e.PLAYER_FRIEND_APPLYNEW_MESSAGE=1306]="PLAYER_FRIEND_APPLYNEW_MESSAGE",e[e.PLAYER_FRIEND_SEARCH_MESSAGE=122]="PLAYER_FRIEND_SEARCH_MESSAGE",e[e.EQUIPSLOT_QUENCHING_MESSAGE=556]="EQUIPSLOT_QUENCHING_MESSAGE",e[e.FESTIVAL_SHOP_INFO_MESSAGE=1900]="FESTIVAL_SHOP_INFO_MESSAGE",e[e.FESTIVAL_SHOP_BUY_MESSAGE=1901]="FESTIVAL_SHOP_BUY_MESSAGE",e[e.FESTIVAL_SHOP_REFRESH_MESSAGE=1902]="FESTIVAL_SHOP_REFRESH_MESSAGE",e[e.FESTIVAL_LOGIN_AWARD_RECEIVE=174]="FESTIVAL_LOGIN_AWARD_RECEIVE",e[e.FESTIVAL_LIMIT_PURCHASE_BUY=175]="FESTIVAL_LIMIT_PURCHASE_BUY",e[e.FESTIVAL_WISHING_WELL_MESSAGE=176]="FESTIVAL_WISHING_WELL_MESSAGE",e[e.FESTIVAL_TARGET_AWARD_RECEIVE=177]="FESTIVAL_TARGET_AWARD_RECEIVE",e[e.FESTIVAL_TARGET_RANKLIST_MESSAGE=178]="FESTIVAL_TARGET_RANKLIST_MESSAGE",e[e.PAY_TARGET_AWARD_RECEIVE=179]="PAY_TARGET_AWARD_RECEIVE",e[e.PAY_TARGET_RANKLIST_MESSAGE=180]="PAY_TARGET_RANKLIST_MESSAGE",e[e.WEEKEND_LIMIT_PURCHASE_BUY=181]="WEEKEND_LIMIT_PURCHASE_BUY",e[e.WEEKEND_LOGIN_AWARD_RECEIVE=182]="WEEKEND_LOGIN_AWARD_RECEIVE",e[e.PLAYCAFE_EXCLUSIVE_AWARD_RECEIVE=183]="PLAYCAFE_EXCLUSIVE_AWARD_RECEIVE",e[e.FESTIVAL_TURNPLATE_LOTTERY_MESSAGE=184]="FESTIVAL_TURNPLATE_LOTTERY_MESSAGE",e[e.FESTIVAL_TURNPLATE_LOTTERY_RANK=192]="FESTIVAL_TURNPLATE_LOTTERY_RANK",e[e.FESTIVAL_MISSION_ACT_UPDATE=3051]="FESTIVAL_MISSION_ACT_UPDATE",e[e.FESTIVAL_MISSION_ACT_REWARD=3052]="FESTIVAL_MISSION_ACT_REWARD",e[e.HEFU_ACT_MISSION_UPDATE=3053]="HEFU_ACT_MISSION_UPDATE",e[e.HEFU_ACT_MISSION_REWARD=3054]="HEFU_ACT_MISSION_REWARD",e[e.HEFU_ACT_TURNPLATE_LOTTERY_MESSAGE=3055]="HEFU_ACT_TURNPLATE_LOTTERY_MESSAGE",e[e.HEFU_ACT_TURNPLATE_LOTTERY_RANK_MSG=3056]="HEFU_ACT_TURNPLATE_LOTTERY_RANK_MSG",e[e.HEFU_ACT_INVESTTURNPLATE_MESSAGE=3057]="HEFU_ACT_INVESTTURNPLATE_MESSAGE",e[e.ARTIFACT_ROLL_PLATE=3058]="ARTIFACT_ROLL_PLATE",e[e.ARTIFACT_ROLL_RANK_MESSAGE=3059]="ARTIFACT_ROLL_RANK_MESSAGE",e[e.BROADCAST_ARTIFACT_ROLL_MESSAGE=3060]="BROADCAST_ARTIFACT_ROLL_MESSAGE",e[e.PET_UPDATE_MESSAGE=381]="PET_UPDATE_MESSAGE",e[e.PET_UPGRADE_MESSAGE=382]="PET_UPGRADE_MESSAGE",e[e.PET_ACTIVE_MESSAGE=383]="PET_ACTIVE_MESSAGE",e[e.PET_TRAIN_RANDOM_MESSAGE=384]="PET_TRAIN_RANDOM_MESSAGE",e[e.PET_TRAIN_CHANGE_MESSAGE=385]="PET_TRAIN_CHANGE_MESSAGE",e[e.PET_TRAIN_CANCEL_MESSAGE=386]="PET_TRAIN_CANCEL_MESSAGE",e[e.PET_DAN_MESSAGE=387]="PET_DAN_MESSAGE",e[e.TUJIAN_MESSAGE=391]="TUJIAN_MESSAGE",e[e.XINFA_TUJIAN_MESSAGE=392]="XINFA_TUJIAN_MESSAGE",e[e.PET_LOTTERY_LOG_MESSAGE=824]="PET_LOTTERY_LOG_MESSAGE",e[e.WANBA_DESK_INFO_MESSAGE=3001]="WANBA_DESK_INFO_MESSAGE",e[e.WANBA_DESK_REWARD_MESSAGE=3002]="WANBA_DESK_REWARD_MESSAGE",e[e.WANBA_GIFT_MESSAGE=3003]="WANBA_GIFT_MESSAGE",e[e.REBIRTH_TASK_INIT_MSG=3004]="REBIRTH_TASK_INIT_MSG",e[e.REBIRTH_TASK_UPDATE_MSG=3005]="REBIRTH_TASK_UPDATE_MSG",e[e.REBIRTH_TASK_LV_MSG=3021]="REBIRTH_TASK_LV_MSG",e[e.REBIRTH_UPGRAGE_MESSAGE=670]="REBIRTH_UPGRAGE_MESSAGE",e[e.VIGOUR_EXCHANGE_MESSAGE=671]="VIGOUR_EXCHANGE_MESSAGE",e[e.LONGHUN_RANDOM=1400]="LONGHUN_RANDOM",e[e.LONGHUN_CHANGE=1401]="LONGHUN_CHANGE",e[e.LONGHUN_CANCEL=1402]="LONGHUN_CANCEL",e[e.WUXING_UP=1500]="WUXING_UP",e[e.FATE_UPGRADE_MESSAGE=690]="FATE_UPGRADE_MESSAGE",e[e.FATE_ACTIVE_MESSAGE=691]="FATE_ACTIVE_MESSAGE",e[e.FATE_LOTTERY_MESSAGE=692]="FATE_LOTTERY_MESSAGE",e[e.FATE_REWARD_MESSAGE=693]="FATE_REWARD_MESSAGE",e[e.TIANSHU_LEVELUP_MESSAGE=3401]="TIANSHU_LEVELUP_MESSAGE",e[e.TIANSHU_UPGRADE_MESSAGE=3402]="TIANSHU_UPGRADE_MESSAGE",e[e.SKILLENCHANT_LEVELUP_MESSAGE=3451]="SKILLENCHANT_LEVELUP_MESSAGE",e[e.SKILLENCHANT_CLOTH_MESSAGE=3452]="SKILLENCHANT_CLOTH_MESSAGE",e[e.SKILLENCHANT_UPGRADE_MESSAGE=3453]="SKILLENCHANT_UPGRADE_MESSAGE",e[e.SKILLENCHANT_ACTIVE_MESSAGE=3454]="SKILLENCHANT_ACTIVE_MESSAGE",e[e.PILL_ROLL_MESSAGE=1701]="PILL_ROLL_MESSAGE",e[e.PILL_USE_MESSAGE=1702]="PILL_USE_MESSAGE",e[e.PILL_MESSAGE=1703]="PILL_MESSAGE",e[e.PILL_HIDE_BOSS_MESSAGE=1704]="PILL_HIDE_BOSS_MESSAGE",e[e.ONLINE_BOSS_MESSAGE=1705]="ONLINE_BOSS_MESSAGE",e[e.ENERGY_MESSAGE=1751]="ENERGY_MESSAGE",e[e.ENERGY_GIFT=1752]="ENERGY_GIFT",e[e.ENERGY_GIFT_RECEIVE=1753]="ENERGY_GIFT_RECEIVE",e[e.ENERGY_GIFT_NOTIFY=1754]="ENERGY_GIFT_NOTIFY",e[e.BOSS_PILL_INFO_MESSAGE=1800]="BOSS_PILL_INFO_MESSAGE",e[e.BOSS_PILL_START_MESSAGE=1801]="BOSS_PILL_START_MESSAGE",e[e.BOSS_PILL_QUIT_MESSAGE=1802]="BOSS_PILL_QUIT_MESSAGE",e[e.BOSS_PILL_REWARD_MESSAGE=1803]="BOSS_PILL_REWARD_MESSAGE",e[e.BOSS_PILL_FIGHT_MESSAGE=1804]="BOSS_PILL_FIGHT_MESSAGE",e[e.BOSS_PILL_TOP_MESSAGE=1805]="BOSS_PILL_TOP_MESSAGE",e[e.BOSS_PILL_APPEAR_MESSAGE=1806]="BOSS_PILL_APPEAR_MESSAGE",e[e.VIP_ROLL_PLATE=3100]="VIP_ROLL_PLATE",e[e.ROLL_PLATE_REWARD=3101]="ROLL_PLATE_REWARD",e[e.VERIFY_GIFT=3201]="VERIFY_GIFT",e[e.FULING_MESSAGE=3301]="FULING_MESSAGE",e[e.YUANJIE_MESSAGE=3302]="YUANJIE_MESSAGE",e[e.RUNE_WEAR=3351]="RUNE_WEAR",e[e.RUNE_COMPOS=3352]="RUNE_COMPOS",e[e.RUNE_COMPOSE_QUICK=3353]="RUNE_COMPOSE_QUICK",e[e.CROSS_CONSUMERANK=3010]="CROSS_CONSUMERANK",e[e.ACT_TUANGOU_MESSAGE=3011]="ACT_TUANGOU_MESSAGE",e[e.ACT_CROSS_PAYRANK=3012]="ACT_CROSS_PAYRANK",e[e.ACT_LABA_MESSAGE=3015]="ACT_LABA_MESSAGE",e[e.ACT_LABA_RANK_MESSAGE=3016]="ACT_LABA_RANK_MESSAGE",e[e.ACT_FEAST_GET_MESSAGE=3017]="ACT_FEAST_GET_MESSAGE",e[e.ACT_FEAST_RUN_MESSAGE=3018]="ACT_FEAST_RUN_MESSAGE",e[e.ACT_666_LABA_MESSAGE=3019]="ACT_666_LABA_MESSAGE",e[e.ACT_666_RANK_MESSAGE=3020]="ACT_666_RANK_MESSAGE",e[e.WUTAN_INFO_GET_MESSAGE=3550]="WUTAN_INFO_GET_MESSAGE",e[e.WUTAN_LIST_GET_MESSAGE=3551]="WUTAN_LIST_GET_MESSAGE",e[e.WUTAN_FIGHT_MESSAGE=3552]="WUTAN_FIGHT_MESSAGE",e[e.WUTAN_BUY_MESSAGE=3553]="WUTAN_BUY_MESSAGE",e[e.WUTAN_HEART_MESSAGE=3554]="WUTAN_HEART_MESSAGE",e[e.ZHANGONG_INFO_GET_MESSAGE=3651]="ZHANGONG_INFO_GET_MESSAGE",e[e.MARRIAGE_AD_MESSAGE=3701]="MARRIAGE_AD_MESSAGE",e[e.MARRIAGE_APPLY_MESSAGE=3702]="MARRIAGE_APPLY_MESSAGE",e[e.MARRIAGE_AD_LIST_MESSAGE=3703]="MARRIAGE_AD_LIST_MESSAGE",e[e.MARRIAGE_DIVORCE_MESSAGE=3704]="MARRIAGE_DIVORCE_MESSAGE",e[e.MARRIAGE_DIVORCE_APPLY_MESSAGE=3705]="MARRIAGE_DIVORCE_APPLY_MESSAGE",e[e.MARRIAGE_TREE_UP_MESSAGE=3706]="MARRIAGE_TREE_UP_MESSAGE",e[e.MARRIAGE_RING_UP_MESSAGE=3707]="MARRIAGE_RING_UP_MESSAGE",e[e.MARRIAGE_TREE_EXP_RECEIVE_MESSAGE=3708]="MARRIAGE_TREE_EXP_RECEIVE_MESSAGE",e[e.MARRIAGE_TREE_EXP_MESSAGE=3709]="MARRIAGE_TREE_EXP_MESSAGE",e[e.MARRIAGE_PARTNER_INFO_MESSAGE=3710]="MARRIAGE_PARTNER_INFO_MESSAGE",e[e.MARRIAGE_EQUIP_LEVELUP_MESSAGE=3711]="MARRIAGE_EQUIP_LEVELUP_MESSAGE",e[e.STRONGER_ACT=3601]="STRONGER_ACT"
}(MESSAGE_ID||(MESSAGE_ID={}));var MessageErrorManager=function(){function e(){this.requsetFailTimes=0}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.errorMsgHandler=function(e){var t=MESSAGE_ERROR.AGAIN;switch(e){case MESSAGE_ID.GAME_LOGON_MESSAGE:case MESSAGE_ID.SELECT_SERVER_MESSAGE:case MESSAGE_ID.LOGIN_SERVER_MESSAGE:case MESSAGE_ID.CREATE_ROLE_MESSAGE:case MESSAGE_ID.ENTER_GAME_MESSAGE:case MESSAGE_ID.PLAYER_MESSAGE:t=MESSAGE_ERROR.CLOSE}return t},e}();__reflect(MessageErrorManager.prototype,"MessageErrorManager");var MESSAGE_ERROR;!function(e){e[e.CLOSE=0]="CLOSE",e[e.CONUTINE=1]="CONUTINE",e[e.AGAIN=2]="AGAIN"}(MESSAGE_ERROR||(MESSAGE_ERROR={}));var MessageReceive=function(){function e(e){this.gameWorld=e}return e.prototype.receiveMessage=function(e){var t=e.getCmdId();switch(t){case MESSAGE_ID.GAME_TICK_MESSAGE:var n=e.getBoolean();n||this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_4);break;case MESSAGE_ID.GAME_LOGON_MESSAGE:this.gameWorld.dispatchEvent(new GameMessageEvent(MESSAGE_ID.GAME_LOGON_MESSAGE.toString(),e));break;case MESSAGE_ID.SELECT_SERVER_MESSAGE:this.gameWorld.dispatchEvent(new GameMessageEvent(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),e));break;case MESSAGE_ID.LOGIN_SERVER_MESSAGE:var a=e.getBoolean();a?this.gameWorld.enterGame():(this.gameWorld.createRole(),DataManager.getInstance().serverManager.isCreateRole=!0);break;case MESSAGE_ID.CREATE_ROLE_MESSAGE:this.gameWorld.enterGame();break;case MESSAGE_ID.ENTER_GAME_MESSAGE:this.gameWorld.loginRecord(DataManager.getInstance().playerManager.player),this.gameWorld.reciveEnterGameMsg(),DataManager.getInstance().serverManager.onLoginSDKStatistics();break;case MESSAGE_ID.PLAYER_MESSAGE:DataManager.getInstance().playerManager.player.parsePlayerMessage(e);break;case MESSAGE_ID.PAIHANGBANG_ZAOYUBANG_MESSAGE:DataManager.getInstance().topRankManager.topzaoyulistdate(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OFFLINE_EXP_REWARD:DataManager.getInstance().playerManager.parseOffLineExp(e);break;case MESSAGE_ID.PASS_SCENE_REWARD:DataManager.getInstance().playerManager.parsePassSceneUpdate(e);break;case MESSAGE_ID.RECEIVE_ONLINE_GIFT:DataManager.getInstance().playerManager.player.onlineGift=e.getByte(),DataManager.getInstance().playerManager.player.onlineGiftTime=e.getInt(),DataManager.getInstance().playerManager.player.onlineGiftTimeStamp=egret.getTimer(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN));break;case MESSAGE_ID.GAME_FIGHT_START_MSG:this.gameWorld.dispatchEvent(new GameMessageEvent(e.getCmdId().toString(),e));break;case MESSAGE_ID.GAME_FIGHT_RESULT_MSG:this.gameWorld.dispatchEvent(new GameMessageEvent(e.getCmdId().toString(),e));break;case MESSAGE_ID.OPEN_PLAYER_MESSAGE:DataManager.getInstance().playerManager.parseOpenRole(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE:DataManager.getInstance().playerManager.parsePlayerHead(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OPT_PLAYER_HEAD_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseHeadUp(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE:DataManager.getInstance().playerManager.player.name=e.getString(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE:DataManager.getInstance().playerManager.parsePlayerHeadFrame(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseHeadFrameUp(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_CURRENCY_UPDATE:DataManager.getInstance().playerManager.parseCurrencyMsg(e);break;case MESSAGE_ID.PLAYER_EXP_UPDATE:DataManager.getInstance().playerManager.parseExp(e);break;case MESSAGE_ID.OFFLINE_EXP_SHARE_COMPLETE:DataManager.getInstance().playerManager.parseOffLineAwardMsg(e);break;case MESSAGE_ID.REPEAT_LOGIN_MESSAGE:this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_2);break;case MESSAGE_ID.LOGIN_BAN_MESSAGE:this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_6);break;case MESSAGE_ID.GOODS_LIST_MESSAGE:DataManager.getInstance().bagManager.parseInitBag(e);break;case MESSAGE_ID.GOODS_LIST_ADD_MESSAGE:DataManager.getInstance().bagManager.parseAddBag(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GOODS_LIST_USE_MESSAGE:DataManager.getInstance().bagManager.praseRemoveBag(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE:DataManager.getInstance().playerManager.parseClothEquip(e);break;case MESSAGE_ID.GOODS_ARTIFACT_EQUIP_MESSAGE:DataManager.getInstance().playerManager.parseArtifactEquip(e),DataManager.getInstance().playerManager.player.updataAttribute(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FUNCTION_REWARD_MESSAGE:DataManager.getInstance().playerManager.parseFuncAwardedMsg(e);break;case MESSAGE_ID.WXGAME_INVITE_FRIEND_MSG:DataManager.getInstance().wxgameManager.parseInviteFriendMsg(e);break;case MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE:DataManager.getInstance().wxgameManager.parseShareAwdLevelMsg(e);break;case MESSAGE_ID.XYX_IOS_CHARGE_MESSAGE:GameCommon.getInstance().addAlert("支付成功");var i=e.getShort(),o=e.getString(),r={goodsName:"IOS充值"+i,amount:i,playerInfo:DataManager.getInstance().playerManager.player};SDKManager.onPaySuccess(r,o);break;case MESSAGE_ID.XYX_COLLECTION_MESSAGE:DataManager.getInstance().wxgameManager.parseCollectionAwardMsg(e);break;case MESSAGE_ID.USE_LADDER_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().arenaManager.ladderArenaData.fightCount+=s,PromptPanel.getInstance().addPromptError("您已增加挑战天梯"+s+"次");break;case MESSAGE_ID.USE_EXPLORE_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().dupManager.explorebossInfo.lifeNum+=s,PromptPanel.getInstance().addPromptError("您已增加探索"+s+"次");break;case MESSAGE_ID.USE_ESCORT_PASS_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().escortManager.escort.count-=s,PromptPanel.getInstance().addPromptError("您已增加渡魂"+s+"次");break;case MESSAGE_ID.USE_ESCORT_ROB_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().escortManager.escort.rob-=s,PromptPanel.getInstance().addPromptError("您已增加渡魂劫杀"+s+"次");break;case MESSAGE_ID.USE_BOSS_DEKARON_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().dupManager.worldbossEnjoyNum+=s,PromptPanel.getInstance().addPromptError("您已增加Boss挑战"+s+"次");break;case MESSAGE_ID.GOODS_LIMIT_LIST_MESSAGE:DataManager.getInstance().timeGoodsManager.parseTimeGoodsList(e);break;case MESSAGE_ID.GOODS_LIMIT_ADD_MESSAGE:DataManager.getInstance().timeGoodsManager.parseTimeGoods(e);break;case MESSAGE_ID.USE_ARENA_ORDER_MESSAGE:var s=e.getByte();DataManager.getInstance().arenaManager.arenaData.fightCount-=s,PromptPanel.getInstance().addPromptError("您已增加竞技场挑战"+s+"次"),GameCommon.getInstance().receiveMsgToClient(new Message(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE));break;case MESSAGE_ID.FOURINAGE_UPLEVEL_MESSAGE:DataManager.getInstance().playerManager.player.updateFourinageLevel(e);break;case MESSAGE_ID.FOURINAGE_UPUPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.updateFourinageGrade(e);break;case MESSAGE_ID.TITLE_LIST_MESSAGE:DataManager.getInstance().titleManager.parseList(e);break;case MESSAGE_ID.TITLE_WEAR_MESSAGE:DataManager.getInstance().titleManager.parseWear(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TITLE_JIHUO_MESSAGE:DataManager.getInstance().playerManager.player.onParseTitle(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TUJIAN_MESSAGE:DataManager.getInstance().playerManager.player.parsrTujian(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.XINFA_TUJIAN_MESSAGE:DataManager.getInstance().playerManager.player.updateXinfa(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GAME_FIGHT_DUP_ENTER:this.gameWorld.dispatchEvent(new GameMessageEvent(e.getCmdId().toString(),e));break;case MESSAGE_ID.GAME_FIGHT_DUP_RESULT:this.gameWorld.dispatchEvent(new GameMessageEvent(e.getCmdId().toString(),e));break;case MESSAGE_ID.GAME_DUP_INFO_MESSAGE:DataManager.getInstance().dupManager.parseDupinfo(e);break;case MESSAGE_ID.GAME_DUP_BUYNUM_MESSAGE:case MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE:DataManager.getInstance().dupManager.parseDupSweepNum(e);break;case MESSAGE_ID.GAME_SIXIANG_PROGRESS_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GAME_SIXIANG_REWARD_MSG:DataManager.getInstance().dupManager.parseFourinageAwardMsg(e);break;case MESSAGE_ID.GAME_BLESSDUP_REWARD_MSG:DataManager.getInstance().dupManager.parseBlessDupAwardMsg(e);break;case MESSAGE_ID.ERROR_TIP_MESSAGE:GameCommon.getInstance().addHintBar(e);break;case MESSAGE_ID.SKILL_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseSkillUp(e);break;case MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE:DataManager.getInstance().skillEnhantM.parseSkinMsg(e);break;case MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE:DataManager.getInstance().skillEnhantM.parseGradeMsg(e);break;case MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE:DataManager.getInstance().skillEnhantM.parseLevelMsg(e);break;case MESSAGE_ID.GONGFA_DATE_MESSAGE:break;case MESSAGE_ID.SKILL_UP_AUTO_MESSAGE:DataManager.getInstance().playerManager.player.parseSkillUpAuto(e);break;case MESSAGE_ID.SKILL_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.updateGradeSkill(e);break;case MESSAGE_ID.BLESS_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessInfo(e);break;case MESSAGE_ID.BLESS_EQUIP_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessEquip(e);break;case MESSAGE_ID.BLESS_EQUIP_SLOT_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessEquipSlot(e);break;case MESSAGE_ID.BLESS_UP_SKILL_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessSkill(e);break;case MESSAGE_ID.BLESS_UP_DAN_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessDan(e);break;case MESSAGE_ID.BLESS_WAKE_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseBlessJuexing(e);break;case MESSAGE_ID.HUANHUA_ACTIVATE_MESSMAGE:var h=e.getByte();DataManager.getInstance().playerManager.player.updateHuanhuaInfo(h),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.HUANHUA_CHANGE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SHENTONG_INIT_BAG_MESSAGE:DataManager.getInstance().shentongManager.onParseInitBagMsg(e);break;case MESSAGE_ID.SHENTONG_LOTTERY_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SHENTONG_ADD_MESSAGE:DataManager.getInstance().shentongManager.onParseAddBagMsg(e);break;case MESSAGE_ID.SHENTONG_REMOVE_MESSAGE:DataManager.getInstance().shentongManager.onParseRemoveBagMsg(e);break;case MESSAGE_ID.SHENTONG_INIT_SLOT_MESSAGE:DataManager.getInstance().shentongManager.onParseInitSlotMsg(e);break;case MESSAGE_ID.SHENTONG_LEARN_MESSAGE:DataManager.getInstance().shentongManager.onParseUpdateSlotMsg(e);break;case MESSAGE_ID.SHENTONG_UPLEVEL_MESSAGE:DataManager.getInstance().shentongManager.parseLevelUpMsg(e);break;case MESSAGE_ID.SHENTONG_UPGRADE_MESSAGE:DataManager.getInstance().shentongManager.parseUpgradeMsg(e);break;case MESSAGE_ID.PLAYER_INFUSE_SOUL_MESSAGE:DataManager.getInstance().playerManager.player.parseInfuseSoul(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_ZHUHUN_MESSAGE:DataManager.getInstance().playerManager.player.parseZhunHun(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_INTENSIFY_MESSAGE:DataManager.getInstance().playerManager.player.parseIntensify(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_SMELT_SPECIAL_MESSAGE:DataManager.getInstance().bagManager.parseUpdateBag(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_SMELT_COMMON_MESSAGE:DataManager.getInstance().bagManager.parseUpdateBag(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE:DataManager.getInstance().playerManager.player.parseLegendActivate(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.parseLegendUpdate(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_PULSE_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.parsePulseUpdate(e),GameCommon.getInstance().receiveMsgToClient(e,l);break;case MESSAGE_ID.PLAYER_QIHUN_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.parseQihun(e),GameCommon.getInstance().receiveMsgToClient(e,l);break;case MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE:DataManager.getInstance().arenaManager.parseLadderAreneMsg(e);break;case MESSAGE_ID.ARENE_LADDERARENE_FIGHT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_LADDERARENE_RESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_LADDERARENE_RANK_MESSAGE:DataManager.getInstance().arenaManager.parseLadderRankUpdate(e);break;case MESSAGE_ID.ARENE_LADDERARENE_INSPIRE_MESSAGE:DataManager.getInstance().arenaManager.parseInspire(e);break;case MESSAGE_ID.ARENE_CROSS_INFO_UPDATE_MESSAGE:DataManager.getInstance().arenaManager.parseArenaMsg(e);break;case MESSAGE_ID.ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE:DataManager.getInstance().arenaManager.parseArenaEnemyMsg(e);break;case MESSAGE_ID.ARENE_CROSS_FIGHT_ENTER_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_CROSS_WORSHIP_MESSAGE:DataManager.getInstance().arenaManager.isWorship=e.getBoolean(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_CROSS_RANK_UPDATE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_CROSS_RANK_HISTROY_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE:DataManager.getInstance().arenaManager.parseArenaBuyMsg(e);break;case MESSAGE_ID.ARENE_INFO_UPDATE_MESSAGE:DataManager.getInstance().localArenaManager.parseArenaMsg(e);break;case MESSAGE_ID.ARENE_REFRESH_ENEMYLIST_MESSAGE:DataManager.getInstance().localArenaManager.parseArenaEnemyMsg(e);break;case MESSAGE_ID.ARENE_FIGHT_ENTER_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_RANK_UPDATE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_FIGHT_RESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARENE_BUY_FIGHTCOUNT_MESSAGE:DataManager.getInstance().localArenaManager.parseArenaBuyMsg(e);break;case MESSAGE_ID.ARENA_BATTLE_SWEEP:DataManager.getInstance().localArenaManager.parseArenaFightMsg(e);break;case MESSAGE_ID.ARENE_FIRST_AWARD_MESSAGE:DataManager.getInstance().localArenaManager.parseFirstAwardMsg(e);break;case MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE:var l=e.getByte();GameCommon.getInstance().receiveMsgToClient(e,l);break;case MESSAGE_ID.TASK_CHAIN_UPDATE_MESSAGE:DataManager.getInstance().taskManager.parseTaskChainMsg(e);break;case MESSAGE_ID.TASK_DAILY_INIT_MESSAGE:DataManager.getInstance().taskManager.parseTaskDailyInitMsg(e);break;case MESSAGE_ID.TASK_DAILY_UPDATE_MESSAGE:DataManager.getInstance().taskManager.parseTaskDailyUpdateMsg(e);break;case MESSAGE_ID.JIANCHI_INFO_UPDATE_MESSAGE:DataManager.getInstance().playerManager.player.parseJianchiUpdate(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.XYX_SHARE_EXP_MESSAGE:DataManager.getInstance().playerManager.parseTianshiAwardMsg(e);break;case MESSAGE_ID.XYX_SHARE_MASTER_MESSAGE:DataManager.getInstance().playerManager.parseTianshiActivateMsg(e);break;case MESSAGE_ID.SHARE_INFO_MESSAGE:DataManager.getInstance().functionManager.parseShareInfo(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FOCUS_REWARD_MESSAGE:DataManager.getInstance().functionManager.parseFocusInfo(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAIL_MESSAGE:DataManager.getInstance().mailManager.parseMail(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAIL_READ_MESSAGE:DataManager.getInstance().mailManager.parseMailRead(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_MESSAGE:DataManager.getInstance().mailManager.parseMailAccessory(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE:DataManager.getInstance().mailManager.parseMailAccessoryAll(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAIL_NEW_MESSAGE:DataManager.getInstance().mailManager.parseMailNew(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_CHAT_RECEIVE_MESSAGE:DataManager.getInstance().chatManager.parseChatRecord(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE:DataManager.getInstance().chatManager.parseChatNew(e);break;case MESSAGE_ID.PLAYER_BROADCAST_MESSAGE:var g=e.getByte();DataManager.getInstance().broadcastManager.parseBroadcast(e,g),GameCommon.getInstance().receiveMsgToClient(e,g);break;case MESSAGE_ID.XUEZHAN_INIT_MESSAGE:DataManager.getInstance().dupManager.parseXuezhanInitMsg(e);break;case MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.XUEZHAN_RESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.XUEZHAN_BUFF_MESSAGE:DataManager.getInstance().dupManager.parseXuezhanBuffMsg(e);break;case MESSAGE_ID.XUEZHAN_REWARD_MESSAGE:DataManager.getInstance().dupManager.parseXuezhanRewardMsg(e);break;case MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE:DataManager.getInstance().dupManager.parseXuezhanSaodangMsg(e);break;case MESSAGE_ID.XUEZHANBOSS_LISTINFO_MSG:DataManager.getInstance().dupManager.parseXuezhanBossInfoMsg(e);break;case MESSAGE_ID.VIPBOSS_LISTINFO_MSG:DataManager.getInstance().dupManager.parseVipBossInfoMsg(e);break;case MESSAGE_ID.ALLPEOPLE_BOSS_LISTINFO_MSG:DataManager.getInstance().dupManager.parseAllPeopleBossMsg(e);break;case MESSAGE_ID.ALLPEOPLE_REBORN_NOTICE_MSG:DataManager.getInstance().dupManager.onRemindAllPeopleBoss(e);break;case MESSAGE_ID.ALLPEOPLE_DEAD_MSG:DataManager.getInstance().dupManager.onAllPeopleBossDead(e);break;case MESSAGE_ID.ALLPEOPLE_FT_MSG:DataManager.getInstance().dupManager.onAllPeopleBossFT(e);break;case MESSAGE_ID.XUEZHANBOSS_REBORN_NOTICE_MSG:DataManager.getInstance().dupManager.onRemindXuezhanBoss(e);break;case MESSAGE_ID.VIPBOSS_REBORN_NOTICE_MSG:DataManager.getInstance().dupManager.onRemindVIPBoss(e);break;case MESSAGE_ID.ALLPEOPLE_OTHERBODY_MSG:case MESSAGE_ID.XUEZHANBOSS_OTHERBODY_MSG:case MESSAGE_ID.VIPBOSS_OTHERBODY_MSG:case MESSAGE_ID.BOSS_PILL_APPEAR_MESSAGE:DataManager.getInstance().dupManager.parseAllPeopleOtherFightMsg(e);break;case MESSAGE_ID.ALLPEOPLE_BOSS_ENTER_MSG:case MESSAGE_ID.ALLPEOPLE_FIGHT_UPDATE_MSG:case MESSAGE_ID.ALLPEOPLE_RANK_INFO_MSG:case MESSAGE_ID.ALLPEOPLE_BOSS_RESULT_MSG:case MESSAGE_ID.XUEZHANBOSS_ENTER_MSG:case MESSAGE_ID.XUEZHANBOSS_FIGHT_UPDATE_MSG:case MESSAGE_ID.XUEZHANBOSS_RANK_INFO_MSG:case MESSAGE_ID.XUEZHANBOSS_RESULT_MSG:case MESSAGE_ID.ALLPEOPLE_PK_MESSAGE:case MESSAGE_ID.ALLPEOPLE_PVP_REVIVE:case MESSAGE_ID.XUEZHANBOSS_OTHERPK_MSG:case MESSAGE_ID.XUEZHANBOSS_REBORN_MSG:case MESSAGE_ID.VIPBOSS_ENTER_MSG:case MESSAGE_ID.VIPBOSS_FIGHT_UPDATE_MSG:case MESSAGE_ID.VIPBOSS_RANK_INFO_MSG:case MESSAGE_ID.VIPBOSS_RESULT_MSG:case MESSAGE_ID.VIPBOSS_OTHERPK_MSG:case MESSAGE_ID.VIPBOSS_REBORN_MSG:case MESSAGE_ID.BOSS_PILL_START_MESSAGE:case MESSAGE_ID.BOSS_PILL_REWARD_MESSAGE:case MESSAGE_ID.BOSS_PILL_FIGHT_MESSAGE:case MESSAGE_ID.BOSS_PILL_TOP_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ALLPEOPLE_SET_REMIND_MSG:DataManager.getInstance().dupManager.parseAllPeopleRemindMsg(e);break;case MESSAGE_ID.SAMSARA_BOSS_LISTINFO_MSG:DataManager.getInstance().dupManager.parseSamsareBossInfoMsg(e);break;case MESSAGE_ID.SAMSARA_BOSS_FIGHT_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_ENTER_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_TARGET_MSG:GameFight.getInstance().samsaraTargetMsg=e,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_RANK_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_OTHERBODY_MSG:DataManager.getInstance().dupManager.parseSamsaraBossOhterFightMsg(e);break;case MESSAGE_ID.SAMSARA_BOSS_KILLLOG_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TEAMDUP_CREATETEAM_MESSAGE:DataManager.getInstance().dupManager.onJoinRoomSeccuss();break;case MESSAGE_ID.TEAMDUP_JOINTEAM_MESSAGE:DataManager.getInstance().dupManager.onJoinRoomSeccuss();break;case MESSAGE_ID.TEAMDUP_LEAVETEAM_MESSAGE:GameFight.getInstance().isteamdupReady=!1;break;case MESSAGE_ID.TEAMDUP_READYINFO_MESSAGE:case MESSAGE_ID.TEAMDUP_TEAMDAMAGE_MESSAGE:case MESSAGE_ID.TEAMDUP_DROPGOODS_MESSAGE:case MESSAGE_ID.TEAMDUP_QUITSCENE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YEWAIPVP_FIGHTTER_INFO_MSG:DataManager.getInstance().yewaipvpManager.onParsePVPOhterInfoMsg(e);break;case MESSAGE_ID.SAMSARA_BOSS_REBORN_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_OTHERLEAVE_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SAMSARA_BOSS_REMIND_MSG:DataManager.getInstance().dupManager.onRemindSamsaraBoss();break;case MESSAGE_ID.YEWAIPVP_FIGHT_LOG_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YEWAIPVP_FIGHT_PK_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YEWAIPVP_FIHGT_RESULT_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_BOSS_INIT:DataManager.getInstance().dupManager.parseWorldBossInfo(e);break;case MESSAGE_ID.EXPLOREBOSS_BOSS_FIGHTENTER:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_BOSS_FIGHTRESULT:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_BOSS_RANK:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_LIFE_MSG:DataManager.getInstance().dupManager.parseExploreInfo(e);break;case MESSAGE_ID.EXPLOREBOSS_ENTER_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_EXPLORETASK_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_FINISH_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EXPLOREBOSS_LEAVE_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_PSYCH_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.onParsePsychEquip(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_PSYCH_EQUIP_MESSAGE:DataManager.getInstance().playerManager.player.onParsePsychEquip(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_PSYCH_GAIN_MESSAGE:DataManager.getInstance().psychManager.parsePsychGain(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_PSYCH_DECOMPOSE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_DETAIL_MESSAGE:DataManager.getInstance().escortManager.parseEscort(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_DISPATCH_MESSAGE:DataManager.getInstance().escortManager.parseDispatchMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_ROB_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_REVENGE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_REVENGE_RESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_REFRESH_QUALITY_MESSAGE:DataManager.getInstance().escortManager.parseRefreshQualityMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_ROBLIST_MESSAGE:DataManager.getInstance().escortManager.parseRobListMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_ROB_RESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_ESCORT_DONE:DataManager.getInstance().escortManager.parseAward(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_ESCORT_RECORD:DataManager.getInstance().escortManager.parseRecord(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_REDPOINT_MESSAGE:DataManager.getInstance().escortManager.parseRedPoint(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE:DataManager.getInstance().escortManager.parseReceiveAward(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ORANGE_RES_MESSAGE:case MESSAGE_ID.CELESTIAL_DECOMPOSE_MESSAGE:DataManager.getInstance().bagManager.parseUpdateMasterBag(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GEM_LOTTERY_MESSAGE:DataManager.getInstance().forgeManager.onParseGemLottery(e);break;case MESSAGE_ID.GEM_LOTTERY_LOGS_MESSAGE:DataManager.getInstance().forgeManager.onParseLotteryLog(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_INFO_MESSAGE:DataManager.getInstance().unionManager.parseUnionInfoMsg(e);break;case MESSAGE_ID.UNION_LIST_MESSAGE:DataManager.getInstance().unionManager.parseUnionListMsg(e);break;case MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE:DataManager.getInstance().unionManager.parseUnionMemberMsg(e);break;case MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE:DataManager.getInstance().unionManager.parseUnionXuanyanMsg(e);break;case MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE:DataManager.getInstance().unionManager.parseUnionNoticeMsg(e);break;case MESSAGE_ID.UNION_CHANGE_LVLIMIT_MESSAGE:DataManager.getInstance().unionManager.parseUnionLevelLimitMsg(e);break;case MESSAGE_ID.UNION_CHANGE_AUTOADOPT_MESSAGE:DataManager.getInstance().unionManager.parseUnionAutoAdoptMsg(e);break;case MESSAGE_ID.UNION_QUIT_MESSAGE:DataManager.getInstance().unionManager.onDestroyUnionInfo(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_REVIEW_AGREE_ALL:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MYSTERIOUS_BOSS_INFO:DataManager.getInstance().unionManager.parseSummonMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT_INFO:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_MYSTERIOUS_TARGET_MESSAGE:GameFight.getInstance().mysteriousTargetMsg=e,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_MYSTERIOUS_TOP_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_MYSTERIOUS_REVIVE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_MYSTERIOUS_QUIT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MYSTERIOUS_BOSS_OTHERBODY_MSG:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_TRIBUTE_MESSAGE:DataManager.getInstance().unionManager.parseUnionTribute(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_POSTION_MESSAGE:DataManager.getInstance().unionManager.parsePostionUpdateMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE:DataManager.getInstance().unionManager.parseDeleteMember(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_TURNPLATE_FILT_MESSAGE:DataManager.getInstance().unionManager.parseRunALotteryMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_SKILL2_UPGRADE_MESSAGE:DataManager.getInstance().unionManager.parseUpdateUnionSkill2(e);break;case MESSAGE_ID.UNION_LOG_MESSAGE:DataManager.getInstance().unionManager.parseUnionLog(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE:DataManager.getInstance().unionManager.onParseUnionPrizeRecord(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_TASK_MESSAGE:DataManager.getInstance().unionManager.onParseUnionTaskMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_TASK_UPDATE_MESSAGE:DataManager.getInstance().unionManager.onParseTaskUpdateMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BOSS_INFO_MESSAGE:DataManager.getInstance().unionManager.onParseUnionBossInfo(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_DUP_REWARD_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_DUP_RANK_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_DUP_ZHUWEI_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BOSS_LIST_MESSAGE:DataManager.getInstance().unionManager.onParseUnionBossList(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BOSS_FIGHT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BOSS_RESUTL_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE:DataManager.getInstance().unionManager.onParseUnionGroupInfoMsg(e);break;case MESSAGE_ID.UNION_BATTLE_ENJOIN_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BATTLE_FIGHT_MESSAGE:GameFight.getInstance().unionbattlePkMsg=e,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BATTLE_FIGHTRESULT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BATTLE_ALLOT_MESSAGE:var c=e.getByte();1==c&&GameCommon.getInstance().addAlert("分配成功"),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE:DataManager.getInstance().unionManager.onParseUnionDepotMsg(e);break;case MESSAGE_ID.UNION_BATTLE_RANK_MESSAGE:DataManager.getInstance().unionManager.onParseUnionBattleRankMsg(e);break;case MESSAGE_ID.UNION_BATTLE_BUYBUFF_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.UPDATE_BAG_UPPERLIMIT:DataManager.getInstance().bagManager.parseUpperlimit(e);break;case MESSAGE_ID.UPDATA_BAG_USELIMIT:DataManager.getInstance().playerManager.player.remainExchageVigourTime=e.getByte(),DataManager.getInstance().bagManager.parseUselimit(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GEM_INLAY_MESSAGE:break;case MESSAGE_ID.GEM_SYNTHETIC_MESSAGE:DataManager.getInstance().gemManager.parseSynthetic(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GEM_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.parseGemInlay(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SPATBLOOD_BUY_MESSAGE:DataManager.getInstance().spatBloodsManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ONEREBATEST_BUY_MESSAGE:DataManager.getInstance().oneRebateSTManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ONEREBATEST_RECEIVE_MESSAGE:DataManager.getInstance().oneRebateSTManager.parseReceiveMessage(e),GameCommon.getInstance().receiveMsgToClient(e);
break;case MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE:DataManager.getInstance().playerManager.player.parseCoatard(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIGOUR_EXCHANGE_MESSAGE:DataManager.getInstance().rebirthManager.onParseVigourExchange(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DOMINATE_UPGRADE_MESSAGE:DataManager.getInstance().dominateManager.onParseDominateUpgrade(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DOMINATE_ADVANCE_MESSAGE:DataManager.getInstance().dominateManager.onParseDominateAdvance(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DOMINATE_DECOMPOSE_MESSAGE:DataManager.getInstance().dominateManager.onParseDecompose(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FASHION_ACTIVE_MESSAGE:DataManager.getInstance().playerManager.player.parseFashionctive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FASHION_SHOW_MESSAGE:DataManager.getInstance().playerManager.player.parseFasionShow(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FASHION_UPLEVEL_MESSAGE:DataManager.getInstance().playerManager.player.parseFashionLvUp(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAGIC_MESSAGE:DataManager.getInstance().magicManager.onParseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAGIC_UPGRADE_MESSAGE:DataManager.getInstance().magicManager.onParseUpdateMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAGIC_ADVANCE_MESSAGE:DataManager.getInstance().magicManager.onParseAdvanceMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_MAGIC_TURNPLATE_MESSAGE:DataManager.getInstance().magicManager.onParseTurnplateMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CELESTIAL_COMPOUND_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CELESTIAL_UPGRADE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_CONSUMEITEM_MESSAGE:DataManager.getInstance().totalConsumeManager.parseMessage(e);break;case MESSAGE_ID.WAREHOUSE_TAKEOUT_MESSAGE:DataManager.getInstance().celestialManager.onParseTakeOutMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TREASURE_CELESTIAL_MEESAGE:DataManager.getInstance().celestialManager.onParseCelestiaTreasure(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TREASURE_WEEK_AWARD_MESSAGE:DataManager.getInstance().celestialManager.onParseTreasureWeekAwardMsg(e);break;case MESSAGE_ID.TREASURE_CELESTIAL_LOG_MEESAGE:DataManager.getInstance().celestialManager.onParseCelestiaTreasureLog(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WAREHOUSE_MESSAGE:DataManager.getInstance().celestialManager.onParseWarehouseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE:DataManager.getInstance().friendManager.onParseFriendList(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_FRIEND_APPLYNEW_MESSAGE:DataManager.getInstance().friendManager.onParseNewApply(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_FRIEND_SEARCH_MESSAGE:DataManager.getInstance().friendManager.onParseSearch(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.EQUIPSLOT_QUENCHING_MESSAGE:DataManager.getInstance().playerManager.player.parseQuenching(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_UPDATE_MESSAGE:DataManager.getInstance().playerManager.player.onParsePetUpdate(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.onParsePetUpgrade(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_LOTTERY_LOG_MESSAGE:DataManager.getInstance().petManager.onParsePetLogMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_TRAIN_RANDOM_MESSAGE:DataManager.getInstance().petManager.parseRandomValue(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_DAN_MESSAGE:DataManager.getInstance().playerManager.player.parsePetDanChange(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PET_TRAIN_CHANGE_MESSAGE:DataManager.getInstance().playerManager.player.parsePetChange(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TEST_FIGHTING_MESSAGE:break;case MESSAGE_ID.TIMEOUT_MESSAGE:this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_3);break;case MESSAGE_ID.ACTIVITY_MESSAGE:DataManager.getInstance().activityManager.parseMessage(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN)),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_SEVDAY_MESSAGE:DataManager.getInstance().sevenDayCarnivalManager.parseSevDayInfo(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE:DataManager.getInstance().sevenDayCarnivalManager.parseSevDayLoginReceive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE:DataManager.getInstance().sevenDayCarnivalManager.parseSevDayObjectiveReceive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_COATARD_REWARD:DataManager.getInstance().playerManager.parseCoatardRewardMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_MONTHCARD_MESSAGE:DataManager.getInstance().monthCardManager.parseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GAME_TOPRANK_INFO_MESSAGE:DataManager.getInstance().topRankManager.parseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.OTHER_MESSAGE:DataManager.getInstance().topRankManager.otherMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE:DataManager.getInstance().topRankManager.parseSimpleMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.RECHAREG_RECORD_MESSAGE:DataManager.getInstance().rechargeManager.parseMessage(e),DataManager.getInstance().newactivitysManager.payToday=!0,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DAILY_WELFARE_MESSAGE:DataManager.getInstance().welfareManager.parseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.REBATE_TO_BUY_MESSAGE:var p=e.getInt();switch(p){case ACTIVITY_BRANCH_TYPE.TEHUILIBAO:DataManager.getInstance().newactivitysManager.parseBuyMessage(e);break;case ACTIVITY_BRANCH_TYPE.WUYITEHUILIBAO:DataManager.getInstance().festivalWuYiManager.onParseLiBao(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_FAVORABLE:case ACTIVITY_BRANCH_TYPE.WEEKEND_FAVORABLE:case ACTIVITY_BRANCH_TYPE.FESTIVAL_FAVORABLE2:DataManager.getInstance().festivalFavorableManager.onPraseBuyMessage(e,p)}GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.XIANGOULIBAO_BUY_MESSAGE:DataManager.getInstance().newactivitysManager.parseBuyxiangouMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CHONGJILIBAO_BUY_MESSAGE:DataManager.getInstance().newactivitysManager.parseBuychongjiMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DABIAOJIANGLI_BUY_MESSAGE:DataManager.getInstance().newactivitysManager.parseBuydabiaoMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.DABIAOPAIHANG_DATE_MESSAGE:DataManager.getInstance().newactivitysManager.parsedabiaopaihangMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YAOQIANSHU_YAOQIAN:DataManager.getInstance().newactivitysManager.yaoqianshuyaoqian(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YAOQIANSHU_LINGJIANG:DataManager.getInstance().newactivitysManager.parseyaoqianshulingjiang(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TREASURE_RANK_LIST_MESSAGE:DataManager.getInstance().treasureRankManager.parseTreasureRankMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SIGN_REWARD_MESSAGE:DataManager.getInstance().newactivitysManager.parseSignEveryDay(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIP_XIANGOULIBAO_BUY_MESSAGE:DataManager.getInstance().newactivitysManager.parseBuyVipxiangouMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ZHIZUN_XIANGOULIBAO_BUY_MESSAGE:DataManager.getInstance().newactivitysManager.parseBuyzhizunxiangouMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.INVEST_TO_BUY_MESSAGE:DataManager.getInstance().investManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.INVEST_TO_OBTAIN_MESSAGE:DataManager.getInstance().investManager.parseObtainMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TURNPLATE_FILT_MESSAGE:DataManager.getInstance().turnplateManager.parseRunALotteryMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TLSHOP_TO_BUY_MESSAGE:DataManager.getInstance().tLShopManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_SHENMISHOP_GOODS_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_SHENMISHOP_BUY_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE:DataManager.getInstance().shopManager.onParseDiscountMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.LOGON_REWARD_MESSAGE:DataManager.getInstance().newactivitysManager.parseLogonAdd(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.LIMIT_SIGN_REWARD_MESSAGE:DataManager.getInstance().newactivitysManager.parseLogonLimit(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TLGIFT_TO_OBTAIN_MESSAGE:DataManager.getInstance().tLGiftManager.parseObtainMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TOPRANK_GIFT_MESSAGE:DataManager.getInstance().tOPRankGiftManager.parseMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIPTLGIFT_TO_BUY_MESSAGE:DataManager.getInstance().vipTLGiftManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIPTLSHOP_TO_BUY_MESSAGE:DataManager.getInstance().vipTLShopManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CASHCOW_LOTTERY_MESSAGE:DataManager.getInstance().springActivityManager.onParseCrashcowLottery(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TLDOGZ_EXCHANGE_MESSAGE:DataManager.getInstance().tLDogzManager.parseExchangeMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.COLLECTWORD_EXCHANGE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.SPRINGTLSHOP_TO_BUY_MESSAGE:DataManager.getInstance().springTLShopManager.parseBuyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE:DataManager.getInstance().festivalWuYiManager.onParseCelestiaTreasureLog(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE:DataManager.getInstance().festivalWuYiManager.onParseZhuanPanMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WISHINGWELL_ADVANCE_MESSAGE:DataManager.getInstance().wishingWellManager.onParseAdvanceMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE:case MESSAGE_ID.WEEKEND_LOGIN_AWARD_RECEIVE:DataManager.getInstance().festivalLoginManager.onParseLoginAwardReceive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FESTIVAL_LIMIT_PURCHASE_BUY:case MESSAGE_ID.WEEKEND_LIMIT_PURCHASE_BUY:break;case MESSAGE_ID.FESTIVAL_WISHING_WELL_MESSAGE:DataManager.getInstance().festivalWishingwellManager.onParseAdvanceMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FESTIVAL_TARGET_AWARD_RECEIVE:case MESSAGE_ID.PAY_TARGET_AWARD_RECEIVE:DataManager.getInstance().festivalTargetManager.onParseTargetAwardReceive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FESTIVAL_TARGET_RANKLIST_MESSAGE:case MESSAGE_ID.PAY_TARGET_RANKLIST_MESSAGE:DataManager.getInstance().festivalTargetManager.onParseTargetRankList(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PLAYCAFE_EXCLUSIVE_AWARD_RECEIVE:DataManager.getInstance().playCafeManager.onParseLoginAwardReceive(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACTIVITY_FUDAI_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_MESSAGE:break;case MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK:DataManager.getInstance().festivalWuYiManager.parseZhuanpanRankMsg(e);break;case MESSAGE_ID.FESTIVAL_MISSION_ACT_UPDATE:DataManager.getInstance().festivalWuYiManager.parseLiuyiMissonUpdate(e);break;case MESSAGE_ID.FESTIVAL_MISSION_ACT_REWARD:DataManager.getInstance().festivalWuYiManager.parseLiuyiMissonUpdate(e,1);break;case MESSAGE_ID.ACTIVITY_XIANFENG:DataManager.getInstance().newactivitysManager.parseXianFeng(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.HEFU_ACT_MISSION_UPDATE:DataManager.getInstance().hefuActManager.parseHefuiMissonUpdate(e);break;case MESSAGE_ID.HEFU_ACT_MISSION_REWARD:DataManager.getInstance().hefuActManager.parseHefuiMissonUpdate(e,1);break;case MESSAGE_ID.ARTIFACT_ROLL_PLATE:DataManager.getInstance().shenqiZhuanPanManager.onParseZhuanPanMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE:DataManager.getInstance().shenqiZhuanPanManager.parseZhuanpanRankMsg(e);break;case MESSAGE_ID.BROADCAST_ARTIFACT_ROLL_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.HEFU_ACT_TURNPLATE_LOTTERY_MESSAGE:DataManager.getInstance().hefuActManager.onParseZhuanPanMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.HEFU_ACT_TURNPLATE_LOTTERY_RANK_MSG:DataManager.getInstance().hefuActManager.parseZhuanpanRankMsg(e);break;case MESSAGE_ID.HEFU_ACT_INVESTTURNPLATE_MESSAGE:DataManager.getInstance().hefuActManager.onParseCelestiaTreasureLog(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WANBA_DESK_INFO_MESSAGE:DataManager.getInstance().playerManager.player.sendDesk=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WANBA_GIFT_MESSAGE:DataManager.getInstance().playerManager.player.giftState=e.getByte();for(var u=[],d=e.getByte(),_=0;d>_;++_){var m=new AwardItem;m.type=e.getByte(),m.id=e.getShort(),m.quality=e.getByte(),m.num=e.getInt(),m.quality=m.type==GOODS_TYPE.MASTER_EQUIP||m.type==GOODS_TYPE.SERVANT_EQUIP?m.quality:-1,u.push(m)}DataManager.getInstance().playerManager.player.giftReward=u,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"WanbaGiftPanel");break;case MESSAGE_ID.REBIRTH_TASK_INIT_MSG:DataManager.getInstance().taskManager.parseInitCoatardTaskMsg(e);break;case MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG:DataManager.getInstance().taskManager.parseUpdateCoatardTaskMsg(e);break;case MESSAGE_ID.REBIRTH_TASK_LV_MSG:DataManager.getInstance().playerManager.player.chengjiuLvDict[e.getShort()]=1,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.LONGHUN_RANDOM:DataManager.getInstance().dragonSoulManager.parseRandomValue(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.LONGHUN_CHANGE:DataManager.getInstance().playerManager.player.parseLonghunChange(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WUXING_UP:DataManager.getInstance().playerManager.player.parseWuxing(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FATE_LOTTERY_MESSAGE:DataManager.getInstance().playerManager.player.fateIndex=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FATE_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.player.onParseFateUpgrade(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FATE_ACTIVE_MESSAGE:DataManager.getInstance().playerManager.player.onParseFateEquipRefresh(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FATE_REWARD_MESSAGE:DataManager.getInstance().fateManager.parseFateGain(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ROLL_PLATE_REWARD:DataManager.getInstance().vipManager.onParseZhuanPanGetAwardNum(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIP_ROLL_PLATE:DataManager.getInstance().vipManager.onParseZhuanPanMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VERIFY_GIFT:DataManager.getInstance().playerManager.parseVerifyMessage(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE:DataManager.getInstance().playerManager.parseTianshuLevelUpMsg(e);break;case MESSAGE_ID.TIANSHU_UPGRADE_MESSAGE:DataManager.getInstance().playerManager.parseTianshuUpgradeMsg(e);break;case MESSAGE_ID.PILL_ROLL_MESSAGE:DataManager.getInstance().xiandanManager.parseXianDanGain(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PILL_USE_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PILL_MESSAGE:DataManager.getInstance().playerManager.player.riviseXianDan(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.PILL_HIDE_BOSS_MESSAGE:DataManager.getInstance().xiandanManager.parseBossState(e),DataManager.getInstance().dupManager.onChangeXianShanBossList(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ONLINE_BOSS_MESSAGE:DataManager.getInstance().xiandanManager.parseBossSize(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ENERGY_MESSAGE:DataManager.getInstance().xiandanManager.energy=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.BOSS_PILL_INFO_MESSAGE:DataManager.getInstance().dupManager.parseXianShanBossInfoMsg(e);break;case MESSAGE_ID.BOSS_PILL_QUIT_MESSAGE:DataManager.getInstance().dupManager.onRemindXuezhanBoss(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ENERGY_GIFT:DataManager.getInstance().friendManager.onParseCaoYaoSend(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ENERGY_GIFT_RECEIVE:DataManager.getInstance().friendManager.onParseCaoYaoGet(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ENERGY_GIFT_NOTIFY:DataManager.getInstance().friendManager.onParseCaoYaoRefresh(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CROSS_PVEBOSS_INFO_MESSAGE:DataManager.getInstance().dupManager.parseCrossPVEBossInfo(e);break;case MESSAGE_ID.CROSS_PVEBOSS_COUNTBUY_MESSAGE:DataManager.getInstance().dupManager.parseCrossPVEBossBuy(e);break;case MESSAGE_ID.CROSS_PVEBOSS_FIGHT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.CROSS_PVEBOSS_RANK_MESSAGE:DataManager.getInstance().dupManager.parseCrossPVEBossRank(e);break;case MESSAGE_ID.VIPGOD_ARTIFACT_ACTIVATE_MESSAGE:DataManager.getInstance().legendManager.updateVipGodArtifact(e.getByte(),1),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.VIPGOD_ARTIFACT_UPGRADE_MESSAGE:DataManager.getInstance().legendManager.updateVipGodArtifact(e.getByte(),e.getShort()),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FULING_MESSAGE:DataManager.getInstance().playerManager.player.parseFuling(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.YUANJIE_MESSAGE:DataManager.getInstance().playerManager.player.parseYuanjie(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.RUNE_WEAR:case MESSAGE_ID.RUNE_COMPOSE_QUICK:DataManager.getInstance().playerManager.player.onParseRunesMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.RUNE_COMPOS:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WUTAN_INFO_GET_MESSAGE:DataManager.getInstance().wuTanManager.parseInfo(e);break;case MESSAGE_ID.WUTAN_LIST_GET_MESSAGE:DataManager.getInstance().wuTanManager.parseList(e);break;case MESSAGE_ID.WUTAN_FIGHT_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.WUTAN_BUY_MESSAGE:DataManager.getInstance().wuTanManager.parseBuy(e);break;case MESSAGE_ID.WUTAN_HEART_MESSAGE:DataManager.getInstance().wuTanManager.parseRefresh(e);break;case MESSAGE_ID.ACT_TUANGOU_MESSAGE:DataManager.getInstance().tuangouActManager.parseTuangouMsg(e);break;case MESSAGE_ID.ACT_LABA_MESSAGE:DataManager.getInstance().labaManager.parseLaba(e);break;case MESSAGE_ID.ACT_FEAST_GET_MESSAGE:DataManager.getInstance().zqManager.parseGet(e);break;case MESSAGE_ID.ACT_FEAST_RUN_MESSAGE:DataManager.getInstance().zqManager.parseRun(e);break;case MESSAGE_ID.ACT_666_LABA_MESSAGE:DataManager.getInstance().a666Manager.parseLaba(e);break;case MESSAGE_ID.ACT_666_RANK_MESSAGE:DataManager.getInstance().a666Manager.parseLabaRank(e);break;case MESSAGE_ID.ZHANGONG_INFO_GET_MESSAGE:DataManager.getInstance().pvpManager.parseMsg(e);break;case MESSAGE_ID.FASHIONSETL_ACT_MESSAGE:var E=e.getByte();DataManager.getInstance().playerManager.player.getPlayerData(E).taozhuangDict[e.getShort()]=1,DataManager.getInstance().playerManager.player.updataAttribute(!0),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.FASHIONSETL_UPLV_MESSAGE:DataManager.getInstance().playerManager.player.parseFashionEtl(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_AD_MESSAGE:GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE:DataManager.getInstance().marryManager.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_APPLY_MESSAGE:DataManager.getInstance().playerManager.player.marriId=e.getInt(),DataManager.getInstance().marryManager.marryId=DataManager.getInstance().playerManager.player.marriId,GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_RING_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseRingLevelup(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE:DataManager.getInstance().marryManager.parseMsgDivorce(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_DIVORCE_APPLY_MESSAGE:DataManager.getInstance().marryManager.parseMsgAgreeDivorce(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_TREE_UP_MESSAGE:DataManager.getInstance().playerManager.player.parseMarrayTree(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_TREE_EXP_RECEIVE_MESSAGE:DataManager.getInstance().playerManager.player.parseMarrayTree(e),DataManager.getInstance().playerManager.player.marriedTreeExp=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_TREE_EXP_MESSAGE:DataManager.getInstance().playerManager.player.marriedTreeExp=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_PARTNER_INFO_MESSAGE:DataManager.getInstance().marryManager.partnerId=e.getInt(),DataManager.getInstance().marryManager.partnerName=e.getString(),DataManager.getInstance().marryManager.partnerHead=e.getByte(),DataManager.getInstance().marryManager.partnerHeadIndex=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE:DataManager.getInstance().playerManager.player.parseMarryEquipSuitLevelup(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.STRONGER_ACT:DataManager.getInstance().playerManager.player.parseStronger(e),GameCommon.getInstance().receiveMsgToClient(e);break;case MESSAGE_ID.ACT_RONGLIAN_DUIHUAN:DataManager.getInstance().activitySmeltManager.parseUpdateMsg(e)}DataManager.getInstance().redPointManager.onCheck(t),0!=MessageErrorManager.getInstance().requsetFailTimes&&(MessageErrorManager.getInstance().requsetFailTimes=0)},e}();__reflect(MessageReceive.prototype,"MessageReceive");var RetinueBody=function(e){function t(){var t=e.call(this)||this;return t.onHideHeadBar(!1),t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){egret.superSetter(t,this,"data",e)},enumerable:!0,configurable:!0}),t.prototype.onResetHeadInfo=function(){e.prototype.onResetHeadInfo.call(this)},t.prototype.onRefreshData=function(){e.prototype.onRefreshData.call(this)},t.prototype.updateAction=function(){e.prototype.updateAction.call(this),this.onChangeBody(),this.onChangeMountBody(),this.onChangeWeaponBody(),this.onChangeWingBody(),this.onChangeFabaoBody(),this.refreshLayer()},t.prototype.refreshLayer=function(){var e;this._mountBody&&!this._mountBody.parent&&(this.addLayerOrder(this._mountBody,1),this._mountBody.y=-50),this._body&&(e=[3,4,4,4,3],this.addLayerOrder(this._body,e[this.direction-1]),this._body.y=-50),this._weaponBody&&(e=[4,3,2,2,2],this.addLayerOrder(this._weaponBody,e[this.direction-1]),this._weaponBody.y=-50),this._wingBody&&(e=[2,2,3,3,4],this.addLayerOrder(this._wingBody,e[this.direction-1]),this._wingBody.y=-50),this._fabaoBody&&!this._fabaoBody.parent&&this.addLayerOrder(this._fabaoBody,5)},t.prototype.onChangeBody=function(){if(this.data&&this.data.cloth_res){var e=this.actionName,t=LoadManager.getInstance().getRetinueClothResUrl(this.data.cloth_res,e,this.getDirectionFrame());this._body?this._body.onUpdateRes(t,this._actionPlayNum,this.getDirectionFrame()):(this._body=new BodyAnimation(t,this._actionPlayNum,this.getDirectionFrame()),this._body.visible=this._bodyVisible)}else this._body&&(this._body.onDestroy(),this._body=null)},t.prototype.onChangeWeaponBody=function(){if(this.data&&this.data.weapon_res){var e=this.actionName,t=LoadManager.getInstance().getRetinueWeaponResUrl(this.data.weapon_res,e,this.getDirectionFrame());this._weaponBody?this._weaponBody.onUpdateRes(t,this._actionPlayNum,this.getDirectionFrame()):(this._weaponBody=new BodyAnimation(t,this._actionPlayNum,this.getDirectionFrame()),this._weaponBody.visible=this._bodyVisible)}else this._weaponBody&&(this._weaponBody.onDestroy(),this._weaponBody=null)},t.prototype.onChangeMountBody=function(){},t.prototype.onChangeWingBody=function(){if(this.data&&this.data.wing_res){var e="ride_stand",t=LoadManager.getInstance().getRetinueWingResUrl(this.data.wing_res,e,this.getDirectionFrame());this._wingBody?this._wingBody.onUpdateRes(t,-1,this.getDirectionFrame()):(this._wingBody=new BodyAnimation(t,-1,this.getDirectionFrame()),this._wingBody.visible=this._bodyVisible)}else this._wingBody&&(this._wingBody.onDestroy(),this._wingBody=null)},t.prototype.onChangeFabaoBody=function(){if(this.data&&this.data.magic_res){var e="stand",t=LoadManager.getInstance().getRetinueMagicResUrl(this.data.magic_res,e);this._fabaoBody?this._fabaoBody.onUpdateRes(t,-1,null):(this._fabaoBody=new BodyAnimation(t,-1,null),this._fabaoBody.x=-60,this._fabaoBody.y=-150,this._fabaoBody.visible=this._bodyVisible)}else this._fabaoBody&&(this._fabaoBody.onDestroy(),this._fabaoBody=null)},t.prototype.onUpdateHeadPos=function(){this.data},Object.defineProperty(t.prototype,"mountType",{get:function(){return MOUNT_TYPE.RIDE_MOUNT},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleStandAction",{get:function(){return"ride_stand"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleMoveAction",{get:function(){return"ride_walk"},enumerable:!0,configurable:!0}),t.prototype.setFollowPaths=function(e){this.setMove(e),this._isfollow=!0},Object.defineProperty(t.prototype,"isfollow",{get:function(){return this._isfollow},enumerable:!0,configurable:!0}),t.prototype.onAttack=function(){e.prototype.onAttack.call(this),this._isfollow=!1},Object.defineProperty(t.prototype,"bodyVisible",{set:function(e){egret.superSetter(PlayerBody,this,"bodyVisible",e),this._body&&(this._body.visible=e),this._weaponBody&&(this._weaponBody.visible=e),this._mountBody&&(this._mountBody.visible=e),this._wingBody&&(this._wingBody.visible=e),this._fabaoBody&&(this._fabaoBody.visible=e),this.onshoworhideShodow(e)},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._weaponBody&&(this._weaponBody.onDestroy(),this._weaponBody=null),this._mountBody&&(this._mountBody.onDestroy(),this._mountBody=null),this._wingBody&&(this._wingBody.onDestroy(),this._wingBody=null),this._fabaoBody&&(this._fabaoBody.onDestroy(),this._fabaoBody=null)},t.prototype.onReset=function(){e.prototype.onReset.call(this)},t}(ActionBody);__reflect(RetinueBody.prototype,"RetinueBody");var RoleAppearBody=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.updateAvatarAnim=function(e,t){var n="",a=e[BLESS_TYPE.HORSE];n=LoadManager.getInstance().getFeijianUrl("jian"+a,"stand",Direction.RIGHTDOWN+""),this._mountBody?this._mountBody.onUpdateRes(n,-1,null):(this._mountBody=new BodyAnimation(n,-1,Direction.RIGHTDOWN+""),this.addChildAt(this._mountBody,0));var i=e[BLESS_TYPE.WING];i>=0&&(n=LoadManager.getInstance().getWingResUrl("wing"+i,"ride_stand",Direction.DOWN+""),this._wingBody?this._wingBody.onUpdateRes(n,0,null):(this._wingBody=new BodyAnimation(n,-1,Direction.DOWN),this._wingBody.y=-45,this.addChildAt(this._wingBody,1)));var o=e[BLESS_TYPE.WEAPON];n=LoadManager.getInstance().getWeaponResUrl("weapon"+o,t==SEX_TYPE.MALE?"standNan":"stand",Direction.DOWN+""),this._weaponBody?this._weaponBody.onUpdateRes(n,-1,null):(this._weaponBody=new BodyAnimation(n,-1,Direction.DOWN+""),this._weaponBody.y=-45,this.addChildAt(this._weaponBody,2));var r=e[BLESS_TYPE.CLOTHES];n=LoadManager.getInstance().getClothResUrl("r"+t+"_cloth"+r,"stand",Direction.DOWN+""),this._body?this._body.onUpdateRes(n,-1,null):(this._body=new BodyAnimation(n,-1,Direction.DOWN+""),this._body.y=-45,this.addChildAt(this._body,3))},t}(egret.DisplayObjectContainer);__reflect(RoleAppearBody.prototype,"RoleAppearBody");var Modelmount=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(JsonModelTemplet);__reflect(Modelmount.prototype,"Modelmount");var ModelManager=function(){function e(){this.JOSN_GID={},this.allModelsHashMap={},this.init()}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(){this.JOSN_GID.baoshi="postion",this.JOSN_GID.lianhua="type",this.JOSN_GID.ronghun="postion",this.JOSN_GID.mount="type",this.JOSN_GID.story="stage",this.JOSN_GID.chongwu="id",this.JOSN_GID.mountEqianghua="postion",this.JOSN_GID.sixiang="postion",this.JOSN_GID.sixiangjinjie="postion",this.JOSN_GID.skilltupo="skillId",this.JOSN_GID.shanggutaozhuang="position",this.JOSN_GID.shenqi="id",this.JOSN_GID.guildSkill="id",this.JOSN_GID.tianshenzhuangbei="coatardLv",this.JOSN_GID.fabaojinjie="jieduan",this.JOSN_GID.fabaoshengji="Lv",this.JOSN_GID.qianghuadashi="type",this.JOSN_GID.tujiantaozhuang="type",this.JOSN_GID.chongwujinjie="jieduan",this.JOSN_GID.mounttaozhuang="type",this.JOSN_GID.chengjiuMubiao="type"},e.prototype.getModelFigher=function(e){if(this._modelfighterDict||(this._modelfighterDict={}),!this._modelfighterDict[e]){var t=Tool.readZipToJson("fighter.json"),n=t[e.toString()];if(n){if(!this._fighterNodeDataType){this._fighterNodeDataType={};for(var a in n){var i=n[a];Tool.stringIsNum(i)?this._fighterNodeDataType[a]="Int":this._fighterNodeDataType[a]="String"}}var o=new Modelfighter(n);for(var a in this._fighterNodeDataType){var i=n[a];i="Int"==this._fighterNodeDataType[a]?parseInt(i):"*"==i?"":i,o[a]=i
}this._modelfighterDict[e]=o}}return this._modelfighterDict[e]},e.prototype.getModelMount=function(e,t,n){if(!(e>=BLESS_TYPE.SIZE)){this._modelmountDict||(this._modelmountDict={}),this._modelmountDict[e]||(this._modelmountDict[e]={});var a=t+"_"+n,i="mount"+e+".json";if(!this._modelmountDict[e][a]){var o=Tool.readZipToJson(i),r=o[a];if(r){if(!this._mountNodeDataType){this._mountNodeDataType={};for(var s in r){var h=r[s];Tool.stringIsNum(h)?this._mountNodeDataType[s]="Int":this._mountNodeDataType[s]="String"}}var l=new Modelmount(r);for(var s in this._mountNodeDataType){var h=r[s];h="Int"==this._mountNodeDataType[s]?parseInt(h):"*"==h?"":h,l[s]=h}this._modelmountDict[e][a]=l}}return this._modelmountDict[e][a]}},e.prototype.onCreateModelHashMap=function(e){var t;if(!this.allModelsHashMap[e]){this.allModelsHashMap[e]={};var n=this.allModelsHashMap[e],a=Tool.readZipToJson(e+".json"),i=this.JOSN_GID[e];this.allModelsHashMap[e+"_Lenth"]=i?{}:0;var o=void 0,r=0;for(var s in a){var h=a[s],l=new JsonModelTemplet(h);if(!t){t={};for(var g in h){var c=h[g];Tool.stringIsNum(c)?t[g]="Int":t[g]="String"}}for(var g in t){var c=h[g];c="Int"==t[g]?parseInt(c):"*"==c?"":c,l[g]=c}o="ID"!=i&&"Id"!=i&&"id"!=i?l.id:null,i&&null!=l[i]?(n[l[i]]||(n[l[i]]={},r=0),o=o?o:r,r++,n[l[i]][o]=l,this.allModelsHashMap[e+"_Lenth"]=r):(o=o?o:r,n[o]=l,r++,this.allModelsHashMap[e+"_Lenth"]=r)}}return this.allModelsHashMap[e]},e.prototype.getModelLength=function(e){return this.allModelsHashMap[e+"_Lenth"]||this.onCreateModelHashMap(e),this.allModelsHashMap[e+"_Lenth"]},e.prototype.parseXmlToModel=function(e,t,n,a){if(void 0===a&&(a=!1),e&&t&&n){var i=RES.getRes(n),o=0;e instanceof Array&&(o=1);for(var r=0;r<i.children.length;++r){var s=new t;if(s.parseXML(i.children[r]),a)e.push(s),e[s.id]=s;else switch(o){case 0:e[s.id]=s;break;case 1:e.push(s)}}}else Tool.throwException()},e}();__reflect(ModelManager.prototype,"ModelManager");var ModelMapNode=function(e){function t(){var t=e.call(this)||this;return t.areaIndex=0,t.findnode=new FindNode,t}return __extends(t,e),t.prototype.parseXML=function(e){this.id=this.getXmlValueNumber(e,"id"),this.nodeId=this.getXmlValueNumber(e,"id"),this.nodeType=this.getXmlValueNumber(e,"type"),this.areaIndex=this.getXmlValue(e,"area")},Object.defineProperty(t.prototype,"isCanWalk",{get:function(){return this.nodeType!=MAP_GRID_TYPE.COLLSION},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCover",{get:function(){return this.nodeType==MAP_GRID_TYPE.COVER},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJump",{get:function(){return this.nodeType==MAP_GRID_TYPE.JUMP?!0:!1},enumerable:!0,configurable:!0}),t}(ModelBase);__reflect(ModelMapNode.prototype,"ModelMapNode");var FindNode=function(){function e(){}return e.prototype.onreset=function(){this.parentnodeId=null,this.gValue=null,this.hValue=null},e}();__reflect(FindNode.prototype,"FindNode");var ModelThing=function(){function e(e,t){this._quality=0,this._occupation=-1,this._model=e,this._type=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._model.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attrAry",{get:function(){return this._model.attrAry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._model.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._model.icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropicon",{get:function(){return this._model.Dropicon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rewards",{get:function(){return this._model.rewards},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._model.quality?this._model.quality:this._model.pinzhi?this._model.pinzhi:this._quality},set:function(e){this._quality=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._model.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coatardLv",{get:function(){return this._model.coatardLv||this._model.jieduan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"des",{get:function(){return this._model.des},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useful",{get:function(){return this._model.useful},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gotype",{get:function(){return this._model.gotype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tujing",{get:function(){if(!this._fromTujings&&""!=String(this._model.tujing)){this._fromTujings=[];for(var e=String(this._model.tujing).split(","),t=0;t<e.length;t++){var n=parseInt(e[t]);n>0&&this._fromTujings.push(n)}}return this._fromTujings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"part",{get:function(){return this._model.position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"occupation",{get:function(){return isNaN(this._model.occupation)?this._occupation:this._model.occupation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appearance",{get:function(){return this._model.Appearance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equipAttr",{get:function(){var e=[];if(this.type==GOODS_TYPE.MASTER_EQUIP)for(var t=GoodsDefine.EQUIP_QUALITY_ADDRATE[this.quality],n=0;n<ATTR_TYPE.SIZE;n++){var a=Math.floor(this.attrAry[n]*t);e[n]=a}else for(var n=0;n<ATTR_TYPE.SIZE;n++)e[n]=this.attrAry[n];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pingfenValue",{get:function(){return GameCommon.calculationFighting(this.equipAttr)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effct",{get:function(){return GameCommon.getInstance().onParseAttributeStr(this._model.effct)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addEffect",{get:function(){return GameCommon.getInstance().onParseAttributeStr(this._model.addEffect)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"next",{get:function(){return this._model.next},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cost",{get:function(){return this._model.cost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"costNum",{get:function(){return this._model.costNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"limitTime",{get:function(){return this._model.lastTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jieduan",{get:function(){return this._model.jieduan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blesstype",{get:function(){return this._model.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"starNum",{get:function(){return this._model.star},enumerable:!0,configurable:!0}),e}();__reflect(ModelThing.prototype,"ModelThing");var AwardItem=function(){function e(e,t,n,a,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=-1),void 0===a&&(a=-1),void 0===i&&(i=0),this.num=-1,this.lv=0,this.uid=0,this.type=e,this.id=t,this.num=n,this.quality=a,this.lv=i}return e.prototype.parseMessage=function(e){this.type=e.getByte(),this.id=e.getShort(),this.quality=e.getByte(),this.num=e.getInt()},Object.defineProperty(e.prototype,"idKey",{get:function(){return this.type+"_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thingbase",{get:function(){return new ThingBase(this.type,this.id,this.num)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thingmodel",{get:function(){return null},enumerable:!0,configurable:!0}),e}();__reflect(AwardItem.prototype,"AwardItem");var ModelYewaiWave=function(e){function t(){var t=e.call(this)||this;return t.monterFightNodes=[],t}return __extends(t,e),t.prototype.parseXML=function(e){this.id=this.getXmlValueNumber(e,"id");for(var t=String(this.getXmlValue(e,"point")).split(","),n=0;n<t.length;n++)this.monterFightNodes.push(parseInt(t[n]))},t}(ModelBase);__reflect(ModelYewaiWave.prototype,"ModelYewaiWave");var HttpManager=function(){function e(e){this.gameWorld=e,this.recvMsg=new Message}return e.prototype.reLogin=function(){this.url=SDKManager.loginInfo.url,this.gameWorld.sendLogin()},e.prototype.sendMessage=function(e){100!=e.getCmdId()&&Tool.log("发送消息："+e.getCmdId()),e.isCheckLoading;var t=new egret.HttpRequest;t.Message=e,t.responseType=egret.HttpResponseType.ARRAY_BUFFER,t.open(this.url,egret.HttpMethod.POST),t.setRequestHeader("Content-Type","text/plain"),t.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.pack(),t.send(e.getMsg())},e.prototype.onGetComplete=function(e){var t=e.currentTarget;this.recvMsg.recvData(t.response);for(var n=null,a=0,i=0;i<this.recvMsg.getMessageSize();++i){var o=new Message,r=this.recvMsg.getMessage();if(!r)break;o.unpack(r),100!=o.getCmdId()&&Tool.log("接收消息："+o.getCmdId()),o.getCmdId()==MESSAGE_ID.GOODS_LIST_ADD_MESSAGE?(null==n?(n=o,n.newGoodsMessage()):n.joinMessage(o),++a):(null!=n&&(n.setGoodsSize(a),n.readPos(),this.gameWorld.receiveMessage(n),a=0,n=null),this.gameWorld.receiveMessage(o))}null!=n&&(n.setGoodsSize(a),n.readPos(),this.gameWorld.receiveMessage(n),a=0,n=null),this.onDestroyRequsetObj(t)},e.prototype.onGetIOError=function(e){var t=e.currentTarget,n=t.Message;if(n){var a=new egret.Event(GameEvent.NET_EVENT_ERROR);a.data=n,this.gameWorld.dispatchGameEvent(a),egret.log("get error msgID: "+n.getCmdId())}this.onDestroyRequsetObj(t)},e.prototype.onDestroyRequsetObj=function(e){e.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e=null},e.prototype.onGetProgress=function(e){Tool.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e.prototype.setUrl=function(e){this.url=e},e.prototype.sendRequest=function(e,t){var n=new XMLHttpRequest;n.open("POST",e),n.setRequestHeader("Content-Type","text/plain"),n.onreadystatechange=function(){if(4==n.readyState&&n.status>=200&&n.status<=207){var e=(n.statusText,n.responseText);e?Tool.log(e):Tool.log("response str is null")}else Tool.log("xhr.readyState == 4 && (xhr.status >= 200 && xhr.status <= 207) is false "),Tool.log("xhr.readyState: "+n.readyState),Tool.log("xhr.status: "+n.status),Tool.log("param: "+t.getCmdId()),Tool.log("=========================================")},t.pack(),n.send(t.getMsg())},e}();__reflect(HttpManager.prototype,"HttpManager");var Message=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=!0),this.posIndex=12,this.isCheckLoading=!0,this.isCheckRepeat=!0,this.isLogoned=!0,this.isLogoned=t,e>0&&(this.cmdId=e,this.msg=new ArrayBuffer(1024),this.data=new DataView(this.msg),this.data.setInt16(4,e)),this.isLogoned||(this.posIndex=6)}return e.prototype.inputData=function(){},e.prototype.getCmdId=function(){return this.cmdId},e.prototype.getMsg=function(){return this.msg},e.prototype.setBoolean=function(e){e?this.setByte(1):this.setByte(0)},e.prototype.setByte=function(e){this.data.setInt8(this.posIndex,e),this.posIndex+=1},e.prototype.setShort=function(e){this.data.setInt16(this.posIndex,e),this.posIndex+=2},e.prototype.setInt=function(e){this.data.setInt32(this.posIndex,e),this.posIndex+=4},e.prototype.setFloat=function(e){this.data.setFloat32(this.posIndex,e),this.posIndex+=4},e.prototype.setLong=function(e){this.data.setFloat64(this.posIndex,e),this.posIndex+=8},e.prototype.setString=function(e){e=encodeURIComponent(e);var t=e.length;this.setShort(t);for(var n=0;t>n;++n)this.setByte(e.charCodeAt(n))},e.prototype.setPlayerId=function(e){this.isLogoned&&this.data.setInt32(6,e)},e.prototype.setLoginCode=function(e){this.isLogoned&&this.data.setInt16(10,e)},e.prototype.pack=function(){this.data.setInt32(0,this.posIndex-4),this.msg=this.msg.slice(0,this.posIndex)},e.prototype.getBoolean=function(){return 1==this.getByte()?!0:!1},e.prototype.getByte=function(){var e=this.data.getInt8(this.posIndex);return this.posIndex+=1,e},e.prototype.getShort=function(){var e=this.data.getInt16(this.posIndex);return this.posIndex+=2,e},e.prototype.getInt=function(){var e=this.data.getInt32(this.posIndex);return this.posIndex+=4,e},e.prototype.getLong=function(){var e=this.data.getFloat64(this.posIndex);return this.posIndex+=8,e},e.prototype.getFloat=function(){var e=this.data.getFloat32(this.posIndex);return this.posIndex+=4,e},e.prototype.getString=function(){var e=this.getShort(),t=new Uint8Array(this.msg,this.posIndex,e);return this.posIndex+=e,this.Utf8ArrayToStr(t)},e.prototype.unpack=function(e){this.posIndex=0,this.msg=e,this.data=new DataView(this.msg),this.dataLength=this.getInt(),this.cmdId=this.getShort()},e.prototype.Utf8ArrayToStr=function(e){var t,n,a,i,o,r;for(t="",a=e.length,n=0;a>n;)switch(i=e[n++],i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(i);break;case 12:case 13:o=e[n++],t+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e[n++],r=e[n++],t+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&r)<<0)}return t},e.prototype.recvData=function(e){this.posIndex=0,this.msg=e,this.data=new DataView(this.msg),this.messageSize=this.getByte()},e.prototype.getMessage=function(){var e;if(this.data.byteLength>this.posIndex){var t=this.data.getInt32(this.posIndex);e=this.msg.slice(this.posIndex,this.posIndex+t),this.posIndex+=t}return e},e.prototype.getMessageSize=function(){return this.messageSize},e.prototype.getJoinDataLength=function(){return this.dataLength-6},e.prototype.readPos=function(){this.posIndex=5},e.prototype.setGoodsSize=function(e){this.data.setInt8(5,e)},e.prototype.joinMessage=function(e){for(var t=0;t<e.getJoinDataLength();++t)this.setByte(e.getByte())},e.prototype.newGoodsMessage=function(){for(var e=new ArrayBuffer(10240),t=new DataView(e),n=0;n<this.dataLength;++n)t.setInt8(n,this.data.getInt8(n));this.msg=e,this.data=t,this.posIndex=this.dataLength},e}();__reflect(Message.prototype,"Message");var RequestManager=function(){function e(e){this.gameWorld=e,this.list=[]}return e.prototype.start=function(){Tool.addTimer(this.gameRequestTimer,this,200)},e.prototype.addMessage=function(e){if(e.isCheckRepeat&&this.list.length>0){var t=this.list[this.list.length-1];if(t&&t.getCmdId()==e.getCmdId())return}this.list.push(e)},e.prototype.gameRequestTimer=function(e){if(this.list.length>0){var t=this.list.shift();t.inputData(),t.setPlayerId(DataManager.getInstance().playerManager.player.id),t.setLoginCode(DataManager.getInstance().playerManager.player.loginCode),this.gameWorld.httpManager.sendMessage(t)}},e}();__reflect(RequestManager.prototype,"RequestManager");var BodyManager=function(){function e(e){this._fightPause=!0,this.isShieldOhter=!1,this._magicMoveTime=0,this.pvp_showtime_stamp=0,this.Drop_Fly_Max=4,this._showanimCheckTime=0,this.cheackNodeColRadius=4,this.cheackNodeRowRadius=6,this._mainScene=e,this._otherPlayerBodys=[]}return e.prototype.onRefreshSence=function(){this._heroBodys=this._mainScene.heroBodys,this._mapInfo=this._mainScene.mapInfo,this.onDestroyAllHeroTarget(),this.onDestroyOtherBodys(),this.herowalkingEff&&this.herowalkingEff.parent&&(this.herowalkingEff.parent.removeChild(this.herowalkingEff),this.herowalkingEff.onStop()),this.pvp_showtime_stamp=0,this.play_ultimate_skill=!1},Object.defineProperty(e.prototype,"fightPause",{set:function(e){if(this._fightPause!=e&&(this._fightPause=e,e)){this.playStandForPlayer(this._mainScene.heroBody);for(var t=0;t<this._otherPlayerBodys.length;t++){var n=this._otherPlayerBodys[t];this.playStandForPlayer(n)}}},enumerable:!0,configurable:!0}),e.prototype.playStandForPlayer=function(e){if(e){e.setMove(null),e.onStand();for(var t=0;t<e.data.targets.length;t++){var n=e.data.targets[t];n.setMove(null),n.onStand()}e.petBody&&(e.petBody.setMove(null),e.petBody.onStand()),e.retinuebody&&(e.retinuebody.setMove(null),e.retinuebody.onStand()),e.magicbody&&e.magicbody.onStop()}},Object.defineProperty(e.prototype,"otherPlayerBodys",{get:function(){return this._otherPlayerBodys},enumerable:!0,configurable:!0}),e.prototype.onShieldOhterBody=function(e){this.isShieldOhter!=e&&(this.isShieldOhter=e,this.refreshShieldOtherBody())},e.prototype.refreshShieldOtherBody=function(){for(var e=0;e<this._otherPlayerBodys.length;e++){var t=this._otherPlayerBodys[e];this._mainScene.heroBody.data.targets.indexOf(t)<0&&(this._otherPlayerBodys[e].bodyVisible=!this.isShieldOhter)}},e.prototype.logicHandler=function(e){return this._fightPause||(this.onHeroLogic(e),this.onOhterBodyLogic(e),this.onMonsterLogic(e)),!1},e.prototype.onSceneEvnetMonster=function(e){var t=new RushEnemyData;t.monsterId=e;var n=this._mapInfo.getGridListByDistance(this._mapInfo.getNodeModelByXY(this._mainScene.heroBody.x,this._mainScene.heroBody.y),5);t.refreshGrid=n[Math.floor(Math.random()*n.length)].nodeId,t.refreshNum=3*Math.random()+6,this.onRushMonster(t,0,4,5),t=null},e.prototype.onRushNpcToScene=function(e,t,n){void 0===n&&(n=1);var a=this._mapInfo.getXYByGridIndex(e.refreshGrid),i=BodyFactory.instance.createMonsterBody(e.monsterId,BODY_TYPE.NPC);switch(i.data.eventType=t,t){case NPC_BODY_TYPE.JACKAROO1:case NPC_BODY_TYPE.JACKAROO2:case NPC_BODY_TYPE.JACKAROO3:i.onScaleHandler(n),i.onShowOrHideHpBar(!1),this._mainScene.heroBody.setMove([a]),this._mainScene.heroBody.moveSpeed=GameDefine.Jackaroo_Move_Speed;break;case NPC_BODY_TYPE.SIXIANG:}return this.addEmenyBodyToAry(i,a),i},e.prototype.onSceneEvnetCollection=function(e){var t,n=this._mapInfo.getNodeModelByIndex(this._mapInfo.getGridIndexByXY(this._mainScene.heroBody.x,this._mainScene.heroBody.y)),a=this._mapInfo.getGridNearByNode(n,4,4);t=a.length>0?this._mapInfo.getXYByGridIndex(a[Math.floor(Math.random()*a.length)].nodeId):new egret.Point(this._mainScene.heroBody.x,this._mainScene.heroBody.y);var i=BodyFactory.instance.createMonsterBody(e,BODY_TYPE.COLLECTION);i.data.eventParam=COLLECTION.Treasure,this.addEmenyBodyToAry(i,t)},e.prototype.onSceneEvnetPVP=function(){var e=GameFight.getInstance().onRandomCrateRobotData(5,8,"神秘玩家"),t=BodyFactory.instance.createPlayerBody(BODY_TYPE.ROBOT,e),n=this._mapInfo.getGridListByDistance(this._mapInfo.getNodeModelByXY(this._mainScene.heroBody.x,this._mainScene.heroBody.y),12),a=this._mapInfo.getXYByGridIndex(n[Math.floor(Math.random()*n.length)].nodeId);t.onAddEnemyBodyList(this._heroBodys),this.addEmenyBodyToAry(t,a)},e.prototype.onCreateOhterEnemyList=function(e,t,n,a){for(var i=this._mapInfo.getGridNearByNode(a,2,2),o=0;n>o;o++){var r=BodyFactory.instance.createMonsterBody(t,BODY_TYPE.MONSTER);r.isDamageFalse=!0;var s=GameDefine.Dir_All_Ary[Math.floor(GameDefine.Dir_All_Ary.length*Math.random())];r.direction=s;var h;h=i.length>0?this._mapInfo.getXYByGridIndex(i[Math.floor(Math.random()*i.length)].nodeId):new egret.Point(e.x,e.y),r.x=h.x,r.y=h.y;var l=FightDefine.getXgDeathCount();r.setDeathCount(l,l),this._mainScene.addBodyToMapLayer(r),e.onAddEnemyBodyList([r]),r.onAddEnemyBodyList([e])}},e.prototype.onTalkNpcResultHandler=function(e){},e.prototype.onTalkNpcTaskStart=function(e){switch(e.eventId){case TASK_EVENT.Monster_Fight:this.onSceneEvnetMonster(e.param);break;case TASK_EVENT.Treasure:this.onSceneEvnetCollection(e.param);break;case TASK_EVENT.PVP_Fight:this.onSceneEvnetPVP();break;case TASK_EVENT.Treasure_PVP:this.onSceneEvnetCollection(e.param);break;case TASK_EVENT.Talk:this.onCompleteNpcTask();break;default:this.onCompleteNpcTask()}this.currNpcEvnetData=e},e.prototype.onCompleteNpcTask=function(){return this.currNpcEvnetData?GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.EXPLORE_BOSS&&(this.onDestroyAllHeroTarget(),TASK_EVENT.Treasure_PVP==this.currNpcEvnetData.eventId)?(this.currNpcEvnetData.eventId=TASK_EVENT.PVP_Fight,void this.onTalkNpcResultHandler(this.currNpcEvnetData)):void(this.currNpcEvnetData=null):void 0},e.prototype.onFailNpcTask=function(){this.currNpcEvnetData&&(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.EXPLORE_BOSS&&this.onDestroyAllHeroTarget(),this.currNpcEvnetData=null)},e.prototype.onExploreBossOtherHandler=function(e){var t,n=10*Math.random(),a=this._mapInfo.getGridListByDistance(this._mapInfo.getNodeModelByXY(e.x,e.y),15);t=a[Math.floor(Math.random()*a.length)];var i;if(2>n)i=new egret.Point(e.x,e.y),Tool.removeArrayObj(this._otherPlayerBodys,e),Tool.callbackTime(function(e,t){this.addOtherBodyToScene(e,t)},this,10*Math.random()+10,e,i);else if(6>n)i=this._mapInfo.getXYByGridIndex(t.nodeId),e.setMove(this._mapInfo.findPointPath(e.x,e.y,i.x,i.y));else if(10>n){var o=GameDefine.Explore_Monsters[Math.floor(Math.random()*GameDefine.Explore_Monsters.length)];this.onCreateOhterEnemyList(e,o,2,t)}},e.prototype.onCreateFakerPlayerToSnece=function(e,t,n,a){if(n.length>0){var i=Math.floor(Math.random()*n.length),o=this._mapInfo.getGridRdXYByIndex(n[i].nodeId),r=GameFight.getInstance().onRandomCrateRobotData(e,t,a),s=BodyFactory.instance.createPlayerBody(BODY_TYPE.ROBOT,r);return s.direction=GameDefine.Dir_All_Ary[Math.floor(GameDefine.Dir_All_Ary.length*Math.random())],s.x=o.x,s.y=o.y,this.addOtherBodyToScene(s,o),n.splice(i,1),s}return null},e.prototype.onCreateOtherPlayer=function(e,t){var n=BodyFactory.instance.createPlayerBody(BODY_TYPE.PLAYER,e);return n.direction=GameDefine.Dir_All_Ary[Math.floor(GameDefine.Dir_All_Ary.length*Math.random())],this.setOtherPlayerPos(n,t),n},e.prototype.setOtherPlayerPos=function(e,t){if(t&&0!=t.length){var n=Math.floor(Math.random()*t.length),a=this._mapInfo.getGridRdXYByIndex(t[n].nodeId);e.x=a.x,e.y=a.y,this.addOtherBodyToScene(e,a),this.addPlayerRetinueToMap(e)}},e.prototype.onCreateMapBody=function(e,t,n,a){void 0===n&&(n=BODY_TYPE.MONSTER),void 0===a&&(a=!0);var i=Math.floor(Math.random()*t.length),o=this._mapInfo.getGridRdXYByIndex(t[i].nodeId),r=BodyFactory.instance.createMonsterBody(e,n);return a?this.addEmenyBodyToAry(r,o):(r.x=o.x,r.y=o.y,this._mainScene.addBodyToMapLayer(r)),r},e.prototype.onRushMonster=function(e,t,n,a){void 0===t&&(t=0),void 0===n&&(n=2),void 0===a&&(a=2),this.resetShowAnimCheckIndex();for(var i,o=this._mapInfo.getXYByGridIndex(e.refreshGrid),r=this._mapInfo.getNodeModelByXY(o.x,o.y),s=this._mapInfo.getGridNearByNode(r,n,a),h=0;h<e.refreshNum;h++){var l;if(e.isBoss)l=o,i=BodyFactory.instance.createMonsterBody(e.monsterId,BODY_TYPE.BOSS),i.direction=Direction.DOWN;else{i=BodyFactory.instance.createMonsterBody(e.monsterId,BODY_TYPE.MONSTER);var g=GameDefine.Dir_All_Ary[Math.floor(GameDefine.Dir_All_Ary.length*Math.random())];if(i.direction=g,s.length>0){var c=Math.floor(s.length*Math.random());r=s[c],l=this._mapInfo.getGridRdXYByIndex(r.nodeId),s.splice(c,1)}else if(this._mainScene.heroBody.data.targets.length>0){var p=this._mainScene.heroBody.data.targets[Math.floor(this._mainScene.heroBody.data.targets.length*Math.random())],u=this._mapInfo.getGridIndexByXY(p.x,p.y);l=this._mapInfo.getGridRdXYByIndex(u)}else l=o}t>0&&i.setDeathCount(t,t),this.addEmenyBodyToAry(i,l),l=null}},e.prototype.onInitAreraScene=function(e,t,n){var a=this._mainScene.heroBody,i=this._mapInfo.getGridRdXYByIndex(t);this._mainScene.setHeroMapPostion(i);for(var o,r=this._mapInfo.getNodeModelByIndex(n),s=0;s<e.length;s++){if(o=this.onCreateOtherPlayer(e[s],[r]),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.LODDER_ARENA)o.data.bodyType==BODY_TYPE.ROBOT&&(o.data.attributes[ATTR_TYPE.ATTACK]=100,o.setDeathCount(3,3));else if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAIPVP){var h=DataManager.getInstance().taskManager.guideTaskData;if(h.model&&!h.isFinish&&28==h.model.eventType){o.data.attributes[ATTR_TYPE.HP]=2*a.data.attributes[ATTR_TYPE.ATTACK],o.data.attributes[ATTR_TYPE.ATTACK]=100,o.data.attributes[ATTR_TYPE.PHYDEF]=o.data.attributes[ATTR_TYPE.MAGICDEF]=0;for(var l=0;l<o.data.skills.length;l++)o.data.updateSkillLevel(l,o.data.skills[l].level>0?1:0),o.data.updateSkillGrade(l,0);o.data.onRebirth()}}o.direction=Direction.RIGHT,this.addEmenyBodyToAry(o),o.onAddEnemyBodyList(this._heroBodys)}o&&(a.playChagre([new egret.Point(size.width/2+50,size.height/2+50)],!0),o.playChagre([new egret.Point(size.width/2-100,size.height/2-100)],!0))},e.prototype.onBodyMove=function(e){if(e.isMoving){var t=this._mapInfo.getNodeModelByXY(e.x,e.y);t&&(t.isCover?e.onSetCover(!0):e.onSetCover(!1)),e.onMove();var n=egret.is(e,"PlayerBody");if(n){var a=e;a.isChagre&&e.onCreateGhost()}}},e.prototype.onHerobodyTalkNpc=function(e){switch(e.data.eventType){case NPC_BODY_TYPE.JACKAROO1:GameFight.getInstance().onCheckStoyTalk();break;case NPC_BODY_TYPE.JACKAROO2:GameFight.getInstance().onCheckStoyTalk();var t=new RushEnemyData;t.monsterId=191,t.refreshGrid=359,this.onRushNpcToScene(t,NPC_BODY_TYPE.JACKAROO3)}e.data.eventParam=null},e.prototype.onHerobodyCollection=function(e){if(e.data.eventParam){e.data.eventParam==COLLECTION.Treasure&&e.onBodyWaiting(5e3,this.onCollectionComplete,this,"寻宝中.",skins.Collection_ProBarSkin);for(var t=0;t<this._heroBodys.length;t++)this._heroBodys[t].onStand();e.data.eventParam=null}},e.prototype.onCollectionComplete=function(){GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.EXPLORE_BOSS&&this.onCompleteNpcTask()},e.prototype.getBodyActionType=function(e){var t="";switch(e){case BODY_TYPE.PLAYER:case BODY_TYPE.ROBOT:t="PlayerBody";break;case BODY_TYPE.MONSTER:t="MonsterBody";break;case BODY_TYPE.BOSS:t="BossBody";break;case BODY_TYPE.NPC:case BODY_TYPE.COLLECTION:t="NpcBody";break;case BODY_TYPE.PET:t="PetBody"}return t},e.prototype.addEmenyBodyToAry=function(e,t){if(void 0===t&&(t=null),!(this._mainScene.heroBody.data.targets.indexOf(e)>=0)){e.addEventListener(Action_Event.BODY_DEATH_FINISH,this.bodyDeathEventHanlder,this);for(var n=0;n<this._heroBodys.length;n++)this._heroBodys[n].onAddEnemyBodyList([e]);e.bodyVisible=!0,t&&(e.x=t.x,e.y=t.y,this._mainScene.addBodyToMapLayer(e))}},e.prototype.addOtherBodyToScene=function(e,t){this._otherPlayerBodys.indexOf(e)>=0||(e.x=t.x,e.y=t.y,e.bodyVisible=!this.isShieldOhter,this._otherPlayerBodys.indexOf(e)<0&&this._otherPlayerBodys.push(e),this._mainScene.addBodyToMapLayer(e))},e.prototype.bodyDeathEventHanlder=function(e){var t=e.currentTarget;this.removeEmenyBodyToAry(t),this.dropPoint||(this.dropPoint=new egret.Point),this.dropPoint.x=t.x,this.dropPoint.y=t.y,GameFight.getInstance().fightScene.onKillTargetHandle(),t.data.bodyType==BODY_TYPE.MONSTER?Tool.callbackTime(this.onOverDeathAnim,this,600,t):t.data.bodyType==BODY_TYPE.BOSS?Tool.callbackTime(this.onOverDeathAnim,this,600,t):t.data.bodyType==BODY_TYPE.PLAYER||t.data.bodyType==BODY_TYPE.ROBOT?((GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS||GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.VIP_BOSS)&&DataManager.getInstance().dupManager.allpeoplebossData.removeOneOhterFightData(t.data.playerId),this.onDestroyOhterOne(t,!1),BodyFactory.instance.onRecovery(t)):BodyFactory.instance.onRecovery(t)},e.prototype.onOverDeathAnim=function(e){BodyFactory.instance.onRecovery(e)},e.prototype.onDestroyAllHeroTarget=function(){for(var e=0;e<this._heroBodys.length;e++)for(var t=this._mainScene.heroBody.data.targets.length-1;t>=0;t--){var n=this._heroBodys[e].data.targets[t];this.removeEmenyBodyToAry(n),(n.data.bodyType==BODY_TYPE.PLAYER||n.data.bodyType==BODY_TYPE.ROBOT)&&this.onDestroyOhterOne(n,!1),BodyFactory.instance.onRecovery(n)}},e.prototype.onDestroyOtherBodys=function(){for(var e=this._otherPlayerBodys.length-1;e>=0;e--){var t=this._otherPlayerBodys[e];this.onDestroyOhterOne(t)}},e.prototype.onDestroyOhterOne=function(e,t){void 0===t&&(t=!0),t&&this.onRemoveAllOtherTarget(e),e.petBody&&e.removePetBody(),e.retinuebody&&e.removeRetinue(),e.onClearTargets(),Tool.removeArrayObj(this._otherPlayerBodys,e),BodyFactory.instance.onRecovery(e)},e.prototype.onRemoveAllOtherTarget=function(e){for(var t=e.data.targets.length-1;t>=0;t--){var n=e.data.targets[t];e.onRemoveTarget(n),BodyFactory.instance.onRecovery(n)}},e.prototype.removeEmenyBodyToAry=function(e){if(e){for(var t=0;t<this._heroBodys.length;t++)this._heroBodys[t].onRemoveTarget(e);e.removeEventListener(Action_Event.BODY_DEATH_FINISH,this.bodyDeathEventHanlder,this)}},e.prototype.addPlayerRetinueToMap=function(e){e.petBody&&(e.petBody.onRefreshData(),this.addBodyToOwnerNear(e.petBody,e)),e.retinuebody&&(e.retinuebody.onRefreshData(),this.addBodyToOwnerNear(e.retinuebody,e)),e.magicbody&&this.addBodyToOwnerNear(e.magicbody,e)},e.prototype.addBodyToOwnerNear=function(e,t){var n=this._mapInfo.getNodeModelByXY(t.x,t.y),a=this._mapInfo.getGridNearByNode(n,2,2);n=a[Math.floor(Math.random()*a.length)];var i=this._mapInfo.getGridRdXYByIndex(n.nodeId);e.x=i.x,e.y=i.y,!e.parent&&t.parent&&this._mainScene.addBodyToMapLayer(e),e.onReset()},e.prototype.onHeroLogic=function(e){for(var t=0;t<this._heroBodys.length;t++){var n=this._heroBodys[t];n.checkBuffer(),n.data.isDie||(n.data.isHitChenMo||n.removeChenMoAnim(),n.data.isHitMaBi||(n.data.targets.length>0?this.useSkill(n):n.isMoving&&this.onBodyMove(n),n.removeMaBiAnim()),this.onPetLogic(n),this.onRetinueLogic(n),this.onMagicLogic(n))}this.onShowOrHideWalkingEffect()},e.prototype.onMagicLogic=function(e){var t=e.magicbody;if(t&&t.parent){if(!t.isMoving&&this._magicMoveTime<egret.getTimer()){var n=Tool.randomPosByDistance(e.x,e.y,60);t.setRandomMove(n),this._magicMoveTime=2e3+egret.getTimer()}t.onMove()}},e.prototype.onRetinueLogic=function(e){var t=e.retinuebody;if(t&&t.parent){if(!t.isMoving&&!t.isfollow){var n=Tool.randomPosByDistance(e.x,e.y,200);t.moveSpeed=GameDefine.Attack_Move_Speed,t.setMove([n])}this.onBodyMove(t)}},e.prototype.onPetLogic=function(e){e.petBody&&e.petBody.parent&&this.onBodyMove(e.petBody)},e.prototype.onMonsterLogic=function(e){for(var t=[],n=0;n<this._mainScene.heroBody.data.targets.length;n++)if(this._mainScene.heroBody.data.targets[n].data.bodyType==BODY_TYPE.MONSTER||this._mainScene.heroBody.data.targets[n].data.bodyType==BODY_TYPE.BOSS){var a=this._mainScene.heroBody.data.targets[n];t.push(a)}for(var n=0;n<this._otherPlayerBodys.length;n++){var i=this._otherPlayerBodys[n];if(i)for(var o=0;o<i.data.targets.length;o++){var a=i.data.targets[o];a?(a.data.bodyType==BODY_TYPE.MONSTER||a.data.bodyType==BODY_TYPE.BOSS)&&t.indexOf(a)<0&&t.push(a):SDKManager.getChannel()==EChannel.CHANNEL_LOCAL&&Tool.throwException("当前玩家并无攻击对象！！")}else SDKManager.getChannel()==EChannel.CHANNEL_LOCAL&&Tool.throwException("其他玩家为空！但没有从列表中移除")}for(var n=0;n<t.length;n++){var a=t[n];a.data.isHitMaBi||(a.checkBuffer(),a.removeMaBiAnim(),a.data.warnDist>0&&a.distanceToSelf(this._mainScene.heroBody)<=a.data.warnDist&&a.onAddEnemyBodyList(this._mainScene.heroBodys),a.data.targets.length>0&&this.useSkill(a))}},e.prototype.onOhterBodyLogic=function(e){for(var t=0;t<this._otherPlayerBodys.length;t++){var n=this._otherPlayerBodys[t];this.isShieldOhter&&this._mainScene.heroBody.data.targets.indexOf(n)<0||(n.checkBuffer(),n.data.isHitChenMo||n.removeChenMoAnim(),n.data.isHitMaBi||(n.data.targets.length>0?this.useSkill(n):n.isMoving&&this.onBodyMove(n),n.removeMaBiAnim()),this.onPetLogic(n),this.onRetinueLogic(n),this.onMagicLogic(n))}},e.prototype.onShowOrHideWalkingEffect=function(){var e=this._mainScene.heroBody;this.herowalkingEff||(this.herowalkingEff=new Animation("xunluzhong",-1,!1)),!GameFight.getInstance().isJackaroo&&e.getDistToTarget()>100?this.herowalkingEff.parent||(this._mainScene.heroBody.addEffectToSelf("HEAD",this.herowalkingEff),this.herowalkingEff.onPlay()):this.herowalkingEff.parent&&(this.herowalkingEff.parent.removeChild(this.herowalkingEff),this.herowalkingEff.onStop())},e.prototype.useSkill=function(e){if(!e.data.isDie){if(e.data.isStop)return void e.onActionReset();if(this.play_ultimate_skill)return void this.onBodyMove(e);var t=e.data.targets[0];if(!t)return void(e.data.isUseingSkill||e.onActionReset());var n=egret.is(e,"PlayerBody"),a=e.distanceToSelf(t);
if(t.data.bodyType==BODY_TYPE.NPC&&e.data.bodyType==BODY_TYPE.SELF){t.data;if(a<=FightDefine.STORY_TALK_DISTANCE)return void this.onHerobodyTalkNpc(t)}else if(t.data.bodyType==BODY_TYPE.COLLECTION&&e.data.bodyType==BODY_TYPE.SELF){if(a<=FightDefine.TREASURE_TALK_DISTANCE)return void this.onHerobodyCollection(t)}else{var i=void 0;if(!e.walkOn&&(i=e.data.useSkill,!i&&(i=e.data.getCanUseSkill(),i&&GameFight.getInstance().isPKEffectScene&&i.model.fonteffect)))return void this.onPlayPVPSceneEFT(e);if(i){if(0!=i.model.targetType)return e.currTarget||(e.currTarget=t),this.releaseBuffHandler(e,i),e.onAttack(),void this.onBodyMove(e);t=null;for(var o=0;o<e.data.targets.length;o++){var r=e.data.targets[o],s=e.distanceToSelf(r);if(!r.data.isDie){if(e.currTarget===r){t=r,a=s;break}t?a>s&&(t=r,a=s):(t=r,a=s)}}if(!t)return void e.onActionReset();if(e.currTarget=t,i.isDist(a)||e.ignoreDist||this.pvp_showtime_stamp>0){if(e.data.bodyType==BODY_TYPE.SELF){if(GameFight.getInstance().onCheckStoyTalk())return}else if((e.data.bodyType==BODY_TYPE.PLAYER||e.data.bodyType==BODY_TYPE.ROBOT)&&t.data.bodyType==BODY_TYPE.SELF&&0==t.data.attackcount)return;e.onAttack()}else if(!e.isMoving)if(n){if(GameFight.getInstance().canHitBack&&t.data.bodyType==BODY_TYPE.MONSTER?e.playChagre([Tool.getPosByTwoPoint(t.x,t.y,e.x,e.y,50)],!0):e.data.bodyType==BODY_TYPE.SELF?e.onJump(new egret.Point(t.x,t.y)):t===this._mainScene.heroBody.currTarget?e.onJump(Tool.randomPosByDistance(t.x,t.y,150)):e.onJump(new egret.Point(t.x,t.y)),e.retinuebody){var h=void 0;h=e.movePaths.length>0?e.movePaths[e.movePaths.length-1]:e.moveTarget,h&&(h=Tool.randomPosByDistance(h.x,h.y,200),e.retinuebody.setFollowPaths([h]))}}else this.onFindPathHanlder(e,t.x,t.y)}}this.onBodyMove(e)}},e.prototype.onFindPathHanlder=function(e,t,n){var a=[new egret.Point(t,n)];e.setMove(a)},e.prototype.onMonsterPatrol=function(e){if(e.isMoving)return void this.onBodyMove(e);if(e.data.canPatrol){e.data.patrolPoint||(e.data.patrolPoint=new egret.Point(e.x,e.y));var t=this._mapInfo.getNodeModelByXY(e.data.patrolPoint.x,e.data.patrolPoint.y),n=this._mapInfo.getGridNearByNode(t),a=n[Math.floor(Math.random()*n.length)];if(a){var i=this._mapInfo.getGridRdXYByIndex(a.nodeId);e.setMove([i])}}else e.onActionReset()},e.prototype.releaseBuffHandler=function(e,t){t.model.buffId;if(t.model.rectType>0)for(var n=this.getTeamBodys(e),a=0;a<n.length;a++)n[a].addBuffer(t)},e.prototype.getTeamBodys=function(e,t){void 0===t&&(t=!1);var n,a=[],i=e.data.bodyType;if(i==BODY_TYPE.SELF)for(var o=0;o<this._heroBodys.length;o++){var r=this._heroBodys[o];t?a.push(r):r!==e&&a.push(r)}else if(i==BODY_TYPE.PLAYER){n=e.data.playerId;for(var o=0;o<this.otherPlayerBodys.length;o++){var s=this.otherPlayerBodys[o];s.data.playerId==n&&(t?a.push(s):s!==e&&a.push(s))}}else if((i==BODY_TYPE.MONSTER||i==BODY_TYPE.BOSS)&&e.data.targets[0]){n=e.data.modelid;for(var h=e.data.targets[0],o=0;o<h.data.targets.length;o++){var l=h.data.targets[o];l.data.modelid==n&&(t?a.push(l):l!==e&&a.push(l))}}return a},e.prototype.onPlayPVPSceneEFT=function(e){if(!(this.pvp_showtime_stamp>0)){this.pvp_showtime_stamp=0,this.play_ultimate_skill=!0,this.playStandForPlayer(this._mainScene.heroBody);for(var t=0;t<this._otherPlayerBodys.length;t++){var n=this._otherPlayerBodys[t];this.playStandForPlayer(n)}this._mainScene.onSwithMapGary(!0);var a=e.currTarget;if(a&&!a.data.isDie&&(e.data.bodyType==BODY_TYPE.SELF||a.data.bodyType==BODY_TYPE.SELF)){var i=e.data.getCanUseSkill(),o=a.data.getCanUseSkill();if(this.pvp_showtime_stamp=Math.max(i?i.model.castTime:0,o?o.model.castTime:0)+1500,0!=this.pvp_showtime_stamp){var r=(new egret.Point(this._mainScene.heroBody.x,this._mainScene.heroBody.y),e.x),s=e.y,h=a.x,l=a.y,g=new egret.Point(r,s),c=new egret.Point(h,l),p=Tool.getPosByTwoPoint(h,l,r,s,300),u=Tool.getPosByTwoPoint(r,s,h,l,300);e.setWalkWithSpeed([p],400),a.setWalkWithSpeed([u],400),Tool.callbackTime(this.showUltimateSkill,this,300),Tool.callbackTime(this.onEndPVPSceneEFT,this,this.pvp_showtime_stamp,e,g,a,c)}}}},e.prototype.showUltimateSkill=function(){if(GameFight.getInstance().isPKEffectScene&&0!=this.pvp_showtime_stamp){SkillEffectManager.getInstance().onDestroyAllSkillEffect();var e=this._mainScene.heroBody,t=e.data.getCanUseSkill(),n=e.currTarget,a=n?n.data.getCanUseSkill():null;if(t.model.fonteffect){var i=new Animation("skill_longjuanfeng",1,!0);e.addEffectToSprite(i,null,"TOP")}if(a&&a.model.fonteffect){var o=new Animation("skill_longjuanfeng",1,!0);n.addEffectToSprite(o,null,"TOP")}Tool.callbackTime(function(){this.play_ultimate_skill=!1},this,1e3)}},e.prototype.onEndPVPSceneEFT=function(e,t,n,a){0!=this.pvp_showtime_stamp&&(this.pvp_showtime_stamp=0,this._mainScene.onSwithMapGary(!1),e&&n&&e&&n&&!e.data.isDie&&e.parent&&!n.data.isDie&&n.parent&&(e.playChagre([t],!0),n.playChagre([a],!0)))},e.prototype.onPlayDropEffect=function(e){this.dropPoint||(this.dropPoint=new egret.Point(this._mainScene.heroBody.x,this._mainScene.heroBody.y));for(var t=80,n=Math.ceil(Math.sqrt(e.length)),a=this.dropPoint.x-Math.floor(n/2)*t,i=this.dropPoint.y-Math.floor(n/2)*t,o=0;o<e.length;o++){var r=e[o],s=BodyFactory.instance.onCreateDropBody(r.type,r.id,r.quality);this._mainScene.addBodyToMapLayer(s),s.x=this.dropPoint.x,s.y=this.dropPoint.y;var h=a+o%n*t,l=i+Math.floor(o/n)*t;200*Math.floor(o/this.Drop_Fly_Max);TweenLiteUtil.dropbodyFly1(s,new egret.Point(h,l)),Tool.callbackTime(this.onDropFlyHanlder,this,1500,s)}this._dropScene=GameFight.getInstance().fightsceneTpye},e.prototype.onDropFlyHanlder=function(e){if(e.onDestyEffect(),(e.model.type==GOODS_TYPE.MASTER_EQUIP||e.model.type==GOODS_TYPE.SERVANT_EQUIP)&&DataManager.getInstance().bagManager.cheakEquipbagIsFull())return GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(34)),void this.onDestroyDropbody(e);if(this._mainScene.getMapLayer().visible&&this._dropScene==GameFight.getInstance().fightsceneTpye){e.x=this._mainScene.getMapLayer().heroPosByModule[0]-(this._heroBodys[0].x-e.x),e.y=this._mainScene.getMapLayer().heroPosByModule[1]-(this._heroBodys[0].y-e.y),this._mainScene.addDropBodyToLayer(e);var t=new egret.Point(this._mainScene.getMapLayer().heroPosByModule[0],this._mainScene.getMapLayer().heroPosByModule[1]-this._mainScene.heroBody.data.model.high/2);TweenLiteUtil.beelineTween(e,this.onDestroyDropbody,this,t)}else this.onDestroyDropbody(e)},e.prototype.onDestroyDropbody=function(e){e.onDestroy(),e=null},e.prototype.resetShowAnimCheckIndex=function(){this._heroCheckNodeIndex=0},e.prototype.checkShowAnimation=function(){if(this.showanimbody=[],!(egret.getTimer()-this._showanimCheckTime<100)){this._showanimCheckTime=egret.getTimer();var e=this._mapInfo.getNodeModelByXY(this._mainScene.heroBody.x,this._mainScene.heroBody.y);if(this._heroCheckNodeIndex!=e.nodeId){this._heroCheckNodeIndex=e.nodeId;for(var t=this._mapInfo.getGridNearByNode(e,this.cheackNodeColRadius,this.cheackNodeRowRadius),n=0;n<this._mainScene.heroBody.data.targets.length;n++){var a=this._mainScene.heroBody.data.targets[n],i=this._mapInfo.getNodeModelByXY(a.x,a.y);t.indexOf(i)>=0&&a.data.showAnimation&&this.showanimbody.push(a)}}}},e.prototype.onPlayShowAnimation=function(){if(!this._isPlayShowAnim){this._isPlayShowAnim=!0;this.bodyShowAnimation1,this.bodyShowAnimationEnd1}},e.prototype.bodyShowAnimation1=function(e){e.alpha=0;var t=egret.Tween.get(e);t.to({alpha:1},1e3)},e.prototype.bodyShowAnimationEnd1=function(e){var t=e.currentTarget;t.currentTarget.removeEventListener(Action_Event.BODY_EFFECT_DESTROY,this.bodyShowAnimationEnd1,this);for(var n=this.showanimbody.length-1;n>=0;n--){var a=this.showanimbody[n];a.alpha=1,egret.Tween.removeTweens(a),this.showanimbody.splice(n,1)}this._isPlayShowAnim=!1,t=null},e}();__reflect(BodyManager.prototype,"BodyManager");var GameLoadingLayer=function(e){function t(t){var n=e.call(this)||this;return n._owner=t,n}return __extends(t,e),t.prototype.startLoading=function(e,t,n){this.isloading=!0,this.callback=e,this.thisObject=t,this.imgs=n,this.imgs?(this.imgIdx=0,this.loadImgs()):this.loadFinish()},t.prototype.loadImgs=function(){if(this.imgIdx<this.imgs.length){var e=this.imgs[this.imgIdx++];RES.hasRes(e)?RES.getRes(e)?this.loadImgs():RES.getResAsync(e,this.loadImgs,this):this.loadImgs()}else this.loadFinish()},t.prototype.loadFinish=function(){this.isloading&&(this.isloading=!1,Tool.callback(this.callback,this.thisObject),this.callback=null,this.thisObject=null)},t.prototype.close=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(GameLoadingLayer.prototype,"GameLoadingLayer");var MainScene=function(e){function t(t){var n=e.call(this)||this;return n.Tick_Interval=5e3,n._initMsgCount=0,n.checkTickTime=0,n.logicTimeStamp=0,n.gameworld=t,GameFight.getInstance().setMainscene(n),n}return __extends(t,e),t.prototype.onStarGame=function(){this.gameheroBodys=[],this._mapLayer=new MapLayer(this),this.addChild(this._mapLayer),this._moduleLayer=new ModuleLayer(this),this.addChild(this._moduleLayer),this._bodyManager=new BodyManager(this),this.onRegistAllScene(),GameFight.getInstance().onInitJackaroo(),this.onupdateHero(),this.onRegistGameEvent(),this.onReturnYewaiScene()},t.prototype.onInitRequestMsg=function(){this._initMsgCount=0,this.onCallBackRequestMsg(DataManager.getInstance().arenaManager,"onSendServerArenaInfoMsg"),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_PERSONALLY),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_CAILIAO),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_CHALLENGE),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_SIXIANG),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_ZHUFU),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_DIFU),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_TEAM),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_BLESS),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"onRequestDupInofMsg",DUP_TYPE.DUP_LINGXING),this.onCallBackRequestMsg(DataManager.getInstance().arenaManager,"onSendLocalArenaInfoMsg"),this.onCallBackRequestMsg(DataManager.getInstance().arenaManager,"onSendLadderInfoMsg"),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"requstSamsareBossInfoMsg"),this.onCallBackRequestMsg(DataManager.getInstance().chatManager,"onSendChatRecord",CHANNEL.WHISPER),this.onCallBackRequestMsg(DataManager.getInstance().dupManager,"sendPVEBossInfoRequst")},t.prototype.onCallBackRequestMsg=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=1e3*this._initMsgCount;Tool.callbackTime.apply(Tool,[e[t],e,i].concat(n)),this._initMsgCount++},t.prototype.onRegistAllScene=function(){this.allFightScenes={},this.allFightScenes[MESSAGE_ID.GAME_FIGHT_DUP_ENTER]=FIGHT_SCENE.DUP,this.allFightScenes[MESSAGE_ID.ALLPEOPLE_BOSS_ENTER_MSG]=FIGHT_SCENE.ALLPEOPLE_BOSS,this.allFightScenes[MESSAGE_ID.XUEZHANBOSS_ENTER_MSG]=FIGHT_SCENE.XUEZHAN_BOSS,this.allFightScenes[MESSAGE_ID.VIPBOSS_ENTER_MSG]=FIGHT_SCENE.VIP_BOSS,this.allFightScenes[MESSAGE_ID.SAMSARA_BOSS_ENTER_MSG]=FIGHT_SCENE.SAMSARA_BOSS,this.allFightScenes[MESSAGE_ID.YEWAIPVP_FIGHT_PK_MSG]=FIGHT_SCENE.YEWAIPVP,this.allFightScenes[MESSAGE_ID.ARENE_LADDERARENE_FIGHT_MESSAGE]=FIGHT_SCENE.LODDER_ARENA,this.allFightScenes[MESSAGE_ID.ESCORT_ROB_MESSAGE]=FIGHT_SCENE.ESCORT,this.allFightScenes[MESSAGE_ID.ESCORT_REVENGE_MESSAGE]=FIGHT_SCENE.REVENGE,this.allFightScenes[MESSAGE_ID.UNION_BOSS_FIGHT_MESSAGE]=FIGHT_SCENE.UNION_BOSS,this.allFightScenes[MESSAGE_ID.UNION_BATTLE_ENJOIN_MESSAGE]=FIGHT_SCENE.UNION_BATTLE,this.allFightScenes[MESSAGE_ID.ARENE_CROSS_FIGHT_ENTER_MESSAGE]=FIGHT_SCENE.SERVER_ARENA,this.allFightScenes[MESSAGE_ID.ARENE_FIGHT_ENTER_MESSAGE]=FIGHT_SCENE.LOCAL_ARENA,this.allFightScenes[MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT]=FIGHT_SCENE.MYSTERIOUS_BOSS,this.allFightScenes[MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE]=FIGHT_SCENE.DIFU_DUP,this.allFightScenes[MESSAGE_ID.BOSS_PILL_START_MESSAGE]=FIGHT_SCENE.XIANSHAN_BOSS,this.allFightScenes[MESSAGE_ID.CROSS_PVEBOSS_FIGHT_MESSAGE]=FIGHT_SCENE.CROSS_PVE_BOSS,this.allFightScenes[MESSAGE_ID.WUTAN_FIGHT_MESSAGE]=FIGHT_SCENE.THRONE},t.prototype.onReturnYewaiScene=function(){this.onChangeFightScene(FIGHT_SCENE.YEWAI_XG)},t.prototype.onEnterYewaiBoss=function(){this.onChangeFightScene(FIGHT_SCENE.YEWAI_BOSS)},t.prototype.onRegistGameEvent=function(){platform.onListenerShow(this.onListenerGameShow),platform.onListenerHide(this.onListenerGameHide);for(var e in this.allFightScenes)this.gameworld.addEventListener(e.toString(),this.onChangeFightScene,this);GameDispatcher.getInstance().addEventListener(GameEvent.GAME_RELOGIN_EVENT,this.onReLoginServer,this),GameDispatcher.getInstance().addEventListener(GameEvent.SHIELD_OTHERBODY_EVENT,this.onShieldHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_EARTHQUAKE_STRAT,this.onEarthquake,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.onHeroLevelUp,this),GameDispatcher.getInstance().addEventListener(GameEvent.PET_ENJOIN_MAP,this.onPetJoinMap,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_AVATAR_UPDATE,this.onRefreshHeroAvatar,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_GOTO_BOSS_WAVE,this.onEnterYewaiBoss,this),GameDispatcher.getInstance().addEventListener(GameEvent.WXGAME_ONSHOW_EVENT,this.gameonshowHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.WXGAME_ONHIDE_EVENT,this.gameonHideHanlder,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TITLE_WEAR_MESSAGE.toString(),this.onWearTitle,this),this.gameworld.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchStage,this)},t.prototype.onListenerGameShow=function(e){console.log("监听到游戏回到前台的事件~"),console.log(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.WXGAME_ONSHOW_EVENT),e)},t.prototype.gameonshowHandler=function(e){var t=e.data;SoundFactory.playMusic(SoundDefine.SOUND_BGM),DataManager.getInstance().wxgameManager.onupdateColletionStatus(t),SDKManager.isIphone&&this._moduleLayer.onResetUIResource(t)},t.prototype.onListenerGameHide=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.WXGAME_ONHIDE_EVENT))},t.prototype.gameonHideHanlder=function(){SoundFactory.stopMusic(SoundDefine.SOUND_BGM)},t.prototype.gameLogic=function(e){if(SDKManager.islowphone){if(e-this.logicTimeStamp<50)return}else if(e-this.logicTimeStamp<20)return;return this.logicTimeStamp=e,this.checkTickTime-egret.getTimer()<=0&&(this.checkTickTime>0?(this.onSendTickMessage(),egret.getTimer()>36e5&&egret.getTimer()%36e5<=15e3&&SDKManager.getChannel()==EChannel.CHANNEL_WANBA&&SDKWanBa.getInstance().isLoginIn()):this.checkTickTime=egret.getTimer()+this.Tick_Interval),this._sceneRun&&(this._bodyManager.logicHandler(e),this.mapMove(),this.isearthquake&&this.earthquakeHandler()),!1},t.prototype.onSendTickMessage=function(){for(var e=new Message(MESSAGE_ID.GAME_TICK_MESSAGE),t=0,n=0;n<this.heroBodys.length;n++){var a=this.heroBodys[n].data;t+=GameCommon.calculationFighting(a.attributes);for(var i=0,o=0;o<SkillDefine.SKILL_NUM;o++)i+=SkillDefine.getSkillFighting(a.skills[o].level,a.skills[o].grade);t+=i}e.setString(t+""),GameCommon.getInstance().sendMsgToServer(e),this.checkTickTime=egret.getTimer()+this.Tick_Interval},t.prototype.onTouchStage=function(e){},t.prototype.onChangeFightScene=function(e){var t,n=GameFight.getInstance().fightScene?!0:!1;switch(t=e?egret.is(e,"GameMessageEvent")?e?this.allFightScenes[e.message.getCmdId()]:FIGHT_SCENE.YEWAI_XG:Tool.isNumber(e)?e:FIGHT_SCENE.YEWAI_XG:FIGHT_SCENE.YEWAI_XG,GameFight.getInstance().fightScene&&t!=GameFight.getInstance().fightsceneTpye&&GameFight.getInstance().fightScene.onDestroyScene(),t){case FIGHT_SCENE.YEWAI_XG:GameFight.getInstance().onRegistScene(FIGHT_SCENE.YEWAI_XG),GameFight.getInstance().fightScene.onSwitchMap(GameFight.getInstance().yewaiMapId);break;case FIGHT_SCENE.YEWAI_BOSS:GameCommon.getInstance().onHideFuncTipsBar(null),GameFight.getInstance().onRegistScene(t),GameFight.getInstance().fightScene.onParseFightMsg(null);break;default:var a=e.message;a||Tool.throwException("注册场景未注册！"),this._moduleLayer.removeAllWindows(),GameCommon.getInstance().onHideFuncTipsBar(null),GameFight.getInstance().onRegistScene(t),GameFight.getInstance().fightScene.onParseFightMsg(a)}n&&this.onSendTickMessage(),this.Tick_Interval=GameFight.getInstance().fightScene.TickInterval,this._bodyManager.onShieldOhterBody(!1)},t.prototype.setHeroMapPostion=function(e){this.mapInfo.getNodeModelByXY(e.x,e.y);this.heroBody.parent||this.addBodyToMapLayer(this.heroBody),this.heroBody.x=e.x,this.heroBody.y=e.y,this._bodyManager.addPlayerRetinueToMap(this.heroBody),this.mapMove()},t.prototype.startFightRun=function(){this.isInitTick||(this.isInitTick=!0,egret.startTick(this.gameLogic,this)),this._sceneRun||(this._sceneRun=!0)},t.prototype.pauseFightRun=function(){this._sceneRun&&(this._sceneRun=!1)},t.prototype.stopFightRun=function(){this.isInitTick=!1,this._sceneRun=!1,egret.stopTick(this.gameLogic,this)},t.prototype.mapMove=function(){this._mapLayer.logicMove()},t.prototype.addBodyToMapLayer=function(e,t){void 0===t&&(t=-1),this._mapLayer.addBodyToMaplayer(e,t)},t.prototype.onPauseBodys=function(e,t){for(var n=0;n<e.length;n++){var a=e[n];a.data.isStop=t}},t.prototype.addDropBodyToLayer=function(e){this._moduleLayer.addToDropLayer(e)},Object.defineProperty(t.prototype,"mapInfo",{get:function(){return this._mapinfo||(this._mapinfo=new MapInfo),this._mapinfo},enumerable:!0,configurable:!0}),t.prototype.getMapLayer=function(){return this._mapLayer},t.prototype.onupdateHero=function(){for(var e=0;e<DataManager.getInstance().playerManager.player.playerDatas.length;e++){var t=void 0;if(this.gameheroBodys.length<=e){var n=DataManager.getInstance().playerManager.player.playerDatas[e];n.onRebirth(),t=new PlayerBody,t.data=n,t.addEventListener(Action_Event.BODY_DEATH_FINISH,this.heroDeathHandler,this),this.gameheroBodys.push(t)}else t=this.gameheroBodys[e],t.data.onRebirth(),t.onRefreshData()}},t.prototype.onResetAllHeroDir=function(e){for(var t=0;t<this.gameheroBodys.length;t++){var n=this.gameheroBodys[t];n.direction=e}},t.prototype.onResetAllHeroBody=function(){for(var e=0;e<this.gameheroBodys.length;e++){var t=this.gameheroBodys[e];t.onReset(),t.retinuebody&&t.retinuebody.onReset()}},t.prototype.onShieldHandler=function(e){this._bodyManager.onShieldOhterBody(e.data)},t.prototype.onShowOrHideMapLayer=function(e){this._mapLayer.visible=!e},t.prototype.onHeroLevelUp=function(e){if(1==e.data){var t=new Animation("renwushengji",1,!0);this.heroBody.addEffectToSelf("TOP",t),this.heroBody.onRefreshLevelShow()}},t.prototype.onRefreshHeroAvatar=function(e){var t=e.data,n=this.heroBodys[t.idx];n.onUpdateAvatar(),n.retinuebody&&n.retinuebody.onUpdateAvatar(),n.magicbody&&(n.magicbody.data=n.data),LoadManager.getInstance().onClearAllBodyAnimCache(!1)},t.prototype.onPetJoinMap=function(){this.heroBody.onCheckRetinue(),this._bodyManager.addPlayerRetinueToMap(this.heroBody)},t.prototype.onWearTitle=function(e){for(var t=0;t<this.gameheroBodys.length;t++){var n=this.gameheroBodys[t];n.onChangeTitleBody()}},Object.defineProperty(t.prototype,"heroBodys",{get:function(){if(this._currHeroBodys||(this._currHeroBodys=[]),this._currHeroBodys.length!=this.gameheroBodys.length)for(var e=0;e<this.gameheroBodys.length;e++)this._currHeroBodys[e]=this.gameheroBodys[e];return this._currHeroBodys},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"heroBody",{get:function(){for(var e=0;e<this.gameheroBodys.length;e++){var t=this.gameheroBodys[e];if(!t.data.isDie)return t}return this.gameheroBodys[0]},enumerable:!0,configurable:!0}),t.prototype.onEarthquake=function(){this.isearthquake||(this.isearthquake=!0,this.earthquakeOffValue=4,this.earthupdown=Math.floor(2*Math.random()),this.earthleftright=Math.floor(2*Math.random()))},t.prototype.earthquakeHandler=function(){egret.getTimer()-this.earthTime<100||(this.earthTime=egret.getTimer(),0==this.earthupdown?(this._mapLayer.y=-this.earthquakeOffValue,this.earthupdown=1):(this._mapLayer.y=this.earthquakeOffValue,this.earthupdown=0),0==this.earthleftright?(this._mapLayer.x=-this.earthquakeOffValue,this.earthleftright=1):(this._mapLayer.x=this.earthquakeOffValue,this.earthleftright=0),this.earthquakeOffValue<=0?(this.isearthquake=!1,this.earthquakeOffValue=0):this.earthquakeOffValue-=1)},t.prototype.onCheckPlayerFail=function(){for(var e=0;e<this.gameheroBodys.length;e++){var t=this.gameheroBodys[e];if(!t.data.isDie)return!1}return!0},t.prototype.heroDeathHandler=function(e){var t=e.currentTarget;this.onRemoveHero(t),this.onCheckPlayerFail()&&GameFight.getInstance().fightScene.onDeath()},t.prototype.onRemoveHero=function(e){e.parent&&e.parent.removeChild(e),e.overChagre(),e.petBody&&e.petBody.parent&&e.petBody.parent.removeChild(e.petBody);var t=e.retinuebody;t&&t.parent&&t.parent.removeChild(t);var n=e.magicbody;n&&n.parent&&n.parent.removeChild(n)},t.prototype.onSwithMapGary=function(e){this._mapLayer.onGary(e)},t.prototype.getModuleLayer=function(){return this._moduleLayer},t.prototype.getBodyManager=function(){return this._bodyManager},t.prototype.onReLoginServer=function(){this.gameworld.addEventListener(MESSAGE_ID.GAME_LOGON_MESSAGE.toString(),this.receiveLoginMsg,this),this.gameworld.addEventListener(GameEvent.NET_EVENT_ERROR,this.onLoginNetError,this),this.gameworld.httpManager.reLogin()},t.prototype.onRemoveLoginListener=function(){this.gameworld.removeEventListener(MESSAGE_ID.GAME_LOGON_MESSAGE.toString(),this.receiveLoginMsg,this),this.gameworld.removeEventListener(GameEvent.NET_EVENT_ERROR,this.onLoginNetError,this)},t.prototype.receiveLoginMsg=function(e){this.onRemoveLoginListener(),this.gameworld.addEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveSelectServerMsg,this),this.gameworld.addEventListener(GameEvent.NET_EVENT_ERROR,this.onLoginNetError,this);var t=SDKManager.loginInfo;this.gameworld.sendSelectServer(t.serverId)},t.prototype.receiveSelectServerMsg=function(e){this.onRemoveSelectServerListener();var t=e.message,n=t.getString(),a=t.getShort(),i=t.getByte();2==i?this.gameworld.setAlertDisconnect(Language.ALERT_DISCONNECT_5):(this.gameworld.setUrl(n,a),this.sendLoginGame()),Tool.log("登录游戏成功")},t.prototype.sendLoginGame=function(){this.gameworld.sendLoginServerMsg()},t.prototype.onRemoveSelectServerListener=function(){this.gameworld.removeEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveSelectServerMsg,this),this.gameworld.removeEventListener(GameEvent.NET_EVENT_ERROR,this.onLoginNetError,this)},t.prototype.onLoginNetError=function(e){this.onRemoveLoginListener(),this.onRemoveSelectServerListener()},t.prototype.onReloadMainScene=function(){this.gameworld.reloadingClose(),this._bodyManager.onDestroyAllHeroTarget(),this.onReturnYewaiScene(),this._moduleLayer.onReLoginSereverHandler(),DataManager.getInstance().newactivitysManager.chongxinlianjie()},t}(egret.DisplayObjectContainer);__reflect(MainScene.prototype,"MainScene");var MapInfo=function(){function e(){this.MAP_GRID_WIDTH=128,this.MAP_GRID_HEIGHT=128,this.heroPointType=CameraType.CENTER}return e.prototype.onRefreshMapInfo=function(e){Tool.isNumber(this.fightId)&&RES.getRes(this.fightId+"_fight_xml")&&RES.destroyRes(this.fightId+"_fight_xml"),this.mapId=e;var t=JsonModelManager.instance.getModelmap()[e];if(t||Tool.throwException("缺少地图配置文件！Mapid:"+e),this.MAP_WIDTH=t.width,this.MAP_HEIGHT=t.height,this.bronNodeId=t.bornPoint,this.mapResId=t.resources,this.fightId=t.fightid,this.mapMaxX=this.MAP_WIDTH-size.width,this.mapMaxY=this.MAP_HEIGHT-size.height,this.mapColNum=Math.ceil(this.MAP_WIDTH/this.MAP_GRID_WIDTH),this.mapRowNum=Math.ceil(this.MAP_HEIGHT/this.MAP_GRID_HEIGHT),this.yewaiprogress=t.xiaoguai,this.MapNodeXmlData)for(var n in this.MapNodeXmlData){var a=this.MapNodeXmlData[n];a=null,delete this.MapNodeXmlData[n]}else this.MapNodeXmlData={};this.modelMapNodes=[];for(var i=this.mapRowNum*this.mapColNum,o=0;i>o;o++){var r=o+1,s=this.MapNodeXmlData[r];s||(s=new ModelMapNode,s.nodeType=MAP_GRID_TYPE.NORMAL,s.nodeId=r),s.colIndex=o%this.mapColNum+1,s.rowIndex=Math.ceil(s.nodeId/this.mapColNum),this.modelMapNodes.push(s)}GameFight.getInstance().fightScene.onLoadingSceneRes(this.mapId)},e.prototype.onloadedMapConfig=function(e,t){if(this.MapNodeXmlData)for(var n in this.MapNodeXmlData){var a=this.MapNodeXmlData[n];a=null,delete this.MapNodeXmlData[n]}else this.MapNodeXmlData={};this.modelMapNodes=[],ModelManager.getInstance().parseXmlToModel(this.MapNodeXmlData,ModelMapNode,t);for(var i=this.mapRowNum*this.mapColNum,o=0;i>o;o++){var r=o+1,s=this.MapNodeXmlData[r];s||(s=new ModelMapNode,s.nodeType=MAP_GRID_TYPE.COLLSION,s.nodeId=r),s.colIndex=o%this.mapColNum+1,s.rowIndex=Math.ceil(s.nodeId/this.mapColNum),this.modelMapNodes.push(s)}GameFight.getInstance().fightScene.onLoadingSceneRes(this.mapId)},e.prototype.getGridIndexByXY=function(e,t){var n=Math.max(1,Math.ceil(e/this.MAP_GRID_WIDTH)),a=Math.max(1,Math.ceil(t/this.MAP_GRID_HEIGHT));return(a-1)*this.mapColNum+n},e.prototype.getXYByGridIndex=function(e){var t=this.modelMapNodes.length>=e?this.modelMapNodes[e-1]:null,n=t?t.colIndex*this.MAP_GRID_WIDTH-this.MAP_GRID_WIDTH/2:-1,a=t?t.rowIndex*this.MAP_GRID_HEIGHT-this.MAP_GRID_HEIGHT/2:-1;return-1==n||-1==a?null:new egret.Point(n,a)},e.prototype.getGridNearByNode=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=1);for(var a=[],i=Math.max(1,e.colIndex-t),o=Math.min(this.mapColNum,e.colIndex+t),r=Math.max(1,e.rowIndex-n),s=Math.min(this.mapRowNum,e.rowIndex+n),h=r;s>=h;h++)for(var l=i;o>=l;l++){var g=this.mapColNum*(h-1)+l,c=this.modelMapNodes[g-1];e.nodeId!=c.nodeId&&(c.nodeType!=MAP_GRID_TYPE.NORMAL||this.getGridBetweenHasHit(e,c)||a.push(c))}return 0==a.length&&a.push(e),a},e.prototype.getGridNearByIndex=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=1);var a=[],i=this.getNodeModelByIndex(e);return a=this.getGridNearByNode(i,t,n)},e.prototype.getGridListByDistance=function(e,t){if(0>=t)return[];for(var n=[],a=Math.max(1,e.colIndex-t),i=Math.min(this.mapColNum,e.colIndex+t),o=Math.max(1,e.rowIndex-t),r=Math.min(this.mapRowNum,e.rowIndex+t),s=o;r>=s;){for(var h=a;i>=h;h++){var l=this.mapColNum*(s-1)+h,g=this.modelMapNodes[l-1];g.nodeType==MAP_GRID_TYPE.NORMAL&&n.push(g)}s+=r-o}for(var h=a;i>=h;){for(var s=o;r>=s;s++){var l=this.mapColNum*(s-1)+h,g=this.modelMapNodes[l-1];g.nodeType==MAP_GRID_TYPE.NORMAL&&n.push(g)}h+=i-a}return n},e.prototype.getGridRdXYByIndex=function(e){var t=this.getXYByGridIndex(e);return t.x=Tool.toInt(Math.floor(t.x+Math.random()*this.MAP_GRID_WIDTH)-this.MAP_GRID_WIDTH/2),t.y=Tool.toInt(Math.floor(t.y+Math.random()*this.MAP_GRID_HEIGHT)-this.MAP_GRID_HEIGHT/2),t},e.prototype.getNodeModelByIndex=function(e){return this.modelMapNodes[e-1]},e.prototype.getNodeModelByXY=function(e,t){var n=this.getGridIndexByXY(e,t);return this.modelMapNodes[n-1]},e.prototype.findGridPath=function(e,t,n,a,i){void 0===i&&(i=!0);for(var o=this.getGridIndexByXY(e,t),r=o,s=this.getGridIndexByXY(n,a),h=[r],l=[];r!=s;){var g=this.findNextGrid(r,s,h,l,i&&o!=r);if(!g||g==r){if(0==l.length)break;for(var c=[],p=0;p<l.length;p++)c[p]=this.modelMapNodes[l[p]-1];c.sort(function(e,t){return e.findnode.hValue-t.findnode.hValue}),g=c.shift().nodeId,Tool.removeArrayObj(l,g)}r=g,h.indexOf(g)<0&&h.push(g)}for(var u=h[h.length-1],d=[u];u!=o;){var _=this.modelMapNodes[u-1];u=_.findnode.parentnodeId,d.push(u)}return d.reverse(),d},e.prototype.findPointPath=function(e,t,n,a,i){void 0===i&&(i=!0);var o=this.findGridPath(e,t,n,a,i);try{for(var r=[],s=this.getNodeModelByIndex(o[0]),h=0;h<o.length;h++)if(h==o.length-1)r.push(new egret.Point(n,a));else{var l=this.getNodeModelByIndex(o[h]);if(l.isJump){for(;l&&l.isJump;)r.push(this.getXYByGridIndex(l.nodeId)),h++,l=this.getNodeModelByIndex(o[h]);r.push(this.getXYByGridIndex(l.nodeId)),s=l}else 1==this.getGridBetweenHasHit(s,l)&&(r.push(this.getXYByGridIndex(o[h-1])),s=this.getNodeModelByIndex(o[h-1]))}return r}catch(g){return null}},e.prototype.findNextGrid=function(e,t,n,a,i){if(void 0===i&&(i=!0),e==t)return t;var o=this.modelMapNodes[e-1];if(!o)return SDKManager.getChannel()==EChannel.CHANNEL_LOCAL&&Tool.throwException("地图格子"+e+"不存在！"),null;if(o.isJump&&i){var r=this.modelMapNodes[o.areaIndex-1];return r&&r.isCanWalk?(r.findnode.parentnodeId=e,r.nodeId):(SDKManager.getChannel()==EChannel.CHANNEL_LOCAL&&Tool.throwException("跳跃点配置错误！"),null)}for(var s,h=Math.max(1,o.colIndex-1),l=Math.min(this.mapColNum,o.colIndex+1),g=Math.max(1,o.rowIndex-1),c=Math.min(this.mapRowNum,o.rowIndex+1),p=this.getXYByGridIndex(e),u=this.getXYByGridIndex(t),d=[],_=g;c>=_;_++)for(var m=h;l>=m;m++){var E=this.mapColNum*(_-1)+m,f=this.modelMapNodes[E-1];if(t==E)return f.findnode.parentnodeId=e,t;if(E!=e&&f.isCanWalk){var y=n.indexOf(E)>=0;if(!y){if(a.indexOf(E)<0){var I=this.getGridBetweenDistance(f,p,u);if(0==I.length)continue;var v=I[0],S=I[1];f.findnode.gValue=v,f.findnode.hValue=S}if(s){var T=s.findnode.gValue+s.findnode.hValue,M=f.findnode.gValue+f.findnode.hValue;(T>M||T==M&&f.findnode.gValue<s.findnode.gValue)&&(s=f)}else s=f;d.push(f)}}}if(s){for(var A=0;A<d.length;A++)if(d[A].nodeId==s.nodeId){var P=a.indexOf(s.nodeId);P>=0?a.splice(P,1):s.findnode.parentnodeId=e}else a.indexOf(d[A].nodeId)<0&&(a.push(d[A].nodeId),d[A].findnode.parentnodeId=s.nodeId);return s.nodeId}return null},e.prototype.getGridBetweenDistance=function(e,t,n){var a,i,o;if(e.isJump){if(!this.MapNodeXmlData[e.areaIndex])return[];a=this.getXYByGridIndex(e.nodeId),i=egret.Point.distance(a,t),a=this.getXYByGridIndex(e.areaIndex),o=egret.Point.distance(a,n)}else a=this.getXYByGridIndex(e.nodeId),i=egret.Point.distance(a,t),o=egret.Point.distance(a,n);return[i,o]},e.prototype.getGridBetweenHasHit=function(e,t){if(e.nodeId==t.nodeId)return!1;var n=this.getXYByGridIndex(e.nodeId),a=this.getXYByGridIndex(t.nodeId),i=Math.abs(a.x-n.x),o=Math.abs(a.y-n.y),r=e.colIndex>t.colIndex?-1:1,s=e.rowIndex>t.rowIndex?-1:1,h=0,l=0,g=Math.abs(t.colIndex-e.colIndex);h=n.x,l=n.y;for(var c=0;g>c;c++){var p=0==c?this.MAP_GRID_WIDTH/2:this.MAP_GRID_WIDTH,u=p*o/i;if(h+=p*r,l+=u*s,l%this.MAP_GRID_HEIGHT==0){var d=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2*r,l-this.MAP_GRID_HEIGHT/2*s);if(d.nodeType!=MAP_GRID_TYPE.NORMAL)return!0;var _=this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2*r,l+this.MAP_GRID_HEIGHT/2*s);if(_.nodeType!=MAP_GRID_TYPE.NORMAL)return!0}else{var m=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2,l);if(m.nodeType!=MAP_GRID_TYPE.NORMAL)return!0;this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2,l);if(m.nodeType!=MAP_GRID_TYPE.NORMAL)return!0}}var E=Math.abs(t.rowIndex-e.rowIndex);h=n.x,l=n.y;for(var c=0;E>c;c++){var u=0==c?this.MAP_GRID_HEIGHT/2:this.MAP_GRID_HEIGHT,p=u*i/o;if(h+=p*r,l+=u*s,h%this.MAP_GRID_HEIGHT==0){var d=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2*r,l-this.MAP_GRID_HEIGHT/2*s);if(d.nodeType!=MAP_GRID_TYPE.NORMAL)return!0;var _=this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2*r,l+this.MAP_GRID_HEIGHT/2*s);if(_.nodeType!=MAP_GRID_TYPE.NORMAL)return!0}else{var f=this.getNodeModelByXY(h,l-this.MAP_GRID_HEIGHT/2);if(f.nodeType!=MAP_GRID_TYPE.NORMAL)return!0;var y=this.getNodeModelByXY(h,l+this.MAP_GRID_HEIGHT/2);if(y.nodeType!=MAP_GRID_TYPE.NORMAL)return!0}}return!1},e.prototype.getGridBetweenNotHit=function(e,t){if(e.nodeId==t.nodeId)return e;var n=this.getXYByGridIndex(e.nodeId),a=this.getXYByGridIndex(t.nodeId),i=Math.abs(a.x-n.x),o=Math.abs(a.y-n.y),r=e.colIndex>t.colIndex?-1:1,s=e.rowIndex>t.rowIndex?-1:1,h=0,l=0,g=Math.abs(t.colIndex-e.colIndex);h=n.x,l=n.y;for(var c=0;g>c;c++){var p=0==c?this.MAP_GRID_WIDTH/2:this.MAP_GRID_WIDTH,u=p*o/i;
if(h+=p*r,l+=u*s,l%this.MAP_GRID_HEIGHT==0){var d=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2*r,l-this.MAP_GRID_HEIGHT/2*s);if(d.nodeType==MAP_GRID_TYPE.NORMAL)return d;var _=this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2*r,l+this.MAP_GRID_HEIGHT/2*s);if(_.nodeType==MAP_GRID_TYPE.NORMAL)return _}else{var m=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2,l);if(m.nodeType==MAP_GRID_TYPE.NORMAL)return m;this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2,l);if(m.nodeType==MAP_GRID_TYPE.NORMAL)return m}}var E=Math.abs(t.rowIndex-e.rowIndex);h=n.x,l=n.y;for(var c=0;E>c;c++){var u=0==c?this.MAP_GRID_HEIGHT/2:this.MAP_GRID_HEIGHT,p=u*i/o;if(h+=p*r,l+=u*s,h%this.MAP_GRID_HEIGHT==0){var d=this.getNodeModelByXY(h-this.MAP_GRID_WIDTH/2*r,l-this.MAP_GRID_HEIGHT/2*s);if(d.nodeType==MAP_GRID_TYPE.NORMAL)return d;var _=this.getNodeModelByXY(h+this.MAP_GRID_WIDTH/2*r,l+this.MAP_GRID_HEIGHT/2*s);if(_.nodeType==MAP_GRID_TYPE.NORMAL)return _}else{var f=this.getNodeModelByXY(h,l-this.MAP_GRID_HEIGHT/2);if(f.nodeType==MAP_GRID_TYPE.NORMAL)return f;var y=this.getNodeModelByXY(h,l+this.MAP_GRID_HEIGHT/2);if(y.nodeType==MAP_GRID_TYPE.NORMAL)return y}}return e},e}();__reflect(MapInfo.prototype,"MapInfo");var MAP_GRID_TYPE;!function(e){e[e.NORMAL=0]="NORMAL",e[e.COLLSION=1]="COLLSION",e[e.JUMP=2]="JUMP",e[e.COVER=3]="COVER"}(MAP_GRID_TYPE||(MAP_GRID_TYPE={}));var MapLayer=function(e){function t(t){var n=e.call(this)||this;return n.MapRes_Width=384,n.MapRes_Height=384,n.MapRes_RelaodNum=1,n.old_x=0,n.old_y=0,n._mainScene=t,n.onInit(),n}return __extends(t,e),t.prototype.onInit=function(){this.mapLayer=new egret.DisplayObjectContainer,this.addChild(this.mapLayer),this._resLayer=new egret.DisplayObjectContainer,this.mapLayer.addChildAt(this._resLayer,0),this._bottomLayer=new egret.DisplayObjectContainer,this.mapLayer.addChildAt(this._bottomLayer,1),this._bodyLayer=new egret.DisplayObjectContainer,this.mapLayer.addChildAt(this._bodyLayer,2),this._dmgfntLayer=new egret.DisplayObjectContainer,this.mapLayer.addChildAt(this._dmgfntLayer,3),this.mapsmallImg=new eui.Image,this._resLayer.addChildAt(this.mapsmallImg,0),this.MapResImgs=[],this.onResizeLayer()},t.prototype.onRefreshMap=function(){this.old_x=this.old_y=0;for(var e=this._resLayer.numChildren-1;e>=0;e--)if(egret.is(this._resLayer.getChildAt(e),"MapImage")){var t=this._resLayer.getChildAt(e);this.onRecoveryMapImg(t),this._resLayer.removeChild(t)}if(this._layerRefreshTime=0,this.mapurlLoadingList=[],this._mapInfo=this._mainScene.mapInfo,this._mapmodel=JsonModelManager.instance.getModelmap()[this._mapInfo.mapId],this.RES_Col_Max=Math.ceil(this._mapInfo.MAP_WIDTH/this.MapRes_Width),this.RES_Row_Max=Math.ceil(this._mapInfo.MAP_HEIGHT/this.MapRes_Height),this.mapsmallImg.source&&this._mapmodel&&RES.destroyRes("map"+this._mapmodel.resources+"_small_jpg",!1),this.mapsmallImg.source="map"+this._mapmodel.resources+"_small_jpg",this.mapsmallImg.width=this._mapmodel.width,this.mapsmallImg.height=this._mapmodel.height,this.mapsmallImg.x=this.mapsmallImg.y=0,this.cameraIsFollow&&this.onCameraFollowForBody(null),this._ismovingMap=GameFight.getInstance().isPKEffectScene,this._ismovingMap){this._scrollLayer||(this._scrollLayer=new egret.DisplayObjectContainer,this.mapLayer.addChildAt(this._scrollLayer,this.mapLayer.getChildIndex(this._resLayer)));for(var n=Math.max(0,(size.width-GameDefine.GAME_STAGE_WIDTH)/2),a=Math.ceil((size.width+40)/this._mapmodel.width),i=2,o=0;i>o;o++)for(var r=0;a>r;r++){var s=new eui.Image("map"+this._mapmodel.resources+"_small_jpg");s.width=this._mapmodel.width,s.height=this._mapmodel.height,s.x=r*this._mapmodel.width,s.y=o*-this._mapmodel.height,this._scrollLayer.addChild(s)}this._scrollLayer.x=-n-20,this.mapLayer.x=n,this.mapLayer.y=0,this.mapsmallImg.visible=!1,this._bottomLayer.visible=!1}else this.mapsmallImg.visible=!0,this._bottomLayer.visible=!0,this._scrollLayer&&(this._scrollLayer.removeChildren(),this._scrollLayer.parent&&this._scrollLayer.parent.removeChild(this._scrollLayer),this._scrollLayer=null),this.onSetHeroStagePointType(this._mapInfo.heroPointType)},t.prototype.onSetHeroStagePointType=function(e,t,n){switch(e){case CameraType.CENTER:this.updateHeroPointInStage(size.width/2,size.height/2+100);break;case CameraType.CENTERLEFT:this.updateHeroPointInStage(size.width/3,size.height/2+100);break;case CameraType.CENTERRIGHT:this.updateHeroPointInStage(size.width/1.5,size.height/2+100);break;case CameraType.AUTO:Tool.isNumber(t)&&Tool.isNumber(n)&&this.updateHeroPointInStage(t,n);break;case CameraType.OFFSET:Tool.isNumber(t)&&Tool.isNumber(n)&&this.updateHeroPointInStage(this.heroPointX+t,this.heroPointY+n)}this.logicMove()},t.prototype.updateHeroPointInStage=function(e,t){this.heroPointX=e,this.heroPointY=t},t.prototype.onCameraFollowForBody=function(e){if(e){this.cameraIsFollow||(this.cameraIsFollow=!0,this.onCheckBodyIsView());var t=-(e.x-this.heroPointX);this.mapLayer.x=t,this.mapLayer.x<=-this._mapInfo.mapMaxX?this.mapLayer.x=-this._mapInfo.mapMaxX:this.mapLayer.x>=0&&(this.mapLayer.x=0);var n=-(e.y-this.heroPointY);this.mapLayer.y=n,this.mapLayer.y<=-this._mapInfo.mapMaxY?this.mapLayer.y=-this._mapInfo.mapMaxY:this.mapLayer.y>=0&&(this.mapLayer.y=0),this.onlogicShadow(),this.moveMapResLayer(),this.layerOrderHandler()}else this.cameraIsFollow=!1},t.prototype.onResizeLayer=function(){if(this._ismovingMap);else{var e=Math.ceil(size.width/this.MapRes_Width)+2*this.MapRes_RelaodNum,t=Math.ceil(size.height/this.MapRes_Height)+2*this.MapRes_RelaodNum;if(e!=this.mapimgColNum||this.mapimgRowNum!=t){var n=Tool.isNumber(this.mapimgColNum);this.mapimgColNum=e,this.mapimgRowNum=t,n&&(this.old_x=0,this.old_y=0,this.onSetHeroStagePointType(this._mapInfo.heroPointType))}}},t.prototype.onchangeMapLayerPos=function(){var e=this._mainScene.heroBody,t=-(e.x-this.heroPointX);this.mapLayer.x=t,this.mapLayer.x<=-this._mapInfo.mapMaxX?this.mapLayer.x=-this._mapInfo.mapMaxX:this.mapLayer.x>=0&&(this.mapLayer.x=0);var n=-(e.y-this.heroPointY);this.mapLayer.y=n,this.mapLayer.y<=-this._mapInfo.mapMaxY?this.mapLayer.y=-this._mapInfo.mapMaxY:this.mapLayer.y>=0&&(this.mapLayer.y=0)},t.prototype.onscrollMapimage=function(){if(this._scrollLayer)for(var e=0;e<this._scrollLayer.numChildren;e++){var t=this._scrollLayer.getChildAt(e);t.y+=10,t.y>=t.height&&(t.y=-t.height)}},t.prototype.logicMove=function(){return this._ismovingMap?(this.onscrollMapimage(),this.onlogicShadow(),!1):this.cameraIsFollow?!1:(this.onchangeMapLayerPos(),(this.old_x!=this.mapLayer.x||this.old_y!=this.mapLayer.y)&&(this.moveMapResLayer(),this.old_x=this.mapLayer.x,this.old_y=this.mapLayer.y,this.layerOrderHandler()),this.onlogicShadow(),this.onCheckBodyIsView(),!1)},t.prototype.getMapImageIdx=function(e,t){return e*Math.ceil(this._mapInfo.MAP_WIDTH/this.MapRes_Width)+t+1},t.prototype.onRecoveryMapImg=function(e){e.texture&&(e.texture.dispose(),RES.destroyRes(e.url)),e.url=null,e.texture=null,e.rowNum=null,e.colNum=null,this.MapResImgs.indexOf(e)<0&&this.MapResImgs.push(e)},t.prototype.moveMapResLayer=function(){if(!this._ismovingMap){for(var e=-this.mapLayer.x-this.MapRes_Width*this.MapRes_RelaodNum,t=-this.mapLayer.y-this.MapRes_Height*this.MapRes_RelaodNum,n=Math.max(0,Math.floor(e/this.MapRes_Width)),a=Math.max(0,Math.floor(t/this.MapRes_Height)),i=Math.min(n+this.mapimgColNum,this.RES_Col_Max),o=Math.min(a+this.mapimgRowNum,this.RES_Row_Max),r=[],s=this._resLayer.numChildren-1;s>=0;s--)if(egret.is(this._resLayer.getChildAt(s),"MapImage")){var h=!1,l=this._resLayer.getChildAt(s);if(l.colNum<n||l.colNum>=i?h=!0:(l.rowNum<a||l.rowNum>=o)&&(h=!0),h)this.onRecoveryMapImg(l);else{var g=this.getMapImageIdx(l.rowNum,l.colNum);r.push(g)}}for(var c=a;o>c;c++)for(var p=n;i>p;p++){var u=this.getMapImageIdx(c,p);if(!(r.indexOf(u)>=0)){var d=void 0;d=0==this.MapResImgs.length?new MapImage:this.MapResImgs.shift(),d.parent||this._resLayer.addChild(d),d.rowNum=c,d.colNum=p,d.x=p*this.MapRes_Width,d.y=c*this.MapRes_Height;var _=LoadManager.getInstance().getMapResUrl(this._mapmodel.resources,u);this.onLoadMapImage(d,_)}}}},t.prototype.onLoadMapImage=function(e,t){for(var n in this.mapurlLoadingList){var a=this.mapurlLoadingList[n][0];if(a===e){var i=this.mapurlLoadingList[n][1];if(i==t)return;this.mapurlLoadingList.splice(n,1);break}}this.mapurlLoadingList.push([e,t]),this.onLoadingMapImgHandler()},t.prototype.onLoadingMapImgHandler=function(){if(!this.loadingMapImg&&0!=this.mapurlLoadingList.length){var e=this.mapurlLoadingList.shift();this.loadingMapImg=e[0];var t=e[1];RES.getResByUrl(t,this.onLoadImgComplete,this,RES.ResourceItem.TYPE_IMAGE)}},t.prototype.onLoadImgComplete=function(e,t){t.indexOf("resource/mapres/"+this._mapmodel.resources)>=0?(this.loadingMapImg.url=t,this.loadingMapImg.texture=e):(e.dispose(),RES.destroyRes(t),e=null),this.loadingMapImg=null,this.onLoadingMapImgHandler()},t.prototype.addBodyToMaplayer=function(e,t){if(egret.is(e,"EffectBody")?e.isUnder?this._bodyLayer.addChildAt(e,0):this._bodyLayer.addChild(e):(egret.is(e,"IMapOrder")&&(e.mapOrder=-1),0>t?this.insertBodyToLayer(e):this._bodyLayer.addChildAt(e,t)),egret.is(e,"ActionBody")){var n=this._mapInfo.getNodeModelByXY(e.x,e.y);n&&n.isCover?e.onSetCover(!0):e.onSetCover(!1),this.onCreateShadow(e)}},t.prototype.insertBodyToLayer=function(e){if(egret.is(e,"ActionBody")&&e.data.bodyType==BODY_TYPE.SELF)return this._bodyLayer.addChild(e),this._layerRefreshTime=0,void this.layerOrderHandler();for(var t,n=0;n<this._bodyLayer.numChildren;n++){var a=this._bodyLayer.getChildAt(n);if(egret.is(a,"IMapOrder")&&a.y>=e.y){this._bodyLayer.addChildAt(e,n-1),t=!0;break}}t||this._bodyLayer.addChild(e)},t.prototype.addToDamageFntLayer=function(e){this._dmgfntLayer.addChild(e)},t.prototype.removeBodyLayerAll=function(){this._bodyLayer.removeChildren(),this._dmgfntLayer.removeChildren(),this.removeAllShadow()},t.prototype.onCheckBodyIsView=function(){for(var e,t=0;t<this._bodyLayer.numChildren;t++)e=this._bodyLayer.getChildAt(t),this.onCheckPosInMapView(e.x,e.y)?e.visible=!0:e.visible=!1;for(var t=0;t<this._bottomLayer.numChildren;t++)e=this._bodyLayer.getChildAt(t),this.onCheckPosInMapView(e.x,e.y)?e.visible=!0:e.visible=!1},t.prototype.layerOrderHandler=function(){if(!(this._layerRefreshTime>egret.getTimer())){for(var e=[],t=[],n=0;n<this._bodyLayer.numChildren;n++){var a=this._bodyLayer.getChildAt(n);egret.is(a,"EffectBody")&&a.isUnder?e.push(a):egret.is(a,"IMapOrder")&&t.push(a)}this._layerRefreshTime=egret.getTimer()+1e3;for(var n=0;n<t.length;n++){var i=t[n];i.visible&&i.updateY()}t.sort(function(e,t){return e.mapY-t.mapY});for(var n=0;n<t.length;n++){var i=t[n],o=i.mapOrder;if(o!=n){e.length+n;this._bodyLayer.setChildIndex(i,n),i.mapOrder=n+1}}}},t.prototype.onCreateShadow=function(e){if(!GameFight.getInstance().isPKEffectScene&&e){for(var t,n=this.shadowBodys.length-1;n>=0;n--){var a=this.shadowBodys[n];if(a.ownerbody){if(a.ownerbody===e)return}else this.removeOneShadow(a)}t=BodyFactory.instance.onCreateShadow(e),this.shadowBodys.push(t),this._bottomLayer.addChild(t)}},t.prototype.onlogicShadow=function(){for(var e=this.shadowBodys.length-1;e>=0;e--){var t=this.shadowBodys[e];t.ownerbody&&t.ownerbody.parent?t.updatePos():this.removeOneShadow(t)}},t.prototype.removeOneShadow=function(e){BodyFactory.instance.onRecoveryShadow(e);var t=this.shadowBodys.indexOf(e);t>=0&&this.shadowBodys.splice(t,1)},t.prototype.removeAllShadow=function(){if(this.shadowBodys)for(var e=this.shadowBodys.length-1;e>=0;e--){var t=this.shadowBodys[e];this.removeOneShadow(t)}else this.shadowBodys=[]},Object.defineProperty(t.prototype,"heroPosByModule",{get:function(){var e=[];return e[0]=this._mainScene.heroBody.x+this.mapLayer.x,e[1]=this._mainScene.heroBody.y+this.mapLayer.y,e},enumerable:!0,configurable:!0}),t.prototype.onCheckPosInMapView=function(e,t){if(this.cameraIsFollow)return!0;var n=this._mainScene.heroBody;return Math.abs(n.x-e)>size.width/2+50?!1:Math.abs(n.y-t)>size.height/2+50?!1:!0},t.prototype.onGary=function(e){if(e){this._mapGaryMask||(this._mapGaryMask=new egret.Shape,this._mapGaryMask.graphics.clear(),this._mapGaryMask.graphics.beginFill(0,.8),this._mapGaryMask.graphics.drawRect(0,0,2*size.width,2*size.height),this._mapGaryMask.graphics.endFill());var t=this._mainScene.heroBody;this._mapGaryMask.x=t.x-size.width,this._mapGaryMask.y=t.y-size.height,this.mapLayer.addChildAt(this._mapGaryMask,1)}else this._mapGaryMask&&this._mapGaryMask.parent&&this._mapGaryMask.parent.removeChild(this._mapGaryMask)},t}(egret.DisplayObjectContainer);__reflect(MapLayer.prototype,"MapLayer");var CameraType;!function(e){e[e.AUTO=0]="AUTO",e[e.CENTER=1]="CENTER",e[e.CENTERLEFT=2]="CENTERLEFT",e[e.CENTERRIGHT=3]="CENTERRIGHT",e[e.OFFSET=4]="OFFSET"}(CameraType||(CameraType={}));var MapImage=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Image);__reflect(MapImage.prototype,"MapImage");var ModuleLayer=function(e){function t(t){var n=e.call(this)||this;return n.allwindows={},n.guidecheckTime=0,n.pointCheckTime=0,n.mainScene=t,n.mainviewBar=new egret.DisplayObjectContainer,n.addChild(n.mainviewBar),n.dropLayer=new egret.DisplayObjectContainer,n.addChild(n.dropLayer),n.dramaBar=new egret.DisplayObjectContainer,n.addChild(n.dramaBar),n.PupoBar=new egret.DisplayObjectContainer,n.addChild(n.PupoBar),n.playerMessagePanel=new egret.DisplayObjectContainer,n.addChild(n.playerMessagePanel),n.gameloadingUI=new GameLoadingLayer(n),n._mainView=new MainView(n),n.mainviewBar.addChild(n._mainView),n._main_btnpro=new MainVIew_btnBar,n.systemMessagePanel=new egret.DisplayObjectContainer,n.systemMessagePanel.touchEnabled=!1,n.addChild(n.systemMessagePanel),n.loadingBar=new egret.DisplayObjectContainer,n.addChild(n.loadingBar),n.viewmask=new egret.Shape,n.viewmask.touchEnabled=!0,n.onRegist(),n.onStageResize(),Tool.addTimer(n.onTimerDown,n,1e3),n}return __extends(t,e),t.prototype.onRegist=function(){GameDispatcher.getInstance().addEventListener(GameEvent.MODULE_WINDOW_OPEN,this.onOpenWindow,this),GameDispatcher.getInstance().addEventListener(GameEvent.MODULE_WINDOW_CLOSE,this.onCloseWindow,this),GameDispatcher.getInstance().addEventListener(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM,this.onOpenWindowWithParam,this),GameDispatcher.getInstance().addEventListener(GameEvent.MODULE_GOTYPE_OPEN_WINDOW,this.gotypeHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_REDPOINT_TRIGGER.toString(),this.trigger,this),GameDispatcher.getInstance().addEventListener(GameEvent.MODULE_WINDOW_ALLREMOVED.toString(),this.onEventRemoveWindow,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_OBTAINHINT_SHOW.toString(),this.onShowObtHintBar,this),GameDispatcher.getInstance().addEventListener(GameEvent.LOADING_OPEN.toString(),this.loadingOpen,this),GameDispatcher.getInstance().addEventListener(GameEvent.LOADING_CLOSE.toString(),this.loadingClose,this),this._mainView.addEventListener(egret.Event.ADDED,this.mainviewAdded,this)},t.prototype.loadingOpen=function(){this.loadingPanel||(this.loadingPanel=new WaitLoadingPanel,this.loadingBar.addChild(this.loadingPanel)),this.loadingPanel.resetPanel(size.width,size.height),this.loadingPanel.loadStart(),this._isLoadingUI=!0},t.prototype.loadingClose=function(){this._isLoadingUI=!1,this.loadingPanel&&this.loadingPanel.loadClose(),this.guideParam&&Tool.callbackTime(this.onCheckGuideHanlde,this,500)},t.prototype.onResetUIResource=function(e){this.removeAllWindows(),LoadManager.getInstance().resetAllUIResources()},t.prototype.mainviewAdded=function(e){LoadManager.getInstance().addMainvewImageAry(e.currentTarget)},t.prototype.onStageResize=function(){this._mainView.resize(),DataManager.IS_PC_Game?(this.PupoBar.x=Globar_Pos.x,this.playerMessagePanel.x=Globar_Pos.x,this.systemMessagePanel.x=Globar_Pos.x):this.PupoBar.x=(size.width-GameDefine.GAME_STAGE_WIDTH)/2,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.6),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,size.width,size.height),this.viewmask.graphics.endFill(),this.gameloadingUI.width=size.width,this.gameloadingUI.height=size.height,this._main_btnpro.resize()},t.prototype.onReLoginSereverHandler=function(){this._mainView.onInit(),this.removeAllWindows()},t.prototype.onTouchMessageBg=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"NoticePanel")},t.prototype.onOpenWindow=function(e){var t=e.data;this.onOpenWindowHandler(t)},t.prototype.onOpenWindowWithParam=function(e){var t=e.data;t&&this.onOpenWindowHandler(t.windowName,t.param)},t.prototype.onOpenWindowHandler=function(e,t){if(void 0===t&&(t=null),window[e]&&!this._isLoadingUI){if(SDKManager.isHidePay){var n=Constant.get(Constant.FANGKUAIWAN_IOS_HIDE_PANEL);if(n.indexOf(e)>=0)return}var a;this.allwindows[e]?a=this.allwindows[e]:window[e]&&(a=new window[e](this),this.allwindows[e]=a),a&&(a.priority==PANEL_HIERARCHY_TYPE.I&&this.removeAllWindows(),null!=t?a.onShowWithParam(t):a.onShow(),this.onControlBasePopWindow(e),this.onCheckShowMapLayer(),this._mainView.onHideBtnGroup())}},t.prototype.onControlBasePopWindow=function(e){switch(e){case"RolePanel":if(this._obtainHintBars&&this._obtainHintBars[HINT_TIPS_TYPE.EQUIP]){var t=this._obtainHintBars[HINT_TIPS_TYPE.EQUIP];t.onDestory()}}},t.prototype.onCloseWindow=function(e){var t=e.data;if(t&&this.allwindows[t]){var n=this.allwindows[t];n.isShow&&n.onHide()}},t.prototype.onShowOrHideMaskView=function(){var e=-1;this.viewmask.parent&&this.viewmask.parent.removeChild(this.viewmask);for(var t=this.PupoBar.numChildren-1;t>=0;t--){var n=this.PupoBar.getChildAt(t);if(n&&n.priority==PANEL_HIERARCHY_TYPE.II){e=t;break}}e>=0&&this.PupoBar.addChildAt(this.viewmask,e)},t.prototype.onEventRemoveWindow=function(e){this.onCheckShowMapLayer(),this._mainView.addMainBtnBar()},t.prototype.onCheckShowMapLayer=function(){for(var e=!0,t=this.PupoBar.numChildren-1;t>=0;t--){var n=this.PupoBar.getChildAt(t);if(n.priority==PANEL_HIERARCHY_TYPE.I){e=!1;break}}this.showorhideMainviewBar(e),this.mainScene.onShowOrHideMapLayer(!e),DataManager.IS_PC_Game||(e?this.panelBackImg&&this.panelBackImg.parent&&this.panelBackImg.parent.removeChild(this.panelBackImg):(this.panelBackImg||(this.panelBackImg=new eui.Image),this.panelBackImg.parent||(this.panelBackImg.source&&(this.panelBackImg.source=null),this.panelBackImg.source="public_panel_back_png",this.PupoBar.addChildAt(this.panelBackImg,0))))},t.prototype.addToDropLayer=function(e){this.dropLayer.addChild(e)},t.prototype.iconToBagEffect=function(e){if(e)try{var t=e.localToGlobal(),n=new eui.Image(e.source);n.width=e.width,n.height=e.height;var a=this._mainView.getTargetPointByFuncId(FUN_TYPE.FUN_ITEMBAG),i=new CurvilinearBody(n,t,a,30,50);this.dropLayer.addChild(i),egret.Tween.get(i).to({factor:1},500).call(this.onDestroyFuncbody,this,[i])}catch(o){}},t.prototype.addFuncToDropLayer=function(e){if(this.visible){var t=this._mainView.getTargetPointByFuncId(e.id);if(!t)return void this.onDestroyFuncbody(e);t.x=t.x-10,t.y=t.y-10,null!=t&&(this.mainviewBar.addChild(e),TweenLiteUtil.beelineTween(e,this.onDestroyFuncbody,this,t,1e3))}},t.prototype.onDestroyFuncbody=function(e){egret.Tween.removeTweens(e),e.onDestroy(),e=null},t.prototype.onRefreshScene=function(){this.dropLayer.removeChildren(),this.stroyIsShow()&&this.storyPanel.onHide(),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG?this.guideParam&&this.onStartOneGuide():this._guideBar&&this._guideBar.parent&&this._guideBar.onHide(),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.UNION_BATTLE?this._mainView.visible=!1:this._mainView.visible=!0,SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&this._mainView.refreshIosPayHide()},t.prototype.removeAllWindows=function(){for(;this.PupoBar.numChildren>0;){var e=this.PupoBar.getChildAt(0);egret.is(e,"BaseWindowPanel")?e.onHide():this.PupoBar.removeChildAt(0)}},t.prototype.onShowStoryView=function(e,t){void 0===t&&(t=null),this.storyPanel&&this.storyPanel.parent||(this.storyPanel||(this.storyPanel=new StoryPanel,this.storyPanel.x=Globar_Pos.x),this.storyPanel.onshowStroy(e,t),this.showorhideMainviewBar(!1),this.dramaBar.addChild(this.storyPanel))},t.prototype.onHideStroyView=function(){this.storyPanel.onHide(),this.showorhideMainviewBar(!0)},t.prototype.stroyIsShow=function(){return this.storyPanel?null!=this.storyPanel.parent:!1},t.prototype.onshowGameloadingUI=function(e,t,n){this.gameloadingUI.startLoading(e,t,n)},t.prototype.onPlayPassSceneAnim=function(){if(this._loadingMask){this._isplayLoading=!0,this.mainviewBar.addChild(this._loadingMask),this._loadingMask.x=size.width/2,this._loadingMask.y=size.height/2,this._loadingMask.scaleX=this._loadingMask.scaleY=0;var e=Math.ceil(size.width/60),t=Math.ceil(size.height/120);egret.Tween.get(this._loadingMask).to({scaleX:e,scaleY:t},300).call(this.onHidePassSceneAnim,this)}else this._loadingMask=new eui.Image,this._loadingMask.source="prompt_mask_lingxing_png",this._loadingMask.anchorOffsetX=110,this._loadingMask.anchorOffsetY=170},t.prototype.onHidePassSceneAnim=function(){this._isplayLoading&&(this._isplayLoading=!1,egret.Tween.removeTweens(this._loadingMask),egret.Tween.get(this._loadingMask).to({scaleX:0,scaleY:0},300,egret.Ease.circOut).call(function(e){e.parent&&e.parent.removeChild(e),egret.Tween.removeTweens(e)},this,[this._loadingMask]))},t.prototype.onShowFuncTipsBar=function(e,t){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG){this.funcTipsBarMap||(this.funcTipsBarMap={});var n;switch(e){case FUNCTIP_TYPE.BOSS_REMIND:n=this._mainView.bottom_btnbar_grp;break;case FUNCTIP_TYPE.BAGFULL:n=this._main_btnpro.btn_bag}if(n){this.funcTipsBarMap[e]||(this.funcTipsBarMap[e]=new FuncTipsBar);var a=this.funcTipsBarMap[e];if(a.param)a.param.desc!=t&&(a.param.desc=t,a.onShow(a.param));else{var i=new FuncTipsObj(e,t);switch(i.parentTarget=n,i.type){case FUNCTIP_TYPE.BOSS_REMIND:i.offX=-120,i.offY=-60,i.autoClose=30;break;case FUNCTIP_TYPE.BAGFULL:i.offX=-140,i.offY=-70}this.addToMainview(a),a.onShow(i)}}}},t.prototype.onHideFuncTipsBar=function(e){if(void 0===e&&(e=null),this.funcTipsBarMap){var t;if(e)t=this.funcTipsBarMap[e],t&&t.onHide();else for(var n in this.funcTipsBarMap)t=this.funcTipsBarMap[n],t.parent&&t.onHide()}},t.prototype.onShowBossHpBar=function(e){this.bossTargetBar||(this.bossTargetBar=new BossTargetBar,this.bossTargetBar.top=180,this.bossTargetBar.horizontalCenter=0),this.bossTargetBar.parent||(this.bossTargetBar.onTarget(e),this._mainView.addChild(this.bossTargetBar))},t.prototype.onUpdateBossHpBar=function(e,t){void 0===t&&(t=0),this.bossTargetBar&&this.bossTargetBar.onUpdateProgress(e,t)},t.prototype.onHideBossHpBar=function(){this.bossTargetBar&&this.bossTargetBar.onRemove()},t.prototype.onDamageRankBar=function(e){this._damagerankBar||(this._damagerankBar=new DamageRankBar),e&&!this._damagerankBar.parent?(this.addToMainview(this._damagerankBar),this._damagerankBar.x=size.width-290,this._damagerankBar.y=size.height-660,this._damagerankBar.onRegist()):!e&&this._damagerankBar.parent&&this._damagerankBar.onRemove()},t.prototype.onUpdateDamageRank=function(e,t){this._damagerankBar&&this._damagerankBar.parent||this.onDamageRankBar(!0),this._damagerankBar.onUpdate(e,t)},t.prototype.onShowOhterHpBar=function(e,t,n){this.otherTargetBar||(this.otherTargetBar=new OtherTargetBar,this.otherTargetBar.top=270,this.otherTargetBar.horizontalCenter=20),this.otherTargetBar.parent||this._mainView.addChild(this.otherTargetBar),this.otherTargetBar.onTarget(e,t,n)},t.prototype.onUpdateOtherHpBar=function(e,t){void 0===t&&(t=0),this.otherTargetBar&&this.otherTargetBar.onUpdateProgress(e,t)},t.prototype.onHideOhterHpBar=function(){this.otherTargetBar&&this.otherTargetBar.onRemove()},t.prototype.addToMainview=function(e){this.mainviewBar.addChild(e)},t.prototype.showorhideMainviewBar=function(e){if(e){if(this.storyPanel&&this.storyPanel.parent)return;this.mainviewBar.visible||(LoadManager.getInstance().onClearAllBodyAnimCache(!1),LoadManager.getInstance().removeloadAllUIImage(),this.mainviewBar.visible=!0)}else this.mainviewBar.visible=!1},t.prototype.onShowObtHintBar=function(e){var t=e.data;this._obtainHintBars||(this._obtainHintBars={});var n=this._obtainHintBars[t.type];if(!n){switch(t.type){case HINT_TIPS_TYPE.EQUIP:n=new ObtainHintEquip}this._obtainHintBars[t.type]=n}n&&!n.parent&&(n.x=size.width-255,n.onShow(this.mainviewBar),n.data=t)},t.prototype.onShowPassProceedsView=function(){this._xiaolvView||(this._xiaolvView=new DupguankaxiaolvPanel(this)),this._xiaolvView.x=Globar_Pos.x,this._xiaolvView.onRefresh(),this.addToMainview(this._xiaolvView)},t.prototype.showorhideDupRebornBar=function(e){this.samsarabar||(this.samsarabar=new SamsaraFuncBar),e?this.samsarabar.parent||(this.addToMainview(this.samsarabar),this.samsarabar.x=size.width/2-50,this.samsarabar.y=size.height-280,this.samsarabar.onRegistSamsaraBar()):this.samsarabar.parent&&(this.samsarabar.parent.removeChild(this.samsarabar),this.samsarabar.onRemoveSamsaraBar())},t.prototype.onShowSamsaraReborn=function(e){this.samsarabar&&this.samsarabar.onStartSamsaraRebornTime(e)},t.prototype.onHideSamsaraReborn=function(){this.samsarabar&&this.samsarabar.onStopSamsaraRebornTime()},t.prototype.playBossIncomingAnim=function(){if(!this._playIncomingBl){this._playIncomingBl=!0,this._incomingBar||(this._incomingBar=new eui.Component,this._incomingBar.skinName=skins.BossIncomingBarSkin,this._incomingBar.x=10,this._incomingBar.y=size.height-430,this._incomingBar.scaleX=.8,this._incomingBar.scaleY=.8);var e=this._incomingBar.back_grp;e.x=-500;var t=this._incomingBar.font_grp;t.x=800,egret.Tween.get(e).to({x:0},600),egret.Tween.get(t).to({x:140},600,egret.Ease.circIn),this.addToMainview(this._incomingBar),Tool.callbackTime(this.overBossIncomeingAnim,this,3e3)}},t.prototype.overBossIncomeingAnim=function(){if(this._incomingBar&&this._incomingBar.parent){this._incomingBar.parent&&this._incomingBar.parent.removeChild(this._incomingBar);var e=this._incomingBar.back_grp;e&&egret.Tween.removeTweens(e);var t=this._incomingBar.font_grp;t&&egret.Tween.removeTweens(t)}this._playIncomingBl=!1},t.prototype.gotypeHandler=function(e){var t,n=e.data;switch(n){case FUN_TYPE.FUN_OPENFUNC:return void this.onOpenWindowHandler("OpenFuncView")}if(!FunDefine.onIsLockandErrorHint(n)&&n>0){if(99999==n)return void GameCommon.getInstance().addAlert("qianwang1");var a=JsonModelManager.instance.getModelfunctionLv()[n];if(!a)return;t=new WindowParam(a.param,a.id),n==FUN_TYPE.FUN_SHOP_JIFEN||n==FUN_TYPE.FUN_SHOP_PUTONG||n==FUN_TYPE.FUN_SHOP_SHENMI||n==FUN_TYPE.FUN_SHOP_RONGYU?ShopDefine.openDefaultShopView():n==FUN_TYPE.FUN_PVE?(this.removeAllWindows(),this.onOpenWindowHandler(a.param)):(e.data=t,this.onOpenWindowWithParam(e))}},t.prototype.onStartOneGuide=function(){var e=DataManager.getInstance().taskManager.guideTaskData;if(e&&e.model&&e.model.jackaroo>0&&!e.isFinish){var t=e.model.jackaroo,n=new GuideParam(t);n.models.length>0&&(this.guideParam=n,this.onCheckGuideHanlde())}else this.onCompleteGuide()},t.prototype.onCheckGuideHanlde=function(){if(this.guideParam&&!this._isLoadingUI)if(this.guidecheckTime=0,this.guideParam.isEnd)this.onCompleteGuide();else{var e=this.guideParam.model,t=DataManager.getInstance().taskManager.guideTaskData;if(!t||!t.model)return void this.onCompleteGuide();var n=void 0;if("$Mainview"==e.panel)n=this._mainView;else if("$MainviewBtnsBar"==e.panel)n=this._main_btnpro;else if(this.PupoBar.numChildren>0){var a=this.PupoBar.getChildAt(this.PupoBar.numChildren-1);egret.is(a,"BaseWindowPanel")&&(n=a)}if(!n)return;this.guideParam.parentContainer=n,this.guideParam.isComplete=!1,this.onShowGuideBar()}},t.prototype.onContiuneGuide=function(){this.guideParam&&(this.guideParam.onContiune(),Tool.callbackTime(this.onCheckGuideHanlde,this,300))},t.prototype.onCompleteGuide=function(){this.guideParam&&(this._guideBar&&this._guideBar.onDestroy(),this.guideParam=null)},t.prototype.onShowGuideBar=function(){this.guideParam&&GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&(this.guideParam.parentContainer===this._mainView&&this.PupoBar.numChildren>0||(this._guideBar||(this._guideBar=new GameGuideBar(this)),this._guideBar.onShow(this.guideParam)))},t.prototype.onQuitGuide=function(e){this.guideParam&&0==this.PupoBar.numChildren&&("$close"==this.guideParam.model.target&&this.guideParam.isLastOne?this.onCompleteGuide():this.onStartOneGuide())},t.prototype.getPanel=function(e){return this.allwindows[e]},t.prototype.onTimerDown=function(){0==this.PupoBar.numChildren&&this.pointCheckTime<egret.getTimer()&&(this.mainviewPointRefresh(),this.mainbtnbarUI.trigger(),this.pointCheckTime=5e3+egret.getTimer()),this._mainView.onTimeDown(),this.guideParam&&this.guideParam.againCount>0&&(0==this.guidecheckTime&&(this.guidecheckTime=egret.getTimer()+500),egret.getTimer()>this.guidecheckTime&&(this.guideParam.againCount=Math.max(this.guideParam.againCount-1,0),this.guidecheckTime=egret.getTimer()+500,this.onCheckGuideHanlde()))},t.prototype.mainviewPointRefresh=function(e){void 0===e&&(e=!1),this._mainView.trigger(e)},t.prototype.trigger=function(e){var t=e.data;if(t.systemID){var n=this.allwindows[t.systemID];n&&n.isShow&&n.trigger()}if(this.PupoBar.numChildren>0)for(var a in this.allwindows)this.allwindows[a].isShow&&this.allwindows[a].trigger&&this.allwindows[a].trigger()},Object.defineProperty(t.prototype,"mainbtnbarUI",{get:function(){return this._main_btnpro},enumerable:!0,configurable:!0}),t}(egret.DisplayObjectContainer);__reflect(ModuleLayer.prototype,"ModuleLayer");var HttpUtil=function(){function e(){}return e.sendGetRequest=function(e,t,n){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open(e,egret.HttpMethod.GET),a.setRequestHeader("Content-Type","text/plain"),a.send(),t&&a.addEventListener(egret.Event.COMPLETE,t,n)},e.sendPostStringRequest=function(e,t,n,a){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(e,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","text/plain"),i.send(a),t&&i.addEventListener(egret.Event.COMPLETE,t,n)},e}();__reflect(HttpUtil.prototype,"HttpUtil");var SDKManager=function(){function e(){}return e.getHandler=function(t){var n=t;n||(n=e.loginInfo.channel);var a=EChannel[n];return e._handlers[a]},e.getHandlerAny=function(){var t=e.loginInfo.channel,n=EChannel[t];return e._handlers[n]},e.getStatistics=function(t){var n=t;n||(n=e.loginInfo.channel);var a=EChannel[n];return e._statistics[a]},e.init=function(){try{window.gamesdk&&this.isSDKLogin&&(this.loginInfo=window.gamesdk,this.loginInfo.url=ChannelDefine.getUrl(this.loginInfo.channel));var t=e.getHandler();t?!platform.isLocalTest()&&this.isSDKLogin?(t.info=this.loginInfo,t.init(),t.login()):(t.info=this.loginInfo,this._loginFlag=!0):this._loginFlag=!0}catch(n){Tool.throwException("缺少渠道信息！！！")}},e.loginSuccessCallBack=function(){this._loginFlag=!0,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_SDK_LOGIN_OK))},e.loginFailCallBack=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_SDK_LOGIN_FAIL))},e.retry=function(){},e.getChannel=function(){return e.loginInfo.channel},Object.defineProperty(e,"sdkLogin",{get:function(){return this._loginFlag},enumerable:!0,configurable:!0}),e.pay=function(t,n){var a=e.getHandler();a&&a.pay(t,n)},e.onCompleteSDK=function(){var t=e.getStatistics();t&&t.onCompleteSDK(e.loginInfo)},e.onEnterGame=function(t){this.loginInfo.playerId=t.id;var n=e.getHandler();n&&n.onEnterGame&&n.onEnterGame(this.loginInfo,t);var a=e.getStatistics();a&&a.onEnterGame(e.loginInfo,t)},e.onCreateRole=function(t){egret.log("进入游戏建角成功 onCreateRole（）");var n=e.getHandler();n&&n.onCreateRole&&n.onCreateRole(this.loginInfo,t);var a=e.getStatistics();a&&a.onCreateRole(e.loginInfo,t)},e.onPaySuccess=function(t,n){var a=e.getStatistics();a&&a.onPay(e.loginInfo,t,n)},e.getFocusSkin=function(){return null},e.subscribe=function(){var t=e.getHandler();t&&t.subscribe&&t.subscribe()},e.getShareSkin=function(){return null
},e.share=function(t,n){var a=e.getHandler();a&&a.share&&a.share(t,n)},e.getShareInfoSkin=function(){return null},e.onDiamondUpdate=function(e,t,n){},e.onMoneyUpdate=function(e,t,n){},e.onLevelUp=function(t){var n=e.getHandler();n&&n.onLevelup&&n.onLevelup(e.loginInfo,t)},Object.defineProperty(e,"gamename",{get:function(){return this.loginInfo.gamename},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isHidePay",{get:function(){try{if(!DataManager.IOS_PAY_ISOPEN)return!0;if(DataManager.IOS_PAY_ZONETIME||DataManager.IOS_PAY_OPENDATE){if(this._currDate?this._currDate.setTime(DataManager.getInstance().playerManager.player.curServerTime):this._currDate=new Date(DataManager.getInstance().playerManager.player.curServerTime),DataManager.IOS_PAY_OPENDATE&&DataManager.IOS_PAY_OPENDATE.length>0){var e=this._currDate.getFullYear(),t=this._currDate.getMonth(),n=this._currDate.getDay(),a=e+"-"+(10>t?"0"+t:t)+"-"+(10>n?"0"+n:n);if(-1==DataManager.IOS_PAY_OPENDATE.indexOf(a))return!0}if(DataManager.IOS_PAY_ZONETIME)for(var i=0;i<DataManager.IOS_PAY_ZONETIME.length;i++){var o=DataManager.IOS_PAY_ZONETIME[i].split("-"),r=o[0].split(":"),s=60*parseInt(r[0])+parseInt(r[1]),h=o[1].split(":"),l=60*parseInt(h[0])+parseInt(h[1]),g=60*this._currDate.getHours()+this._currDate.getMinutes();if(s>l){if(g>l&&s>l)return!0}else if(s>g||g>l)return!0}}if(this._iosPayOpen)return!1;var c=DataManager.getInstance().playerManager.player;if(DataManager.IOS_PAY_OPENMISSION<=GameFight.getInstance().yewai_waveIndex||DataManager.IOS_PAY_LEVEL<=c.level)return this._iosPayOpen=!0,!1}catch(p){egret.log("~~~ERROR!!! FOR IOS PAY SERVER PARAM!!")}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isIphone",{get:function(){var e=this.loginInfo.wx_phone_sysinfo;return e&&e.model.indexOf("iPhone")>=0?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isBangsscreen",{get:function(){if(this.loginInfo.wx_phone_sysinfo)for(var e=this.loginInfo.wx_phone_sysinfo,t=["iPhone X","zenfone5","novs3e","OPPO R15","OPPO A3","BKL-AL20","LYA-AL00","CLT-AL0","VIVO X21","VIVO Y85","OnePlus 6"],n=0;n<t.length;n++)if(e.model.indexOf(t[n])>=0)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"islowphone",{get:function(){if(null==this._islowphone&&(this._islowphone=!1,this.loginInfo.wx_phone_sysinfo)){var e=this.loginInfo.wx_phone_sysinfo,t=e.system;if(t&&t.indexOf("Android")>-1){var n=t.substr(t.indexOf("android")+8,3);/4.|5./i.test(n)&&(this._islowphone=!0)}}return this._islowphone},enumerable:!0,configurable:!0}),e.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?n[2].toString():null},e.loginInfo={gamename:"极品散仙",serverName:"",channel:EChannel.CHANNEL_WXGAMEBOX,subChannel:EChannel.CHANNEL_WXGAMEBOX,serverId:null,url:ChannelDefine.getUrl(EChannel.CHANNEL_WXGAMEBOX),account:null,playerId:null,sign:null,platform:EPlatform.PLATFORM_NONE},e._handlers={CHANNEL_AWY:SDKAWY.getInstance(),CHANNEL_CRAZY:SDKCrazy.getInstance(),CHANNEL_YYB:SDKYYB.getInstance(),CHANNEL_EGRET:SDKEgret.getInstance(),CHANNEL_WANBA:SDKWanBa.getInstance(),CHANNEL_JINBANG:SDKJinBang.getInstance(),CHANNEL_360:SDK360.getInstance(),CHANNEL_QUICK:SDKQuick.getInstance(),CHANNEL_SHENQI:SDKShenQi.getInstance(),CHANNEL_YYBQUICK:SDKYYBQuick.getInstance(),CHANNEL_KAOPUGP:SDKKAOPU.getInstance(),CHANNEL_VIVO:SDKVIVO.getInstance(),CHANNEL_HUAWEI:SDKHW.getInstance(),CHANNEL_SOEZ:SDKEZ.getInstance(),CHANNEL_QUNHEI:SDKQH.getInstance(),CHANNEL_YIYOU:SDKYiYou.getInstance(),CHANNEL_HUIYOU:SDKHUIYOU.getInstance(),CHANNEL_NEZHA:SDKNeZha.getInstance(),CHANNEL_WXGAMEBOX:SDKWXGAMEBOX.getInstance()},e._statistics={CHANNEL_WXGAMEBOX:SDKWXGameBoxSA.getInstance()},e.isSDKLogin=!0,e._islowphone=null,e}();__reflect(SDKManager.prototype,"SDKManager");var WX_SHARE_TYPE;!function(e){e[e.INVITE_FRIEND=1]="INVITE_FRIEND",e[e.OFFLINE_EXP=2]="OFFLINE_EXP",e[e.EVERYDAY_SHARE=3]="EVERYDAY_SHARE",e[e.WEEKEND_SHARE=4]="WEEKEND_SHARE",e[e.FIRST_SHARE=5]="FIRST_SHARE",e[e.LEVEL_SHARE=6]="LEVEL_SHARE"}(WX_SHARE_TYPE||(WX_SHARE_TYPE={}));var ShadowBody=function(e){function t(){var t=e.call(this)||this;return t._ringRes="",t}return __extends(t,e),t.prototype.updatePos=function(){this._ownerbody&&(this._ownerbody.isshowShadow?(this.visible||(this.visible=!0),this.x=this._ownerbody.x,this.y=this._ownerbody.y,this._ownerbody.data.bodyType==BODY_TYPE.SELF&&this.updateRoleRing()):this.visible&&(this.visible=!1))},t.prototype.onRefresh=function(e){if(!this._ownerbody&&e){switch(this._ownerbody=e,e.data.bodyType){case BODY_TYPE.SELF:case BODY_TYPE.PLAYER:case BODY_TYPE.ROBOT:this.updateRoleRing();break;case BODY_TYPE.BOSS:this.shadowImg=new eui.Image,this.shadowImg.source="shadow_boss_png",this.shadowImg.anchorOffsetX=512,this.shadowImg.anchorOffsetY=512,this.addChild(this.shadowImg);break;case BODY_TYPE.MONSTER:this.shadowImg=new eui.Image,this.shadowImg.source="shadow_png",this.shadowImg.width=104,this.shadowImg.height=54,this.shadowImg.x=-52,this.shadowImg.y=-27,this.addChild(this.shadowImg);break;default:this.shadowImg=new eui.Image,this.shadowImg.source="shadow_png",this.shadowImg.x=-65,this.shadowImg.y=-33.5,this.addChild(this.shadowImg)}this.updatePos()}},t.prototype.updateRoleRing=function(){if(egret.is(this._ownerbody.data,"PlayerData")){var e=this._ownerbody.data;if(e.ring_res){if(this.shadowImg&&(this.shadowImg.parent&&this.shadowImg.parent.removeChild(this.shadowImg),this.shadowImg=null),this._ringRes!=e.ring_res){this._ringRes=e.ring_res;var t=LoadManager.getInstance().getRingResUrl(this._ringRes);this.shadowAnim?this.shadowAnim.onUpdateRes(t,-1,null):(this.shadowAnim=new BodyAnimation(t,-1,null),this.shadowAnim.scaleX=1.3,this.shadowAnim.scaleY=1.3,this.addChild(this.shadowAnim))}}else this.shadowAnim&&(this.shadowAnim.onDestroy(),this.shadowAnim=null)}},t.prototype.onRemove=function(){this.shadowAnim&&(this.shadowAnim.onDestroy(),this.shadowAnim=null),this.shadowImg&&(this.removeChildren(),this.shadowImg=null),this.parent&&this.parent.removeChild(this),this._ownerbody=null,this._ringRes=""},Object.defineProperty(t.prototype,"ownerbody",{get:function(){return this._ownerbody},enumerable:!0,configurable:!0}),t.prototype.onDestory=function(){BodyFactory.instance.onRecoveryShadow(this)},t}(egret.DisplayObjectContainer);__reflect(ShadowBody.prototype,"ShadowBody");var TitleBody=function(e){function t(t){var n=e.call(this)||this;return n.onupdate(t),n}return __extends(t,e),t.prototype.onupdate=function(e){if(!e)return void this.onDestroy();if(!this.model||this.model.id!=e.id){this.model=e;var t="chenghaodi_"+this.model.ditu;if(this._animBack?this._animBack.onUpdateRes(t,-1):(this._animBack=new Animation(t),this.addChild(this._animBack)),this.model.wenzi>0){this._fontImg?this._fontImg.source="":(this._fontImg=new eui.Image,this.addChild(this._fontImg)),this._fontImg.source="chenghaozi_"+this.model.wenzi+"_png";var n=this.model.size.split(",");this._fontImg.anchorOffsetX=parseInt(n[0])/2,this._fontImg.anchorOffsetY=parseInt(n[1])/2}else this._fontImg&&(this._fontImg.parent&&this._fontImg.parent.removeChild(this._fontImg),this._fontImg=null)}},t.prototype.onDestroy=function(){this.parent&&this.parent.removeChild(this),this._animBack&&(this._animBack.onDestroy(),this._animBack=null),this._fontImg&&(this._fontImg.parent&&this._fontImg.parent.removeChild(this._fontImg),this._fontImg=null)},t}(egret.DisplayObjectContainer);__reflect(TitleBody.prototype,"TitleBody");var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.ImageLoader.crossOrigin="anonymous",egret.TextField.default_fontFamily=GameCommon.getFontFamily(),eui.Label.default_fontFamily=GameCommon.getFontFamily(),RES.setMaxLoadingThread(6),this.stage.maxTouches=1,this.initialGame()},t.prototype.initialGame=function(){"Windows PC"==egret.Capabilities.os||"Mac OS"==egret.Capabilities.os?(DataManager.IS_PC_Game=!0,this.stage.orientation=egret.OrientationMode.AUTO):this.stage.orientation=egret.OrientationMode.PORTRAIT,this.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW;var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.showSplashView(),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.showSplashView=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.shanpingImg?[3,2]:[4,platform.loadImage("resource/game_splash.jpg")];case 1:e=t.sent(),this.shanpingImg=new egret.Bitmap,this.shanpingImg.texture=e,this.shanpingImg.width=this.stage.stageWidth,this.shanpingImg.height=this.stage.stageHeight,this.addChild(this.shanpingImg),t.label=2;case 2:return[2]}})})},t.prototype.removeSplashView=function(){this.shanpingImg&&(this.shanpingImg.parent&&this.shanpingImg.parent.removeChild(this.shanpingImg),this.shanpingImg=null)},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),e=platform.isLocalTest()?"default.res.json":"ui.res.json",[4,RES.loadConfig(e,LoadManager.resourceRootUrl)];case 1:return t=a.sent(),t&&this.onLoadConfigError(),[4,this.loadTheme()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),this.onLoadConfigError(),[3,4];case 4:return[2]}})})},t.prototype.onLoadConfigError=function(){var e=function(){platform.exit()};platform.showAlert({title:"网络错误",content:"网络错误，游戏配置文件加载失败！请重新登录游戏。",showCancel:!1,callback:e})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var a=new eui.Theme("resource/default.thm.json",e.stage);a.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){this.onStageResize(),this.removeSplashView(),this.gameWorld=new GameWorld,this.gameWorld.stage=this.stage,this.addChildAt(this.gameWorld,0),"Egert_Main_RemoveLoaded"!=window.Egert_Main_Status&&(window.Egert_Main_Status="Egert_Main_RemoveLoaded"),DataManager.IS_PC_Game&&this.stage.addEventListener(egret.Event.RESIZE,this.onStageResize,this)},t.prototype.onStageResize=function(){size.width=Math.max(this.stage.stageWidth,GameDefine.GAME_STAGE_WIDTH),size.height=Math.max(this.stage.stageHeight,GameDefine.GAME_STAGE_HEIGHT),Globar_Pos.x=(size.width-GameDefine.GAME_STAGE_WIDTH)/2,this.gameWorld&&this.gameWorld.onResize()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var size={width:0,height:0},Globar_Pos={x:0,y:0},BodyAnimation=function(e){function t(t,n,a,i){return void 0===i&&(i="action"),e.call(this,t,n,!1,a,i)||this}return __extends(t,e),t.prototype.onUpdateRes=function(t,n,a,i){void 0===i&&(i="action"),e.prototype.onUpdateRes.call(this,t,n,a,i)},t.prototype.onLoadHandler=function(e){if(e&&(!this.targetLoadUrl||this.targetLoadUrl!=e)){if(!this.targetLoadUrl&&this._resName==e)return void(this.playNum=this._playNum);this.targetLoadUrl=e,this._movieClip&&this._movieClip.stop(),this._loadingUrl||(this._loadingUrl=e,LoadManager.getInstance().loadThingModel(this,this._loadingUrl))}},t.prototype.onPlay=function(){this._loadingUrl?this._movieClip&&this._movieClip.stop():e.prototype.onPlay.call(this)},t.prototype.onLoadBodyComplete=function(e,t,n){this._loadingUrl&&(this._resName=e,e!=this.targetLoadUrl?(this._loadingUrl=this.targetLoadUrl,LoadManager.getInstance().loadThingModel(this,this._loadingUrl)):(this._loadingUrl=null,this.targetLoadUrl=null),this._movieClip&&t&&n&&(this._mcFactory&&this._mcFactory.clearCache(),this._mcFactory.mcDataSet=t,this._mcFactory.texture=n,this._movieClip.movieClipData=this._mcFactory.generateMovieClipData(this._actionName),this._movieClip.parent||this.addChildAt(this._movieClip,0),this.addChildAt(this._movieClip,0),this.playFinishCallBack(this.callback,this.callObj,this.callparam),this.playNum=this._playNum))},t.prototype.onDisposeTextrue=function(){this.targetLoadUrl=null,this._loadingUrl=null},t}(Animation);__reflect(BodyAnimation.prototype,"BodyAnimation");var GameCommon=function(){function e(){this._modelthingDict={},this.NOT_SHOW_TYPE=[GOODS_CHANGE_TYPE.XIANSHAN_ADD,GOODS_CHANGE_TYPE.RNUES_EQUIP_PACKAGE_ADD,GOODS_CHANGE_TYPE.TAKEOFF_ADD,GOODS_CHANGE_TYPE.DIAL_ADD,GOODS_CHANGE_TYPE.MAGIC_TURNPLATE_ADD,GOODS_CHANGE_TYPE.WISHINGWELL_ADD,GOODS_CHANGE_TYPE.SERVER_ARENA_ADD,GOODS_CHANGE_TYPE.BLESS_EQUIP_ADD,GOODS_CHANGE_TYPE.VIPZHUANPAN_ADD],this.Show_DelayType=[GOODS_CHANGE_TYPE.FIGHT_BRUSH_MONSTER_ADD,GOODS_CHANGE_TYPE.FIGHT_BRUSH_BOSS_ADD,GOODS_CHANGE_TYPE.YEWAI_PVP_ADD]}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.setGameWorld=function(e){this.gameWorld=e},e.getFontFamily=function(){return"SimHei"},e.prototype.onHideIOSBanWord=function(e){for(var t=0;t<e.numChildren;t++){var n=e.getChildAt(t);if(egret.is(n,"eui.Label")){var a=n,i=a.text;i=i.match(/vip|VIP/g)?"":i.replace(/购买|购 买|充值|充 值/g,"兑 换"),a.text=i}else n.numChildren&&this.onHideIOSBanWord(n)}},e.prototype.sendMsgToServer=function(e){this.gameWorld.sendMessage(e)},e.prototype.receiveMsgToClient=function(e,t){void 0===t&&(t=null);var n=new GameMessageEvent(e.getCmdId().toString(),null==t?e:t);this.gameWorld.dispatchEvent(n),n=null},e.prototype.onDispatchEvent=function(e,t){void 0===t&&(t=null);var n=new GameMessageEvent(e.toString(),null==t?null:t);this.gameWorld.dispatchEvent(n),n=null},e.prototype.addMsgEventListener=function(e,t,n){this.gameWorld.addEventListener(e,t,n)},e.prototype.removeMsgEventListener=function(e,t,n){this.gameWorld.removeEventListener(e,t,n)},e.prototype.createNormalLabel=function(t,n,a,i,o,r,s,h){void 0===t&&(t=14),void 0===n&&(n=16777215),void 0===a&&(a=0),void 0===i&&(i=4065545),void 0===o&&(o=egret.HorizontalAlign.LEFT),void 0===r&&(r=egret.VerticalAlign.MIDDLE),void 0===s&&(s=""),void 0===h&&(h="");var l=new eui.Label;return l.size=t,l.textColor=n,l.stroke=a,l.strokeColor=i,l.textAlign=o,l.verticalAlign=r,l.text=s,h?l.fontFamily=h:l.fontFamily=e.getFontFamily(),l},e.prototype.onButtonEnable=function(e,t){e.enabled=t},e.prototype.onImgSetGray=function(e,t){},e.Occupation_RoleName=function(e){var t=ModelManager.getInstance().getModelFigher(e+1);return t?t.name:""},e.prototype.getOccpationIcon=function(e){return""},e.prototype.getHeadIconByIndex=function(e){return"r"+e+"_headIcon_jpg"},e.prototype.getBigHeadByOccpation=function(e){return"mainview_hero_head"+e+"_png"},e.prototype.getHeadFrameByIndex=function(e){return"head_frame_"+e+"_png"},e.prototype.getAttributeAry=function(e){for(var t=[],n=0;n<GameDefine.ATTR_OBJ_KEYS.length;n++){var a=GameDefine.ATTR_OBJ_KEYS[n];e&&e[a]?t[n]=e[a]:t[n]=0}return t},e.prototype.onParseAttributeStr=function(e){var t;t=e.indexOf("#")>=0?e.split("#"):e.split(";");for(var n,a=this.getAttributeAry(),i=0;i<t.length;i++)n=t[i].split(","),a[n[0]]=parseInt(n[1]);return a},e.prototype.mergeAry=function(e){for(var t=this.getAttributeAry(),n=0;n<e.length;n++)for(var a in e[n])t[a]+=e[n][a];return t},e.prototype.getRedEquipAddAttr=function(t){var n=e.getInstance().getAttributeAry(),a=JsonModelManager.instance.getModelequipment()[t];if(!a||a.position<GameDefine.Equip_Slot_Num)return n;for(var i=0;i<ATTR_TYPE.SIZE;i++){var o=a.attrAry[i];if(o>0){var r=.1;o=Tool.toInt(o*r),n[i]=o}}return n},e.prototype.getHeadIconByModelid=function(e){var t=ModelManager.getInstance().getModelFigher(e),n=t.avata+"_icon_png";return n},e.prototype.getDamageFntByOccp=function(e){return void 0===e&&(e=1),"hero_damage_fnt"+e+"_fnt"},e.prototype.getPropertyTitle=function(e){var t;switch(e){case ATTR_TYPE.ATTACK:t="攻 击：";break;case ATTR_TYPE.PHYDEF:t="物 防：";break;case ATTR_TYPE.MAGICDEF:t="法 防：";break;case ATTR_TYPE.HP:t="生 命：";break;case ATTR_TYPE.HIT:t="命 中：";break;case ATTR_TYPE.DODGE:t="闪 避：";break;case ATTR_TYPE.BLOCK:t="招 架：";break;case ATTR_TYPE.BREAK:t="破 招：";break;case ATTR_TYPE.CRIT:t="暴 击：";break;case ATTR_TYPE.DUCT:t="抗 暴："}return t},e.prototype.compareEquip=function(e,t,n){void 0===n&&(n=!0);var a=DataManager.getInstance().playerManager.player;if(e&&!e.model&&(e=null),t&&!t.model&&(t=null),n){var i=Math.max(a.coatardLv,1);e&&e.model.coatardLv>i&&(e=null),t&&t.model.coatardLv>i&&(t=null)}return e&&t?e===t?null:t.pingfenValue>e.pingfenValue?t:e:e||t},e.prototype.getThingModel=function(e,t,n){var a,i=Tool.isNumber(n)?e+"_"+t+"_"+n:e+"_"+t;if(this._modelthingDict[i])return a=this._modelthingDict[i],Tool.isNumber(n)&&(a.quality=n),a;var o,r=JsonModelManager.instance;switch(e){case GOODS_TYPE.MASTER_EQUIP:o=r.getModelequipment()[t];break;case GOODS_TYPE.SERVANT_EQUIP:o=r.getModelmountEquipment()[t];break;case GOODS_TYPE.BOX:o=r.getModelbox()[t];break;case GOODS_TYPE.ITEM:o=r.getModelitem()[t];break;case GOODS_TYPE.SHENTONG:break;case GOODS_TYPE.YUANSHEN:o=r.getModelyuanshen()[t];break;case GOODS_TYPE.SHOW:o=r.getModelshow()[t];break;case GOODS_TYPE.GEM:o=r.getModelbaoshi()[t];break;case GOODS_TYPE.GOLD:o=new Object,o.name=Language.instance.getText("currency"+e),o.quality=GoodsQuality.Purple,o.icon="yuanbao_png",o.Dropicon="yuanbao_png",o.type=e,o.des="罕见货币，通过活动及游戏内系统产出，可以在商场中购买各种道具。";break;case GOODS_TYPE.DIAMOND:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="zuanshi_png",o.Dropicon="zuanshi_png",o.quality=GoodsQuality.Orange,o.type=e,o.des="珍稀的货币，仅可通过充值获得，可用于在商城中购买各种道具以及参与各类活动。";break;case GOODS_TYPE.EXP:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jingyan_png",o.Dropicon="djinyanzhi_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="通过挂机和参与各类玩法可以获得，累计足够经验可以提升角色等级。";break;case GOODS_TYPE.SHENGWANG:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="shengwang_png",o.Dropicon="shengwang_png",o.quality=GoodsQuality.Purple,o.type=e,o.tujing="92",o.des="参加跨服竞技场可获得，可在跨服商城中兑换全新永久时装和伏魔、诛仙碎片！";break;case GOODS_TYPE.ANIMA:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="lingqi_png",o.Dropicon="dlingqi_png",o.quality=GoodsQuality.Blue,o.type=e,o.tujing="8",o.des="通过分解装备，探索boss等玩法产出，可用于装备注灵。";break;case GOODS_TYPE.YUELI:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="yueli_png",o.Dropicon="dyueli_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="";break;case GOODS_TYPE.RONGYU:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="gongxun_png",o.Dropicon="dgongxun_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="通过参与天梯，可在荣誉商城中购买道具。";break;case GOODS_TYPE.SHOJIFEN:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jifen_png",o.Dropicon="djifen_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="通过商城消耗钻石获得。";break;case GOODS_TYPE.VIPEXP:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="vipjingyanka_png",o.Dropicon="dvipjingyanka_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="充值获得";break;case GOODS_TYPE.ARENA:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jingjidian_png",o.Dropicon="djingjidian_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="通过参与跨服竞技场，可在竞技商城中购买道具。";break;case GOODS_TYPE.POINTS:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="turnplate_integral_icon_png",o.Dropicon="turnplate_integral_icon_png",o.quality=GoodsQuality.Green,o.type=e,o.des="转盘积分,可以在积分商城兑换道具";break;case GOODS_TYPE.DONATE:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="banggong_icon_png",o.Dropicon="union_donate_icon_png",o.quality=GoodsQuality.Green,o.type=e,o.des="仙盟贡献",o.tujing="35";break;case GOODS_TYPE.SAVVY:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="wuxing_png",o.Dropicon="union_donate_icon_png",o.quality=GoodsQuality.Green,o.type=e,o.des="悟性",o.tujing="36";break;case GOODS_TYPE.VIGOUR:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="yuanqi_png",o.Dropicon="coatard_icon_png",o.quality=GoodsQuality.Green,o.type=e,o.des="修为",o.tujing="36";break;case GOODS_TYPE.TLINTEGRAL:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jingfen_png",o.Dropicon="djifen_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="限时积分";break;case GOODS_TYPE.HUANQI:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jingfen_png",o.Dropicon="djifen_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="元气";break;case GOODS_TYPE.CAOYAO:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="jingfen_png",o.Dropicon="djifen_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="草药";break;case GOODS_TYPE.FAHUN:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="fahun_png",o.Dropicon="fahun_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="在武坛圣座中可获得此元素，用来为心法升级，带来更多属性加成！";break;case GOODS_TYPE.DANYAO:o=r.getModelxiandan()[t],o.des=o.desc;break;case GOODS_TYPE.RNUES:o=r.getModelzhanwen()[t],o.des=o.des;break;case GOODS_TYPE.ZHANGONG:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="zhangong_png",o.Dropicon="zhangong_png",o.quality=GoodsQuality.Purple,o.type=e,o.des="战功";break;case GOODS_TYPE.SHAREEXP:o=new Object,o.name=Language.instance.getText("currency"+e),o.icon="",o.Dropicon="",o.quality=GoodsQuality.Purple,o.type=e,o.des=""}return o&&(a=new ModelThing(o,e),Tool.isNumber(n)&&(a.quality=n),this._modelthingDict[i]=a),a},e.prototype.getModelThingByParam=function(t){var n=e.parseAwardItem(t);return this.getThingModel(n.type,n.id,n.quality)},e.prototype.CreateNameColer=function(e){var t=0;switch(e){case GoodsQuality.White:t=14869218;break;case GoodsQuality.Green:t=5963665;break;case GoodsQuality.Blue:t=5620991;break;case GoodsQuality.Purple:t=15354623;break;case GoodsQuality.Orange:t=16767784;break;case GoodsQuality.Red:t=16729651;break;case GoodsQuality.Gold:t=16752399;break;default:Tool.log("CreateNameColer: "+e)}return t},e.prototype.getIconFrame=function(e){var t="";switch(e){case GoodsQuality.White:t="bag_whiteframe_png";break;case GoodsQuality.Green:t="bag_greenframe_png";break;case GoodsQuality.Blue:t="bag_blueframe_png";break;case GoodsQuality.Purple:t="bag_purpleframe_png";break;case GoodsQuality.Orange:t="bag_orangeframe_png";break;case GoodsQuality.Red:t="bag_redframe_png";break;case GoodsQuality.Gold:t="bag_goldframe_png"}return t},e.prototype.getIconFrameDi=function(e){var t="";switch(e){case GoodsQuality.White:t="equip_dengjikuang_bai_png";break;case GoodsQuality.Green:t="equip_dengjikuang_lv_png";break;case GoodsQuality.Blue:t="equip_dengjikuang_lan_png";break;case GoodsQuality.Purple:t="equip_dengjikuang_zi_png";break;case GoodsQuality.Orange:t="equip_dengjikuang_cheng_png";break;case GoodsQuality.Red:t="equip_dengjikuang_hong_png";break;case GoodsQuality.Gold:t="equip_dengjikuang_jin_png"}return t},e.prototype.getPsychIconFrame=function(e){var t="";switch(e){case GoodsQuality.White:t="psych_quality_bg_white_png";break;case GoodsQuality.Green:t="psych_quality_bg_green_png";break;case GoodsQuality.Blue:t="psych_quality_bg_blue_png";break;case GoodsQuality.Purple:t="psych_quality_bg_purple_png";break;case GoodsQuality.Orange:t="psych_quality_bg_orange_png";break;case GoodsQuality.Red:t="psych_quality_bg_red_png"}return t},e.prototype.onGetThingAlert=function(e,t,n){if(!(this.NOT_SHOW_TYPE.indexOf(n)>=0)){var a=this.Show_DelayType.indexOf(n)>=0?1600:0,i=t>0?t:1;Tool.callbackTime(this.addThingAlertText,this,a,e,i,n)}},e.prototype.addThingAlertText=function(t,n,a){var i=[];if(i.push({text:"获得：",style:{textColor:16777215}}),i.push({text:t.name+"*"+n,style:{textColor:e.getInstance().CreateNameColer(t.quality)}}),PromptPanel.getInstance().addPromptGain(i),t.type==GOODS_TYPE.MASTER_EQUIP&&t.quality>=GoodsQuality.Red&&a!=GOODS_CHANGE_TYPE.CELESTIAL_COMPOUND&&a!=GOODS_CHANGE_TYPE.ORANGE_COMPOUND&&a!=GOODS_CHANGE_TYPE.RNUES_EQUIP_ADD){var o=new RareEquip;o.data=t,PromptPanel.getInstance().getRareEquipShow(o)}},e.prototype.onGetPsychAlert=function(t,n){if(n!=PSYCH_CHANGE_TYPE.CHANGE_ADD){var a=0,i=function(n){var a=[];a.push({text:"获得：",style:{textColor:16777215}}),a.push({text:t.name,style:{textColor:e.getInstance().CreateNameColer(t.pinzhi)}}),PromptPanel.getInstance().addPromptGain(a)};Tool.callbackTime(i,this,a,t)}},e.prototype.onGetPillAlert=function(e){},e.prototype.onGetFateAlert=function(t,n){if(10126!=n){var a=0,i=function(n){var a=[];a.push({text:"获得：",style:{textColor:16777215}}),a.push({text:t.name,style:{textColor:e.getInstance().CreateNameColer(t.pinzhi)}}),PromptPanel.getInstance().addPromptGain(a)};Tool.callbackTime(i,this,a,t)}},e.prototype.readStringToHtml=function(e){var t="";if(e){var n=e.match(/\[#[0-9a-fA-F]{6}.*?]/g);if(n)for(var a=0;a<n.length;a++){var i=n[a],o=i.slice(1,8),r=i.slice(8,i.length-1),s="<font color='"+o+"'>"+r+"</font>";e=e.replace(/\[#[0-9a-fA-F]{6}.*?]/,s)}t=e}return t},e.prototype.onParseAwardItemstr=function(e){if(!e||"0"==e||"*"==e)return null;var t,n=[];t=e.indexOf("#")>=0?e.split("#"):e.split(";");for(var a=0;a<t.length;a++){var i=t[a].split(","),o=new AwardItem;switch(o.type=parseInt(i[0]),o.id=parseInt(i[1]),o.type){case GOODS_TYPE.YUANSHEN:o.num=i.length>2?parseInt(i[2]):0,n.push(o);break;default:o.num=i.length>2?parseInt(i[2]):0,o.quality=i.length>3?parseInt(i[3]):-1,n.push(o)}}return n},e.parseAwardItem=function(e){if(!e||"*"==e||"0"==e)return null;var t=e.split(","),n=new AwardItem;switch(n.type=parseInt(t[0]),n.id=parseInt(t[1]),n.type){case GOODS_TYPE.YUANSHEN:t.length>3&&(n.num=t.length>2?parseInt(t[2]):0,n.lv=t.length>3?parseInt(t[3]):1);break;default:n.num=t.length>2?parseInt(t[2]):0,n.quality=t.length>3?parseInt(t[3]):-1}return n},e.prototype.concatAwardAry=function(e){for(var t=[],n={},a=0;a<e.length;a++)for(var i=e[a],o=0;o<i.length;o++){var r=i[o];n[r.type+"_"+r.id]?n[r.type+"_"+r.id].num+=r.num:n[r.type+"_"+r.id]=r}for(var s in n){var r=n[s];t.push(r)}return n=null,t},e.onParseVipBuyItemstr=function(t){if(!t)return null;var n,a,i={};a=t.indexOf("#")>=0?t.split("#"):t.split(";");for(var o=0;o<a.length;o++)n=e.parseVipBuyItem(a[o]),i[n.lv]=n;return i},e.parseVipBuyItem=function(e){var t=e.split(","),n=new VipBuyItem;return n.lv=parseInt(t[0]),n.max=parseInt(t[1]),n},e.prototype.addHintBar=function(t){var n=t.getShort();switch(Tool.log("400 - code:"+n),this.addAlert(GameErrorTip.getInstance().getGameErrorTip(n)),n){case GameErrorTip.ERROR_ID_ARENA_CHANGE:var a=new Message(MESSAGE_ID.ARENE_REFRESH_ENEMYLIST_MESSAGE);e.getInstance().sendMsgToServer(a);break;case GameErrorTip.ERROR_ID_PLUSE_FAIL:GameDispatcher.getInstance().dispatchEventWith(GameEvent.PULSE_UP_FAIL_EVENET);break;case GameErrorTip.ERROR_ID_LADDER_END:GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.LODDER_ARENA&&GameFight.getInstance().fightScene.onDestroyScene()}},e.prototype.addAlert=function(e){PromptPanel.getInstance().addPromptError(Language.instance.getText(e))},e.prototype.onShowFastBuy=function(e,t){void 0===t&&(t=GOODS_TYPE.ITEM);var n=this.getThingModel(t,e);n&&n.tujing&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("FastBuyPanel",n))},e.prototype.onCheckItemConsume=function(e,t,n,a){void 0===n&&(n=GOODS_TYPE.ITEM),void 0===a&&(a=-1);var i=!1,o=DataManager.getInstance().playerManager.player,r=0,s=DataManager.getInstance().bagManager.getGoodsThingById(e);switch(n){case GOODS_TYPE.ITEM:if(r=s?s.num:0,-1!=a){var h=DataManager.getInstance().bagManager.getGoodsThingById(a);h&&(r+=h.num)}break;default:r=o.getICurrency(n)}if(r>=t&&(i=!0),!i){if(n!=GOODS_TYPE.DIAMOND)return n==GOODS_TYPE.GOLD?(this.addAlert(Language.instance.getText("currency4")+"不足"),!1):(this.onShowFastBuy(e),!1);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel");var l=this.getThingModel(n,e);l&&this.addAlert(l.name+"数量不足")}return i},e.prototype.onSendGuideComplete=function(){},e.prototype.onShowFuncTipsBar=function(e,t){this.gameWorld.getGameScene().getModuleLayer()&&this.gameWorld.getGameScene().getModuleLayer().onShowFuncTipsBar(e,t)},e.prototype.onHideFuncTipsBar=function(e){this.gameWorld.getGameScene().getModuleLayer()&&this.gameWorld.getGameScene().getModuleLayer().onHideFuncTipsBar(e)},e.calculationFighting=function(e){var t=0;return t+=e[ATTR_TYPE.HP]*FightDefine.FIGHT_HP_FACTOR,t+=e[ATTR_TYPE.ATTACK]*FightDefine.FIGHT_ATTACK_FACTOR,t+=e[ATTR_TYPE.PHYDEF]*FightDefine.FIGHT_PHYDEF_FACTOR,t+=e[ATTR_TYPE.MAGICDEF]*FightDefine.FIGHT_MAGICDEF_FACTOR,t+=e[ATTR_TYPE.HIT]*FightDefine.FIGHT_HIT_FACTOR,t+=e[ATTR_TYPE.DODGE]*FightDefine.FIGHT_DODGE_FACTOR,t+=e[ATTR_TYPE.BLOCK]*FightDefine.FIGHT_BLOCK_FACTOR,t+=e[ATTR_TYPE.BREAK]*FightDefine.FIGHT_BREAK_FACTOR,t+=e[ATTR_TYPE.CRIT]*FightDefine.FIGHT_CRIT_FACTOR,t+=e[ATTR_TYPE.DUCT]*FightDefine.FIGHT_DUCT_FACTOR,t=Tool.toInt(t)},e.prototype.getTimeStrForSec1=function(e,t){void 0===t&&(t=2);var n="",a=Math.floor(e/86400);a>0?n+=a+"天":t>=3&&(n+="0天"),e-=86400*a;var i=Math.floor(e/3600);i>0?n+=i+"小时":t>=2&&(n+="0小时"),e-=3600*i;var o=Math.floor(e/60);o>0?n+=10>o?"0"+o+"分":o+"分":t>=1&&(n+="00分"),e-=60*o;var r=Math.floor(e);return n+=10>r?"0"+r+"秒":r+"秒"},e.prototype.getTimeStrForSecHS=function(e){var t="",n=Math.floor(e/86400);n>0&&(t+=n+"天"),e-=86400*n;var a=Math.floor(e/3600);t+=a+"时",e-=3600*a;var i=Math.floor(e/60);if(t+=i>0?10>i?"0"+i+"分":i+"分":"00分",60>e){var o=Math.floor(e);t+=10>o?"0"+o+"秒":o+"秒"}return t},e.prototype.getTimeStrForSec2=function(e,t){void 0===t&&(t=!0);var n="",a=Math.floor(e/3600);(t||a>0)&&(n+=10>a?"0"+a:a+"",n+="：",e-=3600*a);var i=Math.floor(e/60);n+=10>i?"0"+i:i+"",n+="：",e-=60*i;var o=Math.floor(e);return n+=10>o?"0"+o:o+""},e.prototype.addUnderlineGet=function(e){e.stroke=2,this.addUnderlineStr(e)},e.prototype.addUnderlineStr=function(e,t){void 0===t&&(t=null),t||(t=e.text),e.textFlow=(new egret.HtmlTextParser).parser("<u>"+t+"</u>")},e.getBlackTransparentBg=function(){var e=new egret.Shape;return e.graphics.beginFill(0,.8),e.graphics.drawRect(0,0,size.width,size.height),e.graphics.endFill(),e},e.powerChangeAttribute=function(t){var n=e.getInstance().getAttributeAry(),a=.25*t*.9;n[ATTR_TYPE.HP]=Math.max(Tool.toInt(a/FightDefine.FIGHT_HP_FACTOR),100);var i=.5*t*.9;n[ATTR_TYPE.ATTACK]=Tool.toInt(i/FightDefine.FIGHT_ATTACK_FACTOR);var o=.125*t*.9;return n[ATTR_TYPE.PHYDEF]=Tool.toInt(o/FightDefine.FIGHT_PHYDEF_FACTOR),n[ATTR_TYPE.MAGICDEF]=Tool.toInt(o/FightDefine.FIGHT_PHYDEF_FACTOR),n},e.prototype.reviseBodyAttributesData=function(e,t,n,a){if(void 0===n&&(n=ATTR_TYPE.HP),void 0===a&&(a=ATTR_TYPE.BREAK),e)for(var i=n;a>=i;i++){var o=e.attributes[i];o>0&&(e.attributes[i]=Math.max(0,Math.floor(t*o)))}},e.prototype.getBit2BooleanValue=function(e,t){return 0>t?!1:(e>>t&1)>0},e.prototype.getColorByVIPLV=function(e){var t;return 0==e?t=16777215:e>=1&&4>=e?t=2680872:e>=5&&8>=e?t=2661098:e>=9&&12>=e?t=13511409:e>=13&&15>=e&&(t=16756257),t},e.prototype.getNickname=function(e){var t=e.split(".");return t.shift(),t.join()},e.prototype.getVipName=function(e){return e+VipDefine.VIP_START_LEVEL},e.prototype.getVipLevel=function(e){var t,n=JsonModelManager.instance.getModelvip();if(t=n[0],e<t.costNum)return 0;for(var a=VipDefine.MAX_VIPLEVEL-1;a>=0&&(t=n[a],!(t.costNum<=e));a--);return t.level},e.prototype.createGoodsIntance=function(e){var t=new GoodsInstance;return t.onUpdate(e.type,e.id,e.uid,e.quality,e.num),t},e.prototype.getOutServerName=function(e){var t="";if(e){var n=e.indexOf(".")+1;n>0&&(t=e.slice(n,e.length))}return t},e.prototype.getMonsterBody=function(e,t,n,a,i){void 0===n&&(n=Direction.DOWN),void 0===a&&(a="stand"),void 0===i&&(i=-1);var o=ModelManager.getInstance().getModelFigher(t),r=LoadManager.getInstance().getMonsterResUrl(o.avata,a,n+"");return e?e.onUpdateRes(r,i,n):e=new BodyAnimation(r,i,n),o.avata.indexOf("boss")>=0&&(e.scaleX=1.3,e.scaleY=1.3),e},e.prototype.addAnimation=function(e,t,n,a){void 0===a&&(a=1);
var i=new Animation(e,a,a>0?!0:!1);return i.x=t?t.x:0,i.y=t?t.y:0,n.addChild(i),i},e.prototype.getEquipSlotThingByIndexSlot=function(e,t){return DataManager.getInstance().playerManager.player.getPlayerData(e).getEquipSlotThings(t)},e.prototype.getFormatNumberShow=function(e){if(1e5>e)return e.toString();if(1e8>e){var t=(e/1e4).toString(),n=t.indexOf(".");return n>0&&4>n?t.substr(0,n+2)+"万":t.substr(0,4)+"万"}var t=(e/1e8).toString(),n=t.indexOf(".");return n>0&&4>n?t.substr(0,n+3)+"亿":t.substr(0,4)+"亿"},e.prototype.objToArray=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.prototype.onParseGainItemstr=function(e,t){if(!e||"0"==e)return null;var n,a=[];n=e.indexOf("#")>=0?e.split("#"):e.split(";");for(var i=0;i<n.length;i++){var o=n[i].split(","),r=new AwardItem;r.id=parseInt(o[0]),r.type=t,r.quality=parseInt(o[1]),r.num=parseInt(o[2]),a.push(r)}return a},e.parseIntArray=function(e){var t=e.split(","),n=[];for(var a in t)n.push(parseInt(t[a]));return n},e.addAndGetChatOrder=function(){return e.chatOrder++,e.chatOrder},e.instance=null,e.Quality_Color_String=["e2e2e2","5aff91","55c4ff","ea4aff","FFDB28","ff4633","FF9F0F"],e.chatOrder=0,e}();__reflect(GameCommon.prototype,"GameCommon");var GameErrorTip=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.getGameErrorTip=function(e){return Language.instance.getText("error_tips_"+e)},e.ERROR_ID_ARENA_CHANGE=62,e.ERROR_ID_PLUSE_FAIL=136,e.ERROR_ID_SAMSARA_REBORN=103,e.ERROR_ID_LADDER_END=21,e}();__reflect(GameErrorTip.prototype,"GameErrorTip");var ErrorTip=function(){function e(){}return e}();__reflect(ErrorTip.prototype,"ErrorTip");var GameFight=function(){function e(){this.isteamdupReady=!1,this.fight_randomIndex=0,this.hero_randomIndex=0,this.enemy_randomIndex=0,this._fightDupId=0,this._unionCheerNum=0,this.xuezhanDifficulty=1,this._beforeRound=0}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.setMainscene=function(e){this.mainscene=e},e.prototype.getFightSceneByName=function(e){return this.gameFightScenes||(this.gameFightScenes={}),this.gameFightScenes[e]||(this.gameFightScenes[e]=new window[e](this.mainscene)),this.gameFightScenes[e]},e.prototype.onRegistScene=function(e){var t="";switch(e){case FIGHT_SCENE.YEWAI_XG:t="YewaiPVEFight";break;case FIGHT_SCENE.YEWAI_BOSS:t="YewaiBossFight";break;case FIGHT_SCENE.DUP:t="DupFight";break;case FIGHT_SCENE.ALLPEOPLE_BOSS:case FIGHT_SCENE.XUEZHAN_BOSS:case FIGHT_SCENE.VIP_BOSS:case FIGHT_SCENE.XIANSHAN_BOSS:t="AllPeopleBossFight";break;case FIGHT_SCENE.SAMSARA_BOSS:t="SamsaraBossFight";break;case FIGHT_SCENE.YEWAIPVP:t="YewaiPVPFight";break;case FIGHT_SCENE.LODDER_ARENA:t="LadderFight";break;case FIGHT_SCENE.ESCORT:t="EscortFight";break;case FIGHT_SCENE.REVENGE:t="RevengeFight";break;case FIGHT_SCENE.UNION_BOSS:t="UnionBossFight";break;case FIGHT_SCENE.UNION_BATTLE:t="UnionBattleFight";break;case FIGHT_SCENE.SERVER_ARENA:t="ServerCrossAraneFight";break;case FIGHT_SCENE.LOCAL_ARENA:t="LocalArenaFight";break;case FIGHT_SCENE.MYSTERIOUS_BOSS:t="MysBossFight";break;case FIGHT_SCENE.DIFU_DUP:t="DiFuDupFight";break;case FIGHT_SCENE.CROSS_PVE_BOSS:t="CrossPVEBossFight";break;case FIGHT_SCENE.THRONE:t="WuTanFight"}t&&(this.currFightScene=this.getFightSceneByName(t),this.currFightScene.onInitScene(e))},e.prototype.onCheckCanWalk=function(e,t){return this.mainscene.mapInfo.getNodeModelByXY(e,t)?this.mainscene.mapInfo.getNodeModelByXY(e,t).isCanWalk:!1},e.prototype.addBodyToMapLayer=function(e,t){this.mainscene.addBodyToMapLayer(e,t)},e.prototype.addDropBodyToLayer=function(e){this.mainscene.getMapLayer().addToDamageFntLayer(e)},e.prototype.getHeroPosByModule=function(){return this.mainscene.getMapLayer().heroPosByModule},Object.defineProperty(e.prototype,"fightScene",{get:function(){return this.currFightScene},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fightsceneTpye",{get:function(){return this.currFightScene?this.currFightScene.sceneTpye:FIGHT_SCENE.YEWAI_XG},enumerable:!0,configurable:!0}),e.prototype.onCheckPosInMapView=function(e,t){return this.mainscene.getMapLayer().onCheckPosInMapView(e,t)},e.prototype.getYewaiExp=function(e){return void 0===e&&(e=this.yewai_waveIndex),Tool.toInt(.95*e+34)},e.prototype.getYewaiGold=function(e){return void 0===e&&(e=this.yewai_waveIndex),Tool.toInt(.1*e+100)},e.prototype.getYewaibossExp=function(e){return void 0===e&&(e=this.yewai_waveIndex),Tool.toInt(420+10.8*e)},e.prototype.getYewaibossYueli=function(e){return void 0===e&&(e=this.yewai_waveIndex),Math.min(500+10*e,1e3)},e.prototype.parseFightRandom=function(e){this.fight_randomIndex=Math.floor(Math.random()*RandomDefine.FIGHT_RANDOM.length);var t=RandomDefine.FIGHT_RANDOM[this.fight_randomIndex];this.hero_randomIndex=Math.floor(Math.random()*t.length),this.enemy_randomIndex=Math.floor(Math.random()*t.length),e&&(e.setInt(this.fight_randomIndex),e.setByte(this.hero_randomIndex),e.setByte(this.enemy_randomIndex))},e.prototype.parseOtherPlayerDataMsg=function(e){var t=[],n=new BaseSimPlayerData;n.parseMsg(e);var a=new PlayerAppears;a.parseMsg(e);for(var i=e.getByte(),o=0;i>o;o++){var r=a.appears[o],s=r.occupation>0&&r.occupation<GameDefine.Max_Role_Num?r.occupation+1:o+1,h=new PlayerData(s,BODY_TYPE.PLAYER);h.playerId=n.playerId,h.name=n.name,h.index=o,h.sex=r.sex,h.coatardLv=n.coatardlv,h.headiconIdx=n.headindex,h.headFrame=n.headFrame,h.setAppear(r),h.figthPower=e.getLong();for(var l=0;l<ATTR_TYPE.SIZE;l++)h.attributes[l]=e.getInt();for(var g=n.level,c=0;c<h.skills.length;c++){var p=h.skills[c],u=e.getShort();p.styleNum=e.getShort(),p.model.lv<=n.level&&(h.updateSkillLevel(c,g),h.updateSkillGrade(c,u))}for(var d=0;d<BLESS_TYPE.SIZE;d++){var _=e.getShort();if(_>0){var m=new FashionData;m.id=_,m.model.type==d&&(h.fashionSkils[d]=m)}}for(var E=1;E<=LegendDefine.Legend_Num;E++)h.legendInfo[E]=e.getByte();t[o]=h}return t[0]&&(t[0].petGrade=a.petGrade),t},e.prototype.parseRobotDataMsg=function(e){for(var t=DataManager.getInstance().playerManager.player,n=e.getInt(),a=e.getString(),i=e.getLong(),o=i%2,r=[],s=t.playerDatas.length,h=0;s>h;h++){var l=new RobotData(h+1,BODY_TYPE.ROBOT);l.playerId=n,l.index=h,l.name=a,l.sex=o,l.coatardLv=t.coatardLv,l.headiconIdx=o==SEX_TYPE.MALE?2:5,l.headFrame=1,l.figthPower=Math.floor(i/s);var g=GameCommon.powerChangeAttribute(l.figthPower);l.onUpdateRobotInfo(g),r[h]=l;for(var c=DataManager.getInstance().playerManager.player.getPlayerData(),p=0;p<l.skills.length;p++){var u=c.skills[p];l.updateSkillLevel(p,u.level>0?1:0),l.updateSkillGrade(p,0),l.skills[p].reset()}}return r},e.prototype.onRandomCrateRobotData=function(e,t,n){void 0===n&&(n=null);var a=Math.floor(Math.random()*GameDefine.Max_Role_Num)+1,i=new RobotData(a,BODY_TYPE.ROBOT),o=Math.round(1*Math.random());i.playerId=-1,null==i.name?n:NameDefine.getRandomPlayerName(!0,o),i.sex=o;var r=(Math.random()*(t-e)+e)/10,s=GameCommon.powerChangeAttribute(Math.floor(DataManager.getInstance().playerManager.player.playerTotalPower*r));return i.onUpdateRobotInfo(s),i.onRebirth(),i},e.prototype.onParsePVPEnemyMsg=function(t,n){void 0===n&&(n=!0);var a=[],i=n?t.getBoolean():!1;a=i?e.getInstance().parseRobotDataMsg(t):e.getInstance().parseOtherPlayerDataMsg(t);for(var o=0;o<a.length;o++)a[o].onRebirth();return a},e.prototype.onParseDropItems=function(e){for(var t,n=[],a=e.getByte(),i=0;a>i;i++)t=new AwardItem,t.type=e.getByte(),t.id=e.getShort(),t.quality=e.getByte(),t.num=e.getInt(),t.quality=t.type==GOODS_TYPE.MASTER_EQUIP||t.type==GOODS_TYPE.SERVANT_EQUIP?t.quality:-1,n.push(t);return n},e.prototype.onInitJackaroo=function(){this.JackarooRushDatas=[];DataManager.getInstance().playerManager.player},Object.defineProperty(e.prototype,"isJackaroo",{get:function(){return this.JackarooRushDatas&&this.JackarooRushDatas.length>0},enumerable:!0,configurable:!0}),e.prototype.onJackarooHandler=function(){var e=this.JackarooRushDatas[0];this.mainscene.getBodyManager().onRushNpcToScene(e,e.refreshNum,.7)},e.prototype.onCheckStoyTalk=function(){if(this.fightsceneTpye!=FIGHT_SCENE.YEWAI_XG&&this.fightsceneTpye!=FIGHT_SCENE.YEWAI_BOSS)return!1;var e=this.mainscene.heroBody.data.targets[0];if(!e)return!1;var t=this.yewai_waveIndex,n=JsonModelManager.instance.getModelstory()[t];if(!n)return!1;this.storysDict||(this.storysDict={});var a;if(!this.storysDict[t]){this.storysDict[t]={};for(var i in n){var o=n[i];this.storysDict[t][o.talktype]||(this.storysDict[t][o.talktype]=[]),this.storysDict[t][o.talktype].push(o)}}var r;if(e)switch(e.data.bodyType){case BODY_TYPE.MONSTER:r=STORY_TYPE.MONSTER;break;case BODY_TYPE.BOSS:r=STORY_TYPE.BOSS;break;default:r=e.data.modelid}else r=STORY_TYPE.FINISH;if(a=this.storysDict[t][r],!a||0==a.length)return!1;for(var s=[],h=a.length-1;h>=0;h--){var o=a[h];o.talktype==r&&(s.unshift(o),a.splice(h,1))}return s.length>0?(this.mainscene.getBodyManager().fightPause=!0,e?(this.mainscene.heroBody.direction=this.mainscene.heroBody.checkFace(e.x,e.y),this.mainscene.getModuleLayer().onShowStoryView(s,e.data)):this.mainscene.getModuleLayer().onShowStoryView(s),!0):!1},e.prototype.onRemoveStory=function(){this.mainscene.getBodyManager().fightPause=!1,this.mainscene.getModuleLayer().onHideStroyView(),this.isJackaroo?(this.JackarooRushDatas.shift(),this.mainscene.getBodyManager().onDestroyAllHeroTarget(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_JACKAROO_COMPLETE)),this.isJackaroo||(this.mainscene.heroBody.onshoworhideShodow(!0),LoadManager.getInstance().onClearAllBodyAnimCache())):this.isFightEndStory&&(this.isFightEndStory=!1,this.fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&this.fightScene.onFightWin())},e.prototype.onCheckBodyIsHero=function(e){if(e.bodyType==BODY_TYPE.SELF)return!0;if(e.bodyType==BODY_TYPE.RETINUE){var t=e;if(!t||!t.playerData)return!1;if(t.playerData.playerId==DataManager.getInstance().playerManager.player.id)return!0}return!1},e.prototype.onSendCommonFightMsg=function(e){var t=new Message(MESSAGE_ID.GAME_FIGHT_START_MSG);t.setByte(e?1:0),e?this.parseFightRandom(t):this.parseFightRandom(null),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendYewaiPVPPKMsg=function(e){if(DataManager.getInstance().yewaipvpManager.pvpfightterInfos&&!(e>=DataManager.getInstance().yewaipvpManager.pvpfightterInfos.length)&&!this.checkBagIsFull()&&this.isCanEnterScene()){this.parseFightRandom(null);var t=new Message(MESSAGE_ID.YEWAIPVP_FIGHT_PK_MSG);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onRequstYewaiFightterInfoMsg=function(){var e=new Message(MESSAGE_ID.YEWAIPVP_FIGHTTER_INFO_MSG);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendEnterDupMsg=function(e){var t=JsonModelManager.instance.getModelcopy()[e],n=DataManager.getInstance().dupManager.getDupInfo(t.type,t.subType);if(!n)return void GameCommon.getInstance().addAlert("副本数据为空!");if(!n.onCheckLimit()&&!this.checkBagIsFull()&&this.isCanEnterScene()){var a=n.lefttimes;if(t.type==DUP_TYPE.DUP_VIP_TEAM&&(a+=DataManager.getInstance().dupManager.vipteamLeftjoinTimes),0==a)return void GameCommon.getInstance().addAlert("error_tips_6");var i=new Message(MESSAGE_ID.GAME_FIGHT_DUP_ENTER);this.parseFightRandom(i),i.setByte(e),GameCommon.getInstance().sendMsgToServer(i)}},e.prototype.onSendBlessDupProgressMsg=function(e,t){void 0===t&&(t=0);var n=new Message(MESSAGE_ID.GAME_BLESSDUP_PROGRESS_MSG);n.setByte(0!=e?1:0),n.setShort(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onSendSixiangDupResultMsg=function(e){void 0===e&&(e=1);var t=new Message(MESSAGE_ID.GAME_SIXIANG_PROGRESS_MSG);t.setByte(0!=e?1:0),0!=e&&this.parseFightRandom(t),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendEnterPersonallyBossMsg=function(e){var t=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_PERSONALLY,e);if(!t)return void GameCommon.getInstance().addAlert("副本数据为空!");if(!this.checkBagIsFull()&&this.isCanEnterScene()){if(0==t.lefttimes)return void GameCommon.getInstance().addAlert("error_tips_6");var n=new Message(MESSAGE_ID.GAME_FIGHT_DUP_ENTER);this.parseFightRandom(n),n.setByte(DUP_TYPE.DUP_PERSONALLY),n.setByte(e),GameCommon.getInstance().sendMsgToServer(n)}},e.prototype.onSendSaoDangPersonallyBossMsg=function(e){var t=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_PERSONALLY,e);if(!t)return void GameCommon.getInstance().addAlert("副本数据为空!");if(!this.checkBagIsFull()&&this.isCanEnterScene()){if(0==t.lefttimes)return void GameCommon.getInstance().addAlert("error_tips_6");var n=new Message(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE);n.setByte(DUP_TYPE.DUP_PERSONALLY),n.setByte(e),GameCommon.getInstance().sendMsgToServer(n)}},e.prototype.onEnterDupSuccess=function(e){this._fightDupId=e},Object.defineProperty(e.prototype,"fightDupId",{get:function(){return this.fightsceneTpye==FIGHT_SCENE.DUP?this._fightDupId:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unionCheerNum",{get:function(){var e=JsonModelManager.instance.getModelcopy()[this.fightDupId];return e&&e.type==DUP_TYPE.DUP_UNION?this._unionCheerNum:0},set:function(e){this._unionCheerNum=e},enumerable:!0,configurable:!0}),e.prototype.onSendCreateTeamDupRoomMsg=function(e){var t=JsonModelManager.instance.getModelcopy()[e],n=DataManager.getInstance().dupManager.getDupInfo(t.type,t.subType);if(0==n.lefttimes)return void GameCommon.getInstance().addAlert("error_tips_6");if(!this.checkBagIsFull()&&this.isCanEnterScene()&&!n.onCheckLimit()){this.teamdupRoomDupId=e;var a=new Message(MESSAGE_ID.TEAMDUP_CREATETEAM_MESSAGE);a.setByte(e),GameCommon.getInstance().sendMsgToServer(a)}},e.prototype.onSendJoinTeamDupRoomMsg=function(e,t){var n=JsonModelManager.instance.getModelcopy()[t],a=DataManager.getInstance().dupManager.getDupInfo(n.type,n.subType),i=a.lefttimes;if(n.type==DUP_TYPE.DUP_VIP_TEAM&&(i+=DataManager.getInstance().dupManager.vipteamLeftjoinTimes),0==i)return void GameCommon.getInstance().addAlert("error_tips_6");if(!a.onCheckLimit()&&!this.checkBagIsFull()&&this.isCanEnterScene()){this.teamdupRoomDupId=t;var o=new Message(MESSAGE_ID.TEAMDUP_JOINTEAM_MESSAGE);o.setByte(t),o.setInt(e),GameCommon.getInstance().sendMsgToServer(o)}},e.prototype.onSendQuitTeamDupMsg=function(){var e=new Message(MESSAGE_ID.TEAMDUP_QUITSCENE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendEscortFightMsg=function(e){if(this.isCanEnterScene()){if(DataManager.getInstance().escortManager.escort.rob==EscortData.MAX_ROB_COUNT)return void GameCommon.getInstance().addAlert("error_tips_6");this.robID=e;var t=new Message(MESSAGE_ID.ESCORT_ROB_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t),DataManager.getInstance().escortManager.OnRobSomeOne(e)}},e.prototype.onSendLocalArenaFightMsg=function(e){var t=DataManager.getInstance().localArenaManager.localArenaData;if(t){if(this.onReqLocalArenaFightTime>egret.getTimer())return void GameCommon.getInstance().addAlert("挑战太频繁，请稍后再试");if(this.isCanEnterScene()){if(t.fightCount<=0)return void GameCommon.getInstance().addAlert("error_tips_6");this.onReqLocalArenaFightTime=egret.getTimer()+2e3;var n=new Message(MESSAGE_ID.ARENE_FIGHT_ENTER_MESSAGE);n.setInt(e),this.parseFightRandom(n),GameCommon.getInstance().sendMsgToServer(n)}}},e.prototype.onSendArenaFightMsg=function(e){var t=DataManager.getInstance().arenaManager.arenaData;if(t&&t.isOpen){if(this.onReqArenaFightTime>egret.getTimer())return void GameCommon.getInstance().addAlert("挑战太频繁，请稍后再试");if(this.isCanEnterScene()){if(t.fightCount<=0)return void GameCommon.getInstance().addAlert("error_tips_6");this.onReqArenaFightTime=egret.getTimer()+2e3;var n=new Message(MESSAGE_ID.ARENE_CROSS_FIGHT_ENTER_MESSAGE);n.setByte(e),n.setByte(t.rank),GameCommon.getInstance().sendMsgToServer(n)}}},e.prototype.onSendLadderArenaFightMsg=function(){if(this.isCanEnterScene()){var e=DataManager.getInstance().arenaManager.ladderArenaData;if(e.ladderStatus>0)return void GameCommon.getInstance().addAlert("error_tips_21");var t=Math.max(0,Math.floor((e.leftRelive-egret.getTimer())/1e3));if(!(t>0)){var n=new Message(MESSAGE_ID.ARENE_LADDERARENE_FIGHT_MESSAGE);this.parseFightRandom(n),GameCommon.getInstance().sendMsgToServer(n)}}},e.prototype.onSendXuezhanFightMsg=function(e){if(this.isCanEnterScene()){if(0==DataManager.getInstance().dupManager.xuezhanInfo.reviveNum)return void GameCommon.getInstance().addAlert("挑战次数不足");var t=new Message(MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE);t.setByte(e),this.parseFightRandom(t),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onEnterAllPeopleBossScene=function(e){if(!this.checkBagIsFull()&&this.isCanEnterScene()){if(0==DataManager.getInstance().dupManager.allpeoplebossData.lefttimes)return void GameCommon.getInstance().addAlert("error_tips_6");var t=new Message(MESSAGE_ID.ALLPEOPLE_BOSS_ENTER_MSG);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onEnterXuezhanBossScene=function(e){if(!this.checkBagIsFull()&&this.isCanEnterScene()){var t=new Message(MESSAGE_ID.XUEZHANBOSS_ENTER_MSG);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onEnterXianShanBossScene=function(e){if(!this.checkBagIsFull()&&this.isCanEnterScene()){var t=new Message(MESSAGE_ID.BOSS_PILL_START_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onEnterVipBossScene=function(e){if(!this.checkBagIsFull()&&this.isCanEnterScene()){var t=new Message(MESSAGE_ID.VIPBOSS_ENTER_MSG);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.sendBossFightPkRequset=function(e){if(e!=DataManager.getInstance().playerManager.player.id){if(this.mainscene.onCheckPlayerFail())return void GameCommon.getInstance().addAlert("error_tips_10002");var t;if(this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS?t=MESSAGE_ID.XUEZHANBOSS_OTHERPK_MSG:this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS?t=MESSAGE_ID.VIPBOSS_OTHERPK_MSG:this.fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS&&(t=MESSAGE_ID.ALLPEOPLE_PK_MESSAGE),Tool.isNumber(t)){var n=new Message(t);this.parseFightRandom(n),n.setShort(this.allpeopleBossId),n.setInt(e),GameCommon.getInstance().sendMsgToServer(n)}}},e.prototype.onEnterSamsaraBossScene=function(){if(DataManager.getInstance().dupManager.samsarebossData.openLefttime>0)return void GameCommon.getInstance().addAlert(Language.instance.getText("samsara_unopen"));if(!this.checkBagIsFull()&&this.isCanEnterScene()){var e=new Message(MESSAGE_ID.SAMSARA_BOSS_ENTER_MSG);GameCommon.getInstance().sendMsgToServer(e)}},e.prototype.onBossFightReborn=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!1),e)if(t)this.onSendRebornMsg();else{var n=[{text:"是否花费100钻石复活？",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,function(){this.onSendRebornMsg()},this)))}else this.onSendRebornMsg(0)},e.prototype.onMyBossFightReborn=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!1),e)if(t)this.onSendRebornMsgMysterious();else{var n=[{text:"是否花费100钻石复活？",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,function(){this.onSendRebornMsgMysterious()},this)))}else this.onSendRebornMsgMysterious(0)},e.prototype.onSendRebornMsgMysterious=function(e){if(void 0===e&&(e=1),1==e&&DataManager.getInstance().playerManager.player.gold<20)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var t=new Message(MESSAGE_ID.BOSS_MYSTERIOUS_REVIVE_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t),this.onEnterMysteriousBossScene()},e.prototype.onSendRebornMsg=function(e){if(void 0===e&&(e=1),1==e&&DataManager.getInstance().playerManager.player.gold<20)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var t,n;this.fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS?t=MESSAGE_ID.SAMSARA_BOSS_REBORN_MSG:this.fightsceneTpye==FIGHT_SCENE.MYSTERIOUS_BOSS?t=MESSAGE_ID.BOSS_MYSTERIOUS_REVIVE_MESSAGE:this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS?(t=MESSAGE_ID.XUEZHANBOSS_REBORN_MSG,n=this.allpeopleBossId):this.fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS?(t=MESSAGE_ID.ALLPEOPLE_PVP_REVIVE,n=this.allpeopleBossId):this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS?(t=MESSAGE_ID.VIPBOSS_REBORN_MSG,n=this.allpeopleBossId):t=MESSAGE_ID.SAMSARA_BOSS_REBORN_MSG;var a=new Message(t);Tool.isNumber(n)&&a.setShort(n),a.setByte(e),GameCommon.getInstance().sendMsgToServer(a),this.fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&this.onEnterSamsaraBossScene()},e.prototype.onEnterMysteriousBossScene=function(){if(!this.checkBagIsFull()&&this.isCanEnterScene()){var e=new Message(MESSAGE_ID.MYSTERIOUS_BOSS_FIGHT);GameCommon.getInstance().sendMsgToServer(e)}},e.prototype.onEnterUnionBossScene=function(e){if(0==DataManager.getInstance().unionManager.unionbossCount)return void GameCommon.getInstance().addAlert("剩余挑战次数不足");if(this.isCanEnterScene()){var t=new Message(MESSAGE_ID.UNION_BOSS_FIGHT_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onSendUnionBattleFightMsg=function(e){if(this.isCanEnterScene()){var t=new Message(MESSAGE_ID.UNION_BATTLE_ENJOIN_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onCheckUnionBattleResult=function(e){var t=DataManager.getInstance().unionManager.unionbattleInfo,n=0==this._beforeRound;if(t&&t.state!=UNIONBATTLE_STATE.NOT&&t.myUnionFightInfo){var a=UNIONBATTLE_RESULT.UNRESULT;this._beforeRound<t.myUnionFightInfo.roundCount&&this._beforeRound>0&&(a=UNIONBATTLE_RESULT.WIN),this._beforeRound=t.myUnionFightInfo.roundCount,this._beforeState!=t.myUnionFightInfo.state&&(n||(a=t.myUnionFightInfo.state),this._beforeState=t.myUnionFightInfo.state);var i="",o="",r="";if(a!=UNIONBATTLE_RESULT.UNRESULT)var s=a==UNIONBATTLE_RESULT.WIN?this._beforeRound-2:this._beforeRound-1,r=e[s];r||(a=UNIONBATTLE_RESULT.UNRESULT),a==UNIONBATTLE_RESULT.WIN?(o=4==this._beforeRound?"获得本次帮会战[#FFFF00冠军]！":"[#FFFF00晋级！]",i="恭喜您击败"+r+"帮会"+o):a==UNIONBATTLE_RESULT.LOSE&&(o=3==this._beforeRound?"获得本次帮会战[#FFFF00亚军]！":"[#FF0000淘汰！]",i="很遗憾您被"+r+"帮会击败"+o),i&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertDescUI",GameCommon.getInstance().readStringToHtml(i)))}},e.prototype.onEnterCrossPVEBossScene=function(){var e=DataManager.getInstance().dupManager.crossPVEBoss;if(!e.isOpen)return void GameCommon.getInstance().addAlert(Language.instance.getText("error_tips_172"));if(e.fightcount<=0)return void GameCommon.getInstance().addAlert("error_tips_6");if(this.isCanEnterScene()){var t=new Message(MESSAGE_ID.CROSS_PVEBOSS_FIGHT_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onEnterWuTanScene=function(e,t,n){if(this.isCanEnterScene()){var a=new Message(MESSAGE_ID.WUTAN_FIGHT_MESSAGE);a.setShort(e),a.setShort(t),a.setInt(n),GameCommon.getInstance().sendMsgToServer(a)}},e.prototype.isCanEnterScene=function(){return this.fightsceneTpye==FIGHT_SCENE.YEWAIPVP?(GameCommon.getInstance().addAlert("error_tips_10001"),!1):this.fightsceneTpye==FIGHT_SCENE.DUP&&!this.canContiuneDup(this._fightDupId)||this.fightsceneTpye==FIGHT_SCENE.UNION_BOSS?(GameCommon.getInstance().addAlert("正在挑战副本中"),!1):this.fightsceneTpye==FIGHT_SCENE.LODDER_ARENA||this.fightsceneTpye==FIGHT_SCENE.SERVER_ARENA||this.fightsceneTpye==FIGHT_SCENE.THRONE||this.fightsceneTpye==FIGHT_SCENE.ESCORT||this.fightsceneTpye==FIGHT_SCENE.REVENGE||this.fightsceneTpye==FIGHT_SCENE.LOCAL_ARENA?(GameCommon.getInstance().addAlert("error_tips_10001"),!1):this.fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS||this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS||this.fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS||this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS||this.fightsceneTpye==FIGHT_SCENE.MYSTERIOUS_BOSS?(GameCommon.getInstance().addAlert("正在挑战BOSS中"),!1):!0},e.prototype.checkBagIsFull=function(){if(DataManager.getInstance().bagManager.cheakEquipbagIsFull(11)){var e=[{text:"背包容量不足，请先进行回收，否则将无法获得奖励。",style:{textColor:16733782}}];return GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.openSmeltView,this))),!0}return!1},e.prototype.openSmeltView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SmeltPanel")},e.prototype.canContiuneDup=function(e){var t=JsonModelManager.instance.getModelcopy()[e];if(!t)return!1;if(t.type==DUP_TYPE.DUP_CHALLENGE)return!0;var n=DataManager.getInstance().dupManager.getDupInfo(t.type,t.subType);return n&&t.type==DUP_TYPE.DUP_UNION&&n.pass<=JsonModelManager.instance.getModelguildfuben().length?!0:!1},Object.defineProperty(e.prototype,"canHitBack",{get:function(){return this.fightScene&&this.fightsceneTpye==FIGHT_SCENE.YEWAI_XG?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canBossMove",{get:function(){if(this.fightDupId>0){var e=JsonModelManager.instance.getModelcopy()[this.fightDupId];if(e.type==DUP_TYPE.DUP_SIXIANG)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canPatrol",{get:function(){if(this.fightDupId>0){var e=JsonModelManager.instance.getModelcopy()[this.fightDupId];if(e.type==DUP_TYPE.DUP_ZHUFU||e.type==DUP_TYPE.DUP_SIXIANG)return!1}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showShieldScene",{get:function(){return this.fightScene?this.fightsceneTpye==FIGHT_SCENE.YEWAI_XG?!1:!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"artifactFackerScene",{get:function(){return this.fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unableArtifactBoss",{get:function(){return this.fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.MYSTERIOUS_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.CROSS_PVE_BOSS?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPVPFightScene",{get:function(){return this.fightsceneTpye==FIGHT_SCENE.YEWAIPVP?!0:this.fightsceneTpye==FIGHT_SCENE.ESCORT?!0:this.fightsceneTpye==FIGHT_SCENE.LOCAL_ARENA?!0:this.fightsceneTpye==FIGHT_SCENE.LODDER_ARENA?!0:this.fightsceneTpye==FIGHT_SCENE.REVENGE?!0:this.fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS?!0:this.fightsceneTpye==FIGHT_SCENE.VIP_BOSS?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPKEffectScene",{get:function(){return this.fightsceneTpye==FIGHT_SCENE.LOCAL_ARENA?!0:this.fightsceneTpye==FIGHT_SCENE.LODDER_ARENA?!0:this.fightsceneTpye==FIGHT_SCENE.ESCORT?!0:this.fightsceneTpye==FIGHT_SCENE.REVENGE?!0:this.fightsceneTpye==FIGHT_SCENE.YEWAIPVP?!0:this.fightsceneTpye==FIGHT_SCENE.SERVER_ARENA?!0:!1},enumerable:!0,configurable:!0}),e.instance=null,e}();__reflect(GameFight.prototype,"GameFight");var Language=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.getText=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";for(var a in e){var i=e[a],o=JsonModelManager.instance.getModeltext();n+=o&&o[i]?o[i].text:i}return n},e.prototype.getAttrName=function(e){return this.getText("attr"+e+"_name")},e.prototype.parseInsertText=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=this.getText(e);for(var i in t){var o=this.getText(t[i]);a=a.replace("{"+i+"}",o)}return a},e.ALERT_DISCONNECT_1="网络中断，请重新登录",e.ALERT_DISCONNECT_2="该账户已在其他地方登录，请重新登录",e.ALERT_DISCONNECT_3="登录超时，请重新登录",e.ALERT_DISCONNECT_4="与服务器通信异常",e.ALERT_DISCONNECT_5="服务器维护中，请稍后再试",e.ALERT_DISCONNECT_6="账户异常，请联系客服",e._instance=null,e}();__reflect(Language.prototype,"Language");var LoadManager=function(){function e(){this._cacheBodyAnimation={},this._urlBodyAnimResAry=[],this.loadThingList={},this._loadingThingURLs=[],this.uiLoadedImageAry=[],this._mainviewImageAry=[],this.loadResList=[],this.Res_NotLoad=!0}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.getTexttrueUrlByVer=function(e){for(var t=["player","weapon","feijian","wing"],n=0;n<t.length;n++)if(e.indexOf("resource/model/"+t[n]+"/")>=0)return e+".png";return e.indexOf("resource/model/monster/")>=0?e+".png":e.indexOf("resource/model/sc_")>=0?e+".png":e+".png"},e.prototype.getJsonUrlByVer=function(e){for(var t=["player","weapon","feijian","wing"],n=0;n<t.length;n++)if(e.indexOf("resource/model/"+t[n]+"/")>=0)return e+".json";return e.indexOf("resource/model/monster/")>=0?e+".json":e.indexOf("resource/model/sc_")>=0?e+".json":e+".json"},Object.defineProperty(e,"resourceRootUrl",{get:function(){return ChannelDefine.cdnUrl+"resource/"},enumerable:!0,configurable:!0}),e.prototype.getMapResUrl=function(e,t){return ChannelDefine.cdnUrl+"resource/mapres/"+e+"/map"+e+"_"+t+".jpg"},e.prototype.getClothResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/player/"+a)}},e.prototype.getWeaponResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/weapon/"+a)}},e.prototype.getFeijianUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/feijian/"+a)}},e.prototype.getMountResUrl=function(e,t,n,a){if(void 0===a&&(a=!1),e&&t&&n){t=a?"top_"+t:t;var i=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/ride/"+i)}},e.prototype.getWingResUrl=function(e,t,n,a){if(void 0===a&&(a=!1),e&&t&&n){t=a?"top_"+t:t;var i=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/wing/"+i)}},e.prototype.getMagicResUrl=function(e,t){return ChannelDefine.cdnUrl+("resource/model/fabao/"+e)+(t?"_"+t:"")},e.prototype.getRingResUrl=function(e){return ChannelDefine.cdnUrl+("resource/model/guanghuan/"+e)},e.prototype.getMonsterResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/monster/"+a)}},e.prototype.getNpcResUrl=function(e,t,n){return void 0===n&&(n="1"),e&&t?ChannelDefine.cdnUrl+("resource/model/npc/"+(e+"_"+t+"_"+n)):void 0},e.prototype.getPetResUrl=function(e,t,n){return e&&t&&n?ChannelDefine.cdnUrl+("resource/model/pet/pet"+(e+"_"+t+"_"+n)):void 0},e.prototype.getRetinueClothResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/sc_role/"+a)}},e.prototype.getRetinueWeaponResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/sc_weapon/"+a)}},e.prototype.getRetinueWingResUrl=function(e,t,n){if(e&&t&&n){var a=e+"_"+t+"_"+n;return ChannelDefine.cdnUrl+("resource/model/sc_wing/"+a)}},e.prototype.getRetinueMountResUrl=function(e,t){if(e&&t){var n=e+"_"+t;return ChannelDefine.cdnUrl+("resource/model/sc_mount/"+n)}},e.prototype.getRetinueMagicResUrl=function(e,t){if(e&&t){var n=e+"_"+t;return ChannelDefine.cdnUrl+("resource/model/sc_magic/"+n)}},e.prototype.getResFileName=function(e){var t="",n="resource/model/",a=e.search(n);return t=e.slice(a+n.length,e.length)},e.prototype.loadRes=function(e){var t=e.resName+"_json",n=e.resName+"_png";if(RES.getRes(t)&&RES.getRes(n))Tool.callback(e.onLoadComplete,e,e.resName);else{var a=new LoadBody([t,n],e.onLoadComplete,e,e.resName);this.loadResList.push(a),this.startLoading()}},e.prototype.startLoading=function(){this.Res_NotLoad&&this.loadResList.length>0&&(this.Res_NotLoad=!1,this.Res_loadbody=this.loadResList.shift(),this.onLoading())},e.prototype.onLoading=function(){if(this.Res_loadbody&&this.Res_loadbody.resList.length>0){var e=this.Res_loadbody.resList.shift();
RES.hasRes(e)?RES.getRes(e)?this.onLoading():RES.getResAsync(e,this.onLoading,this):this.onLoading()}else this.loadingFinish()},e.prototype.loadingFinish=function(){this.Res_NotLoad=!0,this.Res_loadbody&&(this.Res_loadbody.callback(),this.Res_loadbody.destroy(),this.Res_loadbody=null),this.startLoading()},e.prototype.loadThingModel=function(e,t){if(t){var n=t.replace(ChannelDefine.cdnUrl+"resource/model/","");this._urlBodyAnimResAry.indexOf(n)<0&&this._urlBodyAnimResAry.push(n);var a=this.getJsonUrlByVer(t),i=this.getTexttrueUrlByVer(t),o=this.getResFileName(a),r=this._cacheBodyAnimation[o],s=this.getResFileName(i),h=this._cacheBodyAnimation[s];if(r&&h)return void Tool.callback(e.onLoadBodyComplete,e,t,r,h);var l=o.replace(".json","");if(this.loadThingList[l])return void this.loadThingList[l].animBodys.push(e);this.loadThingList[l]=new LoadThingModel,this.loadThingList[l].resName=t,this.loadThingList[l].animBodys.push(e),this._loadingThingURLs.indexOf(a)<0&&this._loadingThingURLs.push(a),this._loadingThingURLs.indexOf(i)<0&&this._loadingThingURLs.push(i),this.onLoadThingModelHandler()}},e.prototype.loadModelByName=function(e,t,n){var a=this.getJsonUrlByVer(e),i=this.getTexttrueUrlByVer(e),o=this.getResFileName(a),r=this._cacheBodyAnimation[o],s=this.getResFileName(i),h=this._cacheBodyAnimation[s];r&&h||(RES.getResByUrl(a,function(){},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(i,t,n,RES.ResourceItem.TYPE_IMAGE))},e.prototype.onLoadThingModelHandler=function(){if(0!=this._loadingThingURLs.length&&!this._loadingthingResUrl){this._loadingthingResUrl=this._loadingThingURLs.shift();var e=(this.getResFileName(this._loadingthingResUrl),null);this._loadingthingResUrl.indexOf(".png")>0?e=RES.ResourceItem.TYPE_IMAGE:this._loadingthingResUrl.indexOf(".json")>0&&(e=RES.ResourceItem.TYPE_JSON),RES.getResByUrl(this._loadingthingResUrl,this.bodyResLoadComplete,this,e)}},e.prototype.bodyResLoadComplete=function(e,t){var n=this.getResFileName(t),a="",i="",o="";if(n.indexOf(".png")>0?(a=n.replace(".png",""),o=n,i=a+".json"):n.indexOf(".json")>0&&(a=n.replace(".json",""),i=n,o=a+".png"),this._cacheBodyAnimation[n]=e,this.loadThingList[a]){var r=this.loadThingList[a],s=r.animBodys,h=r.resName,l=this._cacheBodyAnimation[i],g=this._cacheBodyAnimation[o];if(l&&g){for(var c=0;c<s.length;c++){var p=s[c];Tool.callback(p.onLoadBodyComplete,p,h,l,g)}this.loadThingList[a]=null,delete this.loadThingList[a]}}this._loadingthingResUrl=null,this.onLoadThingModelHandler()},e.prototype.onClearAllBodyAnimCache=function(e){void 0===e&&(e=!0);for(var t=0;t<this._urlBodyAnimResAry.length;t++){var n=this._urlBodyAnimResAry[t],a="resource/model/"+n;if(!this.onCheckHeroAvata(n,e)){var i=this.getTexttrueUrlByVer(a),o=this.getResFileName(i);RES.destroyRes(ChannelDefine.cdnUrl+i),this._cacheBodyAnimation[o]=null,delete this._cacheBodyAnimation[o];var r=this.getJsonUrlByVer(a),s=this.getResFileName(r);this._cacheBodyAnimation[s]=null,delete this._cacheBodyAnimation[s],RES.destroyRes(ChannelDefine.cdnUrl+r)}}this._urlBodyAnimResAry=[],this._loadingThingURLs=[];for(var h in this.loadThingList)for(var l=this.loadThingList[h],t=0;t<l.animBodys.length;t++)l.animBodys[t].onDisposeTextrue();this.loadThingList={},this._loadingthingResUrl=null},e.prototype.onCountImgSource=function(e){e.indexOf("map")>=0&&e.indexOf("_small_jpg")>=0||(e.indexOf("_png")>=0||e.indexOf("_jpg")>=0)&&this.uiLoadedImageAry.indexOf(e)<0&&this.uiLoadedImageAry.push(e)},e.prototype.addMainvewImageAry=function(e){for(var t=0;t<e.numChildren;t++){var n=e.getChildAt(t);if(egret.is(n,"egret.DisplayObjectContainer"))this.addMainvewImageAry(n);else if(egret.is(n,"eui.Image")){var a=n;this._mainviewImageAry.indexOf(a)<0&&this._mainviewImageAry.push(a)}}},e.prototype.reloadUIImageAndAnim=function(e){if(egret.is(e,"egret.DisplayObjectContainer"))for(var t=0;t<e.numChildren;t++){var n=e.getChildAt(t);egret.is(n,"egret.DisplayObjectContainer")?this.reloadUIImageAndAnim(n):egret.is(n,"BodyAnimation")||egret.is(n,"Animation")?this.reloadUIAnimHandler(n):this.reloadImageHanlder(n)}else this.reloadImageHanlder(e)},e.prototype.reloadImageHanlder=function(e){if(e&&egret.is(e,"eui.Image")){var t=e;if(!t.source)return;if("string"==typeof t.source){var n=t.source;t._source=null,t.source=n}else if(egret.is(t.source,"egret.Texture")){var n=new egret.Texture;n.bitmapData=t.source.bitmapData,t._source=null,t.source=n}}},e.prototype.reloadUIAnimHandler=function(e){if(egret.is(e,"BodyAnimation")||egret.is(e,"Animation")){var t=e;t.onReLoad()}},e.prototype.removeloadAllUIImage=function(){for(var e=[],t=0;t<this._mainviewImageAry.length;t++){var n=this._mainviewImageAry[t];e.push(n.source)}for(var t=this.uiLoadedImageAry.length-1;t>=0;t--){var a=this.uiLoadedImageAry[t];e.indexOf(a)>=0||(RES.destroyRes(a,!1),this.uiLoadedImageAry.splice(t,1))}platform.triggerGC()},e.prototype.resetAllUIResources=function(){for(var e=0;e<this.uiLoadedImageAry.length;e++){var t=this.uiLoadedImageAry[e];RES.destroyRes(t,!1)}this.uiLoadedImageAry=[],this.onClearAllBodyAnimCache(),platform.triggerGC();for(var e=0;e<this._mainviewImageAry.length;e++){var n=this._mainviewImageAry[e];this.reloadImageHanlder(n)}},e.prototype.onCheckHeroAvata=function(e,t){for(var n=0;n<DataManager.getInstance().playerManager.player.playerDatas.length;n++){for(var a=DataManager.getInstance().playerManager.player.playerDatas[n],i=[a.cloth_res,a.weapon_res,a.feijian_Res,a.wing_res,a.magic_res],o=0;o<i.length;o++){var r=i[o];if(r&&e.indexOf(r)>=0)return!0}if(JsonModelManager.instance.getModelchongwujinjie()[a.petGrade]){var s=JsonModelManager.instance.getModelchongwujinjie()[a.petGrade][0];if(s&&e.indexOf("pet/pet"+s.waixing1)>=0)return!0}if(!t)for(var h=0;h<a.targets.length;h++){var l=a.targets[h];switch(l.data.bodyType){case BODY_TYPE.BOSS:case BODY_TYPE.MONSTER:if(e.indexOf(l.data.avatar)>=0)return!0;break;case BODY_TYPE.PLAYER:case BODY_TYPE.ROBOT:for(var g=l.data,c=[g.cloth_res,g.weapon_res,g.feijian_Res,g.wing_res,g.magic_res],p=0;p<c.length;p++){var u=c[p];if(u&&e.indexOf(u)>=0)return!0}if(JsonModelManager.instance.getModelchongwujinjie()[g.petGrade]){var s=JsonModelManager.instance.getModelchongwujinjie()[g.petGrade][0];if(s&&e.indexOf("pet/pet"+s.waixing1)>=0)return!0}}}}return!1},e.instance=null,e}();__reflect(LoadManager.prototype,"LoadManager");var LoadBody=function(){function e(e,t,n,a){void 0===t&&(t=null),void 0===n&&(n=null),void 0===a&&(a=null),this.resList=e,this.callbackFunc=t,this.thisObject=n,this.param=a}return e.prototype.callback=function(){Tool.callback(this.callbackFunc,this.thisObject,this.param)},e.prototype.destroy=function(){this.resList=null,this.callbackFunc=null,this.thisObject=null,this.param=null},e}();__reflect(LoadBody.prototype,"LoadBody");var LoadThingModel=function(){function e(){this.animBodys=[],this.resName=""}return e}();__reflect(LoadThingModel.prototype,"LoadThingModel");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function a(a){LoadManager.getInstance().onCountImgSource(e),t.call(n,a,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?a(i):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var WXGameManager=function(){function e(){this._shareAwdLv=1e3,this._isFirstShare=!1,this.inviteawdZhulibiNum=0,this.weekend_shareNum=0,this.weekend_share_rewarded=[],this._weekendShareCD=0,this._sharecdClientTime=0}return Object.defineProperty(e.prototype,"shareAwdLv",{get:function(){return this._shareAwdLv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFirstShare",{get:function(){return this._isFirstShare},enumerable:!0,configurable:!0}),e.prototype.parseShareAwdLevelMsg=function(e){this._shareAwdLv=e.getShort(),this._isFirstShare=e.getBoolean(),GameCommon.getInstance().receiveMsgToClient(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN))},e.prototype.onAwardShareLevel=function(){var e=new Message(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE);e.setBoolean(!1),e.setShort(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseInviteFriendMsg=function(e){this.inviteCount=e.getByte(),this.inviteReachNum=e.getByte(),this.inviteawdNum=e.getByte(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onRequestInviteAwdMsg=function(){var e=new Message(MESSAGE_ID.WXGAME_INVITE_FRIEND_MSG);e.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.wxshareRedPoint=function(){return this.getWxShareAwdRpoint()?!0:this.getWxFriendShareRpoint()?!0:this.getWxOffLineShareRpoint()?!0:!1},e.prototype.getWxShareAwdRpoint=function(){var e=DataManager.getInstance().functionManager,t=JsonModelManager.instance.getModelfenxiang(),n=0;for(var a in t){var i=t[a];if(e.receives.indexOf(i.id)<0&&i.times<=e.shareNum)return!0;n=Math.max(i.times,n)}return 0==DataManager.getInstance().functionManager.cd&&e.shareNum<n?!0:!1},e.prototype.getWxLevelShareRpoint=function(){var e=JsonModelManager.instance.getModellvyaoqing();for(var t in e){var n=e[t];if(this.shareAwdLv<n.lv&&DataManager.getInstance().playerManager.player.level>=n.lv)return!0}return!1},e.prototype.getWxFriendShareRpoint=function(){for(var e=Constant.get(Constant.WXGAME_INVITE_FIREND).split("#"),t=0;t<e.length;t++){var n=e[t].split(","),a=parseInt(n[0]);if(a<=this.inviteReachNum&&(a>this.inviteawdNum||a>this.inviteawdZhulibiNum))return!0}return!1},e.prototype.getWxOffLineShareRpoint=function(){return DataManager.getInstance().playerManager.offlineAwdData.exp>0},e.prototype.onCheckLvYaoqingAwd=function(){FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)&&this.getWxLevelShareRpoint()&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"WXShareLevelAwardPanel")},e.prototype.onRequestOffLineExpAwdMsg=function(){var e=new Message(MESSAGE_ID.OFFLINE_EXP_SHARE_COMPLETE);e.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseActWeekendShareMsg=function(e){this.weekend_share_rewarded=[],this.weekend_shareNum=e.getByte(),this._weekendShareCD=e.getInt(),this._sharecdClientTime=egret.getTimer();for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.weekend_share_rewarded.indexOf(a)<0&&this.weekend_share_rewarded.push(a)}},e.prototype.onParseWeekendShareMsg=function(e){this.parseActWeekendShareMsg(e)},Object.defineProperty(e.prototype,"weekend_share_cd",{get:function(){var e=egret.getTimer()-this._sharecdClientTime;return Math.max(0,Math.floor((this._weekendShareCD-e)/1e3))},enumerable:!0,configurable:!0}),e.prototype.parseIosHuiguiMsg=function(e){this._IOSHuigui=e.getBoolean()},Object.defineProperty(e.prototype,"ios_huigui",{get:function(){return this._IOSHuigui},enumerable:!0,configurable:!0}),e.prototype.parseCollectionAwardMsg=function(e){DataManager.getInstance().playerManager.player.wxcolletion=!0,GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onupdateColletionStatus=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(a){switch(a.label){case 0:return t=0,e&&e.scene?(t=e.scene,[3,3]):[3,1];case 1:return[4,platform.getOption()];case 2:n=a.sent(),n&&n.scene&&(t=n.scene),a.label=3;case 3:return(1001==t||1104==t)&&(this._isColletionScene=!0),[2]}})})},Object.defineProperty(e.prototype,"isColletionScene",{get:function(){return this._isColletionScene},enumerable:!0,configurable:!0}),e}();__reflect(WXGameManager.prototype,"WXGameManager");var ActivityManager=function(){function e(){this.activity={},this._yugaoOpenCondition="server,0#server,1",Tool.addTimer(this.onGiftCDShow,this,1e3)}return e.prototype.parseMessage=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)if(t=this.getActivityData(e),t.isOpen)switch(this.activity[t.id]=t,t.id){case ACTIVITY_BRANCH_TYPE.DABIAOJIANGLI:DataManager.getInstance().newactivitysManager.parsedabiaoRank(e);break;case ACTIVITY_BRANCH_TYPE.SIGN_EVERYDAY:DataManager.getInstance().newactivitysManager.parseSignEveryDay(e);break;case ACTIVITY_BRANCH_TYPE.LOGON_ADD:DataManager.getInstance().newactivitysManager.parseLogonAdd(e);break;case ACTIVITY_BRANCH_TYPE.LOGON_LIMIT:DataManager.getInstance().newactivitysManager.parseLogonLimit(e);break;case ACTIVITY_BRANCH_TYPE.CHONGBANG_LIBAO:DataManager.getInstance().newactivitysManager.parseChongBang(e);break;case ACTIVITY_BRANCH_TYPE.YAOQIANSHU:DataManager.getInstance().newactivitysManager.parseyaoqianshu(e);break;case ACTIVITY_BRANCH_TYPE.XIANGOULIBAO:DataManager.getInstance().newactivitysManager.parsexiangou(e);break;case ACTIVITY_BRANCH_TYPE.GUANQIAXIANFENG:DataManager.getInstance().newactivitysManager.parseXianFeng(e);break;case ACTIVITY_BRANCH_TYPE.VIP_XIANGOU2:DataManager.getInstance().newactivitysManager.parsevipxiangou(e);break;case ACTIVITY_BRANCH_TYPE.PERSONAL_GOAL:DataManager.getInstance().newactivitysManager.parsedabiao(e);break;case ACTIVITY_BRANCH_TYPE.INVEST:DataManager.getInstance().newactivitysManager.parseinvest(e);break;case ACTIVITY_BRANCH_TYPE.MONEYTAKEGODGIFT:DataManager.getInstance().newactivitysManager.parseShenqi(e);break;case ACTIVITY_BRANCH_TYPE.NEWGODGIFT:DataManager.getInstance().newactivitysManager.parseShenqi1(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_SHOP:DataManager.getInstance().festivalShopManager.parseActMessage(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_WORDCOLLECTION:DataManager.getInstance().collectWordManager.parseActMessage(e);break;case ACTIVITY_BRANCH_TYPE.TEHUILIBAO:DataManager.getInstance().newactivitysManager.parseMessage(e);break;case ACTIVITY_BRANCH_TYPE.HONGBAOFANLI:DataManager.getInstance().newactivitysManager.parsehongbao(e);break;case ACTIVITY_BRANCH_TYPE.DENGLUJIANGLI:DataManager.getInstance().newactivitysManager.parsedenglu(e);break;case ACTIVITY_BRANCH_TYPE.LEIJICHONGZHI:DataManager.getInstance().newactivitysManager.parseleiji(e);break;case ACTIVITY_BRANCH_TYPE.CHONGZHISHENGYAN:DataManager.getInstance().newactivitysManager.parsechongzhi(e);break;case ACTIVITY_BRANCH_TYPE.TREASURE_RANK:case ACTIVITY_BRANCH_TYPE.TREASURE_RANK2:DataManager.getInstance().treasureRankManager.activityId=t.id,DataManager.getInstance().treasureRankManager.parseMessage(e);break;case ACTIVITY_BRANCH_TYPE.WISHINGWELL:DataManager.getInstance().wishingWellManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.VIPTLSHOP:DataManager.getInstance().vipTLShopManager.parseMessage(e);break;case ACTIVITY_BRANCH_TYPE.GIFTFORPAY:DataManager.getInstance().newactivitysManager.parsePayGift(e);break;case ACTIVITY_BRANCH_TYPE.SEVENDAYPAY:DataManager.getInstance().newactivitysManager.sevenpayId=t.id,DataManager.getInstance().newactivitysManager.parseSevenDayPay(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_LOGIN:case ACTIVITY_BRANCH_TYPE.FESTIVAL_LOGIN2:DataManager.getInstance().festivalLoginManager.activityID=t.id,DataManager.getInstance().festivalLoginManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_FAVORABLE:case ACTIVITY_BRANCH_TYPE.WEEKEND_FAVORABLE:case ACTIVITY_BRANCH_TYPE.FESTIVAL_FAVORABLE2:DataManager.getInstance().festivalFavorableManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_WISHING_WELL:case ACTIVITY_BRANCH_TYPE.WEEKEND_WISHING_WELL:DataManager.getInstance().festivalWishingwellManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_TARGET_PAY:case ACTIVITY_BRANCH_TYPE.FESTIVAL_TARGET:case ACTIVITY_BRANCH_TYPE.FESTIVAL_TARGET2:DataManager.getInstance().festivalTargetManager.activityId=t.id,DataManager.getInstance().festivalTargetManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.WANBA_PRIVILEGE_GIFT:DataManager.getInstance().playCafeManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.WUYIACTIVITY:DataManager.getInstance().festivalLoginManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.OPENSERVER_LEICHONG:DataManager.getInstance().openServerLeiChongManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.WUYITEHUILIBAO:DataManager.getInstance().festivalWuYiManager.onParseAdvanceMessage(e);break;case ACTIVITY_BRANCH_TYPE.ZHUANPANACTIVITY:DataManager.getInstance().festivalWuYiManager.parseZhuanpanRoundMsg(e);break;case ACTIVITY_BRANCH_TYPE.LIUYI_MISSION:DataManager.getInstance().festivalWuYiManager.parseLiuyiMissionList(e);break;case ACTIVITY_BRANCH_TYPE.LIUYIACTIVITDANCHONG:DataManager.getInstance().festivalDanChongManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.WX_PAYGIFT:DataManager.getInstance().wxDanChongManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.HEFU_MISSION:DataManager.getInstance().hefuActManager.parseHefuMissionList(e);break;case ACTIVITY_BRANCH_TYPE.HEFU_PAYGIFT:DataManager.getInstance().hefuActManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.HEFU_TREASURE:DataManager.getInstance().hefuActManager.parseZhuanpanRoundMsg(e);break;case ACTIVITY_BRANCH_TYPE.ACT_SHENQICHOUQIAN:DataManager.getInstance().shenqiZhuanPanManager.parseZhuanpanRoundMsg(e);break;case ACTIVITY_BRANCH_TYPE.HEFU_LEGEND:DataManager.getInstance().hefuActManager.parseChongBang(e);break;case ACTIVITY_BRANCH_TYPE.ZHIZUN_XIANGOU:DataManager.getInstance().newactivitysManager.parseZhiZunxiangou(e);break;case ACTIVITY_BRANCH_TYPE.LIANXU_LEICHONG:DataManager.getInstance().lianxuChongManager.onParseMessage(e);break;case ACTIVITY_BRANCH_TYPE.CONSUME_ITEM:DataManager.getInstance().totalConsumeManager.parseMessage(e);break;case ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU:DataManager.getInstance().tuangouActManager.parseTuangouMsg(e);break;case ACTIVITY_BRANCH_TYPE.CONSUME_RANK:break;case ACTIVITY_BRANCH_TYPE.LEICHONGLABA:DataManager.getInstance().labaManager.parseLunshu(e);break;case ACTIVITY_BRANCH_TYPE.ZHONGQIULEICHONG:DataManager.getInstance().zqManager.parseInit(e);break;case ACTIVITY_BRANCH_TYPE.JUEXINGDAN:DataManager.getInstance().jxdManager.parseInit(e);break;case ACTIVITY_BRANCH_TYPE.WEEKENDSHAREGIFT:for(var i=(e.getByte(),e.getInt(),egret.getTimer(),e.getByte()),o=0;i>o;o++){e.getByte()}break;case ACTIVITY_BRANCH_TYPE.ACT_666SHENQI2:DataManager.getInstance().a666Manager.parseInit(e);break;case ACTIVITY_BRANCH_TYPE.ACT_RONGLIAN:DataManager.getInstance().activitySmeltManager.parseInit(e)}else this.delActivity(t.id)},e.prototype.delActivity=function(e){delete this.activity[e],GameDispatcher.getInstance().dispatchEvent(new egret.Event("delActivity"))},e.prototype.getActivityData=function(e){var t,n=e.getInt(),a=1==e.getByte();if(a){var i=(e.getByte(),e.getInt());t=this.activity[n],t?(t.cd=i,t.reSetTime()):t=new ActivityData(n,a,i,0)}else t=new ActivityData(n,a,0);return t},e.prototype.getSortActivity=function(e){var t,n=JsonModelManager.instance.getModelactivityGroup()[e],a=GameCommon.parseIntArray(n.activityId),i=[],o=!1;for(var r in a)t=this.activity[a[r]],t&&t.isOpen&&i.push(t),a[r]==ACTIVITY_BRANCH_TYPE.YAOQIANSHU&&(o=!0);switch(e){case ACTIVITY_TYPE.ACTIVITY_FULIDATING:o||(this.activity[ACTIVITY_BRANCH_TYPE.YAOQIANSHU]=new ActivityData(ACTIVITY_BRANCH_TYPE.YAOQIANSHU,!0,0,1),i.push(this.activity[ACTIVITY_BRANCH_TYPE.YAOQIANSHU]))}return i},e.prototype.getActivityCD=function(e){if(e>=ActivityDefine.CLIENT_ORIGIN_ACTID){if(e==ACTIVITY_BRANCH_TYPE.COATARD){if(DataManager.getInstance().playerManager.receiveAllCoatard())return 0}else if(e==ACTIVITY_BRANCH_TYPE.FUND){if(DataManager.getInstance().investManager.isFundOver())return 0}else if(e==ACTIVITY_BRANCH_TYPE.YIYUANLIBAO){if(!DataManager.getInstance().rechargeManager.oneRecharge())return 0}else if(e==ACTIVITY_BRANCH_TYPE.CROSS_PAYRANK){if(this.getActivityCD(ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU)<=0)return 0}else if((e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_RANK||e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_TURNPLATE)&&this.getActivityCD(ACTIVITY_BRANCH_TYPE.CONSUME_ITEM)<=0)return 0;return 1}var t=this.activity[e];return t?t.cd-Tool.toInt((egret.getTimer()-t.currTime)/1e3):0},e.prototype.onGiftCDShow=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAIN_GIFT_COOLDOWN));var e=[],t=JsonModelManager.instance.getModelactivityGroup();for(var n in t){var a=this.onCheckActivity(t[n]);a>0&&e.indexOf(a)<0&&e.push(a)}e.length>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN),e)},e.prototype.onCheckActivity=function(e){var t=DataManager.getInstance().playerManager.player;if(e.id>=ActivityDefine.CLIENT_ORIGIN_ACTID||null==e.activityId||0==e.activityId.length)return 0;for(var n=GameCommon.parseIntArray(e.activityId),a=0,i=!0,o=0;o<n.length;o++){var r=n[o],s=JsonModelManager.instance.getModelactivity()[r];if(!(s&&s.openLv>t.level)){var h=this.activity[r];if(h&&h.isOpen){if(SDKManager.isHidePay)if(s&&s.isIos>0)h.isOpen=!1;else{var l=JsonModelManager.instance.getModelactivityFunction()[r];l&&l.isIos&&(h.isOpen=!1)}a=this.getActivityCD(r),0>=a&&(h.isOpen=!1),!h.isOpen&&i&&(i=!1)}}}return i?0:e.id},e.prototype.getActIsOpen=function(e){if(e<ActivityDefine.CLIENT_ORIGIN_ACTID){var t=this.activity[e];return t&&t.isOpen}return this.getActivityCD(e)>0},e.prototype.getIsOpenByGroupID=function(e){var t=!1,n=JsonModelManager.instance.getModelactivityGroup()[e];if(!n.activityId||0==n.activityId.length)return!0;for(var a=a=GameCommon.parseIntArray(n.activityId),i=0;i<a.length;i++){var o=a[i];if(o<ActivityDefine.CLIENT_ORIGIN_ACTID){var r=this.activity[o];if(r&&r.isOpen){t=!0;break}}else if(this.getActivityCD(o)>0){t=!0;break}}return t},e.prototype.checkActivityPoint=function(e){var t=JsonModelManager.instance.getModelactivityGroup()[e],n=GameCommon.parseIntArray(t.activityId);if(!n)return!1;for(var a=0;a<n.length;a++)if(this.checkActivityPointByID(n[a]))return!0;return!1},e.prototype.checkActivityPointByID=function(e){var t=this.getActivityCD(e);if(1e3>e&&0>=t)return!1;switch(e){case ACTIVITY_BRANCH_TYPE.DABIAOJIANGLI:return DataManager.getInstance().newactivitysManager.refreshDabiaoData(),!1;case ACTIVITY_BRANCH_TYPE.PERSONAL_GOAL:return DataManager.getInstance().newactivitysManager.refreshDabiaoData(),DataManager.getInstance().newactivitysManager.checkRedPointForTarget();case ACTIVITY_BRANCH_TYPE.COATARD:return DataManager.getInstance().newactivitysManager.checkRedPointForCoatard();case ACTIVITY_BRANCH_TYPE.SIGN_EVERYDAY:return DataManager.getInstance().newactivitysManager.checkRedPointForSign();case ACTIVITY_BRANCH_TYPE.YAOQIANSHU:return DataManager.getInstance().newactivitysManager.checkRedPointForYao1000();case ACTIVITY_BRANCH_TYPE.XIANGOULIBAO:return DataManager.getInstance().newactivitysManager.checkRedPointForXiangou();case ACTIVITY_BRANCH_TYPE.GUANQIAXIANFENG:return DataManager.getInstance().newactivitysManager.checkRedPointForXianfeng();case ACTIVITY_BRANCH_TYPE.LOGON_LIMIT:return DataManager.getInstance().newactivitysManager.checkRedPointForSign8();case ACTIVITY_BRANCH_TYPE.FUND:return DataManager.getInstance().newactivitysManager.checkRedPointForFund();case ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU:return DataManager.getInstance().tuangouActManager.oncheckTuangouRpoint();case ACTIVITY_BRANCH_TYPE.CONSUME_ITEM:return DataManager.getInstance().totalConsumeManager.onCheckRedPoint();case ACTIVITY_BRANCH_TYPE.LEICHONGLABA:return DataManager.getInstance().labaManager.getActivityPoint();case ACTIVITY_BRANCH_TYPE.ZHONGQIULEICHONG:return DataManager.getInstance().zqManager.getActivityPointAll();case ACTIVITY_BRANCH_TYPE.FESTIVAL_WORDCOLLECTION:return DataManager.getInstance().collectWordManager.getCanShowRedPoint()}return!1},e.prototype.checkLoginPointByDay=function(e){var t=DataManager.getInstance().newactivitysManager.denglu,n=JsonModelManager.instance.getModeldenglu();if(!t)return!1;var a;return n[e]&&(a=t[1],-1==a.indexOf(e)&&t[0]>=e)?!0:!1},e.prototype.checkHasFudaiItem=function(){return DataManager.getInstance().bagManager.getGoodsThingNumById(GoodsDefine.ITEM_FUDAI)>0},e.prototype.getRegisterTabBtnParam=function(e){if(e>=ActivityDefine.CLIENT_ORIGIN_ACTID){if(this.getActivityCD(e)<=0)return null;if(e==ACTIVITY_BRANCH_TYPE.CROSS_PAYRANK&&this.getActivityCD(ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU)<=0)return null;if((e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_RANK||e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_TURNPLATE)&&this.getActivityCD(ACTIVITY_BRANCH_TYPE.CONSUME_ITEM)<=0)return null;var t=JsonModelManager.instance.getModelactivityFunction()[e];if(t){if(SDKManager.isHidePay&&t.isIos>0)return null;var n=new RegisterTabBtnParam(t.panel,t.icon);return n.title=t.title,n}}else{if(!this.activity[e])return null;var a=JsonModelManager.instance.getModelactivity()[e];if(a){if(SDKManager.isHidePay&&a.isIos>0)return null;var n=new RegisterTabBtnParam(a.panel,a.icon);return n.title=a.title,n}}return null},e.prototype.getRegisterSystemParam=function(e){if(e>=ActivityDefine.CLIENT_ORIGIN_ACTID){if(this.getActivityCD(e)<=0)return null;if(e==ACTIVITY_BRANCH_TYPE.CROSS_PAYRANK&&this.getActivityCD(ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU)<=0)return null;if((e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_RANK||e==ACTIVITY_BRANCH_TYPE.CONSUMEITEM_TURNPLATE)&&this.getActivityCD(ACTIVITY_BRANCH_TYPE.CONSUME_ITEM)<=0)return null;var t=JsonModelManager.instance.getModelactivityFunction()[e];if(t){if(SDKManager.isHidePay&&t.isIos>0)return null;var n=new RegisterSystemParam(t.panel,t.icon);return n.title=t.title,n}}else{if(!this.activity[e])return null;var a=JsonModelManager.instance.getModelactivity()[e];if(a){if(SDKManager.isHidePay&&a.isIos>0)return null;var n=new RegisterSystemParam(a.panel,a.icon);return n.title=a.title,n}}return null},e.prototype.getActYugaoIdx=function(){for(var e=0,t=this._yugaoOpenCondition.split("#"),n=0;n<t.length;n++){var a=t[n].split(","),i=a[0],o=parseInt(a[1]);switch(i){case"server":o==DataManager.getInstance().playerManager.player.serverDay&&(e=n+1)}if(e>0)break}return e},e}();__reflect(ActivityManager.prototype,"ActivityManager");var ActivityData=function(){function e(e,t,n,a){void 0===a&&(a=1),this.id=e,this.isOpen=t,this.cd=n,this.order=a,this.reSetTime()}return e.prototype.reSetTime=function(){this.currTime=egret.getTimer()},e}();__reflect(ActivityData.prototype,"ActivityData");var NewactivitysManager=function(){function e(){this.record={},this.xiangou={},this.vipxiangou={},this.chongji={},this.denglu=[],this.leiji={},this.chongzhi={},this.qianbei_record={},this.zhizunxiangou={},this.activityarr=[],this.activityfuliarr=[],this.xiangouarr=[],this.zhizunxiangouArr=[],this.vipxiangouarr=[],this.chongjiarr=[],this.dengluarr=[],this.hongbaoarr=[],this.dabiao_ranks=[],this.dabiao_reward=[],this.signRewards=[],this.limitLoginRewardDay=[],this.xianfengReward=[],this.blessTp=0,this.payDays=0,this.sevenpayId=ACTIVITY_BRANCH_TYPE.SEVENDAYPAY,this.shenqiData=new ShenQiData,this.shenqiData1=new ShenQiData,this.activityarr=[],this.chargeMoneyNum=-1,this.gooditemnewactivity(),this.dengludatefunction(),this.yaoqianshufunction(),this.yaoqian1000=new Yaoqianshuinit,this.yaoqian1000.lingjiangarr=[],this.activityfuliarr.push(2)}return e.prototype.timerComFunc=function(){},e.prototype.chongxinlianjie=function(){this.activityarr=[]},e.prototype.gooditemnewactivity=function(){},e.prototype.yaoqianshufunction=function(){this.yaoqianshuXmldate={};var e,t=JsonModelManager.instance.getModelyaoqianshu();for(var n in t)e=t[n],this.yaoqianshuXmldate[e.id]||(this.yaoqianshuXmldate[e.id]=[]),this.yaoqianshuXmldate[e.id].push(e)},e.prototype.dengludatefunction=function(){this.denglumodel={};var e,t=JsonModelManager.instance.getModeldenglu();for(var n in t)e=t[n],this.denglumodel[e.id]||(this.denglumodel[e.id]=[]),this.denglumodel[e.id].push(e)},Object.defineProperty(e.prototype,"activityfuli",{get:function(){return this.activityfuliarr.sort(),this.activityfuliarr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xiangoudate",{get:function(){return this.xiangou},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vipxiangoudate",{get:function(){return this.vipxiangou},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chongjidate",{get:function(){return this.chongji},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dengludate",{get:function(){return this.denglu},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zhizunxiangoudate",{get:function(){return this.zhizunxiangou},enumerable:!0,configurable:!0}),e.prototype.parseMessage=function(e){-1==this.activityarr.indexOf(0)&&this.activityarr.push(0),this.record={};for(var t,n=e.getByte(),a=0;n>a;a++)t=e.getByte(),this.record[t]=t},e.prototype.parsedenglu=function(e){this.denglu=[],this.denglu.push(e.getByte()),this.dengluarr=[];for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.dengluarr.push(a)}this.denglu.push(this.dengluarr)},e.prototype.parseleiji=function(e){-1==this.activityarr.indexOf(5)&&this.activityarr.push(5),this.leiji={},this.leiji.atyuanbao=e.getInt(),this.leiji.lunci=e.getByte()},e.prototype.parsePayGift=function(e){this.payDays=e.getByte()},e.prototype.parseSevenDayPay=function(e){this.sevenpayDay=e.getByte(),this.sevenpayGold=e.getInt(),this.getawardDays=[];for(var t=e.getByte(),n=0;t>n;n++)this.getawardDays.push(e.getByte());this._sevenpayTime=1e3*e.getInt()+egret.getTimer()},Object.defineProperty(e.prototype,"sevenpayTime",{get:function(){return Math.max(0,Math.ceil((this._sevenpayTime-egret.getTimer())/1e3))},enumerable:!0,configurable:!0}),e.prototype.parsechongzhi=function(e){this.chongzhi={};var t=e.getInt(),n=e.getByte();this.chongzhi.yuanbao=t,this.chongzhi.boo=n},e.prototype.parsehongbao=function(e){-1==this.activityarr.indexOf(4)&&this.activityarr.push(4),this.hongbaoarr=[],this.hongbaodate={},this.hongbaodate.atday=e.getByte(),this.hongbaodate.dangqian=e.getInt(),this.hongbaodate.boo=e.getByte();for(var t=e.getByte(),n=0;t>n;n++){var a={};a.day=e.getByte(),a.yuanbao=e.getInt(),this.hongbaoarr.push(a)}this.hongbaodate.arr=this.hongbaoarr},e.prototype.parsexiangou=function(e){-1==this.activityarr.indexOf(1)&&this.activityarr.push(1),this.xiangou={};var t=e.getByte();this.activitysday=t;for(var n=e.getByte(),a=0;n>a;a++){this.xiangouarr=[];var i=e.getByte(),o=e.getShort();this.xiangouarr.push(i),this.xiangouarr.push(o),this.xiangou[i]=this.xiangouarr}},e.prototype.parseZhiZunxiangou=function(e){this.zhizunxiangou={};var t=e.getByte();this.zhizunDay=t;for(var n=e.getByte(),a=0;n>a;a++){this.zhizunxiangouArr=[];var i=e.getByte(),o=e.getShort();this.zhizunxiangouArr.push(i),this.zhizunxiangouArr.push(o),this.zhizunxiangou[i]=this.zhizunxiangouArr}},e.prototype.parsedabiao=function(e){var t=e.getByte();this.personal_dabiao_model=JsonModelManager.instance.getModeldabiaohuodong()[t];for(var n=e.getByte(),a=0;n>a;a++)this.dabiao_reward[a]=e.getByte()},e.prototype.parseinvest=function(e){this.isBuyInvestment=e.getBoolean(),this.isBuyInvestment&&(this.investmentDays=e.getByte())},e.prototype.parseShenqi=function(e){this.shenqiData.round=e.getByte(),this.shenqiData.sum=e.getInt(),this.shenqiData.isgoal=e.getBoolean(),this.shenqiData.isreward=1==e.getByte()},e.prototype.parseShenqi1=function(e){this.shenqiData1.round=e.getByte(),this.shenqiData1.sum=e.getInt(),this.shenqiData1.isgoal=e.getBoolean(),this.shenqiData1.isreward=1==e.getByte()},e.prototype.parsedabiaoRank=function(e){var t=e.getByte();this.blessTp=t,this.dabiao_model=JsonModelManager.instance.getModeldabiaorewards()[t]},e.prototype.refreshDabiaoData=function(){if(this.dabiao_model){for(var t=1;this.dabiao_model["mubiao"+t];){if(0==this.dabiao_reward[t-1]){this.dabiao_target=this.dabiao_model["mubiao"+t];break}t++}var n=DataManager.getInstance().playerManager.player.getPlayerData(0);switch(this.dabiao_model.type){case e.DABIAO_TYPE_REDEQUIP:this.dabiao_value=n.seniorEquipsPower+n.qihunPower;break;case e.DABIAO_TYPE_SIXIANG:this.dabiao_value=n.fourinagesPower;break;case e.DABIAO_TYPE_MERIDIAN:this.dabiao_value=DataManager.getInstance().pulseManager.pulsePower();break;case e.DABIAO_TYPE_PET:this.dabiao_value=DataManager.getInstance().petManager.power;break;case e.DABIAO_TYPE_JEWEL:this.dabiao_value=DataManager.getInstance().forgeManager.getRoleGemPower();break;default:this.dabiao_value=n.blessinfos[this.dabiao_model.type].grade
}}},e.prototype.parseyueka=function(e){-1==this.activityfuliarr.indexOf(1)&&this.activityfuliarr.push(1)},e.prototype.parseyaoqianshu=function(e){-1==this.activityfuliarr.indexOf(0)&&this.activityfuliarr.push(0),this.yaoqian1000.yaoqianshuindex=e.getShort();for(var t=e.getByte(),n=0;t>n;n++)this.yaoqian1000.lingjiangarr.push(e.getByte())},e.prototype.yaoqianshuyaoqian=function(e){this.yaoqian1000.yaoqianshuindex=e.getShort();e.getInt();this.yaoqianshuBoom=e.getByte()},e.prototype.parseyaoqianlingjiang=function(e){this.yaoqian170=new YaoqianshuYaoqian,this.yaoqian170.yaoqianindex=e.getShort(),this.yaoqian170.chanchu=e.getInt(),this.yaoqian1000.yaoqianshuindex=this.yaoqian170.yaoqianindex},e.prototype.parseyaoqianshulingjiang=function(e){var t=e.getByte();this.yaoqian1000.lingjiangarr.push(t)},e.prototype.parseQianbeiMessage=function(e){this.qianbei_record={};for(var t,n=e.getByte(),a=0;n>a;a++)t=e.getByte(),this.qianbei_record[t]=t},Object.defineProperty(e.prototype,"itemid",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),e.prototype.parseBuyMessage=function(e){var t=e.getByte();this._id=t,this.record[t]=t},e.prototype.parseBuyxiangouMessage=function(e){var t=e.getByte(),n=e.getShort();this.xiangou[t]=[t,n]},e.prototype.parseBuyVipxiangouMessage=function(e){var t=e.getByte(),n=e.getShort();this.vipxiangou[t]=[t,n]},e.prototype.parseBuyzhizunxiangouMessage=function(e){this.zhizunxiangouArr=[];var t=e.getByte(),n=e.getShort();this.zhizunxiangouArr.push(t),this.zhizunxiangouArr.push(n),this.zhizunxiangou[t]=this.zhizunxiangouArr},e.prototype.parseBuychongjiMessage=function(e){var t=e.getByte(),n=e.getShort();this.chongji[t]=[t,n]},e.prototype.parseBuydabiaoMessage=function(e){for(var t=e.getByte(),n=0;t>n;n++)this.dabiao_reward[n]=e.getByte()},e.prototype.parsedabiaopaihangMessage=function(e){for(var t=[],n=(e.getInt(),e.getByte()),a=0;n>a;a++){var i=[];i.push(e.getByte()),i.push(e.getInt()),i.push(e.getString()),i.push(e.getByte()),i.push(e.getInt()),i.push(e.getInt()),t.push(i)}this.dabiao_ranks=t},e.prototype.getMyRank=function(e){for(var t in this.dabiao_ranks){var n=this.dabiao_ranks[t];if(n[1]==e)return n[0]}return-1},e.prototype.parseSignEveryDay=function(e){this.signId=e.getByte();for(var t=0;3>t;t++)this.signRewards[t]=e.getByte();this.payToday=1==e.getByte()},e.prototype.parseLogonAdd=function(e){this.loginDay=e.getShort(),this.loginRewardDay=e.getByte(),this.currLoginMode=null;var t=JsonModelManager.instance.getModeldenglu2();for(var n in t){var a=t[n];if(a.days>this.loginRewardDay){this.currLoginMode=a;break}}},e.prototype.parseLogonLimit=function(e){this.limitLoginDay=e.getShort();for(var t=e.getByte(),n=0;t>n;n++)this.limitLoginRewardDay[n]=e.getByte()},e.prototype.parseChongBang=function(e){this.chongbangLiBaoId=e.getByte(),this.chargeMoneyNum=e.getInt()},e.prototype.parseXianFeng=function(e){for(var t=e.getShort(),n=0;t>n;n++)this.xianfengReward[n]=e.getByte()},e.prototype.parsevipxiangou=function(e){-1==this.activityarr.indexOf(1)&&this.activityarr.push(1),this.vipxiangou={},e.getByte();for(var t=e.getByte(),n=0;t>n;n++){this.vipxiangouarr=[];var a=e.getByte(),i=e.getShort();this.vipxiangouarr.push(a),this.vipxiangouarr.push(i),this.vipxiangou[a]=this.vipxiangouarr}},e.prototype.checkRedPointForTarget=function(){if(this.dabiao_model)for(var e=0;e<this.dabiao_reward.length;e++)if(0==this.dabiao_reward[e]&&this.dabiao_model["mubiao"+(e+1)]<=this.dabiao_value)return!0;return!1},e.prototype.checkRedPointForCoatard=function(){return!1},e.prototype.checkRedPointForSign=function(){for(var e=0;e<this.signRewards.length;e++)if(0==this.signRewards[e]){if(0==e)return!0;if(1==e&&DataManager.getInstance().playerManager.player.viplevel>0)return!0;if(2==e&&this.payToday)return!0}return!1},e.prototype.checkRedPointForYao1000=function(){return this.yaoqian1000.lingjiangarr?-1!=this.yaoqian1000.lingjiangarr.indexOf(2)?!1:-1!=this.yaoqian1000.lingjiangarr.indexOf(1)?this.yaoqian1000.yaoqianshuindex>=50:-1!=this.yaoqian1000.lingjiangarr.indexOf(0)?this.yaoqian1000.yaoqianshuindex>=20:this.yaoqian1000.yaoqianshuindex>=5:void 0},e.prototype.checkRedPointForXiangou=function(){var e=JsonModelManager.instance.getModelxiangoulibao();for(var t in e){var n=e[t];if(n.round==this.activitysday){var a=GameCommon.getInstance().onParseAwardItemstr(n.price),i=0;if(this.xiangoudate[n.id]){if(i=this.xiangoudate[n.id][1],i<n.max&&DataManager.getInstance().playerManager.player.getICurrency(a[0].type)>=a[0].num)return!0}else if(DataManager.getInstance().playerManager.player.viplevel>=n.vip&&DataManager.getInstance().playerManager.player.getICurrency(a[0].type)>=a[0].num)return!0}}return!1},e.prototype.checkRedPointForXianfeng=function(){var e=JsonModelManager.instance.getModelguanqiaxianfeng();for(var t in e){var n=e[t];if(0==DataManager.getInstance().newactivitysManager.xianfengReward[n.id-1]&&n.mapId<=GameFight.getInstance().yewai_waveIndex)return!0}return!1},e.prototype.checkRedPointForSign8=function(){var e=JsonModelManager.instance.getModeldenglu(),t=0;for(var n in e){var a=e[n];if(a.days<=this.limitLoginDay&&0==this.limitLoginRewardDay[t])return!0;t++}return!1},e.prototype.checkRedPointForFund=function(){if(!DataManager.getInstance().investManager.fundBuy)return!1;var e,t=JsonModelManager.instance.getModelfund(),n=DataManager.getInstance().investManager.fundReward;for(var a in t)if(e=t[a],DataManager.getInstance().playerManager.player.getPlayerData(0).coatardLv>=e.id&&0==n[e.id-2])return!0;return!1},e.DABIAO_TYPE_REDEQUIP=10,e.DABIAO_TYPE_SIXIANG=11,e.DABIAO_TYPE_MERIDIAN=12,e.DABIAO_TYPE_PET=13,e.DABIAO_TYPE_JEWEL=14,e}();__reflect(NewactivitysManager.prototype,"NewactivitysManager");var Yaoqianshuinit=function(){function e(){this.yaoqianshuindex=0}return e}();__reflect(Yaoqianshuinit.prototype,"Yaoqianshuinit");var YaoqianshuYaoqian=function(){function e(){}return e}();__reflect(YaoqianshuYaoqian.prototype,"YaoqianshuYaoqian");var ShenQiData=function(){function e(){this.isreward=!1}return e}();__reflect(ShenQiData.prototype,"ShenQiData");var FestivalDanChongManager=function(){function e(){this.day=1,this.record=[]}return e.prototype.onParseMessage=function(e){var t=e.getByte();this.record=[];for(var n=0;t>n;n++)this.record.push(e.getByte());this.day=e.getByte(),Tool.log("13123")},e}();__reflect(FestivalDanChongManager.prototype,"FestivalDanChongManager");var FestivalFavorableManager=function(){function e(){this.record=[]}return e.prototype.onParseMessage=function(e){var t=e.getByte();this.record=[];for(var n=0;t>n;n++)this.record.push(e.getByte())},e.prototype.onSendMessage=function(e,t){var n=new Message(MESSAGE_ID.REBATE_TO_BUY_MESSAGE);n.setByte(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onPraseBuyMessage=function(e,t){var n=e.getByte();this.record.indexOf(n)&&this.record.push(n)},e}();__reflect(FestivalFavorableManager.prototype,"FestivalFavorableManager");var FestivalLoginManager=function(){function e(){this.day=1,this.record={}}return e.prototype.onParseMessage=function(e){this.day=e.getByte(),this.record={};for(var t,n=1;n<=this.day;n++)t=new FestivalLoginbase,t.day=n,t.onParseMessage(e),this.record[n]=t},e.prototype.onSendLoginAwardReceive=function(e){var t;switch(this.activityID){case ACTIVITY_BRANCH_TYPE.FESTIVAL_LOGIN:t=MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE;break;case ACTIVITY_BRANCH_TYPE.FESTIVAL_LOGIN2:t=MESSAGE_ID.WEEKEND_LOGIN_AWARD_RECEIVE}var n=new Message(t);n.setByte(e),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.onParseLoginAwardReceive=function(e){var t=this.record[e.getByte()];t&&(t.state=2)},e.prototype.checkLoginAwardCanReceive=function(){for(var e=1;e<=this.day;e++)if(this.checkLoginAwardCanReceiveByDay(e))return!0;return!1},e.prototype.checkLoginAwardCanReceiveByDay=function(e){var t=this.record[e];return t&&1==t.state?!0:!1},e}();__reflect(FestivalLoginManager.prototype,"FestivalLoginManager");var FestivalLoginbase=function(){function e(){}return e.prototype.onParseMessage=function(e){this.state=e.getByte()},e}();__reflect(FestivalLoginbase.prototype,"FestivalLoginbase");var FestivalLuckyBagManager=function(){function e(){}return e.prototype.onParseMessage=function(e){},e}();__reflect(FestivalLuckyBagManager.prototype,"FestivalLuckyBagManager");var FestivalShopManager=function(){function e(){this.shoptypes=[],this.refreshTimes=[],this.shopListInfo={}}return e.prototype.parseActMessage=function(e){this.shoptypes=[],this.shopListInfo={},this.refreshTimes=[];for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.shoptypes.push(a),this.shopListInfo[a]=[]}this.payCount=e.getInt()},e.prototype.parseShopInfoMsg=function(e){var t=e.getByte();if(!(this.shoptypes.indexOf(t)<0)){var n=e.getInt();this.refreshTimes[t]=n>0?1e3*n+egret.getTimer():0,this.shopListInfo[t]=[];for(var a=e.getByte(),i=0;a>i;i++){var o=new FestiavlShopData;o.parseMsg(e),o.index=i,this.shopListInfo[t].push(o)}GameCommon.getInstance().receiveMsgToClient(e)}},e.prototype.parseShopBuyMsg=function(e){for(var t=e.getByte(),n=e.getByte(),a=0;n>a;a++){var i=e.getByte(),o=e.getInt(),r=this.shopListInfo[t];r[i]&&(r[i].limitNum=o)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.onRequestShopInfoMsg=function(e){if(this.shoptypes.indexOf(e)>=0){var t=new Message(MESSAGE_ID.FESTIVAL_SHOP_INFO_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}},e.prototype.onReqestRefreshShopMsg=function(e){var t=new Message(MESSAGE_ID.FESTIVAL_SHOP_REFRESH_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.onSendBuyItemMsg=function(e,t){var n=new Message(MESSAGE_ID.FESTIVAL_SHOP_BUY_MESSAGE);n.setByte(e),n.setByte(t),GameCommon.getInstance().sendMsgToServer(n)},e}();__reflect(FestivalShopManager.prototype,"FestivalShopManager");var FestiavlShopData=function(){function e(){}return e.prototype.parseMsg=function(e){this.id=e.getShort(),this.limitNum=e.getInt()},e}();__reflect(FestiavlShopData.prototype,"FestiavlShopData");var FestivalTargetManager=function(){function e(){this.record={}}return e.prototype.onParseMessage=function(e){this.round=e.getByte(),this.gear=e.getByte(),this.consume=e.getInt()},e.prototype.onSendTargetAwardReceive=function(){var e=new Message(MESSAGE_ID.FESTIVAL_TARGET_AWARD_RECEIVE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendPayTargetAwardReceive=function(){var e=new Message(MESSAGE_ID.PAY_TARGET_AWARD_RECEIVE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseTargetAwardReceive=function(e){this.gear=e.getByte()},e.prototype.onSendTargetRankList=function(){var e=new Message(MESSAGE_ID.FESTIVAL_TARGET_RANKLIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onSendPayTargetRankList=function(){var e=new Message(MESSAGE_ID.PAY_TARGET_RANKLIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseTargetRankList=function(e){var t,n=e.getByte();this.record={};for(var a=0;n>a;a++)t=new FestivalTargetRankbase,t.onParseMessage(e),this.record[t.rank]=t},Object.defineProperty(e.prototype,"data",{get:function(){var e,t,n=[];for(var a in this.record)t=this.record[a],t.rank>=4&&(e=new TopRankSimple,e.rank=t.rank,e.name=t.name,e.vip=t.vip,e.value=t.value1,e.fighting=t.value2,n.push(e));return n},enumerable:!0,configurable:!0}),e}();__reflect(FestivalTargetManager.prototype,"FestivalTargetManager");var FestivalTargetRankbase=function(){function e(){}return e.prototype.onParseMessage=function(e){this.rank=e.getByte(),this.name=e.getString(),this.vip=e.getByte(),this.value1=e.getInt(),this.value2=e.getInt()},e}();__reflect(FestivalTargetRankbase.prototype,"FestivalTargetRankbase");var FestivalWishingwellManager=function(){function e(){this.round=0,this.time=0,this.record=[]}return e.prototype.onParseMessage=function(e){this.record=[],this.round=e.getByte(),this.time=e.getByte();for(var t=e.getByte(),n=0;t>n;n++)this.record.push(e.getByte())},Object.defineProperty(e.prototype,"data",{get:function(){var e,t=JsonModelManager.instance.getModelxuyuanchi2();for(var n in t)t[n].round==this.round&&(e=t[n]);return e},enumerable:!0,configurable:!0}),e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.FESTIVAL_WISHING_WELL_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseAdvanceMessage=function(e){this.time=e.getByte(),this.currAwardID=e.getByte(),this.record.push(this.currAwardID)},e}();__reflect(FestivalWishingwellManager.prototype,"FestivalWishingwellManager");var SDKUnicorn=function(){function e(){}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.onCreateRole=function(t,n){var a=t,i=e,o={appid:i.STATISTICS_APPID,who:a.account,deviceid:i.DEFAULT_VALUE,serverid:a.serverId,channelid:a.channel,idfa:i.DEFAULT_VALUE,idfv:i.DEFAULT_VALUE,accounttype:i.DEFAULT_VALUE,gender:i.DEFAULT_VALUE,age:i.DEFAULT_VALUE},r=JSON.stringify(o);HttpUtil.sendPostStringRequest(e.STATISTICS_REGISTER_URL,this.onRegisterCompleted,this,r)},e.prototype.onRegisterCompleted=function(e){var t=e.currentTarget,n=JSON.parse(t.response);0!=n.status&&egret.error("SDKUnicorn.onRegisterCompleted() failed. result="+n.status)},e.prototype.onEnterGame=function(t,n){var a=t,i=e,o={appid:i.STATISTICS_APPID,who:a.account,deviceid:i.DEFAULT_VALUE,idfa:i.DEFAULT_VALUE,idfv:i.DEFAULT_VALUE,serverid:a.serverId,channelid:a.channel,level:n.level},r=JSON.stringify(o);HttpUtil.sendPostStringRequest(e.STATISTICS_LOGIN_URL,this.onLoginCompleted,this,r)},e.prototype.onLoginCompleted=function(e){var t=e.currentTarget,n=JSON.parse(t.response);0!=n.status?egret.log("SDKUnicorn.onLoginCompleted() failed. result="+n.status):egret.log("SDKUnicorn.onLoginCompleted() success.")},e.prototype.init=function(e){},e.STATISTICS_APPID="cj8xZkC8XS87b",e.DEFAULT_VALUE="unknown",e.STATISTICS_BASE_URL="http://log.gank-studio.com",e.STATISTICS_REGISTER_URL=e.STATISTICS_BASE_URL+"/receive/register",e.STATISTICS_LOGIN_URL=e.STATISTICS_BASE_URL+"/receive/login",e}();__reflect(SDKUnicorn.prototype,"SDKUnicorn",["ISDKStatistics"]);var FestivalWuYiManager=function(){function e(){this.round=0,this.zhuanpanNum=0,this.record={},this.zhuanpanId=0,this.zhuanpanType=0,this.zhuanpanAwardNum=0,this.tp=0,this.currInfo=[],this.zhuanpanCfg=JsonModelManager.instance.getModelzhuanpanhuodong()[1],this.liuyiMission={},this.zhuanpanRanks=[]}return e.prototype.onParseZhuanPanMessage=function(e){if(this.treasureAwdIdx=e.getShort(),this.zhuanpanNum=e.getShort(),this.tp=e.getByte(),1==this.tp)this.zhuanpanType=e.getByte(),this.zhuanpanId=e.getShort(),this.zhuanpanAwardNum=e.getInt();else if(10==this.tp||9==this.tp){this.temAward=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new AwardItem;a.type=e.getByte(),a.id=e.getShort(),a.num=e.getInt(),this.temAward.push(a)}}},e.prototype.parseZhuanpanRankMsg=function(e){this.zhuanpanRanks=[];for(var t=e.getByte(),n=0;t>n;n++){this.zhuanpanRanks[n]||(this.zhuanpanRanks[n]=new FestivalZhuanPanRank);var a=this.zhuanpanRanks[n];a.parseMsg(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseZhuanpanRoundMsg=function(e){this.zhuanpanRound=e.getByte(),this.zhuanpanModel=JsonModelManager.instance.getModelzhuanpanhuodong()[this.zhuanpanRound+1]},Object.defineProperty(e.prototype,"data",{get:function(){var e,t=JsonModelManager.instance.getModelxuyuanchi2();for(var n in t)t[n].round==this.round&&(e=t[n]);return e},enumerable:!0,configurable:!0}),e.prototype.parseLiuyiMissionList=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=new TaskChainData;a.parseMsg(e),this.liuyiMission[a.taskId]=a}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseLiuyiMissonUpdate=function(e,t){void 0===t&&(t=0),t=0==t?e.getByte():t;for(var n=0;t>n;n++){var a=e.getShort(),i=this.liuyiMission[a];i.progress=e.getLong(),i.count=e.getByte()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkLiyiMissionRedPoint=function(){for(var e in this.liuyiMission){var t=this.liuyiMission[e];if(1==t.count)return!0}return!1},e.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.FESTIVAL_WISHING_WELL_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.onParseLiBao=function(e){var t=e.getByte();this.record[t]=t},e.prototype.onParseAdvanceMessage=function(e){for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.record[a]=a}},e.prototype.getActivityPoint=function(){return this.checkZhuanPanPoint()?!0:this.loginPoint()?!0:!1},e.prototype.checkZhuanPanPoint=function(){return DataManager.getInstance().bagManager.getGoodsThingNumById(this.zhuanpanCfg.costList[0].id,this.zhuanpanCfg.costList[0].type)>=this.zhuanpanCfg.costList[0].num?!0:this.checkTreasurePoint()?!0:!1},e.prototype.checkSalePoint=function(){for(var e=1;5>e;e++){this.loginActCfg=JsonModelManager.instance.getModeltehuilibaohuodong()[e];var t=DataManager.getInstance().festivalWuYiManager.record,n=DataManager.getInstance().playerManager.player.getICurrency(5);if(n>=this.loginActCfg.price&&!t[e]){for(var a in t)t[a]!=e;return!0}}return!1},e.prototype.loginPoint=function(){var e=DataManager.getInstance().festivalLoginManager;for(var t in e.record)if(1==e.record[t].state)return!0;return!1},e.prototype.checkTreasurePoint=function(){for(var e=this.zhuanpanCfg.box.split("#"),t=0;t<e.length;t++){var n=e[t]?e[t].split(","):null;if(!n)break;var a=parseInt(n[0]);if(!(this.treasureAwdIdx>=a)&&this.zhuanpanNum>=a)return!0}return!1},e.prototype.onParseCelestiaTreasureLog=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=new ZhuanPanLog,t.parseMessage(e),this.currInfo.push(t);this.onfilter()},e.prototype.onfilter=function(){for(;this.currInfo.length>10;)this.currInfo.shift()},e.prototype.getTextFlow=function(){for(var e,t=[],n=0;n<this.currInfo.length;n++){e=this.currInfo[n];var a=GameCommon.getInstance().getThingModel(e.award.type,e.award.id,e.award.quality);a&&(t.push({text:e.name,style:{textColor:2661098}}),t.push({text:" 获得",style:{textColor:16777215}}),t.push({text:a.name+"*"+e.award.num,style:{textColor:GameCommon.getInstance().CreateNameColer(a.quality)}}),t.push({text:"\n",style:{}}))}return t.pop(),t},e}();__reflect(FestivalWuYiManager.prototype,"FestivalWuYiManager");var ZhuanPanLog=function(){function e(){}return e.prototype.parseMessage=function(e){this.name=e.getString(),this.award=new AwardItem,this.award.parseMessage(e)},e}();__reflect(ZhuanPanLog.prototype,"ZhuanPanLog");var FestivalZhuanPanRank=function(){function e(){}return e.prototype.parseMsg=function(e){this.rank=e.getByte(),this.playerId=e.getInt(),this.playerName=e.getString(),this.viplevel=e.getByte(),this.lotteryNum=e.getInt()},e}();__reflect(FestivalZhuanPanRank.prototype,"FestivalZhuanPanRank");var BaihuSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.Style_PosAry=[330,30,90,150,210,270],n.Style_Distances=[120,230],n.skillEffects=[],n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this);this.param.releaseBody;if(!Tool.isNumber(this.skinNum)||this.skinNum!=this.param.skillInfo.styleNum){this.skinNum=this.param.skillInfo.styleNum;for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];n.onDestroy(),n=null,this.skillEffects.splice(t,1)}}this._count=0;var a=this.skinNum>0?this.skinNum-(this.param.skillInfo.id-1)*SkillDefine.SKIN_NUM:0;switch(a){case 1:this.onplayEffect("skill_wan");break;case 2:this.onplayEffect("skill_du");break;case 3:this.onplayEffect("skill_bing1");break;default:this.onplayEffect("skill_leidian")}},t.prototype.onplayEffect=function(e){if(this.isplaying){if(this.Style_Distances.length<=this._count)return void Tool.callbackTime(this.end,this,500);for(var t=this.param.releaseBody,n=this.Style_Distances[this._count],a=this.Style_PosAry.length,i=0;a>i;i++){var o=this._count*a+i;this.skillEffects[o]||(this.skillEffects[o]=new SkillEffectBody(e,null,0));var r=(this.Style_PosAry[i]-30*this._count)%360,s=Tool.getPosByRadiiAndAngle(t.x,t.y,r,n);this.skillEffects[o].x=s.x,this.skillEffects[o].y=s.y,t.addEffectToSprite(this.skillEffects[o],t.parent),this.skillEffects[o].onRePlay(1)}this._count++,Tool.callbackTime(this.onplayEffect,this,100,e)}},t.prototype.dispose=function(){if(this.isplaying){for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];egret.Tween.removeTweens(n),n.onRePlay(0),n.parent&&n.parent.removeChild(n)}e.prototype.dispose.call(this)}},t.prototype.onDestory=function(){this.isplaying=!1;for(var e=this.skillEffects.length-1;e>=0;e--){var t=this.skillEffects[e];t&&(egret.Tween.removeTweens(t),t.onDestroy(),this.skillEffects.splice(e,1),t=null)}this.skillEffects=[]},t}(SkillEffectBase);__reflect(BaihuSkillEffect.prototype,"BaihuSkillEffect");var BossSkillStyle1Effect=function(e){function t(t){var n=e.call(this,t)||this;return n.Style_PosAry=[330,30,90,150,210,270],n.Style_Distances=[150],n.skillEffects=[],n}return __extends(t,e),t.prototype.play=function(){return this.isdestory?void this.end():(e.prototype.play.call(this),this._count=0,void this.onplayEffect("Boss_skill_4"))},t.prototype.onplayEffect=function(e){if(this.isplaying){if(this.Style_Distances.length<=this._count)return void Tool.callbackTime(this.end,this,500);for(var t=this.Style_Distances[this._count],n=this.Style_PosAry.length,a=0;n>a;a++){var i=this._count*n+a;this.skillEffects[i]||(this.skillEffects[i]=new SkillEffectBody(e,null,1));var o=(this.Style_PosAry[a]-30*this._count)%360,r=Tool.getPosByRadiiAndAngle(this.param.releaseBody.x,this.param.releaseBody.y,o,t);this.skillEffects[i].x=r.x,this.skillEffects[i].y=r.y,this.param.releaseBody.addEffectToSprite(this.skillEffects[i],this.param.releaseBody.parent),this.skillEffects[i].onRePlay(1)}this._count++,Tool.callbackTime(this.onplayEffect,this,100,e)}},t.prototype.dispose=function(){if(this.isplaying){for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];egret.Tween.removeTweens(n),n.onRePlay(0),n.parent&&n.parent.removeChild(n)}e.prototype.dispose.call(this)}},t.prototype.onDestory=function(){this.isplaying=!1;for(var e=this.skillEffects.length-1;e>=0;e--){var t=this.skillEffects[e];t&&(egret.Tween.removeTweens(t),t.onDestroy(),this.skillEffects.splice(e,1),t=null)}this.skillEffects=[]},t}(SkillEffectBase);__reflect(BossSkillStyle1Effect.prototype,"BossSkillStyle1Effect");var BossSkillStyle2Effect=function(e){function t(t){var n=e.call(this,t)||this;return n.ANGLEs=[30,90,150,210,270,330],n.effects=[],n}return __extends(t,e),t.prototype.play=function(){return this.isdestory?void this.end():(e.prototype.play.call(this),void this.onplayEffect("Boss_skill_3",0,500))},t.prototype.onplayEffect=function(e,t,n){if(this.isplaying){for(var a=this.param.releaseBody,i=0;i<this.ANGLEs.length;i++){this.effects[i]||(this.effects[i]=new SkillEffectBody(e,null,1));var o=this.effects[i];o.x=a.x,o.y=a.y,o.scaleX=o.scaleY=1.2,a.addEffectToSprite(o,a.parent);var r=this.ANGLEs[i],s=Tool.beelinePointByAngle(o.x,o.y,r,160);egret.Tween.get(o).wait(t).to({x:s.x,y:s.y-50},n)}Tool.callbackTime(this.end,this,500)}},t.prototype.onDestory=function(){if(this.effects){for(var t=this.effects.length-1;t>=0;t--){var n=this.effects[t];egret.Tween.removeTweens(n),n.onDestroy(),n=null}this.effects=null}e.prototype.onDestory.call(this)},t}(SkillEffectBase);__reflect(BossSkillStyle2Effect.prototype,"BossSkillStyle2Effect");var CommonSkillEffect=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this._effectBody&&this._effectBody.onDestroy(),this._effectBody=null;var t=this.param.releaseBody;this._effectBody=new EffectBody(this.param.param1,null,1),this._effectBody.x=t.x,this._effectBody.y=t.y+t.mountOffY;var n=t.direction,a=!1;(n==Direction.LEFTUP||n==Direction.LEFT||n==Direction.LEFTDOWN)&&(a=!0),a?this._effectBody.scaleX=-1:this._effectBody.scaleX=1,Tool.callbackTime(this.end,this,600),t.addEffectToSprite(this._effectBody,t.parent)},t.prototype.dispose=function(){this.isplaying&&e.prototype.dispose.call(this)},t.prototype.onDestory=function(){e.prototype.onDestory.call(this),this._effectBody&&this._effectBody.onDestroy(),this._effectBody=null},t}(SkillEffectBase);__reflect(CommonSkillEffect.prototype,"CommonSkillEffect");var FabaoSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.LIGHTNING_HIGH=400,n.attackCount=2,n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.onRemoveAnim(),this.shandianSprites=[];var t=this.param.releaseBody;if(!t.magicbody)return void this.end();t.magicbody.onAttack();for(var n,a=this.param.hurtBody,i=this.param.skillInfo,o=[],r=t.magicbody.x,s=t.magicbody.y+t.mountOffY-t.data.model.high-10,h=0;h<t.data.targets.length;h++){n=t.data.targets[h];var l=0;if(l=a.distanceToSelf(n),i.model.rectType>=l){o.push(n);var g=new Animation("fabao_shandian",0,!1),c=new egret.DisplayObjectContainer;c.addChild(g),this.oncraeteLightning(t.magicbody,n,c,r,s),this.shandianSprites.push(c)}}for(var h=0;h<o.length-1;h++)r=o[h].x,s=o[h].y+o[h].mountOffY-o[h].data.model.high/2,Tool.callbackTime(this.onplayHurtEffect,this,300+Math.min(100*h,1e3),o[h],o[h+1],this.shandianSprites[h],r,s);Tool.callbackTime(this.end,this,1500)},t.prototype.oncraeteLightning=function(e,t,n,a,i){if(this.isplaying){var o=n.getChildAt(0),r=Math.ceil(t.distanceToSelf(e)),s=t.x,h=t.y-t.data.model.high/2+t.mountOffY,l=-Math.atan2(h-i,s-a)*(180/Math.PI);l=0>l?360+l:l;Tool.getPosByRadiiAndAngle(a,i,l,r);n.x=a,n.y=i,n.scaleY=Tool.toInt(r/this.LIGHTNING_HIGH*100)/100,n.rotation=Math.round(-l-90),this.param.releaseBody.addEffectToSprite(n,this.param.releaseBody.parent),o.playNum=1}},t.prototype.onplayHurtEffect=function(e,t,n,a,i){if(this.isplaying){this.oncraeteLightning(e,t,n,a,i);var o=new Animation("shandian_beiji",2,!0);t.addEffectToSelf("TOP",o),o.y=-t.data.model.high/2}},t.prototype.dispose=function(){var t=this.param.releaseBody;t.onHideWing(!1),this.onRemoveAnim(),e.prototype.dispose.call(this)},t.prototype.onRemoveAnim=function(){if(this.shandianSprites){for(var e=0;e<this.shandianSprites.length;e++){var t=this.shandianSprites[e],n=t.getChildAt(0);n.onDestroy(),n=null,t.parent&&t.parent.removeChild(t),t=null}this.shandianSprites=null}},t}(SkillEffectBase);__reflect(FabaoSkillEffect.prototype,"FabaoSkillEffect");var FeijianSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.Copy_Pos_Ary=[["60,0","-60,0","60,0","-60,0"],["0,60","60,0","0,60","60,0"],["60,-60","60,60","60,-60","60,60"],["60,0","0,-60","60,0","0,-60"],["-60,-60","60,-60","-60,-60","60,-60"],["0,-60","-60,0","0,-60","-60,0"],["-60,60","-60,-60","-60,60","-60,-60"],["-60,0","0,60","-60,0","0,60"]],n.attackCount=5,n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.feijianAnims&&this.onRemoveFeijianAnim(),this.skillEffects&&this.onRemoveSkillEft(),this.skillEffects=[],this.feijianAnims=[];var t=this.param.releaseBody,n=t.x,a=t.y,i=t.direction,o=1;(i==Direction.LEFTUP||i==Direction.LEFT||i==Direction.LEFTDOWN)&&(o=-1);for(var r=LoadManager.getInstance().getFeijianUrl(t.data.feijian_Res,"stand",this.param.param1),s=this.Copy_Pos_Ary[i-1],h=0;h<=s.length;h++){var l=h==s.length?["0","0"]:s[h].split(","),g=new BodyAnimation(r,-1,this.param.param1);g.scaleX=o,g.x=n,g.y=a,g.alpha=0,t.addEffectToSprite(g,t.parent,"BOTTOM");var c=n+parseInt(l[0]),p=a+parseInt(l[1])-t.data.model.high/2,u=Tool.getPosByRadiiAndAngle(c,p,Tool.getAngleByDir(i)-90,Math.max(size.width/2,size.height/2));egret.Tween.get(g).to({x:c,y:p,alpha:1},400),Tool.callbackTime(this.onCreateFeijianEffect,this,400+200*h,g,u),h>=Tool.toInt(s.length/2)&&Tool.callbackTime(this.onCreateEffect,this,400+200*h,c,p)}t.onHideRide(!0),this.startGhostTimer(),Tool.callbackTime(this.end,this,1500)},t.prototype.onCreateFeijianEffect=function(e,t){this.isplaying&&(egret.Tween.get(e).to({x:t.x,y:t.y},300).to({alpha:0},10),this.feijianAnims.push(e))},t.prototype.onCreateEffect=function(e,t){if(this.isplaying){var n=this.param.releaseBody,a=n.direction,i=new SkillEffectBody("wushuangyehuo",null,1);i.isUnder=!0,i.x=e,i.y=t,a==Direction.LEFTUP||a==Direction.LEFT||a==Direction.LEFTDOWN?i.scaleX=-2:i.scaleX=2,i.scaleY=2,i.rotation=-Tool.getAngleByDir(a),n.addEffectToSprite(i,n.parent),this.skillEffects.push(i)}},t.prototype.startGhostTimer=function(){this.isplaying&&Tool.addTimer(this.onGhostHandler,this,50)},t.prototype.endGhostTimer=function(){if(Tool.removeTimer(this.onGhostHandler,this,50),this.ghostAnimAry){for(var e=0;e<this.ghostAnimAry.length;e++){var t=this.ghostAnimAry[e];egret.Tween.removeTweens(t),t.onDestroy(),t=null}this.ghostAnimAry=null}},t.prototype.onGhostHandler=function(){if(!this.isplaying)return void this.endGhostTimer();if(!this.ghostAnimAry)return void(this.ghostAnimAry=[]);for(var e=this.param.releaseBody,t=0;t<this.feijianAnims.length;t++){var n=this.feijianAnims[t];if(0!=n.alpha){var a=new EffectBody(e.data.feijian_Res+"_stand_ying_"+this.param.param1,this.param.param1,-1);a.scaleX=n.scaleX,a.x=n.x,a.y=n.y,a.alpha=.8,a.isUnder=!0,e.addEffectToSprite(a,e.parent,"BOTTOM"),TweenLiteUtil.onHideTween(a,null,null,400),this.ghostAnimAry.push(a)}}},t.prototype.onRemoveFeijianAnim=function(){this.endGhostTimer();var e=this.param.releaseBody;if(e.showRideEffect(),this.feijianAnims){for(var t=this.feijianAnims.length-1;t>=0;t--){var n=this.feijianAnims[t];n&&(egret.Tween.removeTweens(n),n.onDestroy(),n=null)}this.feijianAnims=null}},t.prototype.onRemoveSkillEft=function(){if(this.skillEffects){for(var e=this.skillEffects.length-1;e>=0;e--){var t=this.skillEffects[e];t&&(egret.Tween.removeTweens(t),t.onDestroy(),t=null)}this.skillEffects=null}},t.prototype.dispose=function(){this.onRemoveFeijianAnim(),this.onRemoveSkillEft(),e.prototype.dispose.call(this)},t}(SkillEffectBase);__reflect(FeijianSkillEffect.prototype,"FeijianSkillEffect");var SkillEffParam=function(){function e(e,t,n){void 0===n&&(n=null),this.onUpdate(e,t,n)}return e.prototype.onUpdate=function(e,t,n){void 0===n&&(n=null),this.skillInfo=e,this.releaseBody=t,this.hurtBody=n},e}();__reflect(SkillEffParam.prototype,"SkillEffParam");var SkillParam=function(){function e(){this.x=0,this.y=0,this.isBottom=!1,this.playNum=1,this.scale=1,this.layer="TOP"}return e}();__reflect(SkillParam.prototype,"SkillParam");var JianQiSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.LEVEL_Y=[0,100],n.LEVEL_X=[0,-10,10,20,-20],n.ROTATIONs=[0,-10,10,-15,15],n.DELAYs=[0,100,150,200,250],n.counts=[3,4,5,5,5],n.skillEffects=[],n.effectLayer=new egret.DisplayObjectContainer,n.attackCount=n.counts[n.param.skillInfo.grade-1],n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this);var t=this.param.releaseBody,n=this.param.hurtBody;if(this.effectLayer.removeChildren(),this.effectLayer.x=t.x,this.effectLayer.y=t.y-t.data.model.high/2+t.mountOffY,this.effectLayer.rotation=Math.atan2(n.y-t.y,n.x-t.x)*(180/Math.PI)-90,t.inMap?t.addEffectToSprite(this.effectLayer,t):t.parent&&t.parent.addChild(this.effectLayer),!Tool.isNumber(this.skinNum)||this.skinNum!=this.param.skillInfo.styleNum){this.skinNum=this.param.skillInfo.styleNum;for(var a=this.skillEffects.length-1;a>=0;a--){var i=this.skillEffects[a];i.onDestroy(),i=null,this.skillEffects.splice(a,1)}}for(var o=this.skinNum>0?this.skinNum-(this.param.skillInfo.id-1)*SkillDefine.SKIN_NUM+1:1,r=0,a=0;a<this.LEVEL_Y.length;a++)for(var s=0;s<this.attackCount;s++){var h=void 0;this.skillEffects[r]||(this.skillEffects[r]=new Animation("skill_fly"+o+"_2",0)),h=this.skillEffects[r],h.x=this.LEVEL_X[s],h.y=this.LEVEL_Y[a],h.rotation=this.ROTATIONs[s],r++,Tool.callbackTime(this.createEffect,this,this.DELAYs[s]+200*a,h,r==this.attackCount*this.LEVEL_Y.length)}},t.prototype.createEffect=function(e,t){this.isplaying&&(this.effectLayer.addChild(e),e.playNum=1,t&&e.playFinishCallBack(this.end,this))
},t.prototype.dispose=function(){if(this.isplaying){for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];n.onStop()}this.effectLayer.parent&&this.effectLayer.parent.removeChild(this.effectLayer),this.effectLayer.removeChildren(),e.prototype.dispose.call(this)}},t.prototype.onDestory=function(){e.prototype.onDestory.call(this);for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];n.onDestroy()}this.skillEffects=null,this.effectLayer.parent&&this.effectLayer.parent.removeChild(this.effectLayer),this.effectLayer=null},t}(SkillEffectBase);__reflect(JianQiSkillEffect.prototype,"JianQiSkillEffect");var QingLongSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.ANGLEs=[0,90,180,270],n.attackCount=3,n}return __extends(t,e),t.prototype.play=function(){if(!this.isplaying){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.effects=[],Tool.isNumber(this.skinNum)&&this.skinNum==this.param.skillInfo.styleNum||(this.skinNum=this.param.skillInfo.styleNum);var t=(this.param.releaseBody,this.skinNum>0?this.skinNum-(this.param.skillInfo.id-1)*SkillDefine.SKIN_NUM:0);switch(t){case 1:this.onplayEffect("skill_longjuanfeng",0,700);break;case 2:this.onplayEffect("skill_faqiu",0,700);break;case 3:this.onplayEffect("skill_dian",300,400);break;default:this.onplayEffect("skill_leibao",300,400)}}},t.prototype.onplayEffect=function(e,t,n){if(this.isplaying){for(var a=this.param.releaseBody,i=["0,120","120,0","0,-120","-120,0"],o=0;o<i.length;o++){var r=new Animation(e,2,!0),s=i[o].split(",");r.x=a.x+parseInt(s[0]),r.y=a.y+parseInt(s[1]),r.scaleX=1.5,r.scaleY=1.5,a.addEffectToSprite(r,a.parent),this.effects.push(r);var h=this.ANGLEs[o],l=Tool.beelinePointByAngle(r.x,r.y,h,150);egret.Tween.get(r).wait(t).to({x:l.x,y:l.y},n)}Tool.callbackTime(this.end,this,700)}},t.prototype.dispose=function(){if(this.isplaying){if(this.effects){for(var t=this.effects.length-1;t>=0;t--){var n=this.effects[t];egret.Tween.removeTweens(n),n.onDestroy(),n=null}this.effects=null}e.prototype.dispose.call(this)}},t}(SkillEffectBase);__reflect(QingLongSkillEffect.prototype,"QingLongSkillEffect");var RetinueSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.arrowAnims=[],n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this);var t=this.param.releaseBody,n=BodyFactory.instance.createRetinueArrow();n.playNum=-1;var a=this.param.hurtBody.data.model?this.param.hurtBody.data.model.high/2:0,i=t.x,o=t.y-50,r=this.param.hurtBody.x,s=this.param.hurtBody.y-a,h=-Math.atan2(s-o,r-i)*(180/Math.PI);h=0>h?360+h:h,n.x=i,n.y=o,n.rotation=Math.round(-h-90),t.addEffectToSprite(n,t.parent),this.arrowAnims.push(n);var l=Math.max(200,Math.ceil(this.param.releaseBody.distanceToSelf(this.param.hurtBody)));egret.Tween.get(n).to({x:r,y:s},l).call(this.onRemoveArrowAnim,this,[n]),Tool.callbackTime(this.end,this,l+10)},t.prototype.onRemoveArrowAnim=function(e){var t=this.arrowAnims.indexOf(e);t>=0&&(BodyFactory.instance.onRecoverRetinueArrow(e),this.arrowAnims.splice(t,1))},t.prototype.dispose=function(){this.isplaying&&e.prototype.dispose.call(this)},t.prototype.onDestory=function(){e.prototype.onDestory.call(this);for(var t=this.arrowAnims.length-1;t>=0;t--)this.onRemoveArrowAnim(this.arrowAnims[t]);this.arrowAnims=[]},t}(SkillEffectBase);__reflect(RetinueSkillEffect.prototype,"RetinueSkillEffect");var ShenbingSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.DISTANCE_ARY=[100,200,300],n.attackCount=3,n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.onRemoveAnim(),this.weaponEffects=[];var t=this.param.releaseBody,n=t.direction,a=LoadManager.getInstance().getWeaponResUrl(t.data.weapon_res,"attack4",this.param.param1);this.weaponbodyAnim=new BodyAnimation(a,1,this.param.param1),this.weaponbodyAnim.autoRemove=!0,n==Direction.LEFTUP||n==Direction.LEFT||n==Direction.LEFTDOWN?this.weaponbodyAnim.scaleX=-2:this.weaponbodyAnim.scaleX=2,this.weaponbodyAnim.scaleY=2,this.weaponbodyAnim.x=t.x,this.weaponbodyAnim.y=t.y,t.addEffectToSprite(this.weaponbodyAnim,t.parent);for(var i=0;i<this.DISTANCE_ARY.length;i++)Tool.callbackTime(this.onCreateEffect,this,200*i,this.DISTANCE_ARY[i]);this.startGhostTimer(),Tool.callbackTime(this.end,this,1500)},t.prototype.onCreateEffect=function(e){if(this.isplaying){var t=this.param.releaseBody,n=(t.direction,new EffectBody("shenbing_01",null,1)),a=Tool.beelinePoint(t.x,t.y,t.direction,e);n.x=a.x,n.y=a.y,t.addEffectToSprite(n,t.parent,"BOTTOM"),this.weaponEffects.push(n)}},t.prototype.startGhostTimer=function(){this.isplaying&&Tool.addTimer(this.onGhostHandler,this,50)},t.prototype.endGhostTimer=function(){if(Tool.removeTimer(this.onGhostHandler,this,50),this.ghostBmpAry){for(var e=0;e<this.ghostBmpAry.length;e++){var t=this.ghostBmpAry[e];egret.Tween.removeTweens(t),t.parent&&t.parent.removeChild(t),t=null}this.ghostBmpAry=null}},t.prototype.onGhostHandler=function(){if(!this.isplaying)return void this.endGhostTimer();if(!this.ghostBmpAry)return void(this.ghostBmpAry=[]);var e=this.param.releaseBody,t=this.param.releaseBody.direction,n=2;(t==Direction.LEFTUP||t==Direction.LEFT||t==Direction.LEFTDOWN)&&(n=-2);var a=this.weaponbodyAnim.currFrameTexture;if(a){var i=new egret.Bitmap(a);i.scaleX=n,i.scaleY=2,i.x=this.weaponbodyAnim.x+this.weaponbodyAnim.currFrameData.x*n,i.y=this.weaponbodyAnim.y+2*this.weaponbodyAnim.currFrameData.y,i.alpha=.8,e.addEffectToSprite(i,e.parent),egret.Tween.get(i).wait(200).to({alpha:0},10),this.ghostBmpAry.push(i)}},t.prototype.dispose=function(){this.param.releaseBody;this.onRemoveAnim(),e.prototype.dispose.call(this)},t.prototype.onRemoveAnim=function(){if(this.endGhostTimer(),this.weaponbodyAnim&&(this.weaponbodyAnim.onDestroy(),this.weaponbodyAnim=null),this.weaponEffects)for(var e=0;e<this.weaponEffects.length;e++){var t=this.weaponEffects[e];t&&(t.onDestroy(),t=null)}this.weaponEffects=null},t}(SkillEffectBase);__reflect(ShenbingSkillEffect.prototype,"ShenbingSkillEffect");var WXDanChongManager=function(){function e(){this.day=1,this.record=[]}return e.prototype.onParseMessage=function(e){var t=e.getByte();this.record=[];for(var n=0;t>n;n++)this.record.push(e.getByte());this.day=e.getByte()},e}();__reflect(WXDanChongManager.prototype,"WXDanChongManager");var SkillEffectManager=function(){function e(){this.playSkillEffDict={}}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.createSkillEffect=function(e,t,n){void 0===n&&(n=null);var a=t.getSkillEffectByID(e.id);if(a)a.param.onUpdate(e,t,n);else{var i=new SkillEffParam(e,t,n),o=egret.getDefinitionByName(e.effectClass);o&&(a=new o(i),t.addSkillEffectByID(e.id,a))}return a&&(this.playSkillEffDict[a.id]=a),a},e.prototype.onPlayFinishHanlde=function(e){var t=this.playSkillEffDict[e];delete this.playSkillEffDict[e],t&&t.dispose()},e.prototype.onDestroyAllSkillEffect=function(){for(var e in this.playSkillEffDict){var t=this.playSkillEffDict[e];t.dispose()}this.playSkillEffDict={}},e.instance=null,e}();__reflect(SkillEffectManager.prototype,"SkillEffectManager");var XianyuSkillEffect=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.onRemoveAnim();var t=this.param.releaseBody,n=t.direction,a=LoadManager.getInstance().getWingResUrl(t.data.wing_res,"ride_stand","1");this.wingbodyAnim=new BodyAnimation(a,-1,this.param.param1),n==Direction.LEFTUP||n==Direction.LEFT||n==Direction.LEFTDOWN?this.wingbodyAnim.scaleX=-2:this.wingbodyAnim.scaleX=2,this.wingbodyAnim.scaleY=2,this.wingbodyAnim.alpha=0,t.addEffectToSelf("TOP",this.wingbodyAnim),t.onHideWing(!0),egret.Tween.get(this.wingbodyAnim).wait(400).to({alpha:.8},50).to({alpha:.2},500),Tool.callbackTime(this.oncreateEffect,this,400),Tool.callbackTime(this.end,this,1e3)},t.prototype.oncreateEffect=function(){this.isplaying&&(this.wingEffectAnim=new Animation("shifa_2_2",1),this.wingEffectAnim.x=this.param.releaseBody.x,this.wingEffectAnim.y=this.param.releaseBody.y,this.param.releaseBody.addEffectToSprite(this.wingEffectAnim,this.param.releaseBody.parent))},t.prototype.dispose=function(){var t=this.param.releaseBody;t.onHideWing(!1),this.onRemoveAnim(),e.prototype.dispose.call(this)},t.prototype.onRemoveAnim=function(){this.wingbodyAnim&&(egret.Tween.removeTweens(this.wingbodyAnim),this.wingbodyAnim.onDestroy(),this.wingbodyAnim=null),this.wingEffectAnim&&(this.wingEffectAnim.onDestroy(),this.wingEffectAnim=null)},t}(SkillEffectBase);__reflect(XianyuSkillEffect.prototype,"XianyuSkillEffect");var XuanWuSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.LEVELS=[1,2,3,3,3],n.posAry=[[60,60],[60,-60],[-60,60],[-60,-60]],n.Style_Levels=[2,3,4],n.Style_Angles=[60,40,30],n.attackCount=2,n.attackCount=n.LEVELS[n.param.skillInfo.grade-1],n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this.skillEffects=[];this.param.releaseBody;Tool.isNumber(this.skinNum)&&this.skinNum==this.param.skillInfo.styleNum||(this.skinNum=this.param.skillInfo.styleNum),this._count=0;var t=this.skinNum>0?this.skinNum-(this.param.skillInfo.id-1)*SkillDefine.SKIN_NUM:0;switch(t){case 1:this.onCreateEffect("skill_ta");break;case 2:this.onCreateEffect("skill_quantou");break;case 3:this.onCreateEffect("skill_bing2");break;default:this.onCreateEffect("skill_diyuhuo")}},t.prototype.onCreateEffect=function(e){if(this.isplaying){if(this.Style_Levels.length<=this._count)return void Tool.callbackTime(this.end,this,700);for(var t=this.param.releaseBody,n=this.Style_Levels[this._count],a=this.Style_Angles[this._count],i=150*(this._count+1),o=0;n>o;o++){for(var r=o,s=0;s<this._count;s++)r+=this.Style_Levels[s];this.skillEffects[r]=new SkillEffectBody(e,null,1);var h=parseInt(String(t.direction))-1,l=45*h;0==o&&n%2!=0||(o%2!=0?l+=n%2!=0?Math.ceil(o/2)*a:Math.ceil(o/2)*a-a/2:l-=n%2!=0?Math.ceil(o/2)*a:Math.ceil(o/2)*a+a/2);var g=Tool.beelinePointByAngle(this.param.releaseBody.x,this.param.releaseBody.y,l,i);this.skillEffects[r].x=g.x,this.skillEffects[r].y=g.y,t.addEffectToSprite(this.skillEffects[r],t.parent)}this._count++,Tool.callbackTime(this.onCreateEffect,this,100,e)}},t.prototype.dispose=function(){if(this.isplaying){if(this.skillEffects){for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];egret.Tween.removeTweens(n),n.onDestroy(),n=null}this.skillEffects=null}e.prototype.dispose.call(this)}},t}(SkillEffectBase);__reflect(XuanWuSkillEffect.prototype,"XuanWuSkillEffect");var ZhuQueSkillEffect=function(e){function t(t){var n=e.call(this,t)||this;return n.Style_PosAry=[["0,-120","150,-50","150,50","0,120","-150,50","-150,-50"],["0,-250","280,-120","280,120","0,250","-280,-120","-280,120"]],n.attackCount=3,n}return __extends(t,e),t.prototype.play=function(){if(this.isdestory)return void this.end();e.prototype.play.call(this),this._count=0,this.skillEffects=[];this.param.releaseBody;Tool.isNumber(this.skinNum)&&this.skinNum==this.param.skillInfo.styleNum||(this.skinNum=this.param.skillInfo.styleNum);var t=this.skinNum>0?this.skinNum-(this.param.skillInfo.id-1)*SkillDefine.SKIN_NUM:0;switch(t){case 1:this.onplayEffect("skill_dici");break;case 2:this.onplayEffect("skill_lianhua");break;case 3:this.onplayEffect("skill_huozhu");break;default:this.onplayEffect("skill_fly3_1")}},t.prototype.onplayEffect=function(e){if(this.isplaying&&this.isplaying){if(this.Style_PosAry.length<=this._count)return void Tool.callbackTime(this.end,this,500);for(var t=this.param.releaseBody,n=this.Style_PosAry[this._count],a=n.length,i=0;a>i;i++){var o=this._count*a+i;this.skillEffects[o]=new SkillEffectBody(e,null,1);var r=n[i].split(",");this.skillEffects[o].x=t.x+parseInt(r[0]),this.skillEffects[o].y=t.y+parseInt(r[1]),t.addEffectToSprite(this.skillEffects[o],t.parent)}this._count++,Tool.callbackTime(this.onplayEffect,this,100,e)}},t.prototype.dispose=function(){if(this.isplaying){if(this.skillEffects)for(var t=this.skillEffects.length-1;t>=0;t--){var n=this.skillEffects[t];n&&(egret.Tween.removeTweens(n),n.onDestroy(),this.skillEffects.splice(t,1),n=null)}this.skillEffects=null,e.prototype.dispose.call(this)}},t}(SkillEffectBase);__reflect(ZhuQueSkillEffect.prototype,"ZhuQueSkillEffect");var BaseTabButton=function(e){function t(t,n){var a=e.call(this)||this;return a.resName=t,a.labName=n,a.skinName=skins.Common_TabButtonSkin,a}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.onLoadComplete()},t.prototype.onLoadComplete=function(){this.tab_name.text=this.labName},t.prototype.invalidateState=function(){e.prototype.invalidateState.call(this)},t}(eui.RadioButton);__reflect(BaseTabButton.prototype,"BaseTabButton");var BaseTabButton2=function(e){function t(t,n){var a=e.call(this)||this;return a.resName=t,a.labName=n,a.skinName=skins.Common_TabButtonSkin2,a}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.onLoadComplete()},t.prototype.onLoadComplete=function(){this.tab_name.text=this.labName},t.prototype.invalidateState=function(){e.prototype.invalidateState.call(this)},t}(eui.RadioButton);__reflect(BaseTabButton2.prototype,"BaseTabButton2");var ActivityButton=function(e){function t(t){var n=e.call(this)||this;return n.resName=t,n.skinName=skins.Common_TabButtonSkin4,n}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.onLoadComplete()},t.prototype.onLoadComplete=function(){this.tab_icon.source=this.resName},t.prototype.invalidateState=function(){e.prototype.invalidateState.call(this)},t}(eui.Button);__reflect(ActivityButton.prototype,"ActivityButton");var SoundDefine=function(){function e(){}return e.SOUND_RES="resource/sound/",e.SOUND_BGM="game_bgm.mp3",e.SOUND_BUTTON_TOUCH="point_effect.mp3",e}();__reflect(SoundDefine.prototype,"SoundDefine");var SoundFactory=function(){function e(){}return e.playSound=function(e,t,n,a){if(void 0===a&&(a=null),!GameSetting.getLocalSetting(GameSetting.SOUND_MUTE)){var i=this.getSoundByRes(e);return i.loaded?i.play(t,1,a):i.load(function(e){try{e.play(t,1,a)}catch(n){}}),i}},e.playMusic=function(t,n){var a=this.getSoundByRes(t);return a.loaded?e.soundOpen?a.play(n,-1):a.stop():a.load(function(t){e.soundOpen&&t.play(n,-1),t.volume=.4}),a},e.stopMusic=function(e){var t=this.getSoundByRes(e);t&&t.stop()},e.getSoundByRes=function(e){return this.sounds[e]?this.sounds[e]:this.onBuidOneSound(e)},e.onBuidOneSound=function(e){var t=new SoundBase(e);return this.sounds[e]=t,t},Object.defineProperty(e,"soundOpen",{get:function(){return!GameSetting.getLocalSetting(GameSetting.SOUND_MUTE)},enumerable:!0,configurable:!0}),e.sounds={},e.soundChannels={},e}();__reflect(SoundFactory.prototype,"SoundFactory");var SoundBase=function(){function e(e){this._volume=1,this.loaded=!1,this._res=e}return e.prototype.load=function(e){var t=this._sound=new egret.Sound;t.addEventListener(egret.Event.COMPLETE,function(t){this.loaded=!0,e.bind(this)(this)},this),t.load(ChannelDefine.cdnUrl+(""+SoundDefine.SOUND_RES+this._res))},e.prototype.play=function(e,t,n){return void 0===n&&(n=null),this._channel||(this._channel=this._sound.play(e,t),this.volume=this._volume,this._channel.addEventListener(egret.Event.SOUND_COMPLETE,function(e){n&&n.bind(this)(this._channel)},this)),this._channel},e.prototype.stop=function(){this._channel&&(this._channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onComplete,this),this._channel.stop(),this._channel=null)},e.prototype.onComplete=function(e){this.stop()},Object.defineProperty(e.prototype,"volume",{set:function(e){this._volume=e,this._channel&&(this._channel.volume=this._volume)},enumerable:!0,configurable:!0}),e}();__reflect(SoundBase.prototype,"SoundBase");var GameLogin=function(e){function t(t){var n=e.call(this)||this;return n.gameWorld=t,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.once(egret.Event.REMOVED_FROM_STAGE,n.onRemoveToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(e){if(this.gameWorld.addEventListener(MESSAGE_ID.GAME_LOGON_MESSAGE.toString(),this.receiveMessage,this),this.gameWorld.addEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveServerMessage,this),this.gameWorld.addEventListener(GameEvent.NET_EVENT_ERROR,this.onNetError,this),DataManager.IS_PC_Game||(this.width=size.width),this.height=size.height,SDKManager.sdkLogin){var t=SDKManager.loginInfo.account;if(t){var n=new eui.Image;n.source="login_bg_jpg",DataManager.IS_PC_Game||(n.width=size.width),n.height=size.height+100,this.addChild(n),this.sendLogin()}else this.once(eui.UIEvent.COMPLETE,this.onComplete,this),this.skinName=skins.GameLoginViewSkin}else if(platform.isLocalTest()||!SDKManager.isSDKLogin)this.once(eui.UIEvent.COMPLETE,this.onComplete,this),this.skinName=skins.GameLoginViewSkin;else{var n=new eui.Image;n.source="login_bg_jpg",DataManager.IS_PC_Game||(n.width=size.width),this.addChild(n)}},t.prototype.onComplete=function(){this.txInput.text=GameSetting.getLocalSetting(GameSetting.LOGIN_ACCOUNTS),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},t.prototype.btnClick=function(e){var t=SDKManager.loginInfo;t.account=this.txInput.text,this.sendLogin(),GameSetting.setLocalSave(GameSetting.LOGIN_ACCOUNTS,this.txInput.text)},t.prototype.sendLogin=function(){this.gameWorld.sendLogin()},t.prototype.onRemoveToStage=function(e){this.gameWorld.removeEventListener(MESSAGE_ID.GAME_LOGON_MESSAGE.toString(),this.receiveMessage,this),this.gameWorld.removeEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveServerMessage,this),this.gameWorld.removeEventListener(GameEvent.NET_EVENT_ERROR,this.onNetError,this),this.startBtn&&this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},t.prototype.onNetError=function(e){},t.prototype.receiveMessage=function(e){var t=e.message;DataManager.getInstance().serverManager.parseServerList(t),this.gameWorld.loginServer(),Tool.log("登录成功")},t.prototype.receiveServerMessage=function(e){var t=e.message,n=t.getString(),a=t.getShort(),i=t.getShort();this.gameWorld.setUrl(n,a);var o=SDKManager.loginInfo;o.serverId=i,this.gameWorld.sendLoginServerMsg()},t}(eui.Component);__reflect(GameLogin.prototype,"GameLogin");var CreateRole=function(e){function t(t){var n=e.call(this)||this;return n.gameWorld=t,n.once(eui.UIEvent.COMPLETE,n.onComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.once(egret.Event.REMOVED_FROM_STAGE,n.onRemoveToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(e){DataManager.IS_PC_Game||(this.width=size.width),this.height=size.height,this.skinName=skins.CreateRoleSkin},t.prototype.onComplete=function(){this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.randomBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.randomClick,this),this.addEventListener(egret.Event.ENTER_FRAME,this.onTimeDown,this),Tool.addTimer(this.onTimeDown,this,100);var e=2;this.s_btns=[],this.sex_selecteds=[],this.groups=[];for(var t=0;e>t;t++)this.sex_selecteds[t]=this["sex_selected_"+t],this.groups[t]=this["group"+t],this.s_btns[t]=this["s_btn"+t],this.s_btns[t].name=""+t,this.s_btns[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHeroBtn,this);for(var n=15,a=[];n>a.length;){var i=Math.round(1*Math.random()),o=NameDefine.getRandomPlayerName(!1,i);if(!(a.indexOf(o)>=0||this.nameLabel.text==o)){a.push(o);var r=this.createEnterPlayerLab(o);r.y=20*a.length,this.enter_name_grp.addChild(r)}}this.onChangeHeroHandler(Tool.randomInt(0,100)%2);var s=SDKManager.loginInfo.nickName;s?this.nameLabel.text=s:this.randomName()},t.prototype.onTouchHeroBtn=function(e){var t=parseInt(e.currentTarget.name);this.selectHeroIndex!=t&&(this.onChangeHeroHandler(t),this.randomName())},t.prototype.onChangeHeroHandler=function(e){this.selectHeroIndex=e,this.imgBG.source="login_create_bg_"+e+"_jpg";for(var t=0;2>t;t++)this.groups[t].visible=t==e,this.sex_selecteds[t].source="create_sex_bg"+t+(t==e?"":"_dis")+"_png"},t.prototype.randomClick=function(e){this.randomName()},t.prototype.onTimeDown=function(){for(var e=0;e<this.enter_name_grp.numChildren;e++){var t=this.enter_name_grp.getChildAt(e);if(t.y>-100&&(t.y--,t.y<-70&&(t.alpha=Math.max(0,t.alpha-.05))),e==this.enter_name_grp.numChildren-1&&t.y<=-100)for(var n=0;n<this.enter_name_grp.numChildren;n++){var a=this.enter_name_grp.getChildAt(n);a.y=20*n,a.alpha=1}}},t.prototype.createEnterPlayerLab=function(e){var t=GameCommon.getInstance().createNormalLabel(18,6709084,0,0,egret.HorizontalAlign.CENTER);t.width=250;var n=new Array({text:"玩家  "},{text:e,style:{textColor:5746431}},{text:"  进入游戏"});return t.textFlow=n,t},t.prototype.btnClick=function(e){var t=SDKManager.loginInfo;t.iscreate=this.selectHeroIndex,this.gameWorld.sendCreateRoleMsg(this.nameLabel.text,this.selectHeroIndex),DataManager.getInstance().playerManager.player.name=this.nameLabel.text},t.prototype.randomName=function(){this.nameLabel.text=NameDefine.getRandomPlayerName(!1,this.selectHeroIndex)},t.prototype.onRemoveToStage=function(e){this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.randomBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.randomClick,this),this.s_btns[0].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHeroBtn,this),this.s_btns[1].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHeroBtn,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onTimeDown,this),this.enter_name_grp.removeChildren()},t}(eui.Component);__reflect(CreateRole.prototype,"CreateRole");var SelectServer=function(e){function t(t){var n=e.call(this)||this;return n.animPos=new egret.Point(0,0),n.gameWorld=t,n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.skinName=skins.ServerSelectSkin,n}return __extends(t,e),t.prototype.onAddToStage=function(e){DataManager.IS_PC_Game||(this.width=size.width),this.height=size.height},t.prototype.appinfoDesc=function(){var e=SDKManager.loginInfo.channel,t="",n="抵制不良游戏 拒绝盗版游戏 注意自我保护 谨防上当受骗\n适度游戏益脑 沉迷游戏伤身 合理安排时间 享受健康生活",a="";switch(e){case EChannel.CHANNEL_WANBA:t="本应用由 “联众游戏” 提供";break;default:t="本应用由 “北京呈天网络科技股份有限公司” 提供"}return a="文网游备字[2018]M-RPG1133号\n版号：ISBN 978-7-89989-734-8 审批文号：新出审字[2013]936号\n著作权人：北京呈天网络科技股份有限公司，北京灵动力启点网络科技有限公司\n出版单位：北京呈天网络科技股份有限公司\n该游戏适合16岁以上用户",t+"\n"+n+"\n"+a},t.prototype.onComplete=function(){this.company_lab.text=this.appinfoDesc(),this.versionLabel.text=DataManager.version;GameCommon.getInstance().addAnimation("kaishianniu",this.animPos,this.startBtn.animLayer,-1);this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.group1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectClick,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClick,this),this.loginedBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginedList,this),this.btn_notice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnNotice,this),this.notice_close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseNotice,this);var e=parseInt((DataManager.getInstance().serverManager.serverArray.length/100+1).toString());DataManager.getInstance().serverManager.serverArray.length%100==0&&(e=parseInt((DataManager.getInstance().serverManager.serverArray.length/100).toString()));for(var t=0;e>t;++t){var n=new eui.Button;n.skinName=skins.ServerBtnSkin;var a=100*t+1+"-"+100*(t+1)+"服";n.label=a,n.name=t.toString(),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onServerList,this),this.serverGroup.addChild(n)}var i;DataManager.getInstance().serverManager.serverLoginedArray.length>0?(this.server=DataManager.getInstance().serverManager.serverLoginedArray[0],i=DataManager.getInstance().serverManager.serverLoginedArray,this.loginedBtn.currentState="down"):(this.server=DataManager.getInstance().serverManager.serverArray[DataManager.getInstance().serverManager.serverArray.length-1],i=this.getServerList(e-1),this.serverGroup.getChildAt(e-1).currentState="down"),this.setServer(this.server),this.closeClick(null),this.itemScroller.viewport=this.serverList,this.serverList.itemRenderer=ServerItemRenderer,this.serverList.addEventListener(ServerItemRenderer.ITME_CLICK,this.onItemClick,this),this.serverList.dataProvider=new eui.ArrayCollection(i)},t.prototype.onTouchBtnNotice=function(e){this.noticeloaded||(this.noticeloaded=!0,this.onLoadingNotice()),this.noticeLayer.visible=!0,this.loginLayer.visible=!1},t.prototype.onCloseNotice=function(){this.noticeLayer.visible=!1,this.loginLayer.visible=!0},t.prototype.onLoadingNotice=function(){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXT,e.addEventListener(egret.Event.COMPLETE,this.onLoadNoticeComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this);var t=SDKManager.loginInfo,n="",a=Math.random();if(t.channel==EChannel.CHANNEL_WXGAMEBOX&&(n=ChannelDefine.cdnUrl+"resource/assets/notice/fangkuaiwan.txt?v="+a),""!=n){this.setGameNotice("<font color='#FFFF00' size='26'>公告正在加载中...</font>");var i=new egret.URLRequest(n);e.load(i)}else this.onLoadError()},t.prototype.onLoadNoticeComplete=function(e){var t=e.target,n=t.data;this.setGameNotice(n)},t.prototype.onLoadError=function(){this.setGameNotice("公告内容暂无！")},t.prototype.setGameNotice=function(e){this.label_content.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(e))},t.prototype.onLoginedList=function(e){this.serverList.dataProvider=new eui.ArrayCollection(DataManager.getInstance().serverManager.serverLoginedArray),this.resetServerBtn(),this.loginedBtn.currentState="down"},t.prototype.onServerList=function(e){var t=e.currentTarget,n=this.getServerList(Number(t.name));this.serverList.dataProvider=new eui.ArrayCollection(n),this.resetServerBtn(),this.loginedBtn.currentState="up",t.currentState="down"},t.prototype.resetServerBtn=function(){for(var e=0;e<this.serverGroup.numChildren;++e)this.serverGroup.getChildAt(e).currentState="up"},t.prototype.getServerList=function(e){for(var t=new Array,n=100*e,a=n;n+100>a;++a)DataManager.getInstance().serverManager.serverArray.length>a&&t.push(DataManager.getInstance().serverManager.serverArray[a]);return t.reverse(),t},t.prototype.onItemClick=function(e){var t=e.data;this.setServer(t),this.closeClick(null)},t.prototype.setServer=function(e){this.server=e,this.serverNameLabel.text=e.name,e.state==SERVER_STATE.NEW?this.stateImg.source="login_xinqu_png":e.state==SERVER_STATE.HOT?this.stateImg.source="login_huobao_png":this.stateImg.source="login_weihu_png"},t.prototype.btnClick=function(e){this.sendLogin(this.server.id)},t.prototype.selectClick=function(e){this.group2.visible=!0},t.prototype.closeClick=function(e){this.group2.visible=!1},t.prototype.sendLogin=function(e){this.startBtn.touchEnabled=!1,this.gameWorld.addEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveMessage,this),this.gameWorld.addEventListener(GameEvent.NET_EVENT_ERROR,this.onNetError,this),this.gameWorld.sendSelectServer(e)},t.prototype.receiveMessage=function(e){this.onRemoveToStage();var t=e.message,n=t.getString(),a=t.getShort(),i=t.getByte(),o=t.getByte();return 1!=o?void this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_6):void(2==i?this.gameWorld.setAlertDisconnect(Language.ALERT_DISCONNECT_5):(this.gameWorld.setUrl(n,a),this.sendLoginGame(),Tool.log("登录游戏成功")))},t.prototype.sendLoginGame=function(){this.gameWorld.sendLoginServerMsg()},t.prototype.onRemoveToStage=function(){this.gameWorld.removeEventListener(GameEvent.NET_EVENT_ERROR,this.onNetError,this),this.gameWorld.removeEventListener(MESSAGE_ID.SELECT_SERVER_MESSAGE.toString(),this.receiveMessage,this)},t.prototype.onNetError=function(e){this.startBtn.touchEnabled=!0},t}(eui.Component);__reflect(SelectServer.prototype,"SelectServer");var ServerItemRenderer=function(e){function t(){var t=e.call(this)||this;t.touchEnabled=!0,t.touchChildren=!0;var n=skins.ServerItemSkin;return t.skinName=n,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t}return __extends(t,e),t.prototype.dataChanged=function(){this.data&&(this.serverNameLabel.text=this.data.name,this.data.state==SERVER_STATE.NEW?this.stateImg.source="login_xinqu_png":this.data.state==SERVER_STATE.HOT?this.stateImg.source="login_huobao_png":this.stateImg.source="login_weihu_png")},t.prototype.onClick=function(e){this.dispatchEvent(new egret.Event(t.ITME_CLICK,!0,!0,this.data))},t.ITME_CLICK="item_click",t}(eui.ItemRenderer);__reflect(ServerItemRenderer.prototype,"ServerItemRenderer");var SineBase=function(){function e(e,t,n,a){void 0===e&&(e=100),void 0===t&&(t=15),void 0===n&&(n=0),void 0===a&&(a=0),this.kfire=0,this.Afire=15,this.wfire=1,this.time=100,this.n=0,this.speed=0,this.xfire=0,this.nfire=0,this.onInitParam(e,t,n,a)}return e.prototype.onInitParam=function(e,t,n,a){void 0===e&&(e=100),void 0===t&&(t=15),void 0===n&&(n=0),void 0===a&&(a=0),this.nfire=n,this.kfire=a,this.Afire=t,this.time=e,this.speed=2*Math.PI/this.time},e.prototype.flotage=function(){return this.yfire=this.Afire*Math.sin(this.wfire*this.xfire+this.nfire)+this.kfire,this.xfire+=this.speed,this.n+=1,this.n>=this.time&&(this.n=0,this.xfire=0),this.yfire},e}();__reflect(SineBase.prototype,"SineBase");var Tool=function(){function e(){}return e.logClassName=function(e){platform.isLocalTest()&&egret.log("className: "+e)},e.log=function(e){},e.randomInt=function(e,t){return e+Math.floor(Math.random()*(t-e))},e.randomFloat=function(e,t){return e+Math.random()*(t-e)},e.callback=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];egret.callLater.apply(egret,[e,t].concat(n))},e.callbackTime=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];var o=-1;if(n>0){var r={intervalId:0,callback:e,target:t,time:n,args:a},s=function(e){this.callback.apply(this,[e.callback,e.target].concat(e.args)),egret.clearTimeout(e.intervalId)};r.intervalId=egret.setTimeout(s,this,n,r),o=r.intervalId}else this.callback.apply(this,[e,t].concat(a));return o},e.throwException=function(e,t){throw void 0===e&&(e=void 0),void 0===t&&(t=ExceptionBase),e&&(SDKManager.getChannel()==EChannel.CHANNEL_LOCAL?alert(e):egret.log(e)),new t},e.addTimer=function(t,n,a){if(void 0===a&&(a=1e3),!e.timerManager[a.toString()]){var i=new egret.Timer(a);i.start(),e.timerManager[a.toString()]=i}e.callback(t,n),e.timerManager[a.toString()].addEventListener(egret.TimerEvent.TIMER,t,n)},e.removeTimer=function(t,n,a){void 0===a&&(a=1e3),e.timerManager[a.toString()]&&e.timerManager[a.toString()].removeEventListener(egret.TimerEvent.TIMER,t,n)},e.removeArrayObj=function(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)},e.isNumber=function(e){return null!=e?!isNaN(e):!1},e.stringIsNum=function(e){var t=/^\d+(\.\d+)?$/;return t.test(e)},e.checkFace8=function(t,n,a,i){var o=-Math.atan2(i-n,a-t)*(180/Math.PI);return e.getFaceByAngle(o)},e.getFaceByAngle=function(e){var t;return t=e>67.5&&112.5>e?Direction.UP:e>22.5&&67.5>e?Direction.RIGHTUP:e>-22.5&&22.5>e?Direction.RIGHT:e>-67.5&&-22.5>e?Direction.RIGHTDOWN:e>-112.5&&-67.5>e?Direction.DOWN:e>-157.5&&-112.5>e?Direction.LEFTDOWN:e>112.5&&157.5>e?Direction.LEFTUP:Direction.LEFT},e.getAngleByDir=function(e){switch(e){case Direction.DOWN:return 0;case Direction.RIGHTDOWN:return 60;case Direction.RIGHT:return 90;case Direction.RIGHTUP:return 120;case Direction.UP:return 180;case Direction.LEFTUP:return 240;case Direction.LEFT:return 270;case Direction.LEFTDOWN:return 300}},e.beelinePoint=function(e,t,n,a){var i=new egret.Point,o=Math.floor(Math.sin(45*Math.PI/180)*a);switch(n){case Direction.DOWN:i.x=e,i.y=t+a;break;case Direction.LEFTDOWN:i.x=e-o,i.y=t+o;break;case Direction.LEFT:i.x=e-a,i.y=t;
break;case Direction.LEFTUP:i.x=e-o,i.y=t-o;break;case Direction.UP:i.x=e,i.y=t-a;break;case Direction.RIGHTUP:i.x=e+o,i.y=t-o;break;case Direction.RIGHT:i.x=e+a,i.y=t;break;case Direction.RIGHTDOWN:i.x=e+o,i.y=t+o}return i},e.beelinePointByAngle=function(e,t,n,a){var i=new egret.Point,o=0;return 90>=n?(o=n*(Math.PI/180),i.x=e+Math.sin(o)*a,o=(90-n)*(Math.PI/180),i.y=t+Math.sin(o)*a):180>=n?(o=(180-n)*(Math.PI/180),i.x=e+Math.sin(o)*a,o=(n-90)*(Math.PI/180),i.y=t-Math.sin(o)*a):270>=n?(o=(n-180)*(Math.PI/180),i.x=e-Math.sin(o)*a,o=(270-n)*(Math.PI/180),i.y=t-Math.sin(o)*a):(o=Math.max(0,360-n)*(Math.PI/180),i.x=e-Math.sin(o)*a,o=(n-270)*(Math.PI/180),i.y=t+Math.sin(o)*a),i},e.randomPosByDistance=function(e,t,n,a){void 0===a&&(a=null);var i=Math.floor(360*Math.random());return this.getPosByRadiiAndAngle(e,t,i,n,a)},e.getPosByRadiiAndAngle=function(e,t,n,a,i){return void 0===i&&(i=null),i||(i=new egret.Point),i.x=Math.ceil(e+a*Math.cos(n*Math.PI/180)),i.y=Math.ceil(t-a*Math.sin(n*Math.PI/180)),i},e.getPosByTwoPoint=function(e,t,n,a,i){var o=-Math.atan2(a-t,n-e)*(180/Math.PI);return o=0>o?360+o:o,this.getPosByRadiiAndAngle(e,t,o,i)},e.readZipToJson=function(t){try{return t?ModelManager.getInstance().configJson[t]:null}catch(n){e.log("read zip to json Error!! name: "+t),this.throwException()}},e.getResAsync=function(t,n,a){RES.hasRes(t)?RES.getRes(t)?e.callback(n,a):RES.getResAsync(t,n,a):e.callback(n,a)},e.onDrawDisObjToTexture=function(e,t,n){void 0===n&&(n=1);var a=new egret.RenderTexture;return a.drawToTexture(e,t,n),a},e.Object2Ary=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.jointHintAttributeAddStr=function(e){for(var t=e.length,n=[],a=0;t>a;a++)n.push({text:e[a][0],style:{textColor:16777215}}),n.push({text:"+"+e[a][1],style:{textColor:65280}}),n.push({text:"\n",style:{}});return n.pop(),n},e.getCurrTime=function(){return(new Date).getTime()},e.getTimeStr=function(e){if(e>0){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60);return(10>t?"0"+t:t)+":"+(10>n?"0"+n:n)+":"+(10>a?"0"+a:a)}return"00:00:00"},e.getDayHourMinuteTimeStr=function(e){if(e>0){var t=Math.floor(e/86400),n=Math.floor(e%86400/3600),a=Math.floor(e%3600/60);Math.floor(e%60);return t+"天"+(10>n?"0"+n:n)+"时"+(10>a?"0"+a:a)+"分"}return"00:00:00"},e.formatZeroDate=function(e){var t=e.toString(),n=/[0-9]{2}:[0-9]{2}:[0-9]{2}/g;return t=t.replace(n,"00:00:00"),e=new Date(Date.parse(t))},e.getHtmlColorStr=function(e,t){return"<font color='#"+t+"'>"+e+"</font>"},e.getHtmlITextElement=function(e){return this._htmlParser||(this._htmlParser=new egret.HtmlTextParser),this._htmlParser.parse(e)},e.isIPUrl=function(e){var t=/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[0-9]{1,2})(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[0-9]{1,2})){3}$/g,n=e.match(t);return n&&n.length>0},e.compareVersion=function(e,t){if(!e)return-1;if(!t)return-1;e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var a=0;n>a;a++){var i=parseInt(e[a]),o=parseInt(t[a]);if(i>o)return 1;if(o>i)return-1}return 0},e.toInt=function(e){var t=Math.floor(e);return t>e?t-1:t},e.getChineseByImgNum=function(e){var t=""+e;return 2==t.length&&"1"==t[0]&&"9"!=t[1]&&(t="9"+t[1]),t},e.toChineseNum=function(e){var t=""+e;return 2==t.length&&(t=20>e?"0"+("0"!=t[1]?t[1]:""):e%10==0?t:t[0]+"0"+t[1]),t},e.getChineseByNum=function(e){if(0>=e)return GameDefine.Chinese_Company_Ary[0];if(10>e)return GameDefine.Chinese_Number_Ary[e];if(20>e)return GameDefine.Chinese_Company_Ary[1]+GameDefine.Chinese_Number_Ary[e%10];for(var t="",n=e.toString(),a=n.length,i=-1,o=0,r=a-1;r>=0;--r){var s=parseInt(n[r]);0==s?t.length>0&&0!=i&&(t=GameDefine.Chinese_Company_Ary[0]+t):t=o>0?GameDefine.Chinese_Number_Ary[s]+GameDefine.Chinese_Company_Ary[o]+t:GameDefine.Chinese_Number_Ary[s]+t,o++,i=s}return t},e.currencyTo=function(e){var t=parseFloat(e);return isNaN(t)?void 0:t.toFixed(2)},e.setDisplayGray=function(t,n){void 0===n&&(n=!0),t&&(n?t.filters=[new egret.ColorMatrixFilter(e.colorMatrix)]:t.filters=[])},e.timerManager={},e.callbacktimeManager={},e.colorMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e}();__reflect(Tool.prototype,"Tool");var ExceptionBase=function(){function e(){}return e}();__reflect(ExceptionBase.prototype,"ExceptionBase",["ExceptionInformation"]);var GameJSZipLoadOptions=function(){function e(){}return e}();__reflect(GameJSZipLoadOptions.prototype,"GameJSZipLoadOptions",["JSZipLoadOptions"]);var TweenLiteUtil=function(){function e(){}return e.onBelineTween=function(e,t,n,a,i,o){void 0===a&&(a=null),void 0===i&&(i=null),void 0===o&&(o=null);var r=egret.Tween.get(e);r.to({x:t.x,y:t.y},n,a).call(function(e){r=null,egret.Tween.removeTweens(e),null!=i&&null!=o&&Tool.callback(i,o,e)},this,[e])},e.onHideTween=function(e,t,n,a){void 0===t&&(t=null),void 0===n&&(n=null),void 0===a&&(a=500);var i=egret.Tween.get(e);i.to({alpha:0},a,egret.Ease.circIn).call(function(e){egret.Tween.removeTweens(e),i=null,null!=t&&null!=n&&Tool.callback(t,n,e)},this,[e])},e.bodyJumpFly=function(e,t,n,a,i){var o=-(80+.05*i),r=egret.Tween.get(e);r.to({x:a.x,y:a.y},.9*i,egret.Ease.circOut);var s=egret.Tween.get(e);s.to({childOffY:o},.5*i,egret.Ease.circOut).to({childOffY:0},.5*i,egret.Ease.quartIn).call(function(){egret.Tween.removeTweens(e),r=null,s=null,e.childOffY=0,null!=t&&null!=n&&Tool.callback(t,n,e)})},e.dropbodyFly1=function(e,t){var n=-(30+this.getRD(60)),a=egret.Tween.get(e);a.to({childOffY:n},100,egret.Ease.circOut).to({childOffY:0},300,egret.Ease.quartIn);var i=egret.Tween.get(e);i.to({x:t.x,y:t.y},410,egret.Ease.circOut).call(function(e){i=null,a=null,egret.Tween.removeTweens(e),e.onShowDropEffect()},this,[e])},e.beelineTween=function(e,t,n,a,i,o){void 0===i&&(i=600),void 0===o&&(o=egret.Ease.circOut);var r=egret.Tween.get(e);r.to({x:a.x,y:a.y},i,o).call(function(e){egret.Tween.removeTweens(e),r=null,null!=t&&null!=n&&Tool.callback(t,n,e)},this,[e])},e.openWindowEffect=function(e){e.anchorOffsetX=GameDefine.GAME_STAGE_WIDTH/2,e.anchorOffsetY=GameDefine.GAME_STAGE_HEIGHT/2,e.x=e.anchorOffsetX,e.y=e.anchorOffsetY,e.scaleX=.6,e.scaleY=.6;var t=egret.Tween.get(e);t.to({scaleX:1,scaleY:1},2e3,egret.Ease.backInOut).call(this.openWindowAnimEnd,this,[e])},e.openWindowAnimEnd=function(e){e.anchorOffsetX=0,e.anchorOffsetY=0,e.x=0,e.y=0,egret.Tween.removeTweens(e)},e.onDeathFly=function(e,t,n,a){var i=600,o=-(50+this.getRD(50)),r=egret.Tween.get(e);r.to({x:a.x,y:a.y},i).call(function(){egret.Tween.removeTweens(e),s=null,r=null,e.childOffY=0,null!=t&&null!=n&&Tool.callback(t,n,e)});var s=egret.Tween.get(e);s.to({childOffY:o},.2*i,egret.Ease.circOut).to({childOffY:0},.3*i,egret.Ease.quartIn)},e.getRD=function(e){return Math.round(e*Math.random())},e}();__reflect(TweenLiteUtil.prototype,"TweenLiteUtil");var HallActivityManager=function(){function e(){}return e}();__reflect(HallActivityManager.prototype,"HallActivityManager");var VipBuyItem=function(){function e(){}return e.prototype.parseMessage=function(e){this.lv=e.getByte(),this.max=e.getShort()},e}();__reflect(VipBuyItem.prototype,"VipBuyItem");var InvestManager=function(){function e(){this.isBuy=!1,this.record=[],this.fundReward=[],this.fundBuy=!1}return e.prototype.parseMessage=function(e){if(this.isBuy=1==e.getByte(),this.isBuy){this.day=e.getByte();var t=e.getByte();this.record=[];for(var n=0;t>n;n++)this.record.push(e.getByte())}},e.prototype.parseBuyMessage=function(e){this.isBuy=1==e.getByte(),this.isBuy&&(this.day=1)},e.prototype.parseObtainMessage=function(e){this.fundBuy=e.getBoolean(),this.fundReward=[];var t=e.getByte();this.fundReward=[];for(var n=0;t>n;n++)this.fundReward.push(e.getByte())},e.prototype.isFundOver=function(){for(var e=0;e<this.fundReward.length;e++)if(0==this.fundReward[e])return!1;return!0},e.prototype.getCanObtainAward=function(){var e=DataManager.getInstance().investManager;if(!e.isBuy)return!1;for(var t=Math.min(7,e.day),n=t;n>=1;n--){var a=e.record.indexOf(n);if(-1==a)return!0}return!1},e.prototype.getCanObtainAwardByDay=function(e){var t=DataManager.getInstance().investManager;if(!t.isBuy)return!1;var n=Math.min(7,t.day);return e>n?!1:-1==t.record.indexOf(e)?!0:!1},e}();__reflect(InvestManager.prototype,"InvestManager");var LianXuLeiChongManager=function(){function e(){this.record={},this.todayMoney=0}return e.prototype.onParseMessage=function(e){this.record={},this.allMoney=[],this.todayMoney=e.getInt();for(var t=e.getByte(),n=0;t>n;n++)this.allMoney.push(e.getByte())},e}();__reflect(LianXuLeiChongManager.prototype,"LianXuLeiChongManager");var OpenServerLeiChongManager=function(){function e(){this.record={},this.todayMoney=0}return e.prototype.onParseMessage=function(e){this.record={},this.allMoney=[],this.todayMoney=e.getInt();for(var t=e.getByte(),n=0;t>n;n++)this.allMoney.push(e.getByte())},e.prototype.getAllMoney=function(e){var t=0;switch(e){case 100:t=0;break;case 300:t=1;break;default:t=2}return this.allMoney[t]},e}();__reflect(OpenServerLeiChongManager.prototype,"OpenServerLeiChongManager");var ActivityContainerBar=function(e){function t(t){var n=e.call(this)||this;return n.points={},n.layer=t,n.layer.removeChildren(),n.activityIDOrder=[],n.checkActivityBtn(),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WANBA_DESK_INFO_MESSAGE.toString(),n.onWanbaInfo,n),GameDispatcher.getInstance().addEventListener(GameEvent.WANBAVIP_MAX,n.onRemoveWanBaVipBtn,n),n}return __extends(t,e),t.prototype.onRemoveWanBaVipBtn=function(){var e;e=this.layer.getChildByName("Activity_Button_20"),e&&(this.layer.removeChild(e),e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onActivityBtnClick,this),e=null,this.adjusetChild(this.layer),delete this.points[20])},t.prototype.checkActivityBtn=function(){var e=JsonModelManager.instance.getModelactivityGroup();for(var t in e){var n=e[t];n.level>DataManager.getInstance().playerManager.player.level||SDKManager.isHidePay&&n.isIos>0||this.onCheckActBtnRemove(n.id,this.layer)}},t.prototype.trigger=function(){for(var e in this.points)this.points[e].checkPoint()},t.prototype.onCheckActBtnRemove=function(e,t){-1==this.activityIDOrder.indexOf(e)&&this.activityIDOrder.push(e);var n="",a=JsonModelManager.instance.getModelactivityGroup()[e];a&&a.icon&&a.icon.length>0&&(n=a.icon);var i=!1;if(ACTIVITY_TYPE.ACTIVITY_FOCUS==e)n=SDKManager.getFocusSkin(),!SDKManager.loginInfo.focus&&n&&(i=!0,SDKManager.loginInfo.channel==EChannel.CHANNEL_SOEZ&&(i=SDKEZJS.isSupportFocus(),10410==SDKManager.loginInfo.subChannel&&(i=!1)));else if(ACTIVITY_TYPE.ACTIVITY_SHARE==e)i=!0,SDKManager.getShareSkin()||(i=!1),SDKManager.getChannel()==EChannel.CHANNEL_SOEZ&&(i=SDKEZ.getInstance().isSupportShare);else if(ACTIVITY_TYPE.VERIFY_GIFT==e){if(SDKManager.loginInfo.channel==EChannel.CHANNEL_AWY&&0==DataManager.getInstance().playerManager.verify){var o=SDKUtil.getQueryString("verify");o&&"0"!=o||(i=!0)}}else if(ACTIVITY_TYPE.ACTIVITY_WANBA_FOCUS==e)i=DataManager.getInstance().functionManager.wanbaFoucs||SDKManager.loginInfo.channel!=EChannel.CHANNEL_WANBA?!1:!0;else if(ACTIVITY_TYPE.WANBA_XQBL==e)SDKManager.loginInfo.channel==EChannel.CHANNEL_WANBA&&(i=!0);else if(ACTIVITY_TYPE.ACTIVITY_WANBA_DESK==e)i=SDKManager.getChannel()==EChannel.CHANNEL_WANBA?!0:!1;else if(ACTIVITY_TYPE.ACTIVITY_WANBA_VIPTEQUAN==e)if(SDKManager.getChannel()==EChannel.CHANNEL_WANBA){i=!0;var r=0,s=SDKWanBa.getInstance().getVipInfo();HttpUtil.sendGetRequest(s,function(e){var t=e.currentTarget,n=JSON.parse(JSON.parse(t.response).ret);n&&(r=n.level,r>0&&!n.isGetGift?DataManager.getInstance().playerManager.player.wanbaVip=!0:(r>=6&&n.isGetGift&&(i=!1,this.onRemoveWanBaVipBtn()),DataManager.getInstance().playerManager.player.wanbaVip=!1))},this)}else i=!1;else if(ACTIVITY_TYPE.ACTIVITY_YUGAO==e){n="";var h=DataManager.getInstance().activityManager.getActYugaoIdx();i=h>0,i&&(n="activity_yugao_icon"+h+"_png")}else ACTIVITY_TYPE.FANGKUAI_GENGDUOYOUXI==e?SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&FunDefine.getXYXFuncIsOpen(Constant.XYX_MOREGAME_SWITCH)&&(i=!0):ACTIVITY_TYPE.VIP_SERVICE==e?SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&FunDefine.getXYXFuncIsOpen(Constant.XYX_CUSTOMSERVICE_SWITCH)&&(i=!0):ACTIVITY_TYPE.WXGAME_COLLECTION==e?SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&FunDefine.getXYXFuncIsOpen(Constant.XYX_SHOUCANGYOUXI_SWITCH)&&(i=!DataManager.getInstance().playerManager.player.wxcolletion):i=ACTIVITY_TYPE.WXGAME_FIRST_SHARE==e?SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX?FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)&&DataManager.getInstance().wxgameManager.isFirstShare:!1:ACTIVITY_TYPE.WXGAME_INVITE==e||ACTIVITY_TYPE.WXGAME_SHARE==e?SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX?FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE):!1:DataManager.getInstance().activityManager.getIsOpenByGroupID(e);var l;if(i)l=t.getChildByName("Activity_Button_"+e),l||(l=new ActivityButton(n),l.name="Activity_Button_"+e,l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onActivityBtnClick,this),t.addChild(l),this.addButtonAnimation(l),this.adjusetChild(t)),this.onAddRedPoint(e,l);else switch(l=t.getChildByName("Activity_Button_"+e),l&&(this.delButtonAnimation(l),t.removeChild(l),l.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onActivityBtnClick,this),l=null,this.adjusetChild(t),delete this.points[e]),e){case ACTIVITY_TYPE.ACTIVITY_HALL:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_CLOSE),"HallActivityPanel")}},t.prototype.addButtonAnimation=function(e){var t;e&&!e.getChildByName("Activity_Button_effect")&&(t=new Animation("huodong"),t.name="Activity_Button_effect",t.x=35,t.y=35,e.addChildAt(t,1))},t.prototype.delButtonAnimation=function(e){var t;e&&e.getChildByName("Activity_Button_effect")&&(t=e.getChildByName("Activity_Button_effect"),t.onDestroy(),t=null)},t.prototype.adjusetChild=function(e){for(var t,n=-73,a=75,i=8,o=0,r=0;r<this.activityIDOrder.length;r++)t=e.getChildByName("Activity_Button_"+this.activityIDOrder[r]),t&&(t.x=Math.floor(o%i)*n,t.y=Math.floor(o/i)*a,o++)},t.prototype.onAddRedPoint=function(e,t){var n;switch(this.points[e]?n=this.points[e]:(this.points[e]=new redPoint,this.points[e].addRedPointImg(t,GameDefine.RED_CRICLE_STAGE_PRO),n=this.points[e]),e){case ACTIVITY_TYPE.ACTIVITY_TREASURE:n.addTriggerFuc(DataManager.getInstance().celestialManager,"checkEpicTierEquipPoint");break;case ACTIVITY_TYPE.ACTIVITY_WANBA_DESK:n.addTriggerFuc(DataManager.getInstance().playerManager,"checkDeskPoint");break;case ACTIVITY_TYPE.ACTIVITY_YIYUANLIBAO:n.addTriggerFuc(DataManager.getInstance().rechargeManager,"oneRecharge");break;case ACTIVITY_TYPE.ACTIVITY_SHARE:n.addTriggerFuc(DataManager.getInstance().functionManager,"sharePoint");break;case ACTIVITY_TYPE.ACTIVITY_FOCUS:break;case ACTIVITY_TYPE.ACTIVITY_SHENQI:n.addTriggerFuc(DataManager.getInstance().playerManager,"shenqiPoint");break;case ACTIVITY_TYPE.ACTIVITY_WANBA_VIPTEQUAN:n.addTriggerFuc(DataManager.getInstance().playerManager,"checkWanBaVipPoint");break;case ACTIVITY_TYPE.ACTIVITY_VIP_ZHUANPAN:n.addTriggerFuc(DataManager.getInstance().vipManager,"getZhuanPanPoint");break;case ACTIVITY_TYPE.ACTIVITY_WUYi:n.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"getActivityPoint");break;case ACTIVITY_TYPE.ACTIVITY_TREASURE:n.register(this.bottom_72,GameDefine.RED_MAIN_II_POS,DataManager.getInstance().celestialManager,"checkEpicTierEquipPoint");break;case ACTIVITY_TYPE.ACTIVITY_HEFU:n.addTriggerFuc(DataManager.getInstance().hefuActManager,"checkHefuMissionRedPoint");break;case ACTIVITY_TYPE.ACTIVITY_SMELT:n.addTriggerFuc(DataManager.getInstance().bagManager,"getEquipSmeltPointShow");break;default:n.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPoint",e)}},t.prototype.onActivityBtnClick=function(e){var t=e.currentTarget,n=parseInt(t.name.replace("Activity_Button_","")),a=JsonModelManager.instance.getModelactivityGroup()[n];switch(n){case ACTIVITY_TYPE.ACTIVITY_SHOP:ShopDefine.openDefaultShopView();break;case ACTIVITY_TYPE.ACTIVITY_TREASURE_RANK:DataManager.getInstance().treasureRankManager.onSendMessage(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),a?a.panel:"TreasureRankPanel");break;case ACTIVITY_TYPE.ACTIVITY_TREASURE:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam(a?a.panel:"EquipNBPanel",0));break;case ACTIVITY_TYPE.FANGKUAI_GENGDUOYOUXI:platform.navigateToMiniProgram({appId:"wx20194e7827347870",path:""});break;case ACTIVITY_TYPE.VIP_SERVICE:platform.openCustomerServiceConversation({});break;case ACTIVITY_TYPE.ACTIVITY_FESTIVAL:break;case ACTIVITY_TYPE.ACTIVITY_WEEKEND:break;case ACTIVITY_TYPE.ACTIVITY_SHARE:this.onTouchBtnShare(n);break;case ACTIVITY_TYPE.ACTIVITY_FOCUS:this.onTouchBtnFocus(n);break;case ACTIVITY_TYPE.WANBA_XQBL:SDKWanBaJS.openUrl("https://buluo.qq.com/mobile/barindex.html?bid=403919&from=");break;default:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),a.panel)}this.delButtonAnimation(t)},t.prototype.onTouchBtnShare=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ShareInfoPanel")},t.prototype.updateShareInfo=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SDK_SHARE_INFO_UPDATE),e)},t.prototype.onTouchBtnFocus=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FocusPanel")},t.prototype.onlineGiftRedPoint=function(){return!1},t.prototype.onTimer=function(){},t.prototype.onWanbaInfo=function(){var e=this.points[ACTIVITY_TYPE.ACTIVITY_WANBA_DESK];e&&e.checkPoint()},t}(eui.Component);__reflect(ActivityContainerBar.prototype,"ActivityContainerBar");var OnlineGiftPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.goods=new GoodsInstance,this.goods.x=274,this.goods.y=480,this.addChild(this.goods),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.OnlineGiftSkin},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.receiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this)},t.prototype.onReceiveClick=function(e){var t=new Message(MESSAGE_ID.RECEIVE_ONLINE_GIFT);GameCommon.getInstance().sendMsgToServer(t),this.onHide()},t.prototype.onCountDown=function(){},t}(BaseWindowPanel);__reflect(OnlineGiftPanel.prototype,"OnlineGiftPanel");var Activity666MainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="Activity666Panel",n.btnRes="z_shenqi2_icon",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().a666Manager,"checkRedPoint"),t.push(n);var a=new RegisterSystemParam;a.sysName="ActivityXLDHPanel",a.btnRes="z_dh_icon",a.redP=this.points[1],a.redP.addTriggerFuc(DataManager.getInstance().a666Manager,"checkRedDHPointAll"),t.push(a);var i=new RegisterSystemParam;i.sysName="Activity666RankPanel",i.btnRes="z_666_rank_icon",t.push(i),this.registerPage(t,"activity666mainGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("z_shenqi2_title_png");break;case 1:this.setTitle("z_dh_title_png");break;case 2:this.setTitle("z_666_rank_title_png")}e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(Activity666MainPanel.prototype,"Activity666MainPanel");var Activity666Manager=function(){function e(){this.consume_meRank=-1,this.rewardItem=new ItemBody,this.lunshu=0,this.usedCount=0,this.money=0,this.currModel=this.getCurrModel()}return e.prototype.parseInit=function(e){this.lunshu=e.getByte(),this.receiveBoxIdx=e.getByte(),this.usedCount=e.getShort(),this.money=e.getInt(),this.currModel=this.getCurrModel()},e.prototype.sendLabaMessage=function(e){void 0===e&&(e=0);var t=new Message(MESSAGE_ID.ACT_666_LABA_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},e.prototype.parseLaba=function(e){switch(this.receiveBoxIdx=e.getByte(),this.usedCount=e.getShort(),this.type=e.getByte(),this.money=e.getInt(),this.type){case 0:break;case 1:this.rewardItem.parseMsg(e),this.rewardIdx=3-e.getByte()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseLabaRank=function(e){this.consumeitem_ranks=[],this.consume_meRank=-1;for(var t=e.getByte(),n=0;t>n;n++)this.consumeitem_ranks[n]=new CrossServerConsumeRank,this.consumeitem_ranks[n].parseMsg(e),this.consumeitem_ranks[n].playerId==DataManager.getInstance().playerManager.player.id&&(this.consume_meRank=this.consumeitem_ranks[n].rank);GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getRewardItem=function(){return this.rewardItem?new AwardItem(this.rewardItem.itemType,this.rewardItem.itemId,this.rewardItem.itemCount):null},e.prototype.checkRedPointFunc=function(){return this.checkRedPoint()||this.checkRedDHPointAll()},e.prototype.checkRedPoint=function(){return this.checkRedPointBox()?!0:this.currModel?this.getHaveMoney()>=this.currModel.costNum:!1},e.prototype.checkRedDHPointAll=function(){var e=JsonModelManager.instance.getModelactivityxianlvshenqi();for(var t in e){var n=e[t].cost;if(DataManager.getInstance().bagManager.getGoodsThingNumById(n.id)>=n.num)return!0}return!1},e.prototype.checkRedDHPoint=function(e){var t=JsonModelManager.instance.getModelactivityxianlvshenqi()[e];return DataManager.getInstance().bagManager.getGoodsThingNumById(t.id)>=t.num},e.prototype.checkRedPointBox=function(){if(this.receiveBoxIdx<Activity666Panel.BOX_MAX){var e=this.currModel.box.split("#")[this.receiveBoxIdx];if(e){var t=parseInt(e.split(",")[0]);return this.usedCount>=t}}return!1},e.prototype.getCurrModel=function(){var e=JsonModelManager.instance.getModelactivityxianlvlaba();for(var t in e)if(this.lunshu==e[t].round)return e[t];return null},e.prototype.getHaveMoney=function(){return this.money-this.usedCount*this.currModel.costNum},e.prototype.getHaveCount=function(){return Math.floor(this.getHaveMoney()/this.currModel.costNum)},e.prototype.getMoneyStr=function(){return this.getHaveMoney()%this.currModel.costNum},e}();__reflect(Activity666Manager.prototype,"Activity666Manager");var Activity666Panel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.Activity666PanelSkin},t.prototype.onInit=function(){this.manager=DataManager.getInstance().a666Manager,this.points[0].register(this.btnReceive,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().a666Manager,"checkRedPointBox"),this.isRunFinish=[!1,!1,!1],this.groupReward.mask=new egret.Rectangle(0,-10,this.groupReward.width,this.groupReward.height+20),this.groupRewards=[this.groupReward0,this.groupReward1,this.groupReward2],this.timeDelays=[400,0,700],this.timeSps=[200,100,150],this.imgRockers=[this.imgRocker0,this.imgRocker1],this.groupRunTop=this.groupRewards[0].y;var e=this;this.btnFire.touchEnabled=!0,this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.onEventRocker(1)},this),this.initItemList()},t.prototype.onRegist=function(){this.examineCD(),this.showAwardPanel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),this.btnReceive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventReceiveBox,this);for(var e=0;e<t.BOX_MAX;e++)this.award_box_imgs[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_666_LABA_MESSAGE.toString(),this.onCallLaba,this),this.checkModelInfo(),this.resetUI(),this.updateBoxs(),this.onCloseAwdShow(),this.resetGroups(),this.manager.sendLabaMessage()},t.prototype.onRemove=function(){this.examineCD(!1),this.isAction=!1;for(var e=0;e<t.BOX_MAX;e++)this.award_box_imgs[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);this.showAwardPanel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),this.btnReceive.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventReceiveBox,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_666_LABA_MESSAGE.toString(),this.onCallLaba,this)},t.prototype.onCallLaba=function(){this.progressBar.maximum=this.manager.currModel.costNum,this.progressBar.value=this.manager.getMoneyStr(),this.lbCount.text=this.manager.getHaveCount().toString(),this.lbUsedCount.text=this.manager.usedCount.toString(),this.updateBoxs(),1==this.manager.type&&this.onDealRocker()},t.prototype.onEventReceiveBox=function(){this.manager.sendLabaMessage(2)},t.prototype.updateBoxs=function(){this.btnReceive.enabled=!1;for(var e=this.manager.currModel.box.split("#"),n=0;n<t.BOX_MAX;n++){var a=e[n]?e[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this.award_times_labs[n].text=Language.instance.getText(i,"times"),this.reward_anim_grps[n].removeChildren(),i<=this.manager.receiveBoxIdx?(this.award_box_imgs[n].source="hefuActbox_open_png",this.award_box_imgs[n].y=-12):this.manager.usedCount>=i&&(this.btnReceive.enabled=!0,this.award_box_imgs[n].y=-0,this.award_box_imgs[n].source="hefuActbox_png",GameCommon.getInstance().addAnimation("baoxiangtixing",null,this.reward_anim_grps[n],-1))}},t.prototype.onTouchBox=function(e){var t=this.manager.currModel.box.split("#")[parseInt(e.target.name)].split(",")[1],n=JsonModelManager.instance.getModelbox()[t],a=new ThingBase(GOODS_TYPE.BOX);a.onupdate(n.id,n.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,a,0)))},t.prototype.checkModelInfo=function(){for(var e=this.manager.currModel.rewards,t=0;4>t;t++)this.goodLists[t].onUpdate(e[t].type,e[t].id,0,e[t].quality,e[t].num);this.lbCost&&(this.lbCost.text=this.manager.currModel.costNum.toString()),this.lbCost1&&(this.lbCost1.text=this.manager.currModel.costNum+"元")},t.prototype.examineCD=function(e){void 0===e&&(e=!0),e?Tool.addTimer(this.updateTime,this,1e3):Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ACT_666SHENQI2);0>=e&&(e=0,this.examineCD(!1)),this.lbTime.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onRewardShow=function(){this.onPlayDone(this.manager.getRewardItem())},t.prototype.onEventRocker=function(e){void 0===e&&(e=1),this.isAction||this.sendRocker()&&(this.setActionState(1),Tool.callbackTime(this.resetState,this,1e3))},t.prototype.sendRocker=function(e){return void 0===e&&(e=1),this.manager.getHaveCount()>=e?(this.isAction=!0,this.manager.sendLabaMessage(1),!0):(GameCommon.getInstance().addAlert("error_tips_6"),!1)},t.prototype.onDealRocker=function(){this.isRunEnd=!1,this.updateRewardList(),this.resetGroups(),this.isRunFinish=[!1,!1,!1],this.timeDelays=[Tool.randomFloat(0,600),Tool.randomFloat(0,600),Tool.randomFloat(0,600)],this.timeSps=[Tool.randomFloat(100,200),Tool.randomFloat(100,200),Tool.randomFloat(100,200)],this.groupRunStart(0,this.timeDelays[0]),this.groupRunStart(1,this.timeDelays[1]),this.groupRunStart(2,this.timeDelays[2]),Tool.callbackTime(this.onActionEnd,this,1500)},t.prototype.updateRewardList=function(){var e=this.manager.rewardIdx;0==e?this.rewards=[this.getRewardRandom(),this.getRewardRandom(),this.getRewardRandom()]:1==e?(this.rewards=[this.getRewardRandom(),this.getRewardRandom(),this.getRewardRandom()],this.rewards[Tool.randomInt(0,3)]=6):2==e?(this.rewards=[6,6,6],this.rewards[Tool.randomInt(0,3)]=this.getRewardRandom()):3==e&&(this.rewards=[6,6,6])},t.prototype.groupRunStart=function(e,t){void 0===t&&(t=0);var n=egret.Tween.get(this.groupRewards[e]);t>0&&n.wait(t),n.to({y:0},this.timeSps[e]);var a=this;n.call(function(){egret.Tween.removeTweens(a.groupRewards[e]),a.groupRunEnd(e)},this)},t.prototype.groupRunEnd=function(e){this.isAction&&(this.isRunEnd?(this.rewardRuns[e][1]=this.rewards[e],this.rewardRuns[e][0]=this.getRewardRandom(),this.updateItem(this.goodsLit[e][0],this.rewardRuns[e][0]),this.updateItem(this.goodsLit[e][1],this.rewardRuns[e][1]),this.checkRunFinishAll(e)):(this.rewardRuns[e][1]=this.rewardRuns[e][0],this.rewardRuns[e][0]=this.getRewardRandom(),this.updateItem(this.goodsLit[e][0],this.rewardRuns[e][0]),this.updateItem(this.goodsLit[e][1],this.rewardRuns[e][1]),this.resetGroups(e),this.groupRunStart(e)))},t.prototype.updateItem=function(e,t){e.source="z_666_"+t+"_png"},t.prototype.checkRunFinishAll=function(e){this.isRunFinish[e]=!0,this.resetGroups(e);for(var t=0;t<this.isRunFinish.length;++t)if(!this.isRunFinish[t])return;this.onActionEnd(!0)},t.prototype.onActionEnd=function(e){void 0===e&&(e=!1),this.isRunEnd=!0,e&&(this.resetUI(),this.onRewardShow())},t.prototype.resetGroups=function(e){void 0===e&&(e=-1),-1==e?(this.groupRewards[0].y=this.groupRunTop,this.groupRewards[1].y=this.groupRunTop,this.groupRewards[2].y=this.groupRunTop):this.groupRewards[e].y=this.groupRunTop},t.prototype.resetUI=function(){this.isAction=!1,this.setActionState(0)},t.prototype.resetState=function(){this.setActionState(0)},t.prototype.initItemList=function(){this.goodLists=[];for(var e=0;4>e;e++)this.goodLists[e]=this["good"+e],this.goodLists[e].name_label.visible=!1;this.rewardRuns=[],this.goodsLit=[];for(var e=0;e<this.groupRewards.length;++e){this.rewardRuns[e]=[],this.goodsLit[e]=[];for(var n=0;2>n;++n)this.rewardRuns[e][n]=this.getRewardRandom(),this.goodsLit[e][n]=new eui.Image,this.updateItem(this.goodsLit[e][n],this.rewardRuns[e][n]),this.groupRewards[e].addChild(this.goodsLit[e][n]),this.goodsLit[e][n].y=144*n}this.reward_anim_grps=[],this.award_box_imgs=[],this.award_times_labs=[];for(var e=0;e<t.BOX_MAX;e++)this.reward_anim_grps[e]=this["reward_anim_grp"+e],this.award_box_imgs[e]=this["award_box_img"+e],this.award_box_imgs[e].name=e.toString(),this.award_box_imgs[e].touchEnabled=!0,this.award_times_labs[e]=this["award_times_lab"+e];this.resetGroups()},t.prototype.getRewardRandom=function(){var e=Tool.randomInt(0,9);return e>5&&(e+=1),e%10},t.prototype.setActionState=function(e){for(var t=0;t<this.imgRockers.length;++t)this.imgRockers[t].visible=e==t,this.imgRockers[t].visible=e==t},t.BOX_MAX=4,t}(ActivityLabaBase);__reflect(Activity666Panel.prototype,"Activity666Panel");var Activity666RankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.Activity666RankPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().a666Manager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=Act666RankItem,this.itemlist.itemRendererSkinName=skins.Activity666RankItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_666_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("LABA_666_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_666_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LABA_666_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()
},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.ACT_666_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){this.myPro.text="我的进度："+this.manager.usedCount;var e=this.manager.consume_meRank;-1==e?this.myRank.text="我的排名：未上榜":this.myRank.text="我的排名："+e;var t=JsonModelManager.instance.getModelxianlvpaihang(),n=[];for(var a in t)n.push(t[a]);this.itemlist.dataProvider=new eui.ArrayCollection(n)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LEICHONGLABA);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.consumeitem_ranks)for(var t=3;t<this.manager.consumeitem_ranks.length;t++){var n=this.manager.consumeitem_ranks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_LABA,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t.prototype.log=function(e){egret.log(e)},t}(BaseTabView);__reflect(Activity666RankPanel.prototype,"Activity666RankPanel");var Act666RankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.ranklist.hasEventListener(egret.TouchEvent.TOUCH_TAP)||(GameCommon.getInstance().addUnderlineStr(this.ranklist),this.ranklist.touchEnabled=!0,this.ranklist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this))},t.prototype.onUpdate=function(){var e=this.data,t=e.rewards;this.awards.removeChildren();for(var n=0;n<t.length;n++){var a=t[n],i=GameCommon.getInstance().createGoodsIntance(a);this.awards.addChild(i)}var o=DataManager.getInstance().a666Manager.consumeitem_ranks[e.rankMin-1];e.rankMin>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.imgRankBG.source="rankbg_4_png",this.rank_num_lab.text=e.rankMin+"-"+e.rankMax):o?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.imgRankBG.source="rankbg_"+o.rank+"_png",this.rank_num_lab.text=o.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=o.playerName,o.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="累计次数："+o.lotteryNum):(this.imgRankBG.source="rankbg_"+e.rankMin+"_png",this.rank_num_lab.text=e.rankMin.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("LABA_666_LOOP_RANK"))},t}(BaseListItem);__reflect(Act666RankItem.prototype,"Act666RankItem");var ActivityXLDHPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityXLDHPanelSkin},t.prototype.onInit=function(){this.manager=DataManager.getInstance().a666Manager,e.prototype.onInit.call(this),this.goodsList=[],this.lbNames=[],this.lbCounts=[],this.btnDHs=[];for(var t=0;5>t;++t){this.goodsList[t]=this["goods"+t],this.lbNames[t]=this["lbName"+t],this.lbCounts[t]=this["lbCount"+t],this.btnDHs[t]=this["btnDH"+t],this.btnDHs[t].name=t.toString();var n=this.getModel(t);this.lbNames[t].text=n.rewards[0].thingbase.model.name,this.goodsList[t].onUpdate(n.rewards[0].type,n.rewards[0].id,0,n.rewards[0].quality,n.rewards[0].num),this.goodsList[t].name_label.text=n.cost.thingbase.model.name,this.goodsList[t].name_label.textColor=GameCommon.getInstance().CreateNameColer(n.rewards[0].thingbase.model.quality),this.initRed(this.btnDHs[t],GameDefine.RED_BTN_POS,(t+1).toString())}},t.prototype.initRed=function(e,t,n){var a=new redPoint;a.register(e,t,this.manager,"checkRedDHPoint",n),this.points.push(a)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.examineCD(),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TLDOGZ_EXCHANGE_MESSAGE.toString(),this.onCallbackDH,this);for(var t=0;5>t;++t)this.btnDHs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventDH,this);this.updateUI()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TLDOGZ_EXCHANGE_MESSAGE.toString(),this.onCallbackDH,this);for(var t=0;5>t;++t)this.btnDHs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventDH,this)},t.prototype.examineCD=function(e){void 0===e&&(e=!0),e?Tool.addTimer(this.updateTime,this,1e3):Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ACT_666SHENQI2_DUIHUAN);0>=e&&(e=0,this.examineCD(!1)),this.lbTime.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.getModel=function(e){return JsonModelManager.instance.getModelactivityxianlvshenqi()[(e+1).toString()]},t.prototype.updateUI=function(){for(var e=0;5>e;++e){var t=this.getModel(e),n=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id,t.cost.type);this.lbCounts[e].text=n+"/"+t.cost.num,this.lbCounts[e].textColor=n>=t.cost.num?16767576:16711680}},t.prototype.onEventDH=function(e){var t=parseInt(e.target.name),n=this.getModel(t);GameCommon.getInstance().onCheckItemConsume(n.cost.id,n.cost.num,n.cost.type)&&this.onSendExchangeMessage(t+1)},t.prototype.onSendExchangeMessage=function(e){var t=new Message(MESSAGE_ID.TLDOGZ_EXCHANGE_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.onCallbackDH=function(){this.updateUI()},t}(BaseTabView);__reflect(ActivityXLDHPanel.prototype,"ActivityXLDHPanel");var ActivityLeiChongPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.btnNameStr=["10元","100元","300元"],n.btns=[10,100,300],n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityLeiChongSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.itemGroup.itemRenderer=ActivityLeiChongItem,this.itemGroup.itemRendererSkinName=skins.ActivityLeiChongItemSkin,this.itemGroup.useVirtualLayout=!0,this.index=1,this.tab1.source="leiChong_buttonon_png",this.timeLab.text="0天0时0分0";var t=new eui.Button;t.skinName=skins.ScrollerTabBtnSkin;for(var n=0;3>n;n++){var a;a=new BaseTabButton("",this.btnNameStr[n]),0==n&&(a.selected=!0),a.width=103,a.name=n+1+"",a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),this.btnGroup.addChild(a)}this.onRefresh()},t.prototype.onRefresh=function(){this.onShowAward()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!1)},t.prototype.onShowAward=function(){this.leichongDesc.source="leichongDesc"+this.index+"_png",this.itemGroup.dataProvider=new eui.ArrayCollection(this.models),this.showdate()},t.prototype.onTab=function(e){var t=Number(e.target.name);if(this.index!=t){for(var n=1;4>n;n++)this["tab"+n].source="leiChong_buttonoff_png";this.index=t,this["tab"+this.index].source="leiChong_buttonon_png",this.onShowAward()}},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=JsonModelManager.instance.getModelkaifuleichong();for(var t in e)if(e[t].gold==this.btns[this.index-1])for(var n,a=1;6>a;a++){n=GameCommon.getInstance().onParseAwardItemstr(e[t]["reward"+a]);var i=new OpenServerLeiChongItemData(n,e[t].gold,a,DataManager.getInstance().openServerLeiChongManager.getAllMoney(e[t].gold));this.rewardArr.push(i)}return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.showdate=function(){this.toDayMoney.text="今日已累计充值:"+DataManager.getInstance().openServerLeiChongManager.todayMoney;for(var e=this.rewardArr[this.rewardArr.length-1].awardItem;this.box.numChildren>0;){var t=this.box.getChildAt(0);this.box.removeChild(t)}for(var n=0;1>n;n++)this.goods=new GoodsInstance,this.goods.onUpdate(e[n].type,e[n].id,0,e[n].quality,e[n].num),this.goods.item_frame.source="welfare_frame_png",this.box.addChild(this.goods)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.OPENSERVER_LEICHONG);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(ActivityLeiChongPanel.prototype,"ActivityLeiChongPanel");var OpenServerLeiChongItemData=function(){function e(e,t,n,a){this.awardItem=e,this.moneyNum=t,this.day=n,this.curMoey=a}return e}();__reflect(OpenServerLeiChongItemData.prototype,"OpenServerLeiChongItemData");var ActivityLeiChongItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onUpdate=function(){if(this.data&&this.data){for(;this.awards.numChildren>0;){var e=this.awards.getChildAt(0);this.awards.removeChild(e)}this.name_label.text="累计"+this.data.day+"天充值"+this.data.moneyNum+"元,可获得",this.data.curMoey>=this.data.day?(this.btn_reward.label="已达标",this.btn_reward.enabled=!1):(this.btn_reward.label="去充值",this.btn_reward.enabled=!0);for(var t=this.data.awardItem,n=0;n<t.length;n++){var a=new GoodsInstance,i=t[n];a.onUpdate(i.type,i.id,0,i.quality,i.num,i.lv),a.scaleX=.8,a.scaleY=.8,this.awards.addChild(a)}}},t.prototype.onTouch=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseListItem);__reflect(ActivityLeiChongItem.prototype,"ActivityLeiChongItem");var ActivitysdabiaoPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DabiaoPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=HefuActRankItem,this.itemlist.itemRendererSkinName=skins.LiuyiTreasureRankItemSkin,this.itemlist.percentWidth=600,this.itemlist.percentHeight=166,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,this["goto"].visible=!1,this.onRefresh()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().shenqiZhuanPanManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.DABIAOPAIHANG_DATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.showpanel()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.DABIAOPAIHANG_DATE_MESSAGE.toString(),this.showpanel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.DABIAOJIANGLI_BUY_MESSAGE.toString(),this.lingqvfanhui,this),GameDispatcher.getInstance().addEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.DABIAOPAIHANG_DATE_MESSAGE.toString(),this.showpanel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.DABIAOJIANGLI_BUY_MESSAGE.toString(),this.lingqvfanhui,this),GameDispatcher.getInstance().removeEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.openRankView=function(){var e=[];if(this.manager.zhuanpanRanks)for(var t=3;t<this.manager.zhuanpanRanks.length;t++){var n=this.manager.zhuanpanRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.PERSONAL_GOAL);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t.prototype.lingqvfanhui=function(){this.showpanel()},t.prototype.onupdateRanks=function(){for(var e=[],t=0;t<ActivityDefine.LIUYI_ZHUANPAN_AWARD.length;t++)e[t]=t+1;this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.showpanel=function(){var e=DataManager.getInstance().newactivitysManager.personal_dabiao_model;this.setDayNum(e.id-1),this.target_title.source="dianfengbangzi_"+e.round+"_png",this.label_desc.text=e.desc;var t=DataManager.getInstance().newactivitysManager.getMyRank(this.playerData.id);-1==t?this.myRank.text="未上榜":this.myRank.text=t+"",this.myValue.text=DataManager.getInstance().newactivitysManager.dabiao_value+""},t.prototype.setDayNum=function(e){this.dayNum.text=e.toString()},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(ActivitysdabiaoPanel.prototype,"ActivitysdabiaoPanel");var ActivitySignPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivitySignSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.allItem=[];for(var t=0;3>t;t++){var n=new SignRewardInstance;this.allItem.push(n)}this.showpanel()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.showpanel(),this.trigger()},t.prototype.showpanel=function(){var e=DataManager.getInstance().newactivitysManager;this.sign_item_group.removeChildren();for(var t=0;t<this.allItem.length;t++){var n=this.allItem[t];n.onUpdate(t),n.onShow(this.sign_item_group)}if(this.label_sign_days.text=e.loginDay+"天",e.currLoginMode){this.sign_reward_title.text="累计登陆"+e.currLoginMode.days+"天礼包";var a=e.currLoginMode.rewards[0];this.reward_item.onUpdate(a.type,a.id,0,a.quality,a.num),e.currLoginMode.days<=e.loginDay?this.btn_reward.enabled=!0:this.btn_reward.enabled=!1}else this.sign_reward_title.text="已全部领取完毕",this.reward_item.visible=!1,this.btn_reward.visible=!1},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.LOGON_REWARD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SIGN_REWARD_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.allItem.length;t++){var n=this.allItem[t];n.onDestory()}this.btn_reward.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.LOGON_REWARD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SIGN_REWARD_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onReward=function(){var e=new Message(MESSAGE_ID.LOGON_REWARD_MESSAGE);e.setByte(0),e.setByte(DataManager.getInstance().newactivitysManager.currLoginMode.days),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(ActivitySignPanel.prototype,"ActivitySignPanel");var SignRewardInstance=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.ActivitySignItemSkin},t.prototype.onInit=function(){Tool.isNumber(this.idx)&&this.refresh()},t.prototype.onRegist=function(){this.points[0].register(this.btn_reward,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"checkRedPoint"),this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onRemove=function(){this.btn_reward.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onUpdate=function(e){this.idx=e,this.refresh()},t.prototype.refresh=function(){if(this.isLoaded){var e=DataManager.getInstance().newactivitysManager,t=JsonModelManager.instance.getModelqiandao()[e.signId];t=JsonModelManager.instance.getModelqiandao()[1];var n;n=0==this.idx?GameCommon.getInstance().onParseAwardItemstr(t.free):1==this.idx?GameCommon.getInstance().onParseAwardItemstr(t.vip):GameCommon.getInstance().onParseAwardItemstr(t.chongzhi),this.awards.removeChildren();for(var a=0;a<n.length;a++){var i=n[a],o=new GoodsInstance;o.onUpdate(i.type,i.id,0,i.quality,i.num),this.awards.addChild(o)}this.label_reward.text=Language.instance.getText("sign_desc_"+this.idx),1==e.signRewards[this.idx]?(this.btn_reward.enabled=!1,this.btn_reward.label="已领取"):(1==this.idx?0==DataManager.getInstance().playerManager.player.viplevel?this.btn_reward.enabled=!1:this.btn_reward.enabled=!0:2==this.idx?e.payToday?this.btn_reward.enabled=!0:this.btn_reward.enabled=!1:this.btn_reward.enabled=!0,this.btn_reward.label="领取奖励")}},t.prototype.onTouchButton=function(){var e=new Message(MESSAGE_ID.SIGN_REWARD_MESSAGE);e.setByte(this.idx),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.checkRedPoint=function(){return 1==this.btn_reward.enabled},t}(BaseComp);__reflect(SignRewardInstance.prototype,"SignRewardInstance");var ActivitysLeijiPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LeijichongzhiSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.leijidate=JsonModelManager.instance.getModelleijichongzhi();var e=DataManager.getInstance().newactivitysManager.leiji;this.chongzhibox.numChildren>0&&this.chongzhibox.removeChildren();var t,n;for(var a in this.leijidate)n=this.leijidate[a],n.round==e.lunci&&(t=new ActivitysChongzhiitem(n),this.chongzhibox.addChild(t));this.leijilab.text="已累计充值"+e.atyuanbao+"元"},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.examineCD(!0),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LEIJICHONGZHI);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(ActivitysLeijiPanel.prototype,"ActivitysLeijiPanel");var ActivitysChongzhiitem=function(e){function t(t,n){void 0===n&&(n=!0);var a=e.call(this)||this;return a.model=t,a.diVisi=n,a.once(egret.Event.COMPLETE,a.onInit,a),a.skinName=skins.ActivityschongzhiPanel,a}return __extends(t,e),t.prototype.onInit=function(){this.di.visible=this.diVisi,this.label_money1.text=this.model.costNum+"",this.itemarr=this.model.rewards;for(var e=0;e<this.itemarr.length;e++)this.goods=new GoodsInstance,this.goods.onUpdate(this.itemarr[e].type,this.itemarr[e].id,0,this.itemarr[e].quality,this.itemarr[e].num,this.itemarr[e].lv),this.box.addChild(this.goods)},t}(eui.Component);__reflect(ActivitysChongzhiitem.prototype,"ActivitysChongzhiitem");var ActivitysTargetRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DabiaoPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=ShenQiTreasureRank,this.itemlist.itemRendererSkinName=skins.LiuyiTreasureRankItemSkin,this.itemlist.percentWidth=600,this.itemlist.percentHeight=166,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,this["goto"].visible=!1,this.onRefresh()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().shenqiZhuanPanManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.openRankView=function(){var e=[];if(this.manager.zhuanpanRanks)for(var t=3;t<this.manager.zhuanpanRanks.length;t++){var n=this.manager.zhuanpanRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.PERSONAL_GOAL);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t.prototype.lingqvfanhui=function(){},t.prototype.onupdateRanks=function(){for(var e=[],t=0;t<ActivityDefine.LIUYI_ZHUANPAN_AWARD.length;t++)e[t]=t+1;this.itemlist.dataProvider=new eui.ArrayCollection(e);var n=(DataManager.getInstance().shenqiZhuanPanManager.zhuanpanModel,DataManager.getInstance().shenqiZhuanPanManager.zhuanpanRound);this.setDayNum(n),this.target_title.source="dianfengbangzi_"+n+"_png";var a="1、活动期间抽取当日神签次数达到40次可上榜\n2、排行榜不同名次会有超额奖励!";this.label_desc.text=a},t.prototype.setDayNum=function(e){this.dayNum.text=e.toString()},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(ActivitysTargetRankPanel.prototype,"ActivitysTargetRankPanel");var ShenQiTreasureRank=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.otherGroup.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.otherGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this)},t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().shenqiZhuanPanManager.zhuanpanModel,n=ActivityDefine.LIUYI_ZHUANPAN_AWARD[e-1];if(n){var a=GameCommon.getInstance().onParseAwardItemstr(t[n]);this.awards.removeChildren();for(var i=0;i<a.length;i++){var o=a[i],r=GameCommon.getInstance().createGoodsIntance(o);r.scaleX=.7,r.scaleY=.7,this.awards.addChild(r)}var s=DataManager.getInstance().shenqiZhuanPanManager.zhuanpanRanks[e-1];e>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.rank.source="rankbg_4_png",this.rank_num_lab.text="4-20"):s?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.rank.source="rankbg_"+s.rank+"_png",this.rank_num_lab.text=s.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=s.playerName,s.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="今日累计"+s.lotteryNum+"次"):(this.rank.source="rankbg_"+e+"_png",this.rank_num_lab.text=e.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)}},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("LIUYI_ZHUANPAN_LOOP_RANK"))},t}(BaseListItem);__reflect(ShenQiTreasureRank.prototype,"ShenQiTreasureRank");var ActivitysTargetRechargePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChongjiRechargePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.progress.minimum=0,this.onRefresh()},t.prototype.onRefresh=function(){this.progress.value=DataManager.getInstance().newactivitysManager.chargeMoneyNum,this.progress.maximum=188,this.desc.text="当日累充达到188元免费赠送",DataManager.getInstance().newactivitysManager.chargeMoneyNum>=188&&(this.progress.maximum=388,this.desc.text="当日累充达到388元免费赠送",this.progress.value=DataManager.getInstance().newactivitysManager.chargeMoneyNum,this.btn_pay.label="前往充值",DataManager.getInstance().newactivitysManager.chargeMoneyNum>=388&&(this.btn_pay.label="已达成",this.btn_pay.enabled=!1)),this.showpanel()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_pay.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPay,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_pay.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPay,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.CHONGBANG_LIBAO);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t.prototype.onTouchPay=function(){"已达成"!=this.btn_pay.label&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.showpanel=function(){var e=JsonModelManager.instance.getModelchongbanglibao()[DataManager.getInstance().newactivitysManager.chongbangLiBaoId];this.target_title.source=e.imgtitle;var t;t=DataManager.getInstance().newactivitysManager.chargeMoneyNum>=188?GameCommon.getInstance().onParseAwardItemstr(e.rewards300):e.rewards;var n=t[0];this.frist_item.onUpdate(n.type,n.id,0,n.quality,n.num),this.rewards.removeChildren();for(var a=1;a<t.length;a++){n=t[a];var i=new GoodsInstance;i.onUpdate(n.type,n.id,0,n.quality,n.num),this.rewards.addChild(i)}this.avatar_grp.removeChildren(),e.type>=10?this.chongji_zi.source="chongji_recharge_z3_png":this.chongji_zi.source="chongji_recharge_z1_png",this.updateAvatarAnim(e.donghua,e.id)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.updateAvatarAnim=function(e,t){var n="";if(e){for(;this.avatar_grp.numChildren>0;){var a=this.avatar_grp.getChildAt(0);egret.is(a,"BodyAnimation")||egret.is(a,"Animation")?a.onDestroy():this.avatar_grp.removeChild(a)}n=e;var i=new Animation(n);switch(this.avatar_grp.addChild(i),this.avatar_grp.x=-250,this.avatar_grp.y=430,t){case 1:this.avatar_grp.x=-150,this.avatar_grp.y=430;break;case 2:this.avatar_grp.x=-200,this.avatar_grp.y=430;break;case 3:this.avatar_grp.x=-250,this.avatar_grp.y=430;break;case 4:this.avatar_grp.x=-100,this.avatar_grp.y=450;break;case 5:this.avatar_grp.x=-150,this.avatar_grp.y=550;break;case 6:this.avatar_grp.x=-150,this.avatar_grp.y=450;break;case 7:i.scaleX=1.2,i.scaleY=1.2,this.avatar_grp.x=-150,this.avatar_grp.y=450;break;case 8:this.avatar_grp.x=-150,this.avatar_grp.y=450;break;case 9:this.avatar_grp.x=-150,this.avatar_grp.y=550;break;case 10:this.avatar_grp.x=-200,this.avatar_grp.y=450}}else{var o,r=DataManager.getInstance().blessManager,s=JsonModelManager.instance.getModelchongwujinjie()[1];if(10>e)if(DataManager.getInstance().newactivitysManager.chargeMoneyNum<100){for(var h=1;11>h;h++)if(JsonModelManager.instance.getModelfashion()[h].type==e){o=JsonModelManager.instance.getModelfashion()[h];break}}else o=r.getBlessModel(e,19,1);for(this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var a=this.avatar_grp.getChildAt(0);egret.is(a,"BodyAnimation")||egret.is(a,"Animation")?a.onDestroy():this.avatar_grp.removeChild(a)}switch(e){case BLESS_TYPE.HORSE:n="zuoqi_"+o.waixing1;var i=new Animation(n);this.avatar_grp.addChild(i),this.avatar_grp.y=550;break;case BLESS_TYPE.CLOTHES:var l=this.playerData.sex==SEX_TYPE.MALE?"nan":"nv";n="shenzhuang_"+l+"_"+o.waixing1;var g=new Animation(n);this.avatar_grp.addChild(g),this.avatar_grp.y=565;break;case BLESS_TYPE.WEAPON:n="jian"+o.waixing1;var g=new Animation(n);this.avatar_grp.addChild(g);break;case BLESS_TYPE.WING:n=LoadManager.getInstance().getWingResUrl("wing"+o.waixing1,"ride_stand",Direction.DOWN+"");var c=new BodyAnimation(n,-1,Direction.DOWN);this.avatar_grp.addChild(c),this.avatar_grp.y=500;break;case BLESS_TYPE.RING:n="guanghuan_jiemian_"+o.waixing1;var g=new Animation(n,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=400;break;case BLESS_TYPE.RETINUE_HORSE:n="sc_mount"+o.waixing1;var p=new Animation(n);this.avatar_grp.addChild(p),this.avatar_grp.y=430;break;case BLESS_TYPE.RETINUE_CLOTHES:n="sc_role"+o.waixing1;var u=new Animation(n);this.avatar_grp.addChild(u),this.avatar_grp.y=565;break;case BLESS_TYPE.RETINUE_WEAPON:n="weapon"+o.waixing1+"_png";var d=new eui.Image;d.source=n,this.avatar_grp.addChild(d),this.avatar_grp.y=70,this.avatar_grp.x=-300,this.onStartFloatAnim();break;case BLESS_TYPE.RETINUE_WING:n="sc_wing"+o.waixing1;var _=new Animation(n);_.x=30,this.avatar_grp.addChild(_),this.avatar_grp.y=570;break;case BLESS_TYPE.MAGIC:n="sc_magic"+o.waixing1;var g=new Animation(n,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=430;break;case NewactivitysManager.DABIAO_TYPE_REDEQUIP:var m=new eui.Image;m.source="hongzhuangchongbang_png",this.avatar_grp.addChild(m),m.x=-165,this.avatar_grp.addChild(m),this.avatar_grp.y=280;break;case NewactivitysManager.DABIAO_TYPE_SIXIANG:var m=new eui.Image;m.source="sixiangchongbang_png",this.avatar_grp.addChild(m),m.x=-168,this.avatar_grp.addChild(m),this.avatar_grp.y=240;break;case NewactivitysManager.DABIAO_TYPE_MERIDIAN:var m=new eui.Image;m.source="jingmaichongbang_png",this.avatar_grp.addChild(m),m.x=-165,this.avatar_grp.addChild(m),this.avatar_grp.y=280;break;case NewactivitysManager.DABIAO_TYPE_PET:var g=new Animation("petbig"+s.waixing1,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=500;break;case NewactivitysManager.DABIAO_TYPE_JEWEL:var m=new eui.Image;
m.source="baoshichongbang_png",m.x=-135,this.avatar_grp.addChild(m),this.avatar_grp.y=280}}},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t}(BaseTabView);__reflect(ActivitysTargetRechargePanel.prototype,"ActivitysTargetRechargePanel");var ActivitysXianFengPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.GuanQiaXianFengPanelSkin},t.prototype.onInit=function(){this.itemBox.itemRenderer=ActivityXianFengitem,this.itemBox.itemRendererSkinName=skins.GuanQiaXianFengItemSkin,this.itemBox.useVirtualLayout=!0,this.scroller.viewport=this.itemBox,this.datas=[];for(var t in JsonModelManager.instance.getModelguanqiaxianfeng()){var n=new ActXianfengData(parseInt(t));this.datas.push(n)}e.prototype.onInit.call(this),this.onRefreshList(),this.onRefresh()},t.prototype.onRefresh=function(){this.datas.sort(function(e,t){return e.sort-t.sort}),this.itemBox.dataProvider=new eui.ArrayCollection(this.datas),this.stageLab.text=GameFight.getInstance().yewai_waveIndex+""},t.prototype.onRefreshList=function(){for(var e=0;e<this.itemBox.numChildren;e++){var t=this.itemBox.getChildAt(e);t.data=t.data}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_XIANFENG.toString(),this.onRefreshList,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_XIANFENG.toString(),this.onRefreshList,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.GUANQIAXIANFENG);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(ActivitysXianFengPanel.prototype,"ActivitysXianFengPanel");var ActivityXianFengitem=function(e){function t(){var t=e.call(this)||this;return t.point=new redPoint,t}return __extends(t,e),t.prototype.onInit=function(){this.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.point.register(this.buyBtn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"checkRedPoint")},t.prototype.onUpdate=function(){var e=this.data,t=e.model.rewards[0];this.item.onUpdate(t.type,t.id,0,t.quality,t.num,t.lv),e.received?(this.buyBtn.enabled=!1,this.buyBtn.label="已领取"):e.model.mapId>GameFight.getInstance().yewai_waveIndex?(this.buyBtn.enabled=!1,this.buyBtn.label="未达成"):(this.buyBtn.enabled=!0,this.buyBtn.label="领取"),this.nameLab.text="达到"+e.model.mapId+"关",this.point.checkPoint()},t.prototype.onTouchBtn=function(){var e=new Message(MESSAGE_ID.ACTIVITY_XIANFENG);e.setShort(this.data.id),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.checkRedPoint=function(){return this.buyBtn.enabled},t}(BaseListItem);__reflect(ActivityXianFengitem.prototype,"ActivityXianFengitem");var ActXianfengData=function(){function e(e){this.id=e}return Object.defineProperty(e.prototype,"model",{get:function(){return JsonModelManager.instance.getModelguanqiaxianfeng()[this.id]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"received",{get:function(){return 1==DataManager.getInstance().newactivitysManager.xianfengReward[this.id-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sort",{get:function(){var e=Tool.toInt(this.id);return this.received&&(e+=100),e},enumerable:!0,configurable:!0}),e}();__reflect(ActXianfengData.prototype,"ActXianfengData");var ActivitysXiangouPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XiangouPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.itemBox.numChildren>0&&this.itemBox.removeChildren();var e,t=[],n=JsonModelManager.instance.getModelxiangoulibao();for(var a in n){var i=n[a];i.round==DataManager.getInstance().newactivitysManager.activitysday&&(e=new ActivityitemFace(i),t.push(e))}t.sort(function(e,t){return e.sort-t.sort});for(var o=0;o<t.length;o++)this.itemBox.addChild(t[o]);this.onUpdateCurrency()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.XIANGOULIBAO);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onUpdateCurrency=function(){this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.GOLD,0,-1)),this.gold.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.DIAMOND,0,-1))},t.prototype.onxiangouBuyover=function(){this.onRefresh()},t}(BaseTabView);__reflect(ActivitysXiangouPanel.prototype,"ActivitysXiangouPanel");var ActivityitemFace=function(e){function t(t){var n=e.call(this)||this;return n.itemarrdate=[],n.isOver=!1,n.point=new redPoint,n._data=t,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.skinName=skins.SpecialgiftbagPanel,n}return __extends(t,e),t.prototype.onLoadComplete=function(){this.update(this._data)},t.prototype.update=function(e){this._data=e;var t=[],n=[];this.zhekou.source="save"+e.zhekou+"_png",t=this._data.rewards,n=GameCommon.getInstance().onParseAwardItemstr(this._data.price),this.itemarrdate=t;var a={};a=DataManager.getInstance().newactivitysManager.xiangoudate;var i=0;a[this._data.id]?(i=a[this._data.id][1],i>=this._data.max?(this.buyBtn.enabled=!1,this.buyBtn.label="已购买",this.isOver=!0):this.buyBtn.enabled=!0):DataManager.getInstance().playerManager.player.viplevel>=this._data.vip?this.buyBtn.enabled=!0:this.buyBtn.enabled=!1;for(var o=0;o<t.length;o++){var r=new GoodsInstance;r.onUpdate(t[o].type,t[o].id,0,t[o].quality,t[o].num,t[o].lv),r.scaleX=.7,r.scaleY=.7,this.itembox.addChild(r)}this.nameLab.text=this._data.name+"("+i+"/"+this._data.max+")",this.consume.data=new CurrencyParam("",new ThingBase(n[0].type,0,n[0].num)),this.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.point.register(this.buyBtn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"checkRedPoint")},t.prototype.onTouchBtn=function(){var e=new Message(MESSAGE_ID.XIANGOULIBAO_BUY_MESSAGE);e.setShort(this._data.id),e.setShort(1),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"sort",{get:function(){var e=Tool.toInt(this._data.vip);return this.isOver&&(e+=100),e},enumerable:!0,configurable:!0}),t.prototype.checkRedPoint=function(){if(this.buyBtn.enabled){var e=GameCommon.getInstance().onParseAwardItemstr(this._data.price);return DataManager.getInstance().playerManager.player.getICurrency(e[0].type)>=e[0].num}return!1},t}(eui.Component);__reflect(ActivityitemFace.prototype,"ActivityitemFace");var LianXuLeiChongPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.btns=[300,2e3,5e3],n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LianXuLeiChongSkin,this.setTitle("lianchongTitle_png")},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.itemGroup.itemRenderer=ActivityLeiChongItem,this.itemGroup.itemRendererSkinName=skins.ActivityLeiChongItemSkin,this.itemGroup.useVirtualLayout=!0,this.index=1,this.tab1.source="leiChong_buttonon_png",this.timeLab.text="0天0时0分0",this.onRefresh()},t.prototype.onRefresh=function(){this.onShowAward()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=1;4>t;t++)this["tabBtn"+t].name=t,this["tabBtn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!1)},t.prototype.onShowAward=function(){this.leichongDesc.source="leichongDesc"+this.index+"1_png",this.itemGroup.dataProvider=new eui.ArrayCollection(this.models),this.showdate()},t.prototype.onTab=function(e){var t=Number(e.target.name);if(this.index!=t){for(var n=1;4>n;n++)this["tab"+n].source="leiChong_buttonoff_png";this.index=t,this["tab"+this.index].source="leiChong_buttonon_png",this.onShowAward()}},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=JsonModelManager.instance.getModellianxuleichong();for(var t in e)if(e[t].gold==this.btns[this.index-1])for(var n,a=1;6>a;a++){n=GameCommon.getInstance().onParseAwardItemstr(e[t]["reward"+a]);var i=new OpenServerLeiChongItemData(n,e[t].gold/10,a,DataManager.getInstance().lianxuChongManager.allMoney[e[t].id-1]);this.rewardArr.push(i)}return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.showdate=function(){this.toDayMoney.text="今日已累计充值:"+DataManager.getInstance().lianxuChongManager.todayMoney;for(var e=this.rewardArr[this.rewardArr.length-1].awardItem;this.box.numChildren>0;){var t=this.box.getChildAt(0);this.box.removeChild(t)}for(var n=0;1>n;n++)this.goods=new GoodsInstance,this.goods.onUpdate(e[n].type,e[n].id,0,e[n].quality,e[n].num),this.goods.item_frame.source="welfare_frame_png",this.box.addChild(this.goods)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LIANXU_LEICHONG);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseWindowPanel);__reflect(LianXuLeiChongPanel.prototype,"LianXuLeiChongPanel");var ActivityCDKPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityJihuomaSkin},t.prototype.oninit=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_send.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t.prototype.onTouchBtnSend=function(){var e=SDKManager.loginInfo.url+"/cdkey/invoke?account="+SDKManager.loginInfo.account+"&server="+SDKManager.loginInfo.serverId+"&channelType="+SDKManager.loginInfo.channel+"&subChannel="+SDKManager.loginInfo.subChannel+"&platform="+SDKManager.loginInfo.platform+"&playerId="+SDKManager.loginInfo.playerId+"&cdKey="+this.label_input.text+".do";HttpUtil.sendGetRequest(e,this.onCDkeyComplete,this)},t.prototype.onCDkeyComplete=function(e){var t=e.currentTarget,n=JSON.parse(t.response);switch(parseInt(n)){case 0:GameCommon.getInstance().addAlert("兑换成功，奖励以通过邮件下发");break;case-2:GameCommon.getInstance().addAlert("未知用户");break;case-3:GameCommon.getInstance().addAlert("未知服务器");break;case-4:GameCommon.getInstance().addAlert("兑换码错误");break;case-5:GameCommon.getInstance().addAlert("渠道不符");break;case-6:GameCommon.getInstance().addAlert("过期");break;case-7:GameCommon.getInstance().addAlert("操作失败");break;case-8:GameCommon.getInstance().addAlert("兑换码已使用");break;case-9:GameCommon.getInstance().addAlert("已使用同类激活码");break;case-10:GameCommon.getInstance().addAlert("已领取过该礼包");break;case-11:GameCommon.getInstance().addAlert("无法在本服使用")}this.label_input.text=""},t}(BaseTabView);__reflect(ActivityCDKPanel.prototype,"ActivityCDKPanel");var ActivityCoatardPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityCoatardSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.coatard_scroller.scrollPolicyH="false",this.allItem=[];var t=JsonModelManager.instance.getModelzhuanshengrewards();for(var n in t)if(t[n].rewards&&t[n].rewards.length>0){var a=new ActivityCoatardItem(t[n]);this.allItem.push(a)}this.points=RedPointManager.createPoint(this.allItem.length);for(var i=0;i<this.allItem.length;i++)this.points[i].register(this.allItem[i].btn_reward,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this.allItem[i],"checkRedPoint");this.showpanel()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.showpanel(),this.trigger()},t.prototype.showpanel=function(){for(var e=0;e<this.allItem.length;e++)this.allItem[e].updateItem();this.allItem.sort(function(e,t){return e.sort-t.sort}),this.coatard_items.removeChildren();for(var e=0;e<this.allItem.length;e++)this.allItem[e].getRewardStatus()||this.coatard_items.addChild(this.allItem[e]);this.label_cur_coatard.text=this.playerData.coatardLv+"转"},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoto,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_COATARD_REWARD.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_goto.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoto,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_COATARD_REWARD.toString(),this.onRefresh,this)},t.prototype.onGoto=function(){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_JINGJIE)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_JINGJIE)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(ActivityCoatardPanel.prototype,"ActivityCoatardPanel");var ActivityCoatardItem=function(e){function t(t){var n=e.call(this)||this;return n.received=!1,n.model=t,n.isLoadingFinish=!1,n.once(egret.Event.COMPLETE,n.onInit,n),n.skinName=skins.ActivityCoatardItemSkin,n}return __extends(t,e),t.prototype.onInit=function(){this.isLoadingFinish=!0,this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this),this.updateItem()},t.prototype.updateItem=function(){if(this.isLoadingFinish){var e=DataManager.getInstance().playerManager.player.coatardLv;this.awards.removeChildren();for(var t=0;t<this.model.rewards.length;t++){var n=this.model.rewards[t],a=GameCommon.getInstance().createGoodsIntance(n);this.awards.addChild(a)}this.name_label.text=this.model.id+"转礼包";var i=DataManager.getInstance().playerManager.getCoatardRewardStatus(this.model.id-1);i?(this.btn_reward.label="已领取",this.btn_reward.enabled=!1,this.received=!0):this.model.id>e?(this.btn_reward.label="未完成",this.btn_reward.enabled=!1,this.received=!1):(this.btn_reward.label="领取",this.btn_reward.enabled=!0,this.received=!1)}},t.prototype.onTouchButton=function(){if(this.isLoadingFinish){var e=new Message(MESSAGE_ID.ACTIVITY_COATARD_REWARD);e.setByte(this.model.id),GameCommon.getInstance().sendMsgToServer(e)}},Object.defineProperty(t.prototype,"sort",{get:function(){if(this.isLoadingFinish){var e=Tool.toInt(this.model.id);return this.received&&(e+=100),0}},enumerable:!0,configurable:!0}),t.prototype.checkRedPoint=function(){return this.isLoadingFinish?0==this.received&&1==this.btn_reward.enabled:!1},t.prototype.getRewardStatus=function(){return DataManager.getInstance().playerManager.getCoatardRewardStatus(this.model.id-1)},t}(eui.ItemRenderer);__reflect(ActivityCoatardItem.prototype,"ActivityCoatardItem");var ActivityNoticePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityNoticeSkin},t.prototype.onInit=function(){this.notice_scroller.verticalScrollBar.autoVisibility=!1,this.notice_scroller.verticalScrollBar.visible=!1,this.onLoadingNotice(),this.onRegist(),this.onRefresh()},t.prototype.onLoadingNotice=function(){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXT,e.addEventListener(egret.Event.COMPLETE,this.onLoadNoticeComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this);var t="",n=Math.random();if(SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&(t=ChannelDefine.cdnUrl+"resource/assets/notice/fangkuaiwan.txt?v="+n),""!=t){this.setGameNotice("<font color='#FFFF00' size='26'>公告正在加载中...</font>");var a=new egret.URLRequest(t);e.load(a)}else this.onHide()},t.prototype.onLoadNoticeComplete=function(e){var t=e.target,n=t.data;this.setGameNotice(GameCommon.getInstance().readStringToHtml(n))},t.prototype.onLoadError=function(){this.setGameNotice("公告内容暂无！")},t.prototype.setGameNotice=function(e){this.notice_label.lineSpacing=5,this.notice_label.textFlow=(new egret.HtmlTextParser).parser(e)},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseTabView);__reflect(ActivityNoticePanel.prototype,"ActivityNoticePanel");var ActivityPayGiftPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityPayGiftSkin},t.prototype.onInit=function(){this.giftlist_grp.itemRenderer=PayGiftItem,this.giftlist_grp.itemRendererSkinName=skins.PayGiftItemSkin,this.giftlist_grp.useVirtualLayout=!0,this.scroll.viewport=this.giftlist_grp;for(var e,t=GameCommon.getInstance().onParseAwardItemstr(ActivityDefine.GIFTTOP),n=0;n<t.length;n++)e=new GoodsInstance,e.onUpdate(t[n].type,t[n].id,0,t[n].quality,t[n].num),this.top_reward.addChild(e);GameCommon.getInstance().addUnderlineStr(this.status_goto),this.onRefresh()},t.prototype.onRefresh=function(){var e,t=[];for(var n in JsonModelManager.instance.getModelleichonghaoli())e=JsonModelManager.instance.getModelleichonghaoli()[n],t.push(e);this.giftlist_grp.dataProvider=new eui.ArrayCollection(t);var a=DataManager.getInstance().newactivitysManager.payDays;this.progress_label.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml("已累计充值[#FCC41E"+a+"]天"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.status_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoLabel,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.status_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoLabel,this)},t.prototype.onTouchGotoLabel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseTabView);__reflect(ActivityPayGiftPanel.prototype,"ActivityPayGiftPanel");var PayGiftItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;this.awards_grp.removeChildren();for(var t=0;t<e.rewards.length;t++){var n=e.rewards[t],a=new GoodsInstance;a.onUpdate(n.type,n.id,0,n.quality,n.num),this.awards_grp.addChild(a)}var i=DataManager.getInstance().newactivitysManager.payDays;i<e.day?this.desc_label.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml("累计充值[#FCC41E"+e.day+"]天")):this.desc_label.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml("[#FFFF00已达成]"))},t.prototype.onTouchGotoLabel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseListItem);__reflect(PayGiftItem.prototype,"PayGiftItem");var ActivityYaoqianshuPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.maxnum=5,n.animPos2=new egret.Point(344,650),n.animPos=new egret.Point(0,0),n.erjiarr=[[4,0,1e7],[4,0,1e7],[4,0,1e7]],n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityyaoqianshuPanel},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.points[0].register(this.lingqvBtn,new egret.Point(155,-10),DataManager.getInstance().newactivitysManager,"checkRedPointForYao1000"),SDKManager.isHidePay?this.btnLab.visible=!1:GameCommon.getInstance().addUnderlineStr(this.btnLab),this.awards=[];var t,n=Constant.get("GOLD_TREE_REWARD");n.indexOf("#")>=0&&(t=n.split("#"));for(var a=0;a<t.length;a++){var i=t[a].split(",");this.awards.push(i)}this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.isAction=!1;var t=this.getPlayerData(),n=JsonModelManager.instance.getModelvip()[t.viplevel-1];if(n){var a,i=n.weals;i.indexOf("#")>=0&&(a=i.split("#"));for(var o=0;o<a.length;o++){var r=a[o].split(",");if("5"==r[0]){this.maxnum=Number(r[1]);break}}}else this.maxnum=Number(Constant.get("GOLD_TREE_NUM"));this.showpanel()},t.prototype.showpanel=function(){DataManager.getInstance().playerManager.player.viplevel;if(this.yaoqianshusever=DataManager.getInstance().newactivitysManager.yaoqian1000,this.yaoqianshudate=DataManager.getInstance().newactivitysManager.yaoqianshuXmldate,this.baoji=DataManager.getInstance().newactivitysManager.yaoqianshuBoom,1==this.baoji&&(GameCommon.getInstance().addAnimation("baoji1",this.animPos2,this),this.baoji=0),this.yaoqianshusever.yaoqianshuindex<55){var e=Number(this.yaoqianshudate[this.yaoqianshusever.yaoqianshuindex+1][0].gold);this.numLab.text=e+"",this.xiaohaoLab.text=""+Number(this.yaoqianshudate[this.yaoqianshusever.yaoqianshuindex+1][0].cost.num)}else{var e=Number(this.yaoqianshudate[this.yaoqianshusever.yaoqianshuindex][0].gold);this.numLab.text=e+"",this.xiaohaoLab.text=""+Number(this.yaoqianshudate[this.yaoqianshusever.yaoqianshuindex][0].cost[0].num)}this.maxLab.text="今日使用："+this.yaoqianshusever.yaoqianshuindex+"/"+this.maxnum,this.jindudata(),this.trigger()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.yaoOneyao.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onyaoOneyao,this),this.btnLab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onchongzhi,this),this.lingqvBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.lingqv,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YAOQIANSHU_YAOQIAN.toString(),this.onyaoqianover,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YAOQIANSHU_LINGJIANG.toString(),this.lingjiangover,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.yaoOneyao.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onyaoOneyao,this),this.btnLab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onchongzhi,this),this.lingqvBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.lingqv,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.YAOQIANSHU_YAOQIAN.toString(),this.onyaoqianover,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.YAOQIANSHU_LINGJIANG.toString(),this.lingjiangover,this)},t.prototype.lingjiangover=function(){this.showpanel()},t.prototype.lingqv=function(){var e=new Message(MESSAGE_ID.YAOQIANSHU_LINGJIANG);e.setByte(this.lingjiang),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.jinboxdate=function(){this.yaoqianshusever.yaoqianshuindex>=50?this.lingqvBtn.enabled=!0:this.lingqvBtn.enabled=!1,this.itembox.numChildren>0&&this.itembox.removeChildren(),-1!=this.yaoqianshusever.lingjiangarr.indexOf(2)?(this.lingqvBtn.enabled=!1,this.lingqvBtn.label="已领取"):(this.lingqvBtn.enabled=!0,this.lingqvBtn.label="领取");for(var e=0;3>e;e++){var t=new GoodsInstance;t.onUpdate(Number(this.awards[2][1]),Number(this.awards[2][2]),0,-1,Number(this.awards[2][3])/3),t.scaleX=.9,t.scaleY=.9,this.itembox.addChild(t)}this.progress1.maximum=this.awards[2][0],this.progress1.value=this.yaoqianshusever.yaoqianshuindex,this.lingjiang=2},t.prototype.yinboxdate=function(){this.yaoqianshusever.yaoqianshuindex>=20?this.lingqvBtn.enabled=!0:this.lingqvBtn.enabled=!1,this.itembox.numChildren>0&&this.itembox.removeChildren(),-1!=this.yaoqianshusever.lingjiangarr.indexOf(1)?(this.lingqvBtn.enabled=!1,this.lingqvBtn.label="已领取"):(this.lingqvBtn.enabled=!0,this.lingqvBtn.label="领取");for(var e=0;3>e;e++){var t=new GoodsInstance;t.onUpdate(Number(this.awards[1][1]),Number(this.awards[1][2]),0,-1,Number(this.awards[1][3])/3),t.scaleX=.9,t.scaleY=.9,this.itembox.addChild(t)}this.progress1.maximum=this.awards[1][0],this.progress1.value=this.yaoqianshusever.yaoqianshuindex,this.lingjiang=1},t.prototype.muboxdate=function(){this.yaoqianshusever.yaoqianshuindex>=5?this.lingqvBtn.enabled=!0:this.lingqvBtn.enabled=!1,this.itembox.numChildren>0&&this.itembox.removeChildren(),-1!=this.yaoqianshusever.lingjiangarr.indexOf(0)?(this.lingqvBtn.enabled=!1,this.lingqvBtn.label="已领取"):(this.lingqvBtn.enabled=!0,this.lingqvBtn.label="领取");for(var e=0;3>e;e++){var t=new GoodsInstance;t.onUpdate(Number(this.awards[0][1]),Number(this.awards[0][2]),0,-1,Number(this.awards[0][3])/3),t.scaleX=.9,t.scaleY=.9,this.itembox.addChild(t)}this.progress1.maximum=this.awards[0][0],this.progress1.value=this.yaoqianshusever.yaoqianshuindex,this.lingjiang=0},t.prototype.jindudata=function(){this.yaoqianshusever.lingjiangarr?-1!=this.yaoqianshusever.lingjiangarr.indexOf(2)?this.jinboxdate():-1!=this.yaoqianshusever.lingjiangarr.indexOf(1)?this.jinboxdate():-1!=this.yaoqianshusever.lingjiangarr.indexOf(0)?this.yinboxdate():this.muboxdate():this.muboxdate()},t.prototype.onyaoqianover=function(){this.actionInit(),this.showpanel()},t.prototype.actionInit=function(){this.isAction=!0;var e=100,t=egret.Tween.get(this.penzi),n=this;this.penzi.rotation=-4,t.to({rotation:5},e),t.to({rotation:-7},e),t.to({rotation:3},e),t.to({rotation:-9},e),t.to({rotation:5},e),t.to({rotation:-5},e),t.call(function(){egret.Tween.removeTweens(n.penzi),n.actionDown()},this)},t.prototype.actionDown=function(){var e=this,t=egret.Tween.get(this.penzi);t.to({rotation:0},100),t.call(function(){egret.Tween.removeTweens(e.penzi),e.resetUI()},this)},t.prototype.resetUI=function(){GameCommon.getInstance().addAnimation("jubaopen",null,this.best_anim_grp),this.isAction=!1},t.prototype.onyaoOneyao=function(){if(!this.isAction){var e=new Message(MESSAGE_ID.YAOQIANSHU_YAOQIAN);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onchongzhi=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseTabView);__reflect(ActivityYaoqianshuPanel.prototype,"ActivityYaoqianshuPanel");var ActivityYuekaPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.group1Pos=[50,290,.9,.9,1],n.group2Pos=[110,250,1,1,3],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityyuekaSkin},t.prototype.onInit=function(){this.viewmask=new egret.Shape,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.5),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,this.stage.stageWidth,this.stage.stageHeight),this.viewmask.graphics.endFill(),this.tips_mask1.addChild(this.viewmask),this.tips_mask1.setChildIndex(this.viewmask,0),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.yuekafunc,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.superCard,this),this.btn_pageDown.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPage,this),this.btn_pageUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPage,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MONTHCARD_MESSAGE.toString(),this.onRefresh,this),SDKManager.getChannel()==EChannel.CHANNEL_EGRET&&SDKEgret.getInstance().isIOS22698()&&(this.btn1.label="30元抢购")},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.yuekafunc,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.superCard,this),this.btn_pageDown.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPage,this),this.btn_pageUp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPage,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MONTHCARD_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onPage=function(){this.isAction||(this.isAction=!0,this.actionInit())},t.prototype.actionInit=function(){var e=egret.Tween.get(this.group1),t=egret.Tween.get(this.group2);this.group1.x==this.group1Pos[0]?(e.to({scaleX:.95,scaleY:.95},150).wait(0).call(this.onCall1,this),t.to({scaleX:.95,scaleY:.95},150).wait(0).call(this.onCall1,this),e.to({x:this.group2Pos[0],y:this.group2Pos[1],scaleX:this.group2Pos[3],scaleY:this.group2Pos[3]},300),t.to({x:this.group1Pos[0],y:this.group1Pos[1],scaleX:this.group1Pos[3],scaleY:this.group1Pos[3]},300)):(e.to({scaleX:.95,scaleY:.95},150).wait(0).call(this.onCall,this),t.to({scaleX:.95,scaleY:.95},150).wait(0).call(this.onCall,this),e.to({x:this.group1Pos[0],y:this.group1Pos[1],scaleX:this.group1Pos[3],scaleY:this.group1Pos[3]},300),t.to({x:this.group2Pos[0],y:this.group2Pos[1],scaleX:this.group2Pos[3],scaleY:this.group2Pos[3]},300));var n=this;e.wait(100),e.call(function(){egret.Tween.removeTweens(n.group1),n.actionDown()},this)},t.prototype.onCall1=function(){this.group1.parent.setChildIndex(this.group1,this.group2Pos[4]),this.group2.parent.setChildIndex(this.group2,this.group1Pos[4])},t.prototype.onCall=function(){this.group1.parent.setChildIndex(this.group1,this.group1Pos[4]),this.group2.parent.setChildIndex(this.group2,this.group2Pos[4])},t.prototype.actionDown=function(){var e=this,t=egret.Tween.get(this.group1);t.to({rotation:0},100),t.call(function(){egret.Tween.removeTweens(e.group1),e.resetUI()},this)},t.prototype.resetUI=function(){this.isAction=!1},t.prototype.onRefresh=function(){this.isAction=!1;var e=DataManager.getInstance().monthCardManager.card[1];this.label_monthCard.text="",this.label_monthCard0.text="",e&&e.param>0&&(this.btn1.label="已激活",this.btn1.enabled=!1,this.btn1.touchEnabled=!1,this.btn1.touchChildren=!1,this.label_monthCard.text="月卡已激活，剩余"+e.day+"天"),e=DataManager.getInstance().monthCardManager.card[2],e&&e.param>0&&(this.btn2.label="已激活",this.btn2.enabled=!1,this.btn2.touchEnabled=!1,this.btn2.touchChildren=!1,this.label_monthCard0.text="超级卡已激活，剩余"+e.day+"天")},t.prototype.yuekafunc=function(){var e=28,t="超值月卡";SDKManager.pay({goodsName:t,amount:e,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))},t.prototype.superCard=function(){var e=88,t="至尊月卡";SDKManager.pay({goodsName:t,amount:e,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))},t.prototype.cardGift=function(){var e=new Message(MESSAGE_ID.MONTHLY_CARD_REWARD);e.setByte(CARD_TYPE.MONTH),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.superCardGift=function(){var e=new Message(MESSAGE_ID.MONTHLY_CARD_REWARD);e.setByte(CARD_TYPE.LIFELONG),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(ActivityYuekaPanel.prototype,"ActivityYuekaPanel");var RebateManager=function(){function e(){this.record={},this.qianbei_record={}}return e.prototype.parseMessage=function(e){this.record={};for(var t,n=e.getByte(),a=0;n>a;a++)t=e.getByte(),this.record[t]=t},e.prototype.parseQianbeiMessage=function(e){this.qianbei_record={};
for(var t,n=e.getByte(),a=0;n>a;a++)t=e.getByte(),this.qianbei_record[t]=t},e.prototype.parseBuyMessage=function(e){e.getByte(),e.getInt()},e}();__reflect(RebateManager.prototype,"RebateManager");var ActivityZhongqiuDan=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.type=ZHUANPAN_TYPE.dan,this.skinName=skins.ActivityZhongqiuDan},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.groups=[this.group0,this.group1],this.imgRockers=[this.imgRocker0,this.imgRocker1];var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.initItemList=function(){this.rewards=this.getCurrModel().rewards;for(var e=.9,t=0;4>t;t++){var n=GameCommon.getInstance().createGoodsIntance(this.rewards[t]);n.x=this.groups[0].width/2,n.y=120*t*e,this.groups[0].addChild(n),n.anchorOffsetX=n.width/2,n.scaleX=n.scaleY=e;var a=GameCommon.getInstance().createGoodsIntance(this.rewards[t+4]);a.x=this.groups[1].width/2,a.y=120*t*e,this.groups[1].addChild(a),a.anchorOffsetX=a.width/2,a.scaleX=a.scaleY=e}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeEffect()},t.prototype.onDealRocker=function(){var e=20,t=50,n=egret.Tween.get(this.imgRockers[0]);n.to({rotation:e},t),n.to({rotation:-e},2*t),n.to({rotation:e/2},1.5*t),n.to({rotation:-e/2},t),n.to({rotation:0},t/2);var a=this;n.call(function(){egret.Tween.removeTweens(a.imgRockers[0]),a.openEffect()},this)},t.prototype.openEffect=function(){this.mountBody=new Animation("zadan_01"),this.mountBody.autoRemove=!1,this.mountBody.playNum=1,this.mountBody.playFinishCallBack(this.onActionFinish,this),this.groupEffect.addChild(this.mountBody),this.mountBody.x=this.groupEffect.width/2,this.mountBody.y=this.groupEffect.height/2},t.prototype.closeEffect=function(){this.mountBody&&(this.mountBody.onStop(),this.groupEffect.removeChild(this.mountBody),this.mountBody=null)},t.prototype.onActionFinish=function(){this.closeEffect(),this.setActionState(1),this.onRewardShow()},t.prototype.onCloseAwdShow=function(){e.prototype.onCloseAwdShow.call(this),this.resetUI()},t.prototype.resetUI=function(){e.prototype.resetUI.call(this),this.setActionState(0),this.imgRockers[0].rotation=0},t.prototype.setActionState=function(e){for(var t=0;t<this.imgRockers.length;++t)this.imgRockers[t].visible=e==t,this.imgRockers[t].visible=e==t},t}(ActivityZhongqiuBase);__reflect(ActivityZhongqiuDan.prototype,"ActivityZhongqiuDan");var ActivityZhongqiuDraw=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.type=ZHUANPAN_TYPE.draw,this.skinName=skins.ActivityZhongqiuDraw},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.groups=[this.group0,this.group1],this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.initItemList=function(){this.rewards=this.getCurrModel().rewards;for(var e=120,t=0;t<this.rewards.length;t++){var n=GameCommon.getInstance().createGoodsIntance(this.rewards[t]);n.y=Math.floor(t%8/2)*e,t%2==0?(n.x=158*Math.floor(t/8),this.groups[0].addChild(n)):(n.x=-158*Math.floor(t/8),this.groups[1].addChild(n))}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onDealRocker=function(){this.onRewardShow()},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e),this.actionInit()},t.prototype.actionInit=function(){this.rect.visible=this.lbAlert.visible=!1,this.imgZhong.visible=!0;var e=.1,t=300,n=312;this.showAwardGroup.scaleX=this.showAwardGroup.scaleY=e,this.showAwardGroup.y=n;var a=egret.Tween.get(this.showAwardGroup),i=this;a.to({scaleX:-(e+.1),scaleY:e+.1},t),a.to({scaleX:e+.2,scaleY:e+.2},t),a.to({scaleX:-(e+.3),scaleY:e+.3},t),a.to({scaleX:e+.4,scaleY:e+.4},t),a.wait(300),a.call(function(){egret.Tween.removeTweens(i.showAwardGroup),i.actionDown()},this)},t.prototype.actionDown=function(){this.imgZhong.visible=!1;var e=this,t=egret.Tween.get(this.showAwardGroup);t.to({y:444,scaleX:.6,scaleY:.6},300),t.call(function(){egret.Tween.removeTweens(e.showAwardGroup),e.lbAlert.visible=e.rect.visible=!0,e.resetUI()},this)},t}(ActivityZhongqiuBase);__reflect(ActivityZhongqiuDraw.prototype,"ActivityZhongqiuDraw");var ActivityZhongqiuPoker=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.type=ZHUANPAN_TYPE.poker,this.skinName=skins.ActivityzhongqiuPoker},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.imgRockers=[this.imgRocker0,this.imgRocker1,this.imgRocker2];var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.onActionInit()},t.prototype.onDealRocker=function(){var e=500;this.onActionRun(this.imgRockers[0],this.imgRockers[1].x-200,e),this.onActionRun(this.imgRockers[2],this.imgRockers[1].x+200,e,!0)},t.prototype.onActionRun=function(e,t,n,a){void 0===a&&(a=!1);var i=this,o=egret.Tween.get(e);o.to({x:this.imgRockers[1].x,y:this.imgRockers[1].y,rotation:this.imgRockers[1].rotation},n),o.to({x:t},n),o.call(function(){a&&i.onActionShow(Tool.randomInt(0,3),n)},this)},t.prototype.setLayer=function(e){void 0===e&&(e=-1);for(var t=0,n=0;n<this.imgRockers.length;++n)e!=n&&(this.imgRockers[n].parent.setChildIndex(this.imgRockers[n],t),++t);-1!=e&&this.imgRockers[e].parent.setChildIndex(this.imgRockers[e],t)},t.prototype.onActionShow=function(e,t,n){void 0===n&&(n=50),this.setLayer(e);var a=this,i=this.imgRockers[1].x,o=470,r=Math.floor(this.imgRockers[e].x+(i-this.imgRockers[e].x)/3*2),s=Math.floor(this.imgRockers[e].y+(o-this.imgRockers[e].y)/3*2),h=egret.Tween.get(this.imgRockers[e]);h.wait(n),h.to({x:r,y:s,scaleX:-1},t),h.to({x:i,y:o,scaleX:0},t/2),h.call(function(){a.imgRockers[e].visible=!1,a.onActionFinish()},this)},t.prototype.onActionFinish=function(){for(var e=0;e<this.imgRockers.length;++e)egret.Tween.removeTweens(this.imgRockers[e]);this.onRewardShow()},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e);var t=this;this.rect.visible=this.lbAlert.visible=!1,this.showAwardGroup.scaleX=0;var n=egret.Tween.get(this.showAwardGroup);n.to({scaleX:1},500),n.call(function(){egret.Tween.removeTweens(t.showAwardGroup),t.rect.visible=t.lbAlert.visible=!0,t.resetUI()},this)},t.prototype.onActionInit=function(){var e=300,t=300;this.imgRockers[1].x=t,this.imgRockers[1].y=e,this.imgRockers[1].rotation=0,this.imgRockers[1].scaleX=1,this.imgRockers[1].visible=!0,this.imgRockers[0].x=t-50,this.imgRockers[0].y=e+12,this.imgRockers[0].rotation=-15,this.imgRockers[0].scaleX=1,this.imgRockers[0].visible=!0,this.imgRockers[2].x=t+50,this.imgRockers[2].y=e+12,this.imgRockers[2].rotation=15,this.imgRockers[2].scaleX=1,this.imgRockers[2].visible=!0,this.setLayer()},t.prototype.onCloseAwdShow=function(){this.isAction||(e.prototype.onCloseAwdShow.call(this),this.onActionInit())},t.prototype.initItemList=function(){this.rewards=this.getCurrModel().rewards;for(var e=.65,t=90,n=8,a=(this.groupItem.width-t*e*this.rewards.length-n*(this.rewards.length-1))/2,i=0;i<this.rewards.length;i++){var o=GameCommon.getInstance().createGoodsIntance(this.rewards[i]);o.x=a-10,o.y=30,this.groupItem.addChild(o),o.scaleX=o.scaleY=e,a+=t*e+n}},t}(ActivityZhongqiuBase);__reflect(ActivityZhongqiuPoker.prototype,"ActivityZhongqiuPoker");var ActivityZhongqiuTurntable=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.type=ZHUANPAN_TYPE.turntable,this.skinName=skins.ActivityZhongqiuTurntable},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.initItemList=function(){this.rewards=this.getCurrModel().rewards;for(var e=0;8>e;++e){var t=GameCommon.getInstance().createGoodsIntance(this.rewards[e]);t.x=this.groupRound.width/2,t.y=this.groupRound.height/2,t.anchorOffsetX=t.width/2,t.anchorOffsetY=250,t.scaleX=t.scaleY=.6,this.groupRound.addChild(t),t.rotation=-45*e,t.num_label.text="",t.name_label.text=this.rewards[e].num.toString(),t.name_label.size=34,t.name_label.textColor=GameCommon.getInstance().CreateNameColer(t.model.quality)}},t.prototype.getRewardIdx=function(){for(var e=this.zqManager.itemList[0].itemType,t=this.zqManager.itemList[0].itemId,n=this.zqManager.itemList[0].itemCount,a=0;a<this.rewards.length;++a)if(e==this.rewards[a].type&&t==this.rewards[a].id&&n==this.rewards[a].num)return a%8;return 0},t.prototype.onDealRocker=function(){var e=egret.Tween.get(this.groupRound),t=500,n=1440+45*this.getRewardIdx();e.to({rotation:n},2e3),e.to({rotation:n+360},t+100);var a=this;e.call(function(){egret.Tween.removeTweens(a.groupRound),a.runFinish()},this)},t.prototype.resetUI=function(){e.prototype.resetUI.call(this),this.groupRound.rotation=this.groupRound.rotation%360},t.prototype.runFinish=function(){this.onRewardShow(),this.resetUI()},t}(ActivityZhongqiuBase);__reflect(ActivityZhongqiuTurntable.prototype,"ActivityZhongqiuTurntable");var ActivityZQManager=function(){function e(){this.payMoney=0,this.surplusMoney=0,this.currModels=[],this.itemInfos1=[],this.itemInfos10=[];var e=JsonModelManager.instance.getModelfeastzhuanpan();for(var t in e){this.currModels[e[t].type]=e[t];var n=e[t].cost;this.itemInfos1[e[t].type]=[n.type,n.id,n.num];var a=e[t].costTen.split(",");this.itemInfos10[e[t].type]=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2])]}this.costMoney=parseInt(Constant.get("ZHONGQIU_CHONGZHI")),this.rewardItems=GameCommon.getInstance().onParseAwardItemstr(Constant.get("ZHONGQIU_CHONGZHIREWARDS"))}return e.prototype.parseInit=function(e){this.surplusMoney=e.getInt()},e.prototype.parseGet=function(e){this.surplusMoney=e.getInt(),this.payMoney=e.getInt(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseRun=function(e){if(this.itemList=null,this.conType=e.getByte(),this.conType>0){this.itemList=[];for(var t=0;t<this.conType;++t)this.itemList[t]=new ItemBody,this.itemList[t].parseMsg(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getZhongQiuData=function(){var e=new Message(MESSAGE_ID.ACT_FEAST_GET_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.getRewardItem=function(){return this.itemList?new AwardItem(this.itemList[0].itemType,this.itemList[0].itemId,this.itemList[0].itemCount):null},e.prototype.getRewardItemList=function(){if(!this.itemList)return null;for(var e=[],t=0;t<this.itemList.length;++t)e.push(new AwardItem(this.itemList[t].itemType,this.itemList[t].itemId,this.itemList[t].itemCount));return e},e.prototype.getItemInfos=function(e){return void 0===e&&(e=1),1>=e?this.itemInfos1:this.itemInfos10},e.prototype.getGoodsName=function(e,t){void 0===t&&(t=1);var n=this.getItemInfos(t)[e];return n?GameCommon.getInstance().getThingModel(n[0],n[1]).name:""},e.prototype.getGoodsNum=function(e,t){void 0===t&&(t=1);var n=this.getItemInfos(t)[e];return n?DataManager.getInstance().bagManager.getGoodsThingNumById(n[1],n[0]):0},e.prototype.getGoodsCost=function(e,t){return void 0===t&&(t=1),this.getItemInfos(t)[e]?this.getItemInfos(t)[e][2]:0},e.prototype.isCanReceive=function(){return this.surplusMoney>=this.costMoney},e.prototype.getActivityPointAll=function(){if(this.isCanReceive())return!0;var e=JsonModelManager.instance.getModelfeastzhuanpan();for(var t in e)if(this.getActivityPoint(e[t].type))return!0;return!1},e.prototype.getActivityPointPanel=function(e){return this.isCanReceive()?!0:this.getActivityPoint(e)?!0:!1},e.prototype.getActivityPoint=function(e,t){return void 0===e&&(e=ZHUANPAN_TYPE.draw),void 0===t&&(t=1),this.getGoodsNum(e,t)>=this.getGoodsCost(e,t)},e.prototype.getCurrModel=function(e){return this.currModels[e]},e.prototype.getActionPanel=function(e){switch(e){case ZHUANPAN_TYPE.draw:return"ActivityZhongqiuDraw";case ZHUANPAN_TYPE.poker:return"ActivityZhongqiuPoker";case ZHUANPAN_TYPE.turntable:return"ActivityZhongqiuTurntable";case ZHUANPAN_TYPE.dan:return"ActivityZhongqiuDan"}},e.prototype.getActionTitle=function(e){switch(e){case ZHUANPAN_TYPE.draw:return"抽签";case ZHUANPAN_TYPE.poker:return"翻牌";case ZHUANPAN_TYPE.turntable:return"转盘";case ZHUANPAN_TYPE.dan:return"砸蛋"}},e.prototype.getActionIcon=function(e){switch(e){case ZHUANPAN_TYPE.draw:return"shanggushenqian_png";case ZHUANPAN_TYPE.poker:return"xinyunxianpai_png";case ZHUANPAN_TYPE.turntable:return"sanjiezhuanpa_png";case ZHUANPAN_TYPE.dan:return"xingyunzadan_icon_png"}},e}();__reflect(ActivityZQManager.prototype,"ActivityZQManager");var ZHUANPAN_TYPE;!function(e){e[e["default"]=0]="default",e[e.draw=1]="draw",e[e.poker=2]="poker",e[e.turntable=3]="turntable",e[e.dan=4]="dan",e[e.end=5]="end"}(ZHUANPAN_TYPE||(ZHUANPAN_TYPE={}));var TLGiftManager=function(){function e(){this.record={}}return e.prototype.parseMessage=function(e){this.type=e.getByte(),this.value=e.getInt();for(var t=e.getByte(),n=0;t>n;n++){var a=e.getByte();this.record[a]=a}this.onInitObjectives()},e.prototype.onSortObjectives=function(){DataManager.getInstance().tLGiftManager},e.prototype.onInitObjectives=function(){this.onSortObjectives()},e.prototype.parseObtainMessage=function(e){var t=e.getByte();this.record[t]=t,this.onInitObjectives()},e.prototype.getCanObtainAward=function(){return!1},e}();__reflect(TLGiftManager.prototype,"TLGiftManager");var ActivityLabaManager=function(){function e(){this.consume_meRank=-1}return e.prototype.getRewardItem=function(){return this.itemList?new AwardItem(this.itemList[0].itemType,this.itemList[0].itemId,this.itemList[0].itemCount):null},e.prototype.getRewardItemList=function(){if(!this.itemList)return null;for(var e=[],t=0;t<this.itemList.length;++t)e.push(new AwardItem(this.itemList[t].itemType,this.itemList[t].itemId,this.itemList[t].itemCount));return e},e.prototype.getCurrModel=function(){var e=JsonModelManager.instance.getModellabahuodong();for(var t in e)if(this.lunshu==e[t].round)return e[t];return null},e.prototype.getHaveMoney=function(){return this.money-this.usedCount*this.currModel.costNum},e.prototype.getHaveCount=function(){return Math.floor(this.getHaveMoney()/this.currModel.costNum)},e.prototype.getMoneyStr=function(){return this.getHaveMoney()%this.currModel.costNum},e.prototype.parseLunshu=function(e){this.lunshu=e.getByte(),this.usedCount=e.getShort(),this.money=e.getInt(),this.currModel=this.getCurrModel()},e.prototype.parseLaba=function(e){switch(this.type=e.getByte(),this.usedCount=e.getShort(),this.money=e.getInt(),this.itemList=null,this.type){case 0:break;default:var t=e.getByte();if(t>0){this.itemList=[];for(var n=0;t>n;++n)this.itemList[n]=new ItemBody,this.itemList[n].parseMsg(e)}}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseLabaRank=function(e){this.consumeitem_ranks=[],this.consume_meRank=-1;for(var t=e.getByte(),n=0;t>n;n++)this.consumeitem_ranks[n]=new CrossServerConsumeRank,this.consumeitem_ranks[n].parseMsg(e),this.consumeitem_ranks[n].playerId==DataManager.getInstance().playerManager.player.id&&(this.consume_meRank=this.consumeitem_ranks[n].rank);GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.updateData=function(){var e=new Message(MESSAGE_ID.ACT_LABA_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},e.prototype.getActivityPoint=function(e){return void 0===e&&(e=1),this.currModel?this.getHaveMoney()>=this.currModel.costNum*e:!1},e}();__reflect(ActivityLabaManager.prototype,"ActivityLabaManager");var ActivityZhuanpan=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.Activityzhuanpan},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.groupReward.mask=new egret.Rectangle(0,-10,this.groupReward.width,this.groupReward.height+20),this.groupRewards=[this.groupReward0,this.groupReward1,this.groupReward2],this.timeDelays=[400,0,700],this.timeSps=[200,100,150],this.imgRockers=[this.imgRocker0,this.imgRocker1],this.groupRunTop=this.groupRewards[0].y;var t=this;this.btnFire.touchEnabled=!0,this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.initItemList()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.resetGroups();var t=this.labaManager.getRewardItem()||this.rewards[1];t&&(this.rewardRuns[1][1]=t,this.updateGoods(this.goodsLit[1][1],this.rewardRuns[1][1]))},t.prototype.onEventRocker=function(t){void 0===t&&(t=1),this.isAction||(e.prototype.onEventRocker.call(this,t),this.setActionState(1))},t.prototype.onDealRocker=function(){this.isRunEnd=!1,this.setActionState(0),Tool.callbackTime(this.resetState,this,500),this.resetGroups(),this.timeDelays=[Tool.randomFloat(300,600),0,Tool.randomFloat(300,600)],this.timeSps=[Tool.randomFloat(100,200),Tool.randomFloat(100,200),Tool.randomFloat(100,200)],this.groupRunStart(0,this.timeDelays[0]),this.groupRunStart(1,this.timeDelays[1]),this.groupRunStart(2,this.timeDelays[2]),Tool.callbackTime(this.onActionEnd,this,1500)},t.prototype.groupRunStart=function(e,t){void 0===t&&(t=0);var n=egret.Tween.get(this.groupRewards[e]);t>0&&n.wait(t),n.to({y:0},this.timeSps[e]);var a=this;n.call(function(){egret.Tween.removeTweens(a.groupRewards[e]),a.groupRunEnd(e)},this)},t.prototype.groupRunEnd=function(e){var t=this;if(this.isAction)if(this.isRunEnd){var n=egret.Tween.get(this.groupRewards[e]);if(1==e){this.rewardRuns[e][1]=this.rewardRuns[e][0],this.rewardRuns[e][0]=this.labaManager.getRewardItem(),this.updateGoods(this.goodsLit[e][0],this.rewardRuns[e][0]),this.updateGoods(this.goodsLit[e][1],this.rewardRuns[e][1]),this.resetGroups(e),n.to({y:0},this.timeSps[e]);var a=this;n.call(function(){egret.Tween.removeTweens(t.groupRewards[e]),a.onActionEnd(!0)},this)}else n.to({y:-this.groupRunTop},this.timeSps[e]),n.call(function(){egret.Tween.removeTweens(t.groupRewards[e])},this)}else this.rewardRuns[e][1]=this.rewardRuns[e][0],this.rewardRuns[e][0]=this.getRewardRandom(),this.updateGoods(this.goodsLit[e][0],this.rewardRuns[e][0]),this.updateGoods(this.goodsLit[e][1],this.rewardRuns[e][1]),this.resetGroups(e),this.groupRunStart(e)},t.prototype.onActionEnd=function(e){this.isRunEnd=!0,e&&(this.resetUI(),this.onRewardShow())},t.prototype.resetGroups=function(e){void 0===e&&(e=-1),-1==e?(this.groupRewards[0].y=this.groupRunTop-this.groupReward.height-10,this.groupRewards[1].y=this.groupRunTop,this.groupRewards[2].y=this.groupRunTop-this.groupReward.height-10):this.groupRewards[e].y=this.groupRunTop},t.prototype.resetUI=function(){e.prototype.resetUI.call(this),this.setActionState(0)},t.prototype.resetState=function(){this.setActionState(0)},t.prototype.initItemList=function(){this.rewards=this.labaManager.currModel.rewards;for(var e=0;e<this.rewards.length;e++){var t=GameCommon.getInstance().createGoodsIntance(this.rewards[e]);t.x=130*e,t.y=30,this.group.addChild(t)}this.scroller.horizontalScrollBar.visible=!1,this.scroller.horizontalScrollBar.autoVisibility=!1,this.rewardRuns=[],this.goodsLit=[];for(var e=0;e<this.groupRewards.length;++e){this.rewardRuns[e]=[],this.goodsLit[e]=[];for(var n=0;2>n;++n)this.rewardRuns[e][n]=this.getRewardRandom(),this.goodsLit[e][n]=GameCommon.getInstance().createGoodsIntance(this.rewardRuns[e][n]),this.groupRewards[e].addChild(this.goodsLit[e][n]),this.goodsLit[e][n].y=140*n}this.resetGroups()},t.prototype.getRewardRandom=function(){return this.rewards[Tool.randomInt(0,this.rewards.length)]},t.prototype.setActionState=function(e){for(var t=0;t<this.imgRockers.length;++t)this.imgRockers[t].visible=e==t,this.imgRockers[t].visible=e==t},t}(ActivityLabaBase);__reflect(ActivityZhuanpan.prototype,"ActivityZhuanpan");var ActivityZhuanpanDan=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityzhuanpanDan},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.groups=[this.group0,this.group1],this.imgRockers=[this.imgRocker0,this.imgRocker1];var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeEffect()},t.prototype.onDealRocker=function(){var e=20,t=50,n=egret.Tween.get(this.imgRockers[0]);n.to({rotation:e},t),n.to({rotation:-e},2*t),n.to({rotation:e/2},1.5*t),n.to({rotation:-e/2},t),n.to({rotation:0},t/2);var a=this;n.call(function(){egret.Tween.removeTweens(a.imgRockers[0]),a.openEffect()},this)},t.prototype.openEffect=function(){this.mountBody=new Animation("zadan_01"),this.mountBody.autoRemove=!1,this.mountBody.playNum=1,this.mountBody.playFinishCallBack(this.onActionFinish,this),this.groupEffect.addChild(this.mountBody),this.mountBody.x=this.groupEffect.width/2,this.mountBody.y=this.groupEffect.height/2},t.prototype.closeEffect=function(){this.mountBody&&(this.mountBody.onStop(),this.groupEffect.removeChild(this.mountBody),this.mountBody=null)},t.prototype.onActionFinish=function(){this.closeEffect(),this.setActionState(1),this.onRewardShow()},t.prototype.onCloseAwdShow=function(){e.prototype.onCloseAwdShow.call(this),this.resetUI()},t.prototype.resetUI=function(){e.prototype.resetUI.call(this),this.setActionState(0),this.imgRockers[0].rotation=0},t.prototype.initItemList=function(){this.rewards=this.labaManager.currModel.rewards;for(var e=.96,t=0;4>t;t++){var n=GameCommon.getInstance().createGoodsIntance(this.rewards[t]);n.x=this.groups[0].width/2,n.y=120*t*e,this.groups[0].addChild(n),n.anchorOffsetX=n.width/2,n.scaleX=n.scaleY=e;var a=GameCommon.getInstance().createGoodsIntance(this.rewards[t+4]);a.x=this.groups[1].width/2,a.y=120*t*e,this.groups[1].addChild(a),a.anchorOffsetX=a.width/2,a.scaleX=a.scaleY=e}},t.prototype.getRewardRandom=function(){return this.rewards[Tool.randomInt(0,this.rewards.length)]},t.prototype.setActionState=function(e){for(var t=0;t<this.imgRockers.length;++t)this.imgRockers[t].visible=e==t,this.imgRockers[t].visible=e==t},t}(ActivityLabaBase);__reflect(ActivityZhuanpanDan.prototype,"ActivityZhuanpanDan");var ActivityZhuanpanDraw=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityZhuanpanDraw},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.groups=[this.group0,this.group1],this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.initItemList=function(){this.rewards=this.labaManager.currModel.rewards;for(var e=.9,t=0;4>t;t++){var n=GameCommon.getInstance().createGoodsIntance(this.rewards[t]);n.x=this.groups[0].width/2,n.y=120*t*e,this.groups[0].addChild(n),n.anchorOffsetX=n.width/2,n.scaleX=n.scaleY=e;var a=GameCommon.getInstance().createGoodsIntance(this.rewards[t+4]);a.x=this.groups[1].width/2,a.y=120*t*e,this.groups[1].addChild(a),a.anchorOffsetX=a.width/2,a.scaleX=a.scaleY=e}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onDealRocker=function(){this.onRewardShow()},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e),this.actionInit()},t.prototype.actionInit=function(){this.rect.visible=this.lbAlert.visible=!1,this.imgZhong.visible=!0;var e=.5,t=300,n=380,a=537,i=(a-n)/4;this.showAwardGroup.scaleX=this.showAwardGroup.scaleY=e,this.showAwardGroup.y=a;var o=egret.Tween.get(this.showAwardGroup),r=this;o.to({y:a-i,scaleX:-e},t),o.to({y:a-2*i,scaleX:e},t),o.to({y:a-3*i,scaleX:-e},t),o.to({y:n,scaleX:e},t),o.wait(300),o.call(function(){egret.Tween.removeTweens(r.showAwardGroup),r.actionDown()},this)},t.prototype.actionDown=function(){this.imgZhong.visible=!1;var e=this,t=egret.Tween.get(this.showAwardGroup);t.to({y:510,scaleX:1,scaleY:1},300),t.call(function(){egret.Tween.removeTweens(e.showAwardGroup),e.lbAlert.visible=e.rect.visible=!0,e.resetUI()},this)},t}(ActivityLabaBase);__reflect(ActivityZhuanpanDraw.prototype,"ActivityZhuanpanDraw");var ActivityZhuanpanPoker=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityzhuanpanPoker},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.imgRockers=[this.imgRocker0,this.imgRocker1,this.imgRocker2];var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.onActionInit()},t.prototype.onDealRocker=function(){var e=500;this.onActionRun(this.imgRockers[0],this.imgRockers[1].x-210,e),this.onActionRun(this.imgRockers[2],this.imgRockers[1].x+210,e,!0)},t.prototype.onActionRun=function(e,t,n,a){void 0===a&&(a=!1);var i=this,o=egret.Tween.get(e);o.to({x:this.imgRockers[1].x,y:this.imgRockers[1].y,rotation:this.imgRockers[1].rotation},n),o.to({x:t},n),o.call(function(){a&&i.onActionShow(Tool.randomInt(0,3),n)},this)},t.prototype.setLayer=function(e){void 0===e&&(e=-1);for(var t=0,n=0;n<this.imgRockers.length;++n)e!=n&&(this.imgRockers[n].parent.setChildIndex(this.imgRockers[n],t),++t);-1!=e&&this.imgRockers[e].parent.setChildIndex(this.imgRockers[e],t)},t.prototype.onActionShow=function(e,t,n){void 0===n&&(n=50),this.setLayer(e);var a=this,i=this.imgRockers[1].x,o=680,r=Math.floor(this.imgRockers[e].x+(i-this.imgRockers[e].x)/3*2),s=Math.floor(this.imgRockers[e].y+(o-this.imgRockers[e].y)/3*2),h=egret.Tween.get(this.imgRockers[e]);h.wait(n),h.to({x:r,y:s,scaleX:-1},t),h.to({x:i,y:o,scaleX:0},t/2),h.call(function(){a.imgRockers[e].visible=!1,a.onActionFinish()},this)},t.prototype.onActionFinish=function(){for(var e=0;e<this.imgRockers.length;++e)egret.Tween.removeTweens(this.imgRockers[e]);this.onRewardShow()},t.prototype.onPlayDone=function(e){this.showAwardPanel.visible=!0,e&&this.updateGoods(this.itemNb,e);var t=this;this.rect.visible=this.lbAlert.visible=!1,this.showAwardGroup.scaleX=0;var n=egret.Tween.get(this.showAwardGroup);n.to({scaleX:1},500),n.call(function(){egret.Tween.removeTweens(t.showAwardGroup),t.rect.visible=t.lbAlert.visible=!0,t.resetUI()},this)},t.prototype.onActionInit=function(){this.imgRockers[0].x=262,this.imgRockers[0].y=824,this.imgRockers[0].rotation=-15,this.imgRockers[0].scaleX=1,this.imgRockers[0].visible=!0,this.imgRockers[1].x=312,this.imgRockers[1].y=812,this.imgRockers[1].rotation=0,this.imgRockers[1].scaleX=1,this.imgRockers[1].visible=!0,this.imgRockers[2].x=362,this.imgRockers[2].y=824,this.imgRockers[2].rotation=15,this.imgRockers[2].scaleX=1,this.imgRockers[2].visible=!0,this.setLayer()},t.prototype.onCloseAwdShow=function(){this.isAction||(e.prototype.onCloseAwdShow.call(this),this.onActionInit())},t.prototype.initItemList=function(){this.rewards=this.labaManager.currModel.rewards;for(var e=.65,t=90,n=8,a=(this.groupItem.width-t*e*this.rewards.length-n*(this.rewards.length-1))/2,i=0;i<this.rewards.length;i++){var o=GameCommon.getInstance().createGoodsIntance(this.rewards[i]);o.x=a-10,o.y=30,this.groupItem.addChild(o),o.scaleX=o.scaleY=e,a+=t*e+n}},t}(ActivityLabaBase);__reflect(ActivityZhuanpanPoker.prototype,"ActivityZhuanpanPoker");var ActivityZhuanpanRank=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityZhuanpanRank},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().labaManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=ZhuanpanRankItem,this.itemlist.itemRendererSkinName=skins.ActivityZhuanpanRankItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_LABA_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("LABA_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_LABA_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LABA_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.ACT_LABA_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){this.myPro.text="我的进度："+this.manager.usedCount;var e=this.manager.consume_meRank;-1==e?this.myRank.text="我的排名：未上榜":this.myRank.text="我的排名："+e;var t=JsonModelManager.instance.getModellabapaihangbang(),n=[];for(var a in t)n.push(t[a]);this.itemlist.dataProvider=new eui.ArrayCollection(n)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LEICHONGLABA);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.consumeitem_ranks)for(var t=3;t<this.manager.consumeitem_ranks.length;t++){var n=this.manager.consumeitem_ranks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_LABA,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t.prototype.log=function(e){egret.log(e)},t}(BaseTabView);__reflect(ActivityZhuanpanRank.prototype,"ActivityZhuanpanRank");var ZhuanpanRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=126},t.prototype.onInit=function(){this.ranklist.hasEventListener(egret.TouchEvent.TOUCH_TAP)||(GameCommon.getInstance().addUnderlineStr(this.ranklist),this.ranklist.touchEnabled=!0,this.ranklist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this))
},t.prototype.onUpdate=function(){var e=this.data,t=e.rewards;this.awards.removeChildren();for(var n=0;n<t.length;n++){var a=t[n],i=GameCommon.getInstance().createGoodsIntance(a);this.awards.addChild(i)}var o=DataManager.getInstance().labaManager.consumeitem_ranks[e.rankMin-1];e.rankMin>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.rank.source="rankbg_4_png",this.rank_num_lab.text="4-20"):o?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.rank.source="rankbg_"+o.rank+"_png",this.rank_num_lab.text=o.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=o.playerName,o.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="累计次数："+o.lotteryNum):(this.rank.source="rankbg_"+e.rankMin+"_png",this.rank_num_lab.text=e.rankMin.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("LABA_LOOP_RANK"))},t}(BaseListItem);__reflect(ZhuanpanRankItem.prototype,"ZhuanpanRankItem");var ActivityZhuanpanTurntable=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityZhuanpanTurntable},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=this;this.btnFire.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(1)},this),this.btnFire10.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.onEventRocker(10)},this),this.initItemList(),this.initRed(this.btnFire,GameDefine.RED_BTN_POS,1),this.initRed(this.btnFire10,GameDefine.RED_BTN_POS,10)},t.prototype.initItemList=function(){this.rewards=this.labaManager.currModel.rewards;for(var e=0;8>e;++e){var t=GameCommon.getInstance().createGoodsIntance(this.rewards[e]);t.x=this.groupRound.width/2,t.y=this.groupRound.height/2,t.anchorOffsetX=t.width/2,t.anchorOffsetY=220,t.scaleX=t.scaleY=.6,this.groupRound.addChild(t),t.rotation=-45*e,t.num_label.text="",t.name_label.text=this.rewards[e].num.toString(),t.name_label.size=34,t.name_label.textColor=GameCommon.getInstance().CreateNameColer(t.model.quality)}},t.prototype.getRewardIdx=function(){for(var e=this.labaManager.itemList[0].itemType,t=this.labaManager.itemList[0].itemId,n=this.labaManager.itemList[0].itemCount,a=0;a<this.rewards.length;++a)if(e==this.rewards[a].type&&t==this.rewards[a].id&&n==this.rewards[a].num)return a%8;return 0},t.prototype.onDealRocker=function(){var e=egret.Tween.get(this.groupRound),t=500,n=1440+45*this.getRewardIdx();e.to({rotation:n},2e3),e.to({rotation:n+360},t+100);var a=this;e.call(function(){egret.Tween.removeTweens(a.groupRound),a.runFinish()},this)},t.prototype.resetUI=function(){e.prototype.resetUI.call(this),this.groupRound.rotation=this.groupRound.rotation%360},t.prototype.runFinish=function(){this.onRewardShow(),this.resetUI()},t}(ActivityLabaBase);__reflect(ActivityZhuanpanTurntable.prototype,"ActivityZhuanpanTurntable");var ActivityZPPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_ZHUANPAN],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n.params=[],n.points=RedPointManager.createPoint(n.activityIds.length),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this)},t.prototype.onRegist=function(){this.register(),this.onRefresh(),e.prototype.onRegist.call(this)},t.prototype.register=function(){this.params=[];for(var e,t=[],n=0;n<this.activityIds.length;n++){e=this.activityIds[n];var a=DataManager.getInstance().activityManager.getRegisterSystemParam(e);if(a){if(e==ACTIVITY_BRANCH_TYPE.LEICHONGLABA){var i=DataManager.getInstance().labaManager.currModel;a.sysName=i.panel,a.title=i.title,a.redP=this.points[n],a.redP.addTriggerFuc(DataManager.getInstance().labaManager,"getActivityPoint")}if(t.push(a),this.params.push(a),e==ACTIVITY_BRANCH_TYPE.LEICHONGLABA){var o=this.createRank(e);t.push(o),this.params.push(o)}}}this.registerPage(t,"activityLabaGrp",GameDefine.RED_TAB_POS)},t.prototype.createRank=function(e){var t=new RegisterSystemParam;return t.sysName="ActivityZhuanpanRank",t.btnRes="z_labarank_btn",t.title="z_labarank_title_png",t},t.prototype.onRefresh=function(){this.params&&this.params[this.index]&&this.setTitle(this.params[this.index].title),e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(ActivityZPPanel.prototype,"ActivityZPPanel");var ItemBody=function(){function e(){this.itemType=-1}return e.prototype.parseMsg=function(e){this.itemType=e.getByte(),this.itemId=e.getShort(),this.itemCount=e.getInt()},e}();__reflect(ItemBody.prototype,"ItemBody");var ClientDownLoadPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ClientDownLoadPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRegist(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.download_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDownloadBtn,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.download_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDownloadBtn,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRefresh=function(){},t.prototype.onTouchDownloadBtn=function(){window.location.href="http://wan.yichi666.com/download/ssss_wd.apk?v="+Math.random()},t}(BaseWindowPanel);__reflect(ClientDownLoadPanel.prototype,"ClientDownLoadPanel");var ClientFoursPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRegist(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(ClientFoursPanel.prototype,"ClientFoursPanel");var ActConsumeRewardPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ConsumeRewardPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().totalConsumeManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=ActConsumeRewardItem,this.itemlist.itemRendererSkinName=skins.ConsumeRewardItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_CONSUMEITEM_MESSAGE.toString(),this.onupdateList,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_CONSUMEITEM_MESSAGE.toString(),this.onupdateList,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.manager.requestConsumeItemMsg()},t.prototype.onupdateList=function(){var e=[],t=JsonModelManager.instance.getModelleijixiaohao();for(var n in t){var a=t[n];this.manager.consumeitem_round==a.round&&e.push(a)}e.sort(function(e,t){var n=e.costNum-DataManager.getInstance().totalConsumeManager.consumeitem_pro,a=t.costNum-DataManager.getInstance().totalConsumeManager.consumeitem_pro;return 0>a?-1:0>n?1:-1}),this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.CONSUME_ITEM);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(ActConsumeRewardPanel.prototype,"ActConsumeRewardPanel");var ActConsumeRewardItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().totalConsumeManager,n=e.costNum>t.consumeitem_pro?"[#5aff91（"+t.consumeitem_pro+"/"+e.costNum+"）]":"[#FFF000(已完成)]",a=GameCommon.getInstance().readStringToHtml("活动期间累计消耗[#55c4ff"+e.name+"]"+e.costNum+"个 可获得："+n);this.reward_desc_lab.textFlow=(new egret.HtmlTextParser).parse(a),this.reward_items_grp.removeChildren();for(var i=0;i<e.rewards.length;i++){var o=GameCommon.getInstance().createGoodsIntance(e.rewards[i]);this.reward_items_grp.addChild(o)}},t}(BaseListItem);__reflect(ActConsumeRewardItem.prototype,"ActConsumeRewardItem");var ActivityConsumeMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.params=[],n.activityIdNow=[],n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_CONSUME],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.points=[],e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),DataManager.getInstance().totalConsumeManager.requestConsumeItemMsg();var t=0;this.activityIdNow=[],this.params=[];for(var n=0;n<this.activityIds.length;n++){var a=this.activityIds[n],i=DataManager.getInstance().activityManager.getRegisterSystemParam(a);if(i){var o="";if(1e4>a){var r=JsonModelManager.instance.getModelactivity()[a];i.btnRes=r.icon,o=r.panel}else{var s=JsonModelManager.instance.getModelactivityFunction()[a];i.btnRes=s.icon,o=s.panel}var h=this.getRedPointFunc(o);h&&(this.points[t]||(this.points[t]=new redPoint),i.redP=this.points[t],i.redP.addTriggerFuc(DataManager.getInstance().totalConsumeManager,h),t++),this.params.push(i),this.activityIdNow.push(a)}}this.registerPage(this.params,"consumeActivityGrp",GameDefine.RED_TAB_POS),this.currPanel||this.onRefresh()},t.prototype.onRefresh=function(){this.onRefreshTitle(),e.prototype.onRefresh.call(this)},t.prototype.onRefreshTitle=function(){switch(this.index){case 0:this.setTitle("act_consume_title_png");break;case 1:break;case 2:}},t.prototype.getRedPointFunc=function(e){var t="";switch(e){case"ActConsuemTurnplatePanel":t="oncheckTurnplateRedPoint"}return t},t}(BaseSystemPanel);__reflect(ActivityConsumeMainPanel.prototype,"ActivityConsumeMainPanel");var DeskPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("activity_banba_desktop_png"),this.goods1.onUpdate(5,0,0,4,30),this.goods2.onUpdate(2,1,0,3,5),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.DeskSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.receiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this)},t.prototype.onReceiveClick=function(e){SDKWanBa.getInstance().sendToDesktop(),this.onHide()},t}(BaseWindowPanel);__reflect(DeskPanel.prototype,"DeskPanel");var FestivalFullMoonPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){this.points=[],this.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_FESTIVALFULLMOON],this.activityIds=GameCommon.parseIntArray(this.modelGroup.activityId),e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);var t=0,n=[],a=new RegisterSystemParam;a.redP=new redPoint;for(var i=0;i<this.activityIds.length;i++){var o=this.activityIds[i];if(o==ACTIVITY_BRANCH_TYPE.ZHONGQIULEICHONG){for(var r=DataManager.getInstance().zqManager,s=r.currModels,h=0;h<s.length;++h)if(s[h]){var l=s[h].type,g=r.getActionPanel(l);if(g){var c=new RegisterTabBtnParam;c.sysName=g,c.tabBtnRes=r.getActionIcon(l),c.title=r.getActionTitle(l),n.push(c);var p=new redPoint;this.points.push(p),c.redP=p,c.redP.addTriggerFuc(r,"getActivityPointPanel",l)}}}else{var c=DataManager.getInstance().activityManager.getRegisterTabBtnParam(o);if(c){var u="",d=this.getActivityModel(o);if(!d)continue;c.tabBtnRes=d.icon,u=d.panel,this.points[t]||(this.points[t]=new redPoint),c.redP=this.points[t],c.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",o),t++,n.push(c)}}}a.tabBtns=n,this.registerPage([a],"festivalFullMoonGrp",GameDefine.RED_TAB_POS),this.params=n},t.prototype.getActivityModel=function(e){return 1e4>e?JsonModelManager.instance.getModelactivity()[e]:JsonModelManager.instance.getModelactivityFunction()[e]},t}(BaseSystemPanel);__reflect(FestivalFullMoonPanel.prototype,"FestivalFullMoonPanel");var FocusPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("guanzhu_title_png"),this.goods1.onUpdate(5,0,0,4,100),this.goods2.onUpdate(3,34,0,4,1),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.focusSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FOCUS_REWARD_MESSAGE.toString(),this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.receiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FOCUS_REWARD_MESSAGE.toString(),this.onHide,this)},t.prototype.onReceiveClick=function(e){var t=!1;return SDKManager.loginInfo.channel==EChannel.CHANNEL_SOEZ&&(t=SDKEZJS.isFocus(this.nineGFocus)),SDKManager.loginInfo.channel==EChannel.CHANNEL_QUNHEI&&(t=!0,SDKQHJS.isFocus(this.nineGFocus)),t?void this.onHide:void(SDKManager.loginInfo.focus||SDKManager.subscribe())},t.prototype.nineGFocus=function(e){if(e){var t=SDKEZ.getInstance().info,n=ChannelDefine.createURL(t,"focus",{uid:t.account,server_id:t.serverId,player_id:t.playerId,subChannel:t.subChannel});HttpUtil.sendGetRequest(n,null,this);var a=[{text:"您已关注，请查看邮件奖励",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(a,function(){},this)))}else SDKManager.loginInfo.focus||SDKManager.subscribe()},t.prototype.focusCallback=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN)),this.onHide},t}(BaseWindowPanel);__reflect(FocusPanel.prototype,"FocusPanel");var VerifyPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.rewards=[[2,1,300],[2,2,20],[4,0,3e5]],n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.reward_grp.removeChildren();for(var t=0;t<this.rewards.length;t++){var n=new GoodsInstance;n.onUpdate(this.rewards[t][0],this.rewards[t][1],0,0,this.rewards[t][2]),this.reward_grp.addChild(n)}this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.VerifyPanelSkin},t.prototype.onRegist=function(){this.gift_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VERIFY_GIFT.toString(),this.callback,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){this.gift_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VERIFY_GIFT.toString(),this.callback,this),e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){var e=SDKUtil.getQueryString("verify");SDKUtil.getQueryString("wallow");egret.log("verify分别为 url的="+e+" 游戏内的="+SDKAWY.getInstance().verify),e&&"1"==e||0==SDKAWY.getInstance().verify?this.gift_btn.label="领 取":this.gift_btn.label="我要领取",1==DataManager.getInstance().playerManager.verify&&(this.gift_btn.label="已领取",this.gift_btn.enabled=!1)},t.prototype.onClick=function(){if("我要领取"==this.gift_btn.label)SDKAWY.getInstance().doCheckVerify();else if(this.gift_btn.label="领 取"){var e=SDKAWY.getInstance().getGiftInfo(1);egret.log("onEnterGame get url="+e),HttpUtil.sendGetRequest(e,this.clickCallback,this)}},t.prototype.clickCallback=function(e){var t=e.currentTarget,n=JSON.parse(t.response);if(egret.log(n),"2"==n){var a=new Message(MESSAGE_ID.VERIFY_GIFT);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}},t.prototype.callback=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN)),this.onRefresh()},t}(BaseWindowPanel);__reflect(VerifyPanel.prototype,"VerifyPanel");var WanbaGiftPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.basic.height=360,this.bg.height=225,this.reward_grp.removeChildren();var t=new AwardItem;t.id=SDKWanBa.getInstance().boxId,t.type=GOODS_TYPE.BOX,t.num=1,t.quality=1;var n=GameCommon.getInstance().createGoodsIntance(t);this.reward_grp.addChild(n),SDKWanBa.getInstance().giftOK?(this.label4.text="领取成功",this.label5.text="恭喜您获得："):(this.label4.text="每天只能领取一次哦",this.label5.text="您今天已经领取过："),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.WanbaGiftSkin},t.prototype.onRegist=function(){this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(WanbaGiftPanel.prototype,"WanbaGiftPanel");var WanbaVIPGiftPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.isButtonDisplay=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WanbaVIPGiftSkin},t.prototype.onInit=function(){this.wanbaParam=new WanbaVIPGiftParam,this.vipLevel=0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onHide,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onHide,this),delete this.rewardArr,e.prototype.onRemove.call(this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){this.getVipInfo()},t.prototype.getVipInfo=function(){if(SDKManager.loginInfo.channel==EChannel.CHANNEL_WANBA){var e=SDKWanBa.getInstance().getVipInfo();HttpUtil.sendGetRequest(e,this.updateVipInfo,this)}},t.prototype.updateVipInfo=function(e){var t=e.currentTarget,n=JSON.parse(JSON.parse(t.response).ret);n&&(egret.log(n),this.isButtonDisplay=!n.isGetGift,DataManager.getInstance().playerManager.player.wanbaVip=this.isButtonDisplay,this.vipLevel=n.level,this.vipLevel>=6&&!this.isButtonDisplay&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.WANBAVIP_MAX)),this.vipLv.text="LV"+n.level,this.onUpData())},t.prototype.showTips=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("WanbaGiftPanel",e))},t.prototype.onUpData=function(){this.rewardArr=this.models,this.onClearDepotList();for(var e=0;e<this.rewardArr.length;e++){var t=new WanbaVIPGiftItem;t.getAwardBtn.name=this.rewardArr[e].cfg.id,t.onUpdate(this.rewardArr[e].cfg,this.vipLevel,this.isButtonDisplay,this.rewardArr[e].idx),t.getAwardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendVipGetAward,this),t.y=(t.height+15)*e,this.awardList.addChild(t)}},t.prototype.onClearDepotList=function(){if(this.awardList.numChildren>0)for(var e=this.awardList.numChildren-1;e>=0;e--){var t=this.awardList.getChildAt(e);t&&(t.getAwardBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendVipGetAward,this),this.awardList.removeChild(t))}},t.prototype.sendVipGetAward=function(e){var t=parseInt(e.currentTarget.name),n=SDKWanBa.getInstance().sendVipGetAward(t);HttpUtil.sendGetRequest(n,this.sendAwardCallback,this)},t.prototype.sendAwardCallback=function(e){var t=e.currentTarget,n=JSON.parse(JSON.parse(t.response).ret);n&&(n.ret>0&&(this.isButtonDisplay=!1),this.onRefresh())},Object.defineProperty(t.prototype,"models",{get:function(){var e;e=JsonModelManager.instance.getModelbox(),this.rewardArr=new Array;var t=0;for(var n in e)if(Number(n)>=1007&&Number(n)<1013&&(t+=1,this.vipLevel==t||this.vipLevel+1==t)){var a=new WanbaVIPGiftParam;a.cfg=e[n],a.idx=t,this.rewardArr.push(a)}return this.rewardArr},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(WanbaVIPGiftPanel.prototype,"WanbaVIPGiftPanel");var WanbaVIPGiftItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.WanbaVIPGiftItemSkin},t.prototype.onInit=function(){this.boxCfg&&this.onUpdate(this.boxCfg,this._vipLevel,this.isButtonDisplay,this._idx)},t.prototype.onUpdate=function(e,t,n,a){if(this._vipLevel=t,this.boxCfg=e,this._idx=a,this.isButtonDisplay=n,this.isLoaded){this.getAwardBtn.visible=!1,this.descName.text=e.name,a==t?(this.getAwardBtn.visible=!0,n?(this.getAwardBtn.enabled=!0,this.getAwardBtn.label="领取"):(this.getAwardBtn.enabled=!1,this.getAwardBtn.label="已领取")):this.descName.text="下一级可领取",this.award_grp.removeChildren();for(var i=e.rewards,o=0;o<i.length;o++){var r=new GoodsInstance,s=i[o];r.onUpdate(s.type,s.id,0,s.quality,s.num,s.lv),this.award_grp.addChild(r)}}},t.prototype.onTouch=function(){if(this._vipLevel>=this._idx){var e=SDKWanBa.getInstance().sendVipGetAward(this.boxCfg.id);HttpUtil.sendGetRequest(e,function(e){var t=e.currentTarget,n=JSON.parse(JSON.parse(t.response).ret);n&&this.boxCfg.id==n.boxid&&(this.getAwardBtn.visible=!1)},this)}},t}(BaseComp);__reflect(WanbaVIPGiftItem.prototype,"WanbaVIPGiftItem");var WanbaVIPGiftParam=function(){function e(){}return e}();__reflect(WanbaVIPGiftParam.prototype,"WanbaVIPGiftParam");var FundPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FundPanelSkin},t.prototype.onInit=function(){this.items=[];var t,n,a=JsonModelManager.instance.getModelfund();for(var i in a)n=a[i],t=new FundItem(n),this.items.push(t);e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_obtain.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnObtain,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.INVEST_TO_OBTAIN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_obtain.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnObtain,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.INVEST_TO_OBTAIN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){this.onShowAward(),DataManager.getInstance().investManager.fundBuy&&(this.btn_obtain.label="已购买",this.btn_obtain.enabled=!1)},t.prototype.onShowAward=function(){var e=DataManager.getInstance().investManager.fundReward;this.awardLayer.removeChildren();for(var t=0;t<this.items.length;t++)this.items[t].onUpdate(),0==e[this.items[t].model.id-2]&&this.awardLayer.addChild(this.items[t])},t.prototype.onTouchBtnObtain=function(e){if("已购买"!=this.btn_obtain.label){var t=198,n="基金";SDKManager.pay({goodsName:n,amount:t,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t}(BaseTabView);__reflect(FundPanel.prototype,"FundPanel");var FundItem=function(e){function t(t){var n=e.call(this)||this;return n.model=t,n.skinName=skins.FundItemSkin,n}return __extends(t,e),t.prototype.onInit=function(){this.points=RedPointManager.createPoint(1),this.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getReward,this),this.points[0].register(this.btn_receive,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"checkRedPoint"),this.desc.text=this.model.desc,this.onUpdate()},t.prototype.onUpdate=function(){this.isLoaded&&(DataManager.getInstance().playerManager.player.getPlayerData().coatardLv<this.model.id?(this.btn_receive.label="未完成",this.btn_receive.enabled=!1):DataManager.getInstance().investManager.fundBuy?(this.btn_receive.label="领取",this.btn_receive.enabled=!0):(this.btn_receive.label="未购买",this.btn_receive.enabled=!1),this.trigger())},t.prototype.getReward=function(){var e=new Message(MESSAGE_ID.INVEST_TO_OBTAIN_MESSAGE);e.setShort(this.model.id),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.checkRedPoint=function(){return this.btn_receive.enabled},t.prototype.trigger=function(){this.points&&this.points[0].checkPoint()},t}(BaseComp);__reflect(FundItem.prototype,"FundItem");var HallActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_HALL],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n.activityIdNow=[],n.params=[],n.curIdx=0,n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTabsJianTou(!1),this.register(),this.onRefresh()},t.prototype.register=function(){var e,t=[];this.activityIdNow=[];var n=new RegisterSystemParam;n.redP=this.createRedPoint();for(var a=0;a<this.activityIds.length;a++){e=this.activityIds[a];var i=DataManager.getInstance().activityManager.getRegisterTabBtnParam(e);i?(this.params.push(i),i.redP=this.createRedPoint(),"ActivitysXianFengPanel"==i.sysName&&(i.funcID=FUN_TYPE.FUN_XIANFENG),i.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",this.activityIds[a]),this.activityIdNow.push(e)):egret.log("无效的ActivityId："+e)}n.tabBtns=this.params,t.push(n),this.registerPage(t,"hallGrp",GameDefine.RED_TAB_POS)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.refreshWhenDelActivity,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CHECKACTIVITY_BTN,this.refreshWhenDelActivity,this),GameDispatcher.getInstance().addEventListener("delActivity",this.refreshWhenDelActivity,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.refreshWhenDelActivity,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CHECKACTIVITY_BTN,this.refreshWhenDelActivity,this),GameDispatcher.getInstance().removeEventListener("delActivity",this.refreshWhenDelActivity,this)},t.prototype.onRefresh=function(){this.refreshWhenDelActivity(),e.prototype.onRefresh.call(this)},t.prototype.refreshWhenDelActivity=function(){for(var e=0;e<this.activityIdNow.length;e++)DataManager.getInstance().activityManager.getRegisterSystemParam(this.activityIdNow[e])||this.register()},t.prototype.onTimeOut=function(){this.register()},t}(BaseSystemPanel);__reflect(HallActivityPanel.prototype,"HallActivityPanel");var HallWelfarePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.params=[],n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_FULIDATING],this.activityIds=GameCommon.parseIntArray(this.modelGroup.activityId),this.points=RedPointManager.createPoint(this.activityIds.length);for(var t,n=0;n<this.activityIds.length;n++){t=this.activityIds[n];var a=DataManager.getInstance().activityManager.getRegisterTabBtnParam(t);a&&this.params.push(a)}this.register(),this.onRefresh()},t.prototype.register=function(){for(var e=[],t=new RegisterSystemParam,n=0;n<this.params.length;n++){var a=this.params[n];"ActivityYaoqianshuPanel"==a.sysName&&(a.funcID=FUN_TYPE.FUN_JUBAOPEN),"ActivityYuekaPanel"==a.sysName&&(a.funcID=FUN_TYPE.FUN_MONTHCARD),a.redP=this.points[n],a.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",this.activityIds[n])}t.tabBtns=this.params,e.push(t),this.registerPage(e,"hallWelfareGrp",GameDefine.RED_TAB_POS)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){this.setTitle(this.params[this.index].title),e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(HallWelfarePanel.prototype,"HallWelfarePanel");var InvestPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.InvestPanelSkin},t.prototype.onInit=function(){this.awardLayer.itemRenderer=InvestItem,this.awardLayer.itemRendererSkinName=skins.InvestItemSkin,this.awardLayer.useVirtualLayout=!0,this.scroller.viewport=this.awardLayer,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_obtain.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnObtain,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_obtain.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnObtain,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.onShowAward(),DataManager.getInstance().newactivitysManager.isBuyInvestment&&(this.btn_obtain.label="已投资",this.btn_obtain.enabled=!1,this.timeGroup.visible=!1)},t.prototype.onShowAward=function(){var e,t=[];
for(var n in JsonModelManager.instance.getModelinvest())e=JsonModelManager.instance.getModelinvest()[n],t.push(e);this.awardLayer.dataProvider=new eui.ArrayCollection(t)},t.prototype.onTouchBtnObtain=function(e){if("已投资"!=this.btn_obtain.label){var t=99,n="投资计划";SDKManager.pay({goodsName:n,amount:t,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))}},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.INVEST);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t}(BaseTabView);__reflect(InvestPanel.prototype,"InvestPanel");var InvestItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;this.items.removeChildren();for(var t=0;t<e.rewards.length;t++){var n=e.rewards[t],a=new GoodsInstance;a.onUpdate(n.type,n.id,0,n.quality,n.num),this.items.addChild(a)}this.days.source="invest_item"+e.id+"_png"},t}(BaseListItem);__reflect(InvestItem.prototype,"InvestItem");var RebatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tab=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RebatePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.label_recharge,"充值"),this.label_recharge.touchEnabled=!0,this.label_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBuy,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBuy,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this)},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.label_gold.text=DataManager.getInstance().playerManager.player.gold+""},t.prototype.onTouchBtnBuy=function(){this.onSendMessage()},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onSendMessage=function(){this.tab>t.REBATE_MAX_GEARS},t.prototype.onRefresh=function(){var e,n=DataManager.getInstance().rebateManager.record;for(e=t.REBATE_MAX_GEARS;e>=1;e--)if(n[e]){this.tab=e+1;break}this.onupdateCurrency()},t.prototype.onTouchTab=function(e){parseInt(e.target.value)},t.REBATE_MAX_GEARS=3,t}(BaseWindowPanel);__reflect(RebatePanel.prototype,"RebatePanel");var SaveBuyActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SaveBuyActivitySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t,n=Constant.get("XIANGOU_ZHEKOU");t=n.split("#"),this.bar_recharge.minimum=0;for(var a=0,i=0;i<t.length;i++){var o=t[i].split(",");a=Number(o[0]),Number(o[1])/1e3-Tool.toInt(Number(o[1])/1e3)!=0?(this["imgzhekou"+(i+1)].source="save"+Tool.toInt(Number(o[1])/1e3)+"_png",this.imgzhekou5.source="save5_png"):this["imgzhekou"+(i+1)].source="save"+Number(o[1])/1e3+"_png",0!=i&&(this["zhekou"+(i+1)].text=Number(o[0])+"次后享受")}this.bar_recharge.labelDisplay.visible=!1,this.bar_recharge.maximum=a,this.onRefresh()},t.prototype.onRefresh=function(){this.updateInfo()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ZHIZUN_XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ZHIZUN_XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!1)},t.prototype.updateInfo=function(){var e=JsonModelManager.instance.getModelxiangoulibao3();for(var t in e){var n=e[t];if(n.round==DataManager.getInstance().newactivitysManager.zhizunDay){this.modelCfg=n;var a=n.rewards[0];this.labName.text=n.name;var i,o=Constant.get("XIANGOU_VIP_TIMES");i=o.split(",");var r=DataManager.getInstance().newactivitysManager.zhizunxiangoudate,s=i[DataManager.getInstance().playerManager.player.viplevel];if(i[DataManager.getInstance().playerManager.player.viplevel+1]){var h=DataManager.getInstance().playerManager.player.viplevel+1;this.labDesc2.text="升到VIP"+GameCommon.getInstance().getVipName(h)+"可购买"+i[GameCommon.getInstance().getVipName(h)]+"次"}else this.labDesc2.text="已达到满级VIP购买次数";if(this.btn_buy.visible=!0,r[n.id]&&r[n.id][1]>0){this.labDesc1.text="已购买"+r[n.id][1]+"/"+s+"次";var l,g=Constant.get("XIANGOU_ZHEKOU");l=g.split("#");for(var c=0,p=0;p<l.length;p++){var u=l[p].split(",");r[n.id][1]>=u[0]&&(c=Number(u[1]))}this.bar_recharge.value=r[n.id][1];var d=GameCommon.getInstance().getThingModel(GameCommon.parseAwardItem(n.price).type,GameCommon.parseAwardItem(n.price).id);this.img_cons.source=d.dropicon,this.img_cons1.source=d.dropicon,this.label_points.text=GameCommon.parseAwardItem(n.price).num.toString(),0!=c?(this.label_points1.text=Tool.toInt(GameCommon.parseAwardItem(n.price).num*(c/1e4))+"",this.lineLable.width=this.label_points.width+60):this.label_points1.text=GameCommon.parseAwardItem(n.price).num.toString();var _=DataManager.getInstance().playerManager.player.getICurrency(GameCommon.parseAwardItem(n.price).type);_<GameCommon.parseAwardItem(n.price).num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.item.onUpdate(a.type,a.id,0,a.quality,a.num,a.lv)}else{this.bar_recharge.value=0;var d=GameCommon.getInstance().getThingModel(GameCommon.parseAwardItem(n.gold).type,GameCommon.parseAwardItem(n.gold).id);this.img_cons.source=d.dropicon,this.img_cons1.source=d.dropicon,this.label_points.text=GameCommon.parseAwardItem(n.gold).num.toString(),this.label_points1.text=GameCommon.parseAwardItem(n.gold).num.toString();var _=DataManager.getInstance().playerManager.player.getICurrency(GameCommon.parseAwardItem(n.gold).type);_<GameCommon.parseAwardItem(n.gold).num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.labDesc1.text="已购买0/"+s+"次",this.lineLable.width=this.label_points.width+60,this.item.onUpdate(GameCommon.parseAwardItem(n.goldRewards).type,GameCommon.parseAwardItem(n.goldRewards).id,0,GameCommon.parseAwardItem(n.goldRewards).quality,GameCommon.parseAwardItem(n.goldRewards).num,GameCommon.parseAwardItem(n.goldRewards).lv)}return}}},t.prototype.onTouchBtn=function(){var e=new Message(MESSAGE_ID.ZHIZUN_XIANGOULIBAO_BUY_MESSAGE);e.setShort(this.modelCfg.id),e.setShort(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.DABIAOJIANGLI);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onxiangouBuyover=function(){this.onRefresh()},t.prototype.updateSelected=function(){},t.prototype.onTouchItem=function(e){var t=e.currentTarget;this.index=t.data.id,this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(SaveBuyActivityPanel.prototype,"SaveBuyActivityPanel");var TargetMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_TARGET_MAIN],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n.activityIdNow=[],n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.register(),this.onRefresh()},t.prototype.register=function(){var e,t=[];this.activityIdNow=[];var t=[],n=new RegisterSystemParam;n.redP=this.createRedPoint(),n.tabBtns=[];for(var a=0;a<this.activityIds.length;a++){e=this.activityIds[a];var i=DataManager.getInstance().activityManager.getRegisterTabBtnParam(e);i&&("ActivitysTargetRechargePanel"==i.sysName?i.funcID=FUN_TYPE.FUN_CHONGBANG:"ShenQiTreasurePanel"==i.sysName&&(i.funcID=FUN_TYPE.FUN_SHENQI_CHOUQIAN),n.tabBtns.push(i),i.redP=this.createRedPoint(),i.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",this.activityIds[a]),this.activityIdNow.push(e))}t.push(n),this.registerPage(t,"targetMainGrp",GameDefine.RED_TAB_POS)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);var t=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);t.setByte(0),GameCommon.getInstance().sendMsgToServer(t),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.refreshWhenDelActivity,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CHECKACTIVITY_BTN,this.refreshWhenDelActivity,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.refreshWhenDelActivity,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_CHECKACTIVITY_BTN,this.refreshWhenDelActivity,this)},t.prototype.refreshWhenDelActivity=function(){for(var e=0;e<this.activityIdNow.length;e++)DataManager.getInstance().activityManager.getRegisterSystemParam(this.activityIdNow[e])||this.register()},t.prototype.onShow=function(){this.refreshWhenDelActivity(),e.prototype.onShow.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(TargetMainPanel.prototype,"TargetMainPanel");var ThousandFoldPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tab=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ThousandFoldPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.label_recharge,"充值"),this.label_recharge.touchEnabled=!0,this.label_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this);for(var n=0;n<t.REBATE_MAX_GEARS;n++);this.onRefreshTab(1),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var n=0;n<t.REBATE_MAX_GEARS;n++)this["tab_"+n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBuy,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var n=0;n<t.REBATE_MAX_GEARS;n++)this["tab_"+n].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBuy,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this)},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.label_gold.text=DataManager.getInstance().playerManager.player.gold+""},t.prototype.onTouchBtnBuy=function(){this.onSendMessage()},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onSendMessage=function(){this.tab>t.REBATE_MAX_GEARS},t.prototype.onRefresh=function(){this.onupdateCurrency()},t.prototype.onBuySuccess=function(){if(this.tab<t.REBATE_MAX_GEARS)for(var e=DataManager.getInstance().rebateManager.qianbei_record,n=this.tab+1;n<=t.REBATE_MAX_GEARS;n++)if(!e[n]){this.tab=n;break}this.onRefreshTab(this.tab)},t.prototype.onRefreshTab=function(e){if(!(0>e||e>t.REBATE_MAX_GEARS)){this.tab=e,this["tab_"+(this.tab-1)].selected=!0}},t.prototype.onTouchTab=function(e){var t=parseInt(e.target.value);this.tab!=t&&this.onRefreshTab(t)},t.REBATE_MAX_GEARS=5,t}(BaseWindowPanel);__reflect(ThousandFoldPanel.prototype,"ThousandFoldPanel");var TLGiftPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TLGiftPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TLGIFT_TO_OBTAIN_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TLGIFT_TO_OBTAIN_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){},t.prototype.onShowCD=function(e){this.label_endTime.text="活动结束剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().tLGiftManager;this.label_tab.text=TLGiftDefine.title[e.type],this.img_bannel.source="tLGift_banner"+e.type+"_jpg",this.awardLayer.removeChildren()},t}(BaseWindowPanel);__reflect(TLGiftPanel.prototype,"TLGiftPanel");var TLGiftItem=function(e){function t(){var t=e.call(this)||this;return t.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchBtnReceive,t),t.width=590,t}return __extends(t,e),t.prototype.onUpdate=function(e){this.model=e,this.awardLayer.removeChildren();for(var t,n,a=0;a<e.reward.length;a++){t=e.reward[a];var n=new GoodsInstance;n.scaleX=n.scaleY=.8,n.onUpdate(t.type,t.id,0,t.quality,t.num),this.awardLayer.addChild(n)}var i=DataManager.getInstance().tLGiftManager;this.btn_receive.skinName=skins.Common_ButtonSkin,i.record[e.key]?(this.btn_receive.label="已领取",GameCommon.getInstance().onButtonEnable(this.btn_receive,!1)):i.value>=e.mubiao?(this.btn_receive.label="领取",GameCommon.getInstance().onButtonEnable(this.btn_receive,!0)):(this.btn_receive.skinName=skins.Common_ButtonSkin,this.btn_receive.label="前往",GameCommon.getInstance().onButtonEnable(this.btn_receive,!0)),this.label_progress.text=TLGiftDefine.system[e.type]+"达到"+e.mubiao+"阶("+i.value+"/"+e.mubiao+")"},t.prototype.onTouchBtnReceive=function(e){var t=e.target;if("前往"==t.label)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.model.goType);else if("领取"==t.label){var n=new Message(MESSAGE_ID.TLGIFT_TO_OBTAIN_MESSAGE);n.setByte(this.model.key),GameCommon.getInstance().sendMsgToServer(n)}},t}(eui.Component);__reflect(TLGiftItem.prototype,"TLGiftItem");var TLShopPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TLShopPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.label_recharge,"充值"),this.label_recharge.touchEnabled=!0,this.label_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TLSHOP_TO_BUY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TLSHOP_TO_BUY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onCountDown=function(){},t.prototype.onShowCD=function(e){this.label_endTime.text="活动结束剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.label_gold.text=DataManager.getInstance().playerManager.player.gold+""},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onRefresh=function(){this.examineCD(!0),this.onShowGoodsLayer(),this.onupdateCurrency()},t.prototype.onShowGoodsLayer=function(){this.goodsLayer.removeChildren()},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t}(BaseWindowPanel);__reflect(TLShopPanel.prototype,"TLShopPanel");var TLShopItem=function(e){function t(){var t=e.call(this)||this;return t.btn_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchBtnRecharge,t),t.touchLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouch,t),t}return __extends(t,e),t.prototype.onUpdate=function(e){this.model=e,this.bml_discount.text=e.discount.toString();var t=e.goods;this.thing=GameCommon.getInstance().getThingModel(t.type,t.id);t.quality>=0?t.quality:this.thing.quality;this.img_icon.source=this.thing.icon,this.label_name.textFlow=new Array({text:this.thing.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this.thing.quality)}},{text:"*"+t.num,style:{}}),this.modelPrice=e.price;GameCommon.getInstance().getThingModel(this.modelPrice.type,this.modelPrice.id);this.modeloriginal=e.yuanJia;GameCommon.getInstance().getThingModel(this.modeloriginal.type,this.modeloriginal.id);this.label_original.textFlow=(new egret.HtmlTextParser).parser("<s>"+this.modeloriginal.num+"</s>"),this.label_current.text=""+this.modelPrice.num;var n=DataManager.getInstance().tLShopManager.record[e.id];n&&n.num>=e.max?(this.btn_recharge.label="已购买",GameCommon.getInstance().onButtonEnable(this.btn_recharge,!1),this.sellOutLayer.visible=!0):(this.btn_recharge.label="购买",GameCommon.getInstance().onButtonEnable(this.btn_recharge,!0),this.sellOutLayer.visible=!1),this.shape||(this.shape=new egret.Shape,this.originalLayer.addChild(this.shape)),this.shape.graphics.clear(),this.shape.graphics.lineStyle(1,16711680),this.shape.graphics.moveTo(0,this.originalLayer.height/2),this.shape.graphics.lineTo(this.originalLayer.width,this.originalLayer.height/2)},t.prototype.onTouchBtnRecharge=function(){var e=GameCommon.getInstance().getThingModel(this.modelPrice.type,this.modelPrice.id),t=[{text:"是否花费"+this.modelPrice.num+e.name+"购买此商品",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,this.onSendMessage,this)))},t.prototype.onTouch=function(){if(this.thing){var e=new ThingBase(this.thing.type);e.onupdate(this.thing.id,this.thing.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,this.thing.type,e,0)))}},t.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.TLSHOP_TO_BUY_MESSAGE);e.setInt(this.model.id),e.setInt(1),GameCommon.getInstance().sendMsgToServer(e)},t}(eui.Component);__reflect(TLShopItem.prototype,"TLShopItem");var TurnplateAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TurnplateAwardPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._showleftTime=this.param.autocloseTime,this.param.titleSource&&this.param.titleSource.length>0?this.setTitle(this.param.titleSource):this.basic.title_group.visible=!1,this.result_label.text=this.param.desc,this.onUpdateAward(),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=this.param.btnlabel},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=this.param.btnlabel+("("+this._showleftTime+")"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.param.callFunc&&this.param.callObj&&Tool.callback(this.param.callFunc,this.param.callObj,this.param.callParam),this.param=null,this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&e.prototype.onShow.call(this)},t.prototype.onHide=function(){Tool.removeTimer(this.onCloseTimedown,this,1e3),e.prototype.onHide.call(this)},t.prototype.onUpdateAward=function(){if(this.award_group.removeChildren(),this.param.itemAwards)for(var e=0;e<this.param.itemAwards.length;e++){var t=this.param.itemAwards[e],n=new GoodsInstance;if(n.x=100*Math.floor(e%5),n.y=130*Math.floor(e/5),this.award_group.addChild(n),t.type==GOODS_TYPE.GEM){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.GEM,t.id);n.onUpdate(t.type,t.id,0,t.quality,t.num,a.level)}else n.onUpdate(t.type,t.id,0,t.quality,t.num)}},t}(BaseWindowPanel);__reflect(TurnplateAwardPanel.prototype,"TurnplateAwardPanel");var TurnplateAwardParam=function(){function e(){this.titleSource="",this.desc="",this.btnlabel="确定",this.callFunc=null,this.callObj=null,this.callParam=null,this.autocloseTime=6}return e}();__reflect(TurnplateAwardParam.prototype,"TurnplateAwardParam");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var VIPTLGiftPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VIPTLGiftPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.label_recharge,"充值"),this.label_recharge.touchEnabled=!0,this.label_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPTLGIFT_TO_BUY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPTLGIFT_TO_BUY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onCountDown=function(){},t.prototype.onShowCD=function(e){},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.label_goldbind.text=GameCommon.getInstance().getFormatNumberShow(DataManager.getInstance().playerManager.player.money);var t=DataManager.getInstance().playerManager.player.viplevel;this.label_endTime.text="当前VIP等级："+GameCommon.getInstance().getVipName(t)},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onRefresh=function(){this.onShowGoodsLayer(),this.onupdateCurrency()},t.prototype.onShowGoodsLayer=function(){this.goodsLayer.removeChildren()},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t}(BaseWindowPanel);__reflect(VIPTLGiftPanel.prototype,"VIPTLGiftPanel");var VipTLGiftItem=function(e){function t(){var t=e.call(this)||this;return t.btn_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchBtnRecharge,t),t}return __extends(t,e),t.prototype.onUpdate=function(e){this.model=e,this.bml_discount.text=e.discount.toString();var t=e.goods,n=GameCommon.getInstance().getThingModel(t.type,t.id);t.quality>=0?t.quality:n.quality;this.img_icon.source=n.icon,this.label_name.textFlow=new Array({text:n.name,style:{textColor:GameCommon.getInstance().CreateNameColer(n.quality)}},{text:"*"+t.num,style:{}}),this.modelPrice=e.price;var a=GameCommon.getInstance().getThingModel(this.modelPrice.type,this.modelPrice.id);this.modeloriginal=e.yuanJia;var i=GameCommon.getInstance().getThingModel(this.modeloriginal.type,this.modeloriginal.id);this.label_original.textFlow=(new egret.HtmlTextParser).parser("<s>"+this.modeloriginal.num+"</s>"),this.label_current.text=""+this.modelPrice.num,this.pay_icon.source=i.icon,this.pay_iconCurr.source=a.icon;var o=DataManager.getInstance().vipTLGiftManager.record[e.id],r=DataManager.getInstance().playerManager.player.viplevel;this.vipBuy=this.model.vip[r];var s=0,h=0;o&&(s=o.num),this.vipBuy&&(h=this.vipBuy.max),this.vipBuy&&o&&s>=h&&0!=h?(this.btn_recharge.label="已购买",GameCommon.getInstance().onButtonEnable(this.btn_recharge,!1),this.sellOutLayer.visible=!0):(this.btn_recharge.label="购买",GameCommon.getInstance().onButtonEnable(this.btn_recharge,!0),this.sellOutLayer.visible=!1),this.shape||(this.shape=new egret.Shape,this.originalLayer.addChild(this.shape)),this.shape.graphics.clear(),this.shape.graphics.lineStyle(1,16711680),this.shape.graphics.moveTo(0,this.originalLayer.height/2),this.shape.graphics.lineTo(this.originalLayer.width,this.originalLayer.height/2);for(var l=0,g=0;g<VipDefine.MAX_VIPLEVEL;g++)if(this.model.vip[g]){l=g;break}l=GameCommon.getInstance().getVipName(l),!this.vipBuy||this.vipBuy.lv>r?this.label_hint.textFlow=new Array({text:"提升到VIP"+l+"可购买",style:{textColor:15086130}}):s>=h?this.label_hint.textFlow=new Array({text:"提升VIP增加次数",style:{textColor:15086130}}):this.label_hint.textFlow=new Array({text:" 可购买次数: "+(h-s)+"/"+h,style:{textColor:16777215}})},t.prototype.onTouchBtnRecharge=function(){var e=DataManager.getInstance().playerManager.player.viplevel;if(!this.vipBuy||this.vipBuy.lv>e)return void GameCommon.getInstance().addAlert("未达到购买VIP等级");var t=GameCommon.getInstance().getThingModel(this.modelPrice.type,this.modelPrice.id),n=[{text:"是否花费"+this.modelPrice.num+t.name+"购买此商品",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,this.onSendMessage,this)))},t.prototype.onSendMessage=function(){var e=new Message(MESSAGE_ID.VIPTLGIFT_TO_BUY_MESSAGE);e.setInt(this.model.id),e.setInt(1),GameCommon.getInstance().sendMsgToServer(e)},t}(eui.Component);__reflect(VipTLGiftItem.prototype,"VipTLGiftItem");var HefuActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.params=[],n.activityIdNow=[],n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_WUYi],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.params=[],this.activityIdNow=[],this.points=[];for(var t,n=[],a=0,i=!1,o=0;o<this.activityIds.length;o++){var r=this.activityIds[o],s=DataManager.getInstance().activityManager.getRegisterSystemParam(r);if(s&&(t||(t=new RegisterSystemParam,t.sysName=s.sysName,this.points[a]=new redPoint,t.redP=this.points[a],t.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"checkZhuanPanPoint"),t.tabBtns=[]),t)){var h=new RegisterTabBtnParam,l=JsonModelManager.instance.getModelactivity()[r],g=this.getRedPointFunc(l.panel);g&&(this.points[a]=new redPoint,h.redP=this.points[a],h.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,g),a++),h.sysName=s.sysName,h.tabBtnRes="icon_xianshihuishou_png",r==ACTIVITY_BRANCH_TYPE.ZHUANPANACTIVITY?(this.points[a]=new redPoint,h.redP=this.points[a],h.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"checkZhuanPanPoint"),h.title=DataManager.getInstance().festivalWuYiManager.zhuanpanModel.title,i=!0,h.sysName=DataManager.getInstance().festivalWuYiManager.zhuanpanModel.panel,h.title="节日转盘"):r==ACTIVITY_BRANCH_TYPE.WUYIACTIVITY&&(this.points[a]=new redPoint,h.redP=this.points[a],h.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"loginPoint"),a++,h.title="群仙寻宝"),t.tabBtns.push(h),this.activityIdNow.push(r),this.params.push(s)}}if(i){var s=new RegisterSystemParam;s.sysName="HefuRankPanel",s.title="夏日榜",s.btnRes="icon_xiaribang";var h=new RegisterTabBtnParam;h.sysName="HefuRankPanel",h.title="夏日榜",h.tabBtnRes="icon_xianshihuishou_png",t.tabBtns.push(h),this.params.push(s)}n.push(t),this.basic.tabBtnsBar.nextImg.visible=!1,this.basic.tabBtnsBar.preImg.visible=!1,this.basic.tabBtnsBar.btnGroup.layout.gap=30,this.registerPage(n,"HefuActivityGrp",GameDefine.RED_TAB_POS)},t.prototype.onRegist=function(){var t=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);t.setByte(0),GameCommon.getInstance().sendMsgToServer(t),this.onRefresh(),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){this.setTitle(this.params[this.index].title),e.prototype.onRefresh.call(this)},t.prototype.getRedPointFunc=function(e){var t="";switch(e){case"HefuMissionPanel":t="checkLiyiMissionRedPoint";break;case"HefuPayGiftPanel":break;case"HefuTreasurePanel":t="checkZhuanPanPoint";break;case"HefuTreasurePanel":t="checkZhuanPanPoint"}return t},t.prototype.onRefreshTitle=function(){switch(this.index){case 0:this.setTitle("wuyiTitle1_png");break;case 1:this.setTitle("wuyiTitle2_png");break;case 2:this.setTitle("liuyi_chitang_png")}},t}(BaseSystemPanel);__reflect(HefuActivityPanel.prototype,"HefuActivityPanel");var HefuChouqianPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.LOTTRY_QIAN_MAX=5,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuChouQianPanelSkin},t.prototype.onInit=function(){this.qianRecords=[];for(var t=0;t<this.LOTTRY_QIAN_MAX;t++){var n=this["img_qian"+t];this.qianRecords[t]=new ForgePosInfo(n.x,n.y,n.rotation,n.parent.getChildIndex(n))}e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.lottery_result_grp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeLotteryGrp,this),this.lottery_result_grp.visible=!1},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.lottery_result_grp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeLotteryGrp,this),this.onResetQianPos()},t.prototype.onShowTurnplate=function(){for(var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=0;n<t.length;n++){var a=t[n];e=this["item"+n],e&&e.onUpdate(a.type,a.id,0,a.quality,a.num,a.lv)}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e=Tool.toInt(Math.random()*this.LOTTRY_QIAN_MAX),t=this["img_qian"+e];egret.Tween.get(t).to({y:-150,rotation:0},60).to({x:-100,y:100},300).call(function(e,t){e.parent.setChildIndex(e,e.parent.numChildren-1)},this,[t]).wait(100).to({rotation:-360,x:90,y:0,scaleX:1.3,scaleY:1.3},400).call(this.onPlayDone,this)}},t.prototype.onPlayDone=function(){1==this.manager.tp?(this.one_lottery_goods.onUpdate(this.manager.zhuanpanType,this.manager.zhuanpanId,0,null,this.manager.zhuanpanAwardNum),this.lottery_result_grp.visible=!0,this.lottery_awd_grp.alpha=0,this.lottery_awd_grp.y=700,egret.Tween.get(this.lottery_awd_grp).to({y:300,alpha:1},500,egret.Ease.circIn)):(e.prototype.onShowTenAward.call(this),egret.Tween.get(this.lottery_awd_grp).wait(200).call(this.onResetQianPos,this))
},t.prototype.onShowTenAward=function(){this.onRotateback()},t.prototype.onResetQianPos=function(){for(var e=0;e<this.LOTTRY_QIAN_MAX;e++){var t=this["img_qian"+e];egret.Tween.removeTweens(t);var n=this.qianRecords[e];t.x=n.posX,t.y=n.posY,t.rotation=n.scale,t.scaleX=t.scaleY=1,t.parent.setChildIndex(t,n.childNum)}this.isRun=!1},t.prototype.closeLotteryGrp=function(){this.onResetQianPos(),this.lottery_result_grp.visible=!1},t}(HefuTreasurePanel);__reflect(HefuChouqianPanel.prototype,"HefuChouqianPanel");var HefuFanpaiPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.LOTTRY_CARD_MAX=3,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuFanPaiPanelSkin},t.prototype.onInit=function(){this.cardRecords=[];for(var t=0;t<this.LOTTRY_CARD_MAX;t++){var n=this["lottery_card"+t];this.cardRecords[t]=new ForgePosInfo(n.x,n.y,n.rotation,n.parent.getChildIndex(n))}e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.lottery_result_grp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeLotteryGrp,this),this.lottery_result_grp.visible=!1},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.lottery_result_grp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeLotteryGrp,this),this.onResetQianPos()},t.prototype.onShowTurnplate=function(){this.showawd_grp.removeChildren();for(var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),t=Math.min(e.length,8),n=0;t>n;n++){var a=GameCommon.getInstance().createGoodsIntance(e[n]);this.showawd_grp.addChild(a)}},t.prototype.onRotateback=function(){this.isRun||(this.isRun=!0,egret.Tween.get(this.lottery_card1).to({y:341,x:100,rotation:0},200).wait(100).to({x:302},300),egret.Tween.get(this.lottery_card2).to({y:341,x:100,rotation:0},200).wait(100).to({x:-102},300).call(function(){var e=Tool.toInt(Math.random()*this.LOTTRY_CARD_MAX),t=this["lottery_card"+e];t.parent.setChildIndex(t,t.parent.numChildren-1),egret.Tween.get(t).to({scaleX:0},200).to({scaleX:1},200).to({scaleX:0},200),egret.Tween.get(t).to({x:100,y:200},600).wait(100).call(this.onPlayDone,this)},this))},t.prototype.onPlayDone=function(){1==this.manager.tp?(this.one_lottery_goods.onUpdate(this.manager.zhuanpanType,this.manager.zhuanpanId,0,null,this.manager.zhuanpanAwardNum),this.lottery_result_grp.visible=!0,this.lottery_awd_grp.scaleX=0,egret.Tween.get(this.lottery_awd_grp).to({scaleX:1},500,egret.Ease.circIn)):(e.prototype.onShowTenAward.call(this),egret.Tween.get(this.lottery_awd_grp).wait(200).call(this.onResetQianPos,this))},t.prototype.onResetQianPos=function(){for(var e=0;e<this.LOTTRY_CARD_MAX;e++){var t=this["lottery_card"+e];egret.Tween.removeTweens(t);var n=this.cardRecords[e];t.x=n.posX,t.y=n.posY,t.rotation=n.scale,t.scaleX=t.scaleY=1,t.parent.setChildIndex(t,n.childNum)}this.isRun=!1},t.prototype.onShowTenAward=function(){this.onRotateback()},t.prototype.closeLotteryGrp=function(){this.onResetQianPos(),this.lottery_result_grp.visible=!1},t}(HefuTreasurePanel);__reflect(HefuFanpaiPanel.prototype,"HefuFanpaiPanel");var HefuMissionPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuMissionPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().hefuActManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=HefuMissionItem,this.itemlist.itemRendererSkinName=skins.HefuMissionItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.HEFU_ACT_MISSION_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.HEFU_ACT_MISSION_UPDATE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.HEFU_ACT_MISSION_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.HEFU_ACT_MISSION_UPDATE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){var e=[];for(var t in this.manager.missionDatas)e.push(this.manager.missionDatas[t]);e.sort(function(e,t){return 1==e.count?1:e.count-t.count}),this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.HEFU_MISSION);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(HefuMissionPanel.prototype,"HefuMissionPanel");var HefuMissionItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.btn_reward.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onUpdate=function(){var e=this.data,t=JsonModelManager.instance.getModeltaskhuodong()[e.taskId],n=e.progress>t.count?65280:16711680;this.mission_desc_lab.textFlow=new Array({text:t.name,style:{textColor:15521442}},{text:e.progress+"/"+t.count,style:{textColor:n}}),this.task_icon.source=t.icon,this.reward_items_grp.removeChildren();for(var a=0;a<t.rewards.length;a++){var i=t.rewards[a],o=GameCommon.getInstance().createGoodsIntance(i);this.reward_items_grp.addChild(o)}switch(this.redpoint.visible=!1,this.btn_reward.enabled=!0,e.count){case 0:this.btn_reward.label=Language.instance.getText("goto");break;case 1:this.redpoint.visible=!0,this.btn_reward.label=Language.instance.getText("lingqu2");break;case 2:this.btn_reward.enabled=!1,this.btn_reward.label=Language.instance.getText("mailReceived")}},t.prototype.onReward=function(){var e=this.data;switch(e.count){case 0:var t=JsonModelManager.instance.getModeltaskhuodong()[this.data.taskId];if(36==t.eventType){var n=new ChatPanelParam(CHANNEL.CURRENT,null),a=ChatDefine.ACT_DEFAULT_SHORTCHAT[Math.floor(Math.random()*ChatDefine.ACT_DEFAULT_SHORTCHAT.length)];n.content=Language.instance.getText(a),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",n))}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t.goType);break;case 1:var i=new Message(MESSAGE_ID.HEFU_ACT_MISSION_REWARD);i.setShort(this.data.taskId),GameCommon.getInstance().sendMsgToServer(i)}},t}(BaseListItem);__reflect(HefuMissionItem.prototype,"HefuMissionItem");var HefuPayGiftPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuYiDanChongSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.itemGroup.percentWidth=600,this.itemGroup.percentHeight=636,this.itemGroup.itemRenderer=HefuActDanChongItem,this.itemGroup.itemRendererSkinName=skins.LiuYiDanChongItemSkin,this.itemGroup.useVirtualLayout=!0,this.scroller.viewport=this.itemGroup,this.index=1,this.timeLab.text=GameCommon.getInstance().getTimeStrForSecHS(0),this.onRefresh()},t.prototype.onRefresh=function(){this.onShowAward()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!1)},t.prototype.onShowAward=function(){this.itemGroup.dataProvider=new eui.ArrayCollection(this.models)},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=JsonModelManager.instance.getModeldanbichongzhi();for(var t in e)if(e[t].round==DataManager.getInstance().festivalDanChongManager.day){this.rewardArr.push(e[t])}return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LIUYIACTIVITDANCHONG);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(HefuPayGiftPanel.prototype,"HefuPayGiftPanel");var HefuActDanChongItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.touchEnabled=!1,this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onUpdate=function(){if(this.data&&this.data){for(;this.awards.numChildren>0;){var e=this.awards.getChildAt(0);this.awards.removeChild(e)}1==DataManager.getInstance().festivalDanChongManager.record[this.data.num-1]?(this.btn_reward.label="已达标",this.btn_reward.enabled=!1):(this.btn_reward.label="单笔"+this.data.rmb+"元",this.btn_reward.enabled=!0);for(var t=this.data.rewards,n=0;n<t.length;n++){var a=GameCommon.getInstance().createGoodsIntance(t[n]);a.scaleX=.7,a.scaleY=.7,this.awards.addChild(a)}}},t.prototype.onTouch=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseListItem);__reflect(HefuActDanChongItem.prototype,"HefuActDanChongItem");var HefuRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuRankPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().festivalWuYiManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=HefuActRankItem,this.itemlist.itemRendererSkinName=skins.LiuyiTreasureRankItemSkin,this.itemlist.percentWidth=600,this.itemlist.percentHeight=166,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){for(var e=[],t=0;t<ActivityDefine.LIUYI_ZHUANPAN_AWARD.length;t++)e[t]=t+1;this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ZHUANPANACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.zhuanpanRanks)for(var t=3;t<this.manager.zhuanpanRanks.length;t++){var n=this.manager.zhuanpanRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t}(BaseTabView);__reflect(HefuRankPanel.prototype,"HefuRankPanel");var HefuActRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.ranklist.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.ranklist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this)},t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().festivalWuYiManager.zhuanpanModel,n=ActivityDefine.LIUYI_ZHUANPAN_AWARD[e-1];if(n){var a=GameCommon.getInstance().onParseAwardItemstr(t[n]);this.awards.removeChildren();for(var i=0;i<a.length;i++){var o=a[i],r=GameCommon.getInstance().createGoodsIntance(o);r.scaleX=.7,r.scaleY=.7,this.awards.addChild(r)}var s=DataManager.getInstance().festivalWuYiManager.zhuanpanRanks[e-1];e>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.rank.source="rankbg_4_png",this.rank_num_lab.text="4-10"):s?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.rank.source="rankbg_"+s.rank+"_png",this.rank_num_lab.text=s.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=s.playerName,s.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="今日累计"+s.lotteryNum+"次"):(this.rank.source="rankbg_"+e+"_png",this.rank_num_lab.text=e.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)}},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("LIUYI_ZHUANPAN_LOOP_RANK"))},t}(BaseListItem);__reflect(HefuActRankItem.prototype,"HefuActRankItem");var HefuRechargePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuRechargeSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.progress.minimum=0,this.onRefresh()},t.prototype.onRefresh=function(){this.progress.maximum=1e3,this.progress.value=DataManager.getInstance().hefuActManager.chargeMoneyNum,this.desc.text="当日累充达到1000元免费赠送",DataManager.getInstance().hefuActManager.chargeMoneyNum>=1e3&&(this.btn_pay.label="已达成",this.btn_pay.enabled=!1),this.showpanel()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_pay.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPay,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_pay.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPay,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.HEFU_LEGEND);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t.prototype.onTouchPay=function(){"已达成"!=this.btn_pay.label&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.showpanel=function(){var e=JsonModelManager.instance.getModelhefuleichong()[DataManager.getInstance().hefuActManager.chongbangLiBaoId];this.target_title.source=e.imgtitle;var t;t=GameCommon.getInstance().onParseAwardItemstr(e.rewards1000);var n=t[0];this.frist_item.onUpdate(n.type,n.id,0,n.quality,n.num),this.rewards.removeChildren();for(var a=1;a<t.length;a++){n=t[a];var i=new GoodsInstance;i.onUpdate(n.type,n.id,0,n.quality,n.num),this.rewards.addChild(i)}this.avatar_grp.removeChildren(),this.updateAvatarAnim(e.waixing)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.updateAvatarAnim=function(e){for(this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var t=this.avatar_grp.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.avatar_grp.removeChild(t)}var n=new Animation(e);this.avatar_grp.addChild(n),n.x=this.avatar_grp.width/2,n.y=this.avatar_grp.height/2+this.avatar_grp.height/4},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t}(BaseTabView);__reflect(HefuRechargePanel.prototype,"HefuRechargePanel");var TLShopManager=function(){function e(){this.round=0,this.record={}}return e.prototype.parseMessage=function(e){this.record={};var t;this.round=e.getByte();for(var n=e.getShort(),a=0;n>a;a++)t=new TLShopData,t.parseMessage(e),this.record[t.id]=t},e.prototype.parseBuyMessage=function(e){var t=new TLShopData;t.parseMessage(e),this.record[t.id]=t},e.prototype.getGoodsByRound=function(){},e}();__reflect(TLShopManager.prototype,"TLShopManager");var TLShopData=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getInt(),this.num=e.getInt()},e}();__reflect(TLShopData.prototype,"TLShopData");var HefuXunBaoPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n.endPos=0,n.effectNum=0,n.indexPosX=[85,206,327,447,447,447,447,327,206,85,85,85],n.indexPosY=[305,305,305,305,420,536,653,653,653,653,536,420],n.iconIndex=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuXunBaoPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.best12.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.best12.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this)},t.prototype.onTouchAnim=function(e){var t=e.currentTarget,n=JsonModelManager.instance.getModelbox()[t.name],a=new ThingBase(GOODS_TYPE.BOX);a.onupdate(t.name,n.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,a,0)))},t.prototype.onShowTurnplate=function(){for(var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=0;n<t.length;n++){var a=t[n];if(e=this["item"+n]){if(0==n){var i=GameCommon.getInstance().getThingModel(a.type,a.id,a.quality);this.best12_icon&&(this.best12_icon.source=i.icon),this.best12_name_lab&&(this.best12_name_lab.text=i.name),this.best12&&(this.best12.name=i.id)}e.onUpdate(a.type,a.id,0,a.quality,a.num,a.lv)}}},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0,this.selectEffct.visible=!0;var t=0,n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show);for(t=0;t<n.length;t++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==n[t].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==n[t].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==n[t].num)return this.endPos=24+t,void Tool.addTimer(this.onSelectEffect,this,100);this.isRun=!1,e.prototype.onRefresh.call(this),e.prototype.onShowAward.call(this)}},t.prototype.onSelectEffect=function(){return this.selectEffct.x=this.indexPosX[this.iconIndex],this.selectEffct.y=this.indexPosY[this.iconIndex],this.iconIndex=this.iconIndex+1,this.iconIndex>=11&&(this.iconIndex=0),this.effectNum=this.effectNum+1,this.effectNum>=this.endPos?(this.effectNum=0,Tool.removeTimer(this.onSelectEffect,this,100),this.isRun=!1,e.prototype.onRefresh.call(this),e.prototype.onShowAward.call(this),void(this.iconIndex=0)):void 0},t}(HefuTreasurePanel);__reflect(HefuXunBaoPanel.prototype,"HefuXunBaoPanel");var HefuZaDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuZaDanPanelSkin},t.prototype.onInit=function(){this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.showAwardPanel.visible=!1,this.podan.visible=!1,this.danIcon.visible=!0},t.prototype.onShowTurnplate=function(){for(var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=0;n<t.length;n++){var a=t[n];e=this["item"+n],e&&e.onUpdate(a.type,a.id,0,a.quality,a.num,a.lv)}},t.prototype.onRotateback=function(){if(!this.isRun){for(this.isRun=!0;this.zadanEffect.numChildren>0;){var e=this.zadanEffect.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.zadanEffect.removeChild(e)}DataManager.getInstance().xiandanManager.stats=0;var t=new Animation("zadan_01");t.autoRemove=!1,t.playNum=1,t.playFinishCallBack(this.onAnimFinish,this),this.zadanEffect.addChild(t),t.y=50}},t.prototype.onAnimFinish=function(){this.showAwardPanel.visible=!0;var t=0,n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show);for(t=0;t<n.length;t++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==n[t].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==n[t].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==n[t].num){var a=this.itemNb;if(a)return a.onUpdate(n[t].type,n[t].id,0,n[t].quality,n[t].num,n[t].lv),this.podan.visible=!0,this.danIcon.visible=!1,e.prototype.onRefresh.call(this),e.prototype.onShowAward.call(this),void(this.isRun=!1)}this.podan.visible=!0,this.danIcon.visible=!1,this.isRun=!1,e.prototype.onRefresh.call(this),e.prototype.onShowAward.call(this)},t}(HefuTreasurePanel);__reflect(HefuZaDanPanel.prototype,"HefuZaDanPanel");var NewHefuActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.params=[],n.activityIdNow=[],n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_HEFU],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.params=[],this.activityIdNow=[],this.points=[];for(var t=[],n=0,a=0;a<this.activityIds.length;a++){var i=this.activityIds[a],o=DataManager.getInstance().activityManager.getRegisterSystemParam(i);if(o){var r=JsonModelManager.instance.getModelactivity()[i],s=this.getRedPointFunc(r.panel);s&&(this.points[n]=new redPoint,o.redP=this.points[n],o.redP.addTriggerFuc(DataManager.getInstance().hefuActManager,s),n++),t.push(o),this.params.push(o),this.activityIdNow.push(i)}}this.registerPage(t,"NewHefuActivityGrp",GameDefine.RED_TAB_POS),this.onRefresh()},t.prototype.getRedPointFunc=function(e){var t="";switch(e){case"HefuMissionPanel":t="checkHefuMissionRedPoint"}return t},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){this.setTitle(this.params[this.index].title),e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(NewHefuActivityPanel.prototype,"NewHefuActivityPanel");var ActJueXingDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.isMove=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActJueXingDanSkin},t.prototype.onInit=function(){this.jxdManager=DataManager.getInstance().jxdManager,e.prototype.onInit.call(this),this.groupMoveTop=this.groupAni.y},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.updateUI(),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventPay,this),this.setAnimMove(),this.startTime()},t.prototype.setAnimMove=function(){if(this.groupAni.y=this.groupMoveTop,this.isMove){var e=egret.Tween.get(this.groupAni,{loop:!0});e.to({y:this.groupMoveTop-50},2e3),e.to({y:this.groupMoveTop},2e3)}},t.prototype.startTime=function(){Tool.addTimer(this.updateTime,this,1e3)},t.prototype.closeTime=function(){Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.JUEXINGDAN);this.lbTime.text="活动剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,3),0>=e&&this.closeTime()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),egret.Tween.removeTweens(this.groupAni),this.closeTime(),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventPay,this)},t.prototype.updateUI=function(){var e=this.jxdManager.checkModel();if(this.blessType!=e.type){this.blessType=e.type,this.initAni(this.blessType);var t=e.rewards[0],n=GameCommon.getInstance().getThingModel(t.type,t.id);this.shenqi_name.text=n.name,this.goods.onUpdate(t.type,t.id,0,t.quality,t.num),this.goods.name_label.visible=this.goods.num_label.visible=!1}this.coatard_exp_pro.maximum=this.jxdManager.payMax,this.coatard_exp_pro.value=this.jxdManager.payNum,this.jxdManager.isPayFull()?this.lbAlert.text="您已累充达到"+this.jxdManager.payMax+"元，奖励已通过邮件发放":this.lbAlert.text="活动当天累充达到"+this.jxdManager.payMax+"元可免费获取"},t.prototype.initAni=function(e){for(;this.anim_grp.numChildren>0;){var t=this.anim_grp.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.anim_grp.removeChild(t)}var n=DataManager.getInstance().blessManager,a=n.getPlayerBlessData(e),i=n.getBlessModelByData(a);i=i?i:n.getBlessModel(e,1,1);this.isMove=!1},t.prototype.onEventPay=function(){this.onHide(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseWindowPanel);__reflect(ActJueXingDanPanel.prototype,"ActJueXingDanPanel");var LuckTurnplatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("luckTurnplate_title_png"),GameCommon.getInstance().addUnderlineStr(this.label_recharge,"充值"),this.label_recharge.touchEnabled=!0,this.label_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.LuckTurnplatePanelSkin},t.prototype.onRefresh=function(){this.onShowAward(),this.data=DataManager.getInstance().luckTurnplateManager;var e=DataManager.getInstance().playerManager.player;this.label_points.text=this.model.cost.toString(),this.bmt_total.text=this.data.totalMoney.toString();var t=this.data.needMoney>this.data.totalMoney||this.model.cost>e.gold;this.img_disable.visible=t,GameCommon.getInstance().onButtonEnable(this.btn_invest,!t),this.onupdateCurrency(),this.onUpdateLog()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_invest.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRotate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onRotateback,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onChange,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),this.examineCD(!0),this.isRun=!1},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_invest.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRotate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onRotateback,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onChange,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),this.examineCD(!1),egret.Tween.removeTweens(this.turnplateLayer),this.turnplateLayer.rotation=60*(6-DataManager.getInstance().luckTurnplateManager.bidding),GameDefine.SHIELD_TXT_HINT=!1,GameCommon.getInstance().onDispatchEvent(MESSAGE_ID.PLAYER_CURRENCY_UPDATE)},t.prototype.onChange=function(){GameDefine.SHIELD_TXT_HINT||this.onRefresh()},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.label_gold.text=DataManager.getInstance().playerManager.player.gold.toString()},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){},t.prototype.onShowCD=function(e){this.label_endTime.text="活动结束剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onUpdateLog=function(){GameDefine.SHIELD_TXT_HINT||(this.label_log.textFlow=DataManager.getInstance().luckTurnplateManager.getTextFlow(),setTimeout(this.adjustChatBar.bind(this),100))},t.prototype.adjustChatBar=function(){this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e;e=this.getRotationLong(6,4,6,6-DataManager.getInstance().luckTurnplateManager.bidding),egret.Tween.get(this.turnplateLayer).to({rotation:e},4e3,egret.Ease.sineInOut).wait(1e3).call(this.onPlayDone,this)}},t.prototype.onRotate=function(){var e=DataManager.getInstance().playerManager.player;return this.model.cost>e.gold?void GameCommon.getInstance().addAlert("钻石不足"):(GameDefine.SHIELD_TXT_HINT=!0,GameCommon.getInstance().onButtonEnable(this.btn_invest,!1),this.img_disable.visible=!0,void DataManager.getInstance().luckTurnplateManager.onSendMessage())},t.prototype.getRotationLong=function(e,t,n,a){var i=360/e*a,o=360*(Math.floor(Math.random()*(n-t))+t);return o+i},t.prototype.onShowAward=function(){var e=DataManager.getInstance().luckTurnplateManager.currAward;if(e>0){var t=new LuckTurnplateWinParam;t.currAward=e,t.autocloseTime=6,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LuckTurnplateWinPanel",t)),DataManager.getInstance().luckTurnplateManager.currAward=0}},t.prototype.onPlayDone=function(){this.isRun=!1,GameDefine.SHIELD_TXT_HINT=!1,this.onShowAward(),this.onRefresh(),GameCommon.getInstance().onDispatchEvent(MESSAGE_ID.PLAYER_CURRENCY_UPDATE)
},t}(BaseWindowPanel);__reflect(LuckTurnplatePanel.prototype,"LuckTurnplatePanel");var LuckTurnplateWinPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LuckTurnplateWinPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._showleftTime=this.param.autocloseTime,this.onUpdateAward(),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=this.param.btnlabel},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=this.param.btnlabel+("("+this._showleftTime+")"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.param.callFunc&&this.param.callObj&&Tool.callback(this.param.callFunc,this.param.callObj,this.param.callParam),this.param=null,this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&e.prototype.onShow.call(this)},t.prototype.onHide=function(){Tool.removeTimer(this.onCloseTimedown,this,1e3),e.prototype.onHide.call(this)},t.prototype.onUpdateAward=function(){this.label_savvy.text="银币*"+this.param.currAward},t}(BaseWindowPanel);__reflect(LuckTurnplateWinPanel.prototype,"LuckTurnplateWinPanel");var LiuYiActivityPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.setTitle("wuyiTitle1_png");var t=JsonModelManager.instance.getModelactivityGroup()[21],n=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);n.setByte(0),GameCommon.getInstance().sendMsgToServer(n);var a=[],i=new RegisterSystemParam,o=!1;if(this.isShow)var r=t.activityId.split(",");this.points=RedPointManager.createPoint(r.length);for(var s=0,h=0;h<r.length;h++)if(DataManager.getInstance().activityManager.getActivityCD(Number(r[h]))>0)switch(Number(r[h])){case 15:o=!0,i.sysName="LiuYiTreasurePanel",i.btnRes="liuyiBtn1",i.redP=this.points[s],i.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"checkZhuanPanPoint"),a.push(i);break;case 18:i=new RegisterSystemParam,i.sysName="LiuYiLoginActivityPanel",i.btnRes="liuyiBtn2",i.redP=this.points[s],i.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"loginPoint"),a.push(i);break;case 20:i=new RegisterSystemParam,i.sysName="LiuYiDanChongPanel",i.btnRes="liuyiBtn4",a.push(i);break;case 21:i=new RegisterSystemParam,i.sysName="LiuyiMissionPanel",i.btnRes="liuyiBtn5",i.redP=this.points[s],i.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"checkLiyiMissionRedPoint"),a.push(i)}o&&(i=new RegisterSystemParam,i.sysName="LiuyiTreasureRankPanel",i.btnRes="icon_xiaribang",a.push(i)),this.registerPage(a,"LiuYiActivityGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("wuyiTitle1_png");break;case 1:this.setTitle("wuyiTitle2_png");break;case 2:this.setTitle("liuyi_chitang_png");break;case 5:this.setTitle("z_xiaribang_png");break;case 5:this.setTitle("liuyi_huoyuerenwu_png")}e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(LiuYiActivityPanel.prototype,"LiuYiActivityPanel");var LiuYiDanChongPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuYiDanChongSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.itemGroup.itemRenderer=ActivityDanChongItem,this.itemGroup.itemRendererSkinName=skins.LiuYiDanChongItemSkin,this.itemGroup.useVirtualLayout=!0,this.index=1,this.timeLab.text="0天0时0分0",this.onRefresh()},t.prototype.onRefresh=function(){this.onShowAward()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onShowAward,this),this.examineCD(!1)},t.prototype.onShowAward=function(){this.itemGroup.dataProvider=new eui.ArrayCollection(this.models),this.showdate()},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=JsonModelManager.instance.getModeldanbichongzhi();for(var t in e)if(e[t].round==DataManager.getInstance().festivalDanChongManager.day){this.rewardArr.push(e[t])}return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.showdate=function(){},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LIUYIACTIVITDANCHONG);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(LiuYiDanChongPanel.prototype,"LiuYiDanChongPanel");var ActivityDanChongItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.touchEnabled=!1,this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onUpdate=function(){if(this.data&&this.data){for(;this.awards.numChildren>0;){var e=this.awards.getChildAt(0);this.awards.removeChild(e)}1==DataManager.getInstance().festivalDanChongManager.record[this.data.num-1]?(this.btn_reward.label="已达标",this.btn_reward.enabled=!1):(this.btn_reward.label="单笔"+this.data.rmb+"元",this.btn_reward.enabled=!0);for(var t=this.data.rewards,n=0;n<t.length;n++){var a=new GoodsInstance,i=t[n];a.onUpdate(i.type,i.id,0,i.quality,i.num,i.lv),this.awards.addChild(a)}}},t.prototype.onTouch=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseListItem);__reflect(ActivityDanChongItem.prototype,"ActivityDanChongItem");var LiuYiLoginActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tabIdx=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuYiLoginActivitySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=DataManager.getInstance().festivalLoginManager;for(var n in t.record)this.tabIdx=this.tabIdx+1;0==this.tabIdx&&(this.tabIdx=1),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_getReward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this);for(var t=1;4>t;t++)this["boxIcon"+t].name=t,this["boxIcon"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=1;4>t;t++)this["boxIcon"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);this.btn_getReward.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.onShowAward(this.tabIdx)},t.prototype.onShowAward=function(e){for(var t=DataManager.getInstance().festivalLoginManager,n=1;4>n;n++){n==this.tabIdx?(this["boxIcon"+n].source="activityboxSelect_png",this.curSelectBox.x=180*n-205):this["boxIcon"+n].source="activitybox_png";var a=t.record[n];a&&2==a.state&&(this["boxIcon"+n].source="activityboxOpen_png")}this.loginActCfg=JsonModelManager.instance.getModeldengluhuodong()[e-1];for(var i=this.loginActCfg.rewards;this.award_grp.numChildren>0;){var o=this.award_grp.getChildAt(0);this.award_grp.removeChild(o)}for(var n=0;n<i.length;n++){var r=new GoodsInstance,s=i[n];r.onUpdate(s.type,s.id,0,s.quality,s.num,s.lv),this.award_grp.addChild(r)}var h=t.record[e];if(h)switch(this.btn_getReward.enabled=1==h.state,h.state){case 0:this.btn_getReward.label="已过期";break;case 1:this.btn_getReward.label="领取奖励";break;case 2:this.btn_getReward.label="已领取"}else this.btn_getReward.enabled=!1,this.btn_getReward.label="未开启"},t.prototype.onTab=function(e){var t=Number(e.target.name);this.tabIdx!=t&&(this.tabIdx=t,this.onShowAward(this.tabIdx))},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.WUYIACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE);e.setByte(this.loginActCfg.days),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onGetAward=function(){var e=new Message(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE);e.setByte(this.loginActCfg.days),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(LiuYiLoginActivityPanel.prototype,"LiuYiLoginActivityPanel");var LiuyiMissionPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuyiMissionPanel},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().festivalWuYiManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=LiuyiMissionItem,this.itemlist.itemRendererSkinName=skins.HefuMissionItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_MISSION_ACT_UPDATE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_MISSION_ACT_REWARD.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_MISSION_ACT_UPDATE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_MISSION_ACT_REWARD.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){var e=[];for(var t in this.manager.liuyiMission)e.push(this.manager.liuyiMission[t]);e.sort(function(e,t){return 1==e.count?1:e.count-t.count}),this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.LIUYI_MISSION);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(LiuyiMissionPanel.prototype,"LiuyiMissionPanel");var LiuyiMissionItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.btn_reward.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onUpdate=function(){var e=this.data,t=JsonModelManager.instance.getModeltaskhuodong()[e.taskId];this.mission_desc_lab.text=t.name,this.task_icon.source=t.icon,this.mission_probar.maximum=t.count,this.mission_probar.value=e.progress;var n=t.rewards[0];switch(this.reward_item.onUpdate(n.type,n.id,0,null,n.num),e.count){case 0:this.btn_reward.enabled=!0,this.btn_reward.label=Language.instance.getText("goto");break;case 1:this.btn_reward.enabled=!0,this.btn_reward.label=Language.instance.getText("lingqu2");break;case 2:this.btn_reward.enabled=!1,this.btn_reward.label=Language.instance.getText("mailReceived")}},t.prototype.onReward=function(){var e=this.data;switch(e.count){case 0:var t=JsonModelManager.instance.getModeltaskhuodong()[this.data.taskId];if(36==t.eventType){var n=new ChatPanelParam(CHANNEL.CURRENT,null),a=ChatDefine.ACT_DEFAULT_SHORTCHAT[Math.floor(Math.random()*ChatDefine.ACT_DEFAULT_SHORTCHAT.length)];n.content=Language.instance.getText(a),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",n))}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t.goType);break;case 1:var i=new Message(MESSAGE_ID.FESTIVAL_MISSION_ACT_REWARD);i.setShort(this.data.taskId),GameCommon.getInstance().sendMsgToServer(i)}},t}(BaseListItem);__reflect(LiuyiMissionItem.prototype,"LiuyiMissionItem");var LiuYiTreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.WEEK_AWD_MAX=4,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuYiTreasurePanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().festivalWuYiManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.currHasNum=[],this.points[0].register(this.reward_week_btn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().festivalWuYiManager,"checkTreasurePoint");for(var t=this.manager.zhuanpanModel.box.split("#"),n=0;4>n;n++){var a=t[n]?t[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this["award_times_lab"+n].text=Language.instance.getText(i,"times"),this["award_box_img"+n].name=a[1],this["award_box_img"+n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this)}for(var n=0;8>n;n++)this["img_icon"+n].name=n+"";this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),this.reward_week_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this);for(var t=0;8>t;t++)this["img_icon"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAwardTips,this);this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.reward_week_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_INVESTTURNPLATE_MESSAGE.toString(),this.onUpdateLog,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this);for(var t=0;8>t;t++)this["img_icon"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAwardTips,this);this.examineCD(!1)},t.prototype.onRefresh=function(){this.isRun=!1,this.onUpdateLog(),this.onUpdateWeekAward(),this.onShowTurnplate(),this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);e.setByte(2),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onUpdateLog=function(){this.label_log.textFlow=DataManager.getInstance().festivalWuYiManager.getTextFlow(),setTimeout(this.adjustChatBar.bind(this),10)},t.prototype.adjustChatBar=function(){this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.WUYIACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onNextData=function(){this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum;var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id);e?e.num:0;if(e&&e.num>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899}var n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=n[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<n[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t.prototype.onPlayDone=function(){this.onShowAward(),this.onRefresh()},t.prototype.onUpdateWeekAward=function(){this.reward_week_btn.enabled=!1;var e=DataManager.getInstance().festivalWuYiManager,t=this.manager.zhuanpanModel,n=t.box.split("#"),a=0;for(this.nextNBItemDesc.text="";this.nbItem.numChildren>0;){var i=this.nbItem.getChildAt(0);this.nbItem.removeChild(i)}for(var o=0;o<this.WEEK_AWD_MAX;o++){var r=n[o]?n[o].split(","):null;if(!r)break;var s=parseInt(r[0]),h=this["award_box_img"+o],l=this["reward_anim_grp"+o],g=parseInt(r[0]);if(this["award_times_lab"+o].text=Language.instance.getText(g,"times"),l.removeChildren(),e.treasureAwdIdx>=s)a+=1,h.source="icon_tangguo01_png";else if(h.source="icon_tangguo02_png",e.zhuanpanNum>=s)this.reward_week_btn.enabled||(this.reward_week_btn.enabled=!0),GameCommon.getInstance().addAnimation("baoxiangtixing",null,l,-1),a+=1;else if(a==o){var c=JsonModelManager.instance.getModelbox()[parseInt(r[1])],p=new GoodsInstance,u=c.rewards[0];p.onUpdate(u.type,u.id,0,u.quality,u.num,u.lv),this.nextNBItemDesc.text="再抽"+(s-e.zhuanpanNum)+"次可获得",this.nbItem.addChild(p)}}},t.prototype.onTouchBox=function(e){var t=e.currentTarget,n=JsonModelManager.instance.getModelbox()[t.name],a=new ThingBase(GOODS_TYPE.BOX);a.onupdate(t.name,n.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,a,0)))},t.prototype.onShowAwardTips=function(e){var t=parseInt(e.currentTarget.name),n=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show)[t];if(n){var a,i;n.type==GOODS_TYPE.MASTER_EQUIP||n.type==GOODS_TYPE.SERVANT_EQUIP?(a=new EquipThing(n.type),a.onupdate(n.id,n.quality,0),i=INTRODUCE_TYPE.EQUIP):(a=new ThingBase(n.type),a.onupdate(n.id,n.quality,0),i=INTRODUCE_TYPE.IMG),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(i,n.type,a,n.uid)))}},t.prototype.onTreasureBackMsg=function(){1==DataManager.getInstance().festivalWuYiManager.tp?(this.onNextData(),this.onRotateback()):10==DataManager.getInstance().festivalWuYiManager.tp||9==DataManager.getInstance().festivalWuYiManager.tp?this.onShowTenAward():this.onRefresh()},t.prototype.onShowTenAward=function(){var e=new TurnplateAwardParam;e.desc="十连抽获得以下奖励",e.titleSource="",e.itemAwards=DataManager.getInstance().festivalWuYiManager.temAward,e.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",e)),this.onRefresh()},t.prototype.onShowAward=function(){for(var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),t=0;t<e.length;t++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==e[t].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==e[t].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==e[t].num){var n=DataManager.getInstance().bagManager.getGoodsThingNumById(e[t].id,e[t].type)-this.currHasNum[t];if(n>0){var a=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);GameCommon.getInstance().onGetThingAlert(a,n,GOODS_CHANGE_TYPE.DELAY_ADD)}}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e=(this.manager.zhuanpanModel.show.split("#"),0),t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show);for(e=0;e<t.length;e++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==t[e].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==t[e].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==t[e].num){var n;return n=this.getRotationLong(8,4,3,e,1),void egret.Tween.get(this.disc_outside).to({rotation:n},2e3,egret.Ease.sineInOut).call(this.onPlayDone,this).wait(2300).call(this.onReady,this)}this.isRun=!1}},t.prototype.onHide=function(){this.isRun=!1,e.prototype.onHide.call(this)},t.prototype.onReady=function(){this.isRun=!1},t.prototype.getRotationLong=function(e,t,n,a,i){void 0===i&&(i=1);var o=360/e*a*i,r=360*(Math.floor(Math.random()*(n-t))+t)*i;return r+o},t.prototype.onTouchBtnTurn1=function(){if(!this.isRun){var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=e[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);if(t<e[0].num)return void GameCommon.getInstance().addAlert("error_tips_2");if(!GameFight.getInstance().checkBagIsFull()){var n=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);n.setByte(9),GameCommon.getInstance().sendMsgToServer(n)}}},t.prototype.onTouchBtnTurn=function(){if(!this.isRun){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(0==t){var n=DataManager.getInstance().playerManager.player.getICurrency(5);if(n<this.manager.zhuanpanModel.costList[1].num)return void GameCommon.getInstance().addAlert("error_tips_2")}if(!GameFight.getInstance().checkBagIsFull()){var a=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onShowTurnplate=function(){var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=(this.manager.zhuanpanModel.show.split("#"),0);for(n=0;n<t.length;n++){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(t[n].id,t[n].type);this.currHasNum[n]=a,e=GameCommon.getInstance().getThingModel(t[n].type,t[n].id),this["img_icon"+n].source=e.icon,this["label_num"+n].textFlow=new Array({text:e.name+"*"+t[n].num,style:{textColor:GameCommon.getInstance().CreateNameColer(e.quality)}})}var i=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),o=i?i.num:0;if(o>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,e=GameCommon.getInstance().getThingModel(this.manager.zhuanpanModel.costList[1].type,this.manager.zhuanpanModel.costList[1].id),this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var r=DataManager.getInstance().playerManager.player.getICurrency(5);r<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.img_cons.source=e.dropicon}var s=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costTen);this.label_points1.text=s[0].num.toString();var r=DataManager.getInstance().playerManager.player.getICurrency(5);r<s[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t}(BaseTabView);__reflect(LiuYiTreasurePanel.prototype,"LiuYiTreasurePanel");var LiuyiTreasureRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LiuyiTreasureRankPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().festivalWuYiManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=LiuyiTreasureItem,this.itemlist.itemRendererSkinName=skins.LiuyiTreasureRankItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.FESTIVAL_TURNPLATE_LOTTERY_RANK);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){for(var e=[],t=0;t<ActivityDefine.LIUYI_ZHUANPAN_AWARD.length;t++)e[t]=t+1;this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ZHUANPANACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.zhuanpanRanks)for(var t=3;t<this.manager.zhuanpanRanks.length;t++){var n=this.manager.zhuanpanRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t}(BaseTabView);__reflect(LiuyiTreasureRankPanel.prototype,"LiuyiTreasureRankPanel");var LiuyiTreasureItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.ranklist.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.ranklist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this)},t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().festivalWuYiManager.zhuanpanModel,n=ActivityDefine.LIUYI_ZHUANPAN_AWARD[e-1];if(n){var a=GameCommon.getInstance().onParseAwardItemstr(t[n]);this.awards.removeChildren();for(var i=0;i<a.length;i++){var o=a[i],r=GameCommon.getInstance().createGoodsIntance(o);this.awards.addChild(r)}var s=DataManager.getInstance().festivalWuYiManager.zhuanpanRanks[e-1];e>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.rank.source="rankbg_4_png",this.rank_num_lab.text="4-10"):s?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.rank.source="rankbg_"+s.rank+"_png",this.rank_num_lab.text=s.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=s.playerName,s.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="今日累计转盘"+s.lotteryNum+"次"):(this.rank.source="rankbg_"+e+"_png",this.rank_num_lab.text=e.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)}},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("LIUYI_ZHUANPAN_LOOP_RANK"))},t}(BaseListItem);__reflect(LiuyiTreasureItem.prototype,"LiuyiTreasureItem");var ActivityPublicPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onShowWithParam=function(e){this.modelGroup=e,this.onShow()},t.prototype.onInit=function(){e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);var t=new RegisterSystemParam;this.activityIds=GameCommon.parseIntArray(this.modelGroup.activityId);for(var n=0,a=[],i=0;i<this.activityIds.length;i++){var o=this.activityIds[i],r=DataManager.getInstance().activityManager.getRegisterTabBtnParam(o);if(r){var s=this.getActivityModel(o);if(!s)continue;r.tabBtnRes=s.icon,r.title=s.title,r.redP=this.createRedPoint(),r.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",o),n++,a.push(r)}}t.tabBtns=a,this.registerPage([t],"activityPublicGrp",GameDefine.RED_TAB_POS),this.params=a,a&&this.index>=a.length&&(this.index=0),this.currPanel||this.onRefresh()},t.prototype.getActivityModel=function(e){return 1e4>e?JsonModelManager.instance.getModelactivity()[e]:JsonModelManager.instance.getModelactivityFunction()[e]},t}(BaseSystemPanel);__reflect(ActivityPublicPanel.prototype,"ActivityPublicPanel");var FirstChargePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.btn_rechargeArray=[],n.charge_labelArray=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FirstChargePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("首充"),this.best_zuoqi_item.onUpdate(GOODS_TYPE.ITEM,GoodsDefine.ITEM_FIRSTPAY_FASHION),this.best_xuanqi_item.onUpdate(GOODS_TYPE.ITEM,GoodsDefine.ITEM_FIRSTPAY_XUANQI);var t=[];for(var n in JsonModelManager.instance.getModelpay()){var a=JsonModelManager.instance.getModelpay()[n];5==a.type&&t.push(a)}t.sort(function(e,t){return e.rmb-t.rmb});for(var i=0;i<t.length;i++){var o=t[i],r=this["charge_btn"+i];if(!r)break;r.label=o.rmb+"元",r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this);var s=this["charge_rmb_lab"+i];s.text=o.diamond+o.gold+""}GameCommon.getInstance().addAnimation("jian3",null,this.best_anim_grp,-1),this.best_anim_grp.scaleX=.8,this.best_anim_grp.scaleY=.8,this.onStartFloatAnim();var h=new Animation("chongzhianniudonghua");this.ani.addChild(h),this.ani.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),this.awards.removeChildren();for(var n in JsonModelManager.instance.getModelfirstPay()){var l,g=JsonModelManager.instance.getModelfirstPay()[n];l=g.rewards;for(var c=0;c<l.length&&!(c>=5);c++){var p=l[c],u=new GoodsInstance;u.scaleX=.8,u.scaleY=.8,u.onUpdate(p.type,p.id,0,p.quality,p.num),this.awards.addChild(u)}}this.onRefresh()},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.best_anim_grp.y,this.best_anim_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)
},t.prototype.onFrame=function(){this.moveUp?(this.best_anim_grp.y--,this.best_anim_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.best_anim_grp.y++,this.best_anim_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onHide,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onHide,this),e.prototype.onRemove.call(this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){this.onUpdate()},t.prototype.onUpdate=function(){this.onShowVIPInfo()},t.prototype.onShowVIPInfo=function(){},t.prototype.onTouchBtnRecharge=function(e){var t=parseInt(e.currentTarget.name),n=t+"元超级首充";SDKManager.pay({goodsName:n,amount:t,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))},t}(BaseWindowPanel);__reflect(FirstChargePanel.prototype,"FirstChargePanel");var GodWeaponRechargePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.names=[],n.tab_num=1,n.flag=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.GodWeaponRechargeSkin},t.prototype.onInit=function(){this.shenqiModelMap=JsonModelManager.instance.getModelshenqi(),this.tab_group.removeChildren(),this.tabList=[];for(var t in this.shenqiModelMap){var n=new TujianTabItem;n.type=parseInt(t),n.tabFace="shenqi_icon_"+n.type+"_png",n.name="tab_"+n.type,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this),this.tab_group.addChild(n),this.tabList.push(n);var a=this.shenqiModelMap[t];this.names.push(a[1].name)}this.coatard_exp_pro.maximum=1e3,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.shenqiTimeCircle=function(){if("pay"==this.currentState){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.NEWGODGIFT);this.shenqi_time.text="活动剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,2)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.show_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEquipt,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE.toString(),this.onRefresh,this),Tool.addTimer(this.shenqiTimeCircle,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.anim_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.show_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEquipt,this),this.anim_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),Tool.removeTimer(this.shenqiTimeCircle,this,1e3)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){if(DataManager.getInstance().activityManager.activity[ACTIVITY_BRANCH_TYPE.NEWGODGIFT]){var t=DataManager.getInstance().newactivitysManager.shenqiData1;this.coatard_exp_pro.value=t.sum;var n=this.tabList[t.round];n.data=t,this.selectTab(n)}else this.selectTab(this.tabList[this.tab_num-1]);e.prototype.onRefresh.call(this)},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.selectTab(t)},t.prototype.selectTab=function(e){this.tab_num=e.type,this.currentState="active";var t=e.data;t&&(this.currentState="pay",t.isgoal&&(this.currentState="active",this.red_point_img.visible=DataManager.getInstance().legendManager.getCanLegendAdvance(t.round+1)));var n=this.getPlayerData().getLegendBase(this.tab_num),a=1;this.getPlayerData().isLegendActive(this.tab_num)&&(this.currentState="upgrade",a=n.lv);for(var i in this.tabList)this.tabList[i].type==e.type?this.tabList[i].tabBack="tujian_tab_back_selected_png":this.tabList[i].tabBack="tujian_tab_back_png";this.anim_grp.removeChildren();var o=new Animation("shenqi_"+e.type);this.anim_grp.addChild(o),this.onStartFloatAnim();var r=this.shenqiModelMap[e.type][a-1];this.getDesc(r);for(var s=GameCommon.getInstance().getAttributeAry(),h=0;h<ATTR_TYPE.SIZE;++h)s[h]+=GameCommon.getInstance().getAttributeAry(r)[h];var l;l=this.powerbar,l.power=(GameCommon.calculationFighting(s)+r.ewaizhanli).toString(),this.shenqi_name.text=this.names[e.type-1]+"",this.shenqi_z.source="shenqi_z"+e.type+"_png"},t.prototype.getDesc=function(e){var t=e.gailv,n=e.xiaoguo,a=e.attack,i=e.hp,o=e.phyDef,r=e.magicDef,s="";switch(e.id){case 1:s="每一次攻击有[#07FF00"+t/100+"]%的概率造成对方眩晕，持续[#07FF00"+n/1e3+"]秒\n";break;case 5:s="每一次攻击有[#07FF00"+t/100+"]%的概率造成对方沉默，只能释放基础剑法持续[#07FF00"+n/1e3+"]秒\n";break;case 2:s="死亡后自动复活，恢复最大生命值的[#07FF00"+n/100+"]%\n";break;case 3:s="直接忽视对方防御，对其额外造成自身攻击力[#07FF00"+n/100+"]%的伤害\n";break;case 4:s="增加一层护盾状态，有效吸收对方[#07FF00"+n/100+"]%的伤害\n"}s=s+"生命+[#07FF00"+i+"]\n攻击+[#07FF00"+a+"]\n物防+[#07FF00"+o+"]\n法防+[#07FF00"+r+"]\n";var h=GameCommon.getInstance().readStringToHtml(s);this.shenqi_desc.lineSpacing=5,this.shenqi_desc.textFlow=(new egret.HtmlTextParser).parser(h)},t.prototype.onClick=function(e){e.currentTarget;if("pay"==this.currentState)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel");else if("active"==this.currentState)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("RolePanel",0)),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LegendMainView");else if("upgrade"==this.currentState){var t=new Message(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE);t.setByte(this.tab_num),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=50,this.anim_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.anim_grp.verticalCenter--,this.anim_grp.verticalCenter<this.start_posY-50&&(this.moveUp=!1)):(this.anim_grp.verticalCenter++,this.anim_grp.verticalCenter>this.start_posY&&(this.moveUp=!0))},t.prototype.onTouchEquipt=function(){var e=1,t=this.shenqiModelMap[this.tab_num][e];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.SHENQI,INTRODUCE_TYPE.SHENQI,t)))},t}(BaseWindowPanel);__reflect(GodWeaponRechargePanel.prototype,"GodWeaponRechargePanel");var RechargeOnePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RechargeOnePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this);for(var t=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.YIYUANLIBAO)),n=0;n<t.length;n++){var a=new GoodsInstance;a.onUpdate(t[n].type,t[n].id,0,0,t[n].num),this.goods_list.addChild(a)}this.viewmask=new egret.Shape,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.6),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,this.stage.stageWidth,this.stage.stageHeight),this.viewmask.graphics.endFill(),this.tips_mask.addChild(this.viewmask),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.recharge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onServerCallBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.recharge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onServerCallBack,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onServerCallBack=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN)),this.onHide()},t.prototype.onRefresh=function(){DataManager.getInstance().rechargeManager.oneRecharge()||(this.onHide(),GameCommon.getInstance().addAlert("您已购买过1元礼包，不可重复购买"))},t.prototype.onTouchBtnRecharge=function(){var e=1,t="一元礼包";SDKManager.pay({goodsName:t,amount:e,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))},t}(BaseWindowPanel);__reflect(RechargeOnePanel.prototype,"RechargeOnePanel");var RechargePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RechargePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.queue=[];var t=JsonModelManager.instance.getModelpay(),n=0;for(var a in t)if(RechargeDefine.recharge_gear.indexOf(parseInt(a))>=0){var i=new RechargeItem(t[a],n);this.queue.push(i),this.itemLayer.addChild(i),n++}GameCommon.getInstance().addUnderlineStr(this.loolLabel),this.loolLabel.touchEnabled=!0,this.loolLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onUpdate,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onUpdate,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){0==DataManager.getInstance().rechargeManager.firstCharge&&(GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FirstChargePanel"),this.onHide()),this.onUpdate()},t.prototype.onUpdate=function(){for(var e=(this.getPlayerData(),0);e<this.queue.length;e++)this.queue[e].onUpdate();this.onShowVIPInfo()},t.prototype.onShowVIPInfo=function(){var e=this.getPlayerData();this.font_vip.text=e.viplevel.toString();var t=JsonModelManager.instance.getModelvip()[e.viplevel-1],n=JsonModelManager.instance.getModelvip()[e.viplevel];if(n){var a=0;t&&(a=t.costNum);var i=e.vipExp,o=n.costNum,r=n.costNum-e.vipExp;this.xxxyuan.text=r+"",this.xxxvip.text=GameCommon.getInstance().getVipName(e.viplevel)+1+"",this.label_rechargeAgain.text="",this.bar_recharge.maximum=o,this.bar_recharge.value=i}else this.bar_recharge.maximum=0,this.bar_recharge.value=0,this.xxxvip.text="",this.vipMax.visible=!1,this.label_rechargeAgain.textFlow=new Array({text:"已达目前VIP最高等级",style:{}})},t.prototype.onTouchBtnRecharge=function(){this.onHide(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"VipPanel")},t}(BaseWindowPanel);__reflect(RechargePanel.prototype,"RechargePanel");var RechargeItem=function(e){function t(t,n){var a=e.call(this)||this;return a.data=t,a.itemIndex=n,a.once(egret.Event.COMPLETE,a.onComplete,a),a.skinName=skins.RechargeItemSkin,a}return __extends(t,e),t.prototype.onComplete=function(){this.isloaded=!0,this.btn_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),this.onUpdate()},t.prototype.onUpdate=function(){if(this.isloaded){var e=parseInt(this.data.id),t=e;switch(SDKManager.getChannel()==EChannel.CHANNEL_EGRET&&SDKEgret.getInstance().isIOS22698()&&(e=SDKEgret.getInstance().getIOS22698(e),6==e&&(t=6)),this.itemIndex){case 0:case 1:case 2:this.img_icon.source="recharge_icon_0_png",this.img_icon.y=14;break;case 3:case 4:case 5:this.img_icon.source="recharge_icon_1_png",this.img_icon.y=14;break;case 6:case 7:case 8:this.img_icon.source="recharge_icon_2_png",this.img_icon.y=-24}if(this.btn_recharge.label="￥"+e,DataManager.getInstance().rechargeManager.checkFirstRecharge(t)){if(this.firstLayer.visible=DataManager.getInstance().rechargeManager.checkVipDayRecharge(t),this.doubleImg.source="doubleV"+GameCommon.getInstance().getVipName(DataManager.getInstance().playerManager.player.viplevel)+"_png",this.firstLayer.visible){var n=200*t;return void(n>=1e5?this.xxyuanbao.text=n/1e4+"万钻石":this.xxyuanbao.text=n+"钻石")}var a=100*t;a>=1e5?this.xxyuanbao.text=a/1e4+"万钻石":this.xxyuanbao.text=a+"钻石"}else{this.firstLayer.visible=!0,this.doubleImg.source="recharge_double_png";var a=200*t;a>=1e5?this.xxyuanbao.text=a/1e4+"万钻石":this.xxyuanbao.text=a+"钻石"}}},t.prototype.onTouchBtnRecharge=function(){var e=this.data.id,t=this.data.goodsName;SDKManager.pay({goodsName:t,amount:e,playerInfo:DataManager.getInstance().playerManager.player},new BasePayContainer(this))},t}(eui.Component);__reflect(RechargeItem.prototype,"RechargeItem");var TakeMoneyEveryDayPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TakeMoneyEveryDaySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.viewmask=new egret.Shape,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.6),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,this.stage.stageWidth,this.stage.stageHeight),this.viewmask.graphics.endFill(),this.tips_mask.addChild(this.viewmask),this.onRefresh()},t.prototype.onRefresh=function(){this.leijidate=JsonModelManager.instance.getModelleijichongzhi();var e=DataManager.getInstance().newactivitysManager.leiji;this.chongzhibox.numChildren>0&&this.chongzhibox.removeChildren(),this.chongzhibox1.numChildren>0&&this.chongzhibox1.removeChildren();var t,n=e.atyuanbao,a=0;for(var i in this.leijidate)if(t=this.leijidate[i],t.round==e.lunci){if(n>=t.costNum)continue;for(var o=t.rewards,r=0;r<o.length;r++){var s=new GoodsInstance;s.onUpdate(o[r].type,o[r].id,0,o[r].quality,o[r].num,o[r].lv),s.currentState="notName",2>a?(this.chongzhibox1.addChild(s),a+=1):(this.chongzhibox.addChild(s),a+=1)}return}this.leijilab.text=t.costNum-n+""},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.jump_to_charge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToCharge,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.jump_to_charge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToCharge,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this)},t.prototype.jumpToCharge=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t}(BaseWindowPanel);__reflect(TakeMoneyEveryDayPanel.prototype,"TakeMoneyEveryDayPanel");var TakeURMoneyGiveUArtifactPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.names=[],n.tab_num=1,n.flag=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TakeURMoneyGiveUArtifactPanelSkin},t.prototype.onInit=function(){this.shenqiModelMap=JsonModelManager.instance.getModelshenqi(),this.tab_group.removeChildren(),this.tabList=[];for(var t in this.shenqiModelMap){var n=new TujianTabItem;n.type=parseInt(t),n.tabFace="shenqi_icon_"+n.type+"_png",n.name="tab_"+n.type,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this),this.tab_group.addChild(n),this.tabList.push(n);var a=this.shenqiModelMap[t];this.names.push(a[1].name)}this.coatard_exp_pro.maximum=2e3,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.shenqiTimeCircle=function(){if("pay"==this.currentState){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.MONEYTAKEGODGIFT);this.shenqi_time.text="活动剩余时间："+GameCommon.getInstance().getTimeStrForSec1(e,2)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.show_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEquipt,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE.toString(),this.onRefresh,this),Tool.addTimer(this.shenqiTimeCircle,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btn_coatard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.anim_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.show_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEquipt,this),this.anim_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.onRefresh,this),Tool.removeTimer(this.shenqiTimeCircle,this,1e3)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){if(DataManager.getInstance().activityManager.activity[ACTIVITY_BRANCH_TYPE.MONEYTAKEGODGIFT]){var t=DataManager.getInstance().newactivitysManager.shenqiData;this.coatard_exp_pro.value=t.sum;var n=this.tabList[t.round];n.data=t,this.selectTab(n)}else this.selectTab(this.tabList[this.tab_num-1]);e.prototype.onRefresh.call(this)},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.selectTab(t)},t.prototype.selectTab=function(e){this.tab_num=e.type,this.currentState="active";var t=e.data;t&&(this.currentState="pay",t.isgoal&&(this.currentState="active",this.red_point_img.visible=DataManager.getInstance().legendManager.getCanLegendAdvance(t.round+1)));var n=this.getPlayerData().getLegendBase(this.tab_num),a=1;this.getPlayerData().isLegendActive(this.tab_num)&&(this.currentState="upgrade",a=n.lv);for(var i in this.tabList)this.tabList[i].type==e.type?this.tabList[i].tabBack="tujian_tab_back_selected_png":this.tabList[i].tabBack="tujian_tab_back_png";this.anim_grp.removeChildren();var o=new Animation("shenqi_"+e.type);this.anim_grp.addChild(o),this.onStartFloatAnim();var r=this.shenqiModelMap[e.type][a-1];this.getDesc(r);for(var s=GameCommon.getInstance().getAttributeAry(),h=0;h<ATTR_TYPE.SIZE;++h)s[h]+=GameCommon.getInstance().getAttributeAry(r)[h];var l;l=this.powerbar,l.power=(GameCommon.calculationFighting(s)+r.ewaizhanli).toString(),this.shenqi_name.text=this.names[e.type-1]+"",this.shenqi_z.source="shenqi_z"+e.type+"_png"},t.prototype.getDesc=function(e){var t=e.gailv,n=e.xiaoguo,a=e.attack,i=e.hp,o=e.phyDef,r=e.magicDef,s="";switch(e.id){case 1:s="每一次攻击有[#07FF00"+t/100+"]%的概率造成对方眩晕，持续[#07FF00"+n/1e3+"]秒\n";break;case 5:s="每一次攻击有[#07FF00"+t/100+"]%的概率造成对方沉默，只能释放基础剑法持续[#07FF00"+n/1e3+"]秒\n";break;case 2:s="死亡后自动复活，恢复最大生命值的[#07FF00"+n/100+"]%\n";break;case 3:s="直接忽视对方防御，对其额外造成自身攻击力[#07FF00"+n/100+"]%的伤害\n";break;case 4:s="增加一层护盾状态，有效吸收对方[#07FF00"+n/100+"]%的伤害\n"}s=s+"生命+[#07FF00"+i+"]\n攻击+[#07FF00"+a+"]\n物防+[#07FF00"+o+"]\n法防+[#07FF00"+r+"]\n";var h=GameCommon.getInstance().readStringToHtml(s);this.shenqi_desc.lineSpacing=5,this.shenqi_desc.textFlow=(new egret.HtmlTextParser).parser(h)},t.prototype.onClick=function(e){e.currentTarget;if("pay"==this.currentState)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel");else if("active"==this.currentState)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("RolePanel",0)),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LegendMainView");else if("upgrade"==this.currentState){var t=new Message(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE);t.setByte(this.tab_num),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=50,this.anim_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.anim_grp.verticalCenter--,this.anim_grp.verticalCenter<this.start_posY-50&&(this.moveUp=!1)):(this.anim_grp.verticalCenter++,this.anim_grp.verticalCenter>this.start_posY&&(this.moveUp=!0))},t.prototype.onTouchEquipt=function(){var e=1,t=this.shenqiModelMap[this.tab_num][e];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.SHENQI,INTRODUCE_TYPE.SHENQI,t)))},t}(BaseWindowPanel);__reflect(TakeURMoneyGiveUArtifactPanel.prototype,"TakeURMoneyGiveUArtifactPanel");var SevenDayCarnivalPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tab=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SevenDayCarnivalPanelSkin},t.prototype.onInit=function(){this.basic.closeBtn1.y=20,this.img_getEd.visible=!1;var n=0;for(this.tabs=[],this.tabTitles=[],n=0;4>n;n++)this.tabs.push(this["tab_"+n]),this.tabTitles.push(this["label_tab"+n]);for(this.tab_days=[],this.bmt_days=[],n=0;7>n;n++)this.tab_days.push(this["tab_day"+n]),this.bmt_days.push(this["bmt_day"+n]);t.index=DataManager.getInstance().sevenDayCarnivalManager.today-1,t.index>6&&(t.index=6),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.showTabstate(),this.onShowInfo(),this.onShowPoint()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sevDayLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSevDayLogin,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE.toString(),this.onReceiveLogin,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE.toString(),this.onReceiveObjective,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SEVDAY_CLOSE,this.onHide,this);var t=0;for(t=0;4>t;t++)this.tabs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabs,this);for(t=0;7>t;t++)this.tab_days[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabDays,this);this.getMessage(),Tool.addTimer(this.onCountDown,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sevDayLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSevDayLogin,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE.toString(),this.onReceiveLogin,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE.toString(),this.onReceiveObjective,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SEVDAY_CLOSE,this.onHide,this);var t=0;for(t=0;4>t;t++)this.tabs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabs,this);for(t=0;7>t;t++)this.tab_days[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabDays,this);Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().sevenDayCarnivalManager.getCountDown();e>0||(e=0,Tool.removeTimer(this.onCountDown,this,1e3)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.label_endTime.text="任务截止时间："+GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.getMessage=function(){var e=new Message(MESSAGE_ID.ACTIVITY_SEVDAY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRefreshList=function(){},t.prototype.onTouchSevDayLogin=function(){var e=new Message(MESSAGE_ID.ACTIVITY_SEVDAYLOGIN_AWARD_RECEIVE);e.setByte(t.index+1),GameCommon.getInstance().sendMsgToServer(e);var n=DataManager.getInstance().sevenDayCarnivalManager.sevDayLogin[t.index+1];n.state=2},t.prototype.onShowInfo=function(){this.onShowTabTitle(),this.onShowSevDaySignInfo(),this.onShowSevDayObjectiveInfo()},t.prototype.onTouchTabs=function(e){this.tab=parseInt(e.target.value),this.objectiveBar.stopAnimation(),this.onShowSevDayObjectiveInfo()},t.prototype.chageHierarchy=function(e){},t.prototype.onTouchTabDays=function(e){t.index=parseInt(e.target.value),this.objectiveBar.stopAnimation(),this.onShowInfo(),this.onShowPoint()},t.prototype.showTabstate=function(){var e=(t.index+1,DataManager.getInstance().sevenDayCarnivalManager.today);if(this.tabs[this.tab].selected=!0,!(t.index>=this.tab_days.length)){this.tab_days[t.index].selected=!0;for(var n,a=0;a<this.bmt_days.length;a++)n=this.bmt_days[a],e<parseInt(n.text)?n.font="sevDayGrayFont_fnt":n.font="tiantiFont_fnt"}},t.prototype.onShowTabTitle=function(){for(var e,n=DataManager.getInstance().sevenDayCarnivalManager.getCurrDayInfo(t.index+1),a=0;4>a&&(e=n[a][0],e);a++)this.tabTitles[a].text=e.name},t.prototype.onReceiveLogin=function(){this.onShowSevDaySignInfo(),this.onShowPoint()},t.prototype.onReceiveObjective=function(){this.onShowSevDayObjectiveInfo(),this.onShowPoint()},t.prototype.onShowSevDaySignInfo=function(){var e=t.index+1,n=DataManager.getInstance().sevenDayCarnivalManager.today;this.img_getEd.visible=!1,1==e?(this.img_banner.source="sevDay_banner_1_jpg",n>1?(GameCommon.getInstance().onImgSetGray(this.img_banner,!0),this.img_getEd.visible=!0):GameCommon.getInstance().onImgSetGray(this.img_banner,!1)):2==e?(this.img_banner.source="sevDay_banner_5_jpg",n>2?(GameCommon.getInstance().onImgSetGray(this.img_banner,!0),this.img_getEd.visible=!0):GameCommon.getInstance().onImgSetGray(this.img_banner,!1)):e>=3&&7>=e&&(this.img_banner.source="sevDay_banner_7_jpg",n>7?(GameCommon.getInstance().onImgSetGray(this.img_banner,!0),this.img_getEd.visible=!0):GameCommon.getInstance().onImgSetGray(this.img_banner,!1)),this.img_loginAward.source="sevDay_bmt_dljl"+e+"_png"},t.prototype.onShowPoint=function(){this.showLoginRedPoint(),this.showTabRedPoint()},t.prototype.showLoginRedPoint=function(){this.img_pointLogin.visible=DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainLoginByDay(t.index+1)},t.prototype.onShowSevDayObjectiveInfo=function(){var e,n,a=0,i=DataManager.getInstance().sevenDayCarnivalManager.getCurrDayInfo(t.index+1),o=i[this.tab].concat(),r=t.index+1,s=DataManager.getInstance().sevenDayCarnivalManager.today;if(e=o[0]){var h=DataManager.getInstance().sevenDayCarnivalManager.sevDayObjective[e.key];if(s>=r&&h){for(a=0;a<o.length;a++)e=o[a],e.sortKey=a,GameCommon.getInstance().getBit2BooleanValue(h.getNum,e.level)?e.sortKey+=1e4:h.getNum<e.param&&(e.sortKey+=100);o=o.sort(function(e,t){return e.sortKey<t.sortKey?-1:1})}for(a=this.itemLayer.numChildren-1;a>=0;a--)n=this.itemLayer.getChildAt(a),n.onDestroy(),this.itemLayer.removeChildAt(a);for(this.itemLayer.removeChildren(),a=0;a<o.length;a++)n=new SevDayObjectiveItem,n.data=o[a],this.itemLayer.addChild(n);this.adjustBar()}},t.prototype.showTabRedPoint=function(){for(var e=DataManager.getInstance().sevenDayCarnivalManager.getCurrDayInfo(t.index+1),n=0;n<e.length;n++)this["img_pointTab"+(n+1)].visible=DataManager.getInstance().sevenDayCarnivalManager.getHasAwardGainOneDayByTab(e[n],t.index+1)},t.prototype.adjustBar=function(){this.objectiveBar.viewport.scrollV=0},t.prototype.onHide=function(){e.prototype.onHide.call(this),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CHECKACTIVITY_BTN))},t.index=0,t}(BaseWindowPanel);__reflect(SevenDayCarnivalPanel.prototype,"SevenDayCarnivalPanel");var SevDayObjectiveItem=function(e){function t(){var t=e.call(this)||this;return t.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchBtnReceive,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){var e,t,n=this._data.rewardList;this.awardLayer.removeChildren();for(var a=0;a<n.length;a++)e=n[a],t=new GoodsInstance,t.scaleX=t.scaleY=.8,t.onUpdate(e.type,e.id,0,e.quality,e.num),this.awardLayer.addChild(t);var i=0,o=DataManager.getInstance().sevenDayCarnivalManager.sevDayObjective[this._data.key];this.btn_receive.visible=!0;var r=SevenDayCarnivalPanel.index+1,s=DataManager.getInstance().sevenDayCarnivalManager.today;o&&s>=r?(i=o.currNum,this.btn_receive.skinName=skins.Common_ButtonSkin,GameCommon.getInstance().getBit2BooleanValue(o.getNum,this._data.level)?(this.btn_receive.label="已领取",GameCommon.getInstance().onButtonEnable(this.btn_receive,!1)):o.currNum>=this._data.param?(this.btn_receive.label="领取",GameCommon.getInstance().onButtonEnable(this.btn_receive,!0)):(this.btn_receive.skinName=skins.Common_ButtonSkin,this.btn_receive.label="前往",GameCommon.getInstance().onButtonEnable(this.btn_receive,!0),0==this._data.goType&&(this.btn_receive.visible=!1))):(this.btn_receive.skinName=skins.Common_ButtonSkin,this.btn_receive.label="前往",DataManager.getInstance().sevenDayCarnivalManager.today>=this._data.day?GameCommon.getInstance().onButtonEnable(this.btn_receive,!0):GameCommon.getInstance().onButtonEnable(this.btn_receive,!1),0==this._data.goType&&(this.btn_receive.visible=!1)),this.label_progress.text=this._data.desc+"("+i+"/"+this._data.param+")"},t.prototype.onTouchBtnReceive=function(e){var t=e.target;if("前往"==t.label)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this._data.goType);else if("领取"==t.label){var n=new Message(MESSAGE_ID.ACTIVITY_SEVDAYOBJECTIVE_AWARD_RECEIVE);n.setShort(this._data.key),n.setByte(this._data.level),GameCommon.getInstance().sendMsgToServer(n)}},t.prototype.onDestroy=function(){this.btn_receive.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnReceive,this)},t}(eui.Component);__reflect(SevDayObjectiveItem.prototype,"SevDayObjectiveItem");var ShareInfoPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName="skins.ShareInfoSkin"},Object.defineProperty(t.prototype,"funData",{get:function(){return DataManager.getInstance().functionManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.share_img.visible=!1,this.labelTimes.text="("+this.funData.shareDayNum.toString()+"/3)",this.funData.shareDayNum<3?(this.labelCDDesc.visible=!0,this.labelCD.visible=!0,this.labelCD.text=Tool.getTimeStr(this.funData.cd),this.funData.cd>0&&Tool.addTimer(this.onCountDown,this)):(this.labelCDDesc.visible=!1,this.labelCD.visible=!1)},t.prototype.onCountDown=function(){this.funData.cd>0?(this.labelCD.text=Tool.getTimeStr(this.funData.cd),this.funData.cd--):(this.labelCDDesc.visible=!1,this.labelCD.visible=!1,Tool.removeTimer(this.onCountDown,this))
},t.prototype.updateData=function(e){this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.SDK_SHARE_INFO_UPDATE,this.updateData,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SHARE_INFO_MESSAGE.toString(),this.onRefresh,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.yaoqingBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInvitation,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),Tool.removeTimer(this.onCountDown,this),GameDispatcher.getInstance().removeEventListener(GameEvent.SDK_SHARE_INFO_UPDATE,this.updateData,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SHARE_INFO_MESSAGE.toString(),this.onRefresh,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.yaoqingBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInvitation,this)},t.prototype.onInvitation=function(e){SDKManager.loginInfo.channel==EChannel.CHANNEL_CRAZY&&(this.share_img.visible=!0),SDKManager.loginInfo.channel==EChannel.CHANNEL_SOEZ&&(SDKEZJS.isHaveShareMethod()||(this.share_img.visible=!0)),SDKManager.share(this,null)},t.prototype.showShareInfo=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ShareInfoPanel",e))},t.prototype.updateShareInfo=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SDK_SHARE_INFO_UPDATE),e)},t.prototype.shareComplete=function(){var e=new Message(MESSAGE_ID.SHARE_COMPLETE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(ShareInfoPanel.prototype,"ShareInfoPanel",["ISDKShareContainer"]);var ShareRewardItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t.once(egret.Event.COMPLETE,t.onInit,t),t}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.onUpdate=function(e){this.model=e,this.refresh()},t.prototype.refresh=function(){var e=this.model.rewards;this.points[0].register(this.btn_reward,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this.funData,"rewardPoint",this.model.id,this.model.times),this.awards.removeChildren();for(var t=0;t<e.length;t++){var n=e[t],a=new GoodsInstance;a.scaleX=.8,a.scaleY=.8,a.onUpdate(n.type,n.id,0,n.quality,n.num),this.awards.addChild(a)}1==this.funData.getReceive(this.model.id)?(this.btn_reward.label="已领取",this.btn_reward.enabled=!1):(this.btn_reward.label="领取",this.funData.shareNum>=5?this.btn_reward.enabled=!0:this.btn_reward.enabled=!1);var i=this.model.times;this.rewardLabel.text="("+(this.funData.shareNum>i?i:this.funData.shareNum)+"/"+i+")",this.btn_reward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onTouchButton=function(){var e=new Message(MESSAGE_ID.SHARE_REWARD_MESSAGE);e.setByte(this.model.id),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"funData",{get:function(){return DataManager.getInstance().functionManager},enumerable:!0,configurable:!0}),t}(eui.ItemRenderer);__reflect(ShareRewardItem.prototype,"ShareRewardItem");var WXCollectionGameView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.WXCollectionPanelSkin},t.prototype.onRefresh=function(){DataManager.getInstance().playerManager.player.wxcolletion&&(this.reward_btn.enabled=!1,this.reward_btn.label="已领取")},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReward,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XYX_COLLECTION_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.reward_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReward,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XYX_COLLECTION_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onTouchReward=function(){if(!DataManager.getInstance().wxgameManager.isColletionScene)return void GameCommon.getInstance().addAlert("error_tips_10007");var e=new Message(MESSAGE_ID.XYX_COLLECTION_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(WXCollectionGameView.prototype,"WXCollectionGameView");var WXFirstSharePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){for(var t=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.WXGAME_FIRSTAWD)),n=0;n<t.length;n++){var a=GameCommon.getInstance().createGoodsIntance(t[n]);this.reward_grp.addChild(a)}this.btn_share.label=FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)?"展示游戏":"领取奖励",this.desc_style1.visible=FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE),this.desc_style2.visible=!FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.WXFirstSharePanelSkin},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.touchEnabled=!0,this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchShareBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchShareBtn,this)},t.prototype.onTouchShareBtn=function(){FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)?SDKManager.share(this,WX_SHARE_TYPE.FIRST_SHARE):this.shareComplete(),this.onTouchCloseBtn()},t.prototype.showShareInfo=function(e){},t.prototype.updateShareInfo=function(e){},t.prototype.shareComplete=function(){var e=new Message(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE);e.setBoolean(!0),e.setShort(GameDefine.FANGKUAI_FIRST_SHARE_LV),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(WXFirstSharePanel.prototype,"WXFirstSharePanel",["ISDKShareContainer"]);var WXShareLevelAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.setTitle("等级邀请");var t=JsonModelManager.instance.getModellvyaoqing(),n=0;for(var a in t){var i=t[a],o=new eui.RadioButton;o.skinName=skins.WXShareLevelAwardItem,o.label=i.lv+"级礼包",o.groupName="wxsharelvTabGrp",o.value=n,o.name="sharelv_icon"+n,this.itemlist_grp.addChild(o),n++}e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.WXShareLevelAwdSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().wxgameManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){var e=JsonModelManager.instance.getModellvyaoqing();this.curYaoqingIdx=-1;for(var t in e){var n=e[t];if(!(this.manager.shareAwdLv>=n.lv)){this.curYaoqingIdx++;break}this.curYaoqingIdx++}this.scroller.viewport.scrollH=this.curYaoqingIdx>3?130*this.curYaoqingIdx-390:0;var a=this.itemlist_grp.getChildByName("sharelv_icon"+this.curYaoqingIdx);a.selected=!0,this.onChangeTabHandle()},t.prototype.onTouchTabBtn=function(e){var t=e.currentTarget;this.curYaoqingIdx!=t.value&&(this.curYaoqingIdx=t.value,this.onChangeTabHandle())},t.prototype.onChangeTabHandle=function(){var e=JsonModelManager.instance.getModellvyaoqing()[this.curYaoqingIdx];if(e){this.manager.shareAwdLv>=e.lv?(this.special_des_lab.text="奖励已通过邮件下发，请注意查收！",this.btn_share.label="已领取",this.btn_share.enabled=!1):e.lv>this.player.level?(this.special_des_lab.text="达到"+e.lv+"级后展示游戏，可领取丰厚奖励！",this.btn_share.label="等级不足",this.btn_share.enabled=!1):(this.special_des_lab.text="恭喜您达到了"+e.lv+"级，展示游戏后可领取丰厚奖励！",this.btn_share.label="展示并领取",this.btn_share.enabled=!0),this.award_grp.removeChildren();for(var t=0;t<e.rewards.length;t++){var n=GameCommon.getInstance().createGoodsIntance(e.rewards[t]);this.award_grp.addChild(n)}}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE.toString(),this.onRefresh,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showShareInfo,this);for(var t=0;t<this.itemlist_grp.numChildren;t++){var n=this.itemlist_grp.getChildAt(t);n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE.toString(),this.onRefresh,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showShareInfo,this);for(var t=0;t<this.itemlist_grp.numChildren;t++){var n=this.itemlist_grp.getChildAt(t);n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)}},t.prototype.showShareInfo=function(e){SDKManager.share(this,WX_SHARE_TYPE.LEVEL_SHARE)},t.prototype.shareComplete=function(){var e=JsonModelManager.instance.getModellvyaoqing()[this.curYaoqingIdx];if(e)if(DataManager.getInstance().playerManager.player.level>=e.lv){var t=new Message(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE);t.setBoolean(!0),t.setShort(e.lv),GameCommon.getInstance().sendMsgToServer(t)}else GameCommon.getInstance().addAlert("等级达到"+e.lv+"级展示后可获得奖励哦！")},t}(BaseWindowPanel);__reflect(WXShareLevelAwardPanel.prototype,"WXShareLevelAwardPanel",["ISDKShareContainer"]);var WXShareMainView=function(e){function t(t){var n=e.call(this,t)||this;return n.currTabIdx=0,n.START_POSX=40,n.END_POSX=210,n.points=RedPointManager.createPoint(4),n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WXShareMainViewSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("晋升豪礼");var t=new egret.Point(145,-5);this.points[0].register(this.tabbtn0,t,DataManager.getInstance().wxgameManager,"getWxShareAwdRpoint"),this.points[1].register(this.tabbtn1,t,DataManager.getInstance().wxgameManager,"getWxFriendShareRpoint"),this.points[2].register(this.tabbtn2,t,DataManager.getInstance().wxgameManager,"getWxOffLineShareRpoint"),this.points[3].register(this.tabbtn3,t,DataManager.getInstance().wxgameManager,"wxShareAllRedPoint"),this.tabbtn0.selected=!0,this.onRefresh()},t.prototype.onRefresh=function(){this.onChangeTabHanler()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<WX_SHARE_TABTYPE.SIZE;t++)this["tabbtn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SHARE_INFO_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WXGAME_INVITE_FRIEND_MSG.toString(),this.onYaoqinghaoyou,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OFFLINE_EXP_SHARE_COMPLETE.toString(),this.onReciveOffLineAwdMsg,this),DataManager.getInstance().wxgameManager.onRequestOffLineExpAwdMsg()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<WX_SHARE_TABTYPE.SIZE;t++)this["tabbtn"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SHARE_INFO_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WXGAME_INVITE_FRIEND_MSG.toString(),this.onYaoqinghaoyou,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OFFLINE_EXP_SHARE_COMPLETE.toString(),this.onReciveOffLineAwdMsg,this),this.examineCD(!1)},t.prototype.onTouchTabBtn=function(e){var t=e.currentTarget,n=parseInt(t.value);n!=this.currTabIdx&&(this.currTabIdx=n,this.onChangeTabHanler())},t.prototype.onChangeTabHanler=function(){switch(this.item_grp.removeChildren(),this.btn_share.enabled=!0,this.scroller.stopAnimation(),this.scroller.viewport.scrollV=0,this.scroller.viewport.scrollH=0,this.examineCD(!1),this.currTabIdx){case WX_SHARE_TABTYPE.TAB1_SHARECOUNT:this.onLeijifenxiang();break;case WX_SHARE_TABTYPE.TAB3_INVITEFIREND:DataManager.getInstance().wxgameManager.onRequestInviteAwdMsg();break;case WX_SHARE_TABTYPE.TAB4_LIXIANJINGYAN:this.onLixianjingyan()}},t.prototype.onLeijifenxiang=function(){if(this.currentState="leijifenxiang",this.item_grp.removeChildren(),!this._wxAwardItems){this._wxAwardItems=[];var e=JsonModelManager.instance.getModelfenxiang();for(var t in e){var n=e[t],a=new WXShareAwardItem(n);this._wxAwardItems.push(a)}}for(var i=0;i<this._wxAwardItems.length;i++){var a=this._wxAwardItems[i];this.item_grp.addChild(a),a.onUpdate()}this.btn_share.enabled=Math.ceil((DataManager.getInstance().functionManager.cd-egret.getTimer())/1e3)<=0,this.examineCD(!0)},t.prototype.onYaoqinghaoyou=function(){if(this.currTabIdx==WX_SHARE_TABTYPE.TAB3_INVITEFIREND){this.currentState="yaoqinghaoyou";var e=DataManager.getInstance().wxgameManager;if(!this._wxinviteItems){var t=0;this._wxinviteItems=[];for(var n=Constant.get(Constant.WXGAME_INVITE_FIREND).split("#"),a=0;a<n.length;a++){var i=n[a].split(","),o=new WXFriendInviteAwardItem(parseInt(i[0]),parseInt(i[1]),0);this._wxinviteItems.push(o);var r=parseInt(i[0]);r>t&&(t=r)}this.probar_invite.maximum=t}for(var a=0;a<this._wxinviteItems.length;a++){var o=this._wxinviteItems[a];this.item_grp.addChild(o),o.onUpdate()}this.probar_invite.value=e.inviteReachNum,this.btn_share.enabled=e.inviteawdNum<=e.inviteReachNum||e.inviteawdZhulibiNum<=e.inviteReachNum}},t.prototype.onLixianjingyan=function(){if(this.currentState="baochi",!this.expAnim){this.expAnim=new Animation("zhuling_bowen",-1,!1),this.expAnim.x=131,this.expAnim.y=275-this.exp_scroll.height,this.baochi_grp.addChildAt(this.expAnim,2);var e=new Animation("zhuling_qiu",-1,!1);e.x=145,e.y=180,this.expanim_grp.addChildAt(e,0)}this.onReciveOffLineAwdMsg()},t.prototype.onReciveOffLineAwdMsg=function(){if(this.currTabIdx==WX_SHARE_TABTYPE.TAB4_LIXIANJINGYAN){var e=DataManager.getInstance().playerManager.offlineAwdData;this.zhuhun_exp_lab.text=e.exp+"/"+e.offexpMix;var t=this.END_POSX;t=this.START_POSX+Math.round((this.END_POSX-this.START_POSX)*(e.exp/e.offexpMix)),this.expAnim.y=275-t,this.special_des_lab.text=""}},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=Math.ceil((DataManager.getInstance().functionManager.cd-egret.getTimer())/1e3);e>0?this.special_des_lab.text=Tool.getTimeStr(e)+"后可再次展示":(e=0,this.examineCD(!1),this.btn_share.enabled=!0,this.special_des_lab.text="")},t.prototype.onShare=function(){switch(this.currTabIdx){case WX_SHARE_TABTYPE.TAB1_SHARECOUNT:SDKManager.share(this,WX_SHARE_TYPE.EVERYDAY_SHARE);break;case WX_SHARE_TABTYPE.TAB3_INVITEFIREND:var e=new Message(MESSAGE_ID.WXGAME_INVITE_FRIEND_MSG);e.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(e);break;case WX_SHARE_TABTYPE.TAB4_LIXIANJINGYAN:SDKManager.share(this,WX_SHARE_TYPE.OFFLINE_EXP)}},t.prototype.shareComplete=function(){switch(this.currTabIdx){case WX_SHARE_TABTYPE.TAB1_SHARECOUNT:var e=new Message(MESSAGE_ID.SHARE_COMPLETE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e);break;case WX_SHARE_TABTYPE.TAB3_INVITEFIREND:break;case WX_SHARE_TABTYPE.TAB4_LIXIANJINGYAN:if(DataManager.getInstance().playerManager.offlineAwdData.exp>0){var t=new Message(MESSAGE_ID.OFFLINE_EXP_SHARE_COMPLETE);t.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(t)}}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(WXShareMainView.prototype,"WXShareMainView",["ISDKShareContainer"]);var WXShareAwardItem=function(e){function t(t){var n=e.call(this)||this;return n.model=t,n.once(egret.Event.COMPLETE,n.onInit,n),n.skinName=skins.WXShareAwardItem,n}return __extends(t,e),t.prototype.onInit=function(){for(var e=0;e<this.model.rewards.length;e++){var t=GameCommon.getInstance().createGoodsIntance(this.model.rewards[e]);this.items_grp.addChild(t)}this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onUpdate=function(){var e=DataManager.getInstance().functionManager;this.invite_count_lab.text="今日展示"+this.model.times+"次("+Math.min(this.model.times,e.shareNum)+"/"+this.model.times+")",e.receives.indexOf(this.model.id)>=0?(this.reward_btn.enabled=!1,this.reward_btn.label="已领取"):this.model.times>e.shareNum?(this.reward_btn.enabled=!1,this.reward_btn.label="未达成"):(this.reward_btn.enabled=!0,this.reward_btn.label="领取")},t.prototype.onReward=function(){var e=new Message(MESSAGE_ID.SHARE_REWARD_MESSAGE);e.setByte(this.model.id),GameCommon.getInstance().sendMsgToServer(e)},t}(eui.Component);__reflect(WXShareAwardItem.prototype,"WXShareAwardItem");var WXFriendInviteAwardItem=function(e){function t(t,n,a){var i=e.call(this)||this;return i.inviteCount=t,i.diamond=n,i.zhulibi=a,i.once(egret.Event.COMPLETE,i.onInit,i),i.skinName=skins.WXShareAwardItem,i}return __extends(t,e),t.prototype.onInit=function(){this.invite_count_lab.text=this.inviteCount+"名好友",this.goods=[];var e=GameCommon.getInstance().createGoodsIntance(new AwardItem(GOODS_TYPE.DIAMOND,0,this.diamond));this.items_grp.addChild(e),this.goods=[e],this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onUpdate=function(){var e=DataManager.getInstance().wxgameManager,t=this.inviteCount;t<=e.inviteawdNum&&t<=e.inviteawdZhulibiNum?(this.reward_btn.enabled=!1,this.reward_btn.label="已领取"):(this.reward_btn.enabled=!0,this.reward_btn.label="去展示")},t.prototype.onReward=function(){SDKManager.share(null,WX_SHARE_TYPE.INVITE_FRIEND)},t}(eui.Component);__reflect(WXFriendInviteAwardItem.prototype,"WXFriendInviteAwardItem");var WX_SHARE_TABTYPE;!function(e){e[e.TAB1_SHARECOUNT=0]="TAB1_SHARECOUNT",e[e.TAB3_INVITEFIREND=1]="TAB3_INVITEFIREND",e[e.TAB4_LIXIANJINGYAN=2]="TAB4_LIXIANJINGYAN",e[e.SIZE=3]="SIZE"}(WX_SHARE_TABTYPE||(WX_SHARE_TABTYPE={}));var ShenQiActPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.params=[],n.activityIdNow=[],n.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_SHENQICHOUQIAN],n.activityIds=GameCommon.parseIntArray(n.modelGroup.activityId),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.params=[],this.activityIdNow=[],this.points=[];for(var t,n=[],a=0,i=0;i<this.activityIds.length;i++){var o=this.activityIds[i],r=DataManager.getInstance().activityManager.getRegisterSystemParam(o);if(r&&(t||(t=new RegisterSystemParam,t.sysName=r.sysName,this.points[a]=new redPoint,t.redP=this.points[a],t.redP.addTriggerFuc(DataManager.getInstance().shenqiZhuanPanManager,"checkZhuanPanPoint"),t.tabBtns=[]),t)){var s=new RegisterTabBtnParam,h=JsonModelManager.instance.getModelactivity()[o],l=this.getRedPointFunc(h.panel);l&&(this.points[a]=new redPoint,s.redP=this.points[a],s.redP.addTriggerFuc(DataManager.getInstance().shenqiZhuanPanManager,l),a++),s.sysName=r.sysName,s.tabBtnRes=h.icon+"_png",o==ACTIVITY_BRANCH_TYPE.ACT_SHENQICHOUQIAN&&(this.points[a]=new redPoint,s.redP=this.points[a],s.redP.addTriggerFuc(DataManager.getInstance().shenqiZhuanPanManager,"checkZhuanPanPoint"),s.title=DataManager.getInstance().shenqiZhuanPanManager.zhuanpanModel.title,s.sysName=DataManager.getInstance().shenqiZhuanPanManager.zhuanpanModel.panel),t.tabBtns.push(s),this.activityIdNow.push(o),this.params.push(r)}}n.push(t),this.basic.tabBtnsBar.nextImg.visible=!1,this.basic.tabBtnsBar.preImg.visible=!1,this.basic.tabBtnsBar.btnGroup.layout.gap=30,this.registerPage(n,"ShenQiActGrp",GameDefine.RED_TAB_POS)},t.prototype.onRegist=function(){var t=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);t.setByte(0),GameCommon.getInstance().sendMsgToServer(t),this.onRefresh(),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){this.setTitle(this.params[this.index].title),e.prototype.onRefresh.call(this)},t.prototype.getRedPointFunc=function(e){var t="";switch(e){case"HefuMissionPanel":t="checkLiyiMissionRedPoint";break;case"HefuPayGiftPanel":break;case"HefuTreasurePanel":t="checkZhuanPanPoint";break;case"HefuTreasurePanel":t="checkZhuanPanPoint"}return t},t}(BaseSystemPanel);__reflect(ShenQiActPanel.prototype,"ShenQiActPanel");var ShenQiTreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.WEEK_AWD_MAX=4,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ShenQiTreasurePanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().shenqiZhuanPanManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.currHasNum=[],this.consumItem.nameColor=15987699,this.consumItem1.nameColor=15987699,this.bar_exp.maximum=1e4,this.groups=[this.group0,this.group1],this.onRefresh(),this.initItemList()},t.prototype.initItemList=function(){this.rewards=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show);for(var e=120,t=0;t<this.rewards.length;t++){var n=GameCommon.getInstance().createGoodsIntance(this.rewards[t]);n.y=Math.floor(t%8/2)*e,8==t?(this.nbItem1.onUpdate(this.rewards[t].type,this.rewards[t].id),this.nbItem1.currentState="notName",this.nbItem1Name.text=GameCommon.getInstance().getThingModel(this.rewards[t].type,this.rewards[t].id,-1).name):t%2==0?(n.x=158*Math.floor(t/8),this.groups[0].addChild(n)):(n.x=-158*Math.floor(t/8),this.groups[1].addChild(n))}},t.prototype.onDealRocker=function(){this.onPlayDone()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.showAwardPanel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_PLATE.toString(),this.onTreasureBackMsg,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.showAwardPanel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseAwdShow,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_PLATE.toString(),this.onTreasureBackMsg,this),this.examineCD(!1)},t.prototype.onCloseAwdShow=function(){this.showAwardPanel.visible=!1,egret.Tween.removeTweens(this.showAwardGroup),this.isAction=!1},t.prototype.onRefresh=function(){this.onUpdateWeekAward(),this.onUpdateCost(),this.week_times_lab.text=""+DataManager.getInstance().shenqiZhuanPanManager.zhuanpanNum},t.prototype.actionInit=function(){this.rect.visible=this.lbAlert.visible=!1,this.imgZhong.visible=!0;var e=.1,t=300,n=312;this.showAwardGroup.scaleX=this.showAwardGroup.scaleY=e,this.showAwardGroup.y=n;var a=egret.Tween.get(this.showAwardGroup),i=this;a.to({scaleX:-(e+.1),scaleY:e+.1},t),a.to({scaleX:e+.2,scaleY:e+.2},t),a.to({scaleX:-(e+.3),scaleY:e+.3},t),a.to({scaleX:e+.4,scaleY:e+.4},t),a.wait(300),a.call(function(){egret.Tween.removeTweens(i.showAwardGroup),i.actionDown()},this)},t.prototype.actionDown=function(){this.imgZhong.visible=!1;var e=this,t=egret.Tween.get(this.showAwardGroup);t.to({y:444,scaleX:.6,scaleY:.6},300),t.call(function(){egret.Tween.removeTweens(e.showAwardGroup),e.lbAlert.visible=e.rect.visible=!0,e.resetUI()},this)},t.prototype.resetUI=function(){this.isAction=!1},t.prototype.adjustChatBar=function(){this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ACT_SHENQICHOUQIAN);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onNextData=function(){this.week_times_lab.text=""+DataManager.getInstance().shenqiZhuanPanManager.zhuanpanNum;var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(this.bar_exp.value=DataManager.getInstance().shenqiZhuanPanManager.treasureAwdIdx,e&&e.num>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var n=DataManager.getInstance().playerManager.player.getICurrency(5);n<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899}var a=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costFive);if(t>=a[0].num)this.consumItem1.visible=!0,this.consumItem1.setCostByAwardItem(a[0]),this.img_cons1.visible=!1,this.label_points1.text="";else{this.consumItem1.visible=!1,this.img_cons1.visible=!0,this.label_points1.text=a[1].num.toString();var n=DataManager.getInstance().playerManager.player.getICurrency(5);n<a[1].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899}},t.prototype.onPlayDone=function(){this.showAwardPanel.visible=!0;var e=new AwardItem(DataManager.getInstance().shenqiZhuanPanManager.zhuanpanType,DataManager.getInstance().shenqiZhuanPanManager.zhuanpanId,DataManager.getInstance().shenqiZhuanPanManager.zhuanpanNum);e&&this.updateGoods(this.itemNb,e),this.actionInit()},t.prototype.updateGoods=function(e,t){e.onUpdate(t.type,t.id,t.uid,t.quality,t.num)},t.prototype.onUpdateWeekAward=function(){this.manager.zhuanpanModel;this.bar_exp.value=DataManager.getInstance().shenqiZhuanPanManager.treasureAwdIdx},t.prototype.onTreasureBackMsg=function(){var e=DataManager.getInstance().shenqiZhuanPanManager.tp;1==e||2==e?(this.onNextData(),this.onRotateback()):3==e||4==e?this.onShowTenAward():this.onRefresh()},t.prototype.onShowTenAward=function(){var e=new TurnplateAwardParam;e.desc="五连抽获得以下奖励",e.titleSource="",e.itemAwards=DataManager.getInstance().shenqiZhuanPanManager.temAward,e.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",e)),this.onRefresh()},t.prototype.onShowAward=function(){for(var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),t=0;t<e.length;t++)if(DataManager.getInstance().shenqiZhuanPanManager.zhuanpanId==e[t].id&&DataManager.getInstance().shenqiZhuanPanManager.zhuanpanType==e[t].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==e[t].num){var n=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);GameCommon.getInstance().onGetThingAlert(n,e[t].num,GOODS_CHANGE_TYPE.DELAY_ADD);break}},t.prototype.onRotateback=function(){this.onPlayDone()},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.onTouchBtnTurn1=function(){if(!this.isAction){var e=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costFive),t=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),n=t?t.num:0;if(0==n){var a=DataManager.getInstance().playerManager.player.getICurrency(5);if(a<e[1].num)return void GameCommon.getInstance().addAlert("钻石不足")}else if(!GameFight.getInstance().checkBagIsFull()){var i=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);i.setByte(3),GameCommon.getInstance().sendMsgToServer(i)}if(!GameFight.getInstance().checkBagIsFull()){var i=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);i.setByte(4),GameCommon.getInstance().sendMsgToServer(i)}}},t.prototype.onTouchBtnTurn=function(){if(!this.isAction){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(0==t){var n=DataManager.getInstance().playerManager.player.getICurrency(5);if(n<this.manager.zhuanpanModel.costList[1].num)return void GameCommon.getInstance().addAlert("钻石不足")}else if(!GameFight.getInstance().checkBagIsFull()){var a=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}if(!GameFight.getInstance().checkBagIsFull()){var a=new Message(MESSAGE_ID.ARTIFACT_ROLL_PLATE);a.setByte(2),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onUpdateCost=function(){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.manager.zhuanpanModel.costList[0].id),t=e?e.num:0;if(t>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.manager.zhuanpanModel.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0;var n=GameCommon.getInstance().getThingModel(this.manager.zhuanpanModel.costList[1].type,this.manager.zhuanpanModel.costList[1].id);this.label_points.text=this.manager.zhuanpanModel.costList[1].num.toString();var a=DataManager.getInstance().playerManager.player.getICurrency(5);a<this.manager.zhuanpanModel.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.img_cons.source=n.dropicon}var i=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.costFive);if(t>=i[0].num)this.consumItem1.visible=!0,this.consumItem1.setCostByAwardItem(i[0]),this.img_cons1.visible=!1,this.label_points1.text="";else{this.consumItem1.visible=!1,this.img_cons1.visible=!0,this.label_points1.text=i[1].num.toString();var a=DataManager.getInstance().playerManager.player.getICurrency(5);a<i[1].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899}},t.prototype.onShowTurnplate=function(){var e,t=GameCommon.getInstance().onParseAwardItemstr(this.manager.zhuanpanModel.show),n=(this.manager.zhuanpanModel.show.split("#"),0);for(n=0;n<t.length;n++){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(t[n].id,t[n].type);this.currHasNum[n]=a,e=GameCommon.getInstance().getThingModel(t[n].type,t[n].id);var i=void 0;i=this["img_icon"+n],i.onUpdate(t[n].type,t[n].id,0,t[n].quality,t[n].num,t[n].lv),i.name_label.text="",i.num_label.text="",i.currentState="notName",this["label_num"+n].text="X"+t[n].num}},t}(BaseTabView);__reflect(ShenQiTreasurePanel.prototype,"ShenQiTreasurePanel");var ShenQiTreasureRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.HefuRankPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().shenqiZhuanPanManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=HefuActRankItem,this.itemlist.itemRendererSkinName=skins.LiuyiTreasureRankItemSkin,this.itemlist.percentWidth=600,this.itemlist.percentHeight=166,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()
},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("LIUYI_ZHUANPAN_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.ARTIFACT_ROLL_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){for(var e=[],t=0;t<ActivityDefine.LIUYI_ZHUANPAN_AWARD.length;t++)e[t]=t+1;this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ACT_SHENQICHOUQIAN);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.zhuanpanRanks)for(var t=3;t<this.manager.zhuanpanRanks.length;t++){var n=this.manager.zhuanpanRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.lotteryNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t}(BaseTabView);__reflect(ShenQiTreasureRankPanel.prototype,"ShenQiTreasureRankPanel");var Sign8Panel=function(e){function t(t){var n=e.call(this,t)||this;return n.idx=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.Sign8PanelSkin},t.prototype.onInit=function(){this.scroller.horizontalScrollBar.visible=!1,this.scroller.verticalScrollBar.visible=!1,this.sign_group.itemRenderer=Sign8Item,this.sign_group.itemRendererSkinName=skins.Sign8ItemSkin,this.sign_group.useVirtualLayout=!0,this.scroller.viewport=this.sign_group;var t=[],n=0,a=DataManager.getInstance().newactivitysManager;for(var i in JsonModelManager.instance.getModeldenglu()){var o=JsonModelManager.instance.getModeldenglu()[i];o.days<=a.limitLoginDay&&(this.idx=n),t.push(o),n++}this.sign_group.dataProvider=new eui.ArrayCollection(t),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.LIMIT_SIGN_REWARD_MESSAGE.toString(),this.onUpBack,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.LIMIT_SIGN_REWARD_MESSAGE.toString(),this.onUpBack,this),e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){for(var e=0;e<this.sign_group.numChildren;e++){var t=this.sign_group.getChildAt(e);t.data=t.data}},t.prototype.onUpBack=function(){this.onRefresh()},t}(BaseTabView);__reflect(Sign8Panel.prototype,"Sign8Panel");var Sign8Item=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.btn_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventClick,this)},t.prototype.onEventClick=function(){var e=new Message(MESSAGE_ID.LIMIT_SIGN_REWARD_MESSAGE);e.setByte(this.data.days),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onUpdate=function(){this.reward_group.removeChildren();var e=this.data;this.days_blab.text=Tool.getChineseByImgNum(e.days-1);for(var t=0;t<e.rewards.length;t++){var n=e.rewards[t],a=new GoodsInstance;a.scaleX=.9,a.scaleY=.9,a.onUpdate(n.type,n.id,0,n.quality,n.num),this.reward_group.addChild(a)}e.days>DataManager.getInstance().newactivitysManager.limitLoginDay?(this.btn_group.enabled=!1,this.btn_group.label="领取"):1==DataManager.getInstance().newactivitysManager.limitLoginRewardDay[this.itemIndex]?(this.btn_group.enabled=!1,this.btn_group.label="已领取"):(this.btn_group.enabled=!0,this.btn_group.label="领取")},t}(BaseListItem);__reflect(Sign8Item.prototype,"Sign8Item");var ExchangeDebrisPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.Exchange_Num=500,n.Exchange_OpenVipLv=5,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ExchangeDebrisSkin},t.prototype.onInit=function(){this.setTitle("exchange_hzdh_title_png"),this.goods_left.onUpdate(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_CZSP,0,-1,500),this.goods_right.onUpdate(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_TSSP,0,-1,10),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().bagManager.getGoodsThingNumById(GoodsDefine.ITEM_ID_CZSP);this.consume_num_label.text=""+e,this.Exchange_Num>e?(this.btn_exchange.label="碎片不足",GameCommon.getInstance().onButtonEnable(this.btn_exchange,!1)):(this.btn_exchange.label="兑换",GameCommon.getInstance().onButtonEnable(this.btn_exchange,!0))},t.prototype.reciveUpdateBagMsg=function(e){e.data==GOODS_TYPE.ITEM&&this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_exchange.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchange,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE,this.reciveUpdateBagMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_exchange.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchange,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE,this.reciveUpdateBagMsg,this)},t.prototype.onExchange=function(){var e=new Message(MESSAGE_ID.EXCHANGE_HZSP_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onShow=function(){if(DataManager.getInstance().playerManager.player.viplevel<this.Exchange_OpenVipLv){var t=[{text:"VIP"+this.Exchange_OpenVipLv,style:{textColor:2680872}},{text:"可开启兑换功能，是否前往充值？",style:{textColor:15326899}}];return void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},this)))}e.prototype.onShow.call(this)},t}(BaseWindowPanel);__reflect(ExchangeDebrisPanel.prototype,"ExchangeDebrisPanel");var TreasureRankListPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TreasureRankListPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.itemGroup.useVirtualLayout=!0,this.top_scroll.viewport=this.itemGroup,this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRefresh=function(){var e=[],t=DataManager.getInstance().treasureRankManager.record;for(var n in t)e.push(t[n]);this.itemGroup.dataProvider=new eui.ArrayCollection(e)},t}(BaseWindowPanel);__reflect(TreasureRankListPanel.prototype,"TreasureRankListPanel");var TreasureListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){var e=this.data;e&&(this.img_bg.visible=1==(1&this.itemIndex),this.label_rank.text=(this.itemIndex+1).toString(),this.label_name.text=e.name,this.label_integral.text=e.integral.toString())},t}(eui.ItemRenderer);__reflect(TreasureListItemRenderer.prototype,"TreasureListItemRenderer");var TreasureRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TreasureRankPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh(),GameCommon.getInstance().addUnderlineStr(this.exchange_label)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_list.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnlist,this),this.exchange_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchangeHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TREASURE_RANK_LIST_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.btn_list.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnlist,this),this.exchange_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExchangeHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TREASURE_RANK_LIST_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().treasureRankManager,t=e.data,n=e.record[1],a=t[0];this.act_desc_label.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml("活动须知：单次寻宝获得1积分，寻宝积分至少达到[#FFFF00"+a.jifen+"分]才可以领取排行奖励，奖励将于0点通过邮件发放")),n?(this.my_integral.text=e.my_integral+"",this.vip.text="V"+n.vipLv,this.label_name.text=n.name,this.label_integral.text=n.integral+"积分",this.not_award_label.visible=n.integral<a.jifen,this.not_award_label.visible&&(this.not_award_label.text="积分不足"+a.jifen+"不能获得奖励"),this.nulldateLab.visible=!1,this.infoLayer.visible=!0):(this.nulldateLab.visible=!0,this.infoLayer.visible=!1,this.not_award_label.visible=!1),this.goods.onUpdate(a.rewards[0].type,a.rewards[0].id,0,a.rewards[0].quality,a.rewards[0].num),this.goods.addAnimation("biankuangdonghua2");for(var i=1;i<t.length;i++)this["item"+(i+1)].data=t[i]},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(DataManager.getInstance().treasureRankManager.activityId);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.label_timedown.text=GameCommon.getInstance().getTimeStrForSec1(e,2)},t.prototype.onTouchBtnlist=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("EquipNBPanel",0))},t.prototype.onExchangeHandler=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ExchangeDebrisPanel")},t}(BaseWindowPanel);__reflect(TreasureRankPanel.prototype,"TreasureRankPanel");var TreasureRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){var e,t=(DataManager.getInstance().treasureRankManager.data,DataManager.getInstance().treasureRankManager.record);e=t[this._data.currRank],e?(this.label_name.text=e.name,this.label_integral.text=e.integral+"积分",this.not_award_label.visible=e.integral<this._data.jifen,this.not_award_label.visible&&(this.not_award_label.text="积分不足"+this._data.jifen+"不能获得奖励"),this.nulldateLab.visible=!1,this.infoLayer.visible=!0):(this.nulldateLab.visible=!0,this.infoLayer.visible=!1,this.not_award_label.visible=!1),this.goods.onUpdate(this._data.rewards[0].type,this._data.rewards[0].id,0,this._data.rewards[0].quality,this._data.rewards[0].num),this._data.currRank>3?(this.commonRankLayer.visible=!0,this.rank_icon.visible=!1,this.bmt_rank.text=this._data.currRank+""):(this.commonRankLayer.visible=!1,this.rank_icon.visible=!0,this.rank_icon.source="rank_itemtitle"+this._data.currRank+"_png")},t}(eui.Component);__reflect(TreasureRankItem.prototype,"TreasureRankItem");var ActivityCrossPayRankPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActCrossPayRankPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().tuangouActManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=CrossPayRankItem,this.itemlist.itemRendererSkinName=skins.CrossPayRankItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_CROSS_PAYRANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().addEventListener("CROSS_PAY_LOOP_RANK",this.openRankView,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_CROSS_PAYRANK.toString(),this.onupdateRanks,this),GameDispatcher.getInstance().removeEventListener("CROSS_PAY_LOOP_RANK",this.openRankView,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.requestRankInfo()},t.prototype.requestRankInfo=function(){var e=new Message(MESSAGE_ID.ACT_CROSS_PAYRANK);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onupdateRanks=function(){this.myPro.text="我的筹金："+this.manager.crossPayRankMoney,this.manager.crossPayMyRank>0?this.myRank.text="我的排名："+this.manager.crossPayMyRank:this.myRank.text="我的排名：未上榜";var e=[],t=JsonModelManager.instance.getModelkuafuchongzhi();for(var n in t){var a=t[n];e.push(a)}this.itemlist.dataProvider=new eui.ArrayCollection(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ZHIZUN_XIANGOU);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.openRankView=function(){var e=[];if(this.manager.crossPayRanks)for(var t=3;t<this.manager.crossPayRanks.length;t++){var n=this.manager.crossPayRanks[t],a=new TopRankSimple;a.rank=n.rank,a.name=n.playerName,a.vip=n.viplevel,a.value=n.payNum,e.push(a)}var i=DataManager.getInstance().topRankManager;i.lastRankType=TopRankManager.RANK_SIMPLE_TYPE_CROSSPAY,i.lastDataList=e,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TopRankActivityPanel")},t}(BaseTabView);__reflect(ActivityCrossPayRankPanel.prototype,"ActivityCrossPayRankPanel");var CrossPayRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initializeSize=function(){this.width=600,this.height=166},t.prototype.onInit=function(){this.ranklist.hasEventListener(egret.TouchEvent.TOUCH_TAP)||(GameCommon.getInstance().addUnderlineStr(this.ranklist),this.ranklist.touchEnabled=!0,this.ranklist.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoopRankView,this))},t.prototype.onUpdate=function(){var e=this.data,t=e.rewards;this.awards.removeChildren();for(var n=0;n<t.length;n++){var a=t[n],i=GameCommon.getInstance().createGoodsIntance(a);this.awards.addChild(i)}var o=DataManager.getInstance().tuangouActManager.crossPayRanks[e.id-1];e.rankMax>3?(this.topGroup.visible=!1,this.otherGroup.visible=!0,this.rank.source="rankbg_4_png",e.rankMax<=20?this.rank_num_lab.text="4-20":this.rank_num_lab.text="21-50"):o?(this.topGroup.visible=!0,this.otherGroup.visible=!1,this.rank.source="rankbg_"+o.rank+"_png",this.rank_num_lab.text=o.rank.toString(),this.info_group.visible=!0,this.info_none.visible=!1,this.name_label.text=o.playerName,o.viplevel>0?this.vip_image.source="vip_v_png":this.vip_image.source="",this.value_label.text="筹金"+o.payNum):(this.rank.source="rankbg_"+e.rankMax+"_png",this.rank_num_lab.text=e.rankMax.toString(),this.topGroup.visible=!0,this.otherGroup.visible=!1,this.info_group.visible=!1,this.info_none.visible=!0)},t.prototype.onLoopRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event("CROSS_PAY_LOOP_RANK"))},t}(BaseListItem);__reflect(CrossPayRankItem.prototype,"CrossPayRankItem");var ActivityTuangouMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isActivity=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){this.points=[],this.modelGroup=JsonModelManager.instance.getModelactivityGroup()[ACTIVITY_TYPE.ACTIVITY_TUANGOU],this.activityIds=GameCommon.parseIntArray(this.modelGroup.activityId),e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);var t=0;this.activityIdNow=[],this.params=[];for(var n=new RegisterSystemParam,a=0;a<this.activityIds.length;a++){var i=this.activityIds[a],o=DataManager.getInstance().activityManager.getRegisterTabBtnParam(i);o&&(this.points[t]||(this.points[t]=new redPoint),o.redP=this.points[t],o.redP.addTriggerFuc(DataManager.getInstance().activityManager,"checkActivityPointByID",i),t++,this.params.push(o),this.activityIdNow.push(i)),n.tabBtns=this.params}this.registerPage([n],"tuangouActivityGrp",GameDefine.RED_TAB_POS),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(ActivityTuangouMainPanel.prototype,"ActivityTuangouMainPanel");var ActivityZhongchouPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivityZhongchouPanelSkin},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().tuangouActManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=ActZhongchouItem,this.itemlist.itemRendererSkinName=skins.ZhongchouActItemSkin,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_TUANGOU_MESSAGE.toString(),this.onUpdate,this),this.examineCD(!0),this.onRequetTuangouMsg()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_TUANGOU_MESSAGE.toString(),this.onUpdate,this),this.examineCD(!1)},t.prototype.onRequetTuangouMsg=function(){var e=new Message(MESSAGE_ID.ACT_TUANGOU_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRefresh=function(){},t.prototype.onUpdate=function(){var e=[],t=JsonModelManager.instance.getModeltuangouhuodong(),n=0;for(var a in t){var i=t[a];e.push(i),n=Math.max(i.severPay,n)}this.itemlist.dataProvider=new eui.ArrayCollection(e),this.zonemoney_probar.maximum=n,this.zonemoney_probar.value=this.manager.tuangou_ZoneMoney,this.memoney_lab.text=this.manager.tuangou_MeMoney+""},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.TIANZUNZHONGCHOU);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t}(BaseTabView);__reflect(ActivityZhongchouPanel.prototype,"ActivityZhongchouPanel");var ActZhongchouItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuy,this)},t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().tuangouActManager;this.condition1_lab.text="本服总筹金达到"+e.severPay,this.condition1_lab.textColor=t.tuangou_ZoneMoney>=e.severPay?5963665:14211288,this.condition2_lab.text="且个人筹金达到"+e.privatePay,this.condition2_lab.textColor=t.tuangou_MeMoney>=e.privatePay?5963665:14211288,this.goodsitem.onUpdate(e.rewards[0].type,e.rewards[0].id,0,e.rewards[0].quality,e.rewards[0].num),t.tuangou_buyIds.indexOf(e.id)>=0?(this.buy_btn.enabled=!1,this.buy_btn.label="已购买"):t.tuangou_ZoneMoney>=e.severPay&&t.tuangou_MeMoney>=e.privatePay?(this.buy_btn.enabled=!0,this.buy_btn.label="购买"):(this.buy_btn.enabled=!1,this.buy_btn.label="未达成"),this.price_lab.text=""+GameCommon.parseAwardItem(e.price).num,this.currentState=e.id%2==0?"right":"left"},t.prototype.onBuy=function(){var e=new Message(MESSAGE_ID.ACT_TUANGOU_MESSAGE);e.setByte(this.data.id),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseListItem);__reflect(ActZhongchouItem.prototype,"ActZhongchouItem");var ActivitysVipXiangouPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.index=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VipXiangouPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.vip_scroller.verticalScrollBar.visible=!1,this.itemQueue=[];var t,n=JsonModelManager.instance.getModelxiangoulibao2();for(var a in n){t=new VipLimitItem,t.data=n[a];n[a];t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemQueue.push(t),this.vip_group.addChild(t)}this.onRefresh()},t.prototype.onRefresh=function(){this.updateInfo(),this.updateSelected()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIP_XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XIANGOULIBAO_BUY_MESSAGE.toString(),this.onxiangouBuyover,this),this.examineCD(!1)},t.prototype.updateInfo=function(){var e=this.itemQueue[this.index-1];if(this.vip_nv.source=e.data.image,e.data.vip<=this.getPlayerData().viplevel){var t=DataManager.getInstance().newactivitysManager.vipxiangoudate,n=0;this.btn_buy.visible=!0,t[e.data.id]?(n=t[e.data.id][1],n>=e.data.max?this.btn_buy.label="已购买":(this.btn_buy.enabled=!0,this.btn_buy.label=GameCommon.parseAwardItem(e.data.price).num+"钻石")):(this.btn_buy.enabled=!0,this.btn_buy.label=GameCommon.parseAwardItem(e.data.price).num+"钻石")}else this.btn_buy.visible=!1;this.vip_reward_grp.removeChildren();for(var a=0;a<e.data.rewards.length;a++){var i=e.data.rewards[a],o=new GoodsInstance;o.scaleX=.9,o.scaleY=.9,o.onUpdate(i.type,i.id,0,i.quality,i.num),this.vip_reward_grp.addChild(o)}},t.prototype.onTouchBtn=function(){var e=new Message(MESSAGE_ID.VIP_XIANGOULIBAO_BUY_MESSAGE);e.setShort(this.itemQueue[this.index-1].data.id),e.setShort(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.VIP_XIANGOU2);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){},t.prototype.onxiangouBuyover=function(){this.onRefresh()},t.prototype.updateSelected=function(){for(var e=this.itemQueue.length,t=0;e>t;t++)this.itemQueue[t].selecet=t==this.index-1},t.prototype.onTouchItem=function(e){var t=e.currentTarget;this.index=t.data.id,this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(ActivitysVipXiangouPanel.prototype,"ActivitysVipXiangouPanel");var VipLimitItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.VipLimitItemSkin},t.prototype.onInit=function(){null!=this._selected&&(this.selecet=this._selected)},t.prototype.dataChanged=function(){this.v_img.source="icon_v"+this._data.vip+"_png"},Object.defineProperty(t.prototype,"selecet",{set:function(e){this._selected=e,this.isLoaded&&(this.btn.selected=e)},enumerable:!0,configurable:!0}),t}(BaseComp);__reflect(VipLimitItem.prototype,"VipLimitItem");var VipActMainView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin,this.setTitle("vip转盘")},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="VipZhuanPanPanel",n.btnRes="tab_icon_zhizunzhuanpan",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().vipManager,"getZhuanPanPoint"),t.push(n),this.registerPage(t,"vipzhuanpanGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().magicManager.onSendMessage()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_MESSAGE.toString(),this.onRefresh,this)},t}(BaseSystemPanel);__reflect(VipActMainView.prototype,"VipActMainView");var VipPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.tab=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VipPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.desc_scroller.verticalScrollBar.autoVisibility=!1,this.desc_scroller.verticalScrollBar.visible=!1,GameCommon.getInstance().addUnderlineStr(this.loolLabel),this.loolLabel.touchEnabled=!0,this.loolLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowTeQuan,this),this.viewmask=new egret.Shape,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.5),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,this.stage.stageWidth,this.stage.stageHeight),this.viewmask.graphics.endFill(),this.tips_mask.addChild(this.viewmask),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTeQuan,this),this.btn_pageUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPageUp,this),this.btn_pageDown.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPageDown,this),this.btn_recharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onShowVIPInfo,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTeQuan,this),this.btn_pageUp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPageUp,this),this.btn_pageDown.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPageDown,this),this.btn_recharge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRecharge,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onShowVIPInfo,this)},t.prototype.onShowTeQuan=function(e){this.tequan.visible=!0,this.tips_mask.visible=!0},t.prototype.onCloseTeQuan=function(){this.tequan.visible=!1,this.tips_mask.visible=!1},t.prototype.onUpdateCurrency=function(){this.onShowVIPInfo(),this.onShowPrerogative()},t.prototype.onTouchBtnRecharge=function(){this.onHide(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onShowPrerogative=function(){var e=this.tab+1;e>=VipDefine.MAX_VIPLEVEL&&(e=VipDefine.MAX_VIPLEVEL);var t=Constant.get(Constant.VIP_POWER).split(",");t[e-1]&&(this.powerUp.text=t[e-1]);var n=GameCommon.getInstance().getVipName(e);this.font_common.text=GameCommon.getInstance().getVipName(e).toString(),this.img_prerogative.source="vip_desc_zi"+GameCommon.getInstance().getVipName(e)+"_png";var a,i;this.awardLayer.removeChildren();for(var o=JsonModelManager.instance.getModelvip()[e-1],r=GameCommon.getInstance().onParseAwardItemstr(o.gainId),s=0;s<r.length;s++)i=r[s],a=GameCommon.getInstance().createGoodsIntance(i),this.awardLayer.addChild(a);this.label1.text="充值"+o.costNum+"元成为VIP"+GameCommon.getInstance().getVipName(o.level);for(var h=o.miaoshu,l=h.split("#"),g="",s=0;s<l.length;++s){var c=l[s].split(","),p=c[0],u=c[1],d=s+1;g+="12"!=p?(s>0?"\n":"")+d+"."+Language.instance.parseInsertText("vipweals_"+p,u):(s>0?"\n":"")+d+"."+Language.instance.getText("vip_miaoshu_"+n)}this.rightGroup.removeChildren(),this.leftGroup.removeChildren();var _="";_=o.donghua1;var m=new Animation(_);this.rightGroup.addChild(m);var E=o.donghua2.split(",");switch(Number(E[0])){case BLESS_TYPE.HORSE:_="zuoqi_"+E[1];var f=new Animation(_);f.y=0,this.leftGroup.addChild(f);break;case BLESS_TYPE.WEAPON:_="jian"+ +E[1];var y=new Animation(_,-1);this.leftGroup.addChild(y);break;case BLESS_TYPE.CLOTHES:var I=this.getPlayerData().sex==SEX_TYPE.MALE?"nan":"nv";_="shenzhuang_"+I+"_"+E[1];var y=new Animation(_,-1);y.y=140,this.leftGroup.addChild(y);break;case BLESS_TYPE.MAGIC:var y=new Animation("sc_magic"+ +E[1],-1);this.leftGroup.addChild(y),y.y=20,y.scaleX=y.scaleY=1.5;break;case BLESS_TYPE.WING:var y=new Animation("wing"+ +E[1]+"_ui",-1);y.y=110,this.leftGroup.addChild(y)}this.label2.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(g))},t.prototype.onTouchBtnPageUp=function(){this.tab-=1,this.tab<0&&(this.tab=0),this.onShowPrerogative()},t.prototype.onTouchBtnPageDown=function(){this.tab+=1,this.tab>=VipDefine.MAX_VIPLEVEL&&(this.tab=VipDefine.MAX_VIPLEVEL-1),this.onShowPrerogative()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){this.tab=this.getPlayerData().viplevel,this.onShowVIPInfo(),this.onShowPrerogative()},t.prototype.onShowVIPInfo=function(){var e=this.getPlayerData();this.font_vip.text=GameCommon.getInstance().getVipName(e.viplevel).toString(),this.font_vip1.text=GameCommon.getInstance().getVipName(e.viplevel+1).toString();var t=JsonModelManager.instance.getModelvip()[e.viplevel-1],n=JsonModelManager.instance.getModelvip()[e.viplevel];if(n){var a=0;t&&(a=t.costNum);var i=e.vipExp,o=n.costNum,r=n.costNum-e.vipExp,s=GameCommon.getInstance().getVipName(e.viplevel+1);this.label_rechargeAgain.textFlow=new Array({text:"再充值",style:{}},{text:r+"",style:{textColor:5431826}},{text:"元即可成为",style:{}},{text:"VIP"+s,style:{textColor:5431826}}),this.viplvGroup.visible=!0,this.bar_recharge.visible=!0,this.bar_recharge.maximum=o,this.bar_recharge.value=i
}else this.viplvGroup.visible=!1,this.bar_recharge.visible=!1,this.bar_recharge.maximum=0,this.bar_recharge.value=0,this.label_rechargeAgain.textFlow=new Array({text:"已达目前VIP最高等级",style:{}})},t.prototype.onTouchBtnbuy=function(){},t}(BaseWindowPanel);__reflect(VipPanel.prototype,"VipPanel");var VipZhuanPanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.WEEK_AWD_MAX=5,n.points=RedPointManager.createPoint(1),n._vipNum=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VipZhuanPanSkin},t.prototype.onInit=function(){this.model=JsonModelManager.instance.getModelzhuanpanvip()[1],e.prototype.onInit.call(this),this.currHasNum=[],this.points[0].register(this.reward_week_btn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().festivalWuYiManager,"checkTreasurePoint");for(var t=this.model.box.split("#"),n=0;5>n;n++){var a=t[n]?t[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this["award_times_lab"+n].text=Language.instance.getText(i,"times"),this["award_box_img"+n].name=a[1],this["award_box_img"+n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this)}for(var o=this.model.show.split("#"),n=0;8>n;n++){var a=o[n]?o[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this["itemBtn"+n].name=a[1],this["itemBtn"+n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)}for(;this.effectGroup.numChildren>0;){var r=this.effectGroup.getChildAt(0);egret.is(r,"Animation")?r.onDestroy():this.effectGroup.removeChild(r)}var s=new Animation("vipzhuanpan");s.x=55,s.y=75,this.effectGroup.addChild(s),this.effectGroup.visible=!0,this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.reward_week_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ROLL_PLATE_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIP_ROLL_PLATE.toString(),this.onTreasureBackMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.reward_week_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ROLL_PLATE_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIP_ROLL_PLATE.toString(),this.onTreasureBackMsg,this)},t.prototype.onRefresh=function(){this.effectGroup.visible=!1,this.onUpdateWeekAward(),this.onShowTurnplate();var e;if(0==this.getPlayerData().viplevel)return this.week_times_lab.text="0",void(this.label_points.text="剩余次数:0");e=JsonModelManager.instance.getModelvip()[this.getPlayerData().viplevel-1];for(var t=e.weals.split("#"),n=0;n<t.length;n++){var a=t[n].split(",");11==Number(a[0])&&(this._vipNum=Number(a[1]),this.label_points.text="剩余次数:"+(this._vipNum-DataManager.getInstance().vipManager.curDayzhuanpanNum))}this.week_times_lab.text=""+DataManager.getInstance().vipManager.zhuanpanNum},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.ROLL_PLATE_REWARD);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onPlayDone1=function(){},t.prototype.onPlayDone=function(){this.onShowAward()},t.prototype.onUpdateWeekAward=function(){this.reward_week_btn.enabled=!1;for(var e=DataManager.getInstance().vipManager,t=JsonModelManager.instance.getModelzhuanpanvip()[1],n=t.box.split("#"),a=0;a<this.WEEK_AWD_MAX;a++){var i=n[a]?n[a].split(","):null;if(!i)break;var o=parseInt(i[0]),r=this["award_box_img"+a],s=this["reward_anim_grp"+a],h=parseInt(i[0]);this["award_times_lab"+a].text=Language.instance.getText(h,"times"),s.removeChildren(),e.treasureAwdIdx>=o?r.source="treasure_box_open_png":(r.source="treasure_box_unopen_png",e.zhuanpanNum>=o&&(this.reward_week_btn.enabled||(this.reward_week_btn.enabled=!0),GameCommon.getInstance().addAnimation("baoxiangtixing",null,s,-1)))}},t.prototype.onTouchItem=function(e){for(var t=e.currentTarget,n=this.model.show.split("#"),a=0;8>a;a++){var i=n[a]?n[a].split(","):null;if(!i)break;if(t.name==i[1]){var o=GameCommon.getInstance().getThingModel(i[0],i[1]);return void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.ITEM,o,0)))}}},t.prototype.onTouchBox=function(e){var t=e.currentTarget,n=JsonModelManager.instance.getModelbox()[t.name],a=new ThingBase(GOODS_TYPE.BOX);a.onupdate(t.name,n.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,a,0)))},t.prototype.onTreasureBackMsg=function(){this.onRotateback()},t.prototype.onShowAward=function(){for(var e=GameCommon.getInstance().onParseAwardItemstr(this.model.show),t=0;t<e.length;t++)if(DataManager.getInstance().vipManager.zhuanpanId==e[t].id&&DataManager.getInstance().vipManager.zhuanpanType==e[t].type&&DataManager.getInstance().vipManager.zhuanpanAwardNum==e[t].num){var n=DataManager.getInstance().bagManager.getGoodsThingNumById(e[t].id,e[t].type)-this.currHasNum[t];if(n>0){var a=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);GameCommon.getInstance().onGetThingAlert(a,n,GOODS_CHANGE_TYPE.DELAY_ADD)}}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0,this.effectGroup.visible=!1;var e=(this.model.show.split("#"),0),t=GameCommon.getInstance().onParseAwardItemstr(this.model.show);for(e=0;e<t.length;e++)if(DataManager.getInstance().vipManager.zhuanpanId==t[e].id&&DataManager.getInstance().vipManager.zhuanpanType==t[e].type&&DataManager.getInstance().vipManager.zhuanpanAwardNum==t[e].num){var n;return n=this.getRotationLong(8,6,5,e,1),egret.Tween.get(this.effectGroup).to({rotation:n},3500,egret.Ease.sineInOut).call(this.onPlayDone1,this).wait(1e3).call(this.onReady1,this),void egret.Tween.get(this.disc_outside).to({rotation:n},3500,egret.Ease.sineInOut).call(this.onPlayDone,this).wait(3500).call(this.onReady,this)}}},t.prototype.getRotationLong=function(e,t,n,a,i){void 0===i&&(i=1);var o=360/e*a*i,r=360*(Math.floor(Math.random()*(n-t))+t)*i;return r+o},t.prototype.onTouchBtnTurn=function(){if(!this.isRun){var e=new Message(MESSAGE_ID.VIP_ROLL_PLATE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onReady1=function(){this.effectGroup.visible=!0},t.prototype.onReady=function(){this.effectGroup.visible=!1,this.onRefresh()},t.prototype.onShowTurnplate=function(){this.isRun=!1;var e=GameCommon.getInstance().onParseAwardItemstr(this.model.show),t=(this.model.show.split("#"),0);for(t=0;t<e.length;t++){var n=DataManager.getInstance().bagManager.getGoodsThingNumById(e[t].id,e[t].type);this.currHasNum[t]=n;var a=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);this["img_icon"+t].source=a.icon,this["label_num"+t].text="X"+e[t].num}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(VipZhuanPanPanel.prototype,"VipZhuanPanPanel");var WuYiActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(3),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.setTitle("wuyiTitle1_png");var t=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);t.setByte(0),GameCommon.getInstance().sendMsgToServer(t);var n=[],a=new RegisterSystemParam;a.sysName="WuyiTreasurePanel",a.btnRes="wuyiZhuanPanBtn",a.redP=this.points[0],a.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"checkZhuanPanPoint"),n.push(a),a=new RegisterSystemParam,a.sysName="WuYiLoginActivityPanel",a.btnRes="wuyiDengluhaoliBtn",a.redP=this.points[1],a.redP.addTriggerFuc(DataManager.getInstance().festivalWuYiManager,"loginPoint"),n.push(a),a=new RegisterSystemParam,a.sysName="WuYiSaleActivityPanel",a.btnRes="wuyiTeHuiBtn",a.redP=this.points[2],n.push(a),this.registerPage(n,"fightSpriteGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("wuyiTitle1_png");break;case 1:this.setTitle("wuyiTitle2_png");break;case 2:this.setTitle("wuyiTitle3_png")}e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(WuYiActivityPanel.prototype,"WuYiActivityPanel");var WuYiLoginActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tabIdx=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuYiLoginActivitySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=DataManager.getInstance().festivalLoginManager;for(var n in t.record)this.tabIdx=this.tabIdx+1;this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_getReward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this);for(var t=1;4>t;t++)this["boxIcon"+t].name=t,this["boxIcon"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=1;4>t;t++)this["boxIcon"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);this.btn_getReward.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.onShowAward(this.tabIdx)},t.prototype.onShowAward=function(e){for(var t=DataManager.getInstance().festivalLoginManager,n=1;4>n;n++){n==this.tabIdx?(this["boxIcon"+n].source="activityboxSelect_png",this.curSelectBox.x=180*n-205):this["boxIcon"+n].source="activitybox_png";var a=t.record[n];a&&2==a.state&&(this["boxIcon"+n].source="activityboxOpen_png")}this.loginActCfg=JsonModelManager.instance.getModeldengluhuodong()[e-1];for(var i=this.loginActCfg.rewards;this.award_grp.numChildren>0;){var o=this.award_grp.getChildAt(0);this.award_grp.removeChild(o)}for(var n=0;n<i.length;n++){var r=new GoodsInstance,s=i[n];r.onUpdate(s.type,s.id,0,s.quality,s.num,s.lv),this.award_grp.addChild(r)}var h=t.record[e];if(h)switch(this.btn_getReward.enabled=1==h.state,h.state){case 0:this.btn_getReward.label="未登录";break;case 1:this.btn_getReward.label="领取奖励";break;case 2:this.btn_getReward.label="已领取"}else this.btn_getReward.enabled=!1,this.btn_getReward.label="未开启"},t.prototype.onTab=function(e){var t=Number(e.target.name);this.tabIdx!=t&&(this.tabIdx=t,this.onShowAward(this.tabIdx))},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.WUYIACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE);e.setByte(this.loginActCfg.days),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onGetAward=function(){var e=new Message(MESSAGE_ID.FESTIVAL_LOGIN_AWARD_RECEIVE);e.setByte(this.loginActCfg.days),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(WuYiLoginActivityPanel.prototype,"WuYiLoginActivityPanel");var WuYiSaleActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tabIdx=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuyiSaleActivitySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this._mountBody=new Animation("tehuilibao"),this._mountBody.y=95,this.effect.addChild(this._mountBody),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_Buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this);for(var t=1;5>t;t++)this["icon"+t].name=t,this["icon"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBATE_TO_BUY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=1;5>t;t++)this["icon"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);this.btn_Buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.REBATE_TO_BUY_MESSAGE.toString(),this.onRefresh,this),this.examineCD(!1)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.WUYIACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onRefresh=function(){this.onShowAward(this.tabIdx)},t.prototype.onShowAward=function(e){this._mountBody.x=152*(e-1)+74,this.loginActCfg=JsonModelManager.instance.getModeltehuilibaohuodong()[e];for(var t=this.loginActCfg.rewards;this.award_grp.numChildren>0;){var n=this.award_grp.getChildAt(0);this.award_grp.removeChild(n)}for(var a=0;a<t.length;a++){var i=new GoodsInstance,o=t[a];i.onUpdate(o.type,o.id,0,o.quality,o.num,o.lv),this.award_grp.addChild(i)}this.descLable.text=this.loginActCfg.des+"    原价"+this.loginActCfg.yuanjia,this.tabIdx=e,this.btnStatus(e)},t.prototype.btnStatus=function(e){var t=DataManager.getInstance().festivalWuYiManager.record;this.label_points1.text=this.loginActCfg.price.toString();var n=DataManager.getInstance().playerManager.player.getICurrency(5);n<this.loginActCfg.price?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899;for(var a in t)if(t[a]==e)return this.btn_Buy.label="已购买",void(this.btn_Buy.enabled=!1);this.btn_Buy.enabled=!0,this.btn_Buy.label="购 买"},t.prototype.onTab=function(e){var t=Number(e.target.name);this.tabIdx!=t&&(this.tabIdx=t,this.onShowAward(this.tabIdx))},t.prototype.onTouchBtnAward=function(){if(!GameFight.getInstance().checkBagIsFull()){var e=new Message(MESSAGE_ID.REBATE_TO_BUY_MESSAGE);e.setByte(this.tabIdx),e.setInt(17),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onGetAward=function(){var e=new Message(MESSAGE_ID.TREASURE_WEEK_AWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(WuYiSaleActivityPanel.prototype,"WuYiSaleActivityPanel");var WuyiTreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.WEEK_AWD_MAX=4,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuyiTreasurePanelSkin},t.prototype.onInit=function(){this.model=JsonModelManager.instance.getModelzhuanpanhuodong()[1],e.prototype.onInit.call(this),this.currHasNum=[],this.img_selected.visible=!0,this.points[0].register(this.reward_week_btn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().festivalWuYiManager,"checkTreasurePoint");for(var t=this.model.box.split("#"),n=0;4>n;n++){var a=t[n]?t[n].split(","):null;if(!a)break;var i=parseInt(a[0]);this["award_times_lab"+n].text=Language.instance.getText(i,"times"),this["award_box_img"+n].name=a[1],this["award_box_img"+n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this)}this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),this.reward_week_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.reward_week_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAward,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),this.btn_turn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn1,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE.toString(),this.onTreasureBackMsg,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.isRun=!1,this.onUpdateWeekAward(),this.onShowTurnplate(),this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);e.setByte(2),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.WUYIACTIVITY);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onNextData=function(){this.week_times_lab.text=""+DataManager.getInstance().festivalWuYiManager.zhuanpanNum;var e=DataManager.getInstance().bagManager.getGoodsThingById(this.model.costList[0].id);e?e.num:0;if(e&&e.num>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.model.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,this.label_points.text=this.model.costList[1].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<this.model.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899}var n=GameCommon.getInstance().onParseAwardItemstr(this.model.costTen);this.label_points1.text=n[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);t<n[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t.prototype.onPlayDone=function(){this.onShowAward(),this.onRefresh(),this.isRun=!0},t.prototype.onUpdateWeekAward=function(){this.reward_week_btn.enabled=!1;var e=DataManager.getInstance().festivalWuYiManager,t=JsonModelManager.instance.getModelzhuanpanhuodong()[1],n=t.box.split("#"),a=0;for(this.nextNBItemDesc.text="";this.nbItem.numChildren>0;){var i=this.nbItem.getChildAt(0);this.nbItem.removeChild(i)}for(var o=0;o<this.WEEK_AWD_MAX;o++){var r=n[o]?n[o].split(","):null;if(!r)break;var s=parseInt(r[0]),h=this["award_box_img"+o],l=this["reward_anim_grp"+o],g=parseInt(r[0]);if(this["award_times_lab"+o].text=Language.instance.getText(g,"times"),l.removeChildren(),e.treasureAwdIdx>=s)a+=1,h.source="treasure_box_open_png";else if(h.source="treasure_box_unopen_png",e.zhuanpanNum>=s)this.reward_week_btn.enabled||(this.reward_week_btn.enabled=!0),GameCommon.getInstance().addAnimation("baoxiangtixing",null,l,-1),a+=1;else if(a==o){var c=JsonModelManager.instance.getModelbox()[parseInt(r[1])],p=new GoodsInstance,u=c.rewards[0];p.onUpdate(u.type,u.id,0,u.quality,u.num,u.lv),this.nextNBItemDesc.text="再抽"+(s-e.zhuanpanNum)+"次可获得",this.nbItem.addChild(p)}}},t.prototype.onTouchBox=function(e){var t=e.currentTarget,n=JsonModelManager.instance.getModelbox()[t.name],a=new ThingBase(GOODS_TYPE.BOX);a.onupdate(t.name,n.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,a,0)))},t.prototype.onTreasureBackMsg=function(){1==DataManager.getInstance().festivalWuYiManager.tp?(this.onNextData(),this.onRotateback()):10==DataManager.getInstance().festivalWuYiManager.tp||9==DataManager.getInstance().festivalWuYiManager.tp?this.onShowTenAward():this.onRefresh()},t.prototype.onShowTenAward=function(){var e=new TurnplateAwardParam;e.desc="十连抽获得以下奖励",e.titleSource="",e.itemAwards=DataManager.getInstance().festivalWuYiManager.temAward,e.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardPanel",e)),this.onRefresh()},t.prototype.onShowAward=function(){for(var e=GameCommon.getInstance().onParseAwardItemstr(this.model.show),t=0;t<e.length;t++){var n=DataManager.getInstance().bagManager.getGoodsThingNumById(e[t].id,e[t].type)-this.currHasNum[t];if(n>0){var a=GameCommon.getInstance().getThingModel(e[t].type,e[t].id);GameCommon.getInstance().onGetThingAlert(a,n,GOODS_CHANGE_TYPE.DELAY_ADD)}}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e=(this.model.show.split("#"),0),t=GameCommon.getInstance().onParseAwardItemstr(this.model.show);for(e=0;e<t.length;e++)if(DataManager.getInstance().festivalWuYiManager.zhuanpanId==t[e].id&&DataManager.getInstance().festivalWuYiManager.zhuanpanType==t[e].type&&DataManager.getInstance().festivalWuYiManager.zhuanpanAwardNum==t[e].num){var n;return n=this.getRotationLong(8,4,3,e,1),void egret.Tween.get(this.disc_outside).to({rotation:n},2e3,egret.Ease.sineInOut).call(this.onPlayDone,this).wait(2100).call(this.onReady,this)}}},t.prototype.onHide=function(){e.prototype.onHide.call(this),this.isRun=!1},t.prototype.getRotationLong=function(e,t,n,a,i){void 0===i&&(i=1);var o=360/e*a*i,r=360*(Math.floor(Math.random()*(n-t))+t)*i;return r+o},t.prototype.onTouchBtnTurn1=function(){if(!this.isRun){var e=GameCommon.getInstance().onParseAwardItemstr(this.model.costTen);this.label_points1.text=e[0].num.toString();var t=DataManager.getInstance().playerManager.player.getICurrency(5);if(t<e[0].num)return void GameCommon.getInstance().addAlert("error_tips_2");if(!GameFight.getInstance().checkBagIsFull()){var n=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE),a=DataManager.getInstance().bagManager.getGoodsThingById(this.model.costList[0].id),i=a?a.num:0;i>0?n.setByte(10):n.setByte(9),GameCommon.getInstance().sendMsgToServer(n)}}},t.prototype.onTouchBtnTurn=function(){if(!this.isRun){var e=DataManager.getInstance().bagManager.getGoodsThingById(this.model.costList[0].id),t=e?e.num:0;if(0==t){var n=DataManager.getInstance().playerManager.player.getICurrency(5);if(n<this.model.costList[1].num)return void GameCommon.getInstance().addAlert("error_tips_2")}if(!GameFight.getInstance().checkBagIsFull()){var a=new Message(MESSAGE_ID.INVESTTURNPLATE_LOTTERY_MESSAGE);a.setByte(1),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onReady1=function(){},t.prototype.onReady=function(){this.isRun=!1},t.prototype.onShowTurnplate=function(){var e,t=GameCommon.getInstance().onParseAwardItemstr(this.model.show),n=(this.model.show.split("#"),0);for(n=0;n<t.length;n++){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(t[n].id,t[n].type);this.currHasNum[n]=a,e=GameCommon.getInstance().getThingModel(t[n].type,t[n].id),this["img_icon"+n].source=e.icon,this["label_num"+n].textFlow=new Array({text:e.name+"*"+t[n].num,style:{textColor:GameCommon.getInstance().CreateNameColer(e.quality)}})}var i=DataManager.getInstance().bagManager.getGoodsThingById(this.model.costList[0].id),o=i?i.num:0;if(o>0)this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.model.costList[0]),this.label_points.text="",this.img_cons.visible=!1;else{this.consumItem.visible=!1,this.img_cons.visible=!0,e=GameCommon.getInstance().getThingModel(this.model.costList[1].type,this.model.costList[1].id),this.label_points.text=this.model.costList[1].num.toString();var r=DataManager.getInstance().playerManager.player.getICurrency(5);r<this.model.costList[1].num?this.label_points.textColor=16711680:this.label_points.textColor=15326899,this.img_cons.source=e.dropicon}var s=GameCommon.getInstance().onParseAwardItemstr(this.model.costTen);this.label_points1.text=s[0].num.toString();var r=DataManager.getInstance().playerManager.player.getICurrency(5);r<s[0].num?this.label_points1.textColor=16711680:this.label_points1.textColor=15326899},t}(BaseTabView);__reflect(WuyiTreasurePanel.prototype,"WuyiTreasurePanel");var ActivityYugaoPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ActivtiyYugaoPanelSkin},t.prototype.onInit=function(){this.currDate=new Date,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.examineCD(!0)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.currDate.setTime(DataManager.getInstance().playerManager.player.curServerTime),this.time=3600*this.currDate.getHours()+60*this.currDate.getMinutes()+this.currDate.getSeconds(),this.sigtime=egret.getTimer(),this.awdgrp_1.visible=!1,this.awdgrp_2.visible=!1;var e=DataManager.getInstance().activityManager.getActYugaoIdx();if(0==e)return void this.onTouchCloseBtn();if(this.bg_img.source="act_yugao_bg"+e+"_jpg",this.txt_img.source="act_yugao_txt"+e+"_png",this["awdgrp_"+e].visible=!0,this.awdgrp_2.visible&&0==this.yugao2_awd_grp.numChildren)for(var t=GameCommon.getInstance().onParseAwardItemstr("3,48,1#2,152,1#3,49,1#3,76,5#3,83,20"),n=0;n<t.length;n++){var a=GameCommon.getInstance().createGoodsIntance(t[n]);this.yugao2_awd_grp.addChild(a)}},t.prototype.onCountDown=function(){var e=86400-(this.time+Math.floor((egret.getTimer()-this.sigtime)/1e3));0>=e&&(e=0,this.examineCD(!1)),this.time_label.text="距开启还有"+GameCommon.getInstance().getTimeStrForSec1(e)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t}(BaseWindowPanel);__reflect(ActivityYugaoPanel.prototype,"ActivityYugaoPanel");var AlertDescUI=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AlertFrameSkin},t.prototype.onInit=function(){this.setTitle("提 示"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.labelAlert.textFlow=(new egret.HtmlTextParser).parser(this.param)},t.prototype.onEventOk=function(){this.onEventBack()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this)},t}(BaseWindowPanel);__reflect(AlertDescUI.prototype,"AlertDescUI");var AlertDisconnect=function(e){function t(){var t=e.call(this)||this;return DataManager.IS_PC_Game||(t.width=size.width,t.height=size.height),t.touchEnabled=!0,t.once(egret.Event.COMPLETE,t.onComplete,t),t.skinName=skins.AlertFrameSkin,t}return __extends(t,e),t.prototype.onComplete=function(){this.basic.label_title?this.onBasicComplete():this.basic.once(egret.Event.COMPLETE,this.onBasicComplete,this),this.isInit=!0,this.viewmask=new egret.Shape,this.viewmask.touchEnabled=!0,this.addChildAt(this.viewmask,0),this.text&&this.onShowAlert(this.text)},t.prototype.onBasicComplete=function(){this.basic.label_title.text="异常提示",this.basic.closeBtn2.visible=!1},t.prototype.onShowAlert=function(e){return this.isInit?(this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.6),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,size.width+Globar_Pos.x,size.height),this.viewmask.graphics.endFill(),this.labelAlert.text=e,void this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this)):void(this.text=e)},t.prototype.onBtnClick=function(e){location.reload()},t.prototype.onClose=function(){this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnClick,this),this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(AlertDisconnect.prototype,"AlertDisconnect");var AlertEscort=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AlertEscortSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("VS"),this.onRefresh()},t.prototype.onRefresh=function(){this.my_name_label.text=DataManager.getInstance().playerManager.player.name,this.my_fight_label.text=DataManager.getInstance().playerManager.player.playerTotalPower.toString();var e=1,t=1;if(egret.is(this.param.param,"EscortRobData"))this.enemy_name_label.text=this.param.param.name,this.enemy_fight_label.text=this.param.param.fightvalue,this.btnOk.label="劫 杀";else if(egret.is(this.param.param,"ArenaEnemy")){var n=this.param.param;this.enemy_name_label.text=n.playerData.name,this.enemy_fight_label.text=n.playerData.fightvalue,this.label_hint.textFlow=this.param.texts,this.btnOk.label="挑 战",e=n.playerData.headindex,t=n.playerData.headFrame}this.my_head_img.setHead(),this.enemy_head_img.setHead(e,t)},t.prototype.onEventOk=function(){this.onEventBack(),egret.callLater(this.param.callback,this.param.target,this.param.param)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t}(BaseWindowPanel);__reflect(AlertEscort.prototype,"AlertEscort");var AlertEscortParam=function(){function e(e,t,n,a){void 0===a&&(a=null),this.callback=t,this.target=n,this.param=a,this.texts=e}return e}();__reflect(AlertEscortParam.prototype,"AlertEscortParam");var AlertFrameUI=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AlertFrameSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.param.texts instanceof Array?this.labelAlert.textFlow=this.param.texts:this.labelAlert.text=this.param.texts,this.param.surelabel!=this.btnOk.label&&(this.btnOk.label=this.param.surelabel)},t.prototype.onEventOk=function(){this.onEventBack(),egret.callLater(this.param.callback,this.param.target,this.param.param)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t}(BaseWindowPanel);__reflect(AlertFrameUI.prototype,"AlertFrameUI");var AlertFrameParam=function(){function e(e,t,n,a){void 0===a&&(a=null),this.surelabel="确认",this.callback=t,this.target=n,this.param=a,this.texts=e
}return e}();__reflect(AlertFrameParam.prototype,"AlertFrameParam");var AlertReLogin=function(e){function t(t){var n=e.call(this)||this;return DataManager.IS_PC_Game||(n.width=size.width,n.height=size.height),n._gameworld=t,n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.skinName=skins.AlertReloginSkin,n.viewmask=new egret.Shape,n.viewmask.touchEnabled=!0,n.addChildAt(n.viewmask,0),n}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.onShow=function(e){this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,0),this.viewmask.graphics.drawRect(-Globar_Pos.x,0,size.width+Globar_Pos.x,size.height),this.viewmask.graphics.endFill(),this.parent||(DataManager.IS_PC_Game&&(this.x=Globar_Pos.x),e.addChild(this),this._timeout=10,Tool.addTimer(this.onTimer,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_RELOGIN_EVENT)))},t.prototype.onTimer=function(){this._timeout<=0?this.parent?(this.onClose(),this._gameworld.setAlertDisconnect(Language.ALERT_DISCONNECT_1)):Tool.removeTimer(this.onTimer,this,1e3):this._timeout--},t.prototype.onClose=function(){Tool.removeTimer(this.onTimer,this,1e3),this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(AlertReLogin.prototype,"AlertReLogin");var AwardNoticePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AwardNoticeSkin},t.prototype.onInit=function(){this.setTitle(""),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._showleftTime=this.param.autocloseTime,this.title_img.source=this.param.titleSource,this.result_label.text=this.param.desc,this.onUpdateAward(),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=this.param.btnlabel},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=this.param.btnlabel+("("+this._showleftTime+")"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.param.callFunc&&this.param.callObj&&Tool.callback(this.param.callFunc,this.param.callObj,this.param.callParam),this.param=null,this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&e.prototype.onShow.call(this)},t.prototype.onHide=function(){Tool.removeTimer(this.onCloseTimedown,this,1e3),e.prototype.onHide.call(this)},t.prototype.onUpdateAward=function(){if(this.award_group.removeChildren(),this.param.itemAwards)for(var e=0;e<this.param.itemAwards.length;e++){var t=new eui.Group,n=this.param.itemAwards[e],a=new GoodsInstance;a.horizontalCenter=0,t.addChild(a),this.award_group.addChild(t),a.onUpdate(n.type,n.id,0,n.quality,n.num)}},t}(BaseWindowPanel);__reflect(AwardNoticePanel.prototype,"AwardNoticePanel");var AwardNoticeParam=function(){function e(){this.titleSource="txt_jiangliyulan_png",this.desc="",this.btnlabel="确定",this.callFunc=null,this.callObj=null,this.callParam=null,this.autocloseTime=6}return e}();__reflect(AwardNoticeParam.prototype,"AwardNoticeParam");var BlessUpDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BlessUpDanFrameSkin},t.prototype.onInit=function(){this.labelAlert.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(Language.instance.getText("zhishengyijie"))),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.blessType);e.getNextBlessModel(this.blessType,t.grade+1,t.level);for(this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var n=this.avatar_grp.getChildAt(0);egret.is(n,"BodyAnimation")||egret.is(n,"Animation")?n.onDestroy():this.avatar_grp.removeChild(n)}var a=GoodsDefine.ITEM_BLESS_UPDAN[this.blessType];this.btnOk.enabled=!0,this.consumItem.visible=!0,this.consumItem.setConsume(GOODS_TYPE.ITEM,a),a=GoodsDefine.ITEM_BLESS_SUPERUPDAN[this.blessType],this.btnOk2.enabled=!0,this.consumItem2.visible=!0,this.consumItem.setConsume(GOODS_TYPE.ITEM,a)},t.prototype.sendUpPillBtn=function(){var e=GoodsDefine.ITEM_BLESS_UPDAN[this.blessType],t=DataManager.getInstance().bagManager.getGoodsThingById(e);if(!t||t.num<0)return GameCommon.getInstance().addAlert("error_tips_3"),void this.onTouchCloseBtn();var n=new Message(MESSAGE_ID.MOUNT_UP_PILL_MESSAGE);n.setByte(0),n.setByte(this.blessType),n.setByte(0),GameCommon.getInstance().sendMsgToServer(n),this.onTouchCloseBtn()},t.prototype.sendSuperUpPillBtn=function(){var e=GoodsDefine.ITEM_BLESS_SUPERUPDAN[this.blessType],t=DataManager.getInstance().bagManager.getGoodsThingById(e);if(!t||t.num<0)return GameCommon.getInstance().addAlert("error_tips_3"),void this.onTouchCloseBtn();var n=new Message(MESSAGE_ID.MOUNT_UP_PILL_MESSAGE);n.setByte(0),n.setByte(this.blessType),n.setByte(1),GameCommon.getInstance().sendMsgToServer(n),this.onTouchCloseBtn()},t.prototype.onShowWithParam=function(e){this.blessType=e,this.onShow()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendUpPillBtn,this),this.btnOk2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendSuperUpPillBtn,this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendUpPillBtn,this),this.btnOk2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendSuperUpPillBtn,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t}(BaseWindowPanel);__reflect(BlessUpDanPanel.prototype,"BlessUpDanPanel");var ExplainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ExplainPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("玩法说明"),this.onRefresh()},t.prototype.onRefresh=function(){this.labelAlert.textFlow=(new egret.HtmlTextParser).parser(this.param)},t.prototype.onEventOk=function(){this.onEventBack()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(ExplainPanel.prototype,"ExplainPanel");var FastBuyPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.tujingBtns=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FastBuyPanelSkin},t.prototype.onShowWithParam=function(e){this.thingmodel=e,this.thingmodel&&this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyItem,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateHasMoney,this),this.batch_bar.onRegist()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.tujingBtns.length;t++){var n=this.tujingBtns[t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoItem,this)}this.batch_bar.onRemove(),this.buy_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyItem,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateHasMoney,this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.batch_bar.onSetUpdateCall(this.onBatchUpdateHandler,this),this.onRefresh()},t.prototype.onRefresh=function(){if(this.buyShopModel=null,Tool.isNumber(this.thingmodel.id)){var e;for(var t in JsonModelManager.instance.getModelshop()){var n=JsonModelManager.instance.getModelshop()[t];if(e=GameCommon.parseAwardItem(n.item),e.id==this.thingmodel.id&&e.type==this.thingmodel.type&&n.shopType==SHOP_TYPE.DAOJU){this.buyShopModel=n,this.buyPrice=GameCommon.getInstance().onParseAwardItemstr(n.price);break}}}this.goods_item.onUpdate(this.thingmodel.type,this.thingmodel.id,0,this.thingmodel.quality);var a=DataManager.getInstance().bagManager.getGoodsThingById(this.thingmodel.id);a?a.num:0;if(this.buyShopModel){this.currentState="buy",this.setTitle("快速购买");var i=GameCommon.getInstance().getThingModel(this.buyPrice[0].type,null);this.total_money_icon.source=i.dropicon,this.has_money_icon.source=i.dropicon;var o=new BatchParam;o.maxNum=Math.max(1,Math.floor(DataManager.getInstance().playerManager.player.getICurrency(this.buyPrice[0].type)/this.buyPrice[0].num)),this.batch_bar.onUpdate(o),this.onBatchUpdateHandler(),this.onupdateHasMoney()}else this.setTitle("获取途径"),this.currentState="get";this.onUpdateTujing()},t.prototype.onGetBtn=function(e){this.onRefresh()},t.prototype.onUpdateTujing=function(){this.tujingbtn_group.removeChildren();for(var e=0;e<this.thingmodel.tujing.length;e++){var t=this.thingmodel.tujing[e];if(!(0>=t)){if(this.tujingBtns.length==e){var n=new FastGetItem;this.tujingBtns.push(n)}var a=this.tujingBtns[e];a.data=t,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoItem,this),a.scaleX=.8,a.scaleY=.8,this.tujingbtn_group.addChild(a)}}this.tujingbtn_group.numChildren>0?this.label_attention.visible=!1:this.label_attention.visible=!0},t.prototype.onBuyItem=function(e){var t=this.batch_bar.count,n=this.buyPrice[0].num*t,a=DataManager.getInstance().playerManager.player.getICurrency(this.buyPrice[0].type);if(n>a)return void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel");var i=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);i.setByte(this.buyShopModel.shopType),i.setInt(this.buyShopModel.id),i.setInt(t),GameCommon.getInstance().sendMsgToServer(i),this.onHide()},t.prototype.onBatchUpdateHandler=function(){this.buyShopModel&&(this.totalmoney_num_label.text=this.batch_bar.count*this.buyPrice[0].num+"")},t.prototype.onupdateHasMoney=function(){this.buyShopModel&&(this.hasmoney_num_label.text=DataManager.getInstance().playerManager.player.getICurrency(this.buyPrice[0].type)+"")},t.prototype.onTouchGotoItem=function(e){var t=e.currentTarget;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t.gotype),this.onHide()},t}(BaseWindowPanel);__reflect(FastBuyPanel.prototype,"FastBuyPanel");var StrongerButton=function(e){function t(){var t=e.call(this)||this;return t.gotype=0,t.skinName=skins.Bianqiang_ButtonSkin,t}return __extends(t,e),t.prototype.registGotype=function(e){this.gotype=e,this.buttonIcon.source=this.model.icon,this.addGotypeEventListener()},t.prototype.onCheackLvLimit=function(){this.unopen_group.visible=!1,FunDefine.isFunOpen(this.gotype)||(this.unopen_group.visible=!0,this.model.days>0?this.level_limit_label.text="第"+this.model.days+"天开启":this.model.jingjie>0?this.level_limit_label.text=this.model.jingjie+"阶开启":this.level_limit_label.text=this.model.level+"级开启")},Object.defineProperty(t.prototype,"model",{get:function(){return JsonModelManager.instance.getModelfunctionLv()[this.gotype]},enumerable:!0,configurable:!0}),t.prototype.addGotypeEventListener=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)},t.prototype.removeGotypeEventListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)},t.prototype.onTouchBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.gotype)},t}(eui.Button);__reflect(StrongerButton.prototype,"StrongerButton");var FastGetItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.FastGetItemSkin},t.prototype.dataChanged=function(){var e=JsonModelManager.instance.getModelfunctionLv()[this.gotype];e&&(this.goBtn.label=e.desc)},Object.defineProperty(t.prototype,"gotype",{get:function(){return this._data},enumerable:!0,configurable:!0}),t}(BaseComp);__reflect(FastGetItem.prototype,"FastGetItem");var FuncTipsBar=function(e){function t(){var t=e.call(this)||this;return t.closeTimeCount=0,t.tipsBg=new eui.Image,t.tipsBg.source="prompt_bg3_png",t.tipsBg.scaleX=-1,t.tipsBg.scale9Grid=new egret.Rectangle(64,18,55,53),t.tipsBg.width=235,t.tipsBg.height=90,t.tipsBg.x=235,t.tipsBg.y=0,t.addChild(t.tipsBg),t.tipsDescLabel=new eui.Label,t.tipsDescLabel.x=10,t.tipsDescLabel.y=10,t.tipsDescLabel.width=220,t.tipsDescLabel.height=78,t.tipsDescLabel.lineSpacing=6,t.tipsDescLabel.textAlign=egret.HorizontalAlign.LEFT,t.tipsDescLabel.horizontalCenter=egret.VerticalAlign.MIDDLE,t.tipsDescLabel.size=22,t.tipsDescLabel.fontFamily="SimHei",t.tipsDescLabel.textColor=15326899,t.addChild(t.tipsDescLabel),t}return __extends(t,e),t.prototype.onShow=function(e){this.param=e,e.parentTarget&&(this.refreshPosition(),this.parent||(e.parentTarget.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.tipsDescLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)),this.showOrHideDesc(""!=e.desc),e.desc&&(this.tipsDescLabel.text=e.desc),this.closeTimeCount=e.autoClose,this.closeTimeCount>0?Tool.addTimer(this.onCloseTimeDown,this,1e3):Tool.removeTimer(this.onCloseTimeDown,this,1e3))},t.prototype.refreshPosition=function(){if(this.param&&this.parent)try{var e=this.param.parentTarget.localToGlobal();if(!this.param.parentTarget.parent||0==e.x&&0==e.y)return void Tool.callbackTime(this.refreshPosition,this,1e3);this.x=e.x+this.param.offX,this.y=e.y+this.param.offY}catch(t){this.onHide()}},t.prototype.onCloseTimeDown=function(){return this.closeTimeCount<=0?void this.onHide():void this.closeTimeCount--},t.prototype.onHide=function(){this.parent&&this.parent.removeChild(this),this.param&&(this.tipsDescLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.param.parentTarget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.closeTimeCount=0,Tool.removeTimer(this.onCloseTimeDown,this,1e3),this.param=null)},t.prototype.onTouch=function(){this.param&&this.param.parentTarget.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))},t.prototype.showOrHideDesc=function(e){this.tipsBg.visible=e,this.tipsDescLabel.visible=e},t}(egret.DisplayObjectContainer);__reflect(FuncTipsBar.prototype,"FuncTipsBar");var FuncTipsObj=function(){function e(e,t){this.desc="",this.autoClose=0,this.type=e,this.desc=t}return e}();__reflect(FuncTipsObj.prototype,"FuncTipsObj");var FUNCTIP_TYPE;!function(e){e[e.BOSS_REMIND=1]="BOSS_REMIND",e[e.BAGFULL=2]="BAGFULL"}(FUNCTIP_TYPE||(FUNCTIP_TYPE={}));var ObtainHintEquip=function(e){function t(){var t=e.call(this)||this;return t.autoCloseTime=-1,t}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.ObtainHintSkin},t.prototype.onInit=function(){this.currentState="equip"},t.prototype.dataChanged=function(){this.equipLayer.removeChildren();var e=new GoodsInstance;e.onUpdate(GOODS_TYPE.MASTER_EQUIP,this._data.thing.modelId,this._data.thing.equipId,this._data.thing.quality),this.equipLayer.addChild(e)},t.prototype.onTouchBtnSend=function(){for(var e=0;e<DataManager.getInstance().playerManager.player.playerDatas.length;e++)this.sendClothEquipMsg(DataManager.getInstance().playerManager.player.playerDatas[e]);this.onDestory()},t.prototype.sendClothEquipMsg=function(e){DataManager.getInstance().bagManager.onClothEquipAll()},t.prototype.onRegist=function(){this.btn_use.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDestory,this),this.hint_grp.y=size.height+500,egret.Tween.get(this.hint_grp).to({y:size.height-330},500,egret.Ease.sineOut).call(function(){egret.Tween.removeTweens(this.hint_grp)},this),"equip"==this.currentState?this.autoCloseTime=6:this.autoCloseTime=-1,this.autoCloseTime>0&&Tool.addTimer(this.autoTimerHanlder,this,1e3)},t.prototype.autoTimerHanlder=function(){0==this.autoCloseTime?this.onTouchBtnSend():(this.autoCloseTime--,this.btn_use.label=Language.instance.getText("equip")+("("+this.autoCloseTime+"S)"))},t.prototype.onRemove=function(){this.btn_use.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDestory,this),Tool.removeTimer(this.autoTimerHanlder,this,1e3)},t}(BaseComp);__reflect(ObtainHintEquip.prototype,"ObtainHintEquip");var ObtainHintSys=function(e){function t(t){var n=e.call(this,t)||this;return n.panelID=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onRefresh=function(){this.checkBtn_cd.selected=!1,this.panelID=this.param.panelID,this.thing=this.param.thing,this.currentState="item",this.showItem()},t.prototype.showItem=function(){switch(this.panelID){case 13:this.img_sys.source="zhanqi_png",this.label_guide.text="坐骑可以进阶了，快去试试吧";break;case 14:this.img_sys.source="shenbing_png",this.label_guide.text="神兵可以进阶了，快去试试吧";break;case 15:this.img_sys.source="shenzhuang_png",this.label_guide.text="神装可以进阶了，快去试试吧";break;case 16:this.img_sys.source="xianyu_png",this.label_guide.text="仙羽可以进阶了，快去试试吧";break;case 17:this.img_sys.source="fabao_png",this.label_guide.text="法宝可以进阶了，快去试试吧"}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchBtnSend=function(){this.checkBtn_cd.selected&&DataManager.getInstance().hintManager.shieldObtainHint(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.panelID),this.onHide()},t.prototype.onHide=function(){e.prototype.onHide.call(this),this.checkBtn_cd.selected&&DataManager.getInstance().hintManager.shieldObtainHint()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_use.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_use.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t}(BaseWindowPanel);__reflect(ObtainHintSys.prototype,"ObtainHintSys");var ObtainHintParam=function(){function e(e,t,n){void 0===n&&(n=0),this.panelID=0,this.type=e,this.panelID=n,this.thing=t}return e}();__reflect(ObtainHintParam.prototype,"ObtainHintParam");var HINT_TIPS_TYPE;!function(e){e[e.EQUIP=0]="EQUIP"}(HINT_TIPS_TYPE||(HINT_TIPS_TYPE={}));var ObtainHintUseGoods=function(e){function t(t){var n=e.call(this,t)||this;return n.panelID=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onRefresh=function(){this.checkBtn_cd.selected=!1,this.panelID=this.param.panelID,this.thing=this.param.thing,this.currentState="box",this.setNum(this.max()),this.showBox()},t.prototype.showBox=function(){var e=GameCommon.getInstance().getThingModel(this.thing.type,this.thing.modelId);this.goodsLayer.removeChildren();var t=new GoodsInstance;t.onUpdate(this.thing.type,this.thing.modelId,0),t.name_label.visible=!1,t.scaleX=t.scaleY=.9,this.goodsLayer.addChild(t),this.label_name.textFlow=new Array({text:e.name,style:{textColor:GameCommon.getInstance().CreateNameColer[e.quality]}})},t.prototype.onTouchAdd=function(){this.num+=1,this.num>this.max()&&(this.num=this.max()),this.setNum(this.num)},t.prototype.onTouchReduce=function(){this.num-=1,0==this.num&&(this.num=1),this.setNum(this.num)},t.prototype.setNum=function(e){this.num=e,this.label_num.text=e.toString()},t.prototype.max=function(){return Math.max(1,this.thing.num)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onInputChage=function(e){var t=e.target,n=Tool.isNumber(parseInt(t.text))?parseInt(t.text):1;n>this.max()?(this.num=this.max(),this.setNum(this.num)):this.setNum(n)},t.prototype.onTouchBtnSend=function(){var e=new Message(MESSAGE_ID.GOODS_LIST_USE_MESSAGE);e.setByte(this.thing.type),e.setShort(this.thing.modelId),e.setInt(this.num),GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.label_num.addEventListener(egret.Event.CHANGE,this.onInputChage,this),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdd,this),this.btnReduce.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReduce,this),this.btn_use.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.label_num.removeEventListener(egret.Event.CHANGE,this.onInputChage,this),this.btnAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdd,this),this.btnReduce.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReduce,this),this.btn_use.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this)},t}(BaseWindowPanel);__reflect(ObtainHintUseGoods.prototype,"ObtainHintUseGoods");var RareEquip=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.RareEquipSkin},t.prototype.onInit=function(){},t.prototype.dataChanged=function(){if(this._data){this.goods.onUpdate(this._data.type,this._data.id,0,this._data.quality);var e=new Array;e.push({text:"恭喜获得"+GameDefine.EQUIP_QUALITE_NAME[this._data.quality]+"装备-",style:{textColor:16756257}}),e.push({text:this._data.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._data.quality)}}),this.label_desc.textFlow=e}},t}(BaseComp);__reflect(RareEquip.prototype,"RareEquip");var LocalArenaFirstAwdPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaFirstAwdSkin},t.prototype.onInit=function(){this.setTitle("首次奖励"),this.scroller.verticalScrollBar.autoVisibility=!1,this.scroller.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=LocalArenaFirstAwdItem,this.itemlist.itemRendererSkinName=skins.LocalArenaFirstAwdItemSkin,this.itemlist.useVirtualLayout=!0,this.scroller.viewport=this.itemlist,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){for(var e=DataManager.getInstance().localArenaManager.localArenaData,t=[],n=0,a=JsonModelManager.instance.getModelarenaReward(),i=ModelManager.getInstance().getModelLength("arenaReward"),o=0;i>o;o++){var r=a[o];e.bestRank>r.rank?t.splice(n,0,r):e.rankReward>0&&e.rankReward<=r.rank?t.push(r):(n++,t.unshift(r))}this.itemlist.dataProvider=new eui.ArrayCollection(t),n>0?(this.reward_all_btn.label="一键领取",this.reward_all_btn.enabled=!0):(1==e.rankReward?this.reward_all_btn.label="全部达成":this.reward_all_btn.label="未达成",this.reward_all_btn.enabled=!1),this.best_rank_lab.text="历史最高排名:"+e.bestRank+"名"},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_FIRST_AWARD_MESSAGE.toString(),this.onRefresh,this),this.reward_all_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_FIRST_AWARD_MESSAGE.toString(),this.onRefresh,this),this.reward_all_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onReward=function(){var e=new Message(MESSAGE_ID.ARENE_FIRST_AWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(LocalArenaFirstAwdPanel.prototype,"LocalArenaFirstAwdPanel");var LocalArenaFirstAwdItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data,t=DataManager.getInstance().localArenaManager.localArenaData;switch(!t.bestRank||t.bestRank>e.rank?this.currentState="unlock":t.rankReward>0&&t.rankReward<=e.rank?this.currentState="complete":this.currentState="reward",e.rank){case 1:case 2:case 3:this.rankicon_img.source="rankbg_"+e.rank+"_png";break;default:this.rankicon_img.source="rankbg_4_png"}this.rank_num_lab.text=e.rank+"";var n=e.rewards[0];this.goodsitem.updateByAward(n)},t}(BaseListItem);__reflect(LocalArenaFirstAwdItem.prototype,"LocalArenaFirstAwdItem");var LocalArenaHistoryPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaHistroySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.histroy_scroll.verticalScrollBar.autoVisibility=!1,this.histroy_scroll.verticalScrollBar.visible=!1,this.histroy_List.percentWidth=554,this.histroy_List.percentHeight=65,this.histroy_List.itemRenderer=ArenaHistroyItem,this.histroy_List.itemRendererSkinName=skins.AraneHistroyItemSkin,this.histroy_List.useVirtualLayout=!0,this.histroy_scroll.viewport=this.histroy_List,this.setTitle("历史战绩"),this.onRefresh()},t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResArenaRankMsg=function(e){for(var t=[],n=e.message,a=n.getByte(),i=0;a>i;i++){var o=new ArenaHistoryData;o.index=i,o.parseMsg(n),t.push(o)}this.histroy_List.dataProvider=new eui.ArrayCollection(t)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE.toString(),this.onResArenaRankMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE.toString(),this.onResArenaRankMsg,this)},t}(BaseWindowPanel);__reflect(LocalArenaHistoryPanel.prototype,"LocalArenaHistoryPanel");var LocalArenaPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.get_num_label);for(var t=0;t<GameDefine.Local_Arena_Enemy_Max;t++){this["arena_fightItem"+t]}this.saoDang_btn.visible=DataManager.getInstance().playerManager.player.level>=100,this.points=RedPointManager.createPoint(1),this.points[0].register(this.first_awd_btn,GameDefine.RED_FASHION_ITEM_POS,DataManager.getInstance().localArenaManager,"getRedArenaFirstAwd"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.get_num_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGetArenaNum,this),this.arena_rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenArenaRankPanel,this),this.arena_shop_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAraneShop,this),this.refresh_list_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendRefreshEnemyListMsg,this),this.arena_history_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openArenaHistroyPanel,this),this.saoDang_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnSaoDang,this),this.first_awd_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openFirstAwardPanel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_INFO_UPDATE_MESSAGE.toString(),this.onResArenaInfoUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_BUY_FIGHTCOUNT_MESSAGE.toString(),this.onUpdateSweepRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_REFRESH_ENEMYLIST_MESSAGE.toString(),this.onUpdateEmenyList,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENA_BATTLE_SWEEP.toString(),this.onUpdateSweepRefresh,this);for(var t=0;t<GameDefine.Local_Arena_Enemy_Max;t++){var n=this["arena_fightItem"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchArenaItem,this)}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.get_num_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGetArenaNum,this),this.arena_rank_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenArenaRankPanel,this),this.refresh_list_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendRefreshEnemyListMsg,this),this.arena_shop_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAraneShop,this),this.arena_history_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openArenaHistroyPanel,this),this.saoDang_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnSaoDang,this),this.first_awd_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openFirstAwardPanel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_INFO_UPDATE_MESSAGE.toString(),this.onResArenaInfoUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_BUY_FIGHTCOUNT_MESSAGE.toString(),this.onUpdateSweepRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_REFRESH_ENEMYLIST_MESSAGE.toString(),this.onUpdateEmenyList,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENA_BATTLE_SWEEP.toString(),this.onUpdateSweepRefresh,this);for(var t=0;t<GameDefine.Local_Arena_Enemy_Max;t++){var n=this["arena_fightItem"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchArenaItem,this)}},t.prototype.onRefresh=function(){this.onSendArenaInfo()},t.prototype.onSendArenaInfo=function(){DataManager.getInstance().arenaManager.onSendLocalArenaInfoMsg()},t.prototype.onResArenaInfoUpdateMsg=function(){var e=DataManager.getInstance().localArenaManager.localArenaData;e.rank>0?(this.self_rank_num_label.text=e.rank+"",this.not_rank_lab.visible=!1):(this.self_rank_num_label.text="",this.not_rank_lab.visible=!0);for(var t=DataManager.getInstance().localArenaManager.getRankAwards(e.rank),n=0;2>n;n++){var a=t[n],i=GameCommon.getInstance().getThingModel(a.type,a.id);this["rank_reward_icon"+n].source=i.dropicon,this["rank_reward_label"+n].text=a.num+""}this.onUpdateArenaCount(),this.onUpdateEmenyList()},t.prototype.onUpdateEmenyList=function(){for(var e=0;e<GameDefine.Local_Arena_Enemy_Max;e++){var t=DataManager.getInstance().localArenaManager.localArenaData.enemyList[e],n=this["arena_fightItem"+e];t?n.data=t:n.data=null}},t.prototype.onTouchArenaItem=function(e){var t=e.currentTarget;if(t.data){var n=[{text:"是否对玩家",style:{}},{text:t.data.playerData.name,style:{textColor:2680872}},{text:"发起挑战？",style:{}}];
GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertEscort",new AlertEscortParam(n,this.onSendArenaFightMsg,this,t.data)))}},t.prototype.onSendArenaFightMsg=function(e){GameFight.getInstance().onSendLocalArenaFightMsg(e.rank)},t.prototype.onUpdateSweepRefresh=function(){this.onUpdateArenaCount()},t.prototype.onUpdateArenaCount=function(){var e=DataManager.getInstance().localArenaManager.localArenaData;this.left_fightnum_lab.text=e.fightCount+"",this.total_fightnum_lab.text=Constant.get("ARENA_FREE_TIMES")},t.prototype.onBtnSaoDang=function(){var e=DataManager.getInstance().localArenaManager.localArenaData;if(e.fightCount<=0)return void GameCommon.getInstance().addAlert("error_tips_6");var t=[{text:"使用扫荡功能可快速消耗当前拥有的次数，获得竞技点奖励"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,this.onSaoDangConfirm,this)))},t.prototype.onSaoDangConfirm=function(){var e=new Message(MESSAGE_ID.ARENA_BATTLE_SWEEP);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onTouchGetArenaNum=function(){var e=DataManager.getInstance().localArenaManager.localArenaData,t=Constant.get(Constant.ARENA_FIGHT_BUY_PRICE).split(","),n=parseInt(e.buyCount<t.length?t[e.buyCount]:t[t.length]),a=[{text:"是否消耗"+n+"钻石购买一次挑战次数？",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(a,function(e){if(DataManager.getInstance().playerManager.player.gold<e)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var t=new Message(MESSAGE_ID.ARENE_BUY_FIGHTCOUNT_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)},this,n)))},t.prototype.onSendRefreshEnemyListMsg=function(){var e=new Message(MESSAGE_ID.ARENE_REFRESH_ENEMYLIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onOpenArenaRankPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LocalArenaRankPanel")},t.prototype.onOpenAraneShop=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PvPShopPanel")},t.prototype.openArenaHistroyPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LocalArenaHistoryPanel")},t.prototype.openFirstAwardPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LocalArenaFirstAwdPanel")},t}(BaseTabView);__reflect(LocalArenaPanel.prototype,"LocalArenaPanel");var LocalArenaMatchItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.LocalArenaMatchItemSkin},t.prototype.onInit=function(){this.onDefault()},t.prototype.dataChanged=function(){this.data?this.onUpdate():this.onDefault()},t.prototype.onUpdate=function(){var e=this.data.showAppear;this.roleAppear?this.roleAppear.visible=!0:(this.roleAppear=new RoleAppearBody,this.role_group.addChild(this.roleAppear));for(var t=[],n=0;n<BLESS_TYPE.SIZE;n++)t[n]=e.appears[n];this.roleAppear.updateAvatarAnim(t,e.sex),this.name_label.text=this.data.playerData.name,this.power_label.text=this.data.playerData.fightvalue+"",this.rank_label.text="第 "+this.data.rank+" 名",this.data.rank>3?this.rank_bg.source="arena_rank_3_png":this.rank_bg.source="arena_rank_"+this.data.rank+"_png"},t.prototype.onDefault=function(){this.rank_label.text="",this.name_label.text="虚席以待",this.power_label.text="",this.roleAppear&&(this.roleAppear.visible=!1)},t}(BaseComp);__reflect(LocalArenaMatchItem.prototype,"LocalArenaMatchItem");var LocalArenaRankPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaRankPanelSkin},t.prototype.onInit=function(){this.setTitle("榜单"),this.rank_scroll.verticalScrollBar.autoVisibility=!0,this.rank_scroll.verticalScrollBar.visible=!0,this.arena_rankList.itemRenderer=LocalAraneRankItem,this.arena_rankList.itemRendererSkinName=skins.AraneRankItemSkin,this.arena_rankList.useVirtualLayout=!0,this.rank_scroll.viewport=this.arena_rankList,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.ARENE_RANK_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResArenaRankMsg=function(e){for(var t=[],n=e.message,a=n.getByte(),i=0;a>i;i++){var o=new LocalArenaRankData;o.rank=i+1,o.parseMsg(n),t.push(o)}this.arena_rankList.dataProvider=new eui.ArrayCollection(t);var r=DataManager.getInstance().localArenaManager.localArenaData;r.rank>0?(this.label_myrank.text=r.rank+"",this.not_rank_lab.visible=!1):(this.label_myrank.text="",this.not_rank_lab.visible=!0)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_RANK_UPDATE_MESSAGE.toString(),this.onResArenaRankMsg,this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_RANK_UPDATE_MESSAGE.toString(),this.onResArenaRankMsg,this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(LocalArenaRankPanel.prototype,"LocalArenaRankPanel");var LocalAraneRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.bg_img.source=e.rank%2==0?"public_di1_png":"public_di5_png",this.rank_num_label.text=e.rank+"",this.rank_name_label.text=e.playerData.name;for(var t in JsonModelManager.instance.getModelarenaRankReward()){var n=JsonModelManager.instance.getModelarenaRankReward()[t];if(e.rank>=n.lowRank&&e.rank<=n.highRank){var a=GameCommon.parseAwardItem(n.rate),i=GameCommon.getInstance().getThingModel(a.type,0);this.reward_label.text=i.name+"*"+a.num;break}}},t}(eui.ItemRenderer);__reflect(LocalAraneRankItem.prototype,"LocalAraneRankItem");var LocalArenaWinPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaWinPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(t){this.param=t,this.param&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this);var t=(this.param.oldRank,this.param.newRank);this.itemAwards=this.param.award,this.itemAwards&&this.onPlayAwardAnim(),this.new_rank_label.text=t+"",this._showleftTime=11,this.onCloseTimedown(),Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label="确定("+this._showleftTime+")")},t.prototype.onPlayAwardAnim=function(){this.award_groud.removeChildren();for(var e=0;e<this.itemAwards.length;e++){var t=this.itemAwards[e],n=new GoodsInstance;this.award_groud.addChild(n),n.onUpdate(t.type,t.id,0,t.quality,t.num)}},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t}(BaseWindowPanel);__reflect(LocalArenaWinPanel.prototype,"LocalArenaWinPanel");var AttributeItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.AttributeItemSkin},t.prototype.dataChanged=function(){var e=this._data;return GameDefine.Attr_FontName[e[0]]?(this.attrname_label.text=GameDefine.Attr_FontName[e[0]]+":",this.label_basis.text=e[1],void(e[2]?(this.label_add.visible=!0,this.label_add.text=e[2]):this.label_add.visible=!1)):(this.attrname_label.text=e[0],this.label_basis.text=e[1],void(this.label_add.text=""))},t}(BaseComp);__reflect(AttributeItem.prototype,"AttributeItem");var BagPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.EquipTab="tabBtn_equip",n.ServantEquipTab="tabBtn_servant",n.ItemTab="tabBtn_item",n.BoxTab="tabBtn_box",n.GemTab="tabBtn_gem",n.BagColNum=5,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="BagTypePanel",n.funcID=FUN_TYPE.FUN_EQUIPBAG,n.btnRes="装备",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().bagManager,"getEquipSmeltPointShow"),t.push(n),n=new RegisterSystemParam,n.sysName="BagTypePanel",n.funcID=FUN_TYPE.FUN_ITEMBAG,n.btnRes="物品",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().bagManager,"getItemCanUsePointShow"),t.push(n),this.setTitle("背包"),this.registerPage(t,"bagGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseSystemPanel);__reflect(BagPanel.prototype,"BagPanel");var BagTypePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BagPanelSkins},t.prototype.onInit=function(){this.bag_Scroller.verticalScrollBar.autoVisibility=!0,this.bag_Scroller.verticalScrollBar.visible=!0,this.itemGroup.itemRenderer=BagItemRenderer,this.itemGroup.itemRendererSkinName=skins.BagItemRendererSkin,this.itemGroup.useVirtualLayout=!0,this.bag_Scroller.viewport=this.itemGroup,GameCommon.getInstance().addUnderlineGet(this.get_label),this.points[0].register(this.btn_ronglian,new egret.Point(100,-10),DataManager.getInstance().bagManager,"getEquipSmeltPointShow"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onchangeTabIndex(this.owner.index)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE,this.onMsgUpdate,this),this.btn_ronglian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenSmeltView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UPDATE_BAG_UPPERLIMIT.toString(),this.onUpperlimit,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE,this.onMsgUpdate,this),this.btn_ronglian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenSmeltView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UPDATE_BAG_UPPERLIMIT.toString(),this.onUpperlimit,this),this.itemGroup.dataProvider=null},t.prototype.onMsgUpdate=function(e){this.onchangeTabIndex(this.owner.index)},t.prototype.onUpperlimit=function(){this.maxNum.text=DataManager.getInstance().bagManager.equipMax+""},t.prototype.onOpenSmeltView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SmeltPanel")},t.prototype.onchangeTabIndex=function(e){var n=DataManager.getInstance().bagManager;for(2==e?this.itemDatas=n.getAllRunes():this.itemDatas=n.getGoodsListByTypes(t.types[e]),this.itemDatas?this.currNum.text=this.itemDatas.length+"":this.currNum.text="0";this.itemDatas.length<30;)this.itemDatas.push(null);switch(e){case 0:this.capacityGroup.visible=!0,this.maxNum.text=n.equipMax+"";break;case 1:this.capacityGroup.visible=!1;break;case 2:this.capacityGroup.visible=!1}this.onupdateItemData()},t.prototype.onupdateItemData=function(){this.itemGroup.dataProvider=new eui.ArrayCollection(this.itemDatas),this.bag_Scroller.viewport.scrollV=0},t.types=[[GOODS_TYPE.MASTER_EQUIP,GOODS_TYPE.SERVANT_EQUIP],[GOODS_TYPE.ITEM,GOODS_TYPE.BOX],[GOODS_TYPE.RNUES]],t}(BaseTabView);__reflect(BagTypePanel.prototype,"BagTypePanel");var BagItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.onUpdate=function(){if(this.data)if(this.goods.onThing(this.data),this.goods.num_label.bottom=40,this.data.type==GOODS_TYPE.BOX){var e=JsonModelManager.instance.getModelbox()[this.data.modelId];e&&2!=e.type?(this.point||(this.point=new redPoint),this.point.register(this,GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().bagManager,"getItemCanUsePointShowByUID",this.data.modelId)):this.point&&(this.point.point.visible=!1)}else this.point&&(this.point.point.visible=!1);else this.goods.onReset()},t}(BaseListItem);__reflect(BagItemRenderer.prototype,"BagItemRenderer");var PlayerMessageBar=function(e){function t(t){var n=e.call(this)||this;return n.channel=t,n.onInit(),n}return __extends(t,e),t.prototype.onInit=function(){this.touchEnabled=!1,this.touchChildren=!1;var e=new eui.UILayer;e.touchEnabled=!1,this.addChild(e);var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,630,35),t.graphics.endFill(),this.messageGroup=new eui.Group,this.messageScroller=new eui.Scroller,this.messageScroller.width=630,this.messageScroller.height=35,this.messageScroller.x=0,this.messageScroller.y=0,this.messageScroller.touchEnabled=!1,this.messageScroller.viewport=this.messageGroup,e.addChild(t),e.addChild(this.messageScroller)},t.prototype.onshowMessage=function(){if(!this.isPlaying){var e=DataManager.getInstance().broadcastManager.getMessageArray(this.channel);if(e.length>0){this.messageGroup.removeChildren();var t=e.shift();if(""!=t.str){var n=this.onCreateLabel(t.str);n.y=5,this.messageGroup.addChild(n),this.messageScroller.viewport.scrollH=-this.messageScroller.width-50,this._targetPosX=n.textWidth}else this.onshowMessage()}else this.onDestroy()}},t.prototype.onMessageMove=function(){this.isPlaying?(this.messageScroller.viewport.scrollH+=2,this.messageScroller.viewport.scrollH>=this._targetPosX&&(this._targetPosX=null,this.onshowMessage())):this.onshowMessage()},Object.defineProperty(t.prototype,"isPlaying",{get:function(){return Tool.isNumber(this._targetPosX)},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(){this.parent&&this.parent.removeChild(this),this._targetPosX=null},t.prototype.onCreateLabel=function(e){var t=new eui.Label;return t.size=24,t.fontFamily=GameCommon.getFontFamily(),t.textFlow=(new egret.HtmlTextParser).parser(e),t.stroke=0,t},t}(egret.DisplayObjectContainer);__reflect(PlayerMessageBar.prototype,"PlayerMessageBar");var SystemMessageBar=function(e){function t(t){var n=e.call(this)||this;return n.y=0,n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.channel=t,n}return __extends(t,e),t.prototype.onAddToStage=function(e){this.isInit=!0,this.touchEnabled=!1,this.touchChildren=!1;var t=new eui.UILayer;t.touchEnabled=!1,this.addChild(t),this.messageGroup=new eui.Group,this.messageScroller=new eui.Scroller,this.messageScroller.width=560,this.messageScroller.height=30,this.messageScroller.x=70,this.messageScroller.y=6,this.messageScroller.touchEnabled=!1,this.messageScroller.viewport=this.messageGroup,t.addChild(this.messageScroller),DataManager.getInstance().broadcastManager.getMessageArray.length>0&&this.onMessageMove()},t.prototype.onMessageMove=function(){if(this.isInit&&!this._isPlaying){this._isPlaying=!0;var e=DataManager.getInstance().broadcastManager.getMessageArray(this.channel);if(e.length>0){this.messageGroup.removeChildren();var t=e.shift();if(""!=t.str){var n=this.onCreateLabel(t.str);this.messageGroup.addChild(n),this.messageScroller.viewport.scrollH=-this.messageScroller.width-50;var a=egret.Tween.get(this.messageScroller.viewport);a.to({scrollH:n.textWidth},2e4),a.call(function(){this._isPlaying=!1,egret.Tween.removeTweens(this.messageScroller.viewport),a=null,this.onMessageMove()},this)}else this.onMessageMove()}else this.onDestroy()}},t.prototype.onDestroy=function(){this.parent&&(this.removeChildren(),this.parent.removeChild(this),egret.Tween.removeTweens(this.messageScroller.viewport))},t.prototype.onCreateLabel=function(e){var t=new eui.Label;return t.size=22,t.bold=!0,t.fontFamily=GameCommon.getFontFamily(),t.textFlow=(new egret.HtmlTextParser).parser(e),t},t}(egret.DisplayObjectContainer);__reflect(SystemMessageBar.prototype,"SystemMessageBar");var ChatChannelCD=function(){function e(e,t){this.isCanDo=!0,this.reset(e,t)}return e.prototype.reset=function(e,t){this.id=e,this.cd=t},e.prototype.setCanDo=function(e){this.isCanDo=e},e.prototype.onRun=function(e){this.isCanDo=!0},e.prototype.getCanDo=function(e){void 0===e&&(e=null);var t=this.isCanDo;return this.isCanDo&&(this.isCanDo=!1,setTimeout(this.onRun.bind(this),this.cd,e)),t},e}();__reflect(ChatChannelCD.prototype,"ChatChannelCD");var ChatMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=0,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="ChatPanel",n.btnRes="世界",t.push(n),n=new RegisterSystemParam,n.sysName="ChatPanel",n.btnRes="仙盟",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().chatManager,"onCheckChatRedPointByType",CHANNEL.GUILD),t.push(n),n=new RegisterSystemParam,n.sysName="ChatPanel",n.btnRes="系统",t.push(n),n=new RegisterSystemParam,n.sysName="ChatPanel",n.btnRes="跨服",t.push(n),this.registerPage(t,"chatGrp",GameDefine.RED_TAB_POS),this.setTitle("聊 天"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.index=0},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onShowWithParam=function(e){this.index=e.channel,this.currParam=e,this.onShow()},t.openQueue=[CHANNEL.CURRENT,CHANNEL.GUILD,CHANNEL.SYS,CHANNEL.ALLSERVER],t}(BaseSystemPanel);__reflect(ChatMainPanel.prototype,"ChatMainPanel");var ChatPanelParam=function(){function e(e,t){this.content="",this.channel=e,this.player=t}return e}();__reflect(ChatPanelParam.prototype,"ChatPanelParam");var ChatPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isInCD=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChatPanelSkin},t.prototype.onInit=function(){this.bubbleLayer.itemRenderer=ChatBubble,this.bubbleLayer.itemRendererSkinName=skins.ChatBubbleSkin,this.bar.viewport=this.bubbleLayer,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.refreshChatList=function(){var e=DataManager.getInstance().chatManager.chat[ChatMainPanel.openQueue[this.owner.tab]];this.bubbleLayer.dataProvider=new eui.ArrayCollection(e)},t.prototype.onRefresh=function(){var e=this.owner;switch(this.chatwicket.visible=!0,ChatMainPanel.openQueue[this.owner.tab]){case CHANNEL.SYS:this.chatwicket.visible=!1;break;case CHANNEL.WHISPER:e.currParam&&e.currParam.player&&(this.whisper=e.currParam.player)}this.refreshChatList(),setTimeout(this.adjustBar.bind(this),50),e.currParam&&e.currParam.content&&(this.label_input.text=e.currParam.content,e.currParam.content="")},t.prototype.adjustBar=function(){this.bar.stopAnimation(),this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.checkNotBottom=function(){return this.bar.viewport.contentHeight>this.bar.viewport.height&&this.bar.viewport.scrollV<this.bar.viewport.contentHeight-this.bar.viewport.height-50?!0:!1},t.prototype.updateInfo=function(){if(DataManager.getInstance().chatManager.currType==ChatMainPanel.openQueue[this.owner.tab]&&DataManager.getInstance().chatManager.isSucceed){switch(ChatMainPanel.openQueue[this.owner.tab]){case CHANNEL.GUILD:DataManager.getInstance().chatManager.hasNewGuidTalk=!1;break;case CHANNEL.WHISPER:DataManager.getInstance().chatManager.hasNewWhisperTalk=!1}this.refreshChatList(),this.checkNotBottom()||setTimeout(this.adjustBar.bind(this),50)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.updateInfo,this),GameDispatcher.getInstance().addEventListener(GameEvent.SYSTEM_CHAT_BROADCAST,this.onChatBroadcastBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_send.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.updateInfo,this),GameDispatcher.getInstance().removeEventListener(GameEvent.SYSTEM_CHAT_BROADCAST,this.onChatBroadcastBack,this)},t.prototype.onChatBroadcastBack=function(){ChatMainPanel.openQueue[this.owner.tab]==CHANNEL.SYS&&this.updateInfo()},t.prototype.onTouchBtnSend=function(){var e=this.label_input.text;if(this.label_input.text="",""!=e){if(this.getPlayerData().level<100)return void GameCommon.getInstance().addAlert("100级才可发言");if(!DataManager.getInstance().chatManager.cds[ChatMainPanel.openQueue[this.owner.tab]].getCanDo())return void GameCommon.getInstance().addAlert("不能频繁发言");var t=-1;if(ChatMainPanel.openQueue[this.owner.tab]==CHANNEL.WHISPER){if(!this.whisper)return void GameCommon.getInstance().addAlert("清选择私聊对象");t=this.whisper.id}this.sendInfo(e,t)}},t.prototype.sendInfo=function(e,t){void 0===t&&(t=-1);var n=new Message(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE);n.setByte(ChatMainPanel.openQueue[this.owner.tab]),n.setString(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},t}(BaseTabView);__reflect(ChatPanel.prototype,"ChatPanel");var ChatBubble=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.headLayer.touchEnabled=!0,this.headLayer.touchChildren=!0,this.headLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHead,this),this.richTxt.label_content.addEventListener(egret.TextEvent.LINK,this.onTouchRichTextLink,this)},t.prototype.onUpdate=function(){if(this.data&&this.data.player){this.data.type==CHANNEL.WHISPER&&this.data.sendID==DataManager.getInstance().playerManager.player.id?this.currentState="self":this.data.player.id==DataManager.getInstance().playerManager.player.id?this.currentState="self":this.currentState="normal";var e=this.data.player.id;switch(e){case-2:this.vip_group.visible=!1,this.label_info.textFlow=new Array({text:"[系统]",style:{textColor:16756257}}),this.richTxt.textFlow=(new egret.HtmlTextParser).parser(this.data.content),this.playerHead.setHeadSystem();break;case-1:this.vip_group.visible=!1,this.label_info.textFlow=new Array({text:"[公告]",style:{textColor:16711680}}),this.richTxt.textFlow=(new egret.HtmlTextParser).parser(this.data.content),this.playerHead.setHeadSystem();break;default:var t=this.data.player.headindex,n=this.data.player.headFrameIndex||this.data.player.headFrame;this.data.type==CHANNEL.WHISPER&&this.data.sendID==DataManager.getInstance().playerManager.player.id&&(t=DataManager.getInstance().playerManager.player.headIndex,n=DataManager.getInstance().playerManager.player.headFrameIndex),this.playerHead.setHead(t,n);var a=0;if(a=this.data.type==CHANNEL.WHISPER&&this.data.sendID==DataManager.getInstance().playerManager.player.id?DataManager.getInstance().playerManager.player.viplevel:this.data.player.viplevel,this.vip_group.visible=a>0,this.data.param){this.label_info.text="";var i=void 0;i=this.data.time>egret.getTimer()?DataManager.getInstance().chatManager.parseHtmlToTextElement(this.data):DataManager.getInstance().chatManager.parseHtmlToTextElement(this.data,!0),this.richTxt.textFlow=i}else switch(this.richTxt.appendEmojiText(this.data.content,!1),this.data.type){default:this.label_info.textFlow=new Array({text:GameCommon.getInstance().getNickname(this.data.player.name)});break;case CHANNEL.GUILD:this.label_info.textFlow=new Array({text:"["+UnionDefine.Union_Postions[this.data.job]+"]",style:{textColor:13511409}},{text:GameCommon.getInstance().getNickname(this.data.player.name),style:{textColor:2661098}});break;case CHANNEL.WHISPER:this.vip_group.visible=!1,this.data.sendID==DataManager.getInstance().playerManager.player.id?this.label_info.text=DataManager.getInstance().playerManager.player.name:this.label_info.text=this.data.player.name}}}},t.prototype.onTouchHead=function(){this.data.player.id!=DataManager.getInstance().playerManager.player.id&&this.data.type!=CHANNEL.SYS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("FriendFuncPanel",new FriendFuncParam(FRIENDFUNC_FROM.CHAT,this.data.player)))},t.prototype.onTouchRichTextLink=function(e){var t=e.text;t&&ChatDefine.onChatHrefEvent(t)},t}(BaseListItem);__reflect(ChatBubble.prototype,"ChatBubble");var ChatPrivatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChatPrivatePanelSkin},t.prototype.onInit=function(){this.bubbleLayer.itemRenderer=ChatBubble,this.bubbleLayer.itemRendererSkinName=skins.ChatBubbleSkin,this.bubbleLayer.useVirtualLayout=!0,this.bar.viewport=this.bubbleLayer,this.setTitle("私聊"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.refreshChatList=function(){for(var e=DataManager.getInstance().chatManager.chat[CHANNEL.WHISPER],t=[],n=this.getPlayerData().id,a=0;a<e.length;++a)(e[a].sendID==this.whisper.id||e[a].sendID==n)&&t.push(e[a]);this.bubbleLayer.dataProvider=new eui.ArrayCollection(t)},t.prototype.onRefresh=function(){this.chatwicket.visible=!0,this.currParam&&this.currParam.player&&(this.whisper=this.currParam.player),this.refreshChatList(),setTimeout(this.adjustBar.bind(this),50)},t.prototype.adjustBar=function(){this.bar.stopAnimation(),this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.checkNotBottom=function(){return this.bar.viewport.contentHeight>this.bar.viewport.height&&this.bar.viewport.scrollV<this.bar.viewport.contentHeight-this.bar.viewport.height-50?!0:!1},t.prototype.updateInfo=function(){DataManager.getInstance().chatManager.isSucceed&&(this.refreshChatList(),this.checkNotBottom()||setTimeout(this.adjustBar.bind(this),50))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.updateInfo,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_send.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.updateInfo,this)},t.prototype.onShowWithParam=function(e){this.currParam=e,this.onShow()},t.prototype.onTouchBtnSend=function(){var e=this.label_input.text;if(this.label_input.text="",""!=e){if(DataManager.getInstance().playerManager.player.level<30)return void GameCommon.getInstance().addAlert("30级才可发言");if(!DataManager.getInstance().chatManager.cds[CHANNEL.WHISPER].getCanDo())return void GameCommon.getInstance().addAlert("不能频繁发言");var t=-1;if(!this.whisper)return void GameCommon.getInstance().addAlert("清选择私聊对象");t=this.whisper.id,this.sendInfo(e,t)}},t.prototype.sendInfo=function(e,t){void 0===t&&(t=-1);var n=new Message(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE);n.setByte(CHANNEL.WHISPER),n.setString(e),n.setInt(t),GameCommon.getInstance().sendMsgToServer(n)},t}(BaseWindowPanel);__reflect(ChatPrivatePanel.prototype,"ChatPrivatePanel");var Emoji=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t.skinName=skins.EmojiSkin,t}return __extends(t,e),t.prototype.onComplete=function(){},Object.defineProperty(t.prototype,"source",{set:function(e){this.onLoad(e,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anim",{set:function(e){this.onLoad(e,1)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(e,t){this.animLayer.removeChildren();var n;switch(t){case 0:n=new eui.Image,n.source=e;break;case 1:n=new Animation(e)}n.width=n.height=52,this.animLayer.addChild(n)},t}(eui.Component);__reflect(Emoji.prototype,"Emoji");var RichTextField=function(e){function t(){var t=e.call(this)||this;return t.placeholder="Ω",t.htmlPlaceHolder="<font color=0x336699 size=40>Ω</font>",t.faceCodeExRes={"#001":"jingmaidan_png","#002":"ronghunshi_png"},t.once(egret.Event.COMPLETE,t.onComplete,t),t.skinName=skins.RichTextFieldSkin,t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.appendEmojiText=function(e,t){if(void 0===t&&(t=!1),t){var n=DataManager.getInstance().chatManager;this.faceSize=n.getChatWH(this.placeholder,40);var a=this.onCollectFace(e),i=!1;for(var o in this.expressObj){i=!0;break}i&&(this.onCalculate(a),this.addFaces()),this.addTextFlow(a)}else this.label_content.text=e},t.prototype.addFaces=function(){this.animLayer.removeChildren();for(var e,t,n,a=0,i=0,o=Math.round(this.height/this.label_content.size),r=0;o>r;r++)if(e=this.expressPos[r]){for(var s=0;s<e.length;s++)t=this.expressObj[a],this.faceCodeExRes[t]&&(n=new Emoji,n.source=this.faceCodeExRes[t],n.x=e[s],n.y=i,this.animLayer.addChild(n),a++);i+=40}else i+=this.label_content.size},t.prototype.addTextFlow=function(e){var t=/Ω/g;e=e.replace(t,this.htmlPlaceHolder),this.label_content.textFlow=(new egret.HtmlTextParser).parser(e)},t.prototype.onCalculate=function(e){var t,n,a=DataManager.getInstance().chatManager,i=0,o=0,r=e.split("");this.expressPos={};for(var s=0;s<r.length;s++){var h=!1;r[s]==this.placeholder?(h=!0,n=a.getChatWH(r[s],40)):n=a.getChatWH(r[s],this.label_content.size),i+n[0]<=this.width?(t=i,i+=n[0]):(i=n[0],t=0,o++),h&&(this.expressPos[o]||(this.expressPos[o]=[]),this.expressPos[o].push(t))}},t.prototype.onCollectFace=function(e){var t=/#[0-9]{3}/g;this.expressObj={},this.expressObj=e.match(t);var n=e.replace(t,this.placeholder);return n},Object.defineProperty(t.prototype,"textFlow",{set:function(e){this.label_content.textFlow=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(RichTextField.prototype,"RichTextField");var ConsumeBar=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.ConsumeBarSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this._model&&this.setConsumeModel(this._model)},Object.defineProperty(t.prototype,"nameColor",{set:function(e){this.consume_name_label.textColor=e},enumerable:!0,configurable:!0}),t.prototype.setCostByAwardItem=function(e,t){void 0===t&&(t=-1),this.setConsume(e.type,e.id,e.num,t)},t.prototype.setConsume=function(e,t,n,a){switch(void 0===n&&(n=1),void 0===a&&(a=-1),e){case GOODS_TYPE.MASTER_EQUIP:case GOODS_TYPE.SERVANT_EQUIP:case GOODS_TYPE.ITEM:case GOODS_TYPE.BOX:this.setConsumeModel(GameCommon.getInstance().getThingModel(e,t),n,a);break;default:this.setConsumeByCurrency(GameCommon.getInstance().getThingModel(e,t),n)}},t.prototype.setConsumeModel=function(e,t,n){if(void 0===t&&(t=1),void 0===n&&(n=-1),this._model=e,this.isLoaded){var a=DataManager.getInstance().bagManager.getGoodsThingNumById(e.id,e.type);if(-1!=n){var i=DataManager.getInstance().bagManager.getGoodsThingById(n);
i&&(a+=i.num)}this.consume_name_label.text=e.name+":",a>=t?this.consume_num_label.textColor=56614:this.consume_num_label.textColor=15930131,this.consume_num_label.textFlow=(new egret.HtmlTextParser).parser(a+"/"+t)}},t.prototype.setConsumeByCurrency=function(e,t){if(void 0===t&&(t=1),this._model=e,this.isLoaded){var n;this.consume_name_label.text=e.name+":",n=DataManager.getInstance().playerManager.player.getICurrency(e.type),n>=t?this.consume_num_label.textColor=56614:this.consume_num_label.textColor=15930131,this.consume_num_label.textFlow=(new egret.HtmlTextParser).parser(n+"/"+t)}},Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(ConsumeBar.prototype,"ConsumeBar");var ConsumeBar2=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.ConsumeBar2Skin,t}return __extends(t,e),Object.defineProperty(t.prototype,"arr",{set:function(e){e[0]&&("string"==typeof e[0]?this.label_l.text=e[0]:this.label_l.textFlow=e[0]),e[1]&&("string"==typeof e[0]?this.label_r.text=e[1]:this.label_r.textFlow=e[1])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thing",{set:function(e){var t=GameCommon.getInstance().getThingModel(e.type,e.modelId);this.label_l.text="消耗"+t.name;var n=e.num,a=0;switch(e.type){case GOODS_TYPE.ITEM:var i=DataManager.getInstance().bagManager.getGoodsThingById(t.id);a=i?i.num:0;break;default:a=DataManager.getInstance().playerManager.player.getICurrency(e.type)}this.label_r.text=a+"/"+n},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(ConsumeBar2.prototype,"ConsumeBar2");var CurrencyBar=function(e){function t(){var t=e.call(this)||this;return t.label_color="5b5657",t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this._data&&this.onUpdate()},Object.defineProperty(t.prototype,"nameColor",{set:function(e){this.label_color=e+"",this.label_r.textColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){var e=GameCommon.getInstance().getThingModel(this._data.thing.type,this._data.thing.modelId);if(e){this.visible=!0,this.img_icon.source=e.dropicon;var t=0;switch(this._data.thing.type){case GOODS_TYPE.ITEM:var n=DataManager.getInstance().bagManager.getGoodsThingById(e.id);t=n?n.num:0;break;case GOODS_TYPE.GOLD:t=DataManager.getInstance().playerManager.player.getICurrency(this._data.thing.type);break;case GOODS_TYPE.DIAMOND:t=DataManager.getInstance().playerManager.player.getICurrency(this._data.thing.type);break;default:t=DataManager.getInstance().playerManager.player.getICurrency(this._data.thing.type)}if(-1==this._data.thing.num){var a=this._data.type!=GOODS_TYPE.ITEM?GameCommon.getInstance().getFormatNumberShow(t):t+"";this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0x"+this.label_color+">"+a+"</font>")}else switch(this._data.thing.type){case GOODS_TYPE.ITEM:t>=this._data.thing.num?this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0x28e828>"+t+"/"+this._data.thing.num+"</font>"):this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0xe63232>"+t+"/"+this._data.thing.num+"</font>");break;default:var a=GameCommon.getInstance().getFormatNumberShow(this._data.thing.num);this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0x"+this.label_color+">"+a+"</font>")}}if(-1!=this._data.type){var a=this._data.type!=GOODS_TYPE.ITEM?GameCommon.getInstance().getFormatNumberShow(this._data.thing.num):this._data.thing.num+"";this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0xe9deb3>"+a+"</font>")}},t.prototype.setLabel=function(e,t,n,a){var i=GameCommon.getInstance().getThingModel(e,t);i&&(this.visible=!0,this.img_icon.source=i.dropicon,n>=a?this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0x"+this.label_color+">"+n+"/"+a+"</font>"):this.label_r.textFlow=(new egret.HtmlTextParser).parser("<font color=0xe63232>"+n+"/"+a+"</font>"))},t}(eui.Component);__reflect(CurrencyBar.prototype,"CurrencyBar");var CurrencyParam=function(){function e(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=-1),this.title="",this.title=e,this.thing=t,this.usingTitle=n,this.type=a}return e}();__reflect(CurrencyParam.prototype,"CurrencyParam");var DamageRankBar=function(e){function t(){var t=e.call(this)||this;return t._isHide=!1,t.MAX_ITEM_NUM=5,t.skinName=skins.DamageRankBarSkin,t}return __extends(t,e),t.prototype.onRegist=function(){if(this.hidden_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHiddenBtn,this),this.onMinimize(!1),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS){this.desc_lab.text=Language.instance.getText("allpeople_alert_0");for(var e=0;e<this.MAX_ITEM_NUM;e++)this["item"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItemHanlde,this)}},t.prototype.onRemove=function(){this.hidden_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHiddenBtn,this);for(var e=0;e<this.MAX_ITEM_NUM;e++)this["item"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItemHanlde,this);this.parent&&this.parent.removeChild(this)},t.prototype.onUpdate=function(e,t){for(var n=0;n<this.MAX_ITEM_NUM;n++){var a=t[n];this["item"+n].data=a}this.my_damage_lab.text=Language.instance.getText("wodeshuchu","：",e)},t.prototype.onTouchHiddenBtn=function(){this.onMinimize(!this._isHide)},t.prototype.onMinimize=function(e){this._isHide!=e&&(this._isHide=e,this._isHide?this.currentState="minisize":this.currentState="maxsize")},t.prototype.onTouchItemHanlde=function(e){var t=e.currentTarget;"fight"==t.currentState},t}(eui.Component);__reflect(DamageRankBar.prototype,"DamageRankBar");var DamageRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.damageData},set:function(e){if(this.damageData=e,this.damageData){this.player_name_lab.text=e.index+"."+e.playerName;var t=DataManager.getInstance().unionManager.unionInfo?DataManager.getInstance().unionManager.unionInfo.info.id:-1;this.damageData.unionID==t?this.currentState="firend":0==this.damageData.hpPercent?this.currentState="dead":(e.playerId==DataManager.getInstance().playerManager.player.id?this.currentState="self":this.currentState="fight",this.hp_probar.maximum=100,this.hp_probar.value=e.hpPercent)}else this.currentState="defalut"},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(DamageRankItem.prototype,"DamageRankItem");var BossDamageParam=function(){function e(){}return Object.defineProperty(e.prototype,"isFirst",{get:function(){return 1==this.index},enumerable:!0,configurable:!0}),e}();__reflect(BossDamageParam.prototype,"BossDamageParam");var GameLoadingUIByGroup=function(e){function t(){var t=e.call(this)||this;return t.startPro=50,t.endPro=100,t.skinName=skins.GameLoadingBar,t.bar.skinName=skins.GameLoadingProBar,t.bar.slideDuration=0,t.bar.maximum=100,DataManager.IS_PC_Game||(t.width=size.width),t.height=size.height,t.initPard(),t}return __extends(t,e),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.onInputLoadText=function(e){this.loadtext.text=e},t.prototype.onstartLoad=function(e,t,n,a,i,o,r){void 0===a&&(a=null),void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=100),this.groupName=e,this.callback=t,this.thisObject=n,this.imgs=a,this.urlImgs=i,this.imgMax=a?a.length:0,this.imgMax=i?this.imgMax+i.length:this.imgMax,this.imgIdx=0,this.groupSize=0,this.startPro=o,this.endPro=r,this.initPard()},t.prototype.onShow=function(e){DataManager.IS_PC_Game&&(this.x=Globar_Pos.x),e.addChild(this)},t.prototype.initPard=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.loadGroupFinish,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.groupName&&RES.loadGroup(this.groupName)},t.prototype.onResourceProgress=function(e){this.groupSize=e.itemsTotal,this.loadData(e.itemsLoaded+this.imgIdx,this.groupSize+this.imgMax)},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.loadData=function(e,t){var n=Math.round(e/t*Math.max(1,this.endPro-this.startPro));this.bar.value=Math.min(n+this.startPro,100)},t.prototype.loadGroupFinish=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.loadGroupFinish,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.imgs?(this.imgIdx=0,this.loadImgs()):this.loadFinish()},t.prototype.loadImgs=function(){if(this.imgIdx<this.imgs.length){this.loadData(this.groupSize+this.imgIdx,this.groupSize+this.imgMax),this.imgIdx++;var e=this.imgs.shift();RES.hasRes(e)?RES.getResAsync(e,this.loadImgs,this):this.loadImgs()}else if(this.urlImgs&&this.imgIdx<this.imgs.length+this.urlImgs.length){this.loadData(this.groupSize+this.imgIdx,this.groupSize+this.imgMax),this.imgIdx++;var e=this.urlImgs.shift();LoadManager.getInstance().loadModelByName(e,this.loadImgs,this)}else this.loadFinish()},t.prototype.loadFinish=function(){Tool.callback(this.callback,this.thisObject)},t.prototype.close=function(){this.parent&&this.parent.removeChild(this)},t.prototype.playRoleEnter=function(){for(var e=15,t=[];e>t.length;){var n=Math.round(1*Math.random()),a=NameDefine.getRandomPlayerName(!1,n);if(!(t.indexOf(a)>=0)){t.push(a);var i=this.createEnterPlayerLab(a);i.y=20*t.length,this.enter_name_grp.addChild(i)}}this.addEventListener(egret.Event.ENTER_FRAME,this.onTimeDown,this)},t.prototype.destoryPlayerEnter=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onTimeDown,this),this.enter_name_grp.removeChildren()},t.prototype.createEnterPlayerLab=function(e){var t=GameCommon.getInstance().createNormalLabel(18,1644825,0,0,egret.HorizontalAlign.CENTER);t.width=250;var n=new Array({text:"玩家  "},{text:e,style:{textColor:2671100}},{text:"  进入游戏"});return t.textFlow=n,t},t.prototype.onTimeDown=function(){for(var e=0;e<this.enter_name_grp.numChildren;e++){var t=this.enter_name_grp.getChildAt(e);if(t.y>-100&&(t.y--,t.y<-70&&(t.alpha=Math.max(0,t.alpha-.05))),e==this.enter_name_grp.numChildren-1&&t.y<=-100)for(var n=0;n<this.enter_name_grp.numChildren;n++){var a=this.enter_name_grp.getChildAt(n);a.y=20*n,a.alpha=1}}},t}(eui.Component);__reflect(GameLoadingUIByGroup.prototype,"GameLoadingUIByGroup");var PlayerHeadUI=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(PlayerHeadPanel);__reflect(PlayerHeadUI.prototype,"PlayerHeadUI");var ScrollerTabBtnsBar=function(e){function t(){var t=e.call(this)||this;return t.imgFrameName="iconFrame",t.imgIconName="iconDisplay",t.imgGroup="iconGroup",t.iconTitle="iconTitle",t.iconName="iconName",t.buttonIndex=0,t.buttonList=[],t.tabBtnList=[],t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.ScrollerTabBarSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){},t.prototype.setListenerBack=function(e,t){this.func=e,this.thisObj=t},t.prototype.addTabButton=function(e,t){void 0===t&&(t=!1);var n=new eui.Button;if(n.skinName=skins.ScrollerTabBtnSkin,n.name=this.tabBtnList.length.toString(),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBtn,this),n[this.imgIconName].source=e.tabBtnRes,e.tabFrame&&(n[this.imgFrameName].source=e.tabFrame),t){var a=new Animation("gonghuijineng_1",-1);a.x=40,a.y=49,a.scaleX=a.scaleY=.61,a.onPlay(),n[this.imgGroup].addChild(a),n[this.iconName].text=e.title,n[this.iconTitle].visible=!0}return this.btnGroup.addChild(n),this.buttonList.push(n),this.tabBtnList.push(e),n},t.prototype.onEventBtn=function(e){var t=parseInt(e.target.name);this.buttonIndex!=t&&this.func&&this.thisObj&&Tool.callback(this.func,this.thisObj,this.tabBtnList[t])},t.prototype.removeChildrenAll=function(){for(var e=0;e<this.buttonList.length;++e)this.buttonList[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBtn,this);this.btnGroup.removeChildren(),this.buttonList=[],this.tabBtnList=[],this.scroller.stopAnimation()},t.prototype.setTagIndex=function(e){this.buttonIndex=e;for(var t=0;t<this.buttonList.length;++t)this.buttonList[t][this.imgFrameName].visible=this.buttonList[t][this.imgGroup].visible=e==t},t.prototype.onTouchLeftBtn=function(e){this.scroller.stopAnimation()},t.prototype.onTouchRightBtn=function(e){this.scroller.stopAnimation()},t.prototype.setPreImgVisible=function(e){this.preImg.visible=e},t.prototype.setNextImgVisible=function(e){this.nextImg.visible=e},t}(eui.Component);__reflect(ScrollerTabBtnsBar.prototype,"ScrollerTabBtnsBar");var TimesBar=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.TimesBarSkin},t.prototype.dataChanged=function(){var e=this._data[0]?this._data[0]:Language.instance.getText("shengyucishu");this.title_desc_lab.text=e;var t=this._data[1],n=this._data[2];this.times_lab.text=t+"/"+n,this.times_lab.textColor=t>0?65280:16711680},t}(BaseComp);__reflect(TimesBar.prototype,"TimesBar");var TreasureAwardSmallPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TreasureAwardSmallSkin},t.prototype.onInit=function(){this.setTitle("获得物品"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._showleftTime=this.param.autocloseTime,this.result_label.text=this.param.desc,this.onUpdateAward(),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=this.param.btnlabel},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=this.param.btnlabel+("("+this._showleftTime+")"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.param.callFunc&&this.param.callObj&&Tool.callback(this.param.callFunc,this.param.callObj,this.param.callParam),this.param=null,this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&e.prototype.onShow.call(this)},t.prototype.onHide=function(){Tool.removeTimer(this.onCloseTimedown,this,1e3),e.prototype.onHide.call(this)},t.prototype.onUpdateAward=function(){if(this.award_group.removeChildren(),this.param.itemAwards)for(var e=0;e<this.param.itemAwards.length;e++){var t=this.param.itemAwards[e],n=new GoodsInstance;if(n.x=100*Math.floor(e%5),n.y=130*Math.floor(e/5),this.award_group.addChild(n),t.type==GOODS_TYPE.GEM){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.GEM,t.id);n.onUpdate(t.type,t.id,0,t.quality,t.num,a.level)}else n.onUpdate(t.type,t.id,0,t.quality,t.num)}},t}(BaseWindowPanel);__reflect(TreasureAwardSmallPanel.prototype,"TreasureAwardSmallPanel");var AllPeopleBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.updateTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AllPeopleBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ALLPEOPLE_BOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this),this.remind_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openRemindPanel,this),this.recover_label.text=""},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.onRemomveTimer(),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ALLPEOPLE_BOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this);for(var t=0;t<this.allpeopleItems.length;t++){var n=this.allpeopleItems[t];n.onDestory()}this.remind_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openRemindPanel,this)},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineStr(this.remind_label),this.boss_scroll.verticalScrollBar.autoVisibility=!1,this.boss_scroll.verticalScrollBar.visible=!1,this.allpeopleItems=[];var t=JsonModelManager.instance.getModelquanminboss();for(var n in t){var a=t[n],i=new AllPeopleBossItem(a);this.allpeopleItems.push(i)}e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequsetBossListInfoMsg(),Tool.addTimer(this.runTimerDown,this,1e3)},t.prototype.onRequsetBossListInfoMsg=function(){this.hasRecover=!1,this.hasInfo=!1,this.updateTime=0;var e=new Message(MESSAGE_ID.ALLPEOPLE_BOSS_LISTINFO_MSG);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResBossListInfoMsg=function(){this.hasRecover=DataManager.getInstance().dupManager.allpeoplebossData.leftRecover>0,this.lefttimes_label.text=DataManager.getInstance().dupManager.allpeoplebossData.lefttimes+"/"+DupDefine.AllPEOPLE_MAX_TIMES,this.onupdateItemData(),this.hasInfo=!0},t.prototype.runTimerDown=function(){if(this.hasRecover)if(DataManager.getInstance().dupManager.allpeoplebossData.leftRecover>0){var e=Tool.getTimeStr(DataManager.getInstance().dupManager.allpeoplebossData.leftRecover);this.recover_label.text="("+e+"恢复1次)",this.updateTime>10?this.onRequsetBossListInfoMsg():this.updateTime++}else this.onRequsetBossListInfoMsg();if(this.hasInfo)for(var t=0;t<this.allpeopleItems.length;t++){var n=this.allpeopleItems[t];n.updateRebronTime()&&this.onRequsetBossListInfoMsg()}},t.prototype.onRemomveTimer=function(){Tool.removeTimer(this.runTimerDown,this,1e3)},t.prototype.onupdateItemData=function(){for(var e=0;e<this.allpeopleItems.length;e++){var t=this.allpeopleItems[e];t.onUpdate()}this.allpeopleItems.sort(function(e,t){return t.sort-e.sort}),this.itemGroup.removeChildren();for(var e=0;e<this.allpeopleItems.length;e++){var t=this.allpeopleItems[e];if(t.onShow(this.itemGroup),t.model.limitLevel>DataManager.getInstance().playerManager.player.coatardLv)break}},t.prototype.openRemindPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"AllPeopleRemindPanel")},t}(BaseTabView);__reflect(AllPeopleBossView.prototype,"AllPeopleBossView");var AllPeopleBossItem=function(e){function t(t){var n=e.call(this)||this;return n.model=t,n.info=DataManager.getInstance().dupManager.allpeoplebossData.infos[n.model.id],n.width=590,n.height=147,n.skinName=skins.AllPeopleBossItemSkin,n}return __extends(t,e),t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineGet(this.get_label),this.monster_name_label.text=this.bossFightter.name,this.monsterIcon_img.source=this.bossFightter.avata+"_icon_png";for(var e=0;e<this.model.rewards.length;e++){var t=this.model.rewards[e],n=new GoodsInstance;n.scaleX=.8,n.scaleY=.8,n.onUpdate(t.type,t.id,0,t.quality,t.num),this.award_group.addChild(n)}this.model&&this.onUpdate()},t.prototype.onRegist=function(){this.get_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetZhuansheng,this),this.btn_challenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this)},t.prototype.onRemove=function(){this.get_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetZhuansheng,this),this.btn_challenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this)},t.prototype.onUpdate=function(){if(this.isLoaded&&(this.info=DataManager.getInstance().dupManager.allpeoplebossData.infos[this.model.id-1],this.info)){this.bosshp_probar.text=Math.min(100,Math.ceil(this.info.leftHp/this.bossFightter.hp*100))+"%";var e=this.model.limitLevel<=DataManager.getInstance().playerManager.player.coatardLv;this.joinNum_label.text=(e?this.info.joinNum:0)+"人",this.btn_challenge.enabled=e&&this.info.rebirthTime<=0,e?(this.get_label.visible=!1,this.info.isOpen?this.time_label.text="":this.updateRebronTime()):(this.time_label.text=Language.instance.getText("coatard_level"+this.model.limitLevel,"open"),this.get_label.visible=!0)}},Object.defineProperty(t.prototype,"bossFightter",{get:function(){return ModelManager.getInstance().getModelFigher(this.model.modelId)},enumerable:!0,configurable:!0}),t.prototype.updateRebronTime=function(){if(this.isLoaded){if(this.model.limitLevel>DataManager.getInstance().playerManager.player.coatardLv)return!1;if(this.info&&!this.info.isOpen){if(!(this.info.rebirthTime>0))return this.time_label.text=Tool.getTimeStr(0)+Language.instance.getText("houchongsheng"),!0;this.time_label.text=Tool.getTimeStr(this.info.rebirthTime)+Language.instance.getText("houchongsheng")}return!1}},t.prototype.onTouchChallengeBtn=function(e){GameFight.getInstance().onEnterAllPeopleBossScene(this.model.id)},Object.defineProperty(t.prototype,"sort",{get:function(){var e=0;return this.info&&(e=this.model.limitLevel>DataManager.getInstance().playerManager.player.coatardLv?Tool.toInt(1e3-this.model.limitLevel):this.info.rebirthTime>0?this.model.limitLevel+1e3:this.model.limitLevel+1e4),e},enumerable:!0,configurable:!0}),t.prototype.onGetZhuansheng=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_JINGJIE)},t}(BaseComp);__reflect(AllPeopleBossItem.prototype,"AllPeopleBossItem");var AllPeopleRemindPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.AllPeopleRemindSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onInit=function(){this.setTitle("cross_boss_remind_title_png"),this.itemGroup.itemRenderer=AllPeopleRemindItem,this.itemGroup.itemRendererSkinName=skins.AllPeopleRemindItemSkin,this.itemGroup.useVirtualLayout=!1,this.boss_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.itemGroup.dataProvider=new eui.ArrayCollection(Tool.Object2Ary(JsonModelManager.instance.getModelquanminboss()))},t.prototype.onHide=function(){for(var t=[],n=!1,a=0;a<this.itemGroup.dataProvider.length;a++){var i=this.itemGroup.dataProvider.getItemAt(a).id;this.itemGroup.getChildAt(a).isRemind&&t.push(i),!n&&DataManager.getInstance().dupManager.allpeoplebossData.remindBossIds.indexOf(i)<0&&(n=!0)}if(n||DataManager.getInstance().dupManager.allpeoplebossData.remindBossIds.length!=t.length){DataManager.getInstance().dupManager.allpeoplebossData.remindBossIds=[];var o=new Message(MESSAGE_ID.ALLPEOPLE_SET_REMIND_MSG);o.setShort(t.length);for(var a=0;a<t.length;a++)o.setShort(t[a]),DataManager.getInstance().dupManager.allpeoplebossData.remindBossIds.push(t[a]);GameCommon.getInstance().sendMsgToServer(o)}e.prototype.onHide.call(this)},t}(BaseWindowPanel);__reflect(AllPeopleRemindPanel.prototype,"AllPeopleRemindPanel");var AllPeopleRemindItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data,t=ModelManager.getInstance().getModelFigher(e.modelId);this.monster_name_label.text=t.name,this.level_label.text=Language.instance.getText("coatard_level"+e.limitLevel,"jingjie");var n=e.limitLevel<=DataManager.getInstance().playerManager.player.coatardLv;this.remind_checkbox.visible=n,this.unopen_label.visible=!n;var a=DataManager.getInstance().dupManager.allpeoplebossData.remindBossIds.indexOf(e.id)>=0;this.remind_checkbox.selected=a,this.imgBG.visible=parseInt(e.id)%2==0},Object.defineProperty(t.prototype,"isRemind",{get:function(){return this.remind_checkbox.selected},enumerable:!0,configurable:!0}),t}(BaseListItem);__reflect(AllPeopleRemindItem.prototype,"AllPeopleRemindItem");var CrossBarriersPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_GEREN_BOSS,n.points=RedPointManager.createPoint(3),n}return __extends(t,e),t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="PersonallyBossView",n.btnRes="个人",n.redP=this.points[0],n.redP.addTriggerFuc(FunDefine,"getGerenBossRedPoint"),n.funcID=FUN_TYPE.FUN_GEREN_BOSS,t.push(n),n=new RegisterSystemParam,n.sysName="AllPeopleBossView",n.btnRes="全民",n.redP=this.points[1],n.redP.addTriggerFuc(FunDefine,"getAllPeopleBossRedPoint"),n.funcID=FUN_TYPE.FUN_QUANMIN_BOSS,t.push(n),n=new RegisterSystemParam,n.sysName="XuezhanBossView",n.btnRes="血战",n.funcID=FUN_TYPE.FUN_XUEZHANBOSS,t.push(n),SDKManager.isHidePay||(n=new RegisterSystemParam,n.sysName="VIPTeamBossView",n.btnRes="仙尊",n.title="仙尊",n.funcID=FUN_TYPE.FUN_VIPTEAM,t.push(n)),n=new RegisterSystemParam,n.sysName="SamsaraBossView",n.btnRes="转生",n.title="转生",n.redP=this.points[2],n.redP.addTriggerFuc(FunDefine,"getSamsaraBossBackAwdRPoint"),n.funcID=FUN_TYPE.FUN_ZHUANSHENG_BOSS,t.push(n),this.registerPage(t,"crossGrp"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("个人BOSS");break;case 1:this.setTitle("全民BOSS");break;case 2:this.setTitle("血战BOSS");break;case 3:this.setTitle("仙尊BOSS");break;case 4:this.setTitle("转生BOSS")}e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(CrossBarriersPanel.prototype,"CrossBarriersPanel");var MyBossKillPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.leftCloseTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraKillerLogSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE.toString(),this.onResKillLogMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE.toString(),this.onResKillLogMsg,this)},t.prototype.onInit=function(){this.setTitle("cross_killlog_title_png"),this.setTitlePercent(.9),this.itemGroup.itemRenderer=SamsaraBossKillLogItem,this.itemGroup.itemRendererSkinName=skins.SamsaraKillerLogItemSkin,this.itemGroup.useVirtualLayout=!1,this.boss_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestKillLogMsg()},t.prototype.onRequestKillLogMsg=function(){var e=new Message(MESSAGE_ID.BOSS_MYSTERIOUS_HISTORY_TOP_MESSAGE);e.setShort(this.param.bossId),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResKillLogMsg=function(e){if(this.rankDatas)for(var t=this.rankDatas.length-1;t>=0;t--)this.rankDatas[t]=null,this.rankDatas.splice(t,1);else this.rankDatas=[];for(var n=e.message,a=n.getByte(),t=0;a>t;t++)this.rankDatas[t]=new SimpleFightRankData,this.rankDatas[t].onParseMsg(n,t+1);var i=n.getBoolean();if(i){var o=n.getString();this.killer_label.text=Language.instance.getText("jishazhe","：",o)}else this.killer_label.text=Language.instance.getText("hyhwyrjsBoss");this.itemGroup.dataProvider=new eui.ArrayCollection(this.rankDatas),this.boss_scroll.viewport.scrollV=0,this.param.autoClose>0?(this.leftCloseTime=this.param.autoClose,Tool.addTimer(this.autoCloseHandler,this,1e3)):this.btn_sure.label=Language.instance.getText("sure")},t.prototype.autoCloseHandler=function(){this.leftCloseTime--,this.btn_sure.label=Language.instance.getText("sure")+"("+this.leftCloseTime+")",this.leftCloseTime<=0&&this.onHide()},t.prototype.onShowWithParam=function(e){this.param=e,this.param&&this.onShow()},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.autoCloseHandler,this,1e3),this.param.isLeave&&GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.MYSTERIOUS_BOSS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t}(BaseWindowPanel);__reflect(MyBossKillPanel.prototype,"MyBossKillPanel");var MyBossKillLogItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.rank_num.text=""+e.rank,e.vipLevel>0?this.vip_label.visible=!0:this.vip_label.visible=!1,this.name_label.text=e.playerName,this.power_label.text=""+e.damageValue},t}(eui.ItemRenderer);__reflect(MyBossKillLogItem.prototype,"MyBossKillLogItem");var MyBossKillLogParam=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.autoClose=0,this.bossId=e,this.autoClose=t,this.isLeave=n}return e}();__reflect(MyBossKillLogParam.prototype,"MyBossKillLogParam");var PersonallyBossView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PersonallyBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupinfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupinfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefresh,this),this.itemGroup.dataProvider=null},t.prototype.onInit=function(){this.boss_scroll.verticalScrollBar.autoVisibility=!1,this.boss_scroll.verticalScrollBar.visible=!1,this.itemGroup.itemRenderer=PersonallyBossItem,this.itemGroup.itemRendererSkinName=skins.PersonallyBossItemSkin,this.itemGroup.useVirtualLayout=!0,this.boss_scroll.viewport=this.itemGroup,this.itemDatas=[];var t=JsonModelManager.instance.getModelgerenboss();for(var n in t){var a=new PersonallyItemData,i=t[n];a.model=i,this.itemDatas.push(a)}e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onReqDupInfoMsg=function(){var e=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);e.setByte(DUP_TYPE.DUP_PERSONALLY),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResDupinfoMsg=function(){for(var e=0;e<this.itemDatas.length;e++){var t=this.itemDatas[e],n=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_PERSONALLY,t.model.id);t.lefttimes=n?n.lefttimes:0,t.sort=0==t.lefttimes?t.model.id+1e3:t.model.id,t.pass=n.personDupPassRecord}this.onupdateItemData()},t.prototype.onRefresh=function(){this.onReqDupInfoMsg()},t.prototype.onupdateItemData=function(){this.itemDatas.sort(function(e,t){return e.sort-t.sort});var e,t=[],n=0;do{if(e=this.itemDatas[n],n++,!e)break;t.push(e)}while(e.model.jingjie<=DataManager.getInstance().playerManager.player.coatardLv);this.itemGroup.dataProvider=new eui.ArrayCollection(t),this.boss_scroll.viewport.scrollV=0},t}(BaseTabView);__reflect(PersonallyBossView.prototype,"PersonallyBossView");var PersonallyBossItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t.width=590,t.height=147,t}return __extends(t,e),t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineGet(this.get_label),this.btn_challenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),this.get_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetZhuansheng,this),this.points[0].register(this.btn_challenge,GameDefine.RED_BTN_POS_YELLOW_LITTLE,FunDefine,"getPersonallyBossHasTimes")},t.prototype.onUpdate=function(){var e=this.data,t=ModelManager.getInstance().getModelFigher(e.model.bossId);if(t&&(this.monster_name_label.text=t.name,this.monsterIcon_img.source=GameCommon.getInstance().getHeadIconByModelid(e.model.bossId)),this.lefttimes_label.text=Language.instance.getText("shengyucishu","：",e.lefttimes,"times"),e.model.jingjie>DataManager.getInstance().playerManager.player.coatardLv)this.unopen_des_lab.text=Language.instance.getText("coatard_level"+e.model.jingjie,"open"),this.btn_challenge.visible=!1,this.unopen_des_grp.visible=!0;
else{this.btn_challenge.visible=!0,this.btn_challenge.enabled=e.lefttimes>0,this.btn_challenge.enabled?this.btn_challenge.label="挑 战":this.btn_challenge.label="已挑战";var n=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG];(n&&n.param>0||DataManager.getInstance().playerManager.player.level>=200)&&1==e.pass&&(this.btn_challenge.label="扫 荡"),this.unopen_des_grp.visible=!1}this.award_group.removeChildren();for(var a=GameCommon.getInstance().onParseAwardItemstr(e.model.show),i=0;i<a.length;i++){var o=a[i],r=new GoodsInstance;r.scaleX=.8,r.scaleY=.8,r.onUpdate(o.type,o.id,0,o.quality,o.num),this.award_group.addChild(r)}this.points[0].checkPoint(!0,e.model.id)},t.prototype.onChallenge=function(e){var t=this.data;"扫 荡"==this.btn_challenge.label?GameFight.getInstance().onSendSaoDangPersonallyBossMsg(t.model.id):GameFight.getInstance().onSendEnterPersonallyBossMsg(t.model.id)},t.prototype.onGetZhuansheng=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_JINGJIE)},t}(BaseListItem);__reflect(PersonallyBossItem.prototype,"PersonallyBossItem");var PersonallyItemData=function(){function e(){}return e}();__reflect(PersonallyItemData.prototype,"PersonallyItemData");var SamsaraAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.reward_keys=["firstReward","secondReward","Reward345","canyuReward","killReward"],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraAwdViewSkin},t.prototype.onInit=function(){this.setTitle("奖励"),this.bossReawards=JsonModelManager.instance.getModelbossrewards(),this.award_groups=[],this.items=[];for(var e=0;5>e;++e)this.award_groups[e]=this["award_group"+e],this.items[e]=this["item_"+e];this.tabBtns=[];for(var t=[4,8,11,15],e=0;e<t.length;++e)this.tabBtns[e]=this["tab"+e],this.tabBtns[e].tab_name.text=t[e]+"转";this.currIndex=0,this.updateUI()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.tabBtns.length;t++)this.tabBtns[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.tabBtns.length;t++)this.tabBtns[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)},t.prototype.onTouchTabBtn=function(e){var t=e.currentTarget;t.value!=this.currIndex&&(this.currIndex=t.value,this.updateUI())},t.prototype.updateTabs=function(){for(var e=0;e<this.tabBtns.length;e++)this.tabBtns[e].selected=e==this.currIndex},t.prototype.updateUI=function(){this.updateTabs();for(var e=this.bossReawards[this.currIndex],t=0;t<this.reward_keys.length;t++){var n=this.reward_keys[t],a=GameCommon.getInstance().onParseAwardItemstr(e[n]);if(a){for(var i=Math.max(this.award_groups[t].numChildren,a.length),o=0;i>o;o++){this.award_groups[t].numChildren<=o&&this.award_groups[t].addChild(new GoodsInstance);var r=this.award_groups[t].getChildAt(o);if(a.length>o){var s=a[o];r.onUpdate(s.type,s.id,0,s.quality,s.num),r.visible=!0}else r.visible=!1}this.items[t].visible=!0}else this.items[t].visible=!1}},t}(BaseWindowPanel);__reflect(SamsaraAwardPanel.prototype,"SamsaraAwardPanel");var SamsaraBossKillLogPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.leftCloseTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraKillerLogSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_KILLLOG_MSG.toString(),this.onResKillLogMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_KILLLOG_MSG.toString(),this.onResKillLogMsg,this)},t.prototype.onInit=function(){this.basic.label_title.text="排行",this.setTitlePercent(.9),this.itemGroup.itemRenderer=SamsaraBossKillLogItem,this.itemGroup.itemRendererSkinName=skins.SamsaraKillerLogItemSkin,this.itemGroup.useVirtualLayout=!1,this.boss_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestKillLogMsg()},t.prototype.onRequestKillLogMsg=function(){var e=new Message(MESSAGE_ID.SAMSARA_BOSS_KILLLOG_MSG);e.setShort(this.param.bossId),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResKillLogMsg=function(e){if(this.rankDatas)for(var t=this.rankDatas.length-1;t>=0;t--)this.rankDatas[t]=null,this.rankDatas.splice(t,1);else this.rankDatas=[];for(var n=e.message,a=n.getByte(),t=0;a>t;t++)this.rankDatas[t]=new SimpleFightRankData,this.rankDatas[t].onParseMsg(n,t+1);var i=n.getBoolean();if(i){var o=n.getString();this.killer_label.text=Language.instance.getText("jishazhe","：",o)}else this.killer_label.text=Language.instance.getText("hyhwyrjsBoss");this.itemGroup.dataProvider=new eui.ArrayCollection(this.rankDatas),this.boss_scroll.viewport.scrollV=0,this.param.autoClose>0?(this.leftCloseTime=this.param.autoClose,Tool.addTimer(this.autoCloseHandler,this,1e3)):this.btn_sure.label=Language.instance.getText("sure")},t.prototype.autoCloseHandler=function(){this.leftCloseTime--,this.btn_sure.label=Language.instance.getText("sure")+"("+this.leftCloseTime+")",this.leftCloseTime<=0&&this.onHide()},t.prototype.onShowWithParam=function(e){this.param=e,this.param&&this.onShow()},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.autoCloseHandler,this,1e3),this.param.isLeave&&GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.SAMSARA_BOSS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t}(BaseWindowPanel);__reflect(SamsaraBossKillLogPanel.prototype,"SamsaraBossKillLogPanel");var SamsaraBossKillLogItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;this.rank_num.text=""+e.rank,e.vipLevel>0?this.vip_label.visible=!0:this.vip_label.visible=!1,this.name_label.text=e.playerName,this.power_label.text=""+e.damageValue},t}(BaseListItem);__reflect(SamsaraBossKillLogItem.prototype,"SamsaraBossKillLogItem");var SamsaraBossKillLogParam=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.autoClose=0,this.bossId=e,this.autoClose=t,this.isLeave=n}return e}();__reflect(SamsaraBossKillLogParam.prototype,"SamsaraBossKillLogParam");var SamsaraBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this),this.loop_award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openAwardsPanel,this),this.gotocoatard_lab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoCoatardPanel,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this),this.zhaohui_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onshowZhaohuiPanel,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SAMSARA_BOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this),this.loop_award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openAwardsPanel,this),this.gotocoatard_lab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoCoatardPanel,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this),this.zhaohui_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onshowZhaohuiPanel,this);for(var t=0;t<this.samsaraItems.length;t++){var n=this.samsaraItems[t];n.onDestory()}Tool.removeTimer(this.rebornTimeDown,this,1e3)},t.prototype.onInit=function(){this.gotocoatard_lab.text=Language.instance.getText("goto","jingjie"),GameCommon.getInstance().addUnderlineStr(this.gotocoatard_lab),this.desc_lab.text=Language.instance.getText("jingjiebossguize"),this.open_time_lab.text=Language.instance.getText("jingjiebosstimedesc"),this.samsaraItems=[];var t=JsonModelManager.instance.getModelboss();for(var n in t){var a=t[n],i=new SamsaraBossItem(a);this.samsaraItems.push(i)}this.points[0].register(this.zhaohui_btn,GameDefine.RED_BTN_POS,FunDefine,"getSamsaraBossBackAwdRPoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){for(var e=(DataManager.getInstance().playerManager.player.coatardLv,0);e<this.samsaraItems.length;e++){var t=this.samsaraItems[e];t.onShow(this.itemGroup),t.onUpdate()}},t.prototype.onResBossListInfoMsg=function(){DataManager.getInstance().dupManager.samsarebossData.openLefttime>0?(FunDefine.isSamsaraOpen=!1,this.challenge_btn.enabled=!1):(FunDefine.isSamsaraOpen=!0,this.challenge_btn.enabled=!0,DataManager.getInstance().dupManager.samsarebossData.rebornLefttime>0&&(this.rebornlefttime=DataManager.getInstance().dupManager.samsarebossData.rebornLefttime,Tool.addTimer(this.rebornTimeDown,this,1e3))),this.zhaohui_btn.enabled=FunDefine.getSamsaraBossBackAwdRPoint()},t.prototype.rebornTimeDown=function(){0==this.rebornlefttime?(this.challenge_btn.label=Language.instance.getText("challenge"),Tool.removeTimer(this.rebornTimeDown,this,1e3)):(this.challenge_btn.label=Language.instance.getText("reborn")+"("+this.rebornlefttime+"s)",this.rebornlefttime--)},t.prototype.openAwardsPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SamsaraAwardPanel")},t.prototype.gotoCoatardPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TaskBasePanel",TASKPANEL_TAB.COATARDTASK))},t.prototype.onshowZhaohuiPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SamsaraBossBackAwdPanel")},t.prototype.onTouchChallengeBtn=function(e){return this.rebornlefttime>0?void GameFight.getInstance().onBossFightReborn():this.touchTime>egret.getTimer()?void GameCommon.getInstance().addAlert("error_tips_78"):(this.touchTime=egret.getTimer()+2e3,void GameFight.getInstance().onEnterSamsaraBossScene())},t}(BaseTabView);__reflect(SamsaraBossView.prototype,"SamsaraBossView");var SamsaraBossItem=function(e){function t(t){var n=e.call(this)||this;return n.model=t,n}return __extends(t,e),t.prototype.onInit=function(){this.model&&this.onUpdate(),this.looprank_label.text=Language.instance.getText("shangcipaihang"),GameCommon.getInstance().addUnderlineStr(this.looprank_label)},t.prototype.setSkinName=function(){this.skinName=skins.SamsaraBossItemSkin},t.prototype.onRegist=function(){this.looprank_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBeforeKillLog,this)},t.prototype.onRemove=function(){this.looprank_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBeforeKillLog,this)},t.prototype.onUpdate=function(){if(this.isLoaded){var e=ModelManager.getInstance().getModelFigher(this.model.modelId);this.boss_itemcell_img.source="samsara_item"+this.model.id+"_open_png",this.label_name.text=this.model.limitLevel+"阶·"+e.name;var t=GameCommon.parseAwardItem(this.model.yulan);this.awardicon.onUpdate(t.type,t.id);var n=DataManager.getInstance().playerManager.player.coatardLv,a=0;for(var i in JsonModelManager.instance.getModelboss()){var o=JsonModelManager.instance.getModelboss()[i];if(o.limitLevel>n)break;a=o.id}var r=DataManager.getInstance().dupManager.samsarebossData;if(a==this.model.id){var s=SAMSARABOSS_STATE.UNOPEN,h=r.bossLifes[a];if(h&&h.length>0&&r.openLefttime<=0){var l=h[1];s=l>0?SAMSARABOSS_STATE.FIGHTTING:SAMSARABOSS_STATE.KILLED}switch(s){case SAMSARABOSS_STATE.UNOPEN:this.state_lab.text=Language.instance.getText("unopen");break;case SAMSARABOSS_STATE.FIGHTTING:this.state_lab.text=Language.instance.getText("tiaozhanzhong");break;case SAMSARABOSS_STATE.KILLED:this.state_lab.text=Language.instance.getText("yijisha")}this.setLock(!1),this.state_tips_grp.visible=!0}else this.setLock(!0),this.model.limitLevel>n?(this.state_lab.text=Language.instance.getText("coatard_level"+this.model.limitLevel,"open"),this.state_tips_grp.visible=!0):this.state_tips_grp.visible=!1}},t.prototype.setLock=function(e){this.locked_bg.visible=e,this.imgFrame.source=e?"samsara_item_frame_gray_png":"samsara_item_frame_png",this.imgTitleBG.source=e?"samsara_item_title_bg_gray_png":"samsara_item_title_bg_png",this.imgStateBG.source=e?"samsara_item_wkq_gray_png":"samsara_item_wkq_png"},t.prototype.onShowBeforeKillLog=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SamsaraBossKillLogPanel",new SamsaraBossKillLogParam(this.model.id)))},t}(BaseComp);__reflect(SamsaraBossItem.prototype,"SamsaraBossItem");var SamsaraBossBackAwdPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.BACK_AWD_GOLD=50,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraBossZhaohuiViewSkin},t.prototype.onInit=function(){this.setTitle("找回奖励"),this.mini_explain_label.text=Language.instance.getText("zhaohui_text"),this.label_r.text=Constant.get(Constant.REIN_CALL_BACK),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=0;for(var t in JsonModelManager.instance.getModelboss()){var n=JsonModelManager.instance.getModelboss()[t];if(n.limitLevel>DataManager.getInstance().playerManager.player.coatardLv)break;e=n.id}var a=JsonModelManager.instance.getModelbossrewards()[e],i=GameCommon.getInstance().onParseAwardItemstr(a.canyuReward);this.zhaohui_awd_grp.removeChildren();for(var o=0;o<i.length;o++){var r=i[o],s=GameCommon.getInstance().createGoodsIntance(r);this.zhaohui_awd_grp.addChild(s)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.zhaohui_sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackAward,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.zhaohui_sure_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackAward,this)},t.prototype.onBackAward=function(){if(DataManager.getInstance().playerManager.player.gold<this.BACK_AWD_GOLD)return void GameCommon.getInstance().addAlert("error_tips_2");var e=new Message(MESSAGE_ID.SAMSARA_BOSS_BACKAWD_MSG);GameCommon.getInstance().sendMsgToServer(e),this.onTouchCloseBtn()},t}(BaseWindowPanel);__reflect(SamsaraBossBackAwdPanel.prototype,"SamsaraBossBackAwdPanel");var VIPTeamBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.DUPS=[28,29,30,31],n.selectIdx=0,n._bossNames=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VipTeamBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResVIPBossInfoMsg,this),this.call_boss_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCallBtn,this);for(var t=0;t<this.DUPS.length;t++){var n=this["vipboss_item"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)}DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_VIP_TEAM)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResVIPBossInfoMsg,this),this.call_boss_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCallBtn,this);for(var t=0;t<this.DUPS.length;t++){var n=this["vipboss_item"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)}},t.prototype.onInit=function(){for(var t=0;t<this.DUPS.length;t++){var n=this.DUPS[t],a=JsonModelManager.instance.getModelcopy()[n],i=(JsonModelManager.instance.getModelzuduifuben()[n],this["vipboss_item"+t]);this._bossNames.push(a.name),i.name=t+"",i.data=n}this.onChangeItem(),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);if(t!=this.selectIdx){var n=this["vipboss_item"+this.selectIdx];n.setItemSelect(!1),this.selectIdx=t,this.onChangeItem()}},t.prototype.onChangeItem=function(){var e=this["vipboss_item"+this.selectIdx];e.setItemSelect(!0);var t=this.DUPS[this.selectIdx],n=JsonModelManager.instance.getModelzuduifuben()[t];this.boss_name.text=this._bossNames[this.selectIdx],this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,parseInt(n.bossId)),this.bossAnim.parent||this.boss_model_grp.addChild(this.bossAnim);var a,i,o;this.call_awd_grp.removeChildren(),o=GameCommon.getInstance().onParseAwardItemstr(n.viprewards);for(var r=0;r<o.length;r++)a=o[r],i=GameCommon.getInstance().createGoodsIntance(a),this.call_awd_grp.addChild(i);this.canyu_awd_grp.removeChildren(),o=GameCommon.getInstance().onParseAwardItemstr(n.canyurewards);for(var r=0;r<o.length;r++)a=o[r],i=GameCommon.getInstance().createGoodsIntance(a),this.canyu_awd_grp.addChild(i);this.onRefreshCallTimes()},t.prototype.onRefreshCallTimes=function(){var e=DataManager.getInstance().playerManager.player.viplevel,t=DataManager.getInstance().playerManager.player.coatardLv,n=this.DUPS[this.selectIdx],a=JsonModelManager.instance.getModelcopy()[n],i=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_VIP_TEAM,a.subType);i.lefttimes>0&&a.viplimit<=e&&a.lvlimit<=t?(this.call_boss_btn.enabled=!0,this.call_boss_btn.label=Language.instance.getText("dianjizhaohuan")):(this.call_boss_btn.enabled=!1,e<a.viplimit?this.call_boss_btn.label=Language.instance.getText("error_tips_5"):t<a.lvlimit?this.call_boss_btn.label=Language.instance.getText("error_tips_10005"):this.call_boss_btn.label=Language.instance.getText("yizhaohuan"))},t.prototype.onResVIPBossInfoMsg=function(){this.onRefreshCallTimes();var e=DataManager.getInstance().playerManager.player.viplevel,t=DataManager.getInstance().dupManager.getDupMaxTimesById(this.DUPS[0]),n=DataManager.getInstance().dupManager.vipteamLeftjoinTimes+"/"+t;e>0?this.lefttime_lab.text=Language.instance.parseInsertText("vipteamdup_cishu2",n):this.lefttime_lab.text=Language.instance.parseInsertText("vipteamdup_cishu1",n)},t.prototype.onTouchCallBtn=function(){var e=this.DUPS[this.selectIdx],t=DataManager.getInstance().dupManager.getDupInfoByID(e);GameFight.getInstance().onSendCreateTeamDupRoomMsg(t.dupModel.id)},t}(BaseTabView);__reflect(VIPTeamBossView.prototype,"VIPTeamBossView");var VIPTeamBossBar=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){},t.prototype.onInit=function(){this.onchangeStatus()},t.prototype.dataChanged=function(){var e=this._data,t=JsonModelManager.instance.getModelcopy()[e],n=JsonModelManager.instance.getModelzuduifuben()[e],a=ModelManager.getInstance().getModelFigher(parseInt(n.bossId)),i=a.avata+"_icon_png";this.monsterIcon_img.source=i,this.monster_name_lab.text=a.name,this.lbName.text=t.name,this.viplimit_lab.text="VIP"+GameCommon.getInstance().getVipName(t.viplimit)+Language.instance.getText("kezhaohuan")},t.prototype.setItemSelect=function(e){this._seleted=e,this.onchangeStatus()},t.prototype.onchangeStatus=function(){this.isLoaded&&(this.imgItemBG.source=this._seleted?"xianzun_item_bg1_png":"xianzun_item_bg0_png",this.imgTitleBG.source=this._seleted?"xianzun_title_bg1_png":"xianzun_title_bg0_png",this.imgNameBG.source=this._seleted?"xianzun_name_bg1_png":"public_name_bg2_png")},t}(BaseComp);__reflect(VIPTeamBossBar.prototype,"VIPTeamBossBar");var XuezhanBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.MAX_ITEM_NUM=5,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XuezhanBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHANBOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),this.onRequsetBossListInfoMsg(),this.bossAnim&&this.bossAnim.onReLoad()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHANBOSS_LISTINFO_MSG.toString(),this.onResBossListInfoMsg,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),Tool.removeTimer(this.runTimerDown,this,1e3)},t.prototype.onInit=function(){this.tab0.selected=!0,e.prototype.onInit.call(this)},t.prototype.onRequsetBossListInfoMsg=function(){var e=new Message(MESSAGE_ID.XUEZHANBOSS_LISTINFO_MSG);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResBossListInfoMsg=function(){for(var e=DataManager.getInstance().dupManager.allpeoplebossData,t=0;t<this.MAX_ITEM_NUM;t++){var n=e.xuezhanInfos[t];if(!n)break;var a=ModelManager.getInstance().getModelFigher(n.bossID),i=this["tab"+t];i.label=a.name,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}if(Tool.isNumber(this.selectIndex)){var o=this.selectIndex;this.selectIndex=null,this.onchangeTab(o)}else this.onchangeTab(0);Tool.addTimer(this.runTimerDown,this,1e3)},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.onchangeTab(t.value),this.runTimerDown()},t.prototype.onchangeTab=function(e){if(this.selectIndex!=e){this.selectIndex=e;var t=DataManager.getInstance().dupManager.allpeoplebossData.xuezhanInfos[e],n=ModelManager.getInstance().getModelFigher(t.bossID);this.boss_name_lab.text=n.name,this.belongers_lab.text=t.guishuName?t.guishuName:"暂无",this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,t.bossID),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim),this.reward_grp.removeChildren();for(var a=0;a<t.model.rewards.length;a++){var i=t.model.rewards[a],o=GameCommon.getInstance().createGoodsIntance(i);this.reward_grp.addChild(o)}this.boss_hp_probar.maximum=n.hp,this.boss_hp_probar.value=t.leftHp,this.onUpdateStatus()}},t.prototype.onUpdateStatus=function(){var e=DataManager.getInstance().dupManager.allpeoplebossData.xuezhanInfos[this.selectIndex],t=0==e.rebirthTime;if(t){this.challenge_btn.enabled=!0;var n=parseInt(this["layer_tab"+this.selectIndex].name);FunDefine.isFunOpen(n)?(this.unopne_desc_lab.text="",this._isDeath=e.deathLeftTime>0,this.challenge_btn.visible=!0,this.fight_info_grp.visible=!0,this._isDeath?(this.challenge_btn.enabled=!1,this.challenge_btn.label=Language.instance.getText("reborn")+"("+e.deathLeftTime+"s)"):(this.challenge_btn.enabled=!0,this.challenge_btn.label=Language.instance.getText("challenge"))):(this.challenge_btn.visible=!1,this.unopne_desc_lab.text=Language.instance.getText("xianlv","bless"+e.model.type+"_name","open","fangketiaozhan"))}else this.fight_info_grp.visible=!1,this.challenge_btn.visible=!0,this.unopne_desc_lab.text="",this.challenge_btn.enabled=!1,this.challenge_btn.label=Language.instance.getText("unopen")},t.prototype.runTimerDown=function(){var e=DataManager.getInstance().dupManager.allpeoplebossData.xuezhanInfos[this.selectIndex];e&&e.rebirthTime>0?(this.reborn_time_lab.text=Language.instance.getText("fuhuoshijian")+"："+Tool.getTimeStr(e.rebirthTime),this.reborn_time_bg.visible=!0):""!=this.reborn_time_lab.text&&(this.reborn_time_lab.text="",this.reborn_time_bg.visible=!1,this.onUpdateStatus()),this._isDeath&&(this._isDeath=e.deathLeftTime>0,this._isDeath?this.challenge_btn.label=Language.instance.getText("reborn")+"("+e.deathLeftTime+"s)":this.onUpdateStatus())},t.prototype.onChallenge=function(){var e=DataManager.getInstance().dupManager.allpeoplebossData.xuezhanInfos[this.selectIndex];GameFight.getInstance().onEnterXuezhanBossScene(e.id)},t}(BaseTabView);__reflect(XuezhanBossView.prototype,"XuezhanBossView");var ZhuXianBossMain=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin,this.setTitle("z_peishizhuxian_png")},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="ZhuXianBossPanel",n.btnRes="peishizhuxian_btn",n.redP=this.points[0],n.redP.addTriggerFuc(FunDefine,"DupZhuXianBossTimes"),t.push(n),this.registerPage(t,"zhuxianbossGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(ZhuXianBossMain.prototype,"ZhuXianBossMain");var ZhuXianBossPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ZhuXianBossPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupinfoMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupinfoMsg,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),Tool.removeTimer(this.runTimerDown,this,1e3)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onReqDupInfoMsg()},t.prototype.onResDupinfoMsg=function(){this.onShowInfo()},t.prototype.onReqDupInfoMsg=function(){var e=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);e.setByte(DUP_TYPE.DUP_BLESS),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onShowInfo=function(){var e=DataManager.getInstance().newactivitysManager.dabiao_model,t=e.type;if(this.peishiCfg=JsonModelManager.instance.getModelpeishiboss()[DataManager.getInstance().newactivitysManager.blessTp],!this.peishiCfg)return void(this.boss_name_lab.text="暂未开启");var n,a=JsonModelManager.instance.getModelcopy()[this.peishiCfg.copyId];a.nums.indexOf(";")>=0&&(n=a.nums.split(";"));for(var i=(DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_BLESS,this.peishiCfg.id),n[DataManager.getInstance().playerManager.player.viplevel].split(",")),o=Number(i[0]),r=0;r<n.length;r++){var s=n[r].split(",");if(Number(s[0])>o){this.desc.text="达到vip"+r+GameCommon.getInstance().getVipName(r)+"可增加1次挑战次数";break}this.desc.text=""}var h="",l=DataManager.getInstance().blessManager.getPlayerBlessData(t);h=Language.instance.parseInsertText("mountequiploot_2",BlessDefine.BLESS_NAME[t]),this.desc1.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(h)),0==l.grade?this.desc2.text=Language.instance.getText("mountequiploot_3"):(h=l.grade>=BlessDefine.BLESS_DESC_MIN.length?Language.instance.parseInsertText("mountequiploot_1",BlessDefine.BLESS_NAME[t],l.grade,BlessDefine.BLESS_DESC_MIN[BlessDefine.BLESS_DESC_MIN.length-1],BlessDefine.BLESS_DESC_MAX[BlessDefine.BLESS_DESC_MIN.length-1]):1==l.grade?"当前[#FFFF00"+BlessDefine.BLESS_NAME[t]+"]为[#FFFF00]"+l.grade+"阶，掉落[#FFFF00"+BlessDefine.BLESS_DESC_MIN[l.grade-1]+"星]的装备":Language.instance.parseInsertText("mountequiploot_1",BlessDefine.BLESS_NAME[t],l.grade,BlessDefine.BLESS_DESC_MIN[l.grade-1],BlessDefine.BLESS_DESC_MAX[l.grade-1]),this.desc2.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(h)));var g=ModelManager.getInstance().getModelFigher(this.peishiCfg.bossId);for(this.boss_name_lab.text=g.name;this.boss_avatar_grp.numChildren>0;){var c=this.boss_avatar_grp.getChildAt(0);egret.is(c,"BodyAnimation")||egret.is(c,"Animation")?c.onDestroy():this.boss_avatar_grp.removeChild(c)}var p=ModelManager.getInstance().getModelFigher(this.peishiCfg.bossId),u=LoadManager.getInstance().getMonsterResUrl(p.avata,"stand",Direction.DOWN+"");this.bossAnim=new BodyAnimation(u,-1,Direction.DOWN),this.bossAnim.scaleX=2,this.bossAnim.scaleY=2,this.boss_avatar_grp.addChild(this.bossAnim),this.reward_grp.removeChildren();var d;d=GameCommon.getInstance().onParseAwardItemstr(this.peishiCfg.show);for(var r=0;r<d.length;r++){var _=d[r],m=GameCommon.getInstance().createGoodsIntance(_);this.reward_grp.addChild(m)}this.onUpdateStatus()},t.prototype.onUpdateStatus=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_BLESS,this.peishiCfg.id),t=e?e.lefttimes:0;this.challengeNum.text="剩余次数:"+t;var n=!1;n&&(this.fight_info_grp.visible=!1,this.challenge_btn.visible=!0,this.unopne_desc_lab.text="",this.challenge_btn.enabled=!1,this.challenge_btn.label=Language.instance.getText("unopen"))},t.prototype.runTimerDown=function(){},t.prototype.onChallenge=function(){this.peishiCfg&&GameFight.getInstance().onSendEnterDupMsg(this.peishiCfg.copyId)},t}(BaseTabView);__reflect(ZhuXianBossPanel.prototype,"ZhuXianBossPanel");var DomAdvancePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.animPos=new egret.Point(344,440),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DomAdvancePanelSkin},t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.setTitle("进阶"),this.basic.basic_tip_bg.source="dom_pop_bg_jpg",e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.DOMINATE_ADVANCE_MESSAGE.toString(),this.onUpgradeBack,this);for(var t,n=0;4>n;n++)t=this["item"+n],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.DOMINATE_ADVANCE_MESSAGE.toString(),this.onUpgradeBack,this);for(var t,n=0;4>n;n++)t=this["item"+n],t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this)},t.prototype.onRefresh=function(){this.onSelectItem(),this.onUpdatePower()},t.prototype.onUpdatePower=function(){this.power.power=Tool.toInt(DataManager.getInstance().dominateManager.getOneJobDomPower(0,DomUpgradePanel.index)*GameDefine.Domiante_Advance_add)},t.prototype.onUpgradeBack=function(){GameCommon.getInstance().addAnimation("进阶成功",this.animPos,this.animLayer),this.onRefresh()},t.prototype.onBtnAdvanceClick=function(e){DomUpgradePanel.index=e,this.onSelectItem()},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(GameDefine.Domiante_Advance_needID)},t.prototype.onTouchBtn=function(){GameCommon.getInstance().onCheckItemConsume(GameDefine.Domiante_Advance_needID,GameDefine.Domiante_Advance_needNum)&&DataManager.getInstance().dominateManager.onSendAdvanceMessage(0,DomUpgradePanel.index)},t.prototype.onEquipClick=function(e){var t=e.currentTarget;if(t.isNeedActivate){var n=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[t.data.slot]];if(DataManager.getInstance().playerManager.player.level<n.level)return}DomUpgradePanel.index=t.data.slot,this.onRefresh()},t.prototype.onSelectItem=function(){for(var e,t=0;4>t;t++)e=this["item"+t],e.data=this.getPlayerData().getDominateThingBySlot(t),t==DomUpgradePanel.index?(e.selected=!0,e.isNeedActivate?this.btn_upgrade.enabled=!1:this.btn_upgrade.enabled=!0):e.selected=!1;this.onShowInfo()},t.prototype.onShowInfo=function(){var e,t=this.getPlayerData().getDominateThingBySlot(DomUpgradePanel.index);
0==t.tier?(this.currentState="advance",e=15521442):(this.currentState="max",e=2680872,this.btn_upgrade.enabled=!1);var n=(DataManager.getInstance().playerManager.player,JsonModelManager.instance.getModelshanggutaozhuang()),a=n[t.slot][t.lv-1],i=n[t.slot][t.lv],o=a||i;this.currLayer.removeChildren();var r;for(var s in o.base_effect)o.base_effect[s]>0&&(r=GameCommon.getInstance().createNormalLabel(GameDefine.Domiante_Advance_needNum,e),r.text=Language.instance.getAttrName(s)+"提高"+GameDefine.Domiante_Advance_add+"倍",this.currLayer.addChild(r));var h=this.cons0;h.thing=new ThingBase(GOODS_TYPE.ITEM,GameDefine.Domiante_Advance_needID,GameDefine.Domiante_Advance_needNum),h=this.cons1,h.arr=["成功几率","100%"]},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t.prototype.onChangeRole=function(){this.onRefresh(),this.trigger()},t.prototype.trigger=function(){},t}(BaseWindowPanel);__reflect(DomAdvancePanel.prototype,"DomAdvancePanel");var DomDecomposePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DomDecomposePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("分解"),this.basic.basic_tip_bg.source="dom_pop_bg_jpg",this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_decompose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.DOMINATE_DECOMPOSE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_decompose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.DOMINATE_DECOMPOSE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e,t,n=DataManager.getInstance().bagManager.getDomInateEquip(),a=0;this.bagLayer.removeChildren();for(var i=0;i<n.length;i++)for(var o=0;o<n[i].num&&(t=new DominateInstance("select"),e=new DominateThing,e.slot=i,e.onupdate(n[i].modelId,n[i].quality,1),t.data=e,this.bagLayer.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),a++,!(a>=48));o++);this.onTouchItem(null)},t.prototype.onTouchItem=function(e){if(e){var t=e.currentTarget;t.setBtnSelectOverturn()}this.currDecompose={};for(var n=0,a=this.bagLayer.numChildren-1;a>=0;a--)t=this.bagLayer.getChildAt(a),t.getBtnSelect()&&(this.currDecompose[t.data.modelId]?this.currDecompose[t.data.modelId]+=1:this.currDecompose[t.data.modelId]=1,n++);var i=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,GameDefine.Domiante_decomposeID);this.currency.data=new CurrencyParam("可获得"+i.name,new ThingBase(GOODS_TYPE.ITEM,GameDefine.Domiante_decomposeID,n*GameDefine.Domiante_decomposeNum),!0,0)},t.prototype.onTouchBtn=function(){DataManager.getInstance().dominateManager.onSendDecomposeMessage(this.currDecompose)},t}(BaseWindowPanel);__reflect(DomDecomposePanel.prototype,"DomDecomposePanel");var DomUpgradePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.animPos=new egret.Point(344,440),n.points=RedPointManager.createPoint(6),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DomUpgradePanelSkin},t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0;for(var t=0;t<GameDefine.Dominate_Slot_Num;t++)this.points[t].register(this["item"+t],new egret.Point(66,-5),DataManager.getInstance().dominateManager,"checkJobDomUpgradePointBySlot",t);this.points[t].register(this.advance_btn,new egret.Point(70,0),DataManager.getInstance().dominateManager,"checkDomAdvancePoint"),this.points[t+1].register(this.decompose_btn,new egret.Point(70,0),DataManager.getInstance().dominateManager,"checkDecomposPoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.DOMINATE_UPGRADE_MESSAGE.toString(),this.onUpgradeBack,this);for(var t,n=0;4>n;n++)t=this["item"+n],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this);this.advance_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdvance,this),this.decompose_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDecompose,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.label_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.DOMINATE_UPGRADE_MESSAGE.toString(),this.onUpgradeBack,this);for(var t,n=0;4>n;n++)t=this["item"+n],t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this);this.advance_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdvance,this),this.decompose_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDecompose,this)},t.prototype.onRefresh=function(){this.onSelectItem(),this.onUpdatePower()},t.prototype.onUpdatePower=function(){this.power.power=DataManager.getInstance().dominateManager.getOneJobDomPower(0,t.index)},t.prototype.onUpgradeBack=function(){if(DataManager.getInstance().dominateManager.succeed){var e=this.getPlayerData().getDominateThingBySlot(t.index),n=(e.lv-1)%6-1;n>=0&&this.onShowStarAnim(n),this.animPos.x=320,this.animPos.y=205,GameCommon.getInstance().addAnimation("lianhua_1",this.animPos,this.animLayer)}else this.animPos.x=GameDefine.GAME_STAGE_WIDTH/2,this.animPos.y=350,GameCommon.getInstance().addAnimation("shibai",this.animPos,this.animLayer);this.onRefresh()},t.prototype.onShowStarAnim=function(e){this.starAnimLayer.removeChildren();var t=new eui.Image;t.source=this.img_star0.source,t.anchorOffsetX=29,t.anchorOffsetY=29,t.scaleX=1.2,t.scaleY=1.2,t.x=this.starAnimLayer.width/5*e+29,t.y=29,t.alpha=0,this.starAnimLayer.addChild(t),egret.Tween.get(t).to({scaleX:1,scaleY:1,alpha:1},500,egret.Ease.circOut).call(function(){this.starAnimLayer.removeChildren()},this)},t.prototype.onBtnAdvanceClick=function(e){t.index=e,this.onSelectItem()},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(this.current_cost_id)},t.prototype.onTouchBtn=function(){var e=this.getPlayerData().getDominateThingBySlot(t.index),n=JsonModelManager.instance.getModelshanggutaozhuang()[e.slot][e.lv];n&&GameCommon.getInstance().onCheckItemConsume(n.cost.id,n.cost.num)&&DataManager.getInstance().dominateManager.onSendUpgradeMessage(0,t.index)},t.prototype.onEquipClick=function(e){var n=e.currentTarget;if(n.isNeedActivate){var a=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[n.data.slot]];if(DataManager.getInstance().playerManager.player.level<a.level)return}t.index=n.data.slot,this.onRefresh()},t.prototype.onSelectItem=function(){for(var e,n=0;4>n;n++)e=this["item"+n],e.data=this.getPlayerData().getDominateThingBySlot(n),n==t.index?(e.selected=!0,e.isNeedActivate?(this.select_item_frame.source="bag_whiteframe_png",this.select_item_icon.source="a_"+e.data.model.icon):(this.select_item_frame.source=GameCommon.getInstance().getIconFrame(e.data.quality),this.select_item_icon.source=e.data.model.icon)):e.selected=!1;this.onShowInfo()},t.prototype.onShowInfo=function(){var e=this.getPlayerData().getDominateThingBySlot(t.index),n=(DataManager.getInstance().playerManager.player,JsonModelManager.instance.getModelshanggutaozhuang()),a=n[e.slot][e.lv-1],i=n[e.slot][e.lv],o=a||i,r=0,s="",h="";for(var l in o.base_effect)o.base_effect[l]>0&&(r=a?a.base_effect[l]:0,s=s+GameDefine.Attr_FontName[l]+"+"+r+"\n",r=i?i.base_effect[l]:0,h=h+GameDefine.Attr_FontName[l]+"+"+r+"\n");if(this.curPro.text=s,this.nextPro.text=h,0==e.lv?this.btn_upgrade.label=Language.instance.getText("activate"):this.btn_upgrade.label=Language.instance.getText("sixiangshengji"),i){var g=this.cons0;g.thing=new ThingBase(i.cost.type,i.cost.id,i.cost.num),g=this.cons1,g.arr=["成功几率",i.gailv/100+"%"],0==i.cost.num&&(this.btn_upgrade.label=Language.instance.getText("sixiangshengji")),this.current_cost_id=i.cost.id}this.currNum=(e.lv-1)%6;for(var c=0;5>c;c++)c+1<=this.currNum?this["img_star"+c].visible=!0:this["img_star"+c].visible=!1},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t.prototype.onChangeRole=function(){this.onRefresh(),this.trigger()},t.prototype.onTouchAdvance=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DomAdvancePanel")},t.prototype.onTouchDecompose=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DomDecomposePanel")},t.index=0,t}(BaseTabView);__reflect(DomUpgradePanel.prototype,"DomUpgradePanel");var DragonSoulPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DragonSoulMainSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.animPos=new egret.Point(0,310),this.explainStr=Language.instance.getText("longhundesc"),GameCommon.getInstance().addUnderlineStr(this.explain_label),this.explainStr=GameCommon.getInstance().readStringToHtml(this.explainStr),this.costItemModel=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,GameDefine.LONGHUN_GOODS_ID),GameCommon.getInstance().addUnderlineGet(this.label_get),this.points=RedPointManager.createPoint(1),this.points[0].register(this.btn_normal_random,GameDefine.RED_BTN_POS,DataManager.getInstance().dragonSoulManager,"checkRedPoint"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),this.btn_normal_random.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomNormal,this),this.btn_normal_randomTen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomNormalTen,this),this.btn_save.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSave,this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCancel,this),this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGet,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.LONGHUN_RANDOM.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.LONGHUN_CHANGE.toString(),this.update,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_normal_random.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomNormal,this),this.btn_normal_randomTen.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomNormalTen,this),this.btn_save.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSave,this),this.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCancel,this),this.label_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGet,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.LONGHUN_RANDOM.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.LONGHUN_CHANGE.toString(),this.update,this)},t.prototype.onRefresh=function(){this.updateInfo()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchExplain=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",this.explainStr))},t.prototype.onTouchBtnRandomNormalTen=function(){GameCommon.getInstance().onCheckItemConsume(GameDefine.LONGHUN_GOODS_ID,10*GameDefine.LONGHUN_GOODS_NUM)&&(DataManager.getInstance().dragonSoulManager.sendRandomMessage(t.index,!1,0),this.btn_normal_random.enabled=!1,this.btn_normal_randomTen.enabled=!1)},t.prototype.onTouchBtnRandomNormal=function(){GameCommon.getInstance().onCheckItemConsume(GameDefine.LONGHUN_GOODS_ID,GameDefine.LONGHUN_GOODS_NUM)&&(DataManager.getInstance().dragonSoulManager.sendRandomMessage(t.index,!1,0),this.btn_normal_random.enabled=!1,this.btn_normal_randomTen.enabled=!1)},t.prototype.onTouchBtnSave=function(){var e=new Message(MESSAGE_ID.LONGHUN_CHANGE);e.setByte(t.index),GameCommon.getInstance().sendMsgToServer(e),this.btn_normal_random.enabled=!0,this.btn_normal_randomTen.enabled=!0},t.prototype.onTouchBtnCancel=function(){var e=[{text:Language.instance.getText("longhunconfirm")}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,function(){this.cancel()},this)))},t.prototype.cancel=function(){var e=new Message(MESSAGE_ID.LONGHUN_CANCEL);e.setByte(t.index),GameCommon.getInstance().sendMsgToServer(e),this.update(),this.btn_normal_random.enabled=!0,this.btn_normal_randomTen.enabled=!0},t.prototype.onTouchGet=function(){GameCommon.getInstance().onShowFastBuy(GameDefine.LONGHUN_GOODS_ID,GOODS_TYPE.ITEM)},t.prototype.updateInfo=function(){var e,t=DataManager.getInstance().playerManager.player.coatardLv,n=JsonModelManager.instance.getModellonghun()[t];if(0==this.attributeLayer.numChildren)for(var a=0;a<GameDefine.LONGHUAN_ATTR.length;a++)e=new DragonSoulItem,e.update(n,GameDefine.LONGHUAN_ATTR[a],this.getPlayerData().longhunAttribute[a],DataManager.getInstance().dragonSoulManager.curRandomValue[a]),this.attributeLayer.addChild(e);else for(var a=0;a<GameDefine.LONGHUAN_ATTR.length;a++)e=this.attributeLayer.getChildAt(a),e.update(n,GameDefine.LONGHUAN_ATTR[a],this.getPlayerData().longhunAttribute[a],DataManager.getInstance().dragonSoulManager.curRandomValue[a]);this.consume_normal.setConsume(GOODS_TYPE.ITEM,GameDefine.LONGHUN_GOODS_ID,GameDefine.LONGHUN_GOODS_NUM),this.consume_ten.setConsume(GOODS_TYPE.ITEM,GameDefine.LONGHUN_GOODS_ID,10*GameDefine.LONGHUN_GOODS_NUM),null!=n&&(this.animLayer.removeChildren(),GameCommon.getInstance().addAnimation(n.effect,this.animPos,this.animLayer,-1)),DataManager.getInstance().dragonSoulManager.curRandomValue.length>0?(this.btn_cancel.visible=!0,this.btn_save.visible=!0,this.btn_normal_random.visible=!1,this.btn_normal_randomTen.visible=!1):(this.btn_cancel.visible=!1,this.btn_save.visible=!1,this.btn_normal_random.visible=!0,this.btn_normal_randomTen.visible=!0,this.btn_normal_random.enabled=!0,this.btn_normal_randomTen.enabled=!0),this.onUpdatePlayerPower()},t.prototype.update=function(){DataManager.getInstance().dragonSoulManager.clear(),this.onRefresh(),this.getPlayer().updataAttribute()},t.prototype.onUpdatePlayerPower=function(){this.power.power=DataManager.getInstance().dragonSoulManager.getLonghunPower()+""},t.index=0,t}(BaseTabView);__reflect(DragonSoulPanel.prototype,"DragonSoulPanel");var DragonSoulItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.DragonSoulItemSkin},t.prototype.onInit=function(){this.model&&this.update(this.model,this.attrtype,this.value,this.change)},t.prototype.update=function(e,t,n,a){if(!this.isLoaded)return this.model=e,this.attrtype=t,this.value=n,this.change=a,!1;this.proName.text=GameDefine.Attr_FontName[t];var i=0;null!=e&&(i=e.attrAry[t]),this.progress_cur_value.maximum=i,this.progress_cur_value.value=n,a&&0!=a?(this.attr_title_img.visible=!0,a>0?(this.attr_title_img.source="pet_upIcon_png",this.label_change_value.text="+"+a,this.label_change_value.textColor=GameDefine.Attr_After_Color):(this.label_change_value.text=""+a,this.label_change_value.textColor=16711680,this.attr_title_img.source="pet_downIcon_png")):(this.attr_title_img.visible=!1,this.label_change_value.text=""),this.model=null,this.attrtype=null,this.value=null,this.change=null},t}(BaseComp);__reflect(DragonSoulItem.prototype,"DragonSoulItem");var BlessDupView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BlessDupViewSkin},t.prototype.onInit=function(){this.explan_lab.text=Language.instance.getText("zhufuzhiwanfa"),GameCommon.getInstance().addUnderlineStr(this.goto_vip),this.onRefresh()},t.prototype.onRefresh=function(){this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_ZHUFU),this.showVipLabel()},t.prototype.onResDupInfoMsg=function(){this._dupInfo=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_ZHUFU)[0];var e=this._dupInfo.pass;this.part_num_bmplab.text=e+"";var t=JsonModelManager.instance.getModelzhufuzhifuben()[e];if(t){for(var n,a=t.numReward.split("#"),i=0;3>i;i++)if(a.length>i){this["awardgrp"+i].visible=!0,n=t.rewards[i];var o=parseInt(a[i]);this["kill_desc_lab"+i].text=Language.instance.getText("jisha",o,"zhiguai","award"),this["kill_awarditem"+i].onUpdate(n.type,n.id,0,n.quality,n.num)}else this["awardgrp"+i].visible=!1;this.onUpdateAwards(),this.onRefreshTimes()}},t.prototype.onUpdateAwards=function(){var e=JsonModelManager.instance.getModelzhufuzhifuben();this._dupInfo=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_ZHUFU)[0];var t;for(var n in e)if(t=e[n],t.id>this._dupInfo.awardIndex)break;if(t){this.frist_award_grp.visible=!0;var a=GameCommon.getInstance().onParseAwardItemstr(t.tongguan);this.first_award_item.onUpdate(a[0].type,a[0].id,0,a[0].quality,a[0].num),this._dupInfo.awardIndex<this._dupInfo.blessPassRecord?(this.award_btn.enabled=!0,this.award_btn.label=Language.instance.getText("lingqu")):(this.award_btn.enabled=!1,this.award_btn.label=Language.instance.getText("weitongguan"))}else this.frist_award_grp.visible=!1},t.prototype.onRefreshTimes=function(){this.lefttimes_bar.data=["",this._dupInfo.lefttimes,this._dupInfo.totalTimes]},t.prototype.onChallengeDup=function(e){GameFight.getInstance().onSendEnterDupMsg(this._dupInfo.id)},t.prototype.onReward=function(){var e=new Message(MESSAGE_ID.GAME_BLESSDUP_REWARD_MSG);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_BLESSDUP_REWARD_MSG.toString(),this.onUpdateAwards,this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.goto_vip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoVip,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_BLESSDUP_REWARD_MSG.toString(),this.onUpdateAwards,this),this.btn_enter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.goto_vip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoVip,this)},t.prototype.showVipLabel=function(){0!=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG].param||SDKManager.isHidePay?this.goto_vip.visible=!1:this.goto_vip.visible=!0},t.prototype.gotoVip=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_MONTHCARD)},t}(BaseTabView);__reflect(BlessDupView.prototype,"BlessDupView");var CailiaoDupView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.CailiaoDupViewSkin},t.prototype.onInit=function(){this.cailiaoItems=[];for(var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_CAILIAO),t=0;t<e.length;t++){var n=e[t],a=new CailiaoDupItem(n.subtype);this.cailiaoItems.push(a)}this.onRefresh()},t.prototype.onRefresh=function(){this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_CAILIAO)},t.prototype.onResDupInfoMsg=function(){for(var e=0;e<this.cailiaoItems.length;e++){var t=this.cailiaoItems[e];t.onUpdate()}},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this);for(var e=0;e<this.cailiaoItems.length;e++){var t=this.cailiaoItems[e];t.onShow(this.cailiaodupGroup)}GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onResDupInfoMsg,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this);for(var e=0;e<this.cailiaoItems.length;e++){var t=this.cailiaoItems[e];t.onDestory()}GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onResDupInfoMsg,this)},t}(BaseTabView);__reflect(CailiaoDupView.prototype,"CailiaoDupView");var CailiaoDupItem=function(e){function t(t){var n=e.call(this)||this;return n.subId=t,n.skinName=skins.CailiaoDupItem,n}return __extends(t,e),t.prototype.setSkinName=function(){},t.prototype.onInit=function(){this.dup_backimg.source="cailiao_itemback"+this.subId+"_jpg",this.saodang_probar.maximum=100,this.onUpdate()},t.prototype.onRegist=function(){this.btn_challenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.btn_saodang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDupSweep,this)},t.prototype.onRemove=function(){this.btn_challenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.btn_saodang.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDupSweep,this)},t.prototype.onUpdate=function(){if(this.isLoaded){this._dupinfo=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_CAILIAO,this.subId);var e=(this._dupinfo.dupModel,this._dupinfo.nextModel);this.consume_price_label.text=""+this._dupinfo.dupModel.price,this.nameDiff.text=this._dupinfo.dupModel.name,this.drop_goods.visible=!0;var t=this._dupinfo.dupModel.rewards[0];if(t?this.drop_goods.onUpdate(t.type,t.id,0,t.quality,t.num):this.drop_goods.visible=!1,this.drop_goods.currentState="normal",e&&this._dupinfo.diffcult>0){var n=Language.instance.getText("coatard_level"+e.lvlimit,"jingjie"),a="[#FFFF00"+n+"]"+Language.instance.getText("kaiqixiayinandu");this.dup_limit.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml(a)),this.tisheng_desc_lab.text=Language.instance.getText("chanchutisheng")}else this.dup_limit.text="",this.tisheng_desc_lab.text="";var i=!1;if(this._dupinfo.cailiaoPassRecord<=0&&this._dupinfo.lefttimes>0){this.btn_saodang.visible=!1,this.btn_challenge.visible=this._dupinfo.diffcult>0;var o=this._dupinfo.getOpenCondition();0==this._dupinfo.diffcult||o?(this.unopen_grp.visible=!0,this.times_grp.visible=!1,this.unopen_des_lab.text=o):(this.unopen_grp.visible=!1,this.times_grp.visible=!0),this.saodang_consume.visible=!1,this.dup_num.text=this._dupinfo.lefttimes+"",this.dup_numdesc.text=Language.instance.getText("shengyucishu","："),i=!0}else this.times_grp.visible=!0,this.btn_challenge.visible=!1,this.unopen_grp.visible=!1,this.saodang_consume.visible=this._dupinfo.leftSweepNum>0,this.saodang_probar.visible=this.saodang_consume.visible&&this._isSweep,this.btn_saodang.visible=!this.saodang_probar.visible,this.btn_saodang.enabled=this._dupinfo.leftSweepNum>0,this.btn_saodang.label="扫  荡",this._dupinfo.lefttimes>0?(this.saodang_probar.visible=this._isSweep,this.btn_saodang.label="快速挑战",this.saodang_consume.visible=!1,this.dup_numdesc.text=Language.instance.getText("mianfeisaodang","："),this.dup_num.text=this._dupinfo.lefttimes+""):this._dupinfo.leftSweepNum>0?(this.dup_numdesc.text=Language.instance.getText("jinrishengyusaodang","："),this.dup_num.text=this._dupinfo.leftSweepNum+""):(this.dup_numdesc.text=Language.instance.getText("jinrisaodangyiyongwan"),this.dup_num.text="")}},t.prototype.onDupSweep=function(){return DataManager.getInstance().playerManager.player.gold<this._dupinfo.dupModel.price&&this._dupinfo.lefttimes<=0?void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2)):(this._isSweep=!0,this.saodang_probar.visible=!0,this.btn_saodang.visible=!1,this.saodang_probar.slideDuration=0,this.saodang_probar.value=0,this.saodang_probar.slideDuration=2e3,this.saodang_probar.value=100,this.saodang_probar.labelFunction=function(e,t){return Language.instance.getText("saodangzhong")},void Tool.callbackTime(this.onCompleteSweep,this,2e3))},t.prototype.onChallengeDup=function(e){GameFight.getInstance().onSendEnterDupMsg(this.dupinfo.id)},t.prototype.onCompleteSweep=function(){this._isSweep=!1;var e=new Message(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE);e.setByte(this.dupinfo.id),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"dupinfo",{get:function(){return this._dupinfo},enumerable:!0,configurable:!0}),t}(BaseComp);__reflect(CailiaoDupItem.prototype,"CailiaoDupItem");var ChallengeDupView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChallengeDupViewSkin},t.prototype.onInit=function(){this.dup_desc_lab.text=Language.instance.getText("tiaozhanfuben"),this.zhuxianModels=JsonModelManager.instance.getModelzhuxiantai()},t.prototype.onRefresh=function(){},t.prototype.onResDupInfoMsg=function(){var e;this.challengeInfo=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_CHALLENGE)[0];var t=this.challengeInfo.pass<1?1:this.challengeInfo.pass;e=this.zhuxianModels[t],this.name_label.text=e.id+"",this.monster_group.removeChildren();var n=GameCommon.getInstance().getMonsterBody(null,e.fightId,Direction.DOWN,"stand");this.monster_group.addChild(n),this.award_group.removeChildren();for(var a=e.rewards.length>2?2:e.rewards.length,i=0;a>i;i++){var o=e.rewards[i],r=GameCommon.getInstance().createGoodsIntance(o);r.onUpdate(o.type,o.id,0,o.quality,o.num),this.award_group.addChild(r)}var s;for(a=t;e;){if(e=this.zhuxianModels[a],!e){a=-1;break}for(var h in e.rewards)if(s=e.rewards[h],s.id==GoodsDefine.ITEM_ID_CZSP)break;a++}},t.prototype.onRegist=function(){this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterDup,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenClick,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this),this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_CHALLENGE)},t.prototype.onRemove=function(){this.btn_enter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterDup,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenClick,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this)},t.prototype.onEnterDup=function(){this.challengeInfo&&GameFight.getInstance().onSendEnterDupMsg(this.challengeInfo.id)},t.prototype.onSendTopMsg=function(){var e=new Message(MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE);e.setByte(TopRankManager.RANK_SIMPLE_TYPE_DEKARON),e.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.strengthenClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_CHALLENGE_PASS))},t}(BaseTabView);__reflect(ChallengeDupView.prototype,"ChallengeDupView");var DupLosePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.allbianqiangBtns=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DupLosePanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.banGo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goRecharge,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.addGotypeEventListener()}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.banGo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goRecharge,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.removeGotypeEventListener()}},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameFight.getInstance().fightScene.onQuitScene()},t.prototype.goRecharge=function(){0==DataManager.getInstance().rechargeManager.firstCharge?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FirstChargePanel"):DataManager.getInstance().newactivitysManager.chargeMoneyNum<188&&DataManager.getInstance().newactivitysManager.chargeMoneyNum>=0?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_CHONGBANG):GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),0==DataManager.getInstance().rechargeManager.firstCharge?(this.banImg.source="result_desc1_png",this.imgDi.source="result_Img1_png"):DataManager.getInstance().newactivitysManager.chargeMoneyNum<188&&DataManager.getInstance().newactivitysManager.chargeMoneyNum>=0?(this.banImg.source="result_desc2_png",this.imgDi.source="result_Img2_png"):(this.banImg.source="result_vipDesc"+this.getPlayerData().viplevel+"_png",this.imgDi.source="result_Img3_png"),this._showleftTime=6,Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onShowWithParam=function(t){this.dupInfo=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label="离开("+this._showleftTime+")")},t}(BaseWindowPanel);__reflect(DupLosePanel.prototype,"DupLosePanel");var DupPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_DUP_CAILIAO,n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="CailiaoDupView",n.btnRes="材料",n.funcID=FUN_TYPE.FUN_DUP_CAILIAO,n.subFuncIDs=[FUN_TYPE.FUN_BAOSHIFUBEN,FUN_TYPE.FUN_JINGMAIFUBEN,FUN_TYPE.FUN_CUILIANFUBEN,FUN_TYPE.FUN_CHONGFUBEN],n.redP=this.points[0],n.redP.addTriggerFuc(FunDefine,"DupCailiaoHasTimes"),t.push(n);var n=new RegisterSystemParam;n.sysName="ChallengeDupView",n.btnRes="挑战",n.funcID=FUN_TYPE.FUN_DUP_TIAOZHAN,n.redP=this.points[1],n.redP.addTriggerFuc(FunDefine,"DupChallengeHasTimes"),t.push(n);var n=new RegisterSystemParam;n.sysName="BlessDupView",n.btnRes="法宝",n.funcID=FUN_TYPE.FUN_DUP_ZHUFU,n.redP=this.points[2],n.redP.addTriggerFuc(FunDefine,"BlessDupRedPoint"),t.push(n);var n=new RegisterSystemParam;n.sysName="TeamDupView",n.btnRes="组队",n.funcID=FUN_TYPE.FUN_DUP_ZUDUI,n.redP=this.points[3],n.redP.addTriggerFuc(FunDefine,"getDupHasTimes",DUP_TYPE.DUP_TEAM),t.push(n);var n=new RegisterSystemParam;n.sysName="SixiangDupView",n.btnRes="四象",n.funcID=FUN_TYPE.FUN_DUP_SIXIANG,n.redP=this.points[4],n.redP.addTriggerFuc(FunDefine,"SixiangDupRedPoint"),t.push(n),this.registerPage(t,"dupGrp",GameDefine.RED_TAB_POS),this.sysQueues=t,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("材料本");break;
case 1:this.setTitle("挑战本");break;case 2:this.setTitle("法宝本");break;case 3:this.setTitle("组队本");break;case 4:this.setTitle("四象本")}e.prototype.onRefresh.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRequestDupInofMsg=function(e){DataManager.getInstance().dupManager.onRequestDupInofMsg(e)},t}(BaseSystemPanel);__reflect(DupPanel.prototype,"DupPanel");var DupWinPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.btnLabel="",n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DupWinPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSure,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCancel,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSure,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCancel,this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.award_Scroller.verticalScrollBar.autoVisibility=!1,this.award_Scroller.verticalScrollBar.visible=!1,this.onRefresh()},t.prototype.onShowAnimFinish=function(t){e.prototype.onShowWithParam.call(this,t)},t.prototype.onShowWithParam=function(t){if(this.isloadComp){this.result_des_lab.text="",this.special_des_lab.text="";for(var n=this.award_groud.numChildren-1;n>=0;n--){var a=this.award_groud.getChildAt(n);egret.Tween.removeTweens(a),this.award_groud.removeChild(a),a=null}}this.dupParam=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this._showleftTime=this.dupParam.autoCloseTime,this.dupParam.dupinfo&&GameFight.getInstance().canContiuneDup(this.dupParam.dupinfo.id)?(this.btnLabel=Language.instance.getText("continue"),this.btnbar_grp.addChild(this.btn_back)):(this.btnLabel=Language.instance.getText("sure"),this.btn_back.parent&&this.btn_back.parent.removeChild(this.btn_back)),this.dupParam.dupinfo?this.win_title.source="fight_win_title1_png":this.win_title.source="fight_win_title2_png",GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.ESCORT&&(this.resule_title1.source="text_bencizhanbao_png",this.resule_title3.source="text_teshushuoming_png"),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.ALLPEOPLE_BOSS&&(this.resule_title1.source="text_shanghaidiyi_png",this.resule_title3.source="text_teshushuoming_png"),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.XUEZHAN_BOSS||GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.VIP_BOSS?(this.resule_title1.source="text_benciguishu_png",this.resule_title3.source="text_teshushuoming_png"):(this.resule_title1.source="text_bencizhanbao_png",this.resule_title3.source="text_teshujiangli_png"),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=""+this.btnLabel,this.anim_grp1.x=550,this.anim_grp1.alpha=0,this.result_des_lab.textFlow=(new egret.HtmlTextParser).parser(this.dupParam.resultParam),egret.Tween.get(this.anim_grp1).to({x:90,alpha:1},1e3,egret.Ease.cubicIn),this.anim_grp2.x=550,this.anim_grp2.alpha=0,egret.Tween.get(this.anim_grp2).to({x:550},500).to({x:90,alpha:1},1e3,egret.Ease.cubicIn).call(function(){this.dupParam.dropList.length>0&&this.onPlayAwardAnim()},this),this.anim_grp3.x=550,this.anim_grp3.alpha=0,this.award_Scroller.height=213,this.dupParam.specialDesc?(this.special_des_lab.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml(this.dupParam.specialDesc)),egret.Tween.get(this.anim_grp3).to({x:550},1e3).to({x:90,alpha:1},1e3,egret.Ease.cubicIn)):this.award_Scroller.height=310},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onTouchSure()):void(this.btn_sure.label=this.btnLabel+"("+this._showleftTime+")")},t.prototype.onPlayAwardAnim=function(){for(var e=0;e<this.dupParam.dropList.length;e++){var t=this.dupParam.dropList[e],n=GameCommon.getInstance().createGoodsIntance(t),a=new eui.Group;a.width=90,a.height=110,a.scaleX=.8,a.scaleY=.8,a.addChild(n),n.y=200,n.alpha=0,this.award_groud.addChild(a),egret.Tween.get(n).to({y:200},100*e).to({alpha:1,y:0},300,egret.Ease.sineInOut)}},t.prototype.onTouchSure=function(){this.onHide(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3)},t.prototype.onTouchCancel=function(){this.onHide(),GameFight.getInstance().fightScene.onQuitScene()},t}(BaseWindowPanel);__reflect(DupWinPanel.prototype,"DupWinPanel");var SixiangDupResultPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isopen=!1,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SixiangDupResultSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)},t.prototype.onShowWithParam=function(t){this.dupParam=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DupWinPanel",this.dupParam))},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("结算"),this.onRefresh()},t.prototype.onRefresh=function(){this.isopen=!1,this.currentState="unopen",this.award_grp.removeChildren(),this._showleftTime=this.dupParam.autoCloseTime,this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=Language.instance.getText("sure")},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?void this.onTouchBtn():void(this.btn_sure.label=Language.instance.getText(this.isopen?"sure":"open")+(this._showleftTime+"S"))},t.prototype.onTouchBtn=function(){this.isopen?(Tool.removeTimer(this.onCloseTimedown,this,1e3),this.onTouchCloseBtn()):(this.isopen=!0,this.currentState="open",this.onPlayAwardAnim(),this._showleftTime=this.dupParam.autoCloseTime,this.onCloseTimedown())},t.prototype.onPlayAwardAnim=function(){this.award_grp.alpha=0,this.award_grp.y=500;var e=this.dupParam.dropList[this.dupParam.dropList.length-1];if(e.num>0){var t=GameCommon.getInstance().createGoodsIntance(e);this.award_grp.addChild(t)}egret.Tween.get(this.award_grp).to({alpha:1,y:290},300,egret.Ease.sineInOut)},t}(BaseWindowPanel);__reflect(SixiangDupResultPanel.prototype,"SixiangDupResultPanel");var DupWinParam=function(){function e(){this.dropList=[],this.autoCloseTime=11}return e}();__reflect(DupWinParam.prototype,"DupWinParam");var SixiangDupView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SixiangDupViewSkin},t.prototype.onInit=function(){for(var e=0;e<DupDefine.SixiangDup_Drops_Id.length;e++){var t=GameCommon.getInstance().createGoodsIntance(new AwardItem(GOODS_TYPE.ITEM,DupDefine.SixiangDup_Drops_Id[e]));this.reward_grp.addChild(t)}JsonModelManager.instance.getModelsixiangfuben(),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(GameCommon.getInstance().readStringToHtml(Language.instance.getText("sixiangwanfa"))),GameCommon.getInstance().addUnderlineStr(this.goto_vip),this.points[0].register(this.reward_btn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"checkPassAwardPoint"),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestDupInfo(),this.showVipLabel()},t.prototype.onReciveMsg=function(){this.onUpdateAwards(),this.onUpdateInfo()},t.prototype.onRequestDupInfo=function(){this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_SIXIANG)},t.prototype.onUpdateInfo=function(){var e=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0];this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes],this.challenge_btn.enabled=e.lefttimes>0,this.reward_btn.enabled=this.currmodel.id<=e.pass,this.history_max_lab.text=Language.instance.parseInsertText("sixiang_lishizuigao",e.pass-1)},t.prototype.onUpdateAwards=function(){for(var e=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0],t=ModelManager.getInstance().getModelLength("sixiangfuben"),n=e.awardIndex+1;t>=n;n++){var a=JsonModelManager.instance.getModelsixiangfuben()[n];if(a.firstRewards){this.currmodel=a;break}}if(this.currmodel){var i=GameCommon.getInstance().onParseAwardItemstr(this.currmodel.firstRewards),o=i[0];this.award_item.visible=!0,this.award_item.onUpdate(o.type,o.id,0,o.quality,o.num)}else this.award_item.visible=!1},t.prototype.onChallengeDup=function(e){var t=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0];GameFight.getInstance().onSendEnterDupMsg(t.id)},t.prototype.onReward=function(){var e=new Message(MESSAGE_ID.GAME_SIXIANG_REWARD_MSG);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_SIXIANG_REWARD_MSG.toString(),this.onReciveMsg,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.goto_vip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoVip,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onUpdateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_SIXIANG_REWARD_MSG.toString(),this.onUpdateAwards,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.reward_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.goto_vip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoVip,this)},Object.defineProperty(t.prototype,"dupManager",{get:function(){return DataManager.getInstance().dupManager},enumerable:!0,configurable:!0}),t.prototype.showVipLabel=function(){0!=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG].param||SDKManager.isHidePay?this.goto_vip.visible=!1:this.goto_vip.visible=!0},t.prototype.gotoVip=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_MONTHCARD)},t.prototype.checkPassAwardPoint=function(){var e=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_SIXIANG)[0];return this.currmodel&&e&&this.currmodel.id<=e.pass?!0:!1},t}(BaseTabView);__reflect(SixiangDupView.prototype,"SixiangDupView");var TeamDupReadyPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.readytime=0,n.canEnter=!1,n.TEAM_MAX=3,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TeamDupReadySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),48==GameFight.getInstance().teamdupRoomDupId||49==GameFight.getInstance().teamdupRoomDupId?(this.TEAM_MAX=2,this.currentState="marry"):(this.TEAM_MAX=3,this.currentState="normal")},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.canEnter=!1,GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TEAMDUP_READYINFO_MESSAGE.toString(),this.onReciveTeaminfoMsg,this),this.quit_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitTeam,this),Tool.addTimer(this.onTimeDown,this,1e3),GameFight.getInstance().isteamdupReady=!0},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TEAMDUP_READYINFO_MESSAGE.toString(),this.onReciveTeaminfoMsg,this),this.quit_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitTeam,this),Tool.removeTimer(this.onTimeDown,this,1e3),GameFight.getInstance().isteamdupReady=!1},t.prototype.onTimeDown=function(){this.canEnter?this.onEnterDup():this.onsynchroteaminfo();Math.max(0,Math.round(this.readytime-egret.getTimer()/1e3));this.ready_time_lab.text=Language.instance.parseInsertText("zuduifuben_txt_1",this.readytime)},t.prototype.onsynchroteaminfo=function(){var e=new Message(MESSAGE_ID.TEAMDUP_READYINFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onReciveTeaminfoMsg=function(e){var t=e.message,n=t.getByte();if(0>n)return void this.onTouchCloseBtn();this.readytime=Math.max(0,n);for(var a=t.getByte(),i=0;i<this.TEAM_MAX;i++)if(a>i){var o=new SimplePlayerData;o.parseMsg(t),this["playerHead"+i].setHead(o.headindex,o.headFrame),this["team_name_lab"+i].text=GameCommon.getInstance().getNickname(o.name),this["team_power_lab"+i].text=Language.instance.getText("power")+":"+o.fightvalue}else this["playerHead"+i].onClear(),this["team_name_lab"+i].text="",this["team_power_lab"+i].text="";this.canEnter=0==this.readytime||a>=this.TEAM_MAX,this.canEnter?this.ready_time_lab.text=Language.instance.getText("zuduifuben_txt_2"):this.ready_time_lab.text=Language.instance.parseInsertText("zuduifuben_txt_1",this.readytime)},t.prototype.onEnterDup=function(){GameFight.getInstance().onSendEnterDupMsg(GameFight.getInstance().teamdupRoomDupId),GameFight.getInstance().teamdupRoomDupId=0,this.onHide()},t.prototype.onQuitTeam=function(){var e=new Message(MESSAGE_ID.TEAMDUP_LEAVETEAM_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t}(BaseWindowPanel);__reflect(TeamDupReadyPanel.prototype,"TeamDupReadyPanel");var TeamDupView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TeamDupViewSkin},t.prototype.onInit=function(){this.dup_desc_lab.text=Language.instance.getText("zuduifuben_wanfa"),this.items=[],this.updateItemList(),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestDupInfo()},t.prototype.onReciveMsg=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_TEAM,1),t=JsonModelManager.instance.getModelzuduifuben()[e.id],n=e.nextModel;if(e.teamPassRecord>0&&5!=e.lefttimes?this.challenge_btn.label="扫 荡":this.challenge_btn.label="开启组队",n){var a=Language.instance.getText("coatard_level"+n.lvlimit,"jingjie");"[#FFFF00"+a+"]"+Language.instance.getText("kaiqixiayinandu")}if(t){this.reward_grp.removeChildren();for(var i=0;i<t.rewards.length;i++){var o=new GoodsInstance,r=t.rewards[i];o.onUpdate(r.type,r.id,0,r.quality,r.num),this.reward_grp.addChild(o)}}var s=GameCommon.parseAwardItem(t.viprewards);this.mvp_award_item.onUpdate(s.type,s.id,0,s.quality,s.num),this.challenge_btn.enabled=e.lefttimes>0,this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes],this.updateItemList(e.diffcult-1)},t.prototype.updateItemList=function(e){void 0===e&&(e=-1);for(var t=["21","22","23","24"],n=JsonModelManager.instance.getModelzuduifuben(),a=0;4>a;++a)this.items[a]||(this.items[a]=new TeamDupInfoItem(n[t[a]],a),this.groupItems.addChild(this.items[a])),this.items[a].data=e},t.prototype.onRefreshSweep=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_TEAM,1);this.challenge_btn.enabled=e.lefttimes>0,this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes]},t.prototype.onRequestDupInfo=function(){this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_TEAM)},t.prototype.onChallengeDup=function(e){var t=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_TEAM)[0];if(t.teamPassRecord>0&&5!=t.lefttimes){if(t.lefttimes<=0)return void GameCommon.getInstance().addAlert("error_tips_6");if(!GameFight.getInstance().checkBagIsFull()){var n=new Message(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE);return n.setByte(t.dupModel.id),void GameCommon.getInstance().sendMsgToServer(n)}}GameFight.getInstance().onSendCreateTeamDupRoomMsg(t.dupModel.id)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this)},Object.defineProperty(t.prototype,"dupManager",{get:function(){return DataManager.getInstance().dupManager},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(TeamDupView.prototype,"TeamDupView");var TeamDupInfoItem=function(e){function t(t,n){var a=e.call(this)||this;return a.model=t,a.idx=n,a}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.SamsaraBossItemSkin},t.prototype.dataChanged=function(){var e=this._data;this.looprank_label.visible=!1,this.boss_itemcell_img.source="samsara_item"+this.idx+"_open_png",this.label_name.text=this.model.name,this.awardicon.visible=!1;var t=this.idx==e;if(this.setLock(!t),t)this.state_lab.text=Language.instance.getText("tiaozhanzhong");else if(this.idx<e)this.state_lab.text="已完成";else{var n=JsonModelManager.instance.getModelcopy()[this.model.id];this.state_lab.text=Language.instance.getText("coatard_level"+n.lvlimit,"open")}},t.prototype.setLock=function(e){this.locked_bg.visible=e,this.imgFrame.source=e?"samsara_item_frame_gray_png":"samsara_item_frame_png",this.imgTitleBG.source=e?"samsara_item_title_bg_gray_png":"samsara_item_title_bg_png",this.imgStateBG.source=e?"samsara_item_wkq_gray_png":"samsara_item_wkq_png"},t}(BaseComp);__reflect(TeamDupInfoItem.prototype,"TeamDupInfoItem");var XuezhanBuffPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.Buff_Consume_List=[3,6,9],n.currSeletedIndex=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this);for(var t=0;t<this.Buff_Consume_List.length;t++){var n=this["buff_item"+t];n.consumestar=this.Buff_Consume_List[t],n.name=t+""}this.onRefresh()},t.prototype.onRefresh=function(){if(this.currSeletedIndex>0)var e=this["buff_item"+(this.currSeletedIndex-1)];this.currSeletedIndex=0;var t=DataManager.getInstance().dupManager.xuezhanInfo;this.curr_star_num.text=""+t.xuezhanStar,this.xuezhan_buff_attr.text="";for(var n=0,a=0;a<t.attrAddRates.length;a++){var i=t.attrAddRates[a];i>0&&(a>ATTR_TYPE.MAGICDEF?(n+=1,5==n?this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[a]+"+"+i+"   \n":this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[a]+"+"+i+"  "):(n+=1,this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[a]+"+"+i+"%  "))}for(var a=0;a<t.selectbuffList.length;a++){var e=this["buff_item"+a];e.data=t.selectbuffList[a]}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.Buff_Consume_List.length;t++){var n=this["buff_item"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBuffItem,this)}},t.prototype.onTouchBuffItem=function(e){var t=e.currentTarget,n=parseInt(t.name);n+1!=this.currSeletedIndex&&(this.currSeletedIndex>0,this.currSeletedIndex=n+1);var a=DataManager.getInstance().dupManager.xuezhanInfo;if(a.xuezhanStar<this.Buff_Consume_List[this.currSeletedIndex-1])return void GameCommon.getInstance().addAlert("星数不足无法选择此BUFF");var i=new Message(MESSAGE_ID.XUEZHAN_BUFF_MESSAGE);i.setByte(this.currSeletedIndex),GameCommon.getInstance().sendMsgToServer(i),this.onHide()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.Buff_Consume_List.length;t++){var n=this["buff_item"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBuffItem,this)}},t.prototype.onHide=function(){return 0==this.currSeletedIndex?void GameCommon.getInstance().addAlert("请选择一个加成属性"):void e.prototype.onHide.call(this)},t.prototype.onSkinName=function(){this.skinName=skins.XuezhanBuffPanelSkin},t}(BaseWindowPanel);__reflect(XuezhanBuffPanel.prototype,"XuezhanBuffPanel");var XuezhanBuffItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){Tool.isNumber(this._consumeNum)&&this.consumestar(this._consumeNum)},Object.defineProperty(t.prototype,"consumestar",{set:function(e){this._consumeNum=e,this.isLoaded&&(this.consume_num_label.text="X"+e)},enumerable:!0,configurable:!0}),t.prototype.dataChanged=function(){var e=this._data,t=JsonModelManager.instance.getModeldifubuff()[e],n=String(t.effect).split(","),a=parseInt(n[0]),i=parseInt(n[1]);this.buff_txt_icon.source="difu_buff"+a+"_png",a>ATTR_TYPE.MAGICDEF?this.attr_desc_label.text=i+"":this.attr_desc_label.text=i+"%",this.proName.text=t.name+"+"},t}(BaseComp);__reflect(XuezhanBuffItem.prototype,"XuezhanBuffItem");var XuezhanView=function(e){function t(t){var n=e.call(this,t)||this;return n.Xuezhan_Difficulty=["easy","normal","hard"],n.AwardMaxNum=2,n.baoxiangStatus=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XueZhanDupPanelSkin},t.prototype.onInit=function(){for(var e=0;e<this.Xuezhan_Difficulty.length;e++){this.Xuezhan_Difficulty[e]}this.xuezhanItemPos=[];for(var e=0;e<GameDefine.Xuezhan_LayerWaveNum;e++);},t.prototype.onRefresh=function(){this.onInit();var e=DataManager.getInstance().dupManager.xuezhanInfo;this.currLayerNum!=DataManager.getInstance().dupManager.xuezhanLayerNum;this.currLayerNum=DataManager.getInstance().dupManager.xuezhanLayerNum,this.xuezhan_layernum.text="第"+this.currLayerNum+"层";for(var t=0,n=Math.max(1,(this.currLayerNum-1)*GameDefine.Xuezhan_LayerWaveNum+1),a=n;a<n+GameDefine.Xuezhan_LayerWaveNum;a++)this.onupdateaward([],[]),t++;this.xuezhan_lefttimes.text="剩余复活次数："+e.reviveNum,this.updateAwardBoxStatus(),this.onRegist()},t.prototype.updateAwardBoxStatus=function(){var e=DataManager.getInstance().dupManager.xuezhanInfo;e.isRewardBox?this.baoxiangStatus=1:e.isSelectBuff?this.baoxiangStatus=2:this.baoxiangStatus=0;for(var t=0;t<this.Xuezhan_Difficulty.length;t++){this.Xuezhan_Difficulty[t]}if(2==this.baoxiangStatus)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XuezhanBuffPanel");else if(1==this.baoxiangStatus){var n=new AwardNoticeParam;n.desc="恭喜通关无量试练第"+this.currLayerNum+"层",n.titleSource="",n.btnlabel="领取",n.callFunc=this.onTouchBaoxiang,n.callObj=this,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",n))}},t.prototype.onupdateaward=function(e,t){for(var n=0;n<this.Xuezhan_Difficulty.length;n++)for(var a=(this.Xuezhan_Difficulty[n],e.length>n?e[n]:null),i=1;i<=this.AwardMaxNum;i++)if(a&&a.length>=i){var o=a[i-1];GameCommon.getInstance().getThingModel(o.type,o.id)}},t.prototype.onRegist=function(){for(var e=0;e<this.Xuezhan_Difficulty.length;e++){this.Xuezhan_Difficulty[e]}this.btnSweep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodangHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE.toString(),this.updateAwardBoxStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_BUFF_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE.toString(),this.onResDupSweepMsg,this)},t.prototype.onRemove=function(){for(var e=0;e<this.Xuezhan_Difficulty.length;e++){this.Xuezhan_Difficulty[e]}this.btnSweep.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodangHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE.toString(),this.updateAwardBoxStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_BUFF_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE.toString(),this.onResDupSweepMsg,this)},t.prototype.onChallengeHandler=function(e){},t.prototype.onTouchBaoxiang=function(){if(0==this.baoxiangStatus)this.onShowPassAwardPanel();else if(2==this.baoxiangStatus)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XuezhanBuffPanel");else if(1==this.baoxiangStatus){var e=new Message(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onSaodangHandler=function(e){for(var t=0;t<GameDefine.Xuezhan_LayerWaveNum;t++);var n=new Message(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE);GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onShopHandler=function(e){var t=[2];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ShopPanel",t))},t.prototype.onShowPassAwardPanel=function(){var e=new AwardNoticeParam;e.desc="通关本层即可获得如下奖励",e.titleSource="jiangli_title_txt_png",e.itemAwards=[],e.autocloseTime=0;this.currLayerNum*GameDefine.Xuezhan_LayerWaveNum;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",e))},t.prototype.onResDupSweepMsg=function(e){void 0===e&&(e=null);var t=new AwardNoticeParam;t.desc="扫荡成功获得以下奖励",t.titleSource="",t.itemAwards=[],t.callFunc=this.onRefresh,t.callObj=this;this.currLayerNum*GameDefine.Xuezhan_LayerWaveNum;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",t))},t}(BaseTabView);__reflect(XuezhanView.prototype,"XuezhanView");var YeWaiChallengePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.YeWaiChallengeSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_YEWAI_FIGHT_UPDATE,this.onRefreshWave,this),GameDispatcher.getInstance().addEventListener(GameEvent.SCENE_ENTER_SUCCESS,this.onHide,this),this.btnChallenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),this.chakan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChaKan,this),this.getAward.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowXianfeng,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE.toString(),this.onShowInfo,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_YEWAI_FIGHT_UPDATE,this.onRefreshWave,this),GameDispatcher.getInstance().removeEventListener(GameEvent.SCENE_ENTER_SUCCESS,this.onHide,this),this.btnChallenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),this.chakan.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChaKan,this),this.getAward.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowXianfeng,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE.toString(),this.onShowInfo,this)},t.prototype.onChaKan=function(){var e=new Message(MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE);e.setByte(TopRankManager.RANK_SIMPLE_TYPE_MAPSTAGE),e.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onChallenge=function(){var e=GameFight.getInstance().fightScene.rushData.progress,t=Math.min(e,GameFight.getInstance().yewai_batch);return e>t?void GameCommon.getInstance().addAlert("error_tips_10004"):void(GameFight.getInstance().checkBagIsFull()||(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_GOTO_BOSS_WAVE)),this.onHide()))},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.basic.label_title.text="野外关卡",this.onRefresh()},t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.GAME_TOPRANK_SIMPLE_MESSAGE);e.setByte(TopRankManager.RANK_SIMPLE_TYPE_MAPSTAGE),e.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(e),this.reward_grp.removeChildren();for(var t=0;3>t;t++){var n=new AwardItem;n.type=GOODS_TYPE.ITEM,n.id=557+t;var a=new GoodsInstance;a.onUpdate(GOODS_TYPE.ITEM,557+t),this.reward_grp.addChild(a)}var a=new GoodsInstance;a.onUpdate(2,1),this.reward_grp.addChild(a);var a=new GoodsInstance;a.onUpdate(GOODS_TYPE.YUELI,0),this.reward_grp.addChild(a);var i,o=JsonModelManager.instance.getModelguanqiakaiqi();for(var r in o)if(o[r].guanqia>GameFight.getInstance().yewai_waveIndex){i=o[r];break}i?this.openFunImg.source=i.png:this.openFunImg.source="",this.onRefreshWave()},t.prototype.onShowXianfeng=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_XIANFENG)},t.prototype.onShowInfo=function(){this.passNum.text="第"+GameFight.getInstance().yewai_waveIndex+"关",this.yewai_exp_award.text=720*GameFight.getInstance().getYewaiExp()+"/时",this.yewai_gold_award.text=720*GameFight.getInstance().getYewaiGold()+"/时";var e,t=JsonModelManager.instance.getModelguanqiaxianfeng();for(var n in t){var a=t[n];if(a.mapId>GameFight.getInstance().yewai_waveIndex){e=a;break}}if(e){this.curPass.text=e.mapId+"关豪礼";var i=e.rewards[0];this.awardItem.onUpdate(i.type,i.id)}else this.awardItem.visible=!1,this.curPass.text="奖励已全部领取",this.curPass.size=16;for(var o=DataManager.getInstance().topRankManager.mapStageList,r=0;3>r;r++)o[r]?(this["name"+(r+1)].text=o[r].name,this["dupNum"+(r+1)].text=o[r].value):(this["name"+(r+1)].text="",this["dupNum"+(r+1)].text="")},t.prototype.onRefreshWave=function(){var e=GameFight.getInstance().fightScene.rushData.progress,t=Math.min(e,GameFight.getInstance().yewai_batch);e>t?(this.btnChallenge.enabled=!1,this.btnChallenge.label="还差"+(e-t)+"波"):(this.btnChallenge.enabled=!0,this.btnChallenge.label="挑 战")},t}(BaseWindowPanel);__reflect(YeWaiChallengePanel.prototype,"YeWaiChallengePanel");var YewaiFieldWinPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.YewaiFieldWinSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSure,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSure,this)},t.prototype.onShowWithParam=function(t){this.scenetype=GameFight.getInstance().fightsceneTpye,t&&(this.param=t,e.prototype.onShow.call(this))},t.prototype.onTouchSure=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW)),this.onHide()},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.award_groud.touchEnabled=!1,this.award_groud.touchChildren=!1,this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.param&&this.param.length>0&&this.onPlayAwardAnim(),this._showleftTime=6,this.onCloseTimedown(),Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onTouchSure()):void(this.btn_sure.label=Language.instance.getText("sure")+("("+this._showleftTime+")"))},t.prototype.onPlayAwardAnim=function(){for(var e=this.award_groud.numChildren-1;e>=0;e--){var t=this.award_groud.getChildAt(e);egret.Tween.removeTweens(t),this.award_groud.removeChild(t),t=null}for(var e=0;e<this.param.length;e++){var n=this.param[e],a=GameCommon.getInstance().createGoodsIntance(n),i=new eui.Group;
i.width=90,i.height=110,i.scaleX=.8,i.scaleY=.8,i.addChild(a),a.y=200,a.alpha=0,this.award_groud.addChild(i),egret.Tween.get(a).to({y:200},100*e).to({alpha:1,y:0},300,egret.Ease.sineInOut)}},t}(BaseWindowPanel);__reflect(YewaiFieldWinPanel.prototype,"YewaiFieldWinPanel");var CelestialPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.roleIndex=0,n.index=2*GameDefine.Equip_Slot_Num,n.points=RedPointManager.createPoint(7),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.CelestialPanelSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineStr(this.label_get,"分解获得"),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.ani?this.ani.onPlay():(this.ani=new Animation("shenqi1",-1,!1),this.ani.x=this.aniLayer.width/2,this.ani.y=this.aniLayer.height/2+this.aniLayer.height/4,this.aniLayer.addChild(this.ani));for(var t=0;t<GameDefine.CELESTIAL_EQUIP_SLOTS.length;t++){var n=this["item"+GameDefine.CELESTIAL_EQUIP_SLOTS[t]];n.pos=2*MASTER_EQUIP_TYPE.SIZE+t,this.points[t].register(this["item"+GameDefine.CELESTIAL_EQUIP_SLOTS[t]],GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().celestialManager,"checkJobCelestiaPointBySlot",GameDefine.CELESTIAL_EQUIP_SLOTS[t])}this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length].register(this.btn_compound,GameDefine.RED_BTN_POS,DataManager.getInstance().celestialManager,"checkJobCelestiaPointBySlot",this.index),this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length+1].register(this.reslabel_grp,new egret.Point(85,-8),DataManager.getInstance().celestialManager,"checkGoldDecomposePoint"),this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length+2].register(this.btn_clothAll,GameDefine.RED_BTN_POS,DataManager.getInstance().celestialManager,"checkCanClothGoldEquips"),e.prototype.onInit.call(this),this.currency.nameColor=15987699,this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_compound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCompound,this),this.btn_clothAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothHanlder,this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.CELESTIAL_COMPOUND_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onUpdateCurrency,this);for(var t,n=0;n<GameDefine.CELESTIAL_EQUIP_SLOTS.length;n++)t=this["item"+GameDefine.CELESTIAL_EQUIP_SLOTS[n]],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_compound.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCompound,this),this.btn_clothAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothHanlder,this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.CELESTIAL_COMPOUND_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onUpdateCurrency,this);for(var t,n=0;n<GameDefine.CELESTIAL_EQUIP_SLOTS.length;n++)t=this["item"+GameDefine.CELESTIAL_EQUIP_SLOTS[n]],t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this);this.index=2*GameDefine.Equip_Slot_Num},t.prototype.onRefresh=function(){this.clothMsgUpdate(),this.onShowInfo(),this.trigger()},t.prototype.onTouchBtnCompound=function(e){switch(e.target.label){case"合成":DataManager.getInstance().celestialManager.onSendCompoundMessage(this.roleIndex,this.index);break;case"升级":DataManager.getInstance().celestialManager.onSendUpgradeMessage(this.roleIndex,this.index);break;case"已满级":GameCommon.getInstance().addAlert("已满级")}},t.prototype.onGetBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("OrangeResPanel",GoodsQuality.Gold))},t.prototype.onShowInfo=function(){var e=(DataManager.getInstance().playerManager.player.rebirthLv,JsonModelManager.instance.getModeltianshenzhuangbei()),t=this.getPlayerData().getEquipBySlot(this.index);if(t.model&&t.quality==GoodsQuality.Gold)this.curr=e[t.model.coatardLv][0],this.curr.coatardLv<this.curr.next?this.next=e[this.curr.next][0]:this.next=null;else{this.next=e[GameDefine.MIN_GOLD_COATARD_LV][0];var n=GameCommon.parseIntArray(this.next.eqid)[this.index-2*GameDefine.Equip_Slot_Num];t=new EquipThing(GOODS_TYPE.MASTER_EQUIP),t.onupdate(n,GoodsQuality.Gold),this.curr=this.next}for(var a,i="",o="",r=0;r<ATTR_TYPE.SIZE;r++){var s=t.attributes[r];if(s>0){var h=t.addAttributes[r];a=new AttributeItem,a.data=[r,s,"+"+h],i=i+GameDefine.Attr_FontName[r]+"+"+s+"\n",o=o+GameDefine.Attr_FontName[r]+"+"+(s+h)+"\n"}}this.curPro.text=i,this.nextPro.text=o,this.powerbar.power=GameCommon.calculationFighting(t.attributes),this.onUpdateCurrency(),this.playSelectAnim()},t.prototype.playSelectAnim=function(){this.selectAnim||(this.selectAnim=new Animation("xuanzhongkuang_3",-1),this.selectAnim.scaleX=.9,this.selectAnim.scaleY=.9,this.selectAnim.x=50,this.selectAnim.y=50),this.selectAnim.parent&&this.selectAnim.parent.removeChild(this.selectAnim),this.currItem.addChildAt(this.selectAnim,0),this.ani.onUpdateRes("shenqi"+(this.index+1-2*GameDefine.Equip_Slot_Num),-1)},t.prototype.onUpdateCurrency=function(){var e;this.next?(this.currency.visible=!0,this.btn_compound.enabled=!0,this.curr.coatardLv==this.next.coatardLv?(this.btn_compound.label="合成",e=this.next.costNum):(this.btn_compound.label="升级",e=this.next.costNum-this.curr.costNum),this.currency.setConsume(GOODS_TYPE.ITEM,GameDefine.CELESTIAL_EQUIP_ADVANCE_CONS_ID,e)):(this.currency.visible=!1,this.btn_compound.enabled=!1,this.btn_compound.label="已满级")},t.prototype.onTouchItem=function(e){var t=e.currentTarget;t.getEquipThing().position!=this.index&&(this.index=t.pos,this.onRefresh(),this.trigger())},t.prototype.trigger=function(){for(var e=0;e<GameDefine.CELESTIAL_EQUIP_SLOTS.length;e++)this.points[e].checkPoint(!0,GameDefine.CELESTIAL_EQUIP_SLOTS[e]);this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length].checkPoint(!0,this.index),this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length+1].checkPoint(),this.points[GameDefine.CELESTIAL_EQUIP_SLOTS.length+2].checkPoint()},t.prototype.clothMsgUpdate=function(e){for(var t,n,a=0;a<GameDefine.CELESTIAL_EQUIP_SLOTS.length;a++)n=this.getPlayerData().getEquipBySlot(GameDefine.CELESTIAL_EQUIP_SLOTS[a]),t=this["item"+GameDefine.CELESTIAL_EQUIP_SLOTS[a]],t.shieldTip=!0,n.model&&n.quality==GoodsQuality.Gold||(n=new EquipThing,n.position=GameDefine.CELESTIAL_EQUIP_SLOTS[a]),t.onUpdate(n,0),this.index==GameDefine.CELESTIAL_EQUIP_SLOTS[a]&&(this.currItem=t)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(this.roleIndex)},t.prototype.onClothHanlder=function(){DataManager.getInstance().bagManager.onClothEquipAll(2)},t}(BaseTabView);__reflect(CelestialPanel.prototype,"CelestialPanel");var EquipDepotPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EquipDepotPanelSkin},t.prototype.onInit=function(){this.bag_Scroller.verticalScrollBar.autoVisibility=!0,this.bag_Scroller.verticalScrollBar.visible=!0,this.bagLayer.itemRenderer=DepotItemRenderer,this.bagLayer.itemRendererSkinName=skins.BagItemRendererSkin,this.bagLayer.useVirtualLayout=!0,this.bag_Scroller.viewport=this.bagLayer,this.points[0].register(this.btn_takeOut,GameDefine.RED_BTN_POS,DataManager.getInstance().celestialManager,"checkDepotPoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_takeOut.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WAREHOUSE_TAKEOUT_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_takeOut.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WAREHOUSE_TAKEOUT_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().celestialManager.warehouse,t=[];for(var n in e){var a=new ThingBase(e[n].type,e[n].id,e[n].num);a.quality=e[n].quality,t.push(a)}this.bagLayer.dataProvider=new eui.ArrayCollection(t),this.bag_Scroller.viewport.scrollV=0},t.prototype.onTouchBtn=function(){return DataManager.getInstance().celestialManager.checkDepotPoint()?DataManager.getInstance().bagManager.getIsFullBag()?void GameCommon.getInstance().addAlert("背包已满"):void DataManager.getInstance().celestialManager.onSendTakeOutMessage():void 0},t}(BaseTabView);__reflect(EquipDepotPanel.prototype,"EquipDepotPanel");var DepotItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onComplete=function(){this.goods.touchEnabled=!1,this.goods.touchChildren=!1},t.prototype.onUpdate=function(){this.data?(this.goods.onThing(this.data),this.goods.num_label.bottom=40,(this.data.type==GOODS_TYPE.MASTER_EQUIP||this.data.type==GOODS_TYPE.SERVANT_EQUIP)&&(this.goods.name_label.text=this.data.model.coatardLv+Language.instance.getText("grade"))):this.goods.onReset()},t}(BaseListItem);__reflect(DepotItemRenderer.prototype,"DepotItemRenderer");var EquipNBPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_HONGZHUANG,n._isReset=!1,n.points=RedPointManager.createPoint(4),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="TreasurePanel",n.btnRes="套装宝库",n.funcID=FUN_TYPE.FUN_LOTTERY,n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().celestialManager,"checkTreasurePoint"),t.push(n),n=new RegisterSystemParam,n.sysName="OrangePanel",n.btnRes="诛仙套装",n.funcID=FUN_TYPE.FUN_HONGZHUANG,n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().celestialManager,"checkOrangeEquipPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="DomUpgradePanel",n.btnRes="上古套装",n.funcID=FUN_TYPE.FUN_SHANGGU,n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().dominateManager,"checkDomPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="CelestialPanel",n.btnRes="伏魔套装",n.funcID=FUN_TYPE.FUN_ANJIN,n.redP=this.points[3],n.redP.addTriggerFuc(DataManager.getInstance().celestialManager,"checkCelestiaPoint"),t.push(n),this.registerPage(t,"equipNBGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.checkActivity()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("套装宝库");break;case 1:this.setTitle("诛仙套装");break;case 2:this.setTitle("上古套装");break;case 3:this.setTitle("附魔套装");break;case 4:this.setTitle("仓库")}e.prototype.onRefresh.call(this),this.checkActivity()},t.prototype.checkActivity=function(){var e=DataManager.getInstance().newactivitysManager.dabiao_model;e&&(10==e.type&&1==this.tabs[1].enabled?(this.basic.tipsLayer.visible=!0,this.basic.tipsLayer.x=101):this.basic.tipsLayer.visible=!1)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t}(BaseSystemPanel);__reflect(EquipNBPanel.prototype,"EquipNBPanel");var OrangePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(14),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.OrangePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.label_res.text=Language.instance.getText("fenjiehuoqu"),GameCommon.getInstance().addUnderlineStr(this.label_res),this.label_res.touchEnabled=!0,this.label_res.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRes,this);for(var t=0;t<GameDefine.Equip_Slot_Num;t++)this.points[t].register(this["equip"+t],GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().celestialManager,"checkJobOrangeEquipPointBySlot",t+GameDefine.Equip_Slot_Num);this.points[GameDefine.Equip_Slot_Num].register(this.btn_upgrade,GameDefine.RED_BTN_POS,DataManager.getInstance().celestialManager,"checkJobOrangeEquipPoint"),this.points[GameDefine.Equip_Slot_Num+1].register(this.reslabel_grp,new egret.Point(85,-8),DataManager.getInstance().celestialManager,"checkRedDecomposePoint"),this.points[GameDefine.Equip_Slot_Num+2].register(this.btn_clothAll,GameDefine.RED_BTN_POS,DataManager.getInstance().celestialManager,"checkCanClothZhuxianEquips"),this.points[GameDefine.Equip_Slot_Num+3].register(this.qihunBtn,GameDefine.RED_ROLE_EQUIP_BOTTOM_POS,FunDefine,"checkQihunRedPoint"),this.consItem.nameColor=15987699,this.showOrangeEquip(),this.onupdatePiecesNum(),this.selected?this.clickOrangeEquipIndex(this.selected.pos-GameDefine.Equip_Slot_Num):this.clickOrangeEquipIndex(0)},t.prototype.onRefresh=function(){this.onupdatePiecesNum()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),this.btn_clothAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothHanlder,this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.clothMsgUpdate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ORANGE_RES_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onupdatePiecesNum,this);for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this["equip"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this)}this.qihunBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchQihun,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),this.btn_clothAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothHanlder,this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.clothMsgUpdate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ORANGE_RES_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onupdatePiecesNum,this);for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this["equip"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this)}this.qihunBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchQihun,this)},t.prototype.clothMsgUpdate=function(e){var t=e.data,n=t-GameDefine.Equip_Slot_Num,a=this.playerData.getEquipBySlot(t),i=this["equip"+n];i&&(i.onUpdate(a,0),i.onPlayClothAnim(),this.selectedOrangeEquip(i)),this.onupdatePiecesNum()},t.prototype.trigger=function(){for(var e=0;e<GameDefine.Equip_Slot_Num;e++)this.points[e].checkPoint();this.points[GameDefine.Equip_Slot_Num].checkPoint(),this.points[GameDefine.Equip_Slot_Num+1].checkPoint(),this.points[GameDefine.Equip_Slot_Num+2].checkPoint(),this.points[GameDefine.Equip_Slot_Num+3].checkPoint()},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t.prototype.showOrangeEquip=function(){for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++){var n=t+GameDefine.Equip_Slot_Num,a=this.playerData.getEquipBySlot(n);e=this["equip"+t],e.pos=n,e.shieldTip=!0,e.onUpdate(a,0)}},t.prototype.onEquipClick=function(e){var t=e.currentTarget;this.selectedOrangeEquip(t)},t.prototype.selectedOrangeEquip=function(e){for(var t,n=0;n<GameDefine.Equip_Slot_Num;n++)t=this["equip"+n];this.selectAnim||(this.selectAnim=new Animation("xuanzhongkuang_3",-1),this.selectAnim.scaleX=.9,this.selectAnim.scaleY=.9,this.selectAnim.x=50,this.selectAnim.y=50),this.selectAnim.parent&&this.selectAnim.parent.removeChild(this.selectAnim),e.addChildAt(this.selectAnim,0),this.selected=e;var a=e.getEquipThing();if(a&&a.quality==GoodsQuality.Red){var i=JsonModelManager.instance.getModelhongzhuang()[a.model.coatardLv-1];this.btn_upgrade.enabled=i?!0:!1,this.consItem.visible=i?!0:!1,this.btn_upgrade.label=Language.instance.getText("upgrade"),this.btn_state=MESSAGE_ID.ORANGE_UPGRADE_MESSAGE}else this.btn_upgrade.enabled=!0,this.consItem.visible=!0,this.btn_upgrade.label=Language.instance.getText("hecheng"),this.btn_state=MESSAGE_ID.ORANGE_MIX_MESSAGE;this.showNextOrange(),this.trigger()},t.prototype.showNextOrange=function(){var e=this.selected.getEquipThing(),t=null,n=null;if(e&&e.model){n=e,t=JsonModelManager.instance.getModelhongzhuang()[n.model.coatardLv-1];var a=JsonModelManager.instance.getModelhongzhuang()[n.model.coatardLv];a&&(this.cost=a.hecheng-t.hecheng)}else{t=JsonModelManager.instance.getModelhongzhuang()[0];var i=GameCommon.parseIntArray(t.Eqid)[this.selected.pos-GameDefine.Equip_Slot_Num];n=new EquipThing(GOODS_TYPE.MASTER_EQUIP),n.onupdate(i,GoodsQuality.Red),this.cost=t.hecheng}for(var o="",r="",s=[0,0,0,0,0,0,0,0,0,0],h=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.RED_EQUIP),l=0;l<ATTR_TYPE.SIZE;l++){var g=n.attributes[l];if(s[l]=g,g>0){var c=n.addAttributes[l];o=o+GameDefine.Attr_FontName[l]+"+"+g+"\n",r=r+GameDefine.Attr_FontName[l]+"+"+(g+c)+"\n",s[l]+=c+Tool.toInt(c*h%GameDefine.GAME_ADD_RATIO)}}this.nextPro.text=r,this.curPro.text=o,this.powerbar.power=GameCommon.calculationFighting(s),this.equip_mix.onUpdate(n,0),this.onupdatePiecesNum()},t.prototype.clickOrangeEquipIndex=function(e){var t=this["equip"+e];this.selectedOrangeEquip(t)},t.checkOrangePos=function(){var e=[],n=DataManager.getInstance().bagManager.getGoodsThingById(t.ITEM_ID),a=0;n&&(a=n.num);for(var i=DataManager.getInstance().playerManager.player,o=i.getPlayerData(),r=(10*Math.floor(i.level/10),0);r<GameDefine.Equip_Slot_Num;r++){var s=o.getEquipBySlot(r+GameDefine.Equip_Slot_Num),h=0;if(s){var l=s.model.coatardLv;if(i.level<l+10)continue;var g=JsonModelManager.instance.getModelhongzhuang()[l-1],c=JsonModelManager.instance.getModelhongzhuang()[l];h=c.hecheng-g.hecheng}else{var g=JsonModelManager.instance.getModelhongzhuang()[0];h=g.hecheng}a>=h&&(e[e.length]=r)}return e},t.prototype.onupdatePiecesNum=function(){var e=DataManager.getInstance().bagManager.getGoodsThingById(t.ITEM_ID),n=0;e&&(n=e.num),this.consItem.setConsume(GOODS_TYPE.ITEM,t.ITEM_ID,this.cost)},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(t.ITEM_ID,GOODS_TYPE.ITEM)},t.prototype.onRes=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("OrangeResPanel",GoodsQuality.Red))},t.prototype.onUpgrade=function(){if(GameCommon.getInstance().onCheckItemConsume(t.ITEM_ID,this.cost)){var e=new Message(this.btn_state);e.setByte(0),e.setByte(this.selected.pos),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onClothHanlder=function(){DataManager.getInstance().bagManager.onClothEquipAll(1)},t.prototype.onTouchQihun=function(){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_QIHUN)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"QihunPanel")},t.ITEM_ID=41,t}(BaseTabView);__reflect(OrangePanel.prototype,"OrangePanel");var OrangeResPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.tujingItems=[],n.gotoTypes=[[],[],[],[],[],[FUN_TYPE.FUN_LOTTERY,FUN_TYPE.FUN_GEREN_BOSS,FUN_TYPE.FUN_QUANMIN_BOSS],[FUN_TYPE.FUN_LOTTERY,FUN_TYPE.FUN_SHOP_SHENMI,FUN_TYPE.FUN_VIP_GIFTSHOP]],n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.OrangeResPanelSkin},t.prototype.onShowWithParam=function(e){this.quality=e,this.onShow()},t.prototype.onInit=function(){this.item_scroll.verticalScrollBar.autoVisibility=!1,this.item_scroll.verticalScrollBar.visible=!1,this.tujingItems=[],e.prototype.onInit.call(this),this.setTitle("分解"),this.onRefresh()},t.prototype.onRefresh=function(){this.showOrangeEquip(null);var e="装备列表";switch(this.quality){case GoodsQuality.Red:e="红装列表";break;case GoodsQuality.Gold:e="金装列表"}this.equip_title_lab.text=e,this.tujing_group.removeChildren();for(var t=this.gotoTypes[this.quality],n=Math.max(t.length,this.tujingItems.length),a=0;n>a;a++){var i=t[a],o=void 0;Tool.isNumber(i)&&(this.tujingItems.length>a?o=this.tujingItems[a]:(o=new FastGetItem,o.width=350,this.tujingItems.push(o)),o.scaleX=.8,o.scaleY=.8,o.data=i,this.tujing_group.addChild(o))}},t.prototype.showOrangeEquip=function(e){this.item_group.removeChildren(),this.item_scroll.viewport.scrollV=0;var t=DataManager.getInstance().bagManager.getGoodsListByType(GOODS_TYPE.MASTER_EQUIP);if(t)for(var n=0;n<t.length;n++){var a=t[n];if(a.quality==this.quality){var i=new OrangeItem;i.y=118*n,i.data=a,i.btn_res.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRes,this),this.item_group.addChild(i)}}},t.prototype.onRes=function(e){var t=e.currentTarget;this.item=t.parent.data;var n;n=new Message(this.item.quality==GoodsQuality.Gold?MESSAGE_ID.CELESTIAL_DECOMPOSE_MESSAGE:MESSAGE_ID.ORANGE_RES_MESSAGE),n.setShort(1),n.setInt(this.item.equipId),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.tujingItems.length;t++){var n=this.tujingItems[t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoItem,this)}GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ORANGE_RES_MESSAGE.toString(),this.showOrangeEquip,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.CELESTIAL_DECOMPOSE_MESSAGE.toString(),this.showOrangeEquip,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.tujingItems.length;t++){var n=this.tujingItems[t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGotoItem,this)}GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ORANGE_RES_MESSAGE.toString(),this.showOrangeEquip,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.CELESTIAL_DECOMPOSE_MESSAGE.toString(),this.showOrangeEquip,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.getModelOrangeById=function(e){return JsonModelManager.instance.getModelhongzhuang()[e]},t.prototype.onTouchGotoItem=function(e){var t=e.currentTarget;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t.gotype),this.onHide()},t}(BaseWindowPanel);__reflect(OrangeResPanel.prototype,"OrangeResPanel");var OrangeItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.OrangeItemSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){var e=this._data.model;if(e){var t;if(this._data.quality==GoodsQuality.Red){t=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_CZSP);var n=JsonModelManager.instance.getModelhongzhuang()[e.coatardLv-1];this.label_num.text=n.hecheng+""}else if(this._data.quality==GoodsQuality.Gold){t=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_TSSP);var a=JsonModelManager.instance.getModeltianshenzhuangbei()[e.coatardLv][0];this.label_num.text=a.costNum+""}this.label_suipian.text=t.name,this.equip_icon.source=e.icon,this.equip_frame.source=GameCommon.getInstance().getIconFrame(this._data.quality),this.label_lv.text=e.coatardLv+Language.instance.getText("grade"),this.label_name.text=e.name}},t}(eui.Component);__reflect(OrangeItem.prototype,"OrangeItem");var QihunPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.aniIdx=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.QihunPanelSkin},t.prototype.onInit=function(){this.setTitle("器魂"),this.ani?this.ani.onPlay():(this.ani=new Animation("qihun_"+this.aniIdx,-1,!1),this.ani.x=this.aniLayer.width/2,this.ani.y=this.aniLayer.height/2+this.aniLayer.height/4,this.aniLayer.addChild(this.ani)),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){this.btn_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_QIHUN_UPGRADE_MESSAGE.toString(),this.onUpBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onupdatePiecesNum,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){this.btn_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_QIHUN_UPGRADE_MESSAGE.toString(),this.onUpBack,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_ADD_MESSAGE.toString(),this.onupdatePiecesNum,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GOODS_LIST_USE_MESSAGE.toString(),this.onupdatePiecesNum,this),e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().playerManager.player.getPlayerData(t.index).qihun;this.showInfo(e),this.showLv(e)},t.prototype.showInfo=function(e){for(var t=JsonModelManager.instance.getModelqihun(),n=t[e],a=t[e+1],i=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.RED_EQUIP),o=GameCommon.getInstance().getAttributeAry(),r=n||a,s=0,h="",l="",g=0;g<r.attrAry.length;g++)r.attrAry[g]>0&&(s=n?n.attrAry[g]:0,h.length>0&&(h+="\n"),h+=GameDefine.Attr_FontName[g]+" +"+s,s=a?a.attrAry[g]:n.attrAry[g],l.length>0&&(l+="\n"),l+=GameDefine.Attr_FontName[g]+" +"+s),o[g]=r.attrAry[g]+Tool.toInt(r.attrAry[g]*i/GameDefine.GAME_ADD_RATIO);if(a?(this.nextPro.text=l,this.currentState="normal"):this.currentState="max",this.curPro.text=h,n){this.powerBar.power=GameCommon.calculationFighting(o);var c=Language.instance.parseInsertText("qihun_jingjie_title",n.jieduan);this.setTitle(c)}else this.powerBar.power=0,this.setTitle("");if(this.costModel=null,a)if(a.cost.num>0?(this.costModel=a,this.consume.visible=!0,this.consume.setCostByAwardItem(a.cost)):this.consume.visible=!1,this.btn_up.enabled=!0,n&&n.coatardLimit==a.coatardLimit){var p=a.gailv/100;this.desc.text=Language.instance.getText("chenggonglv","：",p,"%")}else this.desc.text=Language.instance.parseInsertText("qihun_jingjie",a.coatardLimit);else this.max=!0,this.consume.visible=!1,this.btn_up.enabled=!1;n&&this.aniIdx!=n.coatardLimit&&(this.aniIdx=n.coatardLimit,this.ani.onUpdateRes("qihun_"+this.aniIdx,-1))},t.prototype.onupdatePiecesNum=function(){this.costModel&&this.consume.setCostByAwardItem(this.costModel.cost)},t.prototype.showLv=function(e){var t=JsonModelManager.instance.getModelqihun(),n=t[e],a=1,i=0;n&&(a=n.coatardLimit,i=n.level);for(var o,r=e,s=!1;!s;)r++,o=t[r],o&&o.coatardLimit==a||(s=!0);o=t[r-1],this.label_lv.text=i+"/"+o.level},t.prototype.onTouchBtn=function(){var e=new Message(MESSAGE_ID.PLAYER_QIHUN_UPGRADE_MESSAGE);e.setByte(t.index),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onUpBack=function(){this.onRefresh(),DataManager.getInstance().playerManager.player.updataAttribute();var e=new egret.Point(0,0);GameCommon.getInstance().addAnimation("qihunshengji",e,this.aniLayer)},t.index=0,t}(BaseWindowPanel);__reflect(QihunPanel.prototype,"QihunPanel");var TreasureAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TreasureAwardPanelSkin},t.prototype.onInit=function(){this.setTitle("获得奖励"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._showleftTime=this.param.autocloseTime,this.result_label.text=this.param.desc,this.onUpdateAward(),this._showleftTime>0?Tool.addTimer(this.onCloseTimedown,this,1e3):this.btn_sure.label=this.param.btnlabel},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=this.param.btnlabel+("("+this._showleftTime+")"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.param.callFunc&&this.param.callObj&&Tool.callback(this.param.callFunc,this.param.callObj,this.param.callParam),this.param=null,this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&e.prototype.onShow.call(this)},t.prototype.onHide=function(){Tool.removeTimer(this.onCloseTimedown,this,1e3),e.prototype.onHide.call(this)},t.prototype.onUpdateAward=function(){if(this.award_group.removeChildren(),this.param.itemAwards)for(var e=0;e<this.param.itemAwards.length;e++){var t=this.param.itemAwards[e],n=new GoodsInstance;if(n.x=100*Math.floor(e%5),n.y=130*Math.floor(e/5),this.award_group.addChild(n),t.type==GOODS_TYPE.GEM){var a=GameCommon.getInstance().getThingModel(GOODS_TYPE.GEM,t.id);n.onUpdate(t.type,t.id,0,t.quality,t.num,a.level)}else n.onUpdate(t.type,t.id,0,t.quality,t.num)}},t}(BaseWindowPanel);__reflect(TreasureAwardPanel.prototype,"TreasureAwardPanel");var TreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.WEAPON_ID=5,n.CLOTH_ID=10,n.WEEK_AWD_MAX=4,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TreasurePanelSkin},t.prototype.onInit=function(){for(var t,n=JsonModelManager.instance.getModelxunbao()[1],a=GameCommon.getInstance().onParseAwardItemstr(n.show),i=0;i<a.length;i++){var o=a[i];if(t=this["item"+i])t.onUpdate(o.type,o.id,0,o.quality,o.num,o.lv);else{var r=GameCommon.getInstance().getThingModel(o.type,o.id,o.quality);this["best"+i+"_icon"]&&(this["best"+i+"_icon"].source=r.icon),this["best"+i+"_name_lab"]&&(this["best"+i+"_name_lab"].text=r.name),this["best"+i]&&(this["best"+i].name=r.id)}}n.box.split("#");this.currency0.nameColor=15987699,this.currency1.nameColor=15987699,this.currency0.data=new CurrencyParam("",new ThingBase(n.cost.type,n.cost.id,n.cost.num)),this.currency1.data=new CurrencyParam("",new ThingBase(n.costOneKey.type,n.costOneKey.id,n.costOneKey.num)),this.first.visible=!1;var s;s=GameCommon.getInstance().addAnimation("jinzhuang",new egret.Point(86,75),this.best12,-1),s.scaleX=s.scaleY=1.3,s.touchEnabled=!1,s=GameCommon.getInstance().addAnimation("jinzhuang",new egret.Point(86,75),this.best13,-1),s.scaleX=s.scaleY=1.3,s.touchEnabled=!1,SDKManager.loginInfo.channel==EChannel.CHANNEL_AWY||SDKManager.loginInfo.channel==EChannel.CHANNEL_LOCAL?(this.PR_desc_btn.visible=!0,this.PR_desc_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowPRDescPanel,this)):this.PR_desc_btn.visible=!1,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_one.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),this.btn_ten.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTen,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TREASURE_CELESTIAL_MEESAGE.toString(),this.onTreasureBackMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TREASURE_CELESTIAL_LOG_MEESAGE.toString(),this.onUpdateLog,this),this.best12.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this),this.best13.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this),Tool.addTimer(this.onTimeDown,this,1e3)
},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_one.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),this.btn_ten.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTen,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TREASURE_CELESTIAL_MEESAGE.toString(),this.onTreasureBackMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TREASURE_CELESTIAL_LOG_MEESAGE.toString(),this.onUpdateLog,this),this.best12.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this),this.best13.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAnim,this),Tool.removeTimer(this.onTimeDown,this,1e3)},t.prototype.onRefresh=function(){var e=new Date(DataManager.getInstance().playerManager.player.currentTime);this.weekLefttime=86400*(GameDefine.WEEK_DAY-e.getDay())-3600*e.getHours()-60*e.getMinutes()-e.getSeconds(),this.weekLefttime=this.weekLefttime+egret.getTimer(),this.onUpdateLog(),this.onTreasureBackMsg()},t.prototype.onTreasureBackMsg=function(){this.onShowFirst()},t.prototype.onTimeDown=function(){var e=Math.ceil((this.weekLefttime-egret.getTimer())/1e3);0>=e&&Tool.removeTimer(this.onTimeDown,this,1e3)},t.prototype.onTouchAnim=function(e){var t=parseInt(e.currentTarget.name),n=new EquipThing(GOODS_TYPE.MASTER_EQUIP);n.onupdate(t,GoodsQuality.Gold,0),n&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.EQUIP,GOODS_TYPE.MASTER_EQUIP,n)))},t.prototype.onShowFirst=function(){var e=DataManager.getInstance().playerManager.player;0!=e.treasureFirst?this.first.visible=!1:0==this.first.visible&&(this.first_equip.onUpdate(GOODS_TYPE.MASTER_EQUIP,219,0,GoodsQuality.Red,1),this.first.visible=!0)},t.prototype.onUpdateLog=function(){this.label_log.textFlow=DataManager.getInstance().celestialManager.getTextFlow(),setTimeout(this.adjustChatBar.bind(this),100)},t.prototype.adjustChatBar=function(){this.bar.viewport.scrollV=Math.max(this.bar.viewport.contentHeight-this.bar.viewport.height,0)},t.prototype.onTouchBtnOne=function(){DataManager.getInstance().celestialManager.onSendCelestiaTreasure(0)},t.prototype.onTouchBtnTen=function(){DataManager.getInstance().celestialManager.onSendCelestiaTreasure(1)},t.prototype.onTouchBtnAward=function(){var e=new Message(MESSAGE_ID.TREASURE_WEEK_AWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onShowPRDescPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",Language.instance.getText("treasure_PR_explain")))},t}(BaseTabView);__reflect(TreasurePanel.prototype,"TreasurePanel");var EscortAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.REWARD_MAX_NUM=3,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EscortAwardPanelSkin},t.prototype.onInit=function(){this.setTitle("husong_title_png"),this.basic.closeBtn1&&(this.basic.closeBtn1.visible=!1),this.basic.closeBtn2&&(this.basic.closeBtn2.visible=!1),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReceive,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE.toString(),this.onRefreshBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReceive,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE.toString(),this.onRefreshBack,this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().escortManager.award;this.anim?this.anim.onUpdateRes("yunbiao_0"+e.quality,-1):(this.anim=new Animation("yunbiao_0"+e.quality,-1),this.fairyLayer.addChild(this.anim));var t=JsonModelManager.instance.getModeldujie()[e.quality],n=GameCommon.getInstance().onParseAwardItemstr(t.jiangli);this.label_name.textFlow=(new egret.HtmlTextParser).parser("<font color="+GameCommon.getInstance().CreateNameColer(e.quality)+">"+GameDefine.EQUIP_QUALITE_NAME1[e.quality]+"衣仙女</font>");for(var a=0;a<this.REWARD_MAX_NUM&&!(n.length<=a);a++)this["rewarditem"+a].updateByAward(n[a]);this.label_money.text=""+(e.log.length>0?"-"+.1*n[0].num*e.log.length:"无丢失"),this.label_rongyu.text=""+(e.log.length>0?"-"+.1*n[1].num*e.log.length:"无丢失"),this.label_jlzh.text=""+(e.log.length>0?"-"+.1*n[2].num*e.log.length:"无丢失");var i=new Array;if(0==e.log.length)i.push({text:"本次护送没有被抢夺",style:{textColor:15326899}});else{for(var a=0;a<e.log.length;a++)i.push({text:"抢劫情况：",style:{textColor:15326899}}),i.push({text:e.log[a].name,style:{textColor:2661098}}),i.push({text:"抢夺我的",style:{textColor:15326899}}),i.push({text:GameDefine.EQUIP_QUALITE_NAME1[e.log[a].quality]+"衣仙女",style:{textColor:GameCommon.getInstance().CreateNameColer(e.log[a].quality)}}),i.push({text:" ",style:{}}),i.push({text:"成功",style:{textColor:2680872}}),i.push({text:"\n",style:{}});i.pop()}this.label_log.textFlow=i},t.prototype.onRefreshBack=function(){this.onHide()},t.prototype.onTouchReceive=function(){DataManager.getInstance().escortManager.onSendEscortAwardReceive()},t}(BaseWindowPanel);__reflect(EscortAwardPanel.prototype,"EscortAwardPanel");var EscortBeRobPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EscortBeRobPanelSkin},t.prototype.onInit=function(){this.setTitle("rob_title_png"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_rob.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRob,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_rob.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRob,this)},t.prototype.onRefresh=function(){this.awardLayer.removeChildren();var e,t=JsonModelManager.instance.getModeldujie()[this.data.quality];if(t)for(var n=GameCommon.getInstance().onParseAwardItemstr(t.jiangli),a=0;a<n.length;a++){var i=n[a];i.num=i.num/10,e=GameCommon.getInstance().createGoodsIntance(i),this.awardLayer.addChild(e)}this.label_remain.text=EscortData.MAX_ROB_COUNT-DataManager.getInstance().escortManager.escort.rob+"/"+EscortData.MAX_ROB_COUNT,this.label_owner.text="仙女拥有者："+this.data.name,this.label_power.text=""+this.data.fightvalue},t.prototype.onShowWithParam=function(e){this.data=e,this.onShow()},t.prototype.onTouchRob=function(){this.data&&DataManager.getInstance().escortManager.onSendRobSomeBody(this.data.id)},t}(BaseWindowPanel);__reflect(EscortBeRobPanel.prototype,"EscortBeRobPanel");var EscortPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.carLayout=[2,3,2],n.map_max_w=600,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EscortPanelSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineStr(this.link_oneKey),e.prototype.onInit.call(this),this.onInitCar(),this.points[0].register(this.btn_log,GameDefine.RED_MAIN_II_POS,DataManager.getInstance().escortManager,"getHasUnOpenLog"),this.points[1].register(this.btn_escort,GameDefine.RED_BTN_POS,DataManager.getInstance().escortManager,"getCanEscort"),this.onRefresh(),DataManager.getInstance().escortManager.setPanel(this)},t.prototype.onRefresh=function(){this.data=DataManager.getInstance().escortManager.escort,this.arane_Escortnum_label.text=EscortData.MAX_ESCORT_COUNT-this.data.count+"/"+EscortData.MAX_ESCORT_COUNT,this.arane_ranknum_label.text=EscortData.MAX_ROB_COUNT-this.data.rob+"/"+EscortData.MAX_ROB_COUNT,this.onTouchRefresh(),this.onShowAwardLayer(),this.onShowInfo()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_flush.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRefresh,this),this.btn_escort.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnEscort,this),this.btn_log.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnLog,this),this.btn_oneKeyDone.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOneKeyDone,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_ROBLIST_MESSAGE.toString(),this.onRefreshBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_DISPATCH_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_ESCORT_DONE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_ROB_RESULT_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().escortManager.onSendEscortDone(),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_flush.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRefresh,this),this.btn_escort.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnEscort,this),this.btn_log.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnLog,this),this.btn_oneKeyDone.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOneKeyDone,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_ROBLIST_MESSAGE.toString(),this.onRefreshBack,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_DISPATCH_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_AWARD_RECEIVE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_ESCORT_DONE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_ROB_RESULT_MESSAGE.toString(),this.onRefresh,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},t.prototype.onShowInfo=function(){if(this.myInfoLayer.visible=1==this.data.cargo,this.myInfoLayer.visible){var e=JsonModelManager.instance.getModeldujie()[DataManager.getInstance().escortManager.escort.quality];this.max=e.keeptime,this.btn_escort.label="护送中"}else this.btn_escort.label="开始护送"},t.prototype.onTouchBtnAwardClose=function(){this.awardLayer.visible=!1},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchBtnOneKeyDone=function(){var e=2,t=Math.ceil(this.time/60);e*=t;var n="";if(!(this.getPlayerData().gold>=e))return void GameCommon.getInstance().addAlert("error_tips_2");n="钻石";var a=[{text:"是否花费"+e+n+"完成当前护送",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(a,this.onSendOneKeyDone,this)))},t.prototype.onSendOneKeyDone=function(){var e=new Message(MESSAGE_ID.ESCORT_ESCORT_DONE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onShowAwardLayer=function(){var e=DataManager.getInstance().escortManager.award;e&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"EscortAwardPanel")},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(32,GOODS_TYPE.ITEM)},t.prototype.addAnimation=function(e,t,n){var a=new Animation(e,-1);return a.x=t.x,a.y=t.y,n.addChild(a),a},t.prototype.TickingRefresh=function(){this.sendEscortRobListMsg()},t.prototype.onCountDown=function(e){this.time=e,this.label_time.text=GameCommon.getInstance().getTimeStrForSec2(e,!1)},t.prototype.onRefreshBack=function(){this.onTouchflush()},t.prototype.onTouchRefresh=function(){this.onTouchflush()&&this.sendEscortRobListMsg()},t.prototype.onInitCar=function(){this.cars=[];for(var e,t=0;t<EscortData.MAX_SHOW_COUNT;t++)e=new EscortCar,e.index=t,this.cars.push(e),this.carLayer.addChild(e)},t.prototype.onEnterFrame=function(){for(var e,t=0;t<this.cars.length;t++)e=this.cars[t],e.x+=2,e.x>=this.map_max_w&&(e.x=-e.width),e.onShowTime()},t.prototype.onTouchBtnEscort=function(){return 1==this.data.cargo?void GameCommon.getInstance().addAlert("正在护送中"):DataManager.getInstance().escortManager.escort.count>=EscortData.MAX_ESCORT_COUNT?void GameCommon.getInstance().addAlert("已达今日护送上限"):void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SonniePanel")},t.prototype.onTouchBtnLog=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"EscortRobPanel")},t.prototype.onTouchflush=function(){var e=DataManager.getInstance().escortManager.getRandomCar();if(e.length<EscortData.MAX_SHOW_COUNT)return!0;for(var t,n,a,n,i=0,o=40,r=0;r<this.carLayout.length;r++){a=this.carLayout[r],t=this.map_max_w/a;for(var s=0;a>s;s++)n=-Math.random()*this.map_max_w/(2.5*a)-300,this.cars[i].x=this.map_max_w-1.2*t*s+n,this.cars[i].y=200*r+o,this.cars[i].data=e[i],i++}},t.prototype.sendEscortRobListMsg=function(){var e=new Message(MESSAGE_ID.ESCORT_ROBLIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(EscortPanel.prototype,"EscortPanel");var EscortProgressBar=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.EscortProgressBarSkin,t}return __extends(t,e),t.prototype.showInfo=function(e,t){void 0===e&&(e=100),void 0===t&&(t=100),this.minimum=0,this.maximum=t,this.setValue(e)},t.prototype.valueToLabel=function(t,n){return n==t?"MAX":e.prototype.valueToLabel.call(this,t,n)},t.prototype.setValue=function(t){e.prototype.setValue.call(this,t)},t}(eui.ProgressBar);__reflect(EscortProgressBar.prototype,"EscortProgressBar");var EscortCar=function(e){function t(){var t=e.call(this)||this;return t._refreshTime=0,t.touchEnabled=!0,t}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.EscortCarSkin},Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(e){this._index=e},enumerable:!0,configurable:!0}),t.prototype.onRegist=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRob,this)},t.prototype.onRemove=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRob,this)},t.prototype.onRob=function(){this.data&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("EscortBeRobPanel",this.data))},t.prototype.dataChanged=function(){this.visible=null!=this._data,this._data&&(this.label_name.textFlow=(new egret.HtmlTextParser).parser("<font color="+GameCommon.getInstance().CreateNameColer(this.data.quality)+" >"+this._data.name+"</font>"),setTimeout(this.updateFireAnim.bind(this),Math.floor(100*Math.random())+15))},t.prototype.updateFireAnim=function(){this.fire?this.fire.onUpdateRes("yunbiao_0"+this.data.quality,-1):(this.fire=new Animation("yunbiao_0"+this.data.quality,-1),this.ghostFireLayer.addChild(this.fire))},t.prototype.onShowTime=function(){if(this.label_time&&this._data&&egret.getTimer()-this._refreshTime>1e3){this._refreshTime=egret.getTimer();var e=this._data.getCountDown();this.label_time.text="剩余时间："+GameCommon.getInstance().getTimeStrForSec2(e,!1),0>=e&&this.visible&&(this._data=null,this.dataChanged())}},t}(BaseComp);__reflect(EscortCar.prototype,"EscortCar");var EscortRevengePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EscortRevengePanelSkin},t.prototype.onInit=function(){this.setTitle("escort_revenge_title_png"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_revenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRevenge,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_revenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRevenge,this)},t.prototype.onRefresh=function(){this.head_icon.setHead(this._data.headId,this._data.headFrameId),this.label_name.text=this._data.name,this.label_power.text="战斗力："+this._data.power;var e=new Date(this._data.time),t=e.getMonth()+1,n=e.getDate(),a=e.getHours(),i=e.getMinutes();this.label_time.text="抢夺时间："+t+"/"+n+"日 "+a+":"+i+"分",this.awardLayer.removeChildren();var o,r=JsonModelManager.instance.getModeldujie()[this._data.quality];if(r)for(var s=GameCommon.getInstance().onParseAwardItemstr(r.jiangli),h=0;h<s.length;h++){var l=s[h];l.num=.2*l.num,o=GameCommon.getInstance().createGoodsIntance(l),this.awardLayer.addChild(o)}},t.prototype.onTouchRevenge=function(){DataManager.getInstance().escortManager.onSendRevengeSomeBody(this._data.revengeID,this._data.time)},t.prototype.onShowWithParam=function(e){this._data=e,this.onShow()},t}(BaseWindowPanel);__reflect(EscortRevengePanel.prototype,"EscortRevengePanel");var EscortRobPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EscortRobPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("护送记录")},t.prototype.onRefresh=function(){this.infoLayer.removeChildren();for(var e,t=DataManager.getInstance().escortManager.log,n=t.length-1;n>=0;n--)e=new EscortRobitem,e.data=t[n],this.infoLayer.addChild(e)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_ESCORT_RECORD.toString(),this.onRefresh,this),this.onSendGetRecord()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_ESCORT_RECORD.toString(),this.onRefresh,this)},t.prototype.onSendGetRecord=function(){var e=new Message(MESSAGE_ID.ESCORT_ESCORT_RECORD);GameCommon.getInstance().sendMsgToServer(e),DataManager.getInstance().escortManager.hasNewInfo=!1},t}(BaseWindowPanel);__reflect(EscortRobPanel.prototype,"EscortRobPanel");var EscortRobitem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.EscortRobItemSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.label_content.touchEnabled=!0,this.label_content.addEventListener(egret.TextEvent.LINK,function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("EscortRevengePanel",this._data))},this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){this.data.recordType>1?this.result_icon.source=this.data.succeed>0?"fight_win_icon_png":"fight_lose_icon_png":this.result_icon.source="fight_start_icon_png";var e,t=JsonModelManager.instance.getModeldujie()[this.data.quality],n=GameCommon.getInstance().onParseAwardItemstr(t.jiangli),a=n[0];e=a.num;var i=(GameCommon.getInstance().getThingModel(a.type,a.id),new Date(this.data.time));new Array;this.time_ymd_lab.text=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),this.time_hms_lab.text=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),this.label_content.textFlow=DataManager.getInstance().escortManager.getTextFlow(this.data)},t}(eui.Component);__reflect(EscortRobitem.prototype,"EscortRobitem");var SonniePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.isPlay=!1,n.isOneKey=!1,n.max=3,n.time=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SonniePanelSkin},t.prototype.onInit=function(){var t=Constant.get(Constant.ESCORT_SHUAXIN).split(",")[1];this.one_key_lab.text="消耗："+t+"钻石",this.items=[],this.data=DataManager.getInstance().escortManager.escort;for(var n=0;4>n;n++)this.items.push(this.itemLayer.getChildAt(n));e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_oneKey.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOneKey,this),this.btn_refresh.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendEscortRefreshQualityMsg,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ESCORT_REFRESH_QUALITY_MESSAGE.toString(),this.onRefreshQualityBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_oneKey.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOneKey,this),this.btn_refresh.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendEscortRefreshQualityMsg,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ESCORT_REFRESH_QUALITY_MESSAGE.toString(),this.onRefreshQualityBack,this)},t.prototype.onRefresh=function(){this.onShowInfo(this.data.quality),this.currQuality=this.data.quality,this.updateGoodsADD()},t.prototype.onShowInfo=function(e){var t;for(t=0;4>t;t++)this.items[t].index=t,this.items[t].selected=!1;this.items[e-1]&&(this.items[e-1].selected=!0),this.awardLayer.removeChildren();var n,a=JsonModelManager.instance.getModeldujie()[e];if(a){var i=GameCommon.getInstance().onParseAwardItemstr(a.jiangli);for(t=0;t<i.length;t++)n=GameCommon.getInstance().createGoodsIntance(i[t]),this.awardLayer.addChild(n)}},t.prototype.onRefreshQualityBack=function(){this.isPlay||(this.isOneKey?this.onRefresh():this.onPlay())},t.prototype.onPlay=function(){this.isPlay=!0,this.time=0,Tool.callbackTime(this.onChange,this,100,this.time,this.currQuality)},t.prototype.onChange=function(e,t){return t++,t>4&&(e++,t=this.currQuality),this.onShowInfo(t),e==this.max&&t==this.data.quality?(this.isPlay=!1,void this.onRefresh()):void Tool.callbackTime(this.onChange,this,100,e,t)},t.prototype.onTouchBtnAdvance=function(){if(!this.isPlay){if(DataManager.getInstance().escortManager.escort.count>=EscortData.MAX_ESCORT_COUNT)return void GameCommon.getInstance().addAlert("已达今日护送上限");var e=[{text:"是否开始本次护送",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.sendEscortDispatchMsg,this)))}},t.prototype.sendEscortDispatchMsg=function(){var e=new Message(MESSAGE_ID.ESCORT_DISPATCH_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.sendEscortRefreshQualityMsg=function(){return this.isPlay?void 0:5==this.data.quality?void GameCommon.getInstance().addAlert("已达最大品质"):void this.onSendRefreshQuality(0)},t.prototype.updateGoodsADD=function(){if(this.data.refresh<EscortData.MAX_REFRESH_COUNT)this.label_time.text="免费："+(EscortData.MAX_REFRESH_COUNT-this.data.refresh);else{var e=DataManager.getInstance().bagManager.getGoodsThingNumById(30,GOODS_TYPE.ITEM);if(e>0)this.label_time.text="刷新令："+e+"/1";else{var t=Constant.get(Constant.ESCORT_SHUAXIN).split(",")[0];this.label_time.text="消耗："+t+"钻石"}}this.label_remain.text=EscortData.MAX_ESCORT_COUNT-this.data.count+"/"+EscortData.MAX_ESCORT_COUNT},t.prototype.onTouchOneKey=function(){if(!this.isPlay){if(5==this.data.quality)return void GameCommon.getInstance().addAlert("已达最大品质");var e=[{text:"确定一键刷新橙衣仙女吗？",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onSendRefreshQuality,this,1)))}},t.prototype.onSendRefreshQuality=function(e){this.isOneKey=1==e;var t=new Message(MESSAGE_ID.ESCORT_REFRESH_QUALITY_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)},t}(BaseWindowPanel);__reflect(SonniePanel.prototype,"SonniePanel");var SonnieItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.SonnieItemSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"index",{set:function(e){this._index=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){this.img_head.source="escort_fairy_"+(this._index+1)+"_png"},Object.defineProperty(t.prototype,"selected",{set:function(e){this.img_select.visible=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(SonnieItem.prototype,"SonnieItem");var ArenaWinPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.START_HPANIM_Y=30,n.END_HPANIM_Y=170,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ArenaWinPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onShowWithParam=function(t){this.isloadComp&&(this.result_des_lab.text="",this.currhp_rate_lab.text="",this.herohp_anim_grp.removeChildren()),this.param=t,this.param&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this._showleftTime=11,Tool.addTimer(this.onCloseTimedown,this,1e3);var t=DataManager.getInstance().arenaManager.ladderArenaData,n=0;this.param.result==FightDefine.FIGHT_RESULT_SUCCESS?(this.currentState="win",n=Math.min(50,10*(t.wincount-1)),this.awardscore=t.model.winjifen+n,this.result_des_lab.text=Language.instance.parseInsertText("lianshengchangci",t.wincount)):(this.currentState="lost",this.awardscore=t.model.lostjifen,this.result_des_lab.text=""),t.scoreCount=t.scoreCount-this.awardscore,t.onUpdateScore(),this.grade_icon_img.source="arena_ladder_grade"+t.model.type+"_png",this.score_result_lab.text=Language.instance.getText("huodejifen")+"："+this.awardscore+(n>0?"("+Language.instance.getText("liansheng")+"+"+n+")":"");var a=JsonModelManager.instance.getModelttre()[t.model.type-1];this.score_probar.maximum=a.maxjifen,this.score_probar.value=t.score,this.anim_grp1.x=550,this.anim_grp1.alpha=0,egret.Tween.get(this.anim_grp1).to({x:90,alpha:1},1e3,egret.Ease.cubicIn),Tool.callbackTime(this.onStartProgressAnim,this,2e3);var i=DataManager.getInstance().playerManager.player.getPlayerData().maxHp,o=this.param.hpValue,r=Math.min(100,Math.ceil(o/i*100));this.currhp_rate_lab.text=r+"%",this.currhp_rate_lab.textColor=10>r?16729651:16772198;var s=GameCommon.getInstance().addAnimation("tiantixueqiu",new egret.Point(60,this.END_HPANIM_Y),this.herohp_anim_grp,-1);s.y=this.START_HPANIM_Y+Math.ceil((this.END_HPANIM_Y-this.START_HPANIM_Y)*(100-r)/100),this.anim_grp2.x=550,this.anim_grp2.alpha=0,egret.Tween.get(this.anim_grp2).to({x:550},500).to({x:90,alpha:1},1e3,egret.Ease.cubicIn)},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label=Language.instance.getText("sure")+"("+this._showleftTime+")")},t.prototype.onPlayAwardAnim=function(){},t.prototype.onStartProgressAnim=function(){this._proCount=0,Tool.addTimer(this.onPlayProgressAnim,this,20)},t.prototype.onPlayProgressAnim=function(){if(this._proCount>=this.awardscore)return void Tool.removeTimer(this.onPlayProgressAnim,this,20);this._proCount++;var e=this.score_probar.maximum,t=this.score_probar.value+1;if(this.score_probar.value=t,t>=e){var n=DataManager.getInstance().arenaManager.ladderArenaData,a=JsonModelManager.instance.getModelttre()[n.model.type];a&&(this.score_probar.maximum=a.maxjifen,this.score_probar.value=0,egret.Tween.get(this.grade_icon_img).to({x:-150,alpha:0},600,egret.Ease.circIn).call(function(e){this.grade_icon_img.source="arena_ladder_grade"+e+"_png"},this,[a.type]).to({x:100},20).to({x:0,alpha:1},600))}},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t}(BaseWindowPanel);__reflect(ArenaWinPanel.prototype,"ArenaWinPanel");var LadderArenaParam=function(){function e(){this.dropList=[]}return e}();__reflect(LadderArenaParam.prototype,"LadderArenaParam");var BattlePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onInit=function(){this.setTitle("arena_title_png");var t=[],n=new RegisterSystemParam;n.sysName="LadderArenaPanel",n.btnRes="arena_tab_png",DataManager.getInstance().arenaManager,n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().arenaManager,"getLadderPointShow"),t.push(n),this.registerPage(t,"battleGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(BattlePanel.prototype,"BattlePanel");var LadderAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.ladder_award_ary=[1,2,3,4],n.zs_award_ary=[9,8,7,6,5],n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderAraneAwardPanelSkin},t.prototype.onInit=function(){this.setTitle("txt_jiangliyulan_png"),this.duanwei_tab.name="duanwei_tab",this.zuanshi_tab.name="zuanshi_tab",this.currentState="duanwei_rank",this.onRefresh()},t.prototype.onTabChange=function(e){switch(e.currentTarget.name){case"duanwei_tab":this.currentState="duanwei_rank";break;case"zuanshi_tab":this.currentState="zuanshi_rank"}this.onRefresh()},t.prototype.onRefresh=function(){switch(this.currentState){case"zuanshi_rank":for(var e=0;e<this.zs_award_ary.length;e++){var t=this.zs_award_ary[e],n=JsonModelManager.instance.getModelttjjc()[t-1];this["ladder_title_img"+e].source="arena_laddertxt_lv"+t+"_png";var a=this["award_group"+e];a.removeChildren();for(var i=0;i<n.rewards.length;i++){var o=n.rewards[i],r=new GoodsInstance;r.onUpdate(o.type,o.id,0,o.quality,o.num),a.addChild(r)}}break;case"duanwei_rank":for(var e=0;e<this.ladder_award_ary.length;e++){var t=this.ladder_award_ary[e],n=JsonModelManager.instance.getModelttjjc()[t-1],o=n.rewards;this["ladder_title_img"+e].source="arena_laddertxt_lv"+t+"_png";var a=this["award_group"+e];a.removeChildren();for(var i=0;i<n.rewards.length;i++){var s=n.rewards[i],r=new GoodsInstance;r.onUpdate(s.type,s.id,0,s.quality,s.num),a.addChild(r)}}}this.scroll.viewport.scrollV=0},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.duanwei_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabChange,this),this.zuanshi_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabChange,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.duanwei_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabChange,this),this.zuanshi_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabChange,this)},t}(BaseWindowPanel);__reflect(LadderAwardPanel.prototype,"LadderAwardPanel");var LadderAraneRankPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderAraneRankPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.rank_scroll.verticalScrollBar.autoVisibility=!1,this.rank_scroll.verticalScrollBar.visible=!1,this.ladder_rankList.itemRenderer=LadderAraneRankItem,this.ladder_rankList.itemRendererSkinName=skins.LadderAraneRankItemSkin,this.ladder_rankList.useVirtualLayout=!0,this.rank_scroll.viewport=this.ladder_rankList,this.setTitle("排行榜"),this.onRefresh()
},t.prototype.onRefresh=function(){this.ladder_rankList.dataProvider=new eui.ArrayCollection(DataManager.getInstance().arenaManager.ladderRanks),DataManager.getInstance().arenaManager.selfladderRankData.rank>0?(this.self_rank_num.text=DataManager.getInstance().arenaManager.selfladderRankData.rank+"",this.not_rank_lab.visible=!1,this.rank_num_grp.visible=!0):(this.rank_num_grp.visible=!1,this.not_rank_lab.visible=!0)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t}(BaseWindowPanel);__reflect(LadderAraneRankPanel.prototype,"LadderAraneRankPanel");var LadderAraneRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.rank_num.text=e.rank+"",this.bg_img.source=e.rank%2==0?"public_di1_png":"public_di5_png",this.rank_name_label.text=e.name,this.rank_rongyu_num.text=e.score,this.onUpdate(e.duanwei)},t.prototype.onUpdate=function(e){this.duanwei_icon.source="arena_ladder_grade"+e+"_png"},t}(eui.ItemRenderer);__reflect(LadderAraneRankItem.prototype,"LadderAraneRankItem");var LadderArenaPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.showawardMax=1,n.refreshTime=0,n.SCROLLER_HEIGHT=118,n.isDie=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderArenaPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.Insprite_Max=Constant.get(Constant.LADDER_BUFF_PRICE).split(",").length,GameCommon.getInstance().addUnderlineStr(this.ladder_desc_label),GameCommon.getInstance().addUnderlineStr(this.btn_arane_rank),this.onRefresh()},t.prototype.onRefresh=function(){this.sendLadderInfoMsg(),this.sendLadderRankMsg()},t.prototype.sendLadderInfoMsg=function(){var e=new Message(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.sendLadderRankMsg=function(){var e=new Message(MESSAGE_ID.ARENE_LADDERARENE_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.updateMsgReceive=function(){var e=DataManager.getInstance().arenaManager.ladderArenaData,t=e.model;this.duanwei_item.onUpdate(t.type);var n=JsonModelManager.instance.getModelttre()[t.type];this.nextduanwei_item.onUpdate(n?n.type:t.type),this.win_count_lab.text=Language.instance.parseInsertText("lianshengchangci",Math.max(e.wincount,0)),this.score_probar.maximum=t.maxjifen,this.score_probar.value=e.score,this.score_probar.labelFunction=function(e,t){return"积分："+e+"/"+t};var a=100,i=e.heroHpNum;if(0==DataManager.getInstance().arenaManager.ladderArenaData.ladderStatus){var o=DataManager.getInstance().playerManager.player.getPlayerData().attributes[ATTR_TYPE.HP];a=Math.min(100,Math.ceil(i/o*100))}this.currhp_rate_lab.text=a+"%",this.currhp_rate_lab.textColor=10>a?16729651:16772198,this.hp_scroller.height=Math.floor(this.SCROLLER_HEIGHT*a/100),this.isDie=0>=i,this.onUpdateInspire(),0==DataManager.getInstance().arenaManager.ladderArenaData.ladderStatus?this.lefttimes_lab.text=Language.instance.getText("shengyucishu")+"："+e.fightCount+"/"+GameDefine.LADDER_FIGHTCOUNT_MAX:this.lefttimes_lab.text=Language.instance.getText("activity","unopen")},t.prototype.onUpdateInspire=function(){var e=DataManager.getInstance().arenaManager.ladderArenaData;this.inspire_status_lab.text=Language.instance.getText("yiguwu")+":"+e.inspireCount+"/"+this.Insprite_Max},t.prototype.onUpdateRankInfo=function(){var e=DataManager.getInstance().arenaManager.ladderArenaData,t=DataManager.getInstance().arenaManager.selfladderRankData,n=t?t.rank:0;n>0?(this.arane_ranknum_label.text=n+"",this.arane_ranknum_null.visible=!1):(this.arane_ranknum_label.text="",this.arane_ranknum_null.visible=!0);for(var a=0;3>a;a++){var i=DataManager.getInstance().arenaManager.ladderRanks[a],o=this["rank_name_label"+(a+1)],r=this["rank_score_label"+(a+1)];i?(o.text=i.name,r.text=(i.rebirthLv>0?i.rebirthLv+"阶":"")+i.level+"级"):(o.text="暂无",r.text="")}var s=[];ModelManager.getInstance().getModelLength("ttre");for(var h in JsonModelManager.instance.getModelttjjc()){var l=JsonModelManager.instance.getModelttjjc()[h];l.lv==e.model.type&&(s=l.rewards)}for(var a=0;a<this.showawardMax;a++){var g=this["award_item"+a];if(s.length>a){var c=s[a];g.onUpdate(c.type,c.id,0,c.quality,c.num),g.parent||this.arane_award_group.addChildAt(g,a)}else g.parent&&this.arane_award_group.removeChild(g),g.onReset()}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_seach_enemy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeachEnemy,this),this.btn_award_loop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwardPanel,this),this.btn_arane_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRankPanel,this),this.btn_arane_shop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShopHandler,this),this.btn_inspire.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE.toString(),this.updateMsgReceive,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_RANK_MESSAGE.toString(),this.onUpdateRankInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_INSPIRE_MESSAGE.toString(),this.onUpdateInspire,this),Tool.addTimer(this.ontimedownHandler,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_seach_enemy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeachEnemy,this),this.btn_award_loop.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwardPanel,this),this.btn_arane_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRankPanel,this),this.btn_arane_shop.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShopHandler,this),this.btn_inspire.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this),this.explainLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_UPDATE_MESSAGE.toString(),this.updateMsgReceive,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_RANK_MESSAGE.toString(),this.onUpdateRankInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_LADDERARENE_INSPIRE_MESSAGE.toString(),this.onUpdateInspire,this),Tool.removeTimer(this.ontimedownHandler,this,1e3)},t.prototype.onTouchExplain=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",Language.instance.getText("ladder_shuoming")))},t.prototype.onSeachEnemy=function(){GameFight.getInstance().onSendLadderArenaFightMsg()},t.prototype.ontimedownHandler=function(){var e=-1,t=DataManager.getInstance().arenaManager.ladderArenaData;0==DataManager.getInstance().arenaManager.ladderArenaData.ladderStatus?(FunDefine.isLadderOpen=!0,this.open_title_lab.text=Language.instance.getText("activity","shengyushijian")+"：",t.fightCount<GameDefine.LADDER_FIGHTCOUNT_MAX?(e=Math.max(0,Math.ceil((t.leftRecover-egret.getTimer())/1e3)),e>0?this.time_cd_lab.text=GameCommon.getInstance().getTimeStrForSec2(e,!1)+Language.instance.getText("houhuifucishu"):this.time_cd_lab.text=""):this.time_cd_lab.text=""):(FunDefine.isLadderOpen=!1,this.open_title_lab.text=Language.instance.getText("distance","activity","open")+"：",this.time_cd_lab.text="");var n=Math.max(0,Math.ceil((t.statusTime-egret.getTimer())/1e3));this.open_time_lab.text=GameCommon.getInstance().getTimeStrForSec2(n,!1),(0>=n||0==e)&&(this.sendLadderInfoMsg(),this.refreshTime=egret.getTimer()+1e4),0==this.refreshTime?this.refreshTime=egret.getTimer()+2e4:this.refreshTime<egret.getTimer()&&(this.sendLadderRankMsg(),this.refreshTime=egret.getTimer()+2e4)},t.prototype.onOpenAwardPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LadderAwardPanel")},t.prototype.onOpenRankPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LadderAraneRankPanel")},t.prototype.onShopHandler=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PvPShopPanel")},t.prototype.onInspire=function(){return DataManager.getInstance().arenaManager.ladderArenaData.ladderStatus>0?void GameCommon.getInstance().addAlert("error_tips_21"):void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LadderInspirePanel")},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(LadderArenaPanel.prototype,"LadderArenaPanel");var LadderAreneItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.LadderItemSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){},t.prototype.onUpdate=function(e){this.duanwei_icon.source="arena_laddericon_lv"+e+"_png",this.duanwei_img.source="arena_ladder_grade"+e+"_png"},t}(eui.Component);__reflect(LadderAreneItem.prototype,"LadderAreneItem");var LadderReadyPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderReadySkin},t.prototype.onShowWithParam=function(t){this.enemydata=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.playNum=5,this.power_grp.visible=!1,this.name_grp.visible=!1,this.sure_btn.visible=!1,this.headicon_grp.removeChildren(),this.onPlay()},t.prototype.onPlay=function(){if(this._isShow){if(0==this.playNum)return void this.onPlayFinish();this.playNum--;var e=this.playNum>0?Math.floor(Math.random()*GameDefine.Max_Role_Head):this.enemydata.headiconIdx,t=new eui.Image;t.source=GameCommon.getInstance().getBigHeadByOccpation(e),t.width=160,t.height=160,this.headicon_grp.addChild(t),t.x=10,t.y=100;var n=this.playNum>0?-180:0;egret.Tween.get(t).to({y:n},1e3,this.playNum>0?null:egret.Ease.sineOut),Tool.callbackTime(this.onPlay,this,600)}},t.prototype.onPlayFinish=function(){this._isShow&&(this._showleftTime=4,this.power_grp.visible=!0,this.name_grp.visible=!0,this.sure_btn.visible=!0,this.name_lab.text=this.enemydata.name,this.power_lab.text=""+this.enemydata.figthPower,Tool.addTimer(this.onCloseTimedown,this,1e3))},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?void this.onTouchCloseBtn():void(this.sure_btn.label=Language.instance.getText("fight")+("("+this._showleftTime+"S)"))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.sure_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LADDER_FIGHT_START_EVENT))},t}(BaseWindowPanel);__reflect(LadderReadyPanel.prototype,"LadderReadyPanel");var LadderInspirePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderInspireSkin},t.prototype.onInit=function(){this.setTitle("天梯鼓舞"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().arenaManager.ladderArenaData,t=Constant.get(Constant.LADDER_BUFF_PRICE).split(","),n=t.length,a=e.inspireCount,i=GameCommon.getInstance().readStringToHtml("[#5aff91"+FightDefine.ladderBuffEffect[a]+"%]");this.add_desc_lab.textFlow=(new egret.HtmlTextParser).parse(Language.instance.parseInsertText("ladder_insprite",i)),this.times_lab.text=Language.instance.getText("current","yiguwu")+":"+e.inspireCount+"/"+n,n>a?(this.buy_button.label=Language.instance.getText("inspire"," ",t[a],"currency5"),this.buy_button.enabled=!0):(this.buy_button.label=Language.instance.getText("error_tips_7"),this.buy_button.enabled=!1)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.buy_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.buy_button.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this)},t.prototype.onInspire=function(){var e=new Message(MESSAGE_ID.ARENE_LADDERARENE_INSPIRE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onTouchCloseBtn()},t}(BaseWindowPanel);__reflect(LadderInspirePanel.prototype,"LadderInspirePanel");var RevivePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.biangqiangAllGotype=[2,4,17,18,19,20,5,57],n.priority=PANEL_HIERARCHY_TYPE.II,n.allbianqiangBtns=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.DupLosePanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.addGotypeEventListener()}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.removeGotypeEventListener()}},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameFight.getInstance().fightScene.onFightLose()},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.bianqiang_Scroller.verticalScrollBar.autoVisibility=!1;for(var t=0;t<this.biangqiangAllGotype.length;t++){var n=this.biangqiangAllGotype[t],a=new StrongerButton;a.registGotype(n),this.allbianqiangBtns.push(a),this.bianqiang_groud.addChild(a)}this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this._showleftTime=6;for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.registGotype(n.gotype)}Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.onShowWithParam=function(t){e.prototype.onShowWithParam.call(this,t)},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label="复活("+this._showleftTime+")")},t.prototype.onTouchBtn=function(e){},t}(BaseWindowPanel);__reflect(RevivePanel.prototype,"RevivePanel");var FSAdvancePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.auto=!1,n.aniName="",n.currTier=0,n.currTierStar=0,n.currTierStarExp=0,n.animPos=new egret.Point(344,440),n.magicPos=new egret.Point(344,494),n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FSAdvancePanelSkin},t.prototype.onInit=function(){this.points[0].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().magicManager,"checkMagicAdvancePoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),this.btn_autoAdvance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAutoAdvance,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_ADVANCE_MESSAGE.toString(),this.onAdvanceBack,this),this.auto=!1},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),this.btn_autoAdvance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAutoAdvance,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_ADVANCE_MESSAGE.toString(),this.onAdvanceBack,this)},t.prototype.onRefresh=function(){this.onShowInfo(),this.onUpdatePower(),this.updateAvatarAnim()},t.prototype.updateAvatarAnim=function(){for(var e="",t=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];this.avatar_grp.numChildren>0;){var n=this.avatar_grp.getChildAt(0);egret.is(n,"BodyAnimation")||egret.is(n,"Animation")?n.onDestroy():this.avatar_grp.removeChild(n)}e=""+t.waixing1;var a=new Animation(e);this.avatar_grp.addChild(a),this.avatar_grp.y=350},t.prototype.labelFunction=function(e,t){var n=e/t*this.thumb.width;return egret.Tween.get(this.animLayer.getChildAt(0)).to({x:n},12),e+"/"+t},t.prototype.onAdvanceBack=function(){var e,t,n=this.getPlayer().magicTier-this.currTier;0!=n?(e=DataManager.getInstance().magicManager.currTierExp+(this.maxExp-this.currTierStarExp),GameCommon.getInstance().addAnimation("jinjiechenggong",this.animPos,this.animLayer)):e=DataManager.getInstance().magicManager.currTierExp-this.currTierStarExp;var a=Math.abs(this.getPlayer().magicTierStar-this.currTierStar);if(0!=a){var i=new egret.Point(330,330);GameCommon.getInstance().addAnimation("xianyujinjie",i,this.animLayer)}if(t=e/this.addExp,this.maxExp>0&&(2==t?GameCommon.getInstance().addAnimation("baoji1",this.animPos,this.animLayer):5==t&&GameCommon.getInstance().addAnimation("baoji2",this.animPos,this.animLayer)),this.onRefresh(),this.auto&&0==n)this.onTouchBtnAdvance();else{this._auto=!1;var o=this.auto?"quxiaojinjie":"zidongjinjie";this.btn_autoAdvance.label=Language.instance.getText(o)}},t.prototype.onUpdatePower=function(){this.powerBar.power=DataManager.getInstance().magicManager.magicAdvancePower+""},t.prototype.onShowStarAnim=function(){if(0!=this.getPlayer().magicTierStar){var e=this.starAnimLayer.width/17*(this.getPlayer().magicTierStar-1)+this.starAnimLayer.width/20,t=new egret.Point(e,0);GameCommon.getInstance().addAnimation("zuoqishengxing",t,this.starAnimLayer)}},t.prototype.onShowMagicAnim=function(){JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar]},t.prototype.onShowInfo=function(){this.currTier=this.getPlayer().magicTier,this.currTierStar=this.getPlayer().magicTierStar,this.currTierStarExp=DataManager.getInstance().magicManager.currTierExp;var e=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar],t=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicNextTierKey][this.getPlayer().MagicNextStar],n=e||t;e&&t&&(n=t),t?(10==this.getPlayer().magicTierStar?this.currentState="maxStar":this.currentState="advance",this.maxExp=t.exp,this.addExp=t.itemExp):e&&!t&&(this.currentState="max");var a;this.curPro.removeChildren(),this.nextPro.removeChildren();var i=0;for(var o in n.attrAry)n.attrAry[o]>0&&(i=e?e.attrAry[o]:0,a=new AttributesText,a.updateAttr(o,i),this.curPro.addChild(a),i=t?t.attrAry[o]:0,a=new AttributesText,a.updateAttr(o,i),this.nextPro.addChild(a));JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];if(this.label_name.text=this.getPlayer().MagicStarLv+"\n阶",this.progress.minimum=0,this.progress.maximum=n.exp,this.progress.value=DataManager.getInstance().magicManager.currTierExp,t){GameCommon.getInstance().getThingModel(t.cost.type,t.cost.id);this.currency.visible=!0,this.currency.setCostByAwardItem(t.cost)}this.onShowStar()},t.prototype.onShowStar=function(){for(var e,t=0;10>t;t++)e=this["img_star"+t],t+1<=DataManager.getInstance().playerManager.player.magicTierStar?e.source="star_png":e.source="starGrey_png"},t.prototype.onTouchBtnAdvance=function(){var e=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];e&&GameCommon.getInstance().onCheckItemConsume(e.cost.id,1,e.cost.type)?DataManager.getInstance().magicManager.onSendAdvanceMessage():this._auto=!1},t.prototype.onTouchBtnAutoAdvance=function(){this._auto=!this.auto,this.auto&&this.onTouchBtnAdvance()},Object.defineProperty(t.prototype,"_auto",{set:function(e){this.auto=e;var t=this.auto?"quxiaojinjie":"zidongjinjie";this.btn_autoAdvance.label=Language.instance.getText(t)},enumerable:!0,configurable:!0}),t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(FSAdvancePanel.prototype,"FSAdvancePanel");var FSTreasurePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.isRun=!1,n.currHasNum=0,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FSTreasurePanelSkin},t.prototype.onInit=function(){for(var t,n=0;5>n;n++)t=new FSTreasureItem(n),this.boxLayer.addChild(t);this.model=JsonModelManager.instance.getModelfabaozhuanpan()[1],this.points[0].register(this.btn_turn,GameDefine.RED_BTN_POS,DataManager.getInstance().magicManager,"checkMagicTurnplatePoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_TURNPLATE_MESSAGE.toString(),this.onRotateback,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTurn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_TURNPLATE_MESSAGE.toString(),this.onRotateback,this)},t.prototype.onRefresh=function(){this.onShowTurnplate()},t.prototype.onPlayDone=function(){this.onShowAward()},t.prototype.onShowAward=function(){var e=GameCommon.getInstance().onParseAwardItemstr(this.model.itme),t=DataManager.getInstance().bagManager.getGoodsThingNumById(e[0].id,e[0].type)-this.currHasNum;if(t>0){var n=GameCommon.getInstance().getThingModel(e[0].type,e[0].id);GameCommon.getInstance().onGetThingAlert(n,t,GOODS_CHANGE_TYPE.DELAY_ADD)}},t.prototype.onRotateback=function(){if(!this.isRun){this.isRun=!0;var e=DataManager.getInstance().magicManager.numIndex;Tool.log("`````````````````````````````````````````````````````````:"+e);var t,n=DataManager.getInstance().magicManager.multipleIndex;t=this.getRotationLong(4,5,6,n,-1),egret.Tween.get(this.disc_inside).to({rotation:t},3e3,egret.Ease.sineInOut).call(this.onPlayDone,this).wait(3e3).call(this.onReady,this),t=this.getRotationLong(8,1,1,e,-1),egret.Tween.get(this.disc_outside).to({rotation:t},2e3,egret.Ease.sineInOut)}},t.prototype.getRotationLong=function(e,t,n,a,i){void 0===i&&(i=1);var o=360/e*a*i,r=360*(Math.floor(Math.random()*(n-t))+t)*i;return r+o},t.prototype.onTouchBtnTurn=function(){this.isRun||DataManager.getInstance().magicManager.onSendTurnplateMessage()},t.prototype.onReady=function(){this.onRefresh()},t.prototype.onShowTurnplate=function(){var e=DataManager.getInstance().magicManager;for(n=0;5>n;n++)this.boxLayer.getChildAt(n).onUpdate();if(this.playLayer.visible=!1,this.isRun=!1,!(e.turnMax<=e.turnTime)){var t=GameCommon.getInstance().onParseAwardItemstr(this.model.itme);this.currHasNum=DataManager.getInstance().bagManager.getGoodsThingNumById(t[0].id,t[0].type),this.playLayer.visible=!0;var n,a,i=JsonModelManager.instance.getModelfabaozhuanpan()[e.turnTime+1],o=i.multiply.split("#");for(n=0;n<o.length;n++)a=o[n].split(","),this["img_multiple"+n].text=a[0];o=i.num.split("#"),n=0;var t=GameCommon.getInstance().onParseAwardItemstr(i.itme),r=GameCommon.getInstance().getThingModel(t[0].type,t[0].id);for(n=0;n<o.length;n++)a=o[n].split(","),this["img_icon"+n].source=r.dropicon,this["label_num"+n].text=a[0];r=GameCommon.getInstance().getThingModel(i.cost.type,i.cost.id),this.img_cons.source=r.dropicon,this.label_points.text=i.cost.num.toString();var s=DataManager.getInstance().playerManager.player.getICurrency(i.cost.type);s<i.cost.num?this.label_points.textColor=16711680:this.label_points.textColor=15326899}},t}(BaseTabView);__reflect(FSTreasurePanel.prototype,"FSTreasurePanel");var FSTreasureItem=function(e){function t(t){var n=e.call(this)||this;return n.icons=[0,0,1,2,3],n._index=t,n.skinName=skins.FSTreasureItemSkin,n}return __extends(t,e),t.prototype.onUpdate=function(){var e=DataManager.getInstance().magicManager;this.img_arrow.visible=this._index==e.turnTime,this._index+1>e.turnTime?this.img_box.source="cross_pveboss_box_unopen_png":this._index+1<=e.turnTime&&(this.img_box.source="cross_pveboss_box_open_png")},t}(eui.Component);__reflect(FSTreasureItem.prototype,"FSTreasureItem");var FSUpgradePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.progessNum=[0,9,20,31.5,43.3,55,66,78,90,100,100],n.aniName="",n.currLv=0,n.currTier=0,n.animPos=new egret.Point(344,440),n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FSUpgradePanelSkin},t.prototype.onInit=function(){DataManager.getInstance().magicManager.CDOwner=this,this.points[0].register(this.btn_update,GameDefine.RED_BTN_POS,DataManager.getInstance().magicManager,"checkMagicUpgradePoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_update.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_UPGRADE_MESSAGE.toString(),this.onUpgradeback,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_update.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAGIC_UPGRADE_MESSAGE.toString(),this.onUpgradeback,this)},t.prototype.onRefresh=function(){this.onShowMagicAnim(),this.onShowInfo(),this.onUpdatePower(),this.updateAvatarAnim()},t.prototype.updateAvatarAnim=function(){for(var e="",t=JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];this.avatar_grp.numChildren>0;){var n=this.avatar_grp.getChildAt(0);egret.is(n,"BodyAnimation")||egret.is(n,"Animation")?n.onDestroy():this.avatar_grp.removeChild(n)}e=""+t.waixing1;var a=new Animation(e);this.avatar_grp.addChild(a),this.avatar_grp.y=350},t.prototype.onUpgradeback=function(){var e=this.getPlayer().magicLv-this.currLv;if(0!=e)GameCommon.getInstance().addAnimation("shengjichenggong",this.animPos,this.animLayer);else{var t=Math.abs(this.getPlayer().magicLvExp-this.currTier);2==t?GameCommon.getInstance().addAnimation("baoji1",this.animPos,this.animLayer):5==t&&GameCommon.getInstance().addAnimation("baoji2",this.animPos,this.animLayer)}this.onRefresh()},t.prototype.onShowUpdateAnim=function(){var e=(this.ExpBar.width-36)*this.progessNum[this.getPlayer().magicLvExp]/100,t=new egret.Point(e,0);GameCommon.getInstance().addAnimation("fabaoshengji",t,this.ExpBar.animLayer)},t.prototype.onShowMagicAnim=function(){},t.prototype.onUpdatePower=function(){this.powerBar.power=DataManager.getInstance().magicManager.magicUpgradePower+""},t.prototype.onShowInfo=function(){this.currLv=this.getPlayer().magicLv,this.currTier=this.getPlayer().magicLvExp;var e=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][this.getPlayer().magicLvExp],t=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().MagicNextlv][Number(this.getPlayer().magicLvExp)+1],n=!1;"1"==this.getPlayer().Magiclv&&0==this.getPlayer().magicLvExp&&(n=!0,e=null),"1"==this.getPlayer().Magiclv&&(e=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][Number(this.getPlayer().magicLvExp)-1],t="1"==this.getPlayer().Magiclv&&9==this.getPlayer().magicLvExp?JsonModelManager.instance.getModelfabaoshengji()[Number(this.getPlayer().Magiclv)+1][0]:JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][this.getPlayer().magicLvExp]);var a=e||t;e&&t&&(a=t),t?this.currentState="advance":e&&!t&&(JsonModelManager.instance.getModelfabaoshengji()[Number(this.getPlayer().Magiclv)+1]&&(t=JsonModelManager.instance.getModelfabaoshengji()[Number(this.getPlayer().Magiclv)+1][0]),t||(this.currentState="max"));var i;this.curPro.removeChildren(),this.nextPro.removeChildren();var o=0;for(var r in a.attrAry)a.attrAry[r]>0&&(o=e?e.attrAry[r]:0,i=new AttributesText,i.updateAttr(r,o),this.curPro.addChild(i),o=t?t.attrAry[r]:0,i=new AttributesText,i.updateAttr(r,o),this.nextPro.addChild(i));JsonModelManager.instance.getModelfabaojinjie()[this.getPlayer().MagicStarLv][this.getPlayer().MagicStar];this.label_name.text=this.getPlayer().magicLv+"\n级",this.ExpBar.maximum=100,this.ExpBar.minimum=0,this.ExpBar.value=this.progessNum[this.getPlayer().magicLvExp],t&&(this.currency.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.GOLD,0,t.gold),!1)),this.onCountDown()},t.prototype.onCountDown=function(){var e=DataManager.getInstance().magicManager,t=Math.max((e.totalTime-e.lastTime)/1e3,0);this.label_cd.textFlow=new Array({text:"剩余次数:",style:{}},{text:e.currCanUpNum+"/"+e.maxTime+" ",style:{textColor:5431826}},{text:GameCommon.getInstance().getTimeStrForSec2(t),style:{}})},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchBtnUpdate=function(){var e=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][this.getPlayer().magicLvExp];"1"==this.getPlayer().Magiclv&&this.getPlayer().magicLvExp>0&&(e=JsonModelManager.instance.getModelfabaoshengji()[this.getPlayer().Magiclv][Number(this.getPlayer().magicLvExp)-1]),(e||GameCommon.getInstance().onCheckItemConsume(0,e.gold,GOODS_TYPE.GOLD))&&DataManager.getInstance().magicManager.onSendUpdateMessage()},t}(BaseTabView);__reflect(FSUpgradePanel.prototype,"FSUpgradePanel");var ForgePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_QIANGHUA,n._isReset=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.btnRes="锻造",n.redP=this.createRedPoint(),n.tabBtns=[];var a=new RegisterTabBtnParam;a.sysName="IntensifyPanel",a.funcID=FUN_TYPE.FUN_QIANGHUA,a.tabBtnRes="z_btn_icon_qianghua_png",a.title="强化",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().forgeManager,"getIntensifyPointShow"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="InfusePanel",a.funcID=FUN_TYPE.FUN_ZHULING,a.tabBtnRes="z_btn_icon_zhuling_png",a.title="注灵",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().forgeManager,"getInfusePointShow"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="GemInlayPanel",a.funcID=FUN_TYPE.FUN_BAOSHI,a.tabBtnRes="z_btn_icon_baoshi_png",a.title="宝石",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().forgeManager,"getGemPointShow"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="ZhuHunPanel",a.funcID=FUN_TYPE.FUN_LIANHUA,a.tabBtnRes="z_btn_icon_lianhua_png",a.title="炼化",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().forgeManager,"checkLianhuaPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="QuenchingPanel",a.funcID=FUN_TYPE.FUN_CUILIAN,a.tabBtnRes="z_btn_icon_cuilian_png",a.title="淬炼",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().forgeManager,"checkQuenchingPoint"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.btnRes="仙玉",n.funcID=FUN_TYPE.FUN_FIGHTSPRITE,n.redP=this.createRedPoint(),n.tabBtns=[],a=new RegisterTabBtnParam,a.sysName="FSUpgradePanel",a.tabBtnRes="z_btn_icon_levelup_png",a.title="仙玉",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().magicManager,"checkMagicUpgradePoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="FSAdvancePanel",a.tabBtnRes="z_btn_icon_jinjie_png",a.title="仙玉",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().magicManager,"checkMagicAdvancePoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="FSTreasurePanel",a.tabBtnRes="z_btn_icon_xunbao_png",a.title="仙玉",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().magicManager,"checkMagicTurnplatePoint"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.btnRes="战纹",n.funcID=FUN_TYPE.FUN_RNUES,n.redP=this.createRedPoint(),n.tabBtns=[],a=new RegisterTabBtnParam,a.sysName="ZhanWenViewPanel",a.funcID=FUN_TYPE.FUN_RNUES,a.tabBtnRes="z_btn_icon_levelup_png",a.title="战纹",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().bagManager,"checkAllEquipPointPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="ZhanWenComposePanel",a.tabBtnRes="z_btn_icon_hecheng_png",a.title="战纹",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().bagManager,"getRnuesLvPoint"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.btnRes="天书",n.funcID=FUN_TYPE.FUN_TIANSHU,n.redP=this.createRedPoint(),n.tabBtns=[],a=new RegisterTabBtnParam,a.sysName="TianshuLevelUpPanel",a.funcID=FUN_TYPE.FUN_TIANSHU,a.tabBtnRes="z_btn_icon_levelup_png",a.title="天书",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().playerManager,"oncheckRPTianshuLevel"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="TianshuUpgradePanel",a.funcID=FUN_TYPE.FUN_TIANSHU_TUPO,a.tabBtnRes="z_btn_icon_jinjie_png",a.title="天书",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().playerManager,"oncheckRPTianshuGrade"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="YuanJiePanel",a.tabBtnRes="z_btn_icon_yuanjie_png",a.title="元戒",a.funcID=FUN_TYPE.FUN_YUANJIE,a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().yuanjieManager,"checkRedPoint"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.btnRes="仙山",n.funcID=FUN_TYPE.FUN_XIANSHAN,n.redP=this.createRedPoint(),n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianShanPoint"),n.tabBtns=[],a=new RegisterTabBtnParam,a.sysName="XianDanDupPanel",a.title="仙山",a.tabBtnRes="z_btn_icon_xianshan_png",a.redP=this.createRedPoint(),a.funcID=FUN_TYPE.FUN_XIANSHAN,a.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianShanPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="XianDanTabView",a.title="仙丹",a.tabBtnRes="z_btn_icon_xd0_png",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",1),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="XianDanTabView",a.title="仙丹",a.tabBtnRes="z_btn_icon_xd1_png",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",2),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="XianDanTabView",a.title="仙丹",a.tabBtnRes="z_btn_icon_xd2_png",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",3),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="XianDanTabView",a.title="仙丹",a.tabBtnRes="z_btn_icon_xd3_png",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",4),n.tabBtns.push(a),t.push(n),this.registerPage(t,"forgeGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()
},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.checkActivity()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){4==this.index&&this.setTitle("z_title_yuanjie_png"),e.prototype.onRefresh.call(this)},t.prototype.checkActivity=function(){var e=DataManager.getInstance().newactivitysManager.dabiao_model;e&&(14==e.type&&1==this.tabs[2].enabled?(this.basic.tipsLayer.visible=!0,this.basic.tipsLayer.x=202):this.basic.tipsLayer.visible=!1)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t}(BaseSystemPanel);__reflect(ForgePanel.prototype,"ForgePanel");var ForgeSlot=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"slotType",{set:function(e){this._slottype!=e&&(this._slottype=e,this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[this._slottype]+"_png")},enumerable:!0,configurable:!0}),t.prototype.setinfo=function(e){this.info1_lab.text="+"+e},Object.defineProperty(t.prototype,"selected",{set:function(e){this.selectLayer.visible=e,e?(this.selectedAnim||(this.selectedAnim=new Animation("zhuangbeixuanzhong",-1),this.selectedAnim.scaleX=.6,this.selectedAnim.scaleY=.58,this.selectedAnim.y=-38,this.selectLayer.addChild(this.selectedAnim)),this.selectedAnim.onPlay()):this.selectedAnim&&this.selectedAnim.onStop()},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(ForgeSlot.prototype,"ForgeSlot");var suitAttributeItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,t.onInit,t),t}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.suitAttributeItemSkin},t.prototype.onInit=function(){},t.prototype.dataChanged=function(){this.param=this._data,this.attrname_label.text=this.param[0],this.param[2]>0?this.attrvalue_label.textFlow=[{text:this.param[1],style:{textColor:65280}}]:this.attrvalue_label.textFlow=[{text:this.param[1],style:{textColor:16777215}}],this.onInit()},t}(BaseComp);__reflect(suitAttributeItem.prototype,"suitAttributeItem");var ForgePosInfo=function(){function e(e,t,n,a,i){void 0===a&&(a=-1),void 0===i&&(i=0),this.posX=e,this.posY=t,this.scale=n,this.childNum=a,this.rotationNum=i}return e}();__reflect(ForgePosInfo.prototype,"ForgePosInfo");var GemInlayPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.currGemIndex=0,n.animPos=new egret.Point(312,270),n.points=RedPointManager.createPoint(3),n.selectPosX=[1,1,1,1,1],n.selectPosY=[1,1,1,1,1],n.isPlay=!1,n.playedNum=0,n.oldIdx=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.GemInlayPanelSkin},t.prototype.onInit=function(){this.equipRecordPos=[],this.gemRecordPos=[];for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],e.slotType=t,e.setinfo(this.getPlayerData().getEquipSlotThings(t).gemLv);this.points[0].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().forgeManager,"getGemPointShow"),this.points[1].register(this.btn_advance_all,GameDefine.RED_BTN_POS,this,"onCheckAdvanceAll"),this.points[2].register(this.strengthenMasterBtn,new egret.Point(65,5),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI),this.equip_bar_0.slotDI.rotation=100,this.equip_bar_1.slotDI.rotation=130,this.equip_bar_2.slotDI.rotation=165,this.equip_bar_3.slotDI.rotation=185,this.equip_bar_4.slotDI.rotation=230,this.equip_bar_5.slotDI.rotation=-65,this.equip_bar_6.slotDI.rotation=-5,this.equip_bar_7.slotDI.rotation=0,this.equip_bar_8.slotDI.rotation=35,this.equip_bar_9.slotDI.rotation=65,this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.resetPos(),this.updateEquipSlot(),this.updateGemInlay(),this.onUpdatePlayerPower()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.btn_advance_all.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceAllClick,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GEM_UPGRADE_MESSAGE.toString(),this.onGemUpgrade,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.btn_advance_all.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceAllClick,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GEM_UPGRADE_MESSAGE.toString(),this.onGemUpgrade,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRefresh=function(){this.data=this.getPlayerData().currGemInlay,this.updateGoodsADD()},t.prototype.strongerBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI))},t.prototype.onCheckAdvanceAll=function(){var e=55;return DataManager.getInstance().playerManager.player.level<e?!1:DataManager.getInstance().forgeManager.getGemPointShow()},t.prototype.updateSlotInfo=function(){for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],e.setinfo(this.getPlayerData().getEquipSlotThings(t).gemLv)},t.prototype.onGemUpgrade=function(){this.updateSlotInfo(),this.onUpdatePlayerPower(),this.data=this.getPlayerData().currGemInlay,this.isPlay||this.play(),GameCommon.getInstance().addAnimation("new_baoshi_"+this.currGemIndex,new egret.Point(this["gem_icon"+this.currGemIndex].x+57,this["gem_icon"+this.currGemIndex].y+53),this.animLayer)},t.prototype.resetPos=function(){this.data=this.getPlayerData().currGemInlay,this.currGemIndex=this.data.gemLv%GameDefine.GEM_SLOT_NUM;for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],t==this.data.slot?e.slotDI.source="zhancao_xuanzhong_png":e.slotDI.source="zhancao-weixuanzhong_png";this.selectedAnim||(this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.scaleX=.8,this.selectedAnim.scaleY=.8,this.animLayer.addChild(this.selectedAnim)),this.selectedAnim.y=this["gem_icon"+this.currGemIndex].y+50,this.selectedAnim.x=this["gem_icon"+this.currGemIndex].x+60},t.prototype.play=function(){this.isPlay=!0;var e=this["gem_icon"+this.currGemIndex];e.alpha=0,egret.Tween.get(e).to({alpha:1},300,egret.Ease.cubicOut).call(this.play1,this)},t.prototype.play1=function(){this.currGemIndex=this.currGemIndex+1,this.currGemIndex=this.currGemIndex==GameDefine.GEM_SLOT_NUM?0:this.currGemIndex,this.selectedAnim.y=this["gem_icon"+this.currGemIndex].y+50,this.selectedAnim.x=this["gem_icon"+this.currGemIndex].x+60,this.playDone(!0)},t.prototype.playDone=function(e){e&&(this.currGemIndex!=this.data.gemLv%GameDefine.GEM_SLOT_NUM?this.play1():(this.updateGemInlay(),0==this.currGemIndex?(this.play2(),this.updateEquipSlot()):this.isPlay=!1))},t.prototype.play2=function(){this.isPlay=!1;var e=this["equip_bar_"+this.oldIdx];e.slotDI.source="zhancao-weixuanzhong_png";var t=this["equip_bar_"+this.data.slot];t.slotDI.source="zhancao_xuanzhong_png"},t.prototype.getNowGemInlayEquip=function(){for(var e,t=0,n=0;n<GameDefine.Equip_Slot_Num;n++)if(e=this["equip_bar_"+n],0==e.currCircleIndex){t=n;break}return t},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){if(this.data){var e=this.data.getGemLvByGemSlot(this.data.slot),t=JsonModelManager.instance.getModelbaoshi()[e];this.consumItem.visible=t?!0:!1,t&&this.consumItem.setCostByAwardItem(t.cost)}},t.prototype.onBtnAdvanceClick=function(){if(this.data){var e=this.data.getGemLvByGemSlot(this.data.slot),t=JsonModelManager.instance.getModelbaoshi()[e];if(t){if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num))return;this.sendGemInlay()}else GameCommon.getInstance().addAlert("error_tips_105")}},t.prototype.onBtnAdvanceAllClick=function(){if(this.data){var e=this.data.getGemLvByGemSlot(this.data.slot),t=JsonModelManager.instance.getModelbaoshi()[e];if(t){if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num))return;this.sendGemInlay(99)}else GameCommon.getInstance().addAlert("error_tips_105")}},t.prototype.sendGemInlay=function(e){if(void 0===e&&(e=0),!this.isPlay&&this.data){var t=new Message(MESSAGE_ID.GEM_UPGRADE_MESSAGE);t.setByte(0),t.setByte(e),GameCommon.getInstance().sendMsgToServer(t),this.oldIdx=this.data.slot,this.data=null}},t.prototype.onUpdatePlayerPower=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_BAO_SHI),this.power.power=DataManager.getInstance().forgeManager.getRoleGemPower()+""},t.prototype.updateEquipSlot=function(){},t.prototype.updateGemInlay=function(){this.updateGoodsADD();var e,t=this.data.gemLv%GameDefine.GEM_SLOT_NUM,n=this.data.getGemLvByGemSlot(t),a=GoodsDefine.SLOT_GEMTYPE[this.data.slot][t],i=JsonModelManager.instance.getModelbaoshi(),o=i[n-1],r=i[n];e=o||r;var s,h=0;this.curPro.removeChildren(),this.nextPro.removeChildren();e.attrAry[a]>0&&(h=o?o.attrAry[a]:0,s=new AttributesText,s.updateAttr(a,h),this.curPro.addChild(s),r&&(h=r?r.attrAry[a]:0,s=new AttributesText,s.updateAttr(a,h),this.nextPro.addChild(s))),r?(this.btn_advance.label="升 级",this.currentState="normal"):(this.currentState="max",this.btn_advance.label="已满级")},t.prototype.onGetBtn=function(e){var t;t=JsonModelManager.instance.getModelbaoshi()[0],GameCommon.getInstance().onShowFastBuy(t.cost.id)},t}(BaseTabView);__reflect(GemInlayPanel.prototype,"GemInlayPanel");var GemInlayItem=function(e){function t(t,n){var a=e.call(this)||this;return a.index=t,a.slot=n,a.skinName=skins.GemInlayItemSkin,a}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this.gemlv=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){var e=GoodsDefine.SLOT_GEMTYPE[this.slot][this.index];if(!this.gemlv||this.gemlv<=0)this.label_lv.textColor=10395294,this.label_lv.text=Language.instance.getAttrName(e)+"宝石",this.label_add.text="("+Language.instance.getText("weijihuo")+")",this.img_icon.source="gem_nonactivated_png";else{var t=JsonModelManager.instance.getModelbaoshi()[this.gemlv-1];this.label_lv.textColor=8388352,this.label_lv.text="Lv."+this.gemlv,this.label_add.text=Language.instance.getAttrName(e)+" +"+t.attrAry[e],this.img_icon.source="gem_type_"+e+"_png"}},t}(eui.Component);__reflect(GemInlayItem.prototype,"GemInlayItem");var InfusePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.START_POSX=40,n.END_POSX=210,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.InfusePanelSkin},t.prototype.onInit=function(){this.animPos=new egret.Point(this.width/2+3,347);for(var t,n=0;n<GameDefine.Equip_Slot_Num;n++)t=this["equip_bar_"+n],t.slotType=n;this.points[0].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().forgeManager,"getInfusePointShow"),this.points[1].register(this.strengthenMasterBtn,new egret.Point(65,5),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING),this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.consumItem.consume_name_label.textColor=15987699,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.btn_advanceAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAllAdvanceClick,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_INFUSE_SOUL_MESSAGE.toString(),this.onIntensifyUpgrade,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advanceAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAllAdvanceClick,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_INFUSE_SOUL_MESSAGE.toString(),this.onIntensifyUpgrade,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRefresh=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING),this.data=this.getPlayerData().getEquipSlotThings(this.getPlayerData().currInfuseSoul.slot),this.updateSlotInfo(),this.onUpdatePlayerPower(),this.refreshSlot(),this.showInfuse(this.getPlayerData().currInfuseSoul.slot),this.updateGoodsADD()},t.prototype.trigger=function(){this.points[0].checkPoint(),this.points[1].checkPoint()},t.prototype.strongerBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_ZHU_LING))},t.prototype.onIntensifyUpgrade=function(){this.onRefresh(),GameCommon.getInstance().addAnimation("new_zhuling",this.animPos,this.animLayer)},t.prototype.refreshSlot=function(){for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],t==this.data.slot?(e.selected=!0,this.slot_icon_img.text="+"+this.data.infuseLv,this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[t]+"_png"):e.selected=!1},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){if(this.consumItem.visible=null==this.modeled?!1:!0,this.modeled){null==this.modeled?0:this.modeled.cost.num;this.consumItem.setCostByAwardItem(this.modeled.cost)}},t.prototype.onBtnAllAdvanceClick=function(){if(this.modeled){if(!GameCommon.getInstance().onCheckItemConsume(this.modeled.cost.id,this.modeled.cost.num))return;this.sendInfuse(99)}else GameCommon.getInstance().addAlert("error_tips_10")},t.prototype.onBtnAdvanceClick=function(){if(this.modeled){if(!GameCommon.getInstance().onCheckItemConsume(this.modeled.cost.id,this.modeled.cost.num))return;this.sendInfuse(0)}else GameCommon.getInstance().addAlert("error_tips_10")},t.prototype.sendInfuse=function(e){if(this.data){var t=new Message(MESSAGE_ID.PLAYER_INFUSE_SOUL_MESSAGE);t.setByte(0),t.setByte(e),GameCommon.getInstance().sendMsgToServer(t),this.data=null}},t.prototype.onUpdatePlayerPower=function(){this.power.power=DataManager.getInstance().forgeManager.getRoleInfusePower()+""},t.prototype.updateSlotInfo=function(){for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],e.setinfo(this.getPlayerData().getEquipSlotThings(t).infuseLv)},t.prototype.showInfuse=function(e,t){void 0===t&&(t=!0);var n,a,i;this.infuselv_lab.text="注灵总等级："+this.data.infuseLv,n=this.getInfuseDict(GoodsDefine.EQUIP_SLOT_TYPE[this.data.slot])[this.data.infuseLv-1],a=this.getInfuseDict(GoodsDefine.EQUIP_SLOT_TYPE[this.data.slot])[this.data.infuseLv],this.getPlayerData().currInfuseSoul.slot==e&&(this.modeled=a),i=n||a;var o=this.END_POSX;a?(o=this.START_POSX+Math.round((this.END_POSX-this.START_POSX)*(this.data.infuseExp/a.levelUpExp)),this.progress.maximum=a.levelUpExp,this.progress.value=this.data.infuseExp):this.progress.labelDisplay.visible=!1;var r,s=0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var h in i.attrAry)i.attrAry[h]>0&&(s=n?n.attrAry[h]:0,r=new AttributesText,r.scaleX=.7,r.scaleY=.7,r.updateAttr(h,s),this.curPro.addChild(r),a&&(s=a?a.attrAry[h]:0,r=new AttributesText,r.scaleX=.7,r.scaleY=.7,r.updateAttr(h,s),this.nextPro.addChild(r)));a?this.currentState="normal":this.currentState="max",t&&this.updateGoodsADD()},t.prototype.onGetBtn=function(e){var t;t=this.getInfuseDict(this.data.slot)[1],GameCommon.getInstance().onShowFastBuy(t.cost.id)},t.prototype.getInfuseDict=function(e){return JsonModelManager.instance.getModelronghun()[e]},t}(BaseTabView);__reflect(InfusePanel.prototype,"InfusePanel");var IntensifyPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(2),n.isPlay=!1,n.playedNum=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.IntensifyPanelSkin},t.prototype.onInit=function(){this.animRecords=[];for(var t,n,a=0;a<GameDefine.Equip_Slot_Num;a++)n=this["equip_bar_"+a],n.slotType=a,t=new ForgePosInfo(n.x,n.y,n.scaleX,n.parent.getChildIndex(n)),this.animRecords.push(t);this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.points[0].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().forgeManager,"getIntensifyPointShow"),this.points[1].register(this.strengthenMasterBtn,new egret.Point(65,5),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA),this.consumItem.nameColor=15987699,e.prototype.onInit.call(this),this.resetPos(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advanceAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceAllClick,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_INTENSIFY_MESSAGE.toString(),this.onIntensifyUpgrade,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),this.btn_advanceAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceAllClick,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_INTENSIFY_MESSAGE.toString(),this.onIntensifyUpgrade,this)},t.prototype.onRefresh=function(){this.clothMsgUpdate(),this.onUpdatePlayerPower(),this.showIntensify(this.getPlayerData().currIntensify.slot),this.updateGoodsADD()},t.prototype.trigger=function(){this.points[0].checkPoint(),this.points[1].checkPoint()},t.prototype.strongerBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA))},t.prototype.onIntensifyUpgrade=function(){var e=this.getPlayerData().currIntensify.slot-1;-1==e&&(e=GameDefine.Equip_Slot_Num-1),this.clothMsgUpdate(),this.onUpdatePlayerPower(),this.showIntensify(e,!1);var t=this.getNowIntensifyEquip();t!=this.getPlayerData().currIntensify.slot&&(this.okAnim?(this.okAnim.visible=!0,this.okAnim.playNum=1):(this.okAnim=new Animation("new_qianghua",1,!1),this.okAnim.x=this.width/2+7,this.okAnim.y=350,this.animLayer.addChild(this.okAnim)),this.okAnim.playFinishCallBack(this.onAnimPlayEnd,this),this.isPlay||this.play())},t.prototype.onAnimPlayEnd=function(){this.okAnim&&(this.okAnim.visible=!1)},t.prototype.resetPos=function(){var e=this.getPlayerData().currIntensify.slot,t=this.getPlayerData().getEquipSlotThings(e);this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[e]+"_png",this.info1_lab.text="+"+t.intensifyLv,this["equip_bar_"+e].selected=!0},t.prototype.play=function(){for(var e,t=this.getNowIntensifyEquip(),n=GameDefine.Equip_Slot_Num+t,a=t;n>a;a++)e=this["equip_bar_"+(a>=GameDefine.Equip_Slot_Num?a-GameDefine.Equip_Slot_Num:a)],e.selected=!1;this.playDone()},t.prototype.playDone=function(){var e=this.getPlayerData().getEquipSlotThings(this.getPlayerData().currIntensify.slot);this.info1_lab.text="+"+e.intensifyLv,this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[this.getPlayerData().currIntensify.slot]+"_png",this["equip_bar_"+this.getPlayerData().currIntensify.slot].selected=!0,this.showIntensify(this.getPlayerData().currIntensify.slot)},t.prototype.getNowIntensifyEquip=function(){for(var e,t=0,n=0;n<GameDefine.Equip_Slot_Num;n++)if(e=this["equip_bar_"+n],0==e.currCircleIndex){t=n;break}return t},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){var e=DataManager.getInstance().forgeManager.getIntensifyCost(this.data.slot);this.consumItem.visible=e>0,e>0&&this.consumItem.setConsume(this.model.cost.type,this.model.cost.id,e)},t.prototype.onBtnAdvanceClick=function(){var e=DataManager.getInstance().forgeManager.getIntensifyCost(this.data.slot);if(e>0){if(!this.isPlay){if(!GameCommon.getInstance().onCheckItemConsume(this.model.cost.id,e))return;this.data&&this.sendIntensify(this.data.slot)}}else GameCommon.getInstance().addAlert("装备强化等级达到上限")},t.prototype.onBtnAdvanceAllClick=function(){var e=DataManager.getInstance().forgeManager.getIntensifyCost(this.data.slot);if(e>0){if(!this.isPlay){if(!GameCommon.getInstance().onCheckItemConsume(this.model.cost.id,e))return;this.sendIntensify(99)}}else GameCommon.getInstance().addAlert("装备强化等级达到上限")},t.prototype.sendIntensify=function(e){if(!this.isPlay&&this.data){var t=new Message(MESSAGE_ID.PLAYER_INTENSIFY_MESSAGE);t.setByte(0),t.setByte(e),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onUpdatePlayerPower=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_QIANG_HUA),this.power.power=DataManager.getInstance().forgeManager.getRoleIntensifyPower()+""},t.prototype.clothMsgUpdate=function(){for(var e,t=0,n=0;n<GameDefine.Equip_Slot_Num;n++){var a=this.getPlayerData().getEquipSlotThings(n);e=this["equip_bar_"+n],e.setinfo(a.intensifyLv),t+=a.intensifyLv}this.totallv_lab.text=Language.instance.parseInsertText("qianghuazongdengji",t)},t.prototype.showIntensify=function(e,t){void 0===t&&(t=!0);var n=0;this.data=this.getPlayerData().getEquipSlotThings(e),this.model=JsonModelManager.instance.getModelqianghua()[GoodsDefine.EQUIP_SLOT_TYPE[this.data.slot]];var a,i=DataManager.getInstance().forgeManager.getIntensifyAttr(this.data.slot),o=DataManager.getInstance().forgeManager.getIntensifyAttr(this.data.slot,this.data.intensifyLv+1),n=0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var r in this.model.attrAry)this.model.attrAry[r]>0&&(n=i[r],a=new AttributesText,a.scaleX=.7,a.scaleY=.7,a.updateAttr(r,n),this.curPro.addChild(a),o[r]>0&&(n=o[r],a=new AttributesText,a.scaleX=.7,a.scaleY=.7,a.updateAttr(r,n),this.nextPro.addChild(a)));this.data.intensifyLv<GameDefine.QIANGHUA_MAX?this.currentState="normal":this.currentState="max",t&&this.updateGoodsADD()},t.prototype.onGetBtn=function(e){var t;t=JsonModelManager.instance.getModelqianghua()[GoodsDefine.EQUIP_SLOT_TYPE[this.data.slot]][0],GameCommon.getInstance().onShowFastBuy(t.cost.id)},t}(BaseTabView);__reflect(IntensifyPanel.prototype,"IntensifyPanel");var QuenchingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.animPos=new egret.Point(298,323),n.isMax=!1,n.points=RedPointManager.createPoint(12),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.QuenchingPanelSkin},t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get);for(var t,n=0;n<GameDefine.Equip_Slot_Num;n++)t=this["equip_bar_"+n],t.slotType=n,t.name=n.toString(),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipClick,this),this.points[n].register(t,new egret.Point(58,-5),DataManager.getInstance().forgeManager,"getJobQuenchingBySlot",n);this.points[n].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().playerManager,"checkQuenchingPoint"),this.points[n+1].register(this.strengthenMasterBtn,new egret.Point(65,5),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN),this.selectIndex=this.getPlayerData().getSortQuenching()[0].slot,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.EQUIPSLOT_QUENCHING_MESSAGE.toString(),this.onQuenchingBack,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE,this.updateGoodsADD,this),this.selectIndex=this.getPlayerData().getSortQuenching()[0].slot},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdvanceClick,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.EQUIPSLOT_QUENCHING_MESSAGE.toString(),this.onQuenchingBack,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE,this.updateGoodsADD,this)},t.prototype.onRefresh=function(){this.onSelectedQuenching(),this.onShowInfo(),e.prototype.onRefresh.call(this),this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN)},t.prototype.strongerBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_CUI_LIAN))},t.prototype.onBtnAdvanceClick=function(e){if(this.isMax)return void GameCommon.getInstance().addAlert("full_level");var t=this.getPlayerData().getEquipSlotThings(this.selectIndex),n=this.cuilianDict[t.quenchingLv+1];GameCommon.getInstance().onCheckItemConsume(GoodsDefine.ITEM_ID_CUILIAN,n.costNum)&&this.sendQuenching()},t.prototype.sendQuenching=function(){var e=new Message(MESSAGE_ID.EQUIPSLOT_QUENCHING_MESSAGE);e.setByte(0),e.setByte(this.selectIndex),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onQuenchingBack=function(){var e=this.getPlayerData().getEquipSlotThings(this.selectIndex);e.quenchingLv>this.currLv&&this.onShowStarAnim(),this.onRefresh()},t.prototype.onEquipClick=function(e){this.selectIndex=parseInt(e.currentTarget.name),this.onRefresh()},t.prototype.onSelectedQuenching=function(){for(var e,t,n=0;n<GameDefine.Equip_Slot_Num;n++)e=this["equip_bar_"+n],t=this.getPlayerData().getEquipSlotThings(n),e.setinfo(t.quenchingLv),n==this.selectIndex?(e.selected=!0,this.info1_lab.text="+"+t.quenchingLv,this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[this.selectIndex]+"_png"):e.selected=!1},t.prototype.onShowInfo=function(){var e=this.getPlayerData().getEquipSlotThings(this.selectIndex);this.isMax=GameDefine.Equip_Cuilian_Max==e.quenchingLv,this.isMax?this.currentState="max":this.currentState="advance",this.wave_probar.visible=!this.isMax;var t,n=this.cuilianDict[e.quenchingLv],a=this.cuilianDict[e.quenchingLv+1],i="",o=0;t=GameCommon.getInstance().createNormalLabel(24,16106822,1),o=n?n.effect/100:0,i="提高基础属性："+o+"%\n",this.curPro.text=i,this.onShowStar(e.quenchingLv),a&&(t=GameCommon.getInstance().createNormalLabel(24,16106822,1),o=a.effect/100,t.text=o+"%",this.nextPro.text="提高基础属性："+(o+"%")+"\n",this.wave_probar.maximum=a.exp,this.wave_probar.value=e.quenchingExp),this.updateGoodsADD(),this.currLv=e.quenchingLv},t.prototype.onShowStarAnim=function(){var e=this.getPlayerData().getEquipSlotThings(this.selectIndex),t=this.starAnimLayer.width/10*(e.quenchingLv-1)+2*(e.quenchingLv-1)+17,n=this.cuilianDict[e.quenchingLv];10==e.quenchingLv&&GameCommon.getInstance().addAnimation("new_cuilian_kuang",this.animPos,this.animLayer);var a,i=new egret.Point(t,0);switch(n.pinzhi){case 2:a="new_cuilian_juji";break;case 3:a="new_cuilian_juji";break;case 4:a="new_cuilian_juji"}GameCommon.getInstance().addAnimation(a,i,this.starAnimLayer)},t.prototype.onShowStar=function(e){for(var t,n=0;10>n;n++)t=this["img_star"+n],e>=n+1?t.visible=!0:t.visible=!1},t.prototype.updateGoodsADD=function(){if(this.consumItem.visible=!this.isMax,!this.isMax){var e=this.getPlayerData().getEquipSlotThings(this.selectIndex),t=this.cuilianDict[e.quenchingLv+1];this.consumItem.setConsume(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_CUILIAN,t.costNum)}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(GoodsDefine.ITEM_ID_CUILIAN)},t.prototype.trigger=function(){for(var e=0;e<GameDefine.Equip_Slot_Num;e++)this.points[e].checkPoint();this.points[e].checkPoint()},Object.defineProperty(t.prototype,"cuilianDict",{get:function(){return JsonModelManager.instance.getModelcuilian()},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(QuenchingPanel.prototype,"QuenchingPanel");var SmeltSelectPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SmeltSelectPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("smelt_bml_xzzb_png"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnConfirm,this),this.closeBtn0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_confirm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnConfirm,this),this.closeBtn0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRefresh=function(){var e;this.itemLayer.removeChildren();for(var t=this.param.equipQueue.length,n=0;t>n;n++)e=new SmeltInstance(n),e.onUpdate(this.param.equipQueue[n],SMELTINSTANCE_TYPE.SELECT,this.param.from),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemLayer.addChild(e);
this.onShowLabel()},t.prototype.getSmeltLength=function(){var e=0;for(var t in this.param.smeltQueue)e++;return e},t.prototype.onTouchItem=function(e){var t=e.currentTarget;t.thing.selected=!t.thing.selected,t.onRefresh();var n=0;if(t.thing.selected){for(this.param.smeltQueue[t.thing.smeltSot],n=0;n<this.param.maxSelect;n++)if(!this.param.smeltQueue[n]){this.param.smeltQueue[n]=t.thing,t.thing.smeltSot=n;break}}else delete this.param.smeltQueue[t.thing.smeltSot];this.onShowLabel(),this.param.maxSelect==this.getSmeltLength()&&this.onHide()},t.prototype.onShowLabel=function(){for(var e=0,t=this.param.equipQueue.length,n=0;t>n;n++)this.param.equipQueue[n].selected&&e++;this.label_sum.text=e+"/"+this.param.maxSelect},t.prototype.onTouchBtnConfirm=function(){this.onHide()},t.prototype.onHide=function(){e.prototype.onHide.call(this),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SmeltPanel",this.param.from))},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t}(BaseWindowPanel);__reflect(SmeltSelectPanel.prototype,"SmeltSelectPanel");var SmeltSelectParam=function(){function e(e,t,n,a){this.from=e,this.smeltQueue=t,this.maxSelect=n,this.equipQueue=a}return e}();__reflect(SmeltSelectParam.prototype,"SmeltSelectParam");var ZhuHunPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.attribute=[],n.posIndex=0,n.animPos=new egret.Point(185,561),n.points=RedPointManager.createPoint(2),n.slotRotation=[100,130,165,185,230,-65,-5,0,35,65],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ZhuHunPanelSkin},t.prototype.onInit=function(){this.animRecords=[];var e,t,n;this.equip_bar_0.slotDI.rotation=100,this.equip_bar_1.slotDI.rotation=130,this.equip_bar_2.slotDI.rotation=165,this.equip_bar_3.slotDI.rotation=185,this.equip_bar_4.slotDI.rotation=230,this.equip_bar_5.slotDI.rotation=-65,this.equip_bar_6.slotDI.rotation=-5,this.equip_bar_7.slotDI.rotation=0,this.equip_bar_8.slotDI.rotation=35,this.equip_bar_9.slotDI.rotation=65;for(var a=0;a<GameDefine.Equip_Slot_Num;a++){var i=this.getPlayerData().getEquipSlotThings(a);(!Tool.isNumber(n)||n>i.zhLv)&&(n=i.zhLv,this.posIndex=a),t=this["equip_bar_"+a],t.slotType=a,e=new ForgePosInfo(t.x,t.y,t.scaleX,0,this.slotRotation[a]),t.name=a+"",this.animRecords.push(e)}this.points[0].register(this.btn_upgrade,GameDefine.RED_BTN_POS,DataManager.getInstance().forgeManager,"checkLianhuaPoint"),this.points[1].register(this.strengthenMasterBtn,new egret.Point(65,5),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA),this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.consumItem.consume_name_label.textColor=15987699,this.resetPos(),this.onRefresh(),this.updateSlotInfo(),this.onUpdatePlayerPower()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.resetPos=function(){for(var e,t,n=GameDefine.Equip_Slot_Num+this.posIndex,a=this.posIndex;n>a;a++)t=this["equip_bar_"+(a>=GameDefine.Equip_Slot_Num?a-GameDefine.Equip_Slot_Num:a)],e=this.animRecords[a-this.posIndex],t.x=e.posX,t.y=e.posY,t.slotDI.rotation=e.rotationNum,t.scaleX=e.scale,t.scaleY=e.scale,a==this.posIndex?(this.currEquip=t,t.slotDI.source="zhancao_xuanzhong_png"):t.slotDI.source="zhancao-weixuanzhong_png"},t.prototype.onRefresh=function(){this.showIntensify()},t.prototype.strongerBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA))},t.prototype.onLianhuaUpgrade=function(){this.updateSlotInfo(),this.onUpdatePlayerPower();var e=GameCommon.getInstance().addAnimation("new_lianhua",this.animPos,this.animLayer);e.playFinishCallBack(this.onAnimFinish,this)},t.prototype.onAnimFinish=function(){this._playNum=1,this.posIndex=(this.posIndex+1)%GameDefine.Equip_Slot_Num,this.btn_upgrade.enabled=!0,this.currEquip.slotDI.source="zhancao-weixuanzhong_png",this.currEquip=this["equip_bar_"+this.posIndex],this.currEquip.slotDI.source="zhancao_xuanzhong_png",this.onRefresh(),this.play()},t.prototype.updateSlotInfo=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_LIAN_HUA);for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++)e=this["equip_bar_"+t],e.setinfo(this.getPlayerData().getEquipSlotThings(t).zhLv)},t.prototype.updateGoodsADD=function(){this.consumItem.visible=null==this.modeled?!1:!0,this.maxLv.visible=!this.consumItem.visible,this.modeled&&this.consumItem.setCostByAwardItem(this.modeled.cost)},t.prototype.onUpdatePlayerPower=function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this.getPlayerData().getEquipSlotThings(t),a=JsonModelManager.instance.getModellianhua()[t][n.zhLv-1];if(a)for(var i=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.FORGE),o=0;o<ATTR_TYPE.SIZE;o++)e[o]+=a.attrAry[o]+Tool.toInt(a.attrAry[o]*i/GameDefine.GAME_ADD_RATIO)}this.power.power=GameCommon.calculationFighting(e)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandler,this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgradeBtn,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_ZHUHUN_MESSAGE.toString(),this.onLianhuaUpgrade,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strongerBtnClick,this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgradeBtn,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandler,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_ZHUHUN_MESSAGE.toString(),this.onLianhuaUpgrade,this)},t.prototype.showIntensify=function(){var e=0,t=this.getPlayerData().getEquipSlotThings(this.posIndex),n=GoodsDefine.EQUIP_SLOT_TYPE[t.slot],a=JsonModelManager.instance.getModellianhua();if(a[n]){var i,o;i=a[n][t.zhLv-1],this.modeled=a[n][t.zhLv],o=i||this.modeled;var r="",s="";for(var h in o.attrAry)o.attrAry[h]>0&&(e=i?i.attrAry[h]:0,r=r+GameDefine.Attr_FontName[h]+":"+e+"\n",e=this.modeled?this.modeled.attrAry[h]:0,s=s+GameDefine.Attr_FontName[h]+":"+e+"\n");this.modeled?(this.currentState="normal",this.nextPro.text=s):this.currentState="max",this.curPro.text=r,this.updateGoodsADD()}},t.prototype.onUpgradeBtn=function(){if(this.modeled){if(!GameCommon.getInstance().onCheckItemConsume(this.modeled.cost.id,this.modeled.cost.num))return;this.btn_upgrade.enabled=!1,this.onSendLianhuaMsg()}else GameCommon.getInstance().addAlert(Language.instance.getText("error_tips_1001"))},t.prototype.onSendLianhuaMsg=function(){var e=new Message(MESSAGE_ID.PLAYER_ZHUHUN_MESSAGE);e.setByte(0),e.setByte(this.posIndex),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.trigger=function(){this.points[0].checkPoint(),this.points[1].checkPoint()},t.prototype.play=function(){if(0==this._playNum)return void(this._isplay=!1);var e=this.posIndex-this._playNum;e=0>e?e+GameDefine.Equip_Slot_Num:e,this._playNum--,this._isplay=!0;for(var t,n,a=GameDefine.Equip_Slot_Num+e,i=e;a>i;i++){n=this["equip_bar_"+(i>=GameDefine.Equip_Slot_Num?i-GameDefine.Equip_Slot_Num:i)];var o=i-e-1>=0?i-e-1:GameDefine.Equip_Slot_Num-1-(i-e);t=this.animRecords[o],egret.Tween.removeTweens(n),n.slotDI.rotation=t.rotationNum,egret.Tween.get(n).to({x:t.posX,y:t.posY,scaleX:t.scale,scaleY:t.scale},200).call(function(e){e&&this.play()},this,[i==a-1])}},t.prototype.onTouchSlot=function(e){if(!this._isplay){var t=e.currentTarget,n=parseInt(t.name);this.posIndex!=n&&(this._playNum=n-this.posIndex,this._playNum=this._playNum<0?this._playNum+GameDefine.Equip_Slot_Num:this._playNum,this.posIndex=n,this.currEquip.slotDI.source="zhancao-weixuanzhong_png",t.slotDI.source="zhancao_xuanzhong_png",this.currEquip=t,this.play(),this.onRefresh())}},t.prototype.onGetHandler=function(){GameCommon.getInstance().onShowFastBuy(GoodsDefine.ITEM_ID_LIANHUAZHIHUN)},t}(BaseTabView);__reflect(ZhuHunPanel.prototype,"ZhuHunPanel");var FriendAddPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendAddPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.input.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchInput,this),this.btn_add.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdd,this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancel,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.input.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchInput,this),this.btn_add.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAdd,this),this.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnCancel,this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onBtnAdd=function(){""!=this.input.text&&(DataManager.getInstance().friendManager.onSendSeachAddFriend(this.input.text),this.input.text=""),this.onHide()},t.prototype.onBtnCancel=function(){this.onHide()},t.prototype.onTouchInput=function(){""==this.input.text&&(this.input.text=DataManager.getInstance().playerManager.player.name.split(".")[0]+".")},t}(BaseWindowPanel);__reflect(FriendAddPanel.prototype,"FriendAddPanel");var FriendApplyPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendApplyPanelSkin},t.prototype.onInit=function(){this.itemGroup.itemRenderer=FriendApplyItemRenderer,this.itemGroup.itemRendererSkinName=skins.FriendListItemRendererSkin,this.itemGroup.useVirtualLayout=!0,this.bar.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_agree.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAgree,this),this.btn_refuse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRefuse,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().friendManager.onSendGetFriendMessage(FRIEND_LIST_TYPE.APPLY)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_agree.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAgree,this),this.btn_refuse.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRefuse,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.APPLY);this.itemGroup.dataProvider=new eui.ArrayCollection(e);var t=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.FRIEND);this.label_limit.text="好友数量："+t.length+"/"+FriendManager.FRIEND_MAX},t.prototype.onTouchBtnAgree=function(){0!=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.APPLY).length&&DataManager.getInstance().friendManager.onSendApplyFriendMessage(FRIEND_APPLY_TYPE.AGREE)},t.prototype.onTouchBtnRefuse=function(){0!=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.APPLY).length&&DataManager.getInstance().friendManager.onSendApplyFriendMessage(FRIEND_APPLY_TYPE.REFUSE)},t}(BaseTabView);__reflect(FriendApplyPanel.prototype,"FriendApplyPanel");var FriendApplyItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.currentState="apply",this.headLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHead,this),this.btn_agree.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAgree,this),this.btn_refuse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRefuse,this)},t.prototype.onTouchBtnAgree=function(){DataManager.getInstance().friendManager.onSendApplyFriendMessage(FRIEND_APPLY_TYPE.AGREE,this.data.player.id)},t.prototype.onTouchBtnRefuse=function(){DataManager.getInstance().friendManager.onSendApplyFriendMessage(FRIEND_APPLY_TYPE.REFUSE,this.data.player.id)},t.prototype.onTouchHead=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("FriendFuncPanel",new FriendFuncParam(FRIENDFUNC_FROM.FRIEND,this.data.player)))},t}(FriendItemRenderer);__reflect(FriendApplyItemRenderer.prototype,"FriendApplyItemRenderer");var FriendBlackList=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendBlackListSkin},t.prototype.onInit=function(){this.itemGroup.itemRenderer=FriendBlackListItemRenderer,this.itemGroup.itemRendererSkinName=skins.FriendListItemRendererSkin,this.itemGroup.useVirtualLayout=!0,this.bar.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().friendManager.onSendGetFriendMessage(FRIEND_LIST_TYPE.BLACKLIST)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.BLACKLIST);this.itemGroup.dataProvider=new eui.ArrayCollection(e),this.label_limit.text="屏蔽数量："+e.length+"/"+FriendManager.BLACKLIST_MAX},t}(BaseTabView);__reflect(FriendBlackList.prototype,"FriendBlackList");var FriendBlackListItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.currentState="blackList",this.btn_del.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnDel,this)},t.prototype.onTouchBtnDel=function(){DataManager.getInstance().friendManager.onSendDelFriendMessage(FRIEND_LIST_TYPE.BLACKLIST,this.data.player.id)},t}(FriendItemRenderer);__reflect(FriendBlackListItemRenderer.prototype,"FriendBlackListItemRenderer");var FriendFuncPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendFuncPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("玩家信息"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_addOrDel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAddOrDel,this),this.btn_whisper.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnWhisper,this),this.btn_blackList.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnBlackList,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().friendManager.onSendGetFriendMessage(FRIEND_LIST_TYPE.FRIEND)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_addOrDel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAddOrDel,this),this.btn_whisper.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnWhisper,this),this.btn_blackList.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnBlackList,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){if(this.param){switch(3!=this.btnLayer.numChildren&&(this.btnLayer.removeChildren(),this.btnLayer.addChild(this.btn_addOrDel),this.btnLayer.addChild(this.btn_whisper),this.btnLayer.addChild(this.btn_blackList)),this.param.from){case FRIENDFUNC_FROM.CHAT:var e=DataManager.getInstance().friendManager.getObjListByType(FRIEND_LIST_TYPE.FRIEND),t=e[this.param.player.id];t?this.btn_addOrDel.label="删  除":(this.btn_addOrDel.label="添  加",this.btn_whisper.parent&&this.btn_whisper.parent.removeChild(this.btn_whisper));break;case FRIENDFUNC_FROM.FRIEND:this.btn_addOrDel.label="删  除"}this.playerHead.setHead(this.param.player.headindex,this.param.player.headFrame),this.param.player.viplevel>0?this.vip_group.visible=!0:this.vip_group.visible=!1,this.vip_label.text=GameCommon.getInstance().getVipName(this.param.player.viplevel)+"",this.label_info.text=this.param.player.name+" "+Language.instance.getText("coatard_level1")+" "+this.param.player.level+Language.instance.getText("level"),this.power.power=this.param.player.fightvalue}},t.prototype.onBtnAddOrDel=function(){switch(this.btn_addOrDel.label){case"添  加":DataManager.getInstance().friendManager.onSendAddFriendMessage(this.param.player.id);break;case"删  除":DataManager.getInstance().friendManager.onSendDelFriendMessage(FRIEND_LIST_TYPE.FRIEND,this.param.player.id)}this.onHide()},t.prototype.onBtnWhisper=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatPrivatePanel",new ChatPanelParam(CHANNEL.WHISPER,this.param.player)))},t.prototype.onBtnBlackList=function(){switch(DataManager.getInstance().friendManager.onSendShieldSomeBody(this.param.player.id),this.param.from){case FRIENDFUNC_FROM.CHAT:break;case FRIENDFUNC_FROM.FRIEND:}this.onHide()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t}(BaseWindowPanel);__reflect(FriendFuncPanel.prototype,"FriendFuncPanel");var FriendFuncParam=function(){function e(e,t){this.from=e,this.player=t}return e}();__reflect(FriendFuncParam.prototype,"FriendFuncParam");var FRIENDFUNC_FROM;!function(e){e[e.CHAT=1]="CHAT",e[e.FRIEND=2]="FRIEND"}(FRIENDFUNC_FROM||(FRIENDFUNC_FROM={}));var FriendListChatPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendListChatPanelSkin},t.prototype.onInit=function(){this.itemGroup.itemRenderer=FriendChatItemRenderer,this.itemGroup.itemRendererSkinName=skins.FriendListItemRendererSkin,this.itemGroup.useVirtualLayout=!0,this.bar.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().friendManager.getRecentContacts(),t=function(e,t){return t.order-e.order};e.sort(t),this.itemGroup.dataProvider=new eui.ArrayCollection(e),this.trigger()},t.ChatRedPoint=new egret.Point(95,-5),t}(BaseTabView);__reflect(FriendListChatPanel.prototype,"FriendListChatPanel");var FriendChatItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.point=new redPoint,t}return __extends(t,e),t.prototype.onInit=function(){this.currentState="chat",this.point.register(this.btn_chat,FriendListChatPanel.ChatRedPoint,this,"checkRedPoint"),this.btn_chat.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnChat,this)},t.prototype.onUpdate=function(){e.prototype.onUpdate.call(this),this.trigger()},t.prototype.onTouchBtnChat=function(){this.data.order=0,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatPrivatePanel",new ChatPanelParam(CHANNEL.WHISPER,this.data.player)))},t.prototype.trigger=function(){this.point.checkPoint()},t.prototype.checkRedPoint=function(){return this.data?this.data.order>0:!1},t}(FriendItemRenderer);__reflect(FriendChatItemRenderer.prototype,"FriendChatItemRenderer");var FriendListPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FriendListPanelSkin},t.prototype.onInit=function(){this.itemGroup.itemRenderer=FriendListItemRenderer,this.itemGroup.itemRendererSkinName=skins.FriendListItemRendererSkin,this.itemGroup.useVirtualLayout=!0,this.bar.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.allGetBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetCaoYao,this),this.allSendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendCaoYao,this),this.btn_search.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAddFriend,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().friendManager.onSendGetFriendMessage(FRIEND_LIST_TYPE.FRIEND),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ENERGY_GIFT_RECEIVE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.allGetBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetCaoYao,this),this.allSendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendCaoYao,this),this.btn_search.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnAddFriend,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_FRIEND_LIST_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ENERGY_GIFT_RECEIVE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().friendManager.getList(FRIEND_LIST_TYPE.FRIEND);this.itemGroup.dataProvider=new eui.ArrayCollection(e),this.label_limit.text="好友数量："+e.length+"/"+FriendManager.FRIEND_MAX,this.caoyaoGet.text="草药每日领取上限24今日已领取领取"+DataManager.getInstance().xiandanManager.yilingEnergy,this.trigger()},t.prototype.onSendCaoYao=function(){var e=new Message(MESSAGE_ID.ENERGY_GIFT);e.setInt(-1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onGetCaoYao=function(){var e=new Message(MESSAGE_ID.ENERGY_GIFT_RECEIVE);e.setInt(-1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onBtnAddFriend=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FriendAddPanel")},t}(BaseTabView);__reflect(FriendListPanel.prototype,"FriendListPanel");var FriendListItemRenderer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onInit=function(){this.currentState="friend",this.bgBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHead,this),this.sendCaoYao.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendCaoYao,this,!1)},t.prototype.onUpdate=function(){e.prototype.onUpdate.call(this);var t=DataManager.getInstance().friendManager.getOnlineTime(this.data.passTime).split("|");"online"==t[1]?(this.label_online.visible=!1,this.label_online2.visible=!0):(this.label_online.visible=!0,this.label_online2.visible=!1,this.label_online.text=t[0])},t.prototype.onSendCaoYao=function(){var e=new Message(MESSAGE_ID.ENERGY_GIFT_RECEIVE);e.setInt(this.data.player.id),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onTouchHead=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("FriendFuncPanel",new FriendFuncParam(FRIENDFUNC_FROM.FRIEND,this.data.player)))},t}(FriendItemRenderer);__reflect(FriendListItemRenderer.prototype,"FriendListItemRenderer");var TotalRechargeManager=function(){function e(){}return e.prototype.parseMessage=function(e){this.total=e.getInt(),this.round=e.getByte()},e}();__reflect(TotalRechargeManager.prototype,"TotalRechargeManager");var FuLingDupPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.challengeNum=0,n._awardStrAry=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FuLingDupPanelSkin},Object.defineProperty(t.prototype,"bossData",{get:function(){return DataManager.getInstance().fuLingManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onTouchExplain(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.onrequestDupInfo(),this.fight_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterFight,this);for(var t in JsonModelManager.instance.getModelkuafuboss()){var n=(JsonModelManager.instance.getModelkuafuboss()[t],this["tab"+parseInt(t)]);if(!n)break;n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}for(var a=0;6>a;a++)this["boximg"+a].name=a+"",this["boximg"+a].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.fight_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterFight,this);for(var t in JsonModelManager.instance.getModelkuafuboss()){var n=(JsonModelManager.instance.getModelkuafuboss()[t],this["tab"+parseInt(t)]);if(!n)break;n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}for(var a=0;6>a;a++)this["boximg"+a].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this)},t.prototype.onrequestDupInfo=function(){var e=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);e.setByte(DUP_TYPE.DUP_LINGXING),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRefresh=function(){},t.prototype.onTouchExplain=function(){},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currTab!=t.value&&(this.currTab=t.value,this.onTabHanlder())},t.prototype.onTabHanlder=function(){var e=ModelManager.getInstance().getModelFigher(Number(Constant.get("FULING_BOSS_MODEL_ID")));this.boss_name_lab.text=e.name,this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,Number(Constant.get("FULING_BOSS_MODEL_ID"))),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim),this.onUpdateFightCount(),this.onUpdateBoxStatus()},t.prototype.onUpdateFightCount=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_LINGXING,1);this.challengeNum=e?e.lefttimes:0,this.fight_count_lab.text=this.challengeNum.toString()},t.prototype.onUpdateBoxStatus=function(){Constant.get("FULING_BOSS_GAINID").indexOf("#")>=0&&(this._awardStrAry=Constant.get("FULING_BOSS_GAINID").split("#"));for(var e=0;e<this._awardStrAry.length;e++){var t=this._awardStrAry[e].split(",");if(!this["boximg"+e])break;this.bossData.myDamageNum<Number(t[0])?this["boximg"+e].source="cross_pveboss_box_unopen_png":this["boximg"+e].source="cross_pveboss_box_open_png",this["boxname_lab"+e].text=GameCommon.getInstance().getFormatNumberShow(Number(t[0]))}},t.prototype.onReciveBossInfoMsg=function(){this.total_damage_lab.text=this.bossData.myDamageNum+"",this.onTabHanlder()},t.prototype.onEnterFight=function(){GameFight.getInstance().onSendEnterDupMsg(42)},t.prototype.onsendBuyCountMsg=function(){GameFight.getInstance().onSendEnterDupMsg(42)},t.prototype.onTouchBox=function(e){var t=e.currentTarget,n=this._awardStrAry[parseInt(t.name)].split(","),a=GameCommon.getInstance().getThingModel(3,n[1]),i=new ThingBase(a.type);i.onupdate(a.id,a.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,i,0)))},t}(BaseTabView);__reflect(FuLingDupPanel.prototype,"FuLingDupPanel");var FuLingMainViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin,this.setTitle("title_fumo_png")},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="FuLingViewPanel",n.btnRes="icon_fumo",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().fuLingManager,"getFulingDanPoint"),t.push(n),DataManager.getInstance().playerManager.player.level>=JsonModelManager.instance.getModelfunctionLv()[95].level&&(n=new RegisterSystemParam,n.sysName="FuLingDupPanel",n.btnRes="fumozhuxiang_btn",n.redP=this.points[1],n.redP.addTriggerFuc(FunDefine,"DupFulingbossPoint"),t.push(n)),this.registerPage(t,"fulingmainviewGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(e.prototype.onRefresh.call(this),this.index){case 0:this.setTitle("title_fumo_png");break;case 1:this.setTitle("z_fulingzhuxian_png")}},t}(BaseSystemPanel);__reflect(FuLingMainViewPanel.prototype,"FuLingMainViewPanel");var FulingPross=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.init,t),t}return __extends(t,e),t.prototype.init=function(){this.addToContainer(this.getArcProgress(!1,1)),this.addToContainer(this.getSectorProgress(!1,1)),this.addToContainer(this.drawBorderProgress("jindutiaoqiu_png",!1,1))},t.prototype.addToContainer=function(e){e.x=120*Math.floor(this.numChildren%4)+10,e.y=120*Math.floor(this.numChildren/4)+10,this.addChild(e)},t.prototype.getArc=function(e){var t=new egret.Shape;return t.graphics.lineStyle(2,16776960),t.graphics.drawArc(50,50,50,0,30*Math.PI/180,e),t.graphics.endFill(),t},t.prototype.getArch=function(e){var t=new egret.Shape;return t.graphics.beginFill(16711680),t.graphics.drawArc(50,50,50,0,Math.PI/180*60,e),t.graphics.endFill(),t},t.prototype.getSector=function(e,t){var n=new egret.Shape;return n.graphics.beginFill(16711680),n.graphics.moveTo(50,50),n.graphics.lineTo(100,50),n.graphics.drawArc(50,50,50,0,260*Math.PI/180*t,e),n.graphics.lineTo(50,50),n.graphics.endFill(),n},t.prototype.getArcProgress=function(e,t){function n(t){a.graphics.clear(),a.graphics.lineStyle(2,255,1),a.graphics.drawArc(50,50,50,0,t*Math.PI/180,e),a.graphics.endFill()}var a=new egret.Shape,i=0;return egret.startTick(function(e){return i+=1*t,n(i),i%=360,!0},this),a},t.prototype.getSectorProgress=function(e,t){function n(t){a.graphics.clear(),a.graphics.beginFill(16711680),a.graphics.moveTo(50,50),a.graphics.lineTo(100,50),a.graphics.drawArc(50,50,50,0,t*Math.PI/180,e),a.graphics.lineTo(50,50),a.graphics.endFill()}var a=new egret.Shape,i=0;return egret.startTick(function(e){return i+=1*t,n(i),i%=360,!0},this),a},t.prototype.drawMaskWithPic=function(e){var t=new egret.DisplayObjectContainer,n=100,a=100,i=new egret.Bitmap(RES.getRes(e));t.addChild(i),i.width=n,i.height=a;var o=this.drawBorderProgress("club2_png",!0,1);return t.addChild(o),o.alpha=1,t},t.prototype.drawBorderWithPic=function(e){var t=new egret.DisplayObjectContainer,n=96,a=96,i=new egret.Bitmap(RES.getRes(e));t.addChild(i),i.width=n,i.height=a,i.x=3,i.y=3;var o=this.drawBorderProgress("club_png",!1,1);return t.addChild(o),t},t.prototype.drawBgWithPic=function(e){var t=new egret.DisplayObjectContainer,n=100,a=100,i=new egret.Bitmap(RES.getRes(e));t.addChild(i),i.width=n,i.height=a,i.alpha=.5;var o=this.drawBorderProgress(e,!1,1);return t.addChild(o),t},t.prototype.drawBorderProgress=function(e,t,n){function a(e){l.graphics.clear(),l.graphics.beginFill(65535,1),l.graphics.lineTo(s,0),l.graphics.drawArc(0,0,s,0,e*Math.PI/180,t),l.graphics.lineTo(0,0),l.graphics.endFill()}var i=new egret.DisplayObjectContainer,o=100,r=100,s=Math.max(o,r)/2*1.5,h=new egret.Bitmap(RES.getRes(e));
i.addChild(h),h.width=o,h.height=r;var l=new egret.Shape;l.x=h.width/2,l.y=h.height/2,h.mask=l,i.addChild(l);var g=0;return egret.startTick(function(e){return g+=1*n,a(g),g%=360,!0},this),i},t}(egret.DisplayObjectContainer);__reflect(FulingPross.prototype,"FulingPross");var FuLingViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.animPos=new egret.Point(344,600),n.points=RedPointManager.createPoint(4),n.index=0,n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.FuLingPanelSkin},t.prototype.onInit=function(){for(e.prototype.onInit.call(this),this.fulings=[];this.avatar_grp.numChildren>0;){var t=this.avatar_grp.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.avatar_grp.removeChild(t)}var n=new Animation("fuling_02");this.avatar_grp.addChild(n),this.avatar_grp.y=330;for(var a=0;4>a;a++){var i=new FuLingItem;i.onUpdate(this.models[a]),i.isSelect(a,!1),0==a&&i.isSelect(a,!0),i.x=(i.width+30)*a,this.itemGroup.addChild(i),this.fulings.push(i),i.name=a+"",i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectFuLing,this)}this.onRefresh()},t.prototype.onDraw=function(){var e=378,t=378;Math.max(e,t)/2;this._shape=new egret.Shape,this.prooooo.addChild(this._shape),this._shape.x=180,this._shape.y=180;var n=new egret.Shape;this.prooooo.addChild(n),n.graphics.beginFill(255),n.graphics.drawRect(this.progress.width/2,0,this.progress.width/2,378),n.graphics.endFill(),this.progress1.mask=this._shape,this.progress.mask=n,this.changeGraphics(-2)},t.prototype.changeGraphics=function(e){this._shape.graphics.beginFill(255),this._shape.graphics.drawRect(0,0,this.progress.width/2,378),this._shape.graphics.endFill()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.fuLingBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.TouchBtnAdvance,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FULING_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.fuLingBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.TouchBtnAdvance,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FULING_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onSelectFuLing=function(e){for(var t=e.currentTarget,n=0;n<this.fulings.length;n++)this.fulings[n].isSelect(n,!1),this.fulings[n].name==t.name&&(this.index=Number(t.name),this.fulings[n].isSelect(n,!0));GameCommon.getInstance().getThingModel(this.models[this.index].cost.type,this.models[this.index].cost.id);this.currency.setCostByAwardItem(this.models[this.index].cost)},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=JsonModelManager.instance.getModelfuling();for(var t in e)this.rewardArr.push(e[t]);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){var t=DataManager.getInstance().fuLingManager.onGetLingXingCfg(),n=DataManager.getInstance().fuLingManager.nextlingxingCfg;1==n.id?(this.progress.minimum=0,this.progress.value=DataManager.getInstance().playerManager.player.getPlayerData().fuling[6],this.progress.maximum=n.max,this.progress.value=DataManager.getInstance().playerManager.player.getPlayerData().fuling[6]):(this.progress.minimum=0,this.progress.maximum=n.max-t.max,this.progress.value=DataManager.getInstance().playerManager.player.getPlayerData().fuling[6]-t.max);GameCommon.getInstance().getThingModel(this.models[this.index].cost.type,this.models[this.index].cost.id);this.currency.setCostByAwardItem(this.models[this.index].cost);for(var a=(this.models[1].attrAry,""),i="",o=0,r=GameCommon.getInstance().getAttributeAry();o<GameDefine.FULING_ATTR.length;o++)r[GameDefine.FULING_ATTR[o]]+=DataManager.getInstance().playerManager.player.getPlayerData(0).fuling[o],o>2?i=i+GameDefine.Attr_FontName[GameDefine.FULING_ATTR[o]]+"："+(0+DataManager.getInstance().playerManager.player.getPlayerData(0).fuling[o])+"\n":a=a+GameDefine.Attr_FontName[GameDefine.FULING_ATTR[o]]+"："+(0+DataManager.getInstance().playerManager.player.getPlayerData(0).fuling[o])+"\n";var s="",h=GameCommon.getInstance().getAttributeAry(),l=JsonModelManager.instance.getModellingxing();for(var g in l)if(DataManager.getInstance().playerManager.player.getPlayerData(0).fuling[6]>=l[g].max)for(o=10;o<2*l[g].attrAry.length;o++)l[g][GameDefine.getAttrPlusKey(o)]>0&&(h[o%ATTR_TYPE.SIZE]=l[g][GameDefine.getAttrPlusKey(o)]);for(o=0;4>o;++o)s+=Language.instance.getAttrName(o)+Language.instance.getText("shuxingjiacheng")+":"+(h[o]/100).toFixed(1)+"%\n";this.curr_addattr_lab.text=s,this.curPro.text=a,this.nextPro.text=i,this.powerbar.power=GameCommon.calculationFighting(r),e.prototype.onRefresh.call(this)},t.prototype.getPlayData=function(e){return DataManager.getInstance().playerManager.player.getPlayerData(e)},t.prototype.TouchBtnAdvance=function(){var e=new Message(MESSAGE_ID.FULING_MESSAGE);e.setByte(0),e.setShort(this.index+1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onUpdateBack=function(){GameCommon.getInstance().addAnimation("shengjichenggong",this.animPos,this),this.onRefresh()},t.prototype.onChangeRole=function(){this.onRefresh()},t.prototype.trigger=function(){},t}(BaseTabView);__reflect(FuLingViewPanel.prototype,"FuLingViewPanel");var FuLingItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.FuLingItemSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){},t.prototype.onUpdate=function(e){this.name_lab.text=e.name},t.prototype.isSelect=function(e,t){t?this.selectImg.source="fuling_dan"+(e+1)+"_sel_png":this.selectImg.source="fuling_dan"+(e+1)+"_png"},t}(eui.Component);__reflect(FuLingItem.prototype,"FuLingItem");var TurnplateManager=function(){function e(){}return e.prototype.parseRunALotteryMessage=function(e){this.awards=[];for(var t,n=e.getByte(),a=0;n>a;a++)t=new AwardItem,t.parseMessage(e),this.awards.push(t);var i=new TurnplateAwardParam;i.desc="转盘获得以下奖励",i.titleSource="",i.itemAwards=this.awards,i.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TurnplateAwardPanel",i))},e}();__reflect(TurnplateManager.prototype,"TurnplateManager");var ArtifactInstance=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onThing=function(e,t){void 0===t&&(t=!0),this.thingdata=e,this.type=e.type,this.id=e.modelId,this.quality=e.quality,this.num=e.num,this.model=e.model,this.name_label.visible=t,this.refresh()},t.prototype.refresh=function(){e.prototype.refresh.call(this),this.num_label.bottom=100},t.prototype.setDefault=function(e,t){void 0===e&&(e=""),void 0===t&&(t=""),this.onReset(),this.name_label.text=e,this.item_icon.source=t},t.prototype.onReset=function(){this.thingdata=null,e.prototype.onReset.call(this)},t.prototype.onTouch=function(e){},t}(GoodsInstance);__reflect(ArtifactInstance.prototype,"ArtifactInstance");var BagInstance=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onThing=function(e){this.thingdata=e,this.type=e.type,this.id=e.modelId,this.quality=e.quality,this.num=e.num,this.model=e.model,this.type==GOODS_TYPE.GEM&&(this.lv=e.model.level),this.model&&this.refresh()},t.prototype.onReset=function(){this.thingdata=null,e.prototype.onReset.call(this)},t.prototype.onTouch=function(e){if(!this._bl&&this.thingdata){var t=0,n=INTRODUCE_TYPE.IMG;this.type==GOODS_TYPE.MASTER_EQUIP?(t=this.thingdata.equipId,n=INTRODUCE_TYPE.EQUIP):this.type==GOODS_TYPE.SERVANT_EQUIP?(t=this.thingdata.equipId,n=INTRODUCE_TYPE.EQUIP):this.type==GOODS_TYPE.BOX&&(n=INTRODUCE_TYPE.BOX),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(n,this.type,this.thingdata,t)))}},t}(GoodsInstance);__reflect(BagInstance.prototype,"BagInstance");var VIPTLGiftManager=function(){function e(){this.round=0,this.record={}}return e.prototype.parseMessage=function(e){this.record={};var t;this.round=e.getByte();for(var n=e.getShort(),a=0;n>a;a++)t=new TLShopData,t.parseMessage(e),this.record[t.id]=t},e.prototype.parseBuyMessage=function(e){var t=new TLShopData;t.parseMessage(e),this.record[t.id]=t},e.prototype.getGoodsByRound=function(){},e}();__reflect(VIPTLGiftManager.prototype,"VIPTLGiftManager");var BoxTipsBar=function(e){function t(t){var n=e.call(this,t)||this;return n.bless_funcs7=[FUN_TYPE.FUN_MOUNT,FUN_TYPE.FUN_SHENBING,FUN_TYPE.FUN_SHENZHUANG,FUN_TYPE.FUN_FABAO,FUN_TYPE.FUN_XIANYU],n.bless_funcs9=[14,18,15,17,16],n.bless_name7=[0,1,2,3,4],n.bless_name9=[6,5,7,8,9],n}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.BoxTipsBarSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.buyBar.onRegist(),this.buyBar.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUse,this),this.buyBar.btn_vip_open.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToVIP,this),this.buyBar.btn_real_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUse,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.buyBar.onRemove(),this.buyBar.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUse,this),this.buyBar.btn_vip_open.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToVIP,this),this.buyBar.btn_real_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUse,this)},t.prototype.onUpdate=function(t){e.prototype.onUpdate.call(this,t);var n;egret.is(t.model,"ThingBase")?n=t.model.model:egret.is(t.model,"ModelThing")&&(n=t.model),this.timeGoods=DataManager.getInstance().timeGoodsManager.getTimeGoods(n.type,n.id),e.prototype.onRefreshCommonUI.call(this,n);var a=DataManager.getInstance().bagManager.getGoodsThingById(n.id,GOODS_TYPE.BOX),i=a?a.num:0;if(this.goods_num.text="当前拥有："+i,this.buyBar.currentState="use",this.buyBar.visible=!0,this.buyBar.btn_buy.label="使用",n.type==GOODS_TYPE.BOX){var o=JsonModelManager.instance.getModelbox()[n.id];if(7==o.type||9==o.type){this.buyBar.currentState="use2";var r=this.bless_funcs7;9==o.type&&(r=this.bless_funcs9);for(var s=0;s<r.length;s++){var h=r[s],l=this.buyBar["radio_lab"+s];if(FunDefine.isFunOpen(h))this.buyBar["radio"+s].enabled=!0,9==o.type?l.text=Language.instance.getText("bless"+this.bless_name9[s]+"_name"):l.text=Language.instance.getText("bless"+this.bless_name7[s]+"_name");else{var g=JsonModelManager.instance.getModelfunctionLv()[h];this.buyBar["radio"+s].enabled=!1,g.jingjie>0?l.text=Language.instance.getText("coatard_level"+g.jingjie,"open"):g.guanqia>0?l.text=g.guanqia+"关开启":l.text=Language.instance.getText(g.level,"level","open")}}}else 8==o.type?0==DataManager.getInstance().rechargeManager.firstCharge&&(this.buyBar.btn_buy.label="前往首充"):2==o.type&&(this.buyBar.visible=!1);o.vipLimit>DataManager.getInstance().playerManager.player.viplevel&&(this.buyBar.currentState="vip",this.buyBar.btn_vip_open.label="V"+GameCommon.getInstance().getVipName(o.vipLimit)+"开启",this.buyBar.btn_real_buy.label=o.cost.num+"钻石",DataManager.getInstance().bagManager.recordVipBoxOpenId(o.id))}this.buyBar.onUpdate(this.param.model)},t.prototype.onTouchUse=function(){if("use2"==this.buyBar.currentState&&-1==this.buyBar.radio_type)return void GameCommon.getInstance().addAlert("必须选择一个法宝类型");if("前往首充"==this.buyBar.btn_buy.label)return void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FirstChargePanel");var e=new Message(MESSAGE_ID.GOODS_LIST_USE_MESSAGE);e.setByte(this.buyBar.model.type),e.setShort(this.buyBar.model.modelId),e.setInt(this.buyBar.num),this.buyBar.radio_type>=0&&e.setByte(this.buyBar.radio_type),GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.jumpToVIP=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"VipPanel")},t}(BaseTipsBar);__reflect(BoxTipsBar.prototype,"BoxTipsBar");var VIPTLShopManager=function(){function e(){this.round=0,this.record={}}return e.prototype.parseMessage=function(e){this.record={};var t;this.round=e.getByte();for(var n=e.getShort(),a=0;n>a;a++)t=new VIPTLShopData,t.parseMessage(e),this.record[t.id]=t},e.prototype.parseBuyMessage=function(e){var t=new VIPTLShopData;t.parseMessage(e),this.record[t.id]=t},e.prototype.getGoodsByRound=function(){},e}();__reflect(VIPTLShopManager.prototype,"VIPTLShopManager");var VIPTLShopData=function(){function e(){}return e.prototype.parseMessage=function(e){this.id=e.getInt(),this.num=e.getInt()},e}();__reflect(VIPTLShopData.prototype,"VIPTLShopData");var DominateInstance=function(e){function t(t){void 0===t&&(t="normal");var n=e.call(this)||this;return n._currState="normal",n.otherplayerzhuzai=0,n.isNeedActivate=!1,n._currState=t,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.skinName=skins.DominateInstanceSkin,n}return __extends(t,e),t.prototype.onLoadComplete=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.currentState=this._currState,this._data&&this.refresh()},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.refresh()},enumerable:!0,configurable:!0}),t.prototype.onTouch=function(e){if(this._data)switch(this.currentState){case"normal":if(0==this.otherplayerzhuzai){if(this.isNeedActivate){var t=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[this._data.slot]];if(DataManager.getInstance().playerManager.player.level<t.level)return void GameCommon.getInstance().addAlert(t.level+"级激活")}}else{var t=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[this._data.slot]];if(this.otherlvdate<t.level)return void GameCommon.getInstance().addAlert(t.level+"级激活")}DomUpgradePanel.index=this._data.slot;break;case"select":}},t.prototype.refresh=function(){if(this._data){var e;this.isNeedActivate=!1;var e=JsonModelManager.instance.getModelfunctionLv()[GameDefine.Dominate_Slot_func[this._data.slot]];switch(0==this.otherplayerzhuzai?DataManager.getInstance().playerManager.player.level<e.level?this.isNeedActivate=!0:0==this._data.lv&&(this.isNeedActivate=!0):this.otherlvdate<e.level?this.isNeedActivate=!0:0==this._data.lv&&(this.isNeedActivate=!0),this.currentState){case"normal":this.isNeedActivate?(this.label_lv.text="",this.label_name.textFlow=new Array({text:e.level+"级激活",style:{textColor:15326899}}),this.item_icon.source="a_"+this._data.model.icon,this.item_frame.source="bag_whiteframe_png"):(this.label_lv.text="+"+this._data.lv,this.item_icon.source=this._data.model.icon,this.item_frame.source=GameCommon.getInstance().getIconFrame(this._data.quality),this.label_name.textFlow=new Array({text:this._data.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._data.model.quality)}}));break;case"select":this.label_lv.text="",this.label_name.textFlow=new Array({text:this._data.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._data.model.quality)}}),this.item_icon.source=this._data.model.icon,this.item_frame.source=GameCommon.getInstance().getIconFrame(this._data.quality)}}},Object.defineProperty(t.prototype,"otherlv",{get:function(){return this.otherlvdate},set:function(e){this.otherlvdate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{set:function(e){this.selectLayer.visible=e,e?(this.selectedAnim||(this.selectedAnim=new Animation("xuanzhongkuang_3",-1),this.selectLayer.addChildAt(this.selectedAnim,0),this.selectedAnim.scaleX=this.selectedAnim.scaleY=.6),this.selectedAnim.onPlay()):this.selectedAnim&&this.selectedAnim.onStop()},enumerable:!0,configurable:!0}),t.prototype.setBtnSelect=function(e){this.btn.selected=e},t.prototype.setBtnSelectOverturn=function(){this.btn.selected=!this.btn.selected},t.prototype.getBtnSelect=function(){return this.btn.selected},t}(eui.Component);__reflect(DominateInstance.prototype,"DominateInstance");var DOMINATE_POS;!function(e){e[e.EQUIP=0]="EQUIP",e[e.BAG=1]="BAG"}(DOMINATE_POS||(DOMINATE_POS={}));var EquipInstance=function(e){function t(){var t=e.call(this)||this;return t.isLoaded=!1,t._ownID=0,t.quenchingLv=0,t._bl=!1,t._animPos=new egret.Point(50,50),t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.EquipInstanceSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.equipThing&&this.refresh()},t.prototype.onUpdate=function(e,t){this.equipThing=e,this.quenchingLv=t,this.refresh()},t.prototype.refresh=function(){if(this.isLoaded){if(this.equi_soulframe.visible=!1,this.equipThing&&this.equipThing.model){this.default_equip_icon.source="",this.equip_icon.source=this.equipThing.model.icon;var e=this.equipThing.model.coatardLv+Language.instance.getText("grade");if(this.level_label.text=e,this.equi_soulframeDi.source=GameCommon.getInstance().getIconFrameDi(this.equipThing.quality),this.equip_frame.source=GameCommon.getInstance().getIconFrame(this.equipThing.quality),this.equipThing.quality>=GoodsQuality.Red){var t="",n=1;switch(this.equipThing.quality){case GoodsQuality.Red:t="hongzhuang";break;case GoodsQuality.Gold:t="jinzhuang",n=.8}t?(this.orangeLayer.visible=!0,this.orangeAnim?this.orangeAnim.onUpdateRes(t,-1):(this.orangeAnim=new Animation(t,-1),this.orangeLayer.addChild(this.orangeAnim)),this.orangeAnim.scaleX=n,this.orangeAnim.scaleY=n,this.orangeAnim.onPlay()):this.orangeLayer.visible=!1}else this.orangeLayer.visible=!1}else this.equip_icon.source="",this.equipThing?this.equipThing.position>=2*MASTER_EQUIP_TYPE.SIZE?this.default_equip_icon.source="public_slot_"+this.equipThing.position+"_png":this.default_equip_icon.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[this.equipThing.position%MASTER_EQUIP_TYPE.SIZE]+"_png":this.default_equip_icon.source="",this.level_label.text="",this.equip_frame.source="bag_whiteframe_png",this.equi_soulframeDi.source="equip_dengjikuang_bai_png";if(this.equipThing&&Tool.isNumber(this.equipThing.playerIndex)){var a=GameCommon.getInstance().getEquipSlotThingByIndexSlot(this.equipThing.playerIndex,this.equipThing.position);this.showSoulFrame(a&&a.zhLv>0)}}},t.prototype.showSoulFrame=function(e){this.equi_soulframe.visible=e},t.prototype.clearForgeInfo=function(){this.soul.visible=!1,this.soul_label.text="",this.intensify.visible=!1,this.intensify_label.text=""},Object.defineProperty(t.prototype,"forgeInfo",{set:function(e){this.intensify_label.visible=null==e?!1:!0,e&&(e.infuseLv>0?(this.soul.visible=!0,this.soul_label.text="+"+e.infuseLv):this.soul.visible=!1,e.intensifyLv>0?(this.intensify.visible=!0,this.intensify_label.text="+"+e.intensifyLv):this.intensify.visible=!1)},enumerable:!0,configurable:!0}),t.prototype.getEquipThing=function(){return this.equipThing},t.prototype.setEquipThing=function(e){this.equipThing=e},Object.defineProperty(t.prototype,"shieldTip",{set:function(e){this._bl=e},enumerable:!0,configurable:!0}),t.prototype.onTouch=function(e){this.equipThing&&this.equipThing.model&&(this._bl||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.CLOTH,this.equipThing.type,this.equipThing,this.equipThing.equipId,this.equipThing.position,0,this.quenchingLv))))},t.prototype.onPlayClothAnim=function(){this._animPos.x=50,this._animPos.y=50,GameCommon.getInstance().addAnimation("zhuangbeiqianghua",this._animPos,this)},t}(eui.Component);__reflect(EquipInstance.prototype,"EquipInstance");var EquipTipsBar=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.EquipTipsBarSkin},t.prototype.onUpdate=function(t){if(this.currentState="normal",t.type==INTRODUCE_TYPE.SHENQI){this.currentState="shenqi";var n=t.model;this.name_label.text=n.name,this.level_label.text=n.lv+"级";for(var a=GameCommon.getInstance().getAttributeAry(),i=0;i<ATTR_TYPE.SIZE;++i)a[i]+=GameCommon.getInstance().getAttributeAry(n)[i];var o;o=this.bmlable_power,o.power=GameCommon.calculationFighting(a).toString(),this.label_slot.text="神器",this.basic_attr_layer.removeChildren();for(var r,s=0;s<ATTR_TYPE.SIZE;s++){var h=n.attrAry[s];h>0&&(r=new AttributeItem,r.data=[s,h],this.basic_attr_layer.addChild(r))}return void(this.shenqi_icon_id.source="shenqi_icon_"+n.id+"_png")}e.prototype.onUpdate.call(this,t);var l,g,c=-1,p=0;if(egret.is(t.model,"EquipThing")?(l=t.model,c=l.quality,g=l.model):egret.is(t.model,"ModelThing")&&(g=t.model,g.quality=t.model.quality),p=g.pingfenValue,g){e.prototype.onRefreshCommonUI.call(this,g,c);var u="";g.type==GOODS_TYPE.MASTER_EQUIP?u=g.coatardLv+Language.instance.getText("grade"):g.type==GOODS_TYPE.SERVANT_EQUIP&&(u=g.starNum+Language.instance.getText("star")),this.level_label.text=u,this.level_label.text="（"+this.level_label.text+"）",this.label_slot.text=g.des;var r;this.basic_attr_layer.removeChildren();for(var d=g.equipAttr,s=0;s<ATTR_TYPE.SIZE;s++){var h=d[s];if(h>0){if(r=new AttributeItem,l){var _=l.addAttributes[s];r.data=[s,h,"+"+_]}else r.data=[s,h];this.basic_attr_layer.addChild(r)}}l?this.bmlable_power.power=""+l.pingfenValue:this.bmlable_power.power=""+p}},t}(BaseTipsBar);__reflect(EquipTipsBar.prototype,"EquipTipsBar");var HefuActivtyManager=function(){function e(){this.zhuanpanId=0,this.zhuanpanType=0,this.zhuanpanAwardNum=0,this.tp=0,this.currInfo=[],this.zhuanpanNum=0,this.payDay=1,this.payRecord=[],this.missionDatas={},this.zhuanpanRanks=[]}return e.prototype.parseHefuMissionList=function(e){this.missionDatas=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new TaskChainData;a.parseMsg(e),this.missionDatas[a.taskId]=a}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.parseHefuiMissonUpdate=function(e,t){void 0===t&&(t=0),t=0==t?e.getByte():t;for(var n=0;t>n;n++){var a=e.getShort(),i=this.missionDatas[a];i||(i=new TaskChainData,i.taskId=a,this.missionDatas[i.taskId]=i),i.progress=e.getLong(),i.count=e.getByte()}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.checkHefuMissionRedPoint=function(){for(var e in this.missionDatas){var t=this.missionDatas[e];if(1==t.count)return!0}return!1},e.prototype.onParseMessage=function(e){var t=e.getByte();this.payRecord=[];for(var n=0;t>n;n++)this.payRecord.push(e.getByte());this.payDay=e.getByte()},e.prototype.parseZhuanpanRoundMsg=function(e){this.zhuanpanRound=e.getByte(),this.zhuanpanModel=JsonModelManager.instance.getModelzhuanpanhuodong()[this.zhuanpanRound+1]},e.prototype.parseChongBang=function(e){this.chongbangLiBaoId=e.getByte(),this.chargeMoneyNum=e.getInt()},e.prototype.onParseZhuanPanMessage=function(e){if(this.treasureAwdIdx=e.getShort(),this.zhuanpanNum=e.getShort(),this.tp=e.getByte(),1==this.tp)this.zhuanpanType=e.getByte(),this.zhuanpanId=e.getShort(),this.zhuanpanAwardNum=e.getInt();else if(10==this.tp||9==this.tp){this.temAward=[];for(var t=e.getByte(),n=0;t>n;n++){var a=new AwardItem;a.type=e.getByte(),a.id=e.getShort(),a.num=e.getInt(),this.temAward.push(a)}}},e.prototype.parseZhuanpanRankMsg=function(e){for(var t=e.getByte(),n=0;t>n;n++){this.zhuanpanRanks[n]||(this.zhuanpanRanks[n]=new HefuActRank);var a=this.zhuanpanRanks[n];a.parseMsg(e)}GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.getRedPoint=function(){return this.checkZhuanPanPoint()?!0:!1},e.prototype.checkZhuanPanPoint=function(){return this.zhuanpanModel?DataManager.getInstance().bagManager.getGoodsThingNumById(this.zhuanpanModel.costList[0].id,this.zhuanpanModel.costList[0].type)>=this.zhuanpanModel.costList[0].num?!0:this.checkTreasurePoint()?!0:!1:!1},e.prototype.checkTreasurePoint=function(){for(var e=this.zhuanpanModel.box.split("#"),t=0;t<e.length;t++)if(!(this.treasureAwdIdx>t)){var n=e[t]?e[t].split(","):null;if(!n)break;var a=parseInt(n[0]);if(this.zhuanpanNum>=a)return!0}return!1},e.prototype.onParseCelestiaTreasureLog=function(e){for(var t,n=e.getByte(),a=0;n>a;a++)t=new ZhuanPanLog,t.parseMessage(e),this.currInfo.push(t);this.onfilter()},e.prototype.onfilter=function(){for(;this.currInfo.length>10;)this.currInfo.shift()},e.prototype.getTextFlow=function(){for(var e,t=[],n=0;n<this.currInfo.length;n++){e=this.currInfo[n];var a=GameCommon.getInstance().getThingModel(e.award.type,e.award.id,e.award.quality);a&&(t.push({text:e.name,style:{textColor:2661098}}),t.push({text:" 获得",style:{textColor:16777215}}),t.push({text:a.name+"*"+e.award.num,style:{textColor:GameCommon.getInstance().CreateNameColer(a.quality)}}),t.push({text:"\n",style:{}}))}return t.pop(),t},e}();__reflect(HefuActivtyManager.prototype,"HefuActivtyManager");var HefuActRank=function(){function e(){}return e.prototype.parseMsg=function(e){this.rank=e.getByte(),this.playerId=e.getInt(),this.playerName=e.getString(),this.viplevel=e.getByte(),this.lotteryNum=e.getInt()},e}();__reflect(HefuActRank.prototype,"HefuActRank");var ItemIntroducebar=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onShow=function(){this.param&&(this.width=size.width,this.height=size.height,e.prototype.onShow.call(this))},t.prototype.getTipsView=function(){this._allTipsViews||(this._allTipsViews={});var e=this.param.location;if(this._allTipsViews[e])return this._allTipsViews[e];switch(e){case INTRODUCE_TYPE.CLOTH:this._allTipsViews[e]=new ClothEquipTips(this);break;case INTRODUCE_TYPE.SHENQI:case INTRODUCE_TYPE.EQUIP:this._allTipsViews[e]=new EquipTipsBar(this);break;case INTRODUCE_TYPE.IMG:this._allTipsViews[e]=new NormalTipsBar(this);break;case INTRODUCE_TYPE.BOX:this._allTipsViews[e]=new BoxTipsBar(this);break;case INTRODUCE_TYPE.SHOP:this._allTipsViews[e]=new ShopTipsBar(this);break;case INTRODUCE_TYPE.OTHER_CLOHT:this._allTipsViews[e]=new OtherEquipTips(this);break;case INTRODUCE_TYPE.OTHER_CLOHT:this._allTipsViews[e]=new OtherEquipTips(this);break;case INTRODUCE_TYPE.SKILL:this._allTipsViews[e]=new SkillTipsPanel(this)}return this._allTipsViews[e]},t.prototype.onShowTips=function(){this.onHideTips(),this._currTipsBar=this.getTipsView(),this._currTipsBar&&(this._currTipsBar.setParam(this.param),this.addChild(this._currTipsBar))},t.prototype.onHideTips=function(){this._currTipsBar&&(this._currTipsBar.isOnloadComp()&&this._currTipsBar.onRemove(),this._currTipsBar=null)},t.prototype.onSkinName=function(){this.skinName=skins.ItemIntroducebarSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onShowTips()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t}(BaseWindowPanel);__reflect(ItemIntroducebar.prototype,"ItemIntroducebar");var IntroduceBarParam=function(){function e(e,t,n,a,i,o,r){void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=0),this.location=0,this.uid=0,this.pos=0,this.roleID=0,this.quenchingLv=0,this.location=e,this.type=t,this.model=n,this.uid=a,this.pos=i,this.roleID=o,this.quenchingLv=r}return e}();__reflect(IntroduceBarParam.prototype,"IntroduceBarParam");var INTRODUCE_TYPE;!function(e){e[e.OTHER=-1]="OTHER",e[e.IMG=0]="IMG",e[e.CLOTH=1]="CLOTH",e[e.EQUIP=2]="EQUIP",e[e.BOX=3]="BOX",e[e.SHOP=4]="SHOP",e[e.OTHER_CLOHT=5]="OTHER_CLOHT",e[e.SHENQI=6]="SHENQI",e[e.SKILL=7]="SKILL"}(INTRODUCE_TYPE||(INTRODUCE_TYPE={}));var NormalTipsBar=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.NormalTipsBarSkin},t.prototype.onUpdate=function(t){e.prototype.onUpdate.call(this,t);var n;egret.is(t.model,"ThingBase")?n=t.model.model:egret.is(t.model,"ModelThing")&&(n=t.model);var a;a=n.level?"等级:"+n.level:"等级:1",this.level_label.text=a,this.timeGoods=DataManager.getInstance().timeGoodsManager.getTimeGoods(n.type,n.id),e.prototype.onRefreshCommonUI.call(this,n)},t}(BaseTipsBar);__reflect(NormalTipsBar.prototype,"NormalTipsBar");var OtherEquipTips=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUpdate=function(t){this.param=t;var n=t.model,a=n.equipdatearr[t.pos];if(a&&a.model){var i=a.model;e.prototype.onRefreshCommonUI.call(this,i,a.quality);var o=i.coatardLv+Language.instance.getText("grade");this.level_label.text="（"+o+"）",this.label_slot.text=a.model.des;var r;this.param.roleID;this.basic_attr_layer.removeChildren();for(var s=a.attributes,h=0;h<ATTR_TYPE.SIZE;h++){var l=s[h];if(l>0){var g=a.addAttributes[h];r=new AttributeItem,r.data=[h,l,"+"+g],this.basic_attr_layer.addChild(r)}}var r,c=a.pingfenValue;this.cuilian_attr_layer.removeChildren();var p=n.equipgroovearr[t.pos];if(p.quenchingLv>0){var u=JsonModelManager.instance.getModelcuilian()[p.quenchingLv],d=u.effect/1e4;c+=Math.floor(d*c),r=new AttributeItem,r.data=["基础属性 +",u.effect/100+"%"],this.cuilian_attr_layer.addChild(r)}else r=new AttributeItem,r.data=["    未锻造 ",""],this.cuilian_attr_layer.addChild(r);var r,_=p&&p.qianghua>0,m=_?p.qianghua:1,E=DataManager.getInstance().forgeManager.getIntensifyAttr(t.pos,m);this.qianghua_attr_layer.removeChildren();for(var h=0;h<E.length;h++){var l=E[h];l>0&&(l=_?l:0,r=new AttributeItem,r.data=[h,l],this.qianghua_attr_layer.addChild(r))}c+=DataManager.getInstance().forgeManager.getSlotIntensifyPower(t.pos),this.baoshi_group.removeChildren();for(var f=GoodsDefine.SLOT_GEMTYPE[t.pos],y=0;y<f.length;y++){var I=f[y],v=p.baoshi,S=JsonModelManager.instance.getModelbaoshi()[v-1];S&&(r=new AttributeItem,r.data=[I,S.attrAry[I]],this.baoshi_group.addChild(r))}0==this.baoshi_group.numChildren&&(r=new AttributeItem,r.data=["    未锻造 ",""],this.baoshi_group.addChild(r)),c+=DataManager.getInstance().forgeManager.getSlotGemPower(t.pos);var r,T=p&&p.zhuling>0,M=T?p.zhuling:1,A=JsonModelManager.instance.getModelronghun()[GoodsDefine.EQUIP_SLOT_TYPE[t.pos]][M-1];this.zhuling_attr_layer.removeChildren();for(var h=0;h<A.attrAry.length;h++){var l=A.attrAry[h];l>0&&(l=T?l:0,r=new AttributeItem,r.data=[h,l],this.zhuling_attr_layer.addChild(r))}c+=DataManager.getInstance().forgeManager.getSlotInfulsePower(t.pos),this.bmlable_power.power=c.toString()}},t}(ClothEquipTips);__reflect(OtherEquipTips.prototype,"OtherEquipTips");var PetInstance=function(e){function t(){var t=e.call(this)||this;return t._selected=!1,t.skinName=skins.PetInstanceSkin,t}return __extends(t,e),t.prototype.refresh=function(){0==this._data.lv?(this.currentState="activate",this.condition_lab.text=Language.instance.getText("weijihuo"),this.red_point.visible=!1,this.img_icon.source="pet"+this.model.waixing1+"_icon_unopen_png"):(this.currentState="common",this.lab_tier.text=Language.instance.getText(this._data.lv+"","level",this._data.grade,"grade"),this.img_icon.source="pet"+this.model.waixing1+"_icon_open_png"),this._data.isOutBound?(this.lab_state.text=Language.instance.getText("chuzhan"),this.img_state.source="pet_bg_outbound_png"):(this.lab_state.text=Language.instance.getText("rest"),this.img_state.source="pet_bg_rest_png")},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,e.model?this.model=e.gradeModel:this.model=JsonModelManager.instance.getModelchongwujinjie()[this._data.id][0],this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{set:function(e){this._selected=e,this._selected?(this.selectAnim||(this.selectAnim=GameCommon.getInstance().addAnimation("chongwu_xuanzhong",null,this.animLayer,-1)),this.selectAnim.visible=!0):this.selectAnim&&(this.selectAnim.visible=!1)},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(PetInstance.prototype,"PetInstance");var ShopTipsBar=function(e){function t(t){return e.call(this,t)||this
}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.BoxTipsBarSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.buyBar.onRegist(),this.buyBar.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBuy,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateHasMoney,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.buyBar.onRemove(),this.buyBar.btn_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBuy,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateHasMoney,this)},t.prototype.onUpdate=function(t){e.prototype.onUpdate.call(this,t);var n;n=GameCommon.parseAwardItem(this.param.model.item);var a=GameCommon.getInstance().getThingModel(n.type,n.id);e.prototype.onRefreshCommonUI.call(this,a);var i=DataManager.getInstance().bagManager.getGoodsThingById(n.id),o=i?i.num:0;this.goods_num.text="当前拥有："+o,this.buyBar.currentState="buy",this.buyBar.onUpdate(this.param.model),this.buyBar.label_money_owner.text=""+this.buyBar.ownCurrency()},t.prototype.onTouchBuy=function(){if(this.buyBar.sum>this.buyBar.ownCurrency())return void GameCommon.getInstance().addAlert(Language.instance.getText("money_have_not"));var e=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);e.setByte(this.buyBar.model.shopType),e.setInt(this.buyBar.model.id),e.setInt(this.buyBar.num),GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.onupdateHasMoney=function(){this.buyBar.label_money_owner.text=""+this.buyBar.ownCurrency()},t}(BaseTipsBar);__reflect(ShopTipsBar.prototype,"ShopTipsBar");var SmeltInstance=function(e){function t(t){var n=e.call(this)||this;return n._type=0,n._pos=t,n.skinName=skins.SmeltInstanceSkin,n}return __extends(t,e),t.prototype.onUpdate=function(e,t,n){this._thing=e,this._type=t,this._own=n,this.refresh()},Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.refresh()},t.prototype.refresh=function(){switch(this._type){case SMELTINSTANCE_TYPE.NONE:return this.currentState="none",this.item_icon.source="",this.item_frame.source="bag_whiteframe_png",void(this._thing=null);case SMELTINSTANCE_TYPE.SHOWLV:if(!this._thing)return;this.currentState="normal";var e="";this._thing.type==GOODS_TYPE.MASTER_EQUIP?(e=this._thing.model.coatardLv+Language.instance.getText("grade"),this.label_0.textFlow=new Array({text:""+e,style:{textColor:15326899}})):this._thing.type==GOODS_TYPE.SERVANT_EQUIP&&(e=this._thing.model.starNum+Language.instance.getText("star"),this.label_0.textFlow=new Array({text:""+e,style:{textColor:15326899}})),this.label_1.textFlow=[];break;case SMELTINSTANCE_TYPE.SHOWNAME:if(this.currentState="normal",!this._thing)return;this.label_0.textFlow=new Array({text:this._thing.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._thing.model.quality)}}),this.label_1.textFlow=[];break;case SMELTINSTANCE_TYPE.SELECT:if(this.currentState="select",!this._thing)return;this.label_0.textFlow=new Array({text:this._thing.model.name,style:{textColor:15326899}}),this.label_1.textFlow=new Array({text:"评分:"+this._thing.pingfenValue,style:{textColor:15326899}}),this.btn.selected=this._thing.selected}this.item_icon.source=this._thing.model.icon,this.item_frame.source=GameCommon.getInstance().getIconFrame(this._thing.quality)},Object.defineProperty(t.prototype,"thing",{get:function(){return this._thing},enumerable:!0,configurable:!0}),t.prototype.playSmelt=function(){this._thing&&(this._aniSmelt?(this._aniSmelt.visible=!0,this._aniSmelt.playNum=1):(this._aniSmelt=new Animation("ronglian",1),this._aniSmelt.x=this.width/2,this._aniSmelt.y=this.height/2,this.addChild(this._aniSmelt)),this._aniSmelt.playFinishCallBack(this.smeltAnimEnd,this))},t.prototype.smeltAnimEnd=function(){this._aniSmelt&&(this._aniSmelt.visible=!1)},t}(eui.Component);__reflect(SmeltInstance.prototype,"SmeltInstance");var SMELTINSTANCE_TYPE;!function(e){e[e.NONE=0]="NONE",e[e.SHOWLV=1]="SHOWLV",e[e.SHOWNAME=2]="SHOWNAME",e[e.SELECT=3]="SELECT"}(SMELTINSTANCE_TYPE||(SMELTINSTANCE_TYPE={}));var MarryCooperationPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryCooperationPanelSkin},t.prototype.onRegist=function(){this.accessBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.accessBtnClick,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){this.accessBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.accessBtnClick,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh(),this.points[0].register(this.accessBtn,GameDefine.RED_BTN_POS,DataManager.getInstance().marryManager,"checkMarryCooperationPoint")},t.prototype.onRefresh=function(){this.player.marriedTreeExp>0?(this.descLabel.text="您的伴侣为您提供了"+this.player.marriedTreeExp+"点相思树经验，为您的相思树浇注升级带来了满满的爱意，快快领取吧，不要忘记回馈对方，相扶到老不容易！",this.accessBtn.label="领取"):(this.descLabel.text="目前您的伴侣还未对您的相思树提供经验，也许是他（她）忘记了，快先去用铜婚精华、银婚精华或者金婚精华为他的相思树带去满满爱意吧！",this.accessBtn.label="关闭"),this.trigger()},t.prototype.accessBtnClick=function(){this.player.marriedTreeExp>0&&GameCommon.getInstance().sendMsgToServer(new Message(MESSAGE_ID.MARRIAGE_TREE_EXP_RECEIVE_MESSAGE)),this.onHide()},Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(MarryCooperationPanel.prototype,"MarryCooperationPanel");var MarryDivorcePanel=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=PANEL_HIERARCHY_TYPE.II,t.otherId=0,t}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryDivorceSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){1==DataManager.getInstance().playerManager.player.marry_divorce||DataManager.getInstance().marryManager.divorceTime>0?this.currentState="susong":this.currentState="normal";var e=GameCommon.getInstance().onParseAwardItemstr(Constant.get("DIVORCE_COST"));this.consumItem.setCostByAwardItem(e[0])},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.susongBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onSuSong,this),this.qiangzhiBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onQiangZhi,this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSureBtn,this),this.cancelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE.toString(),this.onDivorceMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.susongBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSuSong,this),this.qiangzhiBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onQiangZhi,this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.sureBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSureBtn,this),this.cancelBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE.toString(),this.onDivorceMsg,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onDivorceMsg=function(){0==DataManager.getInstance().marryManager.marryId?GameCommon.getInstance().addAlert("离婚成功"):GameCommon.getInstance().addAlert("请求离婚成功"),this.onHide()},t.prototype.onSureBtn=function(){var e=new Message(MESSAGE_ID.MARRIAGE_DIVORCE_APPLY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.onQiangZhi=function(){var e=[{text:"结婚24小时内离婚无法发布和求婚,是否选择强制离婚？"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onSendDivorce,this)))},t.prototype.onSendDivorce=function(){var e=new Message(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onSuSong=function(){var e=[{text:"结婚24小时内离婚无法发布和求婚,是否选择诉讼离婚？"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onSendSuSong,this)))},t.prototype.onSendSuSong=function(){var e=new Message(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(MarryDivorcePanel.prototype,"MarryDivorcePanel");var MarryDupPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryDupSkin},t.prototype.onInit=function(){this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestDupInfo()},t.prototype.onReciveMsg=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_MARRY,1),t=JsonModelManager.instance.getModelzuduifuben()[e.id],n=e.nextModel;if(this.challenge_btn.label="挑 战",n){var a=Language.instance.getText("coatard_level"+n.lvlimit,"jingjie");"[#FFFF00"+a+"]"+Language.instance.getText("kaiqixiayinandu")}if(t){this.reward_grp.removeChildren();for(var i=0;i<t.rewards.length;i++){var o=new GoodsInstance,r=t.rewards[i];o.onUpdate(r.type,r.id,0,r.quality,r.num),this.reward_grp.addChild(o)}this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,Number(t.bossId)),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim)}GameCommon.parseAwardItem(t.viprewards);this.challenge_btn.enabled=e.lefttimes>0,this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes]},t.prototype.onRefreshSweep=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_MARRY,1);this.challenge_btn.enabled=e.lefttimes>0,this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes]},t.prototype.onRequestDupInfo=function(){DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_MARRY)},t.prototype.onChallengeDup=function(e){var t=this.dupManager.getDupInfolistByType(DUP_TYPE.DUP_MARRY)[0];return t.teamPassRecord>0&&5!=t.lefttimes&&t.lefttimes<=0?void GameCommon.getInstance().addAlert("error_tips_6"):void GameFight.getInstance().onSendCreateTeamDupRoomMsg(t.dupModel.id)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onReciveMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this)},Object.defineProperty(t.prototype,"dupManager",{get:function(){return DataManager.getInstance().dupManager},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(MarryDupPanel.prototype,"MarryDupPanel");var MarryEquipSuitBoss=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryEquipSuitBossSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("marry_tz_boss_title_png"),this.dupinfo=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS)[0],this.modelZDFB=JsonModelManager.instance.getModelzuduifuben()[this.dupinfo.id];var t=this.modelZDFB.rewards;if(t)for(var n=0;n<t.length;++n){var a=t[n],i=new GoodsInstance;i.onUpdate(a.type,a.id,a.uid,a.quality,a.num),this.groupGoods.addChild(i)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onRefreshSweep,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this),this.onRequestDupInfo()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onRefreshSweep,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_SWEEP_MESSAGE.toString(),this.onRefreshSweep,this),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallengeDup,this)},t.prototype.onRequestDupInfo=function(){DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS)},t.prototype.onRefreshSweep=function(){var e=DataManager.getInstance().dupManager.getDupInfo(DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS,1);this.challenge_btn.enabled=e.lefttimes>0,this.lefttimes_bar.data=["",e.lefttimes,e.totalTimes]},Object.defineProperty(t.prototype,"ringManager",{get:function(){return DataManager.getInstance().ringManager},enumerable:!0,configurable:!0}),t.prototype.onChallengeDup=function(e){if(this.dupinfo){if(this.dupinfo.teamPassRecord>0&&5!=this.dupinfo.lefttimes&&this.dupinfo.lefttimes<=0)return void GameCommon.getInstance().addAlert("error_tips_6");GameFight.getInstance().onSendCreateTeamDupRoomMsg(this.dupinfo.dupModel.id)}},t}(BaseSystemPanel);__reflect(MarryEquipSuitBoss.prototype,"MarryEquipSuitBoss");var MarryEquipSuitLevelup=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryEquipSuitLevelupSkin},t.prototype.onShowWithParam=function(t){this.item=t,this.model=t.model,this.model&&e.prototype.onShowWithParam.call(this,this.model)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.setTitle(this.model.name);var e=DataManager.getInstance().ringManager.getLevelEquipSuit(this.model.id);this.groupItem.removeChildren();var t=new MarryEquipSuitItem;t.init(this.item.idx,!1),t.setSkinName(),t.setData(this.model,e),this.groupItem.addChild(t);for(var n="",a="",i=0;i<ATTR_TYPE.SIZE;i++){var o=this.model.attrAry[i];o>0&&(n+=Language.instance.getAttrName(i)+"+"+o*e,a+=Language.instance.getAttrName(i)+"+"+o*(e+1)),i<ATTR_TYPE.SIZE-1&&(n+="\n",a+="\n")}this.cur_attr_lab.text=n,this.next_attr_lab.text=a;var r=this.model.cost;this.consumItem.setCostByAwardItem(r)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this)},t.prototype.onSendUpgradeMsg=function(){var e=this.model.cost;if(GameCommon.getInstance().onCheckItemConsume(e.id,e.num,e.type)){var t=new Message(MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE);t.setShort(this.model.id),GameCommon.getInstance().sendMsgToServer(t)}},t}(BaseWindowPanel);__reflect(MarryEquipSuitLevelup.prototype,"MarryEquipSuitLevelup");var MarryEquipSuitPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryEquipSuitSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.tabs=[];for(var t=this.ringManager.initTabNames(),n=this.ringManager.STRONGER_TYPES.length,a=0;5>a;++a)if(this.tabs[a]=this["tab"+a],n>a){this.tabs[a].labelDisplay.text=t[a]?t[a]:"",this.tabs[a].iconDisplay.source="marry_tz1_icon_0_png";var i=this.tabs[a].value;this.points[a].register(this.tabs[a],new egret.Point(70,0),this.ringManager,"checkTZRedPointTab",i),this.tabs[a].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this),this.tabs[a].visible=!0}else this.tabs[a].visible=!1;this.itemList=[];for(var a=0;10>a;++a){var o=this["item"+a];o.name=a.toString(),o.init(a),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemList[a]=o}this.currTabId=this.tabs[0].value},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnQHDS.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventQHDS,this),this.btnCopy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventCopy,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE.toString(),this.updateCurrItem,this),this.updateUI()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnQHDS.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventQHDS,this),this.btnCopy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventCopy,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_EQUIP_LEVELUP_MESSAGE.toString(),this.updateCurrItem,this)},t.prototype.onEventQHDS=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("MarryEquipSuitQHDS",this.currTabId))},t.prototype.onEventCopy=function(){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_MARRY_EQUIP_SUIT_BOSS)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MarryEquipSuitBoss")},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currIdx=t,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("MarryEquipSuitLevelup",this.itemList[t]))},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currTabId!=t.value&&(this.currTabId=t.value,this.updateUI())},t.prototype.updateUI=function(){for(var e=0;e<this.tabs.length;++e)this.tabs[e].selected=this.tabs[e].value==this.currTabId;this.updateCurrItem()},t.prototype.updateCurrItem=function(){var e=JsonModelManager.instance.getModeljiehuntaozhuang();for(var t in e){var n=e[t];n.taozhuang==this.currTabId&&this.itemList[n.type-1].setData(n,this.ringManager.getLevelEquipSuit(n.id))}var a=this.ringManager.getMarryRingAttributeType(this.currTabId);this.powerbar.power=GameCommon.calculationFighting(a);for(var i="",o=0;4>o;o++)i+=GameDefine.Attr_FontName[o]+"：+"+a[o]+"\n";this.currPro.text=i},Object.defineProperty(t.prototype,"ringManager",{get:function(){return DataManager.getInstance().ringManager},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(MarryEquipSuitPanel.prototype,"MarryEquipSuitPanel");var MarryEquipSuitItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.init=function(e,t){void 0===t&&(t=!0),this.idx=e,this.isCheckRedPoint=t},t.prototype.setSkinName=function(){this.skinName=this.getSkinName(this.idx)},t.prototype.getIconType=function(e){switch(e){case 4:case 5:return 1;case 6:case 7:return 2;case 8:case 9:return 3;default:return 0}},t.prototype.getSkinName=function(e){switch(e){case 4:case 5:return skins.MarryEquipSuitItem1Skin;case 6:case 7:return skins.MarryEquipSuitItem2Skin;case 8:case 9:return skins.MarryEquipSuitItem3Skin;default:return skins.MarryEquipSuitItem0Skin}},t.prototype.setData=function(e,t){this.level=t,this.model=e,this.update()},t.prototype.update=function(){this.labelDisplay.text="+"+this.level,this.icon.source=this.model.waixing1,this.redoint.visible=this.isRedPoint()},t.prototype.isRedPoint=function(){return this.isCheckRedPoint&&this.model&&this.model.cost?DataManager.getInstance().bagManager.getGoodsThingNumById(this.model.cost.id,this.model.cost.type)>=this.model.cost.num:!1},t}(eui.Component);__reflect(MarryEquipSuitItem.prototype,"MarryEquipSuitItem");var MarryEquipSuitQHDS=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryEquipSuitQHDS},t.prototype.onShowWithParam=function(t){void 0===t&&(t=0),this.id=t,this.id&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.imgMask.touchEnabled=!0,this.imgMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.updateTZDS(this.id)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.imgMask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.updateTZDS=function(e){this.setTitle("marry_tz_qhds_title_png");var t=this.ringManager.getQHDSLevel(e),n=this.ringManager.getQHDSModels(e,t);this.tzTitleCurr.text="当前阶段套装等级："+t+"级";var a=null,i=n[0];i?(this.tzProCurr0.text=GameDefine.Attr_FontName[0]+"：+"+i.attrAry[0]+"\n"+GameDefine.Attr_FontName[2]+"：+"+i.attrAry[2],this.tzProCurr1.text=GameDefine.Attr_FontName[1]+"：+"+i.attrAry[1]+"\n"+GameDefine.Attr_FontName[3]+"：+"+i.attrAry[3],a=JsonModelManager.instance.getModelteshuxiaoguo()[i.teshuxiaoguoId],a?(this.tzewCurr.text=LegendDefine.getLegendDescByType(a.type,a.gailv,a.xiaoguo),this.tzewCurr.visible=!0):this.tzewCurr.text="无附加属性"):(this.tzProCurr0.text=GameDefine.Attr_FontName[0]+"：+0\n"+GameDefine.Attr_FontName[2]+"：+0",this.tzProCurr1.text=GameDefine.Attr_FontName[1]+"：+0\n"+GameDefine.Attr_FontName[3]+"：+0",this.tzewCurr.text="无附加属性"),i=n[1],i?(this.tzTitleNext.text="下阶段套装等级达到"+i.mubiao+"级",this.tzProNext0.text=GameDefine.Attr_FontName[0]+"：+"+i.attrAry[0]+"\n"+GameDefine.Attr_FontName[2]+"：+"+i.attrAry[2],this.tzProNext1.text=GameDefine.Attr_FontName[1]+"：+"+i.attrAry[1]+"\n"+GameDefine.Attr_FontName[3]+"：+"+i.attrAry[3],this.tzTitleNext.visible=this.tzProNext0.visible=this.tzProNext1.visible=!0,a=JsonModelManager.instance.getModelteshuxiaoguo()[i.teshuxiaoguoId],a?(this.tzewNext.text=LegendDefine.getLegendDescByType(a.type,a.gailv,a.xiaoguo),this.tzewNext.visible=!0):this.tzewNext.visible=!1,this.currentState="stateDefault"):this.currentState="stateMax"},Object.defineProperty(t.prototype,"ringManager",{get:function(){return DataManager.getInstance().ringManager},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(MarryEquipSuitQHDS.prototype,"MarryEquipSuitQHDS");var MarryListPanel=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.curPage=0,t.rewardArr=new Array,t.selectBoxId=0,t.otherId=0,t}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryListSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.prePage),this.prePage.touchEnabled=!0,this.prePage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPrePage,this),GameCommon.getInstance().addUnderlineStr(this.nextPage),this.nextPage.touchEnabled=!0,this.nextPage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNextPage,this),this.list.itemRenderer=MarryItem,this.list.useVirtualLayout=!1,this.onRefresh()},t.prototype.onRefresh=function(){0==DataManager.getInstance().playerManager.player.marriId?this.fabu.visible=!0:this.fabu.visible=!1,this.curPage=0;var e=new Message(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE);e.setInt(0),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e;e=JsonModelManager.instance.getModelzhenghun();for(var t in e)this.rewardArr.push(e[t]);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.list.addEventListener(egret.TouchEvent.TOUCH_END,this.onItemBtn,this),this.fabuBtn1.name="1",this.fabuBtn2.name="2",this.fabuBtn3.name="3",this.fabuBtn1.addEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.fabuBtn2.addEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.fabuBtn3.addEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.cancelBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onCencel,this),this.fabu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaBu,this),this.bgBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onCencel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE.toString(),this.onShowList,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_AD_MESSAGE.toString(),this.onCloseFaBu,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.list.removeEventListener(egret.TouchEvent.TOUCH_END,this.onItemBtn,this),this.fabuBtn1.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.fabuBtn2.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.fabuBtn3.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSendFaBu,this),this.cancelBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onCencel,this),this.fabu.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaBu,this),this.bgBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onCencel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE.toString(),this.onShowList,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_AD_MESSAGE.toString(),this.onCloseFaBu,this)},t.prototype.onDivorceMsg=function(){0==DataManager.getInstance().marryManager.marryId?GameCommon.getInstance().addAlert("离婚成功"):GameCommon.getInstance().addAlert("请求离婚成功")},t.prototype.onShowList=function(){this.list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().marryManager.marryDatas)},t.prototype.onCloseFaBu=function(){GameCommon.getInstance().addAlert("发布成功"),this.fabuGroup.visible=!1,this.bgBtn.visible=!1;var e=new Message(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE);e.setInt(0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onSendFaBu=function(e){this.selectBoxId=Number(e.target.name),this.dispatchEvent(new egret.Event(egret.TouchEvent.TOUCH_CANCEL));var t=new Message(MESSAGE_ID.MARRIAGE_AD_MESSAGE);return this.selectBoxId<=0?void GameCommon.getInstance().addAlert("请先选择彩礼"):(t.setByte(this.selectBoxId),t.setString(this.label_input.text),void GameCommon.getInstance().sendMsgToServer(t))},t.prototype.onCencel=function(){this.bgBtn.visible=!1,this.fabuGroup.visible=!1},t.prototype.onFaBu=function(){this.fabuGroup.visible=!0,this.bgBtn.visible=!0;var e=JsonModelManager.instance.getModelzhenghun(),t=1;for(var n in e){var a=e[n].costList[0];this["fabuItem"+t].onUpdate(a.type,a.id,0,a.quality,a.num),this["fabuItem"+t].name=a.num,t++}},t.prototype.onDivorce=function(){if(1==DataManager.getInstance().playerManager.player.marry_divorce){var e=new Message(MESSAGE_ID.MARRIAGE_DIVORCE_APPLY_MESSAGE);return void GameCommon.getInstance().sendMsgToServer(e)}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MarryDivorcePanel")},t.prototype.onSendDivorce=function(){var e=new Message(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onPrePage=function(){var e=new Message(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE);return this.curPage<=0?void GameCommon.getInstance().addAlert("已是最前页"):(this.curPage=this.curPage-1,e.setInt(this.curPage),void GameCommon.getInstance().sendMsgToServer(e))},t.prototype.onNextPage=function(){var e=new Message(MESSAGE_ID.MARRIAGE_AD_LIST_MESSAGE);return!DataManager.getInstance().marryManager.marryDatas||DataManager.getInstance().marryManager.marryDatas.length<6?void GameCommon.getInstance().addAlert("没有更多了"):(this.curPage=this.curPage+1,e.setInt(this.curPage),void GameCommon.getInstance().sendMsgToServer(e))},t.prototype.onItemBtn=function(e){if(console.log(e.itemIndex),"求 婚"==e.target.label){var t=DataManager.getInstance().marryManager.marryDatas[Number(e.target.name)];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("MarryQiuHunPanel",t))}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onSureBtn=function(){this.dispatchEvent(new egret.Event(egret.TouchEvent.TOUCH_CANCEL));var e=new Message(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE);e.setInt(this.otherId),GameCommon.getInstance().sendMsgToServer(e)},t.roleIndex=0,t}(BaseTabView);__reflect(MarryListPanel.prototype,"MarryListPanel");var MarryItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.MarryItemSkin,t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){if(this.data){this.data.userdata.id==DataManager.getInstance().playerManager.player.id&&(this.btn_QiuHun.visible=!1),this.btn_QiuHun.name=this.data.idx+"";var e=JsonModelManager.instance.getModelzhenghun()[this.data.cailiId];if(!e)return;this.caili.text="彩礼:"+e.costList[0].num,this.desc.text=this.data.desc,this.userName.text=this.data.userdata.name,this.playerHead.setHead(this.data.userdata.headindex,this.data.userdata.headFrame)}},t.prototype.update=function(e){},t}(eui.ItemRenderer);__reflect(MarryItem.prototype,"MarryItem");var MarryMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(5),n.tabs={},n.tabFs={},n.tabNum=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.onSetTab(),e.prototype.onInit.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE.toString(),this.onSetTab,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE.toString(),this.onSetTab,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_APPLY_MESSAGE.toString(),this.onSetTab,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE.toString(),this.onSetTab,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_MESSAGE.toString(),this.onSetTab,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_DIVORCE_APPLY_MESSAGE.toString(),this.onSetTab,this)},t.prototype.onSetTab=function(){if(0==DataManager.getInstance().playerManager.player.marriId){this.sysQueue=[];var e=new RegisterSystemParam;e.sysName="MarryListPanel",e.btnRes="姻缘墙",e.redP=this.points[0],e.title="姻缘墙",this.sysQueue.push(e),this.setTitle("title_marry_png")}else{this.sysQueue=[];var e=new RegisterSystemParam;e.sysName="MarryTreePanel",e.btnRes="相思树",e.title="相思树",e.redP=this.points[0],e.redP.addTriggerFuc(DataManager.getInstance().marryManager,"checkMarryTreePoint"),this.sysQueue.push(e),e=this.getMarryRingParam(this.points[1]),this.sysQueue.push(e);var e=new RegisterSystemParam;e.sysName="MarryDupPanel",e.btnRes="仙缘boss",e.title="仙缘boss",e.funcID=FUN_TYPE.FUN_MARRY_DUP,e.redP=this.points[2],e.redP.addTriggerFuc(FunDefine,"getDupHasTimes",DUP_TYPE.DUP_MARRY),this.sysQueue.push(e);var e=new RegisterSystemParam;e.sysName="MarryEquipSuitPanel",e.btnRes="仙缘套装",e.title="仙缘套装",e.funcID=FUN_TYPE.FUN_MARRY_EQUIP_SUIT_DUP,e.redP=this.points[3],e.redP.addTriggerFuc(DataManager.getInstance().ringManager,"checkTZRedPointAll"),this.sysQueue.push(e);var e=new RegisterSystemParam;e.sysName="MarryListPanel",e.btnRes="姻缘墙",e.title="姻缘墙",e.redP=this.points[4],e.redP.addTriggerFuc(DataManager.getInstance().marryManager,"divorcePoint"),this.sysQueue.push(e)}this.registerPage(this.sysQueue,"MarryGroup",GameDefine.RED_TAB_POS),this.onRefresh()
},t.prototype.getMarryRingParam=function(e){var t=new RegisterSystemParam;return t.sysName="MarryRingPanel",t.btnRes="婚戒",t.title="婚戒",t.redP=e,t.redP.addTriggerFuc(DataManager.getInstance().ringManager,"checkRedPointAll"),t},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.sysQueue.length>this.index&&this.setTitle(this.sysQueue[this.index].title)},t}(BaseSystemPanel);__reflect(MarryMainPanel.prototype,"MarryMainPanel");var MarryQiuHunPanel=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=PANEL_HIERARCHY_TYPE.II,t.otherId=0,t}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryQiuHunSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onRefresh=function(){this.onShowInfo()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.sureBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onSureBtn,this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE.toString(),this.onCloseJieHun,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.sureBtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onSureBtn,this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE.toString(),this.onCloseJieHun,this)},t.prototype.onCloseJieHun=function(){GameCommon.getInstance().addAlert("结婚成功"),this.onHide()},t.prototype.onShowInfo=function(){this.myName.text=this.getPlayerData().name;var e=this.param;this.otherName.text=e.userdata.name;var t=DataManager.getInstance().playerManager.player.headIndex,n=JsonModelManager.instance.getModelzhenghun()[e.cailiId],a=n.rewards[0],i=n.costList[0];this.item1.onUpdate(n.costList[1].type,n.costList[1].id,0,n.costList[1].quality,n.costList[1].num),this.item2.onUpdate(i.type,i.id,0,i.quality,i.num),this.item3.onUpdate(a.type,a.id,0,a.quality,a.num),this.playerHead1.setHead(t),this.playerHead2.setHead(e.userdata.headindex),this.otherId=e.userdata.id},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onSureBtn=function(){this.dispatchEvent(new egret.Event(egret.TouchEvent.TOUCH_CANCEL));var e=new Message(MESSAGE_ID.MARRIAGE_APPLY_MESSAGE);e.setInt(this.otherId),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(MarryQiuHunPanel.prototype,"MarryQiuHunPanel");var MarryRingManager=function(){function e(){this.STRONGER_TYPES=[STRONGER_MONSTER_TYPE.STRONGER_EQUIPSUIT_1]}return e.prototype.checkRedPointAll=function(){for(var e=3;6>=e;++e)if(this.checkRedPointTab(e))return!0;return!1},e.prototype.checkRedPointTab=function(e){var t=JsonModelManager.instance.getModelhunjie();for(var n in t){var a=t[n];if(a.pinzhi==e){var i=GameCommon.parseAwardItem(a.itemCost),o=DataManager.getInstance().bagManager.getGoodsThingNumById(i.id,i.type);if(o>=i.num)return!0}}return!1},e.prototype.getLevel=function(e){return DataManager.getInstance().playerManager.player.ringLvs[e-1]},e.prototype.initTabNames=function(){var e=[],t=JsonModelManager.instance.getModeljiehuntaozhuang();for(var n in t){var a=t[n];e[a.taozhuang-1]=a.taozhuangName}return e},e.prototype.getLevelEquipSuit=function(e){return DataManager.getInstance().playerManager.player.marryEquipSuitLvs[e-1]},e.prototype.getMarryRingAttributeType=function(e){var t=DataManager.getInstance().playerManager.player,n=GameCommon.getInstance().getAttributeAry(),a=JsonModelManager.instance.getModeljiehuntaozhuang();for(var i in a){var o=a[i];if(o.taozhuang==e){var r=t.marryEquipSuitLvs[o.id-1];if(r>0)for(var s=o.attrAry,h=0;h<s.length;++h)n[h]+=s[h]*r}}return n},e.prototype.checkTZRedPointAll=function(){var e=JsonModelManager.instance.getModeljiehuntaozhuang();for(var t in e){var n=e[t];if(DataManager.getInstance().bagManager.getGoodsThingNumById(n.cost.id,n.cost.type)>=n.cost.num)return!0}return!1},e.prototype.checkTZRedPointTab=function(e){var t=JsonModelManager.instance.getModeljiehuntaozhuang();for(var n in t){var a=t[n];if(a.taozhuang==e&&DataManager.getInstance().bagManager.getGoodsThingNumById(a.cost.id,a.cost.type)>=a.cost.num)return!0}return!1},e.prototype.getQHDSLevel=function(e){var t=1e5,n=JsonModelManager.instance.getModeljiehuntaozhuang();for(var a in n){var i=n[a];i.taozhuang==e&&this.getLevelEquipSuit(i.id)<t&&(t=this.getLevelEquipSuit(i.id))}return t},e.prototype.getQHDSModels=function(e,t){void 0===t&&(t=-1),-1==t&&(t=this.getQHDSLevel(e));var n=JsonModelManager.instance.getModelqianghuadashi()[this.STRONGER_TYPES[e-1]],a=null,i=null;for(var o in n){var r=n[o];if(t<r.mubiao){i=r;break}a=r}return[a,i]},e.prototype.getArtifactGaiLv=function(e){for(var t=0,n=0;n<this.STRONGER_TYPES.length;++n){var a=n+1,i=this.getQHDSModels(a)[0];if(i){var o=JsonModelManager.instance.getModelteshuxiaoguo()[i.teshuxiaoguoId];o&&1==o.opType&&e==o.type&&(t+=o.gailv)}}return t},e.prototype.getArtifactXiaoGuo=function(e){for(var t=0,n=0;n<this.STRONGER_TYPES.length;++n){var a=n+1,i=this.getQHDSModels(a)[0];if(i){var o=JsonModelManager.instance.getModelteshuxiaoguo()[i.teshuxiaoguoId];o&&2==o.opType&&e==o.type&&(t+=o.xiaoguo)}}return t},e}();__reflect(MarryRingManager.prototype,"MarryRingManager");var MarryRingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MarryRingPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.tabs=[];for(var t=["紫品婚戒","橙品仙玉","红品婚玺","金品宝扇"],n=0;4>n;++n){this.tabs[n]=this["tab"+n],this.tabs[n].labelDisplay.text=t[n],this.tabs[n].labelDisplay.size=20;var a=this.tabs[n].value;this.points[n].register(this.tabs[n],new egret.Point(86,0),this.ringManager,"checkRedPointTab",a),this.tabs[n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}this.itemList=[];for(var n=0;6>n;++n)this.itemList[n]=this["item"+n],this.itemList[n].name=n.toString(),this.itemList[n].setSelect(!1),this.itemList[n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this);this.groupRingY=this.groupRing.y,this.currTabId=this.tabs[0].value,this.currIdx=0,this.itemList[this.currIdx].setSelect(!0),this.points[4].register(this.btnLevelup,new egret.Point(140,-5),this,"checkRedPointCurr"),this.updateUI()},t.prototype.actionLogoShow=function(){this.groupRing.y=this.groupRingY;var e=750,t=egret.Tween.get(this.groupRing,{loop:!0});t.to({y:this.groupRingY-20},e),t.to({y:this.groupRingY+20},2*e),t.to({y:this.groupRingY},e)},t.prototype.actionLogoClose=function(){egret.Tween.removeTweens(this.groupRing)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnLevelup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLevelup,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_RING_UP_MESSAGE.toString(),this.onBackLevelup,this),this.actionLogoShow()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnLevelup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLevelup,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_RING_UP_MESSAGE.toString(),this.onBackLevelup,this),this.actionLogoClose()},t.prototype.checkRedPointCurr=function(){return this.getItemCurr().isRedPoint()},t.prototype.onEventLevelup=function(){var e=new Message(MESSAGE_ID.MARRIAGE_RING_UP_MESSAGE);e.setShort(this.getItemCurr().model.id),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onBackLevelup=function(){this.getItemCurr().updateUI(),this.updateCurrItem()},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currIdx!=t&&this.setItemIdx(t)},t.prototype.setItemIdx=function(e){this.itemList[this.currIdx]&&this.itemList[this.currIdx].setSelect(!1),this.currIdx=e,this.itemList[this.currIdx].setSelect(!0),this.updateCurrItem()},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currTabId!=t.value&&(this.currTabId=t.value,this.updateUI())},t.prototype.getItemCurr=function(){return this.itemList[this.currIdx]},t.prototype.updateUI=function(){for(var e=0;4>e;++e)this.tabs[e].selected=this.tabs[e].value==this.currTabId;var t=JsonModelManager.instance.getModelhunjie(),n=0;for(var a in t){var i=t[a];i.pinzhi==this.currTabId&&(this.itemList[n].setData(i,this.ringManager.getLevel(i.id)),++n)}this.updateCurrItem()},t.prototype.updateCurrItem=function(){this.imgIcon.source=this.getItemCurr().model.waixing1;var e=DataManager.getInstance().playerManager.player;this.powerbar.power=GameCommon.calculationFighting(e.getMarryRingAttributeAll());for(var t=this.getItemCurr().model,n=e.ringLvs[t.id-1],a=e.getMarryRingAttribute(t.id,n),i="",o=0;4>o;o++)i+=GameDefine.Attr_FontName[o]+"：+"+a[o]+"\n";this.currPro.text=i,a=e.getMarryRingAttribute(t.id,n+1),i="";for(var o=0;4>o;o++)i+=GameDefine.Attr_FontName[o]+"：+"+a[o]+"\n";this.nextPro.text=i,this.points[4].checkPoint(),this.btnLevelup.enabled=this.checkRedPointCurr();var r=this.getItemCurr().getCost();r?(this.currency.setCostByAwardItem(r),this.currency.visible=!0):this.currency.visible=!1},Object.defineProperty(t.prototype,"ringManager",{get:function(){return DataManager.getInstance().ringManager},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(MarryRingPanel.prototype,"MarryRingPanel");var MarryRingItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.MarryRingItemSkin,t}return __extends(t,e),t.prototype.setData=function(e,t){void 0===t&&(t=0),this.model=e,this.level=t,this.updateUI()},t.prototype.updateUI=function(){this.name_label.text=this.model.name,this.icon_img.source=this.model.waixing1,this.frame_img.source="xinfa_border_"+this.model.pinzhi+"_png",this.nameframe_img.source="xinfa_namebg_"+this.model.pinzhi+"_png",this.level_label.text=this.level+"级";var e=this.getCost(),t=DataManager.getInstance().bagManager.getGoodsThingNumById(e.id,e.type);this.consume_probar.maximum=e.num,this.consume_probar.value=t,this.consume_probar.labelDisplay.visible=!1,this.lbCount.text=t+" / "+e.num,this.redponit_img.visible=t>=e.num},t.prototype.isRedPoint=function(){return this.redponit_img.visible},t.prototype.setSelect=function(e){this.rectSelect.visible=e},t.prototype.getCost=function(){return GameCommon.parseAwardItem(this.model.itemCost)},t}(eui.Component);__reflect(MarryRingItem.prototype,"MarryRingItem");var MarryTreePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.upAnimPos=new egret.Point(310,500),n.index=0,n.currentLv=0,n.points=RedPointManager.createPoint(7),n}return __extends(t,e),Object.defineProperty(t,"costItem",{get:function(){if(!t._costItem){t._costItem=[];for(var e=JsonModelManager.instance.getModelconstant().XIANGSISHU_COST_EXP,n=e.value.split("#"),a=0;a<n.length;++a){var i=n[a].split(",");this.costItem.push(i[0])}}return t._costItem},enumerable:!0,configurable:!0}),t.prototype.onSkinName=function(){this.skinName=skins.MarryTreePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.accessLabel),this.accessLabel.touchEnabled=!0,this.exhibitionItem=[];for(var n=JsonModelManager.instance.getModelconstant().XIANGSISHU_COST_EXP,a=(n.value.split("#"),0);a<t.costItem.length;++a){var i=new ExhibitionItem;i.data=t.costItem[a],0==a?i.select=!0:i.select=!1,i.x=(i.width+30)*a,i.name=a+"",i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectItem,this),this.itemGroup.addChild(i),this.exhibitionItem.push(i),this.points[a].register(i,new egret.Point(75,15),DataManager.getInstance().marryManager,"checkMarryTreeItemPoint",t.costItem[a])}this.points[4].register(this.divorceBtn,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().marryManager,"divorcePoint"),this.points[5].register(this.cooperationBtn,new egret.Point(75,15),DataManager.getInstance().marryManager,"checkMarryCooperationPoint"),this.points[6].register(this.upBtn,GameDefine.RED_BTN_POS,DataManager.getInstance().marryManager,"checkMarryTreeItemPoint",t.costItem[this.index]),this.leftNameLabel.text=this.player.name;var o=new PlayerHeadPanel;o.setHead(this.player.headIndex),o.x=15,o.y=20,this.leftGroup.addChild(o);var r=egret.Tween.get(this.marryHeart,{loop:!0});r.set({y:400,scaleX:.1,scaleY:.1,alpha:0}),r.to({y:250,scaleX:1.2,scaleY:1.2,alpha:1},1500).wait(500),this.refreshDesc(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_UP_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_EXP_RECEIVE_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_EXP_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MARRIAGE_PARTNER_INFO_MESSAGE.toString(),this.updatePartner,this),this.accessLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAccessClick,this),this.divorceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.divorceBtnClick,this),this.cooperationBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cooperationBtnClick,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.upBtnClick,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_UP_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_EXP_RECEIVE_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_TREE_EXP_MESSAGE.toString(),this.onUpMessage,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MARRIAGE_PARTNER_INFO_MESSAGE.toString(),this.updatePartner,this),this.accessLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAccessClick,this),this.divorceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.divorceBtnClick,this),this.cooperationBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cooperationBtnClick,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.upBtnClick,this)},t.prototype.onSelectItem=function(e){for(var n=e.currentTarget,a=0;a<this.exhibitionItem.length;++a)this.exhibitionItem[a].select=!1;this.index=parseInt(n.name),this.exhibitionItem[this.index].select=!0,this.consume=t.costItem[this.index],this.refreshDesc(),this.points[6].param[0]=t.costItem[this.index],this.points[6].checkPoint()},t.prototype.onRefresh=function(){if(e.prototype.onRefresh.call(this),0==this.player.treeLv){var n=JsonModelManager.instance.getModelxiangsishu()[0];this.expBar.maximum=n.exp,this.powerbar.power=0,this.attrLeftLabel.text=GameDefine.Attr_FontName[ATTR_TYPE.HP]+":0 \n"+GameDefine.Attr_FontName[ATTR_TYPE.ATTACK]+":0 \n",this.attrRightLabel.text=GameDefine.Attr_FontName[ATTR_TYPE.PHYDEF]+":0 \n"+GameDefine.Attr_FontName[ATTR_TYPE.MAGICDEF]+":0 \n"}else{var a=JsonModelManager.instance.getModelxiangsishu()[this.player.treeLv-1],i=JsonModelManager.instance.getModelxiangsishu()[this.player.treeLv];i?this.expBar.maximum=i.exp:this.expBar.maximum=0,this.powerbar.power=GameCommon.calculationFighting(a.attrAry);for(var o="",r="",s=0,h=0;h<a.attrAry.length;++h)s=a.attrAry[h],s>0&&(h>ATTR_TYPE.ATTACK?r+=GameDefine.Attr_FontName[h]+"："+s+"\n":o+=GameDefine.Attr_FontName[h]+"："+s+"\n");this.attrLeftLabel.text=o,this.attrRightLabel.text=r}this.treeNameLabel.text="相思树"+this.player.treeLv+"级",this.consume=t.costItem[this.index],this.expBar.value=this.player.treeExp,this.currentLv=this.player.treeLv,this.trigger(),DataManager.getInstance().marryManager.partnerId!=DataManager.getInstance().playerManager.player.marriId&&GameCommon.getInstance().sendMsgToServer(new Message(MESSAGE_ID.MARRIAGE_PARTNER_INFO_MESSAGE))},t.prototype.onUpMessage=function(){this.player.treeLv>this.currentLv&&this.playUpAnimation(),this.onRefresh()},t.prototype.playUpAnimation=function(){GameCommon.getInstance().addAnimation("shengjichenggong",this.upAnimPos,this),this.onRefresh()},t.prototype.divorceBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MarryDivorcePanel"),this.points[4].checkPoint()},t.prototype.cooperationBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MarryCooperationPanel")},t.prototype.upBtnClick=function(){if(DataManager.getInstance().bagManager.getGoodsThingNumById(t.costItem[this.index])>0){var e=new Message(MESSAGE_ID.MARRIAGE_TREE_UP_MESSAGE);e.setByte(this.index+1),GameCommon.getInstance().sendMsgToServer(e)}else GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(3))},t.prototype.onAccessClick=function(){var e=JsonModelManager.instance.getModelitem()[t.costItem[this.index]];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),e.gotype)},Object.defineProperty(t.prototype,"consume",{set:function(e){this.consumeBar.setConsume(GOODS_TYPE.ITEM,e)},enumerable:!0,configurable:!0}),t.prototype.refreshDesc=function(){var e=JsonModelManager.instance.getModelitem()[t.costItem[this.index]];this.descLabel.text=e.des},Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.updatePartner=function(){this.partnerHead||(this.partnerHead=new PlayerHeadPanel,this.partnerHead.x=15,this.partnerHead.y=20,this.rightGroup.addChild(this.partnerHead)),this.partnerHead.setHead(DataManager.getInstance().marryManager.partnerHead,DataManager.getInstance().marryManager.partnerHeadIndex),this.rightNameLabel.text=DataManager.getInstance().marryManager.partnerName},t}(BaseTabView);__reflect(MarryTreePanel.prototype,"MarryTreePanel");var ExhibitionItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.FuLingItemSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.selectImg.source="item_select_state_png",this.selectImg.scaleX=1.3,this.selectImg.scaleY=1.3,this.selectImg.x=-5,this.selectImg.y=-20},Object.defineProperty(t.prototype,"data",{set:function(e){var t=JsonModelManager.instance.getModelitem()[e];this.name_lab.text=t.name,this.itemImg||(this.itemImg=new eui.Image,this.itemImg.x=5,this.itemImg.y=0,this.addChild(this.itemImg)),this.itemImg.source=t.icon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"select",{set:function(e){this.selectImg.visible=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(ExhibitionItem.prototype,"ExhibitionItem");var AttributesPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("属性"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){for(var e=0;e<ATTR_TYPE.SIZE;e++)this["attr_value_label"+e].text=this.getPlayerjiaoseData().attributes[e],this["attrname_label"+e].text=GameCommon.getInstance().getPropertyTitle(e)+""},t.prototype.onSkinName=function(){this.skinName=skins.AttributesPanelSkin},t.prototype.onChangeRole=function(){this.onRefresh()},t.prototype.getPlayerjiaoseData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t}(BaseWindowPanel);__reflect(AttributesPanel.prototype,"AttributesPanel");var AttributesText=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.Attr_Item_Skin2,t}return __extends(t,e),t.prototype.updateAttr=function(e,t,n){void 0===n&&(n=6029312),GameDefine.Attr_FontName[e]?this.updateStr(GameDefine.Attr_FontName[e],"+"+t,n):this.updateStr(e,"+"+t,n)},t.prototype.updateStr=function(e,t,n){void 0===n&&(n=6029312),this.name_Label.text=e,this.attr_value_label.text=t,this.name_Label.textColor=this.attr_value_label.textColor=n},t}(eui.Component);__reflect(AttributesText.prototype,"AttributesText");var AttributesNewText=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.Attr_Item_Skin3,t}return __extends(t,e),t.prototype.updateAttr=function(e,t,n){this.attr_name.text=GameDefine.Attr_FontName[e],this.attr_value_label.text="+"+t,n&&(this.attr_value_label.textColor=n)},t}(eui.Component);__reflect(AttributesNewText.prototype,"AttributesNewText");var RoleEquipPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RoleEquipPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.createRedPoint().register(this.sqBtn,new egret.Point(70,0),DataManager.getInstance().legendManager,"getAllCanLegendAdvance"),this.onRefresh()},t.prototype.onRefresh=function(){this.updateAvatarAnim();for(var e,t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this.getPlayerData().getEquipBySlot(t);e=this["equip_bar"+t],e.onUpdate(n,this.getPlayerData().getEquipSlotThings(t).quenchingLv),e.forgeInfo=this.getPlayerData().getEquipSlotThings(t)}this.onupdateFightPower(),this.onCheckEquipRedPoint(),this.trigger()},t.prototype.onupdateFightPower=function(){this.powerbar.power=this.getPlayerData().figthPower},t.prototype.updateAvatarAnim=function(){this.role_avatar_img.source="login_create_preview"+this.getPlayerData().sex+"_png"},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.updateAvatarAnim,this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.clothMsgUpdate,this),this.btn_loopAttr.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLoopAttributes,this),this.btn_clothAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clothAllBestEquip,this),this.sqBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowSq,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_POWER_UPDATE,this.onupdateFightPower,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.updateAvatarAnim,this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.GAME_CLOTHEQUIP_MESSAGE.toString(),this.clothMsgUpdate,this),this.btn_clothAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clothAllBestEquip,this),this.btn_loopAttr.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLoopAttributes,this),this.sqBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowSq,this),GameDispatcher.getInstance().removeEventListener(GameEvent.PLAYER_POWER_UPDATE,this.onupdateFightPower,this)},t.prototype.clothMsgUpdate=function(e){var t,n=e.data,a=this.getPlayerData().getEquipBySlot(n);t=this["equip_bar"+n],t.onUpdate(a,this.getPlayerData().getEquipSlotThings(n).quenchingLv),t.forgeInfo=this.getPlayerData().getEquipSlotThings(n),t.onPlayClothAnim(),this.onCheckEquipRedPoint()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onTouchLoopAttributes=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"AttributesPanel")},t.prototype.onCheckEquipRedPoint=function(){for(var e=DataManager.getInstance().bagManager.getJobClothEquips(0),t=0;t<GameDefine.Equip_Slot_Num;t++)this["role_point"+t].visible=!1;for(var n in e){var a=e[n];this["role_point"+a.model.part]&&(this["role_point"+a.model.part].visible=!0)}this.roleEquip_point.visible=e.length>0},t.prototype.clothAllBestEquip=function(e){DataManager.getInstance().bagManager.onClothEquipAll()},t.prototype.onShowSq=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LegendMainView")},t}(BaseTabView);__reflect(RoleEquipPanel.prototype,"RoleEquipPanel");var RolePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.funcID=FUN_TYPE.FUN_ROLE,n.btnRes="主角",n.redP=this.createRedPoint(),n.tabBtns=[],n.redP.redName="role";var a=new RegisterTabBtnParam;a.sysName="RoleEquipPanel",a.funcID=FUN_TYPE.FUN_EQUIP,a.tabBtnRes="juese_shizhuang_png",a.title="装备",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(FunDefine,"getRoleEquipPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="WuxingPanel",a.funcID=FUN_TYPE.FUN_WUXING,a.tabBtnRes="juese_wuxing_png",a.title="五行",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(FunDefine,"getWuxingRedPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="PulsePanel",a.funcID=FUN_TYPE.FUN_PULSE,a.title="经脉",a.tabBtnRes="juese_tab_jingmai_png",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().pulseManager,"getCanPulseUpgrade"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="DragonSoulPanel",a.funcID=FUN_TYPE.FUN_DRAGONSOUL,a.tabBtnRes="juese_shenqi_png",a.title="龙魂",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().dragonSoulManager,"checkRedPoint"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="PsychPanel",a.funcID=FUN_TYPE.FUN_YUANSHEN,a.tabBtnRes="juese_btn_yuanshen_png",a.title="元神",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(FunDefine,"getPsychPoint"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.funcID=FUN_TYPE.FUN_SKILL,n.btnRes="技能",n.redP=this.createRedPoint(),n.tabBtns=[],a=new RegisterTabBtnParam,a.sysName="SkillRolePanel",a.funcID=FUN_TYPE.FUN_SKILL,a.tabBtnRes="skill_btn_png",a.title="技能",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().skillManager,"checkMainSkillUp"),n.tabBtns.push(a),a=new RegisterTabBtnParam,a.sysName="SkillEnchantLevelPanel",a.funcID=FUN_TYPE.FUN_SKILL,a.tabBtnRes="xinfashengji_png",a.title="技能",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().skillEnhantM,"checkSkillEnhantUplevelRed"),n.tabBtns.push(a),t.push(n),n=new RegisterSystemParam,n.btnRes="四象",n.funcID=FUN_TYPE.FUN_SIXIANG,n.redP=this.createRedPoint(),n.tabBtns=[];for(var i=["z_btn_icon_qinglong_png","z_btn_icon_baihu_png","z_btn_icon_zhuque_png","z_btn_icon_xuanwu_png"],o=0;o<i.length;o++)a=new RegisterTabBtnParam,a.sysName="SpecialEquipPanel",a.funcID=FUN_TYPE.FUN_SIXIANG,a.tabBtnRes=i[o],a.title="四象",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(FunDefine,"checkSixiangUplevelBySlot",o),n.tabBtns.push(a);t.push(n),n=new RegisterSystemParam,n.btnRes="图鉴",n.redP=this.createRedPoint(),n.tabBtns=[];for(var r=["sanguoyanyi_png","shuihuzhuan_png","xiyouji_png","hongloumeng_png","qunxiazhuan_png"],o=0;o<r.length;o++)a=new RegisterTabBtnParam,a.sysName="TuJianPanel",a.tabBtnRes=r[o],a.title="图鉴",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(FunDefine,"checkTujianRedPointByType",o),n.tabBtns.push(a);t.push(n),n=new RegisterSystemParam,n.sysName="RoleTitlePanel",n.funcID=FUN_TYPE.FUN_TITLE,n.btnRes="称号",n.tabBtns=[],n.redP=this.createRedPoint();for(var s=["z_btn_title_cb_png","z_btn_title_zs_png","z_btn_title_act_png"],o=0;o<s.length;o++)a=new RegisterTabBtnParam,a.sysName="RoleTitlePanel",a.tabBtnRes=s[o],a.title="称号",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().titleManager,"getTitlePoint",o),n.tabBtns.push(a);n.redP.addTriggerFuc(DataManager.getInstance().titleManager,"getTitlePoint",4),t.push(n),this.registerPage(t,"roleGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.checkActivity()},t.prototype.checkActivity=function(){var e=DataManager.getInstance().newactivitysManager.dabiao_model;e&&(11==e.type&&1==this.tabs[3].enabled?(this.basic.tipsLayer.visible=!0,this.basic.tipsLayer.x=303):12==e.type&&1==this.tabs[2].enabled?(this.basic.tipsLayer.visible=!0,this.basic.tipsLayer.x=202):this.basic.tipsLayer.visible=!1)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t}(BaseSystemPanel);__reflect(RolePanel.prototype,"RolePanel");var RoleSelectBar=function(e){function t(){var t=e.call(this)||this;return t._isInit=!1,t.otherNum=0,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.RoleSelectBarSkin,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onShow,t),t}return __extends(t,e),t.prototype.onLoadComplete=function(){},t.prototype.onShow=function(){if(!this._isInit){this._isInit=!0;for(var e=0;e<GameDefine.Max_Role_Num;e++)this["roleHeadBorder"+e].name=""+e;this.onChange(0)}this.onRegist(),this.onRefresh()},t.prototype.onRefreshHeadInfo=function(e,t){0>t?(this["head_icon"+e].source="",this["race_name_icon"+e].source="",this["label_name"+e].text=""):(this["race_name_icon"+e].source=GameCommon.getInstance().getOccpationIcon(t),this["label_name"+e].text=GameCommon.Occupation_RoleName(t))},t.prototype.registFuncBack=function(e,t){this._callBack=e,this._backObj=t},t.prototype.onRegist=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onShow,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPEN_PLAYER_MESSAGE.toString(),this.onRefresh,this);for(var e=0;e<GameDefine.Max_Role_Num;e++)this["roleHeadBorder"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHeadBorder,this)},t.prototype.onRemove=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onShow,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPEN_PLAYER_MESSAGE.toString(),this.onRefresh,this);for(var e=0;e<GameDefine.Max_Role_Num;e++)this["roleHeadBorder"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchHeadBorder,this)},t.prototype.getHeadGroup=function(e){return this["roleHeadBorder"+e]},t.prototype.onRefresh=function(){this.isSelf&&this.updateOpenRoleList()},t.prototype.updateOpenRoleList=function(){for(var e=DataManager.getInstance().playerManager.player,t=0;t<GameDefine.Max_Role_Num;t++){var n=e.getPlayerData(t);n?(this["unopen_group"+t].visible=!1,this["redpoint"+t].visible=!1):(this["unopen_group"+t].visible=!0,e.onCheckRoleCanOpen(t)?(this["unopen_label"+t].text="点击开启",this["redpoint"+t].visible=!0):(this["unopen_label"+t].text="",this["redpoint"+t].visible=!1)),this.onRefreshHeadInfo(t,n?n.occupation:-1)}},t.prototype.registOtherBar=function(e){if(this.otherNum=e.length,this.otherNum>0)for(var t=0;t<GameDefine.Max_Role_Num;t++)this["redpoint"+t].visible=!1,this.otherNum>t?(this["unopen_group"+t].visible=!1,this.onRefreshHeadInfo(t,e[t])):(this["unopen_group"+t].visible=!0,this["unopen_label"+t].text="未开启",this.onRefreshHeadInfo(t,-1))},t.prototype.showOpenRolePanel=function(){this.isSelf&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ActivateRolePanel")},t.prototype.onTouchHeadBorder=function(e){var t=parseInt(e.currentTarget.name);this.isSelf?DataManager.getInstance().playerManager.player.getPlayerData(t)?this.onChange(t):this.showOpenRolePanel():this.otherNum>t&&this.onChange(t)},t.prototype.onChange=function(e,t){if(void 0===t&&(t=!0),e!=this._index){for(var n=0;n<GameDefine.Max_Role_Num;n++)this["selectedImg"+n].visible=!1;this._index=e,this["selectedImg"+this._index].visible=!0,this._callBack&&this._backObj&&t&&Tool.callback(this._callBack,this._backObj)}},Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(e){this.onChange(e)},enumerable:!0,configurable:!0}),t.prototype.onHide=function(){this.onRemove()},Object.defineProperty(t.prototype,"isSelf",{get:function(){return 0==this.otherNum},enumerable:!0,configurable:!0}),t
}(eui.Component);__reflect(RoleSelectBar.prototype,"RoleSelectBar");var SkillAttPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n.useskillTime=0,n}return __extends(t,e),Object.defineProperty(t.prototype,"mainPanel",{get:function(){return this.owner},enumerable:!0,configurable:!0}),t.prototype.onSkinName=function(){this.skinName=skins.SkillAttPanelSkin},t.prototype.onInit=function(){this.roleAvatar=new PlayerBody,this.roleAvatar.isDamageFalse=!0,this.roleAvatar.inMap=!1;var t=GameFight.getInstance().onRandomCrateRobotData(1,2),n=new AppearPlayerData;n.sex=this.playerData.sex;for(var a=0;a<BLESS_TYPE.SIZE;a++)n.appears[a]=this.playerData.getAppearID(a);t.setAppear(n),this.roleAvatar.data=t,this.roleAvatar.onHideHeadBar(!1),this.emenyAvatar=new MonsterBody,this.emenyAvatar.data=new MonsterData(FightDefine.PVE_MONSTER_COMID,BODY_TYPE.MONSTER),this.emenyAvatar.visible=!1,this.emenyAvatar.inMap=!1,this.roleAvatar.onAddEnemyBodyList([this.emenyAvatar]),this.roleAvatar.currTarget=this.emenyAvatar,this.avatar_grp.scaleX=this.avatar_grp.scaleY=.6,this.SKILL_MAX_NUM=this.playerData.skills.length;for(var i=0;i<this.SKILL_MAX_NUM;i++){var o=this.playerData.skills[i],r=this["skill_tab"+i];r.value=o.id,r.label=o.getName(),r.icon=o.getIcon(),this.points[i].register(r,GameDefine.RED_GOODSINSTANCE_POS,this,"oncheckSkillTabRedPoint",o.id)}JsonModelManager.instance.getModelxinfaLv();this.SKIN_MAX_NUM=Math.round(ModelManager.getInstance().getModelLength("xinfaLv")/this.SKILL_MAX_NUM);for(var s=1;s<=this.SKIN_MAX_NUM;s++){var h=JsonModelManager.instance.getModelxinfaLv()[s],l=this["skin_btn"+s];l.name=""+s,l.label=h.name,this.points[this.SKILL_MAX_NUM+s-1].register(l,GameDefine.RED_FASHION_ITEM_POS,this,"oncheckSKinBtnRedPoint",s)}Tool.isNumber(this.mainPanel.curSkin_ID)||(this.mainPanel.curSkill_ID=parseInt(this.skill_tab0.value),this.mainPanel.curSkinBtnIdx=parseInt(this.skin_btn1.name),this.mainPanel.curSkin_ID=1),this.updateBtnName(),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.updateBtnName=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.playerData.skills.length;t++){var n=this["skill_tab"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkillTab,this)}for(var t=1;t<=this.SKIN_MAX_NUM;t++){var a=this["skin_btn"+t];a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkinBtn,this)}GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_ACTIVE_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE.toString(),this.onAdvanceReciveMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE.toString(),this.onAdvanceReciveMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.playerData.skills.length;t++){var n=this["skill_tab"+t];n.selected=!1,n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkillTab,this)}for(var t=1;t<=this.SKIN_MAX_NUM;t++){var a=this["skin_btn"+t];a.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkinBtn,this)}GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_CLOTH_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_ACTIVE_MESSAGE.toString(),this.onUpdateStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_LEVELUP_MESSAGE.toString(),this.onAdvanceReciveMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILLENCHANT_UPGRADE_MESSAGE.toString(),this.onAdvanceReciveMsg,this),this.roleAvatar.onDestroy()},t.prototype.onRefresh=function(){this["skill_tab"+(this.mainPanel.curSkill_ID-1)].selected=!0,this.onUpdateRoleAvatar(),this.onChangeSkillShow(),this.onChangeSkinHandle()},t.prototype.onUpdateRoleAvatar=function(){this.roleAvatar.onUpdateAvatar()},t.prototype.onAdvanceReciveMsg=function(){var e=new Animation("qihunshengji",1,!0);e.x=290,e.y=350,this.addChildAt(e,this.getChildIndex(this.avatar_grp)),this.onChangeSkinHandle()},t.prototype.onTouchSkillTab=function(e){var t=e.currentTarget;if(t.value!=this.mainPanel){this.mainPanel.curSkill_ID=parseInt(t.value),this.useskillTime=0;var n=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+this.mainPanel.curSkinBtnIdx;this.mainPanel.curSkin_ID=n,this.onUpdateAttribute(),this.onUpdateStatus(),this.onUpdateCost()}this.onChangeSkillShow()},t.prototype.onChangeSkillShow=function(){if(!(this.useskillTime>egret.getTimer()))switch(this.avatar_grp.removeChildren(),this.avatar_grp.addChild(this.roleAvatar),this.avatar_grp.addChild(this.emenyAvatar),this.skillInfo.styleNum=this.mainPanel.curSkin_ID,this.roleAvatar.data.onRebirth(),this.roleAvatar.onResetSkillEffect(),this.roleAvatar.x=500,this.roleAvatar.y=745,this.emenyAvatar.x=this.roleAvatar.x+10,this.emenyAvatar.y=this.roleAvatar.y,this.mainPanel.curSkill_ID){case SkillDefine.COMMON_SKILL_ID:Tool.callbackTime(this.onUseSkill,this,300,this.mainPanel.curSkill_ID),Tool.callbackTime(this.onUseSkill,this,1e3,this.mainPanel.curSkill_ID),Tool.callbackTime(this.onUseSkill,this,1700,this.mainPanel.curSkill_ID),this.useskillTime=egret.getTimer()+2e3;break;default:this.onUseSkill(this.mainPanel.curSkill_ID),this.useskillTime=egret.getTimer()+1e3}},t.prototype.onUseSkill=function(e){this.mainPanel.curSkill_ID==e&&(this.roleAvatar.data.useSkill=this.skillInfo,this.roleAvatar.onAttack())},t.prototype.onTouchSkinBtn=function(e){var t=e.currentTarget,n=parseInt(t.name);this.mainPanel.curSkinBtnIdx!=n&&(this.mainPanel.curSkinBtnIdx=n,this.mainPanel.curSkin_ID=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+this.mainPanel.curSkinBtnIdx,this.onChangeSkinHandle()),this.useskillTime=0,this.onChangeSkillShow(),this.trigger()},t.prototype.onChangeSkinHandle=function(){this.changeSelectSkin(),this.onUpdateAttribute(),this.onUpdateStatus(),this.onUpdateCost()},t.prototype.onUpdateStatus=function(){var e=(JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID]),t=e?e.level:0;if(0==t)this.currentState="normal",this.advance_grp.visible=!1,this.btn_active.visible=!0;else{this.currentState="upGrade",this.advance_grp.visible=!0,this.btn_active.visible=!1;var n=this.playerData.getSkillInfoById(this.mainPanel.curSkill_ID);n.styleNum==this.mainPanel.curSkin_ID?this.btn_cloth.label="卸 下":this.btn_cloth.label="启 用"}},t.prototype.onUpdateAttribute=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],n=t?t.level:0,a=GameCommon.getInstance().getAttributeAry();this.attr_item_grp.removeChildren(),this.nextattr_item_grp.removeChildren();for(var i,o=0;o<e.attrAry.length;++o){var r=e.attrAry[o];r>0&&(i=new AttributesText,i.updateAttr(o,r*n),this.attr_item_grp.addChild(i),a[o]=r*n,i=new AttributesText,i.updateAttr(o,r*(n+1)),this.nextattr_item_grp.addChild(i))}this.powerBar.power=GameCommon.calculationFighting(a)},t.prototype.onUpdateCost=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],n=t?t.level:0;if(0==n)if(e.jihuocost){var a=GameCommon.parseAwardItem(e.jihuocost),i=GameCommon.getInstance().getThingModel(a.type,a.id);i.type==GOODS_TYPE.ITEM?this.consumItem.setCostByAwardItem(a):this.consumItem.setCostByAwardItem(e.cost),this.consumItem.visible=!0}else this.consumItem.visible=!1;else{var o=4e3+100*n;this.consumItem.setConsume(GOODS_TYPE.FAHUN,0,o),this.consumItem.visible||(this.consumItem.visible=!0)}},t.prototype.changeSelectSkin=function(){var e=Math.floor(this.mainPanel.curSkin_ID%this.SKIN_MAX_NUM);e=0==e?this.SKIN_MAX_NUM:e;var t=this["skin_btn"+e];this.selectAnim||(this.selectAnim=new Animation("guanghuancheng",-1),this.selectAnim.rotation=45,this.selectAnim.x=47,this.selectAnim.y=52),t.addChild(this.selectAnim)},t.prototype.onActive=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e)if(e.jihuocost){var t=GameCommon.parseAwardItem(e.jihuocost);GameCommon.getInstance().onCheckItemConsume(t.id,t.num,t.type)&&DataManager.getInstance().skillEnhantM.onSendActiveMsg(this.mainPanel.curSkin_ID)}else DataManager.getInstance().skillEnhantM.onSendActiveMsg(this.mainPanel.curSkin_ID)},t.prototype.onCloth=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e){var t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID];if(t&&0!=t.level){var n=this.playerData.getSkillInfoById(this.mainPanel.curSkill_ID);n.styleNum==this.mainPanel.curSkin_ID?DataManager.getInstance().skillEnhantM.onSendClothSkinMsg(0,this.skillInfo.id):DataManager.getInstance().skillEnhantM.onSendClothSkinMsg(this.mainPanel.curSkin_ID,this.skillInfo.id)}}},t.prototype.onAdvanceHanlde=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID];if(e){var t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID];if(t&&0!=t.level){var n=4e3+100*t.level;GameCommon.getInstance().onCheckItemConsume(0,n,GOODS_TYPE.FAHUN)&&DataManager.getInstance().skillEnhantM.onSendLevelUpMsg(this.mainPanel.curSkin_ID)}}},Object.defineProperty(t.prototype,"skillInfo",{get:function(){return this.roleAvatar.data.getSkillInfoById(this.mainPanel.curSkill_ID)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t.prototype.oncheckSkillTabRedPoint=function(e){for(var t=1;t<=this.SKIN_MAX_NUM;t++){var n=(e-1)*this.SKIN_MAX_NUM+t;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUplevelByIDRed(n))return!0}return!1},t.prototype.oncheckSKinBtnRedPoint=function(e){if(Tool.isNumber(this.mainPanel.curSkill_ID)){var t=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+e;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUplevelByIDRed(t))return!0}return!1},t}(BaseTabView);__reflect(SkillAttPanel.prototype,"SkillAttPanel");var SkillRolePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SkillRolePanelSkin},t.prototype.onInit=function(){this.currSkillsLv=[],this.currSkillsGd=[],this.infoReset(),this.list_grp.itemRenderer=SkillUpgradeItem,this.list_grp.itemRendererSkinName=skins.SkillTupoItemSkin,this.list_grp.useVirtualLayout=!0,this.bar.viewport=this.list_grp;this.playerData.skills;this.onRefresh(),this.points[0].register(this.btnUpAll,GameDefine.RED_BTN_POS,this,"checkSkillUpBtn")},t.prototype.onShowTips=function(e){var t=Number(e.target.name);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(7,7,JsonModelManager.instance.getModelskill()[t],0)))},t.prototype.checkSkillUpBtn=function(){for(var e=0;e<this.playerData.skills.length;++e){var t=this.playerData.skills[e];if(DataManager.getInstance().skillManager.checkSkillUp(t.id))return!0}return!1},t.prototype.onRefresh=function(){var e=0,t=this.playerData.skills;this.items=[];for(var n=0;n<SkillDefine.SKILL_NUM;n++){for(var a=t[n],i=(a.model,DataManager.getInstance().skillManager.getSkillUpLevelMax(a)),o=a.level+1;i>=o;o++){var r=JsonModelManager.instance.getModelskilldmg()[o-1];e+=r.cost.num}this.items.push(t[n])}this.label_r.text=e+"",this.cur_cury_lab.text=DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.YUELI)+"",this.list_grp.dataProvider=new eui.ArrayCollection(this.items)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILL_UP_MESSAGE.toString(),this.skillUpHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILL_UP_AUTO_MESSAGE.toString(),this.skillUpHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILL_UPGRADE_MESSAGE.toString(),this.skillUpHandler,this),this.btnUpAll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSkillUpAll,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILL_UP_MESSAGE.toString(),this.skillUpHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILL_UP_AUTO_MESSAGE.toString(),this.skillUpHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILL_UPGRADE_MESSAGE.toString(),this.skillUpHandler,this),this.btnUpAll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSkillUpAll,this)},t.prototype.onSkillUpAll=function(e){var t=new Message(MESSAGE_ID.SKILL_UP_AUTO_MESSAGE);t.setByte(0),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.skillUpHandler=function(e){this.infoReset(),this.onRefresh(),this.trigger()},t.prototype.infoReset=function(){for(var e=0;e<this.playerData.skills.length;e++){var t=this.playerData.skills[e];this.currSkillsLv[e]=t.level,this.currSkillsGd[e]=t.grade}},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(SkillRolePanel.prototype,"SkillRolePanel");var SkillUpgradeItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t}return __extends(t,e),t.prototype.onInit=function(){this.consume.nameColor=15987699,this.upgrade_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),this.points[0].register(this.upgrade_btn,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().skillManager,"checkSkillUpGrade")},t.prototype.onRemove=function(){this.upgrade_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this)},t.prototype.onUpdate=function(){var e=this.data,t=e.model;this.skill_lv_lab.text="Lv."+e.level;GameCommon.getInstance().CreateNameColer(e.grade-1);if(this.skill_icon.source=e.getIcon(),this.skill_name_Icon.source=e.getSkillNameIcon(),t.lv>DataManager.getInstance().playerManager.player.level)this.currentState="unopen",this.open_level_desc.text=Language.instance.getText(t.lv,"level","open");else if(this.currentState="open",e.grade==SkillDefine.SKILL_GRADE_MAX)this.upgrade_btn.visible=!1,this.max_desc_grp.visible=!0,this.tupo_max.text=Language.instance.getText("jinengfumozuigao"),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse("  "+DataManager.getInstance().skillManager.getDesc(e)),this.consume.visible=!1,this.open_desc_grp.visible=!1;else{this.upgrade_btn.visible=!0,this.desc_lab.textFlow=(new egret.HtmlTextParser).parse("  "+DataManager.getInstance().skillManager.getDesc(e));var n,a=JsonModelManager.instance.getModelskilltupo()[e.id];for(var i in a){var n=a[i];if(n.tupoLv==e.grade+1)break}n.jingjie>DataManager.getInstance().playerManager.player.coatardLv?(this.upgrade_btn.enabled=!1,this.open_desc_grp.visible=!0,this.consume.visible=!1,this.tupo_desc_lab.text="  "+Language.instance.getText(n.jingjie,"grade","kefumo")):(this.upgrade_btn.enabled=!0,this.open_desc_grp.visible=!1,this._cost=n.cost,this._cost&&this._cost.type?(this.consume.visible=!0,this.consume.setCostByAwardItem(this._cost)):this.consume.visible=!1)}this.points[0].checkPoint(!0,e.id)},t.prototype.onUpgrade=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SkillUpgradeView",this.data))},t.prototype.onplayUplevelAnim=function(){GameCommon.getInstance().addAnimation("jinengshengji",new egret.Point(68,55),this)},t.prototype.onplayUpGradeAnim=function(){GameCommon.getInstance().addAnimation("jinengfumo",new egret.Point(290,66),this)},t}(BaseListItem);__reflect(SkillUpgradeItem.prototype,"SkillUpgradeItem");var SkillTipsPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.initSkinName=function(){this.skinName=skins.SkillTipsSkin},t.prototype.onUpdate=function(e){var t=e.model;this.name_label.text=t.name,this.desc.text=t.disc,this.icon.source=t.icon},t}(BaseTipsBar);__reflect(SkillTipsPanel.prototype,"SkillTipsPanel");var SkillUpgradeView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SkillTuPoViewSkin},t.prototype.onShowWithParam=function(e){this._skillInfo=e,this.onShow()},t.prototype.onShow=function(){return this._skillInfo?this._skillInfo.grade==SkillDefine.SKILL_GRADE_MAX?void GameCommon.getInstance().addAlert("jinengfumozuigao"):void e.prototype.onShow.call(this):void 0},t.prototype.onInit=function(){this.setTitle("技能附魔"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this._cost=null;var e=this._skillInfo.id,t=this._skillInfo.grade,n=JsonModelManager.instance.getModelskilltupo()[e][t-1],a=JsonModelManager.instance.getModelskilltupo()[e][t];a?(this.currentState="upgrade",this.add_damage_lab.text=a.effect+"点",this._cost=a.cost,this._cost&&this._cost.type&&this.consume.setCostByAwardItem(this._cost)):this.currentState="full",a=a||n,this.name_left_lab.text=this._skillInfo.getName(),this.name_right_lab.text=Language.instance.getText("skillname_"+a.skillId+"_"+(t+1)),this.icon_left_img.source=this._skillInfo.getIcon(),this.icon_right_img.source=this._skillInfo.getIcon(a.tupoLv),this.grade_left_lab.text=n.tupoLv+"阶附魔",this.grade_right_lab.text=a.tupoLv+"阶附魔"},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SKILL_UPGRADE_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SKILL_UPGRADE_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this)},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.onUpgrade=function(){if((!this._cost||GameCommon.getInstance().onCheckItemConsume(this._cost.id,this._cost.num,this._cost.type))&&this._skillInfo){var e=new Message(MESSAGE_ID.SKILL_UPGRADE_MESSAGE);e.setByte(0),e.setByte(this._skillInfo.index),GameCommon.getInstance().sendMsgToServer(e),this.onTouchCloseBtn()}},t}(BaseWindowPanel);__reflect(SkillUpgradeView.prototype,"SkillUpgradeView");var SpecialEquipPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.btn_advance.label=Language.instance.getText("sixiangshengji"),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.SpecialEquipPanelSkin},t.prototype.onRegist=function(){this.points[0].register(this.strengthenMasterBtn,new egret.Point(70,10),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FOURINAGE_UPLEVEL_MESSAGE.toString(),this.reciveUpMessage,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FOURINAGE_UPUPGRADE_MESSAGE.toString(),this.reciveUpMessage,this),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgreade,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenMasterOnClick,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FOURINAGE_UPLEVEL_MESSAGE.toString(),this.reciveUpMessage,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FOURINAGE_UPUPGRADE_MESSAGE.toString(),this.reciveUpMessage,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgreade,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenMasterOnClick,this)},t.prototype.trigger=function(){this.points[0].checkPoint()},t.prototype.onRefresh=function(){this.currentState="xing"+this.currSlotIdx,this.onUpdateLevelInfo()},t.prototype.reciveUpMessage=function(){var e=this.getPlayerData().fourinages[this.currSlotIdx],t=(e.level-1)%7+1,n=new egret.Point(this["star"+t].x+this["star"+t].parent.x+20,this["star"+t].y+80),a=GameCommon.getInstance().addAnimation("sixiangshengji",n,this.effectGroup);a.scaleX=.7,a.scaleY=.7,this.onUpdateLevelInfo()},t.prototype.onUpdateLevelInfo=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG);var e=this.getPlayerData().fourinages[this.currSlotIdx];this.label_name.text=e.level+"星";var t,n=JsonModelManager.instance.getModelsixiang()[this.currSlotIdx][e.level-1],a=JsonModelManager.instance.getModelsixiang()[this.currSlotIdx][e.level],i=n||a,o=0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var r in i.attrAry)i.attrAry[r]>0&&(o=n?n.attrAry[r]:0,t=new AttributesText,t.updateAttr(r,o),this.curPro.addChild(t),a&&(o=a?a.attrAry[r]:0,t=new AttributesText,t.updateAttr(r,o),this.nextPro.addChild(t)));for(var s=e.level%7,h=1;8>h;h++)this["star"+h].visible=!1,s>=h&&(this["star"+h].visible=!0);if(this.cost=null,this.consumItem.visible=null==a?!1:!0,a)this.cost=a.cost,this.consumItem.setCostByAwardItem(this.cost),this.nextImg.visible=!0,this.curImg.visible=!0,this.jiantou.visible=!0,this.nextPro.visible=!0,this.curPro.x=71,this.getGrp.visible=!0,this.consumItem.visible=!0,this.btn_advance.label="升 级";else{for(var h=1;8>h;h++)this["star"+h].visible=!0;this.nextImg.visible=!1,this.curImg.visible=!1,this.jiantou.visible=!1,this.nextPro.visible=!1,this.curPro.x=233,this.getGrp.visible=!1,this.consumItem.visible=!1,this.btn_advance.label="已满级"}this.updatePower()},t.prototype.onUpdateGradeInfo=function(){for(var e=0;e<Fourinages_Type.SIZE;e++){var t=this.getPlayerData().fourinages[e],n=this["info_lab"+e];n.text=t.grade+Language.instance.getText("grade")}var a=this.getPlayerData().fourinages[this.currSlotIdx],i=(JsonModelManager.instance.getModelsixiangjinjie()[this.currSlotIdx][a.grade-1],JsonModelManager.instance.getModelsixiangjinjie()[this.currSlotIdx][a.grade]);this.curr_level_lab.text=a.grade+Language.instance.getText("grade"),this.next_level_lab.text=i?i.level+Language.instance.getText("grade"):"MAX",this.cost=null,this.consumItem.visible=null==i?!1:!0,i&&(this.cost=i.cost,this.consumItem.setCostByAwardItem(this.cost)),this.updatePower()},t.prototype.updatePower=function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=0;t<Fourinages_Type.SIZE;t++){var n=this.getPlayerData().fourinages[t];if(n.level>0){var a=1;if(n.grade>0){var i=JsonModelManager.instance.getModelsixiangjinjie()[t][n.grade-1];a+=i.effect/GameDefine.GAME_ADD_RATIO}for(var o=JsonModelManager.instance.getModelsixiang()[t][n.level-1],r=0;r<ATTR_TYPE.SIZE;++r)o.attrAry[r]>0&&(e[r]+=Math.floor(o.attrAry[r]*a))}}var s=GameCommon.calculationFighting(e);this.powerbar.power=s},t.prototype.onUpgreade=function(){if(this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)){var e=new Message(MESSAGE_ID.FOURINAGE_UPLEVEL_MESSAGE);e.setByte(0),e.setByte(this.currSlotIdx),GameCommon.getInstance().sendMsgToServer(e)}},Object.defineProperty(t.prototype,"currSlotIdx",{get:function(){return this.owner.subTab},enumerable:!0,configurable:!0}),t.prototype.onGetBtn=function(e){this.cost&&GameCommon.getInstance().onShowFastBuy(this.cost.id)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.strengthenMasterOnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_SI_XIANG))},t}(BaseTabView);__reflect(SpecialEquipPanel.prototype,"SpecialEquipPanel");var WuxingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n.isUp=!0,n.dragon_group=[],n.START_POSX=0,n.END_POSX=222,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuxingPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.initMaxLevel(),this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.x=47,this.selectedAnim.y=40,this.selectedAnim.scaleX=.78,this.selectedAnim.scaleY=.78,this.selectedAnim.onPlay(),this.effectGroup.addChild(this.selectedAnim),this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.resetPos(),this.onRefresh()},t.prototype.initMaxLevel=function(){this.maxLevel=0;var e=JsonModelManager.instance.getModelwuxing();for(var t in e)e[t].id>this.maxLevel&&(this.maxLevel=e[t].id)},t.prototype.onRegist=function(){this.btn_zx.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUXING_UP.toString(),this.onUpBack,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){this.btn_zx.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUXING_UP.toString(),this.onUpBack,this),e.prototype.onRemove.call(this)},t.prototype.trigger=function(){this.points[0].checkPoint()},t.prototype.resetPos=function(){var e=DataManager.getInstance().playerManager.player.getPlayerData(t.index).wuxingLevel,n=e%25;this.dragonIdx=Tool.toInt(n/5);var a=e+1;JsonModelManager.instance.getModelwuxing()[a]||0!=n||(this.dragonIdx=4)},t.prototype.onRefresh=function(){var e=DataManager.getInstance().playerManager.player.getPlayerData(t.index).wuxingLevel,n=e%25,a=this.dragonIdx;this.dragonIdx=Tool.toInt(n/5);var i=(a!=this.dragonIdx,Tool.toInt(n%5)),o=e+1;JsonModelManager.instance.getModelwuxing()[o]||0!=n||(this.dragonIdx=4,i=4);for(var r=Tool.toInt(e/5),s=e-5*r,h=(Tool.toInt(s/5)+1,1);h<=GameDefine.WUXIN_NUM;h++)s>=h?this["level_"+h].text=r+1+"级":this["level_"+h].text=r+"级";var l=this.END_POSX;l=this.START_POSX+Math.round((this.END_POSX-this.START_POSX)*(i/5)),this.selectedAnim.x=this["icon_"+(i+1)].x+44,this.selectedAnim.y=this["icon_"+(i+1)].y+46,l>this.exp_scroll.height?(egret.Tween.removeTweens(this.exp_scroll),egret.Tween.get(this.exp_scroll).to({height:l},300,egret.Ease.circOut)):this.exp_scroll.height=l,this.showInfo(e)},t.prototype.onResetDRPoint=function(){},t.prototype.showInfo=function(e){var t,n=JsonModelManager.instance.getModelwuxing(),a=n[e],i=n[e+1],o=a||i;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var r=0,s=0;s<o.attrAry.length;s++)o.attrAry[s]>0&&(r=a?a.attrAry[s]:0,t=new AttributesText,t.updateAttr(s,r),this.curPro.addChild(t),i&&(r=i?i.attrAry[s]:a.attrAry[s],t=new AttributesText,t.updateAttr(s,r),this.nextPro.addChild(t)));a?this.powerBar.power=GameCommon.calculationFighting(a.attrAry):this.powerBar.power=0,i?(this.consume.visible=!0,this.cost=i.cost,this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(i.cost.type,i.cost.id,i.cost.num)),this.isUp=!0,this.currentState="normal"):(this.max=!0,this.consume.visible=!1,this.isUp=!1,this.currentState="max")},t.prototype.onGetBtn=function(e){this.cost&&GameCommon.getInstance().onShowFastBuy(this.cost.id,GOODS_TYPE.GOLD)},t.prototype.onTouchBtn=function(){if(this.isUp){var e=new Message(MESSAGE_ID.WUXING_UP);e.setByte(t.index),GameCommon.getInstance().sendMsgToServer(e)}this.isUp=!1},t.prototype.onUpBack=function(){this.onRefresh(),DataManager.getInstance().playerManager.player.updataAttribute()},t.prototype.strengthenMasterOnClick=function(){},t.index=0,t}(BaseTabView);__reflect(WuxingPanel.prototype,"WuxingPanel");var LegendMainView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.animPos=new egret.Point(300,540),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LegendEquipBasicSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("神器培养");var t=JsonModelManager.instance.getModelshenqi();this.btnTabs=[];for(var n=0;5>n;++n){this.btnTabs[n]=this["btnTab"+n];var a=n+1;this.btnTabs[n].value=a,this.btnTabs[n].tab_name.text=t[a][0].name,this.btnTabs[n].tab_name.size=18,this.btnTabs[n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBtn,this);var i=this.createRedPoint();i.register(this.btnTabs[n],GameDefine.RED_FASHION_ITEM_POS,DataManager.getInstance().legendManager,"getCanLegendAdvance",a)}var o=this.createRedPoint();o.register(this.btnAdvance,GameDefine.RED_BTN_POS_YELLOW_LITTLE,this,"onCheckRedPointBtn"),this.aniName="shenqi_1",this.ani?this.ani.onPlay():(this.ani=new Animation(this.aniName,-1,!1),this.ani.x=this.aniLayer.width/2,this.ani.y=this.aniLayer.height/2+this.aniLayer.height/4,this.ani.scaleX=.95,this.ani.scaleY=.95,this.aniLayer.addChild(this.ani)),this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.setCurrType(1)},t.prototype.onCheckRedPointBtn=function(){return DataManager.getInstance().legendManager.getCanLegendAdvance(this.currType)},t.prototype.onTouchbtnAdvance=function(){if(0==this.data.activate){var e=new Message(MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE);e.setByte(this.data.index),GameCommon.getInstance().sendMsgToServer(e)}else{var t=JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv-1],n=JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv];if(t&&n){if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num,t.cost.type))return;var e=new Message(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE);e.setByte(this.data.index),GameCommon.getInstance().sendMsgToServer(e)}}},t.prototype.onGetBtn=function(e){var t=JsonModelManager.instance.getModelshenqi()[this.currType][0];GameCommon.getInstance().onShowFastBuy(t.cost.id,t.cost.type)},t.prototype.onEventBtn=function(e){var t=e.target.value;this.currType!=t&&this.setCurrType(t)},t.prototype.setCurrType=function(e){this.currType=e;for(var t=0;t<this.btnTabs.length;++t)this.btnTabs[t].selected=this.btnTabs[t].value==e;this.updateUI()},t.prototype.updateAni=function(e){void 0===e&&(e="shenqi_1"),e!=this.aniName&&(this.aniName=e,this.ani.onUpdateRes(e,-1))},t.prototype.updateUI=function(){this.updateAni("shenqi_"+this.currType),this.updatePro(),this.updateGoodsADD(),this.onUpdatePower(),this.trigger()},t.prototype.updatePro=function(){var e,t,n;n=LegendDefine.getLegendDesc(this.currType,this.data.lv-1,!1),this.grade_lab.text=this.data.lv+"阶",e=0==this.data.lv?JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv]:JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv-1],t=LegendDefine.getLegendDesc(this.currType,this.data.lv,!0);var a=JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv],i=e||a;a?this.currentState="advance":(this.btnAdvance.label=Language.instance.getText("shenqiyimanji"),this.currentState="max");
var o=0;for(var r in i.attrAry)i.attrAry[r]>0&&(o=0==this.data.lv?0:e?e.attrAry[r]:0,n.push({text:"\n  "+GameDefine.Attr_FontName[r]+"+"+o}),o=a?a.attrAry[r]:0,t.push({text:"\n  "+GameDefine.Attr_FontName[r]+"+"+o}));this.curPro.textFlow=n,this.nextPro.textFlow=t},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},Object.defineProperty(t.prototype,"data",{get:function(){return this.getPlayerData().getLegendBase(this.currType)},enumerable:!0,configurable:!0}),t.prototype.updateGoodsADD=function(){var e=JsonModelManager.instance.getModelshenqi()[this.currType][this.data.lv];e&&this.consuItem.setCostByAwardItem(e.cost)},t.prototype.onUpdatePower=function(){this.powerBar.power=DataManager.getInstance().legendManager.legendOnePower(this.getPlayerData().getLegendBase(this.currType))},t.prototype.update=function(e){e.type==MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE.toString()?this.playAnim("jihuochenggong",this.animPos,this.animLayer):e.type==MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE.toString()&&this.playAnim("jinjiechenggong",this.animPos,this.animLayer),this.updateUI()},t.prototype.playAnim=function(e,t,n,a){void 0===a&&(a=null),this.animLayer.removeChildren();var i=new Animation(e,1,!0);i.x=t.x,i.y=t.y,i.playFinishCallBack(a,this),this.animLayer.addChild(i)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnAdvance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchbtnAdvance,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE.toString(),this.update,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE.toString(),this.update,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.update,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnAdvance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchbtnAdvance,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_ACTIVATE_MESSAGE.toString(),this.update,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_LEGEND_UPGRADE_MESSAGE.toString(),this.update,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MESSAGE.toString(),this.update,this)},t}(BaseWindowPanel);__reflect(LegendMainView.prototype,"LegendMainView");var VipGodArtifactPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.VipGodArtifactPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPGOD_ARTIFACT_ACTIVATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.VIPGOD_ARTIFACT_UPGRADE_MESSAGE.toString(),this.onRefresh,this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this),this.left_arrow_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLeft,this),this.right_arrow_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRight,this);for(var t in this.tabBtns)this.tabBtns[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPGOD_ARTIFACT_ACTIVATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.VIPGOD_ARTIFACT_UPGRADE_MESSAGE.toString(),this.onRefresh,this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this),this.left_arrow_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLeft,this),this.right_arrow_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRight,this);for(var t in this.tabBtns)this.tabBtns[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)},Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroll.horizontalScrollBar.visible=!1,this.scroll.horizontalScrollBar.autoVisibility=!1,this.tabBtns=[],this.points=[];var t=0,n=JsonModelManager.instance.getModelvipshenqi();for(var a in n){var i=n[a],o=new eui.RadioButton;o.skinName=skins.Radio_Button4_Skin,o.label=i.name,o.icon="vip_shenqi_"+i.id+"_png",o.value=i.id,this.btnbar_grp.addChild(o),this.tabBtns.push(o),this.points[t]=new redPoint,this.points[t].register(o,GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().legendManager,"oncheckVipActifactRedP",i.id),t++}this.currSeletedId=this.tabBtns[0].value,this.tabBtns[0].selected=!0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onTabHanlder(),this.updatePower()},t.prototype.updatePower=function(){var e=GameCommon.calculationFighting(DataManager.getInstance().legendManager.getVipActifactAttrAry());this.powerbar.power=e},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currSeletedId!=t.value&&(this.currSeletedId=t.value,this.onTabHanlder())},t.prototype.onTabHanlder=function(){var e=this.player.vipgodArtifactDict[this.currSeletedId],t=e?e.lv:0,n=JsonModelManager.instance.getModelvipshenqi()[this.currSeletedId];this.actifact_name_lab.text=n.name;var a="xuanqi_"+this.currSeletedId;this.shenqiAnim?this.shenqiAnim.onUpdateRes(a,-1):this.shenqiAnim=GameCommon.getInstance().addAnimation(a,null,this.artifact_anim_grp,-1);for(var i="",o="",r=0;r<ATTR_TYPE.SIZE;r++){var s=n.attrAry[r];s>0&&(i+=Language.instance.getAttrName(r)+"+"+s*t,o+=Language.instance.getAttrName(r)+"+"+s*(t+1)),r<ATTR_TYPE.SIZE-1&&(i+="\n",o+="\n")}if(this.curr_attr_lab.text=i,this.next_attr_lab.text=o,t>0){this.consumItem.visible=!0;DataManager.getInstance().legendManager.getCostNumByID(n.id);this.consumItem.setCostByAwardItem(n.cost),this.btn_upgrade.label=Language.instance.getText("uplevel")}else{var h=n.id;this.consumItem.visible=!1,this.btn_upgrade.label=Language.instance.getText("VIP"+GameCommon.getInstance().getVipName(h),"kejihuo")}},t.prototype.onSendUpgradeMsg=function(){var e=JsonModelManager.instance.getModelvipshenqi()[this.currSeletedId],t=this.player.vipgodArtifactDict[e.id],n=t?t.lv:0,a=e.id;if(n>0){var i=DataManager.getInstance().legendManager.getCostNumByID(e.id);if(GameCommon.getInstance().onCheckItemConsume(e.cost.id,i)){var o=new Message(MESSAGE_ID.VIPGOD_ARTIFACT_UPGRADE_MESSAGE);o.setByte(e.id),GameCommon.getInstance().sendMsgToServer(o)}}else if(this.player.viplevel<a)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("VipPanel",a));else{var r=new Message(MESSAGE_ID.VIPGOD_ARTIFACT_ACTIVATE_MESSAGE);r.setByte(e.id),GameCommon.getInstance().sendMsgToServer(r)}},t.prototype.onTouchLeft=function(){var e=this.scroll.viewport.scrollH-120;this.scroll.viewport.scrollH=0>e?0:e},t.prototype.onTouchRight=function(){var e=this.scroll.viewport.scrollH+120;this.scroll.viewport.scrollH=e>1100?1100:e},t}(BaseTabView);__reflect(VipGodArtifactPanel.prototype,"VipGodArtifactPanel");var DiFuDupChallenge=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XueZhanDupChallengeSkin},t.prototype.onInit=function(){this.Xuezhan_Difficulty=[];for(var e=0;3>e;e++)this.Xuezhan_Difficulty.push(new XueZhanDifficultySelect),this.Xuezhan_Difficulty[e].x=195*e,this.Xuezhan_Difficulty[e].y=30,this.challengePop.addChild(this.Xuezhan_Difficulty[e]);this.onRefresh()},t.prototype.onRefresh=function(){this.updateAwardBoxStatus(),this.onRegist()},t.prototype.onShowWithParam=function(t){this.curBossCfg=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.updateAwardBoxStatus=function(){for(var e=this.curBossCfg.power.split(","),t=0;3>t;t++){var n=(new XueZhanDifficultySelect,GameCommon.getInstance().onParseAwardItemstr(this.curBossCfg["reward"+(t+1)])),a=GameCommon.getInstance().getThingModel(n[0].type,n[0].id,n[0].quality);a&&this.Xuezhan_Difficulty[t].onUpdateItem(a.name,n[0].num,t+1,e[t],this.onChallengeDup)}},t.prototype.onRegist=function(){this.closeDiffBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE.toString(),this.onHide,this)},t.prototype.onRemove=function(){this.closeDiffBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE.toString(),this.onHide,this)},t.prototype.onChallengeDup=function(e){GameFight.getInstance().onSendXuezhanFightMsg(e)},t}(BaseWindowPanel);__reflect(DiFuDupChallenge.prototype,"DiFuDupChallenge");var XueZhanDifficultySelect=function(e){function t(){var t=e.call(this)||this;return t.idx=1,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.XueZhanDifficultySelectSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.btnChallenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},Object.defineProperty(t.prototype,"consumestar",{set:function(e){},enumerable:!0,configurable:!0}),t.prototype.onUpdateItem=function(e,t,n,a,i){switch(this.callfuc=i,this.idx=n,n){case 1:this.icon.x=47,this.icon.y=57;break;case 2:this.icon.x=38,this.icon.y=57;break;case 3:this.icon.x=38,this.icon.y=48}this.power.text="战斗力:"+a,this.award1.text=e+"X"+t,this.award2.text=n.toString(),this.titleName.source="difuTitle"+n+"_png",this.icon.source="difuicon"+n+"_png"},t.prototype.onTouch=function(){this.callfuc&&this.callfuc(this.idx)},t.prototype.onUpdateAttr=function(e){},t}(eui.Component);__reflect(XueZhanDifficultySelect.prototype,"XueZhanDifficultySelect");var DiFuDupPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.AwardMaxNum=2,n.baoxiangStatus=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XueZhanDupPanelSkin},t.prototype.onInit=function(){this.xuezhanItemPos=[];for(var e=0;e<GameDefine.Xuezhan_LayerWaveNum;e++);this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestDupInfo()},t.prototype.onUpDateInfo=function(){for(;this.bossPanel.numChildren>0;){var e=this.bossPanel.getChildAt(0);this.bossPanel.removeChild(e)}var t=DataManager.getInstance().dupManager.xuezhanInfo;if(void 0!=t.xuezhanStar){this.currLayerNum!=DataManager.getInstance().dupManager.xuezhanLayerNum;this.currLayerNum=DataManager.getInstance().dupManager.xuezhanLayerNum,this.xuezhan_layernum.text="第"+this.currLayerNum+"层";var n=0,a=Math.max(1,(this.currLayerNum-1)*GameDefine.Xuezhan_LayerWaveNum+1);this.starNum.text=t.xuezhanStar.toString();var i=0;this.curStar.text=t.addStar.toString();for(var o=0;o<t.layerStars.length;o++)i+=t.layerStars[o];this.maxStar.text=i.toString();for(var r=0,o=a;o<a+GameDefine.Xuezhan_LayerWaveNum;o++){var s=new XuezhanItem,h=JsonModelManager.instance.getModeldifu()[o];s.onsetMonsterBody(h.fightId);var l=t.layerStars.length>=o?t.layerStars[o-1]:0;s.onUpdateStar(l.toString(),o),t.xuezhanWaveNum==o&&(this.curBossCfg=h,r=a+GameDefine.Xuezhan_LayerWaveNum-o),n++,this.bossPanel.addChild(s)}this.xuezhan_buff_attr.text="";for(var g=0,o=0;o<t.attrAddRates.length;o++){var c=t.attrAddRates[o];c>0&&(o>ATTR_TYPE.MAGICDEF?(g+=1,5==g?this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[o]+"+"+c+"   \n":this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[o]+"+"+c+"   "):(g+=1,this.xuezhan_buff_attr.text+=GameDefine.Attr_FontName[o]+"+"+c+"%  "))}switch(""==this.xuezhan_buff_attr.text&&(this.xuezhan_buff_attr.text="无BUFF加成"),this.xuezhan_lefttimes.text=""+t.reviveNum,t.reviveNum<=0&&(this.xuezhan_lefttimes.text="0"),r){case 1:this.curFight.x=460;break;case 2:this.curFight.x=250;break;case 3:this.curFight.x=50}this.updateAwardBoxStatus(),this.onRegist()}},t.prototype.onRequestDupInfo=function(){this.owner.onRequestDupInofMsg(DUP_TYPE.DUP_DIFU)},t.prototype.updateAwardBoxStatus=function(){var e=DataManager.getInstance().dupManager.xuezhanInfo;if(e.isRewardBox?this.baoxiangStatus=1:e.isSelectBuff?this.baoxiangStatus=2:this.baoxiangStatus=0,2==this.baoxiangStatus)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XuezhanBuffPanel");else if(1==this.baoxiangStatus){var t=new AwardNoticeParam;t.desc="恭喜通关地府第"+this.currLayerNum+"层",t.titleSource="txt_jiangliyulan_png",t.btnlabel="领取",t.callFunc=this.onTouchBaoxiang,t.callObj=this;var n=GameCommon.getInstance().onParseAwardItemstr(this.curBossCfg.reward4);t.itemAwards=n,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",t))}},t.prototype.onRegist=function(){this.btnSweep.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodangHandler,this),this.btnChallenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowChallenge,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE.toString(),this.onCloseTips,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_INIT_MESSAGE.toString(),this.onUpDateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE.toString(),this.updateAwardBoxStatus,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_BUFF_MESSAGE.toString(),this.onUpDateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE.toString(),this.onResDupSweepMsg,this)},t.prototype.onRemove=function(){this.btnSweep.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodangHandler,this),this.btnChallenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowChallenge,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_FIGHT_MESSAGE.toString(),this.onCloseTips,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_INIT_MESSAGE.toString(),this.onUpDateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE.toString(),this.updateAwardBoxStatus,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_BUFF_MESSAGE.toString(),this.onUpDateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE.toString(),this.onResDupSweepMsg,this)},t.prototype.onTouchChallengeItem=function(e){},t.prototype.onCloseTips=function(){},t.prototype.onChallengeDup=function(e){GameFight.getInstance().onSendXuezhanFightMsg(e)},t.prototype.onShowChallenge=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("DiFuDupChallenge",this.curBossCfg))},t.prototype.onTouchBaoxiang=function(){if(0==this.baoxiangStatus)this.onShowPassAwardPanel();else if(2==this.baoxiangStatus)GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XuezhanBuffPanel");else if(1==this.baoxiangStatus){var e=new Message(MESSAGE_ID.XUEZHAN_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onSaodangHandler=function(e){for(var t=0;t<GameDefine.Xuezhan_LayerWaveNum;t++);var n=new Message(MESSAGE_ID.XUEZHAN_SAODANG_MESSAGE);GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onShopHandler=function(e){var t=[2];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ShopPanel",t))},t.prototype.onShowPassAwardPanel=function(){var e=new AwardNoticeParam;e.desc="通关本层即可获得如下奖励",e.titleSource="jiangli_title_txt_png",e.itemAwards=[],e.autocloseTime=0;this.currLayerNum*GameDefine.Xuezhan_LayerWaveNum;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",e))},t.prototype.onResDupSweepMsg=function(e){this.onRefresh()},t}(BaseTabView);__reflect(DiFuDupPanel.prototype,"DiFuDupPanel");var XuezhanItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.XuezhanDupItemSkin},t.prototype.onInit=function(){Tool.isNumber(this.monsterAvata)&&this.onsetMonsterBody(this.monsterAvata),this.starnum&&this.onUpdateStar(this.starnum,this.num)},t.prototype.onsetMonsterBody=function(e){this.monsterAvata=e,this.isLoaded&&(this.monsterbody=GameCommon.getInstance().getMonsterBody(this.monsterbody,e),this.monsterbody.parent||(this.monsterbody.scaleX=.8,this.monsterbody.scaleY=.8,this.monsterbody_group.addChild(this.monsterbody)))},t.prototype.onUpdateStar=function(e,t){if(this.starnum=e,this.num=t,this.isLoaded){this.killNum.text="第"+t+"关";for(var n=1;4>n;n++)Number(e)>n-1?this["star"+n].source="star_png":this["star"+n].source="starGrey_png";this.monsterbody&&this.monsterbody.onPlay()}},t.prototype.onreset=function(){this.monsterbody&&(this.monsterbody.onDestroy(),this.monsterbody=null)},t}(BaseComp);__reflect(XuezhanItem.prototype,"XuezhanItem");var LieMingIntroducebar=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LieMingIntroducebarSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btnReplace.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReplace,this),this.btnLvUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLvUp,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.btnReplace.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReplace,this),this.btnLvUp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLvUp,this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onLvUp=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingMainPanel",3)),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LIEMING_LVUP),this.param.fData)},t.prototype.onReplace=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LIEMING_LVUP),null),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingPackagePanel",new LieMingData(1,this.param.fData.slot,"tihuan"))),this.onHide()},t.prototype.onShowWithParam=function(e){this.param=e,this.modelID=this.param.fData.modelID,this.fateLv=this.param.fData.lv,this.onShow()},t.prototype.onRefresh=function(){this.showAttributeInfo()},t.prototype.showAttributeInfo=function(){this.param.fData.slot>=0?(this.btnReplace.visible=!0,this.btnLvUp.visible=!0):(this.btnLvUp.visible=!1,this.btnReplace.visible=!1);var e=0;this.model=JsonModelManager.instance.getModelmingge()[this.param.fData.modelID];var t=JsonModelManager.instance.getModelminggelv()[this.param.fData.lv-1];this.name_label.textFlow=new Array({text:this.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this.model.pinzhi)}}),this.lv_label.text=this.param.fData.lv+"级";var n=[];for(var a in this.model.attrAry)if(this.model.attrAry[a]>0)switch(this.model.pinzhi){case 1:n.push(Tool.toInt(t.attrAry[a]*t.lv/100));break;case 2:n.push(Tool.toInt(t.attrAry[a]*t.lan/100));break;case 3:n.push(Tool.toInt(t.attrAry[a]*t.zi/100));break;case 4:n.push(Tool.toInt(t.attrAry[a]*t.cheng/100));break;case 5:n.push(Tool.toInt(t.attrAry[a]*t.hong/100))}else n.push(0);var i=GameCommon.calculationFighting(n);for(this.bmlable_power.power=i.toString(),this.pingfen_label.text="评分："+i,this.item_icon.source=this.model.icon,this.effectImg.source="";this.avatar_grp.numChildren>0;){var o=this.avatar_grp.getChildAt(0);egret.is(o,"BodyAnimation")||egret.is(o,"Animation")?o.onDestroy():this.avatar_grp.removeChild(o)}if(this.model.pinzhi>2){this.effectImg.source="";var r=new Animation("yuanhun"+this.model.pinzhi);this.avatar_grp.addChild(r),this.avatar_grp.x=200}else this.effectImg.source="liemingEffect"+this.model.pinzhi+"_png";var s;this.basic_attr_layer.removeChildren();for(var e=0;e<ATTR_TYPE.SIZE;e++){var h=n[e];h>0&&(s=new AttributeItem,s.data=[e,h],this.basic_attr_layer.addChild(s))}},t}(BaseWindowPanel);__reflect(LieMingIntroducebar.prototype,"LieMingIntroducebar");var LieMingIntroducebarParam=function(){function e(e){this.fData=e}return e}();__reflect(LieMingIntroducebarParam.prototype,"LieMingIntroducebarParam");var LieMingMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(4),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin,this.setTitle("difutitle_png")},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="DiFuDupPanel",n.btnRes="difuTab",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().dupManager,"difuDupredPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="LieMingObtainPanel",n.btnRes="lieMingTab",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().fateManager,"getObtainPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="LieMingSanHunPanel",n.btnRes="sanhunTab",n.redP=this.points[3],n.redP.addTriggerFuc(DataManager.getInstance().fateManager,"getFateEquipPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="LieMingUpLevel",n.btnRes="shengjiTab",n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().fateManager,"getFatePackage"),t.push(n),this.registerPage(t,"LieMingMainGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onRequestDupInofMsg=function(e){var t=new Message(MESSAGE_ID.XUEZHAN_INIT_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)},t}(BaseSystemPanel);__reflect(LieMingMainPanel.prototype,"LieMingMainPanel");var LieMingObtainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.curItemNum=0,n.curpostion=0,n.isGet=!1,n._effectPosX=0,n._effectPosY=0,n.rewardArr=new Array,n._isGet=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LieMingMainPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.curpostion=DataManager.getInstance().playerManager.player.fateIndex,this.label_points.text=Constant.get(Constant.FATE_GOD_COST),this.onRefresh(),this.onShowSelectEffect(),this.itemGroup.itemRenderer=LieMingItemRenderer,this.itemGroup.itemRendererSkinName=skins.LieMingItemSkin,this.itemGroup.useVirtualLayout=!0,this._isGet=!0},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_getMingGe.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.btn_getMingGe1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch1,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_LOTTERY_MESSAGE.toString(),this.onChouJiang,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_getMingGe.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.btn_getMingGe1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch1,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FATE_LOTTERY_MESSAGE.toString(),this.onChouJiang,this)},t.prototype.onRefresh=function(){this._isGet=!0,this.curItemNum=0,this.itemGroup.dataProvider=new eui.ArrayCollection(this.models);var e=JsonModelManager.instance.getModelchouqian()[DataManager.getInstance().playerManager.player.fateIndex+1];this.currency.setConsume(GOODS_TYPE.ITEM,GoodsDefine.ITEM_ID_FATE,e.costNum);var t=DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.DIAMOND);200>t?this.label_points.textColor=16711680:this.label_points.textColor=15326899},t.prototype.onChouJiang=function(){var e=new egret.Point(this._effectPosX,this._effectPosY);this.onShowSelectEffect(),this.isGet?(this.effectMove.y=545,this.effectMove.x=25+125*this.curpostion,this.effectMove.visible=!0,TweenLiteUtil.beelineTween(this.effectMove,this.onHideEffect,this,e),this.curpostion=DataManager.getInstance().playerManager.player.fateIndex):3==DataManager.getInstance().playerManager.player.fateIndex&&(this.curpostion=DataManager.getInstance().playerManager.player.fateIndex,this.onRefresh())},t.prototype.onShowSelectEffect=function(){for(;this.avatar_grp.numChildren>0;){var e=this.avatar_grp.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.avatar_grp.removeChild(e)}var t=new Animation("liemingxuanzhong");this.avatar_grp.addChild(t),this.avatar_grp.x=122*DataManager.getInstance().playerManager.player.fateIndex+66},t.prototype.onHideEffect=function(e){e.visible=!1,this.onRefresh()},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e=0;for(var t in DataManager.getInstance().playerManager.player.fates)DataManager.getInstance().playerManager.player.fates[t]&&(this.rewardArr[e]=new MingGeItem(JsonModelManager.instance.getModelmingge()[DataManager.getInstance().playerManager.player.fates[t].modelID],new LieMingData(2,0,""),DataManager.getInstance().playerManager.player.fates[t]),e+=1);for(this._effectPosY=95*Math.ceil((e+1)/7)-35,this._effectPosX=e%7*82+23,this.curItemNum=e,e;28>e;e++)this.rewardArr[e]=new MingGeItem(null,new LieMingData(1,0,""),null);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onUpdatePower=function(){},t.prototype.onShowInfo=function(){},t.prototype.onTouch=function(){if(this.isGet=!0,this._isGet){if(this.curItemNum>=28)return void GameCommon.getInstance().addAlert("命魂背包已满清清理后再进行抽取!");this._isGet=!1;var e=new Message(MESSAGE_ID.FATE_LOTTERY_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onTouch1=function(){if(this.isGet=!1,this._isGet=!0,3==DataManager.getInstance().playerManager.player.fateIndex)return void GameCommon.getInstance().addAlert("当前已到达橙色品质,请操作普通抽签获取高品质命魂!");if(4==DataManager.getInstance().playerManager.player.fateIndex)return void GameCommon.getInstance().addAlert("当前已到达红色品质,请操作普通抽签获取高品质命魂!");var e=new Message(MESSAGE_ID.FATE_LOTTERY_MESSAGE);e.setByte(2),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(LieMingObtainPanel.prototype,"LieMingObtainPanel");var LieMingItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.effectImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.dataChanged=function(){if(this.biaoqian.visible=!1,this.data){if(this.data.cfg)if(this.data.cfg.pinzhi>2){if(this.effectImg.source="",0==this.avatar_grp.numChildren){var e=new Animation("yuanhun"+this.data.cfg.pinzhi);e.touchEnabled=!1,e.x=48,e.y=49,this.avatar_grp.addChild(e),this.avatar_grp.touchEnabled=!1,this.avatar_grp.scrollEnabled=!0}}else this.effectImg.source="liemingEffect"+this.data.cfg.pinzhi+"_png";else this.effectImg.source="";switch("isEquip"==this.data.lmData.from&&(this.biaoqian.visible=!0),this.data.lmData.tp){case 1:this.item_icon.visible=!0,this.data.ftData?(this.item_icon.source=this.data.cfg.icon,this.name_label.text=this.data.cfg.name,this.lv_label.text="Lv."+this.data.ftData.lv,this.currentState="haveLv"):(this.item_icon.visible=!1,this.currentState="");break;case 2:this.item_icon.source=this.data.cfg.icon,this.name_label.text=this.data.cfg.name,this.currentState="notName";break;case 3:this.item_icon.source=this.data.cfg.icon,this.name_label.text=this.data.cfg.name,this.lv_label.text="Lv."+this.data.ftData.lv,this.currentState="haveLv";break;case 4:this.item_icon.source=this.data.cfg.icon,this.name_label.text=this.data.cfg.name,this.lv_label.text="Lv."+this.data.ftData.lv,this.currentState="haveLv"}}},t.prototype.onTouch=function(){if(this.data)switch(this.data.lmData.tp){case 1:("equip"==this.data.lmData.from||"lvUp"==this.data.lmData.from)&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LIEMING_EQUIP),this.data);break;case 2:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingIntroducebar",new LieMingIntroducebarParam(this.data.ftData)));break;case 3:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LIEMING_DOWN),this.data);break;case 4:GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.LIEMING_DOWN),this.data)}},t}(eui.ItemRenderer);__reflect(LieMingItemRenderer.prototype,"LieMingItemRenderer");var MingGeItem=function(){function e(e,t,n){this.cfg=e,this.lmData=t,this.ftData=n}return e}();__reflect(MingGeItem.prototype,"MingGeItem");var LieMingPackagePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onSkinName=function(){this.skinName=skins.LieMingPackageSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh(),this.itemGroup.itemRenderer=LieMingItemRenderer,this.itemGroup.itemRendererSkinName=skins.LieMingItemSkin,this.itemGroup.useVirtualLayout=!0},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),GameDispatcher.getInstance().addEventListener(GameEvent.LIEMING_DOWN.toString(),this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_ACTIVE_MESSAGE.toString(),this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),GameDispatcher.getInstance().removeEventListener(GameEvent.LIEMING_DOWN.toString(),this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_ACTIVE_MESSAGE.toString(),this.onHide,this)},t.prototype.onRefresh=function(){this.itemGroup.dataProvider=null,this.itemGroup.dataProvider=new eui.ArrayCollection(this.models)},t.prototype.onTouch=function(){this.onHide()},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e;e=JsonModelManager.instance.getModelmingge();var t=0,n=DataManager.getInstance().playerManager.player.fates;if("lvUp"==this.param.from){for(var a in n)n[a]&&(this.rewardArr[t]=new MingGeItem(e[n[a].modelID],this.param,n[a]),t+=1);var i=DataManager.getInstance().playerManager.player.getPlayerData().fateThings;for(var a in i)i[a].modelID>0&&(this.rewardArr[t]=new MingGeItem(e[i[a].modelID],new LieMingData(3,this.param.solt-1,"isEquip"),i[a]),t+=1)}else if("tihuan"==this.param.from){var i=DataManager.getInstance().playerManager.player.getPlayerData().fateThings;for(var a in n)n[a]&&this.isEquip(Tool.toInt((this.param.solt-1)/7),n[a].modelID,this.param.solt-1,n[a].lv,!0)&&(this.rewardArr[t]=new MingGeItem(e[n[a].modelID],new LieMingData(1,this.param.solt-1,"equip"),n[a]),t+=1)}else for(var a in n)n[a]&&this.isEquip(Tool.toInt((this.param.solt-1)/7),n[a].modelID,this.param.solt-1,0,!1)&&(this.rewardArr[t]=new MingGeItem(e[n[a].modelID],this.param,n[a]),t+=1);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.isEquip=function(e,t,n,a,i){var o=DataManager.getInstance().playerManager.player.getPlayerData().fateThings,r=JsonModelManager.instance.getModelmingge()[t];switch(e){case 0:for(var s=0;7>s;s++){var h=JsonModelManager.instance.getModelmingge()[o[s].modelID];if(h&&i&&s!=n)for(var l in r.attrAry)if(r.attrAry[l]>0&&h.attrAry[l]==r.attrAry[l])return!1}break;case 1:for(var s=0;7>s;s++){var h=JsonModelManager.instance.getModelmingge()[o[s+7].modelID];if(h&&i&&s+7!=n)for(var l in r.attrAry)if(r.attrAry[l]>0&&h.attrAry[l]==r.attrAry[l])return!1}break;case 2:for(var s=0;7>s;s++){var h=JsonModelManager.instance.getModelmingge()[o[s+14].modelID];
if(h&&i&&s+14!=n)for(var l in r.attrAry)if(r.attrAry[l]>0&&h.attrAry[l]==r.attrAry[l])return!1}}return!0},t}(BaseWindowPanel);__reflect(LieMingPackagePanel.prototype,"LieMingPackagePanel");var LieMingData=function(){function e(e,t,n){this.tp=e,this.solt=t,this.from=n}return e}();__reflect(LieMingData.prototype,"LieMingData");var LieMingSanHunPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LieMingSanHunSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.index=0,this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_Quick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this);for(var t=1;8>t;t++)this["itemIcon"+t].name=t,this["itemIcon"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowPackage,this);for(t=1;4>t;t++)this["tabBtn"+t].name=t-1,this["tabBtn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_ACTIVE_MESSAGE.toString(),this.onRefreshEquip,this),GameDispatcher.getInstance().addEventListener(GameEvent.LIEMING_EQUIP.toString(),this.onEquipSend,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_Quick.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this);for(var t=1;8>t;t++)this["itemIcon"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowPackage,this);this.tabBtn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),this.tabBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),this.tabBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FATE_ACTIVE_MESSAGE.toString(),this.onRefreshEquip,this),GameDispatcher.getInstance().removeEventListener(GameEvent.LIEMING_EQUIP.toString(),this.onEquipSend,this)},t.prototype.onRefresh=function(){this.onUpData()},t.prototype.onRefreshEquip=function(){DataManager.getInstance().fateManager.isPackage=!0,this.onRefresh()},t.prototype.onUpData=function(){for(this.powerBar.power=DataManager.getInstance().fateManager.getJobFatePower()+"";this.avatar_grp.numChildren>0;){var e=this.avatar_grp.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.avatar_grp.removeChild(e)}for(var t=1;4>t;t++)this["tabNew"+t].visible=!1,this.getTabNew(7*(t-1))&&(this["tabNew"+t].visible=!0);switch(this.index){case 0:this.onUpDataItemSlot(0);break;case 1:this.onUpDataItemSlot(7);break;case 2:this.onUpDataItemSlot(14)}},t.prototype.getTabNew=function(e){this._fateThings=DataManager.getInstance().playerManager.player.getPlayerData().fateThings;for(var t=0;7>t;t++){if(DataManager.getInstance().dupManager.getXueZhanHistoryNum<GoodsDefine.FATE_UNLOCK[e/7+1])return;var n=JsonModelManager.instance.getModelmingge()[this._fateThings[e+t].modelID];if(n){if(DataManager.getInstance().fateManager.getFateEquipPowerPoint(this._fateThings[e+t],Tool.toInt(e/7)))return!0}else if(DataManager.getInstance().fateManager.getFateEquipPowerPoint(this._fateThings[e+t],Tool.toInt(e/7)))return!0}return!1},t.prototype.onUpDataItemSlot=function(e){for(var t=0;7>t;t++)if(this["redNew"+(t+1)].visible=!1,this["itemIcon"+(t+1)].source="liemingjiahao_png",this["lv_label"+(t+1)].text="",this["name_label"+(t+1)].text="",this["effectImg"+(t+1)].source="",DataManager.getInstance().dupManager.getXueZhanHistoryNum<GoodsDefine.FATE_UNLOCK[e+t])this["itemIcon"+(t+1)].source="public_fun_lock3_png";else{var n=JsonModelManager.instance.getModelmingge()[this._fateThings[e+t].modelID];if(n)if(DataManager.getInstance().fateManager.getFateEquipPowerPoint(this._fateThings[e+t],this.index)&&(this["redNew"+(t+1)].visible=!0),this["itemIcon"+(t+1)].source=n.icon,this["lv_label"+(t+1)].text="Lv."+this._fateThings[e+t].lv,this["name_label"+(t+1)].text=n.name,n.pinzhi>2){var a=new Animation("yuanhun"+n.pinzhi);a.x=this["itemIcon"+(t+1)].parent.x+35,a.y=this["itemIcon"+(t+1)].parent.y+35,this.avatar_grp.addChild(a)}else this["effectImg"+(t+1)].source="liemingEffect"+n.pinzhi+"_png";else DataManager.getInstance().fateManager.getFateEquipPowerPoint(this._fateThings[e+t],this.index)&&(this["redNew"+(t+1)].visible=!0)}},t.prototype.onTab=function(e){var t=Number(e.target.name);if(this.index!=t){if(DataManager.getInstance().dupManager.getXueZhanHistoryNum<GoodsDefine.FATE_UNLOCK[7*t])return void GameCommon.getInstance().addAlert("地府"+GoodsDefine.FATE_UNLOCK[7*t]+"层开启!");this.index=t;for(var n=1;4>n;n++)this["effect"+n].visible=!1;this["effect"+(this.index+1)].visible=!0,this.onRefreshEquip()}},t.prototype.onEquipSend=function(e){if(e.data)if(DataManager.getInstance().fateManager.isEquip(this.index,e.data.ftData.modelID,e.data.lmData.solt)){var t=new Message(MESSAGE_ID.FATE_ACTIVE_MESSAGE);t.setByte(0),t.setInt(e.data.ftData.UID),t.setByte(e.data.lmData.solt),GameCommon.getInstance().sendMsgToServer(t)}else GameCommon.getInstance().addAlert("同属性命格已上限")},t.prototype.onShowPackage=function(e){var t=Number(e.target.name);if(t=7*this.index+t-1,DataManager.getInstance().dupManager.getXueZhanHistoryNum<GoodsDefine.FATE_UNLOCK[t])return void GameCommon.getInstance().addAlert("地府"+GoodsDefine.FATE_UNLOCK[t]+"层开启!");var n=DataManager.getInstance().playerManager.player.getPlayerData().fateThings[t];if(n.modelID>0){var a=JsonModelManager.instance.getModelmingge()[n.modelID];return void(a?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingIntroducebar",new LieMingIntroducebarParam(n))):GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingPackagePanel",new LieMingData(1,t,"equip"))))}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingPackagePanel",new LieMingData(1,t,"equip")))},t.prototype.onAdvanceBack=function(){},t.prototype.onUpdatePower=function(){},t.prototype.onShowInfo=function(){},t.prototype.onTouch=function(){},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(LieMingSanHunPanel.prototype,"LieMingSanHunPanel");var LieMingUpLevel=function(e){function t(t){var n=e.call(this,t)||this;return n.curSlot=0,n.curPinZhi=0,n.rewardArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LieMingUpLevelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.effectImg.source="",this.viewmask=new egret.Shape,this.viewmask.graphics.clear(),this.viewmask.graphics.beginFill(0,.6),this.viewmask.graphics.drawRect(0,0,this.parent.width,this.parent.height),this.viewmask.graphics.endFill(),this.tips_mask.addChild(this.viewmask),this.curId=0,this.onRefresh(),this.itemGroup.itemRenderer=LieMingItemRenderer,this.itemGroup.itemRendererSkinName=skins.LieMingItemSkin,this.itemGroup.useVirtualLayout=!0},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_Quick.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.itemIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBag,this),GameDispatcher.getInstance().addEventListener(GameEvent.LIEMING_DOWN.toString(),this.onUpdateIcon,this),GameDispatcher.getInstance().addEventListener(GameEvent.LIEMING_LVUP.toString(),this.onUpLvUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_REWARD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FATE_UPGRADE_MESSAGE.toString(),this.onAdvanceBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_Quick.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.itemIcon.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBag,this),GameDispatcher.getInstance().removeEventListener(GameEvent.LIEMING_DOWN.toString(),this.onUpdateIcon,this),GameDispatcher.getInstance().removeEventListener(GameEvent.LIEMING_LVUP.toString(),this.onUpLvUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FATE_UPGRADE_MESSAGE.toString(),this.onAdvanceBack,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FATE_REWARD_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){DataManager.getInstance().fateManager.isPackage&&(DataManager.getInstance().fateManager.isPackage=!1,this.onInitFate());for(var e=1;6>e;e++)this["pinzhi"+e]=0;this.itemGroup.dataProvider=new eui.ArrayCollection(this.models)},t.prototype.onInitFate=function(){for(this.ftData=null,this.itemIcon.source="liemingjiahao_png",this.curId=0,this.curLv=0,this.biaoqian.visible=!1,this.fateName.text="",this.fateLv.text="";this.avatar_grp.numChildren>0;){var e=this.avatar_grp.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.avatar_grp.removeChild(e)}this.effectImg.source="",this.currLayer.removeChildren(),this.nextLayer.removeChildren(),this.curProPanel.visible=!1,this.nextProPanel.visible=!1,this.progress.minimum=0,this.progress.maximum=0,this.progress.value=0},t.prototype.onUpLvUp=function(e){this.progress.slideDuration=0,this.ftData=e.data,this.biaoqian.visible=!0,this.getPlayer().fates[this.ftData.UID]&&this.getPlayer().fates[this.ftData.UID].exp==this.ftData.exp&&this.getPlayer().fates[this.ftData.UID].lv==this.ftData.lv&&this.getPlayer().fates[this.ftData.UID].slot==this.ftData.slot&&(this.biaoqian.visible=!1);var t=JsonModelManager.instance.getModelmingge()[this.ftData.modelID];this.itemIcon.source=t.icon,this.fateName.text=t.name,this.fateLv.text="Lv."+this.ftData.lv,this.curId=this.ftData.UID,this.curLv=this.ftData.lv;var n=JsonModelManager.instance.getModelminggelv()[this.ftData.lv-1],a=JsonModelManager.instance.getModelminggelv()[this.ftData.lv];switch(t.pinzhi){case 1:this.progress.maximum=n.exp*n.eXlv/100;break;case 2:this.progress.maximum=n.exp*n.eXlan/100;break;case 3:this.progress.maximum=n.exp*n.eXzi/100;break;case 4:this.progress.maximum=n.exp*n.eXcheng/100;break;case 5:this.progress.maximum=n.exp*n.eXhong/100}if(this.progress.minimum=this.ftData.exp,this.progress.value=this.ftData.exp,t.pinzhi>2){for(this.effectImg.source="";this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}var o=new Animation("yuanhun"+t.pinzhi);this.avatar_grp.addChild(o)}else{for(;this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}this.effectImg.source="liemingEffect"+t.pinzhi+"_png"}this.currLayer.removeChildren(),this.nextLayer.removeChildren(),this.curProPanel.visible=!1,this.nextProPanel.visible=!1;var r,s=0,h=this.getProp(t,n),l=[];a&&(l=this.getProp(t,a));for(var g in t.attrAry)t.attrAry[g]>0&&(r=new AttributesText,s=h?h[g]:0,r.updateAttr(g,t?s:0),this.currLayer.addChild(r),r=new AttributesText,s=l?l[g]:0,r.updateAttr(g,t?s:0),this.nextLayer.addChild(r));this.nextLayer.numChildren>0&&(this.nextProPanel.visible=!0),this.currLayer.numChildren>0&&(this.curProPanel.visible=!0),this.onRefresh()},t.prototype.onShowBag=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingPackagePanel",new LieMingData(4,this.curId,"lvUp")))},t.prototype.onUpdateIcon=function(e){if(e.data){if(0!=this.curId&&"lvUp"!=e.data.lmData.from&&3!=e.data.lmData.tp){if("isEquip"==e.data.lmData.from)return void GameCommon.getInstance().addAlert("已装备的不能被消耗!");if(JsonModelManager.instance.getModelmingge()[e.data.ftData.modelID].pinzhi>=3){this.curMingGe=e.data;var t=[{text:"紫色以上品质是否用来升级"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,this.onConfirm,this)))}else{var n=new Message(MESSAGE_ID.FATE_UPGRADE_MESSAGE);this.biaoqian.visible?(n.setByte(0),n.setInt(this.ftData.slot-1),DataManager.getInstance().fateManager.idEquip=!0):(n.setByte(-1),n.setInt(this.curId),DataManager.getInstance().fateManager.idEquip=!1),n.setShort(1),n.setInt(e.data.ftData.UID),GameCommon.getInstance().sendMsgToServer(n)}}else{this.progress.slideDuration=0,this.ftData=e.data.ftData,this.itemIcon.source=e.data.cfg.icon,this.curId=e.data.ftData.UID,this.curLv=e.data.ftData.lv,this.biaoqian.visible=!0,this.getPlayer().fates[this.curId]&&this.getPlayer().fates[this.curId].exp==this.ftData.exp&&this.getPlayer().fates[this.curId].lv==this.ftData.lv&&this.getPlayer().fates[this.curId].slot==this.ftData.slot&&(this.biaoqian.visible=!1),this.fateName.text=e.data.cfg.name,this.fateLv.text="Lv."+e.data.ftData.lv;var a=JsonModelManager.instance.getModelminggelv()[e.data.ftData.lv-1],i=JsonModelManager.instance.getModelminggelv()[e.data.ftData.lv];switch(e.data.cfg.pinzhi){case 1:this.progress.maximum=a.exp*a.eXlv/100;break;case 2:this.progress.maximum=a.exp*a.eXlan/100;break;case 3:this.progress.maximum=a.exp*a.eXzi/100;break;case 4:this.progress.maximum=a.exp*a.eXcheng/100;break;case 5:this.progress.maximum=a.exp*a.eXhong/100}if(this.progress.minimum=0,this.progress.value=e.data.ftData.exp,e.data.cfg.pinzhi>2){for(this.effectImg.source="";this.avatar_grp.numChildren>0;){var o=this.avatar_grp.getChildAt(0);egret.is(o,"BodyAnimation")||egret.is(o,"Animation")?o.onDestroy():this.avatar_grp.removeChild(o)}var r=new Animation("yuanhun"+e.data.cfg.pinzhi);this.avatar_grp.addChild(r)}else{for(;this.avatar_grp.numChildren>0;){var o=this.avatar_grp.getChildAt(0);egret.is(o,"BodyAnimation")||egret.is(o,"Animation")?o.onDestroy():this.avatar_grp.removeChild(o)}this.effectImg.source="liemingEffect"+e.data.cfg.pinzhi+"_png"}this.currLayer.removeChildren(),this.nextLayer.removeChildren();var s;this.nextProPanel.visible=!1,this.curProPanel.visible=!1;var s,h=0,l=this.getProp(e.data.cfg,a),g=[];i&&(g=this.getProp(e.data.cfg,i));for(var c in e.data.cfg.attrAry)e.data.cfg.attrAry[c]>0&&(s=new AttributesText,h=l?l[c]:0,s.updateAttr(c,e.data.cfg?h:0),this.currLayer.addChild(s),s=new AttributesText,h=g?g[c]:0,s.updateAttr(c,e.data.cfg?h:0),this.nextLayer.addChild(s));this.nextLayer.numChildren>0&&(this.nextProPanel.visible=!0),this.currLayer.numChildren>0&&(this.curProPanel.visible=!0)}this.onRefresh()}},t.prototype.getProp=function(e,t){var n=[];for(var a in e.attrAry)if(e.attrAry[a]>0)switch(e.pinzhi){case 1:n.push(Tool.toInt(t.attrAry[a]*t.lv/100));break;case 2:n.push(Tool.toInt(t.attrAry[a]*t.lan/100));break;case 3:n.push(Tool.toInt(t.attrAry[a]*t.zi/100));break;case 4:n.push(Tool.toInt(t.attrAry[a]*t.cheng/100));break;case 5:n.push(Tool.toInt(t.attrAry[a]*t.hong/100))}else n.push(0);return n},t.prototype.onConfirm=function(){var e=new Message(MESSAGE_ID.FATE_UPGRADE_MESSAGE);this.biaoqian.visible?(DataManager.getInstance().fateManager.idEquip=!0,e.setByte(0),e.setInt(this.ftData.slot-1)):(e.setByte(-1),e.setInt(this.curId),DataManager.getInstance().fateManager.idEquip=!1),e.setShort(1),e.setInt(this.curMingGe.ftData.UID),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onAdvanceBack=function(){var e;if(this.progress.slideDuration=500,e=this.ftData.slot>0?DataManager.getInstance().playerManager.player.getPlayerData().getFateSlotIdx(this.ftData.slot-1):DataManager.getInstance().fateManager.getCurExp(this.biaoqian.visible,this.curId)){if(e.lv>this.curLv){for(this.curLv=e.lv;this.lvUpEffect.numChildren>0;){var t=this.lvUpEffect.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.lvUpEffect.removeChild(t)}var n=new egret.Point(25,50),a=GameCommon.getInstance().addAnimation("qihunshengji",n,this.lvUpEffect);a.scaleX=.5,a.scaleY=.5}this.ftData=e,this.fateLv.text="Lv."+e.lv;var i=JsonModelManager.instance.getModelmingge()[e.modelID],o=JsonModelManager.instance.getModelminggelv()[e.lv-1],r=JsonModelManager.instance.getModelminggelv()[e.lv];switch(i.pinzhi){case 1:this.progress.maximum=o.exp*o.eXlv/100;break;case 2:this.progress.maximum=o.exp*o.eXlan/100;break;case 3:this.progress.maximum=o.exp*o.eXzi/100;break;case 4:this.progress.maximum=o.exp*o.eXcheng/100;break;case 5:this.progress.maximum=o.exp*o.eXhong/100}this.progress.minimum=e.exp,this.progress.value=e.exp,this.currLayer.removeChildren(),this.nextLayer.removeChildren();var s=0,h=void 0,l=this.getProp(i,o),g=[];r&&(g=this.getProp(i,r)),this.nextProPanel.visible=!1,this.curProPanel.visible=!1;for(var c in i.attrAry)i.attrAry[c]>0&&(h=new AttributesText,s=l?l[c]:0,h.updateAttr(c,i?s:0),this.currLayer.addChild(h),h=new AttributesText,s=g?g[c]:0,h.updateAttr(c,i?s:0),this.nextLayer.addChild(h));this.nextLayer.numChildren>0&&(this.nextProPanel.visible=!0),this.currLayer.numChildren>0&&(this.curProPanel.visible=!0)}},t.prototype.onUpdatePower=function(){},t.prototype.onShowInfo=function(){},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e;e=JsonModelManager.instance.getModelmingge();var t=0,n=DataManager.getInstance().playerManager.player.fates;for(var a in n)this.ftData&&this.curId==Number(a)?(n[a]&&n[a].exp!=this.ftData.exp||n[a].lv!=this.ftData.lv||n[a].slot!=this.ftData.slot||n[a].model.id!=this.ftData.model.id)&&(this.rewardArr[t]=new MingGeItem(e[n[a].modelID],new LieMingData(4,this.curId,"noEquip"),n[a]),t+=1):(this.rewardArr[t]=new MingGeItem(e[n[a].modelID],new LieMingData(4,this.curId,"noEquip"),n[a]),t+=1);for(t;28>t;t++)this.rewardArr[t]=new MingGeItem(null,new LieMingData(1,0,""),null);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onTouch=function(){return 0==this.curId?void GameCommon.getInstance().addAlert("请先选择要升级的命格!"):void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("LieMingUpLvPop",this.ftData))},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(LieMingUpLevel.prototype,"LieMingUpLevel");var LieMingUpLvPop=function(e){function t(t){var n=e.call(this,t)||this;return n.pinzhi1=0,n.pinzhi2=0,n.pinzhi3=0,n.pinzhi4=0,n.pinzhi5=0,n.curPinZhi=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LieMingUpPopSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.popBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this);for(var t=1;6>t;t++)this["btn"+t].name=t,this["btn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTunShi,this)},t.prototype.onShowWithParam=function(t){this.curFateData=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.popBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this);for(var t=1;6>t;t++)this["btn"+t].name=t,this["btn"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTunShi,this)},t.prototype.onRefresh=function(){for(var e=1;6>e;e++)this["pinzhi"+e]=0;this.upDatamodels()},t.prototype.onTunShi=function(e){var t=e.target.name;if(this["pinzhi"+t]>0){if(this.curPinZhi=Number(t),Number(t)>=3){var n=[{text:"紫色以上品质是否用来升级"}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,this.onConfirm1,this)))}else{var a=new Message(MESSAGE_ID.FATE_UPGRADE_MESSAGE);this.getPlayer().fates[this.curFateData.UID]&&this.getPlayer().fates[this.curFateData.UID].exp==this.curFateData.exp&&this.getPlayer().fates[this.curFateData.UID].lv==this.curFateData.lv&&this.getPlayer().fates[this.curFateData.UID].slot==this.curFateData.slot?(a.setByte(-1),a.setInt(this.curFateData.UID),DataManager.getInstance().fateManager.idEquip=!1):(a.setByte(0),a.setInt(this.curFateData.slot-1),DataManager.getInstance().fateManager.idEquip=!0);var i=DataManager.getInstance().playerManager.player.onGetFatelvUp(this.curFateData,this.curPinZhi);a.setShort(i.length);for(var o=0;o<i.length;o++)a.setInt(i[o]);GameCommon.getInstance().sendMsgToServer(a)}this.onHide()}},t.prototype.onConfirm1=function(){var e=new Message(MESSAGE_ID.FATE_UPGRADE_MESSAGE);this.getPlayer().fates[this.curFateData.UID]&&this.getPlayer().fates[this.curFateData.UID].exp==this.curFateData.exp&&this.getPlayer().fates[this.curFateData.UID].lv==this.curFateData.lv&&this.getPlayer().fates[this.curFateData.UID].slot==this.curFateData.slot?(e.setByte(-1),e.setInt(this.curFateData.UID),DataManager.getInstance().fateManager.idEquip=!1):(e.setByte(0),e.setInt(this.curFateData.slot-1),DataManager.getInstance().fateManager.idEquip=!0);var t=DataManager.getInstance().playerManager.player.onGetFatelvUp(this.curFateData,this.curPinZhi);e.setShort(t.length);for(var n=0;n<t.length;n++)e.setInt(t[n]);GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t.prototype.upDatamodels=function(){var e;e=JsonModelManager.instance.getModelmingge();var t=0,n=DataManager.getInstance().playerManager.player.fates;for(var a in n)if(n[a].modelID!=this.curFateData.modelID){switch(e[n[a].modelID].pinzhi){case 1:this.pinzhi1=this.pinzhi1+1;break;case 2:this.pinzhi2=this.pinzhi2+1;break;case 3:this.pinzhi3=this.pinzhi3+1;break;case 4:this.pinzhi4=this.pinzhi4+1;break;case 5:this.pinzhi5=this.pinzhi5+1}t+=1}else if(n[a]&&n[a].exp!=this.curFateData.exp||n[a].lv!=this.curFateData.lv||this.curFateData.slot!=n[a].slot){switch(e[n[a].modelID].pinzhi){case 1:this.pinzhi1=this.pinzhi1+1;break;case 2:this.pinzhi2=this.pinzhi2+1;break;case 3:this.pinzhi3=this.pinzhi3+1;break;case 4:this.pinzhi4=this.pinzhi4+1;break;case 5:this.pinzhi5=this.pinzhi5+1}t+=1}for(var i=1;6>i;i++)this["btn"+i].label="X"+this["pinzhi"+i]},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(LieMingUpLvPop.prototype,"LieMingUpLvPop");var Magic3DanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.blessType=0,n.danType=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.Magic3DanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("丹 药"),this.btnTabs=[];for(var t=["pet_juexingIcon_png","pet_zizhiIcon_png","icon_macig_chengzhangdan_png"],n=0;3>n;++n)this.btnTabs[n]=this["btnTab"+n],this.btnTabs[n].value=n,this.btnTabs[n].iconDisplay.source=t[n];this.initModels(),this.onRefresh()},t.prototype.initModels=function(){var e=DataManager.getInstance().blessManager.getBlessJueXingItemId(this.blessType);this.modelJueXing=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,e);var t=JsonModelManager.instance.getModelmountDan();for(var n in t)t[n].type==this.blessType&&(0==t[n].subtype?this.modelZiZhi=t[n]:1==t[n].subtype&&(this.modelChengZhang=t[n]))},t.prototype.onShowWithParam=function(e){this.blessType=e,this.danType=0,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;3>t;++t)this.btnTabs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.updateUI,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE.toString(),this.updateUI,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;3>t;++t)this.btnTabs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.updateUI,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE.toString(),this.updateUI,this)},t.prototype.onRefresh=function(){this.updateUI(),this.updateAvatarAnim()},t.prototype.onTouchBtnUp=function(){switch(this.danType){case 0:if(!GameCommon.getInstance().onCheckItemConsume(this.modelJueXing.id,1,GOODS_TYPE.ITEM))return;var e=new Message(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE);e.setByte(0),e.setByte(this.blessType),GameCommon.getInstance().sendMsgToServer(e);break;case 1:if(!GameCommon.getInstance().onCheckItemConsume(this.modelZiZhi.cost.id,this.modelZiZhi.cost.num,this.modelZiZhi.cost.type))return;var e=new Message(MESSAGE_ID.BLESS_UP_DAN_MESSAGE);e.setByte(0),e.setByte(this.blessType),e.setByte(this.modelZiZhi.subtype),GameCommon.getInstance().sendMsgToServer(e);break;case 2:if(!GameCommon.getInstance().onCheckItemConsume(this.modelChengZhang.cost.id,this.modelChengZhang.cost.num,this.modelChengZhang.cost.type))return;var e=new Message(MESSAGE_ID.BLESS_UP_DAN_MESSAGE);e.setByte(0),e.setByte(this.blessType),e.setByte(this.modelChengZhang.subtype),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.danType!=t.value&&(this.danType=t.value,this.updateUI())},t.prototype.updateUI=function(){0==this.danType?this.updateJueXing():this.updateDan()},t.prototype.updateJueXing=function(){this.lbName.text=this.modelJueXing.name;var e=this.getPlayer().getPlayerData().blessWakeLevel[this.blessType];this.lbLevel.text="等级:"+e;var t=DataManager.getInstance().blessManager.getBlessJueXingValue();if(e>0){var n=t[e-1]/1e4+1;this.curPro.text="全属性加成"+n+"倍"}else this.curPro.text="无属性加成";if(e<t.length){var a=t[e]/1e4+1;this.nextPro.text="全属性加成"+a+"倍",this.consumItem.setConsume(this.modelJueXing.type,this.modelJueXing.id),this.consumItem.visible=this.upBtn.visible=!0}else this.nextPro.text="已升至满级",this.consumItem.visible=this.upBtn.visible=!1},t.prototype.updateDan=function(){var e=1==this.danType?this.modelZiZhi:this.modelChengZhang;this.lbName.text=e.name;var t=DataManager.getInstance().blessManager.getPlayerBlessData(this.blessType),n=1==this.danType?t.danDic[0]:t.danDic[1];this.lbLevel.text="等级:"+n;var a="",i="";if(e.harm>0)a=GameDefine.BlessName[this.blessType]+"全属性:"+e.harm*n/100+"%",i=GameDefine.BlessName[this.blessType]+"全属性:"+e.harm*(n+1)/100+"%";else for(var o=e.attrAry,r=0;r<GameDefine.ATTR_OBJ_KEYS.length;r++)o[r]>0&&(a.length>0&&(a+="\n"),a=a+GameDefine.Attr_FontName[r]+"："+o[r]*n,i.length>0&&(i+="\n"),i=i+GameDefine.Attr_FontName[r]+"："+o[r]*(n+1));this.curPro.text=a,this.nextPro.text=i,this.consumItem.setCostByAwardItem(e.cost)},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.updateAvatarAnim=function(){var e="",t=DataManager.getInstance().blessManager,n=t.getPlayerBlessData(this.blessType),a=t.getBlessModelByData(n);for(a=a?a:t.getBlessModel(this.blessType,1,1),this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}var o=0,r=DataManager.getInstance().playerManager.player.getPlayerData().fashionWearIds[this.blessType],s=JsonModelManager.instance.getModelfashion()[r];s&&(o=s.waixing1);var h=1;switch(this.blessType){case BLESS_TYPE.HORSE:e="zuoqi_"+o;var l=new Animation(e);l.y=0,this.avatar_grp.addChild(l);break;case BLESS_TYPE.WEAPON:e="jian"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),h=.7;break;case BLESS_TYPE.CLOTHES:var c=DataManager.getInstance().playerManager.player.getPlayerData().sex==SEX_TYPE.MALE?"nan":"nv";e="shenzhuang_"+c+"_"+o;var g=new Animation(e,-1);g.y=140,this.avatar_grp.addChild(g),h=.7;break;case BLESS_TYPE.MAGIC:var g=new Animation("sc_magic"+o,-1);this.avatar_grp.addChild(g);break;case BLESS_TYPE.WING:var g=new Animation("wing"+o+"_ui",-1);g.y=120,this.avatar_grp.addChild(g)}this.avatar_grp.scaleX=this.avatar_grp.scaleY=h},t}(BaseWindowPanel);__reflect(Magic3DanPanel.prototype,"Magic3DanPanel");var MagicBaoQiPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicBaoQiSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){switch(this.owner.tab){case BLESS_TAB_TYPE.LINGSHOU:return FUN_TYPE.FUN_MOUNT;case BLESS_TAB_TYPE.SHENZHUANG:return FUN_TYPE.FUN_SHENZHUANG;case BLESS_TAB_TYPE.SHENGBING:return FUN_TYPE.FUN_SHENBING;case BLESS_TAB_TYPE.XIANYU:return FUN_TYPE.FUN_XIANYU;case BLESS_TAB_TYPE.GUANGHUAN:return FUN_TYPE.FUN_FABAO}return 0},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.onRefreshUpGrade(),this.onUpdatePower()},t.prototype.onRefreshUpGrade=function(){var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.owner.tab),n=e.getBlessModelByData(t),a=e.getNextBlessModel(this.owner.tab,t.grade,t.level),i=n||a;this.mountName.text=i.name,0==DataManager.getInstance().blessManager.btnType?this.baoqiPanel.visible=!0:this.baoqiPanel.visible=!1,n&&(this.progress.maximum=n.exp,this.progress.value=t.exp),this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType);for(var o=0;10>o;++o){var r=this["star"+o];if(!r)return;o<t.level?r.visible||(r.alpha=0,r.visible=!0,egret.Tween.get(r).to({alpha:1},600,egret.Ease.sineOut).call(function(e){egret.Tween.removeTweens(e)},this,[r])):r.visible=!1}},t.prototype.onUpdatePower=function(){},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onUpgrade=function(e){Tool.log("sdsadsadas"),this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&DataManager.getInstance().blessManager.onSendBlessUpMsg(this.owner.tab,!1)},t.prototype.upHandler=function(e){this.onRefreshUpGrade(),this.onUpdatePower()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.basicPanel.updateGoodsADD()},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.basicPanel&&this.basicPanel.trigger()},t}(BaseTabView);__reflect(MagicBaoQiPanel.prototype,"MagicBaoQiPanel");var MagicBasicPanel=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(10),t.blessType=-1,t.consumeTP=0,t.currIdx=-1,t.iconNames=["","z_btn_icon_levelup_png","z_btn_icon_huanhua_png","z_btn_icon_taozhuang_png","tianfu_png","z_btn_icon_guahun_png"],t.isActTaoZhuang=!0,t.skinName=skins.MagicBasicSkin,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddStage,t),t
}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.onRegist(),this.blessType>-1&&this.refresh(),SDKManager.isHidePay&&SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&this.topBtn3.parent.removeChild(this.topBtn3)},t.prototype.onAddStage=function(){},t.prototype.trigger=function(){for(var e=0;e<this.points.length;++e)this.points[e].checkPoint();if(this.pointItems)for(var e=0;e<this.pointItems.length;++e)this.pointItems[e].checkPoint()},t.prototype.onRegist=function(){this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),this.btnActive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnActive,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),this.btnDan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),this.btnSkill.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showSkillPanel,this),this.btnHuanhua.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendHuanHua,this),this.huanhua_jihuo_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHuahuaActive,this),this.fashionLvUpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHuanHuaLvUp,this),this.btnSendUpTaoZhuang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendTaoZhuangUp,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this);for(var e=1;6>e;e++)this["topBtn"+e].name=e-1,this["topBtn"+e].iconDisplay.source=this.iconNames[e],this["topBtn"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.topPanel,this);this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this)},t.prototype.onRemove=function(){this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),this.btnActive.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnActive,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),this.btnDan.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),this.btnSkill.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showSkillPanel,this),this.btnHuanhua.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendHuanHua,this),this.huanhua_jihuo_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHuahuaActive,this),this.fashionLvUpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHuanHuaLvUp,this),this.btnSendUpTaoZhuang.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendTaoZhuangUp,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this);for(var e=1;6>e;e++)this["topBtn"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.topPanel,this)},t.prototype.initBtn=function(){},t.prototype.refresh=function(){this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(this.blessType),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(this.blessType),this.getGrp.visible=!0,this.onChangeBtn();var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.blessType),n=e.getBlessModelByData(t),a=e.getNextBlessModel(this.blessType,t.grade,t.level),i=n||a;if(this.addPoint(),this.updateAvatarAnim(),this.mountName.text=t.grade+"级",this.activeLabel.text="",0==t.level&&0==t.grade){this.btn_upgrade.visible=!1,this.getGrp.visible=!1,this.freeachive_grp.visible=!0;var o=JsonModelManager.instance.getModelfunctionLv()[this.func_Type];return FunDefine.isFunOpen(this.func_Type)?this.btnActive.enabled=!0:(this.activeLabel.text=Language.instance.parseInsertText("bless_open_des","coatard_level"+o.jingjie),this.btnActive.enabled=!1),this.jiantou.visible=!1,void(this.consumItem.visible=!1)}if(this.btn_upgrade.visible=!0,this.freeachive_grp.visible=!1,this.jiantou.visible=!0,this.consumItem.visible=!0,!i)return void GameCommon.getInstance().addAlert("已达到最高级别！");if(this.cost=GameCommon.parseAwardItem(i.itemCost),this.consumeTP>0){var r=i.itemCost.split("#");this.cost=GameCommon.parseAwardItem(r[this.consumeTP])}if(this.isLoaded){var s,h=i.attrAry;this.curPro.removeChildren(),this.nextPro.removeChildren(),this.centerPro.removeChildren();var l=a?a.attrAry:i.attrAry,g=0;if(a){for(;g<GameDefine.ATTR_OBJ_KEYS.length;g++)l[g]>0&&(s=new AttributesText,s.updateAttr(g,h[g]),this.curPro.addChild(s),s=new AttributesText,s.updateAttr(g,l[g]),this.nextPro.addChild(s));this.getGrp.visible=!0,this.nextImg.visible=!0,this.curImg.visible=!0,this.jiantou.visible=!0,"zhuanpan"==this.currentState?(this.btn_upgrade.label="升 级",this.getGrp.visible=!0):this.btn_upgrade.label="一键升级",this.consumItem.visible=!0,this.consumItem.setCostByAwardItem(this.cost)}else{for(;g<GameDefine.ATTR_OBJ_KEYS.length;g++)i.attrAry[g]>0&&(s=new AttributesText,s.updateAttr(g,i.attrAry[g]),this.centerPro.addChild(s));this.getGrp.visible=!1,this.btn_upgrade.label="已满级",this.jiantou.visible=!1,this.consumItem.visible=!1,this.nextImg.visible=!1,this.curImg.visible=!1}this.powerbar.power=DataManager.getInstance().playerManager.player.getPlayerData(0).getBlessFightingByType(this.blessType),this.updateHuanHua(),this.updateTaoZhuang()}},t.prototype.addPoint=function(){this.points[0].register(this.topBtn1,new egret.Point(50,10),this,"checkPointTab0",this.blessType),this.points[1].register(this.topBtn2,new egret.Point(50,10),DataManager.getInstance().playerManager,"checkFashionPointByType",this.blessType),this.points[2].register(this.topBtn3,new egret.Point(50,10),DataManager.getInstance().playerManager,"chechFashionTaoZhuang",this.blessType),this.points[3].register(this.topBtn4,new egret.Point(50,10),this,"checkPointSkill"),this.points[4].register(this.btnDan,new egret.Point(60,10),this,"checkPointDan"),this.points[5].register(this.strengthenMasterBtn,new egret.Point(70,10),DataManager.getInstance().strongerManager,"getPoint",this.blessType),this.points[6].register(this.topBtn5,new egret.Point(50,10),DataManager.getInstance().playerManager,"checkMagicEquipPoint",this.blessType),this.checkPointLogic()},t.prototype.checkPointLogic=function(){switch(DataManager.getInstance().blessManager.btnType){case 0:this.blessType==BLESS_TYPE.WEAPON?this.points[6].register(this.btn_upgrade,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkBlessUPCostMoney",this.blessType,this.consumeTP):this.points[6].register(this.btn_upgrade,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkBlessUPCostMoney",this.blessType);break;case 1:this.points[6].register(this.huanhua_jihuo_btn,new egret.Point(150,-5),this,"checkPointHuanHuaCurr",0),this.points[7].register(this.fashionLvUpBtn,new egret.Point(150,-5),this,"checkPointHuanHuaCurr",1);break;case 2:this.points[6].register(this.btnSendUpTaoZhuang,new egret.Point(150,-5),this,"checkPointTaoZhuangCurr")}},t.prototype.checkPointTaoZhuangCurr=function(){var e=this._tsModels[this.currIdx];return e&&DataManager.getInstance().playerManager.chechFashionTaoZhuangOne(e)?!0:!1},t.prototype.checkPointHuanHuaCurr=function(e){var t=this.models[this.currIdx];if(t&&DataManager.getInstance().playerManager.checkFashionPointByID(t.id)){var n=this.getPlayerData().fashionDatas[t.id];return n&&0!=n.limitTime?1==e:0==e}return!1},t.prototype.checkPointTab0=function(){return DataManager.getInstance().playerManager.checkBlessUPCostMoney(this.blessType)?!0:this.checkPointDan()?!0:DataManager.getInstance().strongerManager.getPoint(this.blessType)?!0:!1},t.prototype.checkPointDan=function(){return this.checkPoint5()||this.checkPoint4()||this.checkPointJueXing()},t.prototype.checkPointJueXing=function(){return this.manager.checkJueXingPoint(this.blessType)?!0:!1},t.prototype.checkPoint5=function(){return this.manager.checkLingDanPoint(this.blessType,1)?!0:!1},t.prototype.checkPoint4=function(){return this.manager.checkLingDanPoint(this.blessType,0)?!0:!1},t.prototype.checkPointSkill=function(){return this.manager.checkMountSkill(this.blessType)?!0:!1},t.prototype.updateAvatarAnim=function(){var e="",t=DataManager.getInstance().blessManager,n=t.getPlayerBlessData(this.blessType),a=t.getBlessModelByData(n);for(a=a?a:t.getBlessModel(this.blessType,1,1);this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}this.avatar_grp.touchEnabled=!1,this.avatar_grp.touchChildren=!1;var o=0;if(1==DataManager.getInstance().blessManager.btnType){var r=this.models[this.currIdx];if(!r)return;o=r.waixing1}else{var s=DataManager.getInstance().playerManager.player.getPlayerData().fashionWearIds[this.blessType],h=JsonModelManager.instance.getModelfashion()[s];h&&(o=h.waixing1)}switch(this.blessType){case BLESS_TYPE.HORSE:e="zuoqi_"+o;var l=new Animation(e);l.y=0,this.avatar_grp.addChild(l);break;case BLESS_TYPE.WEAPON:e="jian"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g);break;case BLESS_TYPE.CLOTHES:var c=this.getPlayerData().sex==SEX_TYPE.MALE?"nan":"nv";e="shenzhuang_"+c+"_"+o;var g=new Animation(e,-1);g.y=140,this.avatar_grp.addChild(g);break;case BLESS_TYPE.MAGIC:var g=new Animation("sc_magic"+o,-1);this.avatar_grp.addChild(g),g.y=20,g.scaleX=g.scaleY=1.5;break;case BLESS_TYPE.WING:var g=new Animation("wing"+o+"_ui",-1);g.y=110,this.avatar_grp.addChild(g)}},t.prototype.onupdateStatus=function(){var e=this.models[this.currIdx],t=this.getPlayerData().fashionDatas[e.id];GameCommon.getInstance().getThingModel(e.cost.type,e.cost.id);t&&0!=t.limitTime?(this.fashionLvUpBtn.visible=!0,this.btnHuanhua.visible=!0,this.huanhua_jihuo_btn.visible=!1,t.isWear?(this.btnHuanhua.label=Language.instance.getText("cloth_out"),this.btnHuanhua.name=FASHION_STATUS.OUT+""):(this.btnHuanhua.label=Language.instance.getText("cloth"),this.btnHuanhua.name=FASHION_STATUS.CLOTH+"")):(this.fashionLvUpBtn.visible=!1,this.btnHuanhua.visible=!1,this.huanhua_jihuo_btn.visible=!0),this.consumItem.setCostByAwardItem(e.cost),this.isWearingImg||(this.isWearingImg=new eui.Image("huanhuazhong_png"),this.isWearingImg.x=-25),this.isWearingImg.parent&&this.isWearingImg.parent.removeChild(this.isWearingImg);for(var n=0;n<this.items.length;n++){var a=this.items[n],i=this.models[n],o=this.getPlayerData().fashionDatas[i.id];if(o.isWear){a.parent.addChild(this.isWearingImg);break}}},t.prototype.onSendTaoZhuangUp=function(){if(!this.isActTaoZhuang)return void GameCommon.getInstance().addAlert("皮肤未收集齐,无法激活");var e=this._tsModels[this.currIdx],t=this.getPlayerData().taozhuangDict[e.id];if(0==t){var n=new Message(MESSAGE_ID.FASHIONSETL_ACT_MESSAGE);n.setByte(0),n.setShort(e.id),GameCommon.getInstance().sendMsgToServer(n)}else{if(!GameCommon.getInstance().onCheckItemConsume(e.cost.id,e.cost.num))return;var n=new Message(MESSAGE_ID.FASHIONSETL_UPLV_MESSAGE);n.setByte(0),n.setShort(e.id),GameCommon.getInstance().sendMsgToServer(n)}},t.prototype.onHuanHuaLvUp=function(){var e=this.models[this.currIdx];if(GameCommon.getInstance().onCheckItemConsume(e.cost.id,e.cost.num)){var t=new Message(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE);t.setByte(0),t.setByte(e.id),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onHuahuaActive=function(){var e=this.models[this.currIdx];if(GameCommon.getInstance().onCheckItemConsume(e.cost.id,e.cost.num)){var t=new Message(MESSAGE_ID.FASHION_ACTIVE_MESSAGE);t.setByte(0),t.setByte(this.blessType),t.setByte(e.id),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onSendHuanHua=function(e){var t,n=this.models[this.currIdx],a=parseInt(e.currentTarget.name);switch(a){case FASHION_STATUS.CLOTH:t=new Message(MESSAGE_ID.FASHION_SHOW_MESSAGE),t.setByte(0),t.setByte(this.blessType),t.setByte(n.id);break;case FASHION_STATUS.OUT:t=new Message(MESSAGE_ID.FASHION_SHOW_MESSAGE),t.setByte(0),t.setByte(this.blessType),t.setByte(0)}GameCommon.getInstance().sendMsgToServer(t)},t.prototype.onUpgrade=function(e){this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&(this.blessType==BLESS_TYPE.MAGIC?DataManager.getInstance().blessManager.onSendBlessUpMsg(this.blessType,!1,this.consumeTP):DataManager.getInstance().blessManager.onSendBlessUpMsg(this.blessType,!0,this.consumeTP))},t.prototype.onUpdate=function(e,t,n){if(void 0===n&&(n=0),this.blessType=e,this.func_Type=t,this.consumeTP=n,this.isLoaded){if(this.groupLayer.visible=!1,this.fashion_item_grp.removeChildren(),this.avatar_grp.touchEnabled=!1,this.avatar_grp.touchChildren=!1,this.freeachive_grp.visible=!1,1==DataManager.getInstance().blessManager.btnType){if(!FunDefine.isFunOpen(this.func_Type))return DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh();var a=DataManager.getInstance().blessManager,i=a.getPlayerBlessData(this.blessType);return!i||0==i.grade&&0==i.level?(DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh()):(this.onChangeBtn(),this.onHuanHuaInfo(),void this.addPoint())}if(2==DataManager.getInstance().blessManager.btnType){if(!FunDefine.isFunOpen(this.func_Type))return DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh();var a=DataManager.getInstance().blessManager,i=a.getPlayerBlessData(this.blessType);return!i||0==i.grade&&0==i.level?(DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh()):(this.onChangeBtn(),this.currentState="taozhuang1",this.onTaoZhuangInfo(),this.updateTaoZhuang(),void this.addPoint())}if(3==DataManager.getInstance().blessManager.btnType){if(!FunDefine.isFunOpen(this.func_Type))return DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh();var a=DataManager.getInstance().blessManager,i=a.getPlayerBlessData(this.blessType);return!i||0==i.grade&&0==i.level?(DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh()):(this.currentState="skill",this.groupLayer.visible=!0,this.onChangeBtn(),this.refreshSkill(),void this.addPoint())}if(4==DataManager.getInstance().blessManager.btnType){if(!FunDefine.isFunOpen(this.func_Type))return DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh();var a=DataManager.getInstance().blessManager,i=a.getPlayerBlessData(this.blessType);return!i||0==i.grade&&0==i.level?(DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),void this.refresh()):(this.currentState="equip",this.groupLayer.visible=!0,this.onChangeBtn(),this.refreshEquip(),void this.updateAvatarAnim())}switch(this.groupLayer.removeChildren(),this.blessType){case 2:this.currentState="shenzhuang";break;case 3:this.currentState="zhuanpan";break;default:this.currentState="normal"}this.refresh()}},t.prototype.onChangeBtn=function(){for(var e=1;6>e;e++)DataManager.getInstance().blessManager.btnType+1==e?this["topBtn"+e].iconFrame.visible=!0:this["topBtn"+e].iconFrame.visible=!1},t.prototype.onTaoZhuangInfo=function(){this.models=[],this.items=[],this._tsModels=[];var e=JsonModelManager.instance.getModelmounttaozhuang()[this.blessType],t=JsonModelManager.instance.getModelfashion(),n=[];for(var a in e){var i=e[a];n.push(i)}this._tsModels=n,this.pointItems=[];for(var o=0;o<n.length;o++){var r;n[o].fashionId.indexOf(",")>=0&&(r=n[o].fashionId.split(","));var s=t[r[0]],h=(this.getPlayerData().fashionDatas[s.id],GameCommon.getInstance().getThingModel(s.cost.type,s.cost.id)),l=new eui.Component;l.name=o+"",l.skinName=skins.GoodsInstanceSkin,l.item_frame.source="slotFrame_png",l.item_icon.source=h.icon,l.name_label.textColor=GameCommon.getInstance().CreateNameColer(h.quality);var g=this.getPlayerData().taozhuangDict[n[o].id];l.num_label.text="Lv."+g,l.name_label.text=n[o].name;var c=new eui.Group;c.width=90,c.addChild(l),l.y=40,this.fashion_item_grp.addChild(c),this.items.push(l),l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this);var p=n[o];this.pointItems[o]=new redPoint,this.pointItems[o].register(l,new egret.Point(65,0),DataManager.getInstance().playerManager,"chechFashionTaoZhuangOne",p)}if(this.scroll.viewport.scrollH=0,-1==this.currIdx?this.onSelectItem(0):this.onSelectItem(this.currIdx),this.activeLabel.text="",!FunDefine.isFunOpen(this.func_Type)){var u=JsonModelManager.instance.getModelfunctionLv()[this.func_Type];this.activeLabel.text=Language.instance.parseInsertText("bless_open_des","coatard_level"+u.jingjie),this.btnActive.enabled=!1}},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(this.cost.id,this.cost.type)},t.prototype.onHuanHuaInfo=function(){this.models=[],this.items=[];var e=JsonModelManager.instance.getModelfashion(),t=[],n=[],a=[];for(var i in e){var o=e[i],r=this.getPlayerData().fashionDatas[o.id];if(o.type==this.blessType)if(r)t.push(o);else{var s=DataManager.getInstance().bagManager.getGoodsThingById(o.cost.id,o.cost.type);s&&s.num>=o.cost.num?n.push(o):a.push(o)}}for(var h=0;h<t.length;h++)this.models.push(t[h]);for(var h=0;h<n.length;h++)this.models.push(n[h]);for(var h=0;h<a.length;h++)this.models.push(a[h]);this.pointItems=[];for(var h=0;h<this.models.length;h++){var o=this.models[h],r=this.getPlayerData().fashionDatas[o.id],l=GameCommon.getInstance().getThingModel(o.cost.type,o.cost.id),g=new eui.Component;g.name=h+"",g.skinName=skins.GoodsInstanceSkin,g.item_frame.source="slotFrame_png",g.item_icon.source=l.icon,g.name_label.textColor=GameCommon.getInstance().CreateNameColer(l.quality),g.num_label.text=r?"Lv."+r.level:o.name,g.name_label.text=o.name;var c=new eui.Group;c.width=90,c.addChild(g),g.y=40,this.fashion_item_grp.addChild(c),this.items.push(g),g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.pointItems[h]=new redPoint,this.pointItems[h].register(g,new egret.Point(65,0),DataManager.getInstance().playerManager,"checkFashionPointByID",o.id)}if(this.scroll.viewport.scrollH=0,-1==this.currIdx?this.onSelectItem(0):this.onSelectItem(this.currIdx),this.activeLabel.text="",!FunDefine.isFunOpen(this.func_Type)){var p=JsonModelManager.instance.getModelfunctionLv()[this.func_Type];this.activeLabel.text=Language.instance.parseInsertText("bless_open_des","coatard_level"+p.jingjie),this.btnActive.enabled=!1}},t.prototype.updateHuanHua=function(){if(1==DataManager.getInstance().blessManager.btnType){var e=this.models[this.currIdx];if(e){var t=this.getPlayerData().fashionDatas[e.id];t&&0!=t.limitTime?this.getGrp.visible=!1:this.getGrp.visible=!0}}},t.prototype.updateTaoZhuang=function(){if(2==DataManager.getInstance().blessManager.btnType){this.btnSendUpTaoZhuang.enabled=!0;var e=(-1==this.currIdx?0:this.currIdx,this._tsModels[this.currIdx]);this.getPlayerData().taozhuangDict[e.id];this.consumItem.visible=!1}},t.prototype.onSelectItem=function(e){if(2==DataManager.getInstance().blessManager.btnType){this.isActTaoZhuang=!0,this.currIdx=e;var t;this._tsModels[this.currIdx]||(this.currIdx=0,this.onSelectItem(this.currIdx));var n=this._tsModels[this.currIdx];n.fashionId.indexOf(",")>=0&&(t=n.fashionId.split(",")),this.currentState="taozhuang"+(t.length-1);for(var a=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(a),o=0;o<t.length;o++){var r=this["equip_slot"+o];r.touchEnabled=!0;var s=JsonModelManager.instance.getModelfashion()[t[o]],h=this.getPlayerData().fashionDatas[s.id];h&&0!=h.level?(r.onUpdate(s.cost.type,s.cost.id),r.filters=[]):(r.onUpdate(s.cost.type,s.cost.id,1),r.filters=[i],this.isActTaoZhuang=!1),r.name_label.text=s.name+"\n"+s.goDesc}var l=this.items[this.currIdx];this.selectAnim||(this.selectAnim=new Animation("zhuangbeixuanzhong",-1),this.selectAnim.scaleX=.7,this.selectAnim.scaleY=.7),this.selectAnim.parent&&this.selectAnim.parent.removeChild(this.selectAnim),l.orangeLayer.addChild(this.selectAnim);var g=1;this.mountName.text=n.name;var c;this.curPro.removeChildren(),this.nextPro.removeChildren(),this.centerPro.removeChildren(),this.nextImg.visible=!0,this.curImg.visible=!0;for(var p=(g>=parseInt(Constant.get(Constant.TAOZHUANG_MAX)),0),u=0;u<n.attrAry.length;++u)n.attrAry[u]>0&&(p+=1,p%2==0?(c=new AttributesText,c.updateAttr(u,n.attrAry[u]*g),this.nextPro.addChild(c)):(c=new AttributesText,c.updateAttr(u,n.attrAry[u]*g),this.curPro.addChild(c)));for(var d=10;d<2*n.attrAry.length;d++)n[GameDefine.getAttrPlusKey(d)]>0&&(p+=1,p%2==0?(c=new AttributesText,c.updateAttr("角色总"+GameDefine.Attr_FontName[d%ATTR_TYPE.SIZE],n[GameDefine.getAttrPlusKey(d)]/100+"%"),this.nextPro.addChild(c)):(c=new AttributesText,c.updateAttr("角色总"+GameDefine.Attr_FontName[d%ATTR_TYPE.SIZE],n[GameDefine.getAttrPlusKey(d)]/100+"%"),this.curPro.addChild(c)));this.powerbar.power=DataManager.getInstance().playerManager.player.getPlayerData(0).getBlessFightingByType(this.blessType),this.cost=n.cost,this.consumItem.visible=!1,0==this.getPlayerData().taozhuangDict[n.id]?(this.consumItem.setCostByAwardItem(this.cost),this.btnSendUpTaoZhuang.visible=!0,this.btnSendUpTaoZhuang.label="激 活",this.consumItem.visible=!1,this.getGrp.visible=!1):(this.consumItem.visible=!1,this.btnSendUpTaoZhuang.visible=!1)}else{this.consumItem.visible=!0,this.currIdx=e;var s=this.models[this.currIdx];s||(this.currIdx=0,this.onSelectItem(this.currIdx));var h=this.getPlayerData().fashionDatas[s.id];this.skillDesc.text=h.skillInfo.model.disc;var l=this.items[this.currIdx];this.selectAnim||(this.selectAnim=new Animation("zhuangbeixuanzhong",-1),this.selectAnim.scaleX=.7,this.selectAnim.scaleY=.7),this.selectAnim.parent&&this.selectAnim.parent.removeChild(this.selectAnim),l.orangeLayer.addChild(this.selectAnim),this.updateAvatarAnim(),this.onTimeDown();var c,_=GameCommon.getInstance().getAttributeAry(),m=h?h.level:1;this.curPro.removeChildren(),this.nextPro.removeChildren(),this.centerPro.removeChildren(),this.nextImg.visible=!0,this.curImg.visible=!0;for(var E=0;E<s.attrAry.length;++E)s.attrAry[E]>0&&(c=new AttributesText,c.updateAttr(E,s.attrAry[E]*m),this.curPro.addChild(c),c=new AttributesText,c.updateAttr(E,s.attrAry[E]*(m+1)),this.nextPro.addChild(c),_[E]=s.attrAry[E]*m);this.mountName.text=m+"阶",this.powerbar.power=GameCommon.calculationFighting(_),this.cost=s.cost;GameCommon.getInstance().getThingModel(s.cost.type,s.cost.id);this.consumItem.setCostByAwardItem(s.cost),this.onupdateStatus()}this.checkPointLogic()},t.prototype.onTimeDown=function(){},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currIdx!=t&&this.onSelectItem(t)},t.prototype.onBtnActive=function(e){FunDefine.isFunOpen(this.func_Type)?DataManager.getInstance().blessManager.onSendBlessUpMsg(this.blessType,!1,this.consumeTP,2):GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(4))},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.openStrongerMonsterPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",this.blessType))},t.prototype.showDanPanel=function(e){this.isOpenBless()&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("Magic3DanPanel",this.blessType))},t.prototype.showSkillPanel=function(e){return this.isOpenBless()?this.getPlayerData().fashionSkils[this.blessType]?void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("MagicSkillFashionPanel",this.blessType)):void GameCommon.getInstance().addAlert("幻化技能尚未解锁"):void 0},t.prototype.isOpenBless=function(){if(!FunDefine.isFunOpen(this.func_Type))return DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),this.refresh(),!1;this.groupLayer.visible=!1,this.groupLayer.removeChildren();var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.blessType);return!t||0==t.grade&&0==t.level?(DataManager.getInstance().blessManager.btnType=0,GameCommon.getInstance().addAlert("请先进行激活"),this.refresh(),!1):!0},t.prototype.topPanel=function(e){var t=Number(e.target.name);if(DataManager.getInstance().blessManager.btnType!=t)switch(this.groupLayer.visible=!1,t){case 0:switch(this.groupLayer.removeChildren(),DataManager.getInstance().blessManager.btnType=0,this.blessType){case 2:this.currentState="shenzhuang";break;case 3:this.currentState="zhuanpan";break;default:this.currentState="normal"}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAGIC_HUANHUA));break;case 1:this.isOpenBless()&&(this.currentState="huanhua",DataManager.getInstance().blessManager.btnType=1,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAGIC_HUANHUA)));break;case 2:this.isOpenBless()&&(this.currentState="taozhuang1",DataManager.getInstance().blessManager.btnType=2,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAGIC_HUANHUA)));break;case 3:this.isOpenBless()&&(this.groupLayer.visible=!0,this.currentState="skill",DataManager.getInstance().blessManager.btnType=3,this.refreshSkill(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAGIC_HUANHUA)));break;case 4:this.isOpenBless()&&(this.groupLayer.visible=!0,this.currentState="equip",DataManager.getInstance().blessManager.btnType=4,this.refreshEquip(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MAGIC_HUANHUA)))}},t.prototype.refreshSkill=function(){this.layerSkill?(this.layerSkill.parent||this.groupLayer.addChild(this.layerSkill),this.layerSkill.onRefresh()):(this.layerSkill=new MagicSkillPanel(this.blessType),this.groupLayer.addChild(this.layerSkill)),this.layerEquip&&this.layerEquip.parent&&this.groupLayer.removeChild(this.layerEquip),this.groupLayer.visible=!0},t.prototype.refreshEquip=function(){this.layerEquip?(this.layerEquip.parent||this.groupLayer.addChild(this.layerEquip),this.layerEquip.onRefresh()):(this.layerEquip=new MagicEquipPanel(this.blessType),this.groupLayer.addChild(this.layerEquip)),this.layerSkill&&this.layerSkill.parent&&this.groupLayer.removeChild(this.layerSkill),this.groupLayer.visible=!0},t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.cost&&this.consumItem.setCostByAwardItem(this.cost)},t}(eui.Component);__reflect(MagicBasicPanel.prototype,"MagicBasicPanel");var MagicEquipPanel=function(e){function t(t){var n=e.call(this)||this;return n.blessType=0,n.points=RedPointManager.createPoint(8),n.isLoaded=!1,n.indexId=0,n._clothbtnStamp=0,n.currEquipSlot=0,n.blessType=t,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddStage,n),n}return __extends(t,e),t.prototype.onAddStage=function(){this.skinName=skins.MagicEquipSkin},t.prototype.onLoadComplete=function(){this.isLoaded=!0,DataManager.IS_PC_Game||(this.width=size.width),this.isLoaded&&(this.onInit(),this.onRegist(),this.onRefresh())},t.prototype.onInit=function(){},t.prototype.onRegist=function(){for(var e=0;e<BlessDefine.BLESS_SLOT_MAXNUM;e++)this.points[e].register(this["equip_bar_"+e],new egret.Point(75,-5),DataManager.getInstance().playerManager,"checkMountEquipRedPoint",this.blessType,e);this.btn_equip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothAllEquip,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_EQUIP_MESSAGE.toString(),this.onReciveEquipsMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_EQUIP_SLOT_MESSAGE.toString(),this.onReciveSlotMsg,this)},t.prototype.onRemove=function(){this.btn_equip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClothAllEquip,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_EQUIP_MESSAGE.toString(),this.onReciveEquipsMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_EQUIP_SLOT_MESSAGE.toString(),this.onReciveSlotMsg,this)},t.prototype.trigger=function(){for(var e=0;e<this.points.length;e++)this.points[e].checkPointAll()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.onRefresh=function(){this.isLoaded&&this.onEquipInfo()},t.prototype.onEquipInfo=function(){this.onRefreshEquipSlots(),this.onRefreshEquips()},t.prototype.onRefreshEquips=function(){for(var e=0;e<BlessDefine.BLESS_SLOT_MAXNUM;e++){var t=this["equip_bar_"+e],n=this.getPlayerData().getBlessEquip(this.blessType,e);n?t.onThing(n):(t.onReset(),t.name_label.text=Language.instance.getText("bless"+(this.blessType+1)+"_slot"+e+"_name"),t.item_icon.source="magic_slot"+e+"_png")}},t.prototype.onReciveEquipsMsg=function(){this.onRefreshEquips(),this.trigger()},t.prototype.onReciveSlotMsg=function(e){e.message;this.onRefreshEquipSlots()},t.prototype.onClothAllEquip=function(){if(!(this._clothbtnStamp>egret.getTimer())){this._clothbtnStamp=egret.getTimer()+2e3;var e=new Message(MESSAGE_ID.BLESS_EQUIP_MESSAGE);e.setByte(0),e.setByte(this.blessType),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onRefreshEquipSlots=function(){for(var e=GameCommon.getInstance().getAttributeAry(),t=this.getPlayerData().blessEquipDict[this.blessType],n=0;n<t.length;++n){var a=t[n];if(a)for(var i=JsonModelManager.instance.getModelmountEquipment()[a.modelId],o=0;o<ATTR_TYPE.SIZE;++o)i.attrAry[o]>0&&(e[o]+=i.attrAry[o])}var r,s=0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var h in e)e[h]>0&&(s+=1,s%2!=0?(r=new AttributesText,r.updateAttr(h,e[h]),r.scaleX=.8,r.scaleY=.8,this.curPro.addChild(r)):(r=new AttributesText,r.scaleX=.8,r.scaleY=.8,r.updateAttr(h,e[h]),this.nextPro.addChild(r)))},t.prototype.onChangeEquipSlot=function(e){var t=parseInt(e.currentTarget.name);this.currEquipSlot!=t&&t<BlessDefine.BLESS_SLOT_MAXNUM&&(this.currEquipSlot=t,this.onRefreshEquipSlots())},t.prototype.requestStrongSlotMsg=function(){if(!this.qhCost||GameCommon.getInstance().onCheckItemConsume(this.qhCost.id,this.qhCost.num,this.qhCost.type)){var e=new Message(MESSAGE_ID.BLESS_EQUIP_SLOT_MESSAGE);e.setByte(0),e.setByte(this.blessType),e.setByte(this.currEquipSlot),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(eui.Component);__reflect(MagicEquipPanel.prototype,"MagicEquipPanel");var MagicGodWeaponPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(3),n.index=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicGodWeaponPanelSkin},t.prototype.onInit=function(){this.index=0,this.selectAnim=new Animation("shenbing_UIeffect"),this.efftecsGrp=[];for(var t=0;3>t;++t)this.efftecsGrp[t]=this["groupEff"+t],this.points[t].register(this.efftecsGrp[t],GameDefine.RED_FASHION_ITEM_POS,DataManager.getInstance().playerManager,"checkBlessUPCostMoney",BLESS_TYPE.WEAPON,t),this.index==t&&(this.selectAnim.x=this.efftecsGrp[t].width/2,this.selectAnim.y=this.efftecsGrp[t].height/2,this.efftecsGrp[t].addChild(this.selectAnim));e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){switch(this.owner.tab){case BLESS_TAB_TYPE.LINGSHOU:return FUN_TYPE.FUN_MOUNT;case BLESS_TAB_TYPE.SHENZHUANG:return FUN_TYPE.FUN_SHENZHUANG;case BLESS_TAB_TYPE.SHENGBING:return FUN_TYPE.FUN_SHENBING;case BLESS_TAB_TYPE.XIANYU:return FUN_TYPE.FUN_XIANYU;case BLESS_TAB_TYPE.GUANGHUAN:return FUN_TYPE.FUN_FABAO}return 0},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.onRefreshUpGrade(),this.weaponGroup.touchEnabled=!1,0==DataManager.getInstance().blessManager.btnType?(this.progress.visible=!0,this.weaponGroup.visible=!0,this.textNameGroup.visible=!0):(this.progress.visible=!1,this.weaponGroup.visible=!1,this.textNameGroup.visible=!1)
},t.prototype.onRefreshUpGrade=function(){for(var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.owner.tab),n=e.getBlessModelByData(t),a=(e.getNextBlessModel(this.owner.tab,t.grade,t.level),0);a<n.costList.length;++a){this["star"+a];this["lab"+a].text=GameCommon.getInstance().getThingModel(n.costList[a].type,n.costList[a].id).name,this["icon"+a].source=GameCommon.getInstance().getThingModel(n.costList[a].type,n.costList[a].id).icon}this.progress.maximum=n.exp,this.progress.value=t.exp,this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType,this.index)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this);for(var e=0;3>e;e++)this["star"+e].name=e,this["star"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this);for(var e=0;3>e;e++)this["star"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this);GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onTab=function(e){var t=Number(e.target.name);if(this.index!=t){this.index=t;for(var n=0;3>n;n++)this["star"+n].source=this.index==n?"baoqiIcondi_png":"baoqiIcondi1_png",this.index==n&&(this.selectAnim.x=this.efftecsGrp[n].width/2,this.selectAnim.y=this.efftecsGrp[n].height/2,this.efftecsGrp[n].addChild(this.selectAnim));this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType,this.index)}},t.prototype.onUpgrade=function(e){this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&DataManager.getInstance().blessManager.onSendBlessUpMsg(this.owner.tab,!1)},t.prototype.upHandler=function(e){this.onRefreshUpGrade()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.basicPanel.updateGoodsADD()},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.basicPanel&&this.basicPanel.trigger()},t}(BaseTabView);__reflect(MagicGodWeaponPanel.prototype,"MagicGodWeaponPanel");var MagicGodZhuangPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n.index=0,n.isPlay=!1,n.playedNum=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicGodZhuangPanelSkin},t.prototype.onInit=function(){this.animRecords=[];for(var t,n,a=0;a<GameDefine.Equip_Slot_Num;a++)n=this.basicPanel["star"+a],n.slotType=a,t=new MagicPosInfo(n.x,n.y,n.scaleX,n.parent.getChildIndex(n)),this.animRecords.push(t);var i=DataManager.getInstance().blessManager;this._BlessData=i.getPlayerBlessData(this.owner.tab),e.prototype.onInit.call(this),this.resetPos(),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){switch(this.owner.tab){case BLESS_TAB_TYPE.LINGSHOU:return FUN_TYPE.FUN_MOUNT;case BLESS_TAB_TYPE.SHENZHUANG:return FUN_TYPE.FUN_SHENZHUANG;case BLESS_TAB_TYPE.SHENGBING:return FUN_TYPE.FUN_SHENBING;case BLESS_TAB_TYPE.XIANYU:return FUN_TYPE.FUN_XIANYU;case BLESS_TAB_TYPE.GUANGHUAN:return FUN_TYPE.FUN_FABAO}return 0},enumerable:!0,configurable:!0}),t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onRefresh=function(){this.onRefreshUpGrade()},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.basicPanel&&this.basicPanel.trigger()},t.prototype.onAnimPlayEnd=function(){this.okAnim&&(this.okAnim.visible=!1)},t.prototype.resetPos=function(){for(var e,t,n=this._BlessData.level,a=GameDefine.Equip_Slot_Num+n,i=n;a>i;i++)t=this.basicPanel["star"+(i>=GameDefine.Equip_Slot_Num?i-GameDefine.Equip_Slot_Num:i)],t.currCircleIndex=i-n,e=this.animRecords[t.currCircleIndex],t.x=e.posX,t.y=e.posY,t.scaleX=e.scale,t.scaleY=e.scale,t.parent.setChildIndex(t,e.childNum),i==n?t.selected=!0:t.selected=!1},t.prototype.play=function(){this.isPlay=!0;var e,t,n=(this._BlessData.level,this.getNowIntensifyEquip()),a=1,i=GameDefine.Equip_Slot_Num+n;this.playedNum=0;for(var o=n;i>o;o++)t=this.basicPanel["star"+(o>=GameDefine.Equip_Slot_Num?o-GameDefine.Equip_Slot_Num:o)],t.currCircleIndex=o-n-a>=0?o-n-a:GameDefine.Equip_Slot_Num-a-(o-n),e=this.animRecords[t.currCircleIndex],t.selected=!1,egret.Tween.get(t).to({},100).to({x:e.posX,y:e.posY,scaleX:e.scale,scaleY:e.scale},150,egret.Ease.sineIn).call(this.playDone,this),t.parent.setChildIndex(t,e.childNum)},t.prototype.playDone=function(){if(this.playedNum+=1,this.playedNum==GameDefine.Equip_Slot_Num){var e=this.getNowIntensifyEquip();if(e==this._BlessData.level){this.isPlay=!1,this.data=this.getPlayerData().getEquipSlotThings(this._BlessData.level);for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this.basicPanel["star"+t];if(0==n.currCircleIndex){n.selected=!0;break}}this.basicPanel.avatar_grp.parent.setChildIndex(this.basicPanel.avatar_grp,9)}else this.play()}},t.prototype.getNowIntensifyEquip=function(){for(var e,t=0,n=0;n<GameDefine.Equip_Slot_Num;n++)if(e=this.basicPanel["star"+n],0==e.currCircleIndex){t=n;break}return t},t.prototype.upHandler=function(e){var t=this._BlessData.level-1;-1==t&&(t=GameDefine.Equip_Slot_Num-1);var n=this.getNowIntensifyEquip();n!=this._BlessData.level&&(this.okAnim?(this.okAnim.visible=!0,this.okAnim.playNum=1):(this.okAnim=new Animation("zhuangbeiqianghua",1,!1),this.okAnim.x=308,this.okAnim.y=415,this.animLayer.addChild(this.okAnim)),this.okAnim.playFinishCallBack(this.onAnimPlayEnd,this),this.isPlay||this.play()),this.onRefreshUpGrade()},t.prototype.onRefreshUpGrade=function(){this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType),this.basicPanel.powerbar.power=DataManager.getInstance().playerManager.player.getPlayerData(0).getBlessFightingByType(this.owner.tab)},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.basicPanel.updateGoodsADD()},t}(BaseTabView);__reflect(MagicGodZhuangPanel.prototype,"MagicGodZhuangPanel");var MagicSlot=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"slotType",{set:function(e){this._slottype!=e&&(this._slottype=e,this.slot_icon_img.source="public_slot_"+GoodsDefine.EQUIP_SLOT_TYPE[this._slottype]+"_png")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labName",{set:function(e){this.slotName.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{set:function(e){this.selectLayer.visible=e,e?(this.selectedAnim||(this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.scaleX=.85,this.selectedAnim.scaleY=.85,this.selectedAnim.y=-30,this.selectLayer.addChild(this.selectedAnim)),this.selectedAnim.onPlay()):this.selectedAnim&&this.selectedAnim.onStop()},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(MagicSlot.prototype,"MagicSlot");var MagicPosInfo=function(){function e(e,t,n,a){void 0===a&&(a=-1),this.posX=e,this.posY=t,this.scale=n,this.childNum=a}return e}();__reflect(MagicPosInfo.prototype,"MagicPosInfo");var MagicJueXingDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicJueXingDanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.blessType=e;var t=DataManager.getInstance().blessManager.getBlessJueXingItemId(parseInt(e)),n=GameCommon.getInstance().getThingModel(GOODS_TYPE.ITEM,t);this.modelThing=n,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.updateAvatarAnim=function(){var e="",t=DataManager.getInstance().blessManager,n=t.getPlayerBlessData(this.blessType),a=t.getBlessModelByData(n);for(a=a?a:t.getBlessModel(this.blessType,1,1),this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}var o=0,r=DataManager.getInstance().playerManager.player.getPlayerData().fashionWearIds[this.blessType],s=JsonModelManager.instance.getModelfashion()[r];switch(s&&(o=s.waixing1),this.blessType){case BLESS_TYPE.HORSE:e="zuoqi_"+o;var h=new Animation(e);this.avatar_grp.addChild(h),this.avatar_grp.y=200;break;case BLESS_TYPE.CLOTHES:var l=this.getPlayer().getPlayerData(0).sex==SEX_TYPE.MALE?"nan":"nv";e="shenzhuang_"+l+"_"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=320;break;case BLESS_TYPE.WEAPON:e="jian"+o;var g=new Animation(e,-1);this.avatar_grp.y=200,this.avatar_grp.addChild(g);break;case BLESS_TYPE.WING:e=LoadManager.getInstance().getWingResUrl("wing"+o,"ride_stand",Direction.DOWN+"");var c=new BodyAnimation(e,-1,Direction.DOWN);this.avatar_grp.addChild(c),this.avatar_grp.scaleX=.9,this.avatar_grp.scaleY=.9,this.avatar_grp.y=300;break;case BLESS_TYPE.RING:e="guanghuan_jiemian_"+o;var g=new Animation(e,-1);return this.avatar_grp.addChild(g),this.avatar_grp.y=200,this.avatar_grp.scaleX=.9,void(this.avatar_grp.scaleY=.9);case BLESS_TYPE.RETINUE_HORSE:e="sc_mount"+o;var p=new Animation(e);this.avatar_grp.addChild(p),this.avatar_grp.y=240;break;case BLESS_TYPE.RETINUE_CLOTHES:e="sc_role"+o;var u=new Animation(e);this.avatar_grp.addChild(u),this.avatar_grp.y=310;break;case BLESS_TYPE.RETINUE_WEAPON:e="weapon"+o+"_png";var d=new eui.Image;d.source=e,this.avatar_grp.addChild(d),this.avatar_grp.y=-100,this.onStartFloatAnim();break;case BLESS_TYPE.RETINUE_WING:e="sc_wing"+o;var _=new Animation(e);_.x=30,this.avatar_grp.addChild(_),this.avatar_grp.y=340;break;case BLESS_TYPE.MAGIC:e="sc_magic"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=200}this.avatar_grp.scaleX=.8,this.avatar_grp.scaleY=.8},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){this.onShowInfo(),this.updateAvatarAnim()},t.prototype.onShowInfo=function(){this.titleName.text=this.lbName.text=this.modelThing.name;var e=this.getPlayer().getPlayerData().blessWakeLevel[this.blessType];this.lbLevel.text="等级:"+e;var t=DataManager.getInstance().blessManager.getBlessJueXingValue();if(e>0){var n=t[e-1]/1e4+1;this.curPro.text="全属性加成"+n+"倍"}else this.curPro.text="无属性加成";if(e<t.length){var a=t[e]/1e4+1;this.nextPro.text="全属性加成"+a+"倍",this.consumItem.setConsume(this.modelThing.type,this.modelThing.id),this.groupInfo.visible=this.consumItem.visible=this.upBtn.visible=!0}else this.nextPro.text="已升至满级",this.consumItem.visible=this.upBtn.visible=!1},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.modelThing.id,1,GOODS_TYPE.ITEM)){var e=new Message(MESSAGE_ID.BLESS_WAKE_UP_MESSAGE);e.setByte(0),e.setByte(this.blessType),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(MagicJueXingDanPanel.prototype,"MagicJueXingDanPanel");var MagicLingDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n.indexId=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicLingDanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.blessType=e;var t;t=JsonModelManager.instance.getModelmountDan();for(var n in t)t[n].type==this.blessType&&1==t[n].subtype&&(this.models=t[n]);this.indexId=0,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.updateAvatarAnim=function(){var e="",t=DataManager.getInstance().blessManager,n=t.getPlayerBlessData(this.blessType),a=t.getBlessModelByData(n);for(a=a?a:t.getBlessModel(this.blessType,1,1),this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}var o=0,r=DataManager.getInstance().playerManager.player.getPlayerData().fashionWearIds[this.blessType],s=JsonModelManager.instance.getModelfashion()[r];switch(s&&(o=s.waixing1),this.blessType){case BLESS_TYPE.HORSE:e="zuoqi_"+o;var h=new Animation(e);this.avatar_grp.addChild(h),this.avatar_grp.y=200;break;case BLESS_TYPE.CLOTHES:var l=this.getPlayer().getPlayerData(0).sex==SEX_TYPE.MALE?"nan":"nv";e="shenzhuang_"+l+"_"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=320;break;case BLESS_TYPE.WEAPON:e="jian"+o;var g=new Animation(e,-1);this.avatar_grp.y=200,this.avatar_grp.addChild(g);break;case BLESS_TYPE.WING:e=LoadManager.getInstance().getWingResUrl("wing"+o,"ride_stand",Direction.DOWN+"");var c=new BodyAnimation(e,-1,Direction.DOWN);this.avatar_grp.addChild(c),this.avatar_grp.scaleX=.9,this.avatar_grp.scaleY=.9,this.avatar_grp.y=300;break;case BLESS_TYPE.RING:e="guanghuan_jiemian_"+o;var g=new Animation(e,-1);return this.avatar_grp.addChild(g),this.avatar_grp.y=200,this.avatar_grp.scaleX=.9,void(this.avatar_grp.scaleY=.9);case BLESS_TYPE.RETINUE_HORSE:e="sc_mount"+o;var p=new Animation(e);this.avatar_grp.addChild(p),this.avatar_grp.y=240;break;case BLESS_TYPE.RETINUE_CLOTHES:e="sc_role"+o;var u=new Animation(e);this.avatar_grp.addChild(u),this.avatar_grp.y=310;break;case BLESS_TYPE.RETINUE_WEAPON:e="weapon"+o+"_png";var d=new eui.Image;d.source=e,this.avatar_grp.addChild(d),this.avatar_grp.y=-100,this.onStartFloatAnim();break;case BLESS_TYPE.RETINUE_WING:e="sc_wing"+o;var _=new Animation(e);_.x=30,this.avatar_grp.addChild(_),this.avatar_grp.y=340;break;case BLESS_TYPE.MAGIC:e="sc_magic"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=200}this.avatar_grp.scaleX=.8,this.avatar_grp.scaleY=.8},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){this.updateAvatarAnim(),this.onShowInfo(this.indexId)},t.prototype.onShowInfo=function(e){this.titleName.text=this.models.name,this.indexId=e;var t=this.models;this.skillName.text=t.name;var n=DataManager.getInstance().blessManager.getPlayerBlessData(this.blessType),a=n.danDic[1],i=(t.attrAry,""),o="";this.skillLv.text="等级:"+a,a>0?(i=GameDefine.BlessName[this.blessType]+"全属性:"+t.harm*a+"\n",o=GameDefine.BlessName[this.blessType]+"全属性:"+t.harm*(a+1)+"\n"):(i=GameDefine.BlessName[this.blessType]+"全属性:0\n",o=GameDefine.BlessName[this.blessType]+"全属性:"+t.harm+"\n"),this.curPro.text=i,this.nextPro.text=o,this.consumItem.setCostByAwardItem(t.cost)},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.models.cost.id,this.models.cost.num,this.models.cost.type)){var e=new Message(MESSAGE_ID.BLESS_UP_DAN_MESSAGE);e.setByte(0),e.setByte(this.blessType),e.setByte(this.models.subtype),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(MagicLingDanPanel.prototype,"MagicLingDanPanel");var MagicMainViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_MOUNT,n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.basic.bgDi.visible=!1;var t=[],n=new RegisterSystemParam;n.sysName="MagicViewPanel",n.btnRes="飞 剑",n.funcID=FUN_TYPE.FUN_MOUNT,n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkBlessUPMain",BLESS_TYPE.HORSE),t.push(n);var n=new RegisterSystemParam;n.sysName="MagicGodWeaponPanel",n.btnRes="神 兵",n.funcID=FUN_TYPE.FUN_SHENBING,n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkBlessUPMain",BLESS_TYPE.WEAPON),t.push(n);var n=new RegisterSystemParam;n.sysName="MagicGodZhuangPanel",n.btnRes="神 装",n.funcID=FUN_TYPE.FUN_SHENZHUANG,n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkBlessUPMain",BLESS_TYPE.CLOTHES),t.push(n);var n=new RegisterSystemParam;n.sysName="MagicBaoQiPanel",n.btnRes="宝 器",n.funcID=FUN_TYPE.FUN_FABAO,n.redP=this.points[3],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkBlessUPMain",BLESS_TYPE.MAGIC),t.push(n);var n=new RegisterSystemParam;n.sysName="MagicWingPanel",n.btnRes="仙 羽",n.funcID=FUN_TYPE.FUN_XIANYU,n.redP=this.points[4],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkBlessUPMain",BLESS_TYPE.WING),t.push(n),this.params=t,this.registerPage(t,"forgeGrp",GameDefine.RED_TAB_POS);new eui.Image;e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.MAGIC_HUANHUA,this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHIONSETL_ACT_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHIONSETL_UPLV_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.STRONGER_ACT.toString(),this.upHandler,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.MAGIC_HUANHUA,this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHIONSETL_ACT_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHIONSETL_UPLV_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.STRONGER_ACT.toString(),this.upHandler,this)},t.prototype.onRefresh=function(){this.setTitle(this.params[this.index].btnRes),e.prototype.onRefresh.call(this)},t.prototype.upHandler=function(){this.allwindows[this.sysInfos[this.index].sysName]&&this.allwindows[this.sysInfos[this.index].sysName].upHandler()},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t}(BaseSystemPanel);__reflect(MagicMainViewPanel.prototype,"MagicMainViewPanel");var FASHION_STATUS;!function(e){e[e.ACTIVE=0]="ACTIVE",e[e.CLOTH=1]="CLOTH",e[e.OUT=2]="OUT"}(FASHION_STATUS||(FASHION_STATUS={}));var MagicSkillFashionPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicSkillFashionSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("皮肤技能"),this.initAvata()},t.prototype.initAvata=function(){this.roleAvatar=new PlayerBody,this.roleAvatar.isDamageFalse=!0,this.roleAvatar.inMap=!1;var e=GameFight.getInstance().onRandomCrateRobotData(1,2);this.roleAppears=new AppearPlayerData,e.sex=this.playerData.sex,e.setAppear(this.roleAppears),this.roleAvatar.data=e,this.roleAvatar.onHideHeadBar(!1),this.emenyAvatar=new MonsterBody,this.emenyAvatar.data=new MonsterData(FightDefine.PVE_MONSTER_COMID,BODY_TYPE.MONSTER),this.emenyAvatar.visible=!1,this.emenyAvatar.inMap=!1,this.roleAvatar.onAddEnemyBodyList([this.emenyAvatar]),this.roleAvatar.currTarget=this.emenyAvatar},t.prototype.onShowWithParam=function(e){this.blessType=e,this.fashion=this.playerData.fashionSkils[this.blessType],this.onShow()},t.prototype.initAction=function(){this.onShowInfo(),this.updateAvatarAnim()},t.prototype.onShowInfo=function(){this.skillDesc.text=this.fashion.skillInfo.model.disc},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.isAction=!0,this.initAction()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.isAction=!1},t.prototype.updateAvatarAnim=function(){for(var e=0;e<BLESS_TYPE.SIZE;e++)this.roleAppears.appears[e]=this.playerData.getAppearID(e);this.roleAvatar.data.setAppear(this.roleAppears),this.roleAvatar.onUpdateAvatar(),this.avatar_grp.removeChildren(),this.avatar_grp.addChild(this.roleAvatar),this.avatar_grp.addChild(this.emenyAvatar),this.roleAvatar.data.onRebirth(),this.roleAvatar.onResetSkillEffect(),this.roleAvatar.x=0,this.roleAvatar.y=0,this.emenyAvatar.x=this.roleAvatar.x+10,this.emenyAvatar.y=this.roleAvatar.y,this.updateSkill()},t.prototype.updateSkill=function(){this.isAction&&(this.onUseSkill(),Tool.callbackTime(this.updateSkill,this,8e3))},t.prototype.onUseSkill=function(){this.roleAvatar.data.useSkill=this.fashion.skillInfo,this.roleAvatar.onAttack()},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(MagicSkillFashionPanel.prototype,"MagicSkillFashionPanel");var MagicSkillPanel=function(e){function t(t){var n=e.call(this)||this;return n.blessTp=0,n.points=RedPointManager.createPoint(6),n.isLoaded=!1,n.rewardArr=new Array,n.indexId=0,n.blessTp=t,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.once(egret.Event.ADDED_TO_STAGE,n.onAddStage,n),n}return __extends(t,e),t.prototype.onAddStage=function(){this.skinName=skins.MagicSkillSkin},t.prototype.onLoadComplete=function(){this.isLoaded=!0,DataManager.IS_PC_Game||(this.width=size.width),this.isLoaded&&(this.onInit(),this.onRegist(),this.onRefresh())},t.prototype.onInit=function(){this.indexId=0,this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.x=58,this.selectedAnim.y=58,this.selectedAnim.onPlay(),this.btn0.addChildAt(this.selectedAnim,2),this.selectedAnim2=new Animation("gonghuijineng_1",-1),this.selectedAnim2.x=60,this.selectedAnim2.y=60,this.selectedAnim2.onPlay();for(var e=0;5>e;e++)this["skillIcon"+e].source=this.models[e].icon},t.prototype.onRegist=function(){for(var e=DataManager.getInstance().blessManager.skillModels(this.blessTp),t=0;5>t;t++){this["btn"+t].name=t+"",this["btn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSkill,this);var n=e[t];this.points[t].register(this["btn"+t],new egret.Point(95,0),this,"checkRedPoint",n)}this.points[5].register(this.upBtn,new egret.Point(150,-5),this,"checkRedPointBtn"),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_SKILL_MESSAGE.toString(),this.onRefresh,this)},t.prototype.checkRedPointBtn=function(){var e=DataManager.getInstance().blessManager.skillModels(this.blessTp);return this.checkRedPoint(e[this.indexId])},t.prototype.checkRedPoint=function(e){var t=e.cost;return DataManager.getInstance().bagManager.getGoodsThingNumById(t.id,t.type)>=t.num},t.prototype.trigger=function(){for(var e=0;e<this.points.length;e++)this.points[e].checkPointAll()},Object.defineProperty(t.prototype,"models",{get:function(){this.rewardArr=[];var e;e=JsonModelManager.instance.getModelmountSkill();for(var t in e)e[t].type==this.blessTp&&this.rewardArr.push(e[t]);return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onTouchSkill=function(e){var t=e.currentTarget,n=Number(e.target.name);this.clearAnim(),this.onShowInfo(n),2>=n?t.addChildAt(this.selectedAnim,2):t.addChildAt(this.selectedAnim2,3),this.onRefresh()},t.prototype.clearAnim=function(){0==this.indexId&&this.btn0.removeChildAt(2),1==this.indexId&&this.btn1.removeChildAt(2),2==this.indexId&&this.btn2.removeChildAt(2),3==this.indexId&&this.btn3.removeChildAt(3),4==this.indexId&&this.btn4.removeChildAt(3)},t.prototype.onRefresh=function(){this.isLoaded&&this.onShowInfo(this.indexId)},t.prototype.onShowInfo=function(e){this.indexId=e;var t=this.models[this.indexId];this.imgSkillName.source=t.zi;var n=this.getPlayer().getPlayerData(0).getBlessSkill(t.id);n?this.skillLv.text="等级："+n.level:this.skillLv.text="等级：0";var a=DataManager.getInstance().blessManager.getSkillAttrByID(t.id),i=DataManager.getInstance().blessManager.getSkillAttrByID(t.id,!0),o="",r="",s=0;for(0==i.length&&(r=Language.instance.getText("error_tips_7"));s<GameDefine.ATTR_OBJ_KEYS.length;s++)(a[s]>0||i[s])&&(o.length>0&&(o+="\n"),o+=GameDefine.Attr_FontName[s]+"："+a[s],s<i.length&&(r.length>0&&(r+="\n"),r+=GameDefine.Attr_FontName[s]+"："+i[s]));for(;s<2*GameDefine.ATTR_OBJ_KEYS.length;s++)(a[s]>0||i[s])&&(o.length>0&&(o+="\n"),o=a[s]/GameDefine.GAME_ADD_RATIO>0?o+GameDefine.Attr_FontName[s%ATTR_TYPE.SIZE]+"加成："+(a[s]/GameDefine.GAME_ADD_RATIO*100).toFixed(2)+"%":o+GameDefine.Attr_FontName[s%ATTR_TYPE.SIZE]+"加成：0%",s<i.length&&(r.length>0&&(r+="\n"),r=r+GameDefine.Attr_FontName[s%ATTR_TYPE.SIZE]+"加成："+(i[s]/GameDefine.GAME_ADD_RATIO*100).toFixed(2)+"%"));this.curPro.text=o,this.nextPro.text=r,this.exp_probar.maximum=DataManager.getInstance().blessManager.getSkillExpMaxByID(t.id),this.exp_probar.maximum>0?this.exp_probar.value=n?n.exp:0:(this.exp_probar.maximum=1,this.exp_probar.value=1,this.exp_probar.labelDisplay.text="MAX"),this.powerBar.power=DataManager.getInstance().playerManager.player.getPlayerData(0).getBlessFightingByType(this.blessTp),this.consumItem.setCostByAwardItem(t.cost),this.trigger()},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.models[this.indexId].cost.id,this.models[this.indexId].cost.num,this.models[this.indexId].cost.type)){var e=new Message(MESSAGE_ID.BLESS_UP_SKILL_MESSAGE);e.setByte(0),e.setByte(this.blessTp),e.setByte(this.models[this.indexId].id),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(eui.Component);__reflect(MagicSkillPanel.prototype,"MagicSkillPanel");var MagicViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicViewPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){switch(this.owner.tab){case BLESS_TAB_TYPE.LINGSHOU:return FUN_TYPE.FUN_MOUNT;case BLESS_TAB_TYPE.SHENZHUANG:return FUN_TYPE.FUN_SHENZHUANG;case BLESS_TAB_TYPE.SHENGBING:return FUN_TYPE.FUN_SHENBING;case BLESS_TAB_TYPE.XIANYU:return FUN_TYPE.FUN_XIANYU;case BLESS_TAB_TYPE.GUANGHUAN:return FUN_TYPE.FUN_FABAO}return 0},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.onRefreshUpGrade(),0==DataManager.getInstance().blessManager.btnType?this.magicGroup.visible=!0:this.magicGroup.visible=!1},t.prototype.onRefreshUpGrade=function(){var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.owner.tab);e.getBlessModelByData(t),e.getNextBlessModel(this.owner.tab,t.grade,t.level);this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType);for(var n=0;8>n;++n){var a=this["star"+n];n<t.level?a.visible||(a.alpha=0,a.visible=!0,egret.Tween.get(a).to({alpha:1},600,egret.Ease.sineOut).call(function(e){egret.Tween.removeTweens(e)},this,[a])):a.visible=!1}},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)
},t.prototype.onUpgrade=function(e){this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&DataManager.getInstance().blessManager.onSendBlessUpMsg(this.owner.tab,!1)},t.prototype.upHandler=function(e){this.onRefreshUpGrade()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.basicPanel&&this.basicPanel.trigger()},t.prototype.updateGoodsADD=function(){this.basicPanel.updateGoodsADD()},t}(BaseTabView);__reflect(MagicViewPanel.prototype,"MagicViewPanel");var MagicWingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicWingPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){return FUN_TYPE.FUN_XIANYU},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.onRefreshUpGrade()},t.prototype.onRefreshUpGrade=function(){var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.owner.tab),n=e.getBlessModelByData(t);e.getNextBlessModel(this.owner.tab,t.grade,t.level);0==DataManager.getInstance().blessManager.btnType?this.wingPanel.visible=!0:this.wingPanel.visible=!1,this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType),n&&(this.progress.maximum=n.exp,this.progress.value=t.exp);for(var a=0;a<BlessDefine.BLESS_STARS_MAX;++a){var i=this["star"+a];a<t.level?(i.alpha=1,egret.Tween.get(i).to({alpha:1},600,egret.Ease.sineOut).call(function(e){egret.Tween.removeTweens(e)},this,[i])):i.alpha=.2}},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_ACTIVE_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_SHOW_MESSAGE.toString(),this.upHandler,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FASHION_UPLEVEL_MESSAGE.toString(),this.upHandler,this)},t.prototype.onUpgrade=function(e){this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&DataManager.getInstance().blessManager.onSendBlessUpMsg(this.owner.tab,!1)},t.prototype.upHandler=function(e){this.onRefreshUpGrade()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.basicPanel.updateGoodsADD()},t.prototype.trigger=function(){e.prototype.trigger.call(this),this.basicPanel&&this.basicPanel.trigger()},t}(BaseTabView);__reflect(MagicWingPanel.prototype,"MagicWingPanel");var MagicZhuanPanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(8),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicZhuanPanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"blessFuncType",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.onRefreshUpGrade(),this.onUpdatePower()},t.prototype.onRefreshUpGrade=function(){var e=DataManager.getInstance().blessManager,t=e.getPlayerBlessData(this.owner.tab);e.getBlessModelByData(t),e.getNextBlessModel(this.owner.tab,t.grade,t.level);this.basicPanel.onUpdate(this.owner.tab,this.blessFuncType);for(var n=0;n<BlessDefine.BLESS_STARS_MAX;++n){var a=this["star"+n];n<t.level?a.visible||(a.alpha=0,a.visible=!0,egret.Tween.get(a).to({alpha:1},600,egret.Ease.sineOut).call(function(e){egret.Tween.removeTweens(e)},this,[a])):a.visible=!1}},t.prototype.onUpdatePower=function(){},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_MESSAGE.toString(),this.upHandler,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this)},t.prototype.onUpgrade=function(e){Tool.log("sdsadsadas"),this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)&&DataManager.getInstance().blessManager.onSendBlessUpMsg(this.owner.tab,!1)},t.prototype.upHandler=function(e){this.onRefreshUpGrade(),this.onUpdatePower()},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.getPlayerData=function(){return this.manager.player.getPlayerData()},t.prototype.updateGoodsADD=function(){this.cost&&this.consumItem.setCostByAwardItem(this.cost)},t}(BaseTabView);__reflect(MagicZhuanPanPanel.prototype,"MagicZhuanPanPanel");var MagicZiZhiDan=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n.indexId=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicZiZhiDanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.blessType=e;var t;t=JsonModelManager.instance.getModelmountDan();for(var n in t)t[n].type==this.blessType&&0==t[n].subtype&&(this.models=t[n]);this.indexId=0,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BLESS_UP_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.updateAvatarAnim=function(){var e="",t=DataManager.getInstance().blessManager,n=t.getPlayerBlessData(this.blessType),a=t.getBlessModelByData(n);for(a=a?a:t.getBlessModel(this.blessType,1,1),this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var i=this.avatar_grp.getChildAt(0);egret.is(i,"BodyAnimation")||egret.is(i,"Animation")?i.onDestroy():this.avatar_grp.removeChild(i)}var o=0,r=DataManager.getInstance().playerManager.player.getPlayerData().fashionWearIds[this.blessType],s=JsonModelManager.instance.getModelfashion()[r];switch(s&&(o=s.waixing1),this.blessType){case BLESS_TYPE.HORSE:e="zuoqi_"+o;var h=new Animation(e);this.avatar_grp.addChild(h),this.avatar_grp.y=200;break;case BLESS_TYPE.CLOTHES:var l=this.getPlayer().getPlayerData(0).sex==SEX_TYPE.MALE?"nan":"nv";e="shenzhuang_"+l+"_"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=320;break;case BLESS_TYPE.WEAPON:e="jian"+o;var g=new Animation(e,-1);this.avatar_grp.y=200,this.avatar_grp.addChild(g);break;case BLESS_TYPE.WING:e=LoadManager.getInstance().getWingResUrl("wing"+o,"ride_stand",Direction.DOWN+"");var c=new BodyAnimation(e,-1,Direction.DOWN);this.avatar_grp.addChild(c),this.avatar_grp.scaleX=.9,this.avatar_grp.scaleY=.9,this.avatar_grp.y=300;break;case BLESS_TYPE.RING:e="guanghuan_jiemian_"+o;var g=new Animation(e,-1);return this.avatar_grp.addChild(g),this.avatar_grp.y=200,this.avatar_grp.scaleX=.9,void(this.avatar_grp.scaleY=.9);case BLESS_TYPE.RETINUE_HORSE:e="sc_mount"+o;var p=new Animation(e);this.avatar_grp.addChild(p),this.avatar_grp.y=240;break;case BLESS_TYPE.RETINUE_CLOTHES:e="sc_role"+o;var u=new Animation(e);this.avatar_grp.addChild(u),this.avatar_grp.y=310;break;case BLESS_TYPE.RETINUE_WEAPON:e="weapon"+o+"_png";var d=new eui.Image;d.source=e,this.avatar_grp.addChild(d),this.avatar_grp.y=-100,this.onStartFloatAnim();break;case BLESS_TYPE.RETINUE_WING:e="sc_wing"+o;var _=new Animation(e);_.x=30,this.avatar_grp.addChild(_),this.avatar_grp.y=340;break;case BLESS_TYPE.MAGIC:e="sc_magic"+o;var g=new Animation(e,-1);this.avatar_grp.addChild(g),this.avatar_grp.y=200}this.avatar_grp.scaleX=.8,this.avatar_grp.scaleY=.8},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){this.updateAvatarAnim(),this.onShowInfo(this.indexId)},t.prototype.onShowInfo=function(e){this.titleName.text=this.models.name,this.indexId=e;var t=this.models;this.skillName.text=t.name;var n=DataManager.getInstance().blessManager.getPlayerBlessData(this.blessType),a=n.danDic[0],i=t.attrAry,o="",r="",s=0;if(this.skillLv.text="等级:"+a,a>0)for(;s<GameDefine.ATTR_OBJ_KEYS.length;s++)i[s]>0&&(o=o+GameDefine.Attr_FontName[s]+"："+i[s]*a+"\n",r=r+GameDefine.Attr_FontName[s]+"："+i[s]*(a+1)+"\n");else for(;s<GameDefine.ATTR_OBJ_KEYS.length;s++)i[s]>0&&(o=o+GameDefine.Attr_FontName[s]+"：0\n",r=r+GameDefine.Attr_FontName[s]+"："+i[s]+"\n");this.curPro.text=o,this.nextPro.text=r,this.consumItem.setCostByAwardItem(t.cost)},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.models.cost.id,this.models.cost.num,this.models.cost.type)){var e=new Message(MESSAGE_ID.BLESS_UP_DAN_MESSAGE);e.setByte(0),e.setByte(this.blessType),e.setByte(this.models.subtype),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(MagicZiZhiDan.prototype,"MagicZiZhiDan");var MailPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(3),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="MailTypePanel",n.btnRes="邮件",n.title="mail_title_png",n.redP=this.points[0],t.push(n);var n=new RegisterSystemParam;n.sysName="FriendListPanel",n.btnRes="好友",n.title="friend_title_png",t.push(n),n=new RegisterSystemParam,n.sysName="FriendApplyPanel",n.btnRes="查找",n.title="friend_title_png",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().friendManager,"checkFriendRedPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="FriendBlackList",n.btnRes="黑名单",n.title="friend_title_png",t.push(n),n=new RegisterSystemParam,n.sysName="FriendListChatPanel",n.btnRes="私聊",n.title="friend_title_png",n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().chatManager,"onCheckPrivateChatRedPoint"),t.push(n),this.sysQueue=t,this.registerPage(t,"bagGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.setTitle(this.sysQueue[this.index].btnRes)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseSystemPanel);__reflect(MailPanel.prototype,"MailPanel");var MailTypePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MailPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.com.label_title.text="邮件详情",this.accessoryLayer.touchChildren=!1,this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefresh=function(){var e,t;this.mail=DataManager.getInstance().mailManager.getMailList(),this.mailLayer.removeChildren(),e=this.mail.length;for(var n=0;e>n;n++)t=new MailItem,t.y=130*n,t.data=this.mail[n],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.mailLayer.addChild(t);this.ononeKeyfunction()},t.prototype.onTouchItem=function(e){if(this.item=e.currentTarget,this.data=this.item.data,!this.data.isOpen){this.data.isOpen=!0,this.item.onUpdate();var t=new Message(MESSAGE_ID.PLAYER_MAIL_READ_MESSAGE);t.setInt(this.item.data.id),GameCommon.getInstance().sendMsgToServer(t)}this.onmailfunction(),this.contentLayer.visible=!0,this.showContent()},t.prototype.showContent=function(){this.accessoryLayer.removeChildren();for(var e=this.data.accessory.length,t=0;e>t;t++){var n=this.data.accessory[t],a=new GoodsInstance;a.x=95*Math.floor(t%4),a.y=120*Math.floor(t/4),a.onUpdate(n.type,n.id,0,n.quality,n.count,n.lv),a.scaleX=.8,a.scaleY=.8,this.accessoryLayer.addChild(a)}this.data.isReceived?this.btn_receive.label=Language.instance.getText("mailReceived"):this.btn_receive.label=Language.instance.getText("lingqu"),this.label_title.text=this.data.title,this.label_desc.text=this.data.content},t.prototype.onTouchCloseBtn1=function(){this.contentLayer.visible=!1},t.prototype.onRegist=function(){if(e.prototype.onRegist.call(this),this.btn_receive.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnReceive,this),this.btn_receive_oneKey.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnrReceiveOneKey,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAIL_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE.toString(),this.onReceiveAll,this),this.com.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn1,this),0==DataManager.getInstance().mailManager.mail.length||void 0==DataManager.getInstance().mailManager.mail.length){var t=new Message(MESSAGE_ID.PLAYER_MAIL_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)}else this.onRefresh();this.contentLayer.visible=!1},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_receive.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnReceive,this),this.btn_receive_oneKey.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnrReceiveOneKey,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAIL_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE.toString(),this.onReceiveAll,this),this.com.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn1,this)},t.prototype.onReceiveAll=function(){for(var e=this.mailLayer.numChildren,t=e-1;t>=0;t--){var n=this.mailLayer.getChildAt(t);n.onUpdate(),this.ononeKeyfunction()}},t.prototype.ononeKeyfunction=function(){for(var e=this.mail.length,t=0;e>t&&(this.btn_receive_oneKey.enabled=this.mail[t].isReceived?!1:!0,1!=this.btn_receive_oneKey.enabled);t++);},t.prototype.onmailfunction=function(){this.btn_receive.enabled=this.data.isReceived?!1:!0},t.prototype.onTouchBtnReceive=function(){if(!this.data.isReceived){var e=new Message(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_MESSAGE);e.setInt(this.item.data.id),GameCommon.getInstance().sendMsgToServer(e)}this.contentLayer.visible=!1},t.prototype.onTouchBtnrReceiveOneKey=function(){var e=new Message(MESSAGE_ID.PLAYER_MAIL_GET_ACCESSORY_ALL_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.updateInfo=function(e){},t.prototype.onTouchBtnAdvance=function(){},t}(BaseTabView);__reflect(MailTypePanel.prototype,"MailTypePanel");var MailItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.MailItemSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){this.img_read.source=this.data.isOpen?"mail_read_png":"mail_unread_png",this.imgDi.source=this.data.isOpen?"mail_read_di_png":"mail_unread_di_png",this.label_title.text=this.data.title,this.data.isReceived?this.img_received.source="mail_yilingqu_png":this.img_received.source="mail_attach_png",this.label_time.text=this.data.sendTime},t}(eui.Component);__reflect(MailItem.prototype,"MailItem");var BossTargetBar=function(e){function t(){var t=e.call(this)||this;return t.hpLevelNum=1,t.maxinum=0,t.currhplevel=0,t.MAX_SOURCE=4,t.once(egret.Event.COMPLETE,t.onInit,t),t.skinName=skins.WorldBoss_ProBarSkin,t}return __extends(t,e),t.prototype.onInit=function(){this.thumb=this.progressBar.thumb,this.thumb_next=this.progressBar.thumb_next,this.pro_lab=this.progressBar.pro_lab,this.progressBar.slideDuration=0},t.prototype.onTarget=function(e){this.boosHP=null,e&&(this.boss_head_icon.source=GameCommon.getInstance().getHeadIconByModelid(e.modelid),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG?this.bossname_label.text=e.model.name+" "+Language.instance.parseInsertText("dijiguan",GameFight.getInstance().yewai_waveIndex):this.bossname_label.text=e.model.name,this.currhplevel=0)},t.prototype.onUpdateProgress=function(e,t){void 0===t&&(t=0),t>0&&(this.initHPLevelNum(),this.maxinum=Math.ceil(t/this.hpLevelNum),this.progressBar.maximum=this.maxinum,Tool.isNumber(this.boosHP)||(this.boosHP=t)),this.boosHP=Math.max(0,Math.min(e,this.boosHP));var n=this.currhplevel;this.currhplevel=Math.max(0,Math.ceil(this.boosHP/this.maxinum)),n>0&&this.currhplevel>0&&this.currhplevel!=n&&(this.progressBar.value=this.maxinum),this.pro_lab.text="×"+this.currhplevel;var a=Tool.toInt(this.boosHP%this.maxinum);this.progressBar.value=a;var i=(this.currhplevel-1)%this.MAX_SOURCE+1;switch(this.thumb.source=this.currhplevel<=1?"boss_thumb_b_0_png":"boss_thumb_b_"+i+"_png",i=(this.currhplevel-2)%this.MAX_SOURCE+1,this.currhplevel){case 1:this.thumb_next.source="";break;case 2:this.thumb_next.source="boss_thumb_b_0_png";break;default:this.currhplevel>0?this.thumb_next.source!="boss_thumb_b_"+i+"_png"&&(this.thumb_next.source="boss_thumb_b_"+i+"_png"):this.thumb_next.source=""}},t.prototype.onRemove=function(){this.parent&&this.parent.removeChild(this)},t.prototype.initHPLevelNum=function(){var e=GameFight.getInstance().fightsceneTpye;switch(e){case FIGHT_SCENE.ALLPEOPLE_BOSS:case FIGHT_SCENE.XUEZHAN_BOSS:case FIGHT_SCENE.VIP_BOSS:case FIGHT_SCENE.XIANSHAN_BOSS:this.hpLevelNum=10;break;case FIGHT_SCENE.SAMSARA_BOSS:this.hpLevelNum=20;break;case FIGHT_SCENE.CROSS_PVE_BOSS:this.hpLevelNum=50;break;default:this.hpLevelNum=1}},t}(eui.Component);__reflect(BossTargetBar.prototype,"BossTargetBar");var ChangeNamePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.isUpdate=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChangeNameSkin},t.prototype.onInit=function(){this.onRefresh()},t.prototype.onRefresh=function(){this.setTitle("角色名更改");var e=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.RENAME_COST));e&&(this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(e[0].type,e[0].id,e[0].num)))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE.toString(),this.onComplete,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_send.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSend,this),this.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE.toString(),this.onComplete,this)},t.prototype.onComplete=function(){GameCommon.getInstance().addAlert("修改成功"),e.prototype.onHide.call(this)},t.prototype.onTouchBtnSend=function(){var e=this.label_input.text;if(this.label_input.text="",e.length>6)return GameCommon.getInstance().addAlert("名称不能大于6个字"),void(this.label_input.text="");var t=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE);t.setString(e),GameCommon.getInstance().sendMsgToServer(t)},t}(BaseWindowPanel);__reflect(ChangeNamePanel.prototype,"ChangeNamePanel");var DupguankaxiaolvPanel=function(e){function t(t){var n=e.call(this)||this;return n.num=0,n}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.GuankaxiaolvPanel},t.prototype.onRefresh=function(){this.showdate()},t.prototype.showdate=function(){null==this.timer&&(this.timer=new egret.Timer(50,60)),this.alpha=1,this.num=0,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start(),this.qianbox.x=this.expbox.x,GameFight.getInstance().yewai_waveIndex>=2?(this.expLab1.text=720*GameFight.getInstance().getYewaiExp(GameFight.getInstance().yewai_waveIndex-1)+"",this.qian1.text=720*GameFight.getInstance().getYewaiGold(GameFight.getInstance().yewai_waveIndex-1)+"",this.expLab2.text=720*GameFight.getInstance().getYewaiExp()+"",this.qian2.text=720*GameFight.getInstance().getYewaiGold()+""):(this.expLab1.text="0",this.qian1.text="0",this.expLab2.text=720*GameFight.getInstance().getYewaiExp()+"",this.qian2.text=720*GameFight.getInstance().getYewaiGold()+"")},t.prototype.timerFunc=function(e){this.num++,this.num>50&&(this.alpha-=.2)},t.prototype.timerComFunc=function(){this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null),this.onDestory()},t.prototype.onDestory=function(){e.prototype.onDestory.call(this),this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null)},t}(BaseComp);__reflect(DupguankaxiaolvPanel.prototype,"DupguankaxiaolvPanel");var MainVIew_btnBar=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.Main_BtnsPro},t.prototype.addToLayer=function(e){e.addChild(this)},t.prototype.resize=function(){DataManager.IS_PC_Game||(this.width=size.width)},t.prototype.onRegistGameEvent=function(){this.btn_role.addEventListener(egret.Event.CHANGE,this.onTouchRole,this),this.btn_bag.addEventListener(egret.Event.CHANGE,this.onTouchBag,this),this.btn_xianlv.addEventListener(egret.Event.CHANGE,this.onTouchRetinue,this),this.btn_forge.addEventListener(egret.Event.CHANGE,this.onTouchBtnforge,this),this.btn_huanling.addEventListener(egret.Event.CHANGE,this.onTouchBtnBless,this),this.btn_fenZheng.addEventListener(egret.Event.CHANGE,this.onShowFenZheng,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.onupdateExp,this),DataManager.getInstance().bagManager.onShowEquipBagIsFullTips()},t.prototype.getHeroData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onInit=function(){this.onRegistGameEvent(),this.onupdateExp(),this.addRedPoint(),this.trigger()},t.prototype.addRedPoint=function(){this.points=RedPointManager.createPoint(6),this.points[0].register(this.btn_role,GameDefine.RED_MAIN_POS,this,"checkBtnRolePoint"),this.points[1].register(this.btn_forge,GameDefine.RED_MAIN_POS,this,"getForgePointShow"),this.points[2].register(this.btn_huanling,GameDefine.RED_MAIN_POS,this,"checkBtnBlessPoint"),this.points[3].register(this.btn_xianlv,GameDefine.RED_MAIN_POS,this,"checkBtnRetinueBlessPoint"),this.points[4].register(this.btn_bag,GameDefine.RED_MAIN_POS,this,"checkBtnBagPoint"),this.points[5].register(this.btn_fenZheng,GameDefine.RED_MAIN_POS,this,"checkBtnFenZheng")},t.prototype.trigger=function(){if(this.points)for(var e=0;e<this.points.length;e++)this.points[e].checkPoint()},t.prototype.onTouchRole=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RolePanel")},t.prototype.onTouchRetinue=function(e){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_PET_LEVEL)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PetMainPanel")},t.prototype.onShowFenZheng=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"YewaiPVPPanel")},t.prototype.onTouchBtnforge=function(e){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_QIANGHUA)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ForgePanel")},t.prototype.onTouchBtnBless=function(e){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_MOUNT)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MagicMainViewPanel")},t.prototype.onTouchBag=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"BagPanel")},t.prototype.onupdateExp=function(e){void 0===e&&(e=null);var t;t=null==e?!0:e.data,t&&(this.heroHp_probar.maximum=this.getHeroData().expMax),this.heroHp_probar.value=this.getHeroData().exp},t.prototype.checkBtnRolePoint=function(){return FunDefine.getTabRolePoint()?!0:DataManager.getInstance().skillManager.checkMainSkillUp()?!0:DataManager.getInstance().pulseManager.getCanPulseUpgrade()?!0:FunDefine.checkSixiangPoint()?!0:FunDefine.getWuxingRedPoint()?!0:FunDefine.checkTujianRedPointAll()?!0:FunDefine.getPsychPoint()?!0:!1},t.prototype.getForgePointShow=function(){return DataManager.getInstance().forgeManager.getForgePointShow()?!0:(DataManager.getInstance().magicManager,!0)},t.prototype.checkBtnBlessPoint=function(){return DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.HORSE)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.CLOTHES)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.WEAPON)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.WING)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.MAGIC)?!0:!1},t.prototype.checkBtnRetinueBlessPoint=function(){return DataManager.getInstance().petManager.onCheckPetRedPoint()?!0:!1},t.prototype.checkBtnBagPoint=function(){return DataManager.getInstance().bagManager.getEquipSmeltPointShow()?!0:DataManager.getInstance().bagManager.getItemCanUsePointShow()?!0:!1},t.prototype.checkBtnFenZheng=function(){return DataManager.getInstance().yewaipvpManager.checkEncounterPoint()?!0:DataManager.getInstance().localArenaManager.getRedPointShow()?!0:DataManager.getInstance().arenaManager.getLadderPointShow()?!0:DataManager.getInstance().escortManager.getShowSysRedpoint()?!0:!1},t.prototype.resetButtonsStatus=function(){if(this.isLoaded)for(var e=0;e<this.btnsbarGrp.numChildren;e++){var t=this.btnsbarGrp.getChildAt(e);t&&(t.selected=!1)}},t}(BaseComp);__reflect(MainVIew_btnBar.prototype,"MainVIew_btnBar");var MainView=function(e){function t(t){var n=e.call(this)||this;return n.isInit=!1,n.btnIsHide=null,n._swithBottomBar1=!1,n._swithShowChat=!0,n._showChatPlaying=!1,n.points=RedPointManager.createPoint(21),n.owner=t,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.skinName=skins.GameMainView,n}return __extends(t,e),t.prototype.resize=function(){DataManager.IS_PC_Game?this.maininfo_grp.width=GameDefine.GAME_STAGE_WIDTH:this.maininfo_grp.width=size.width,this.width=size.width,this.height=size.height},Object.defineProperty(t.prototype,"mainbarUI",{get:function(){return this.owner.mainbtnbarUI},enumerable:!0,configurable:!0}),t.prototype.onLoadComplete=function(){this.onRegistGameEvent();GameSetting.getLocalSetting(GameSetting.SOUND_MUTE);SoundFactory.playMusic(SoundDefine.SOUND_BGM)},t.prototype.onChangeScene=function(){this.isInit?this.updateFunOpenTip():(this.isInit=!0,this.onInit()),this.onRefreshStatus()},t.prototype.addMainBtnBar=function(){this.mainbarUI.addToLayer(this.bottom_main_bar),this.mainbarUI.resetButtonsStatus()},t.prototype.onRegistGameEvent=function(){var e=new Message(MESSAGE_ID.XUEZHAN_INIT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onupdateCurrency,this),GameDispatcher.getInstance().addEventListener(GameEvent.SCENE_ENTER_SUCCESS,this.onChangeScene,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FUNCTION_REWARD_MESSAGE.toString(),this.updateFunOpenTip,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TASK_CHAIN_UPDATE_MESSAGE.toString(),this.updateGuideTaskList,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_JACKAROO_COMPLETE,this.onCompleteJackroo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CHAT_SEND_MESSAGE.toString(),this.updateChatInfoBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CHAT_RECEIVE_MESSAGE.toString(),this.updateChatInfoBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE.toString(),this.onRefreshPlayerHead,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE.toString(),this.onRefreshPlayerHead,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_LEVEL_UPDATE,this.onupdateExp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE.toString(),this.updateCoatard,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_YEWAI_FIGHT_UPDATE,this.onRefreshWave,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SET_AUTO_FIGHT,this.onSetAutoFight,this),GameDispatcher.getInstance().addEventListener(GameEvent.PLAYER_POWER_UPDATE,this.onUpdatePlayerPower,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG.toString(),this.updateCoatardTask,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_CHECKACTIVITY_BTN,this.onCheckActivityBtn,this),GameDispatcher.getInstance().addEventListener(GameEvent.SYSTEM_CHAT_BROADCAST_UPDATEMAINVIEW,this.updateChatInfoBack,this),GameDispatcher.getInstance().addEventListener(GameEvent.MAIN_GIFT_COOLDOWN,this.onGiftCDShow,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RECHAREG_RECORD_MESSAGE.toString(),this.hideBtnFC,this),this.maskimg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHideBtnGroup,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE.toString(),this.onChangeName,this),this.cb_autoFight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAutoFight,this),this.btn_jingjie.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchJingjie,this),this.dup_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDup,this),this.union_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUnion,this),this.challenge_boss_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBossBtn,this),this.guide_task_bar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGuideTaskBar,this),this.btn_mail.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnMail,this),this.btn_boss.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBoss,this),this.btn_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRank,this),this.gold_money.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnGotoRecharge,this),this.money_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchfuli,this),this.btn_yueka.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchyueka,this),this.btn_firstcharge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchfc,this),this.btn_meiri.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMeiRi,this),this.btn_chongbang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChongbang,this),this.vipBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onVipBtn,this),this.funBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFunOpenBtn,this),this.funGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFunOpenBtn,this),this.playerHead.addClickListener(this.onTouchBtnSysOpt,this),this.chatLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMinChatLayer,this),this.minChat.addEventListener(egret.TextEvent.LINK,this.onTouchMiniChat,this),this.minichat_layer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMinChatLayer,this),this.btnGrop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowGrop,this),this.btnMarry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowMarry,this),this.switch_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchAccount,this),this.bottom_boss.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnBoss,this)
},t.prototype.updateChatInfoBack=function(){this.updateChatInfo(50)},t.prototype.updateChatInfo=function(e){for(var t=DataManager.getInstance().chatManager.chat[CHANNEL.ALL].concat();t.length>2;)t.shift();var n=DataManager.getInstance().chatManager.getChatTextFlow(CHANNEL.ALL,t);this.minChat&&(this.minChat.textFlow=n,setTimeout(this.adjustChatBar.bind(this),e))},t.prototype.adjustChatBar=function(){},t.prototype.getHeroData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onRefreshStatus=function(){var e=this.isDupScene;this.onSwitchMainviewBtn(e),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&this.onRefreshYewaiAwardDesc(),this.btnGrop.visible=!1;JsonModelManager.instance.getModelfunctionLv();this.updateChatInfoBack()},t.prototype.onSwitchMainviewBtn=function(e){this.btnIsHide!=e&&(this.group_topbar.visible=!e,this.bottom_main_bar.visible=!e,this.bottom_btnbar_grp.visible=!e,this.left_btns_bar.visible=!e,this.funGroup.visible=!e&&!GameFight.getInstance().isJackaroo,this.btn_jingjie.visible=!e,this.btnIsHide=e,this.chatGroup.visible=!e),SDKManager.loginInfo.channel==EChannel.CHANNEL_YYBQUICK&&(this.switch_btn.visible=!0),this.setYewaiBarVisible(),this.setGuideTaskVisible()},t.prototype.onSwitchBtnForYewai=function(e){this.setYewaiBarVisible(),this.setGuideTaskVisible()},t.prototype.setGuideTaskVisible=function(){if(this.guide_task_bar.parent){var e=!0;GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG&&(e=!1),this.guide_task_bar.visible=e}},t.prototype.setYewaiBarVisible=function(){this.yewai_wave_bar.visible=this.yewaiBtnVisible},Object.defineProperty(t.prototype,"yewaiBtnVisible",{get:function(){var e=!0;return(GameFight.getInstance().isJackaroo||GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG)&&(e=!1),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDupScene",{get:function(){return GameFight.getInstance().fightsceneTpye!=FIGHT_SCENE.YEWAI_XG},enumerable:!0,configurable:!0}),t.prototype.onShowLieMing=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LieMingMainPanel")},t.prototype.onShowMarry=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MarryMainPanel")},t.prototype.onShowGrop=function(){this._swithBottomBar1=!this._swithBottomBar1,this.btnsPanel.visible=this._swithBottomBar1,this.maskimg.visible=this._swithBottomBar1},t.prototype.onShowXianShan=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"XianDanMainViewPanel")},t.prototype.switchAccount=function(){var e=[{text:"是否确定切换账号？",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,function(){this.switchJS()},this)))},t.prototype.switchJS=function(){SDKQuickJS.logout()},t.prototype.onTouchSoundCkBtn=function(){},t.prototype.onInit=function(){1!=this.getHeroData().level||0!=this.getHeroData().exp||SDKManager.isHidePay||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"Welcome"),this.top_back_img.height=80,SDKManager.isBangsscreen?(this.maininfo_grp.top=25,this.group_topbar.top=165):(this.maininfo_grp.top=45,this.group_topbar.top=175),this.addMainBtnBar();var e=new Animation("UI_zhandouli",-1);e.x=40,e.scaleX=1.1,e.y=32,this.power_info_grp.addChildAt(e,0),this.onRefreshPlayerHead(),this.heroName.text=this.getHeroData().name,this.onUpdatePlayerPower(),this.onupdateExp(),this.updateCoatard(),this.onupdateCurrency(),this.cb_autoFight.selected=GameSetting.getLocalSetting(GameSetting.YEWAI_AUTO_FIGHT),this.updateGuideTaskList(),this.onShowActivity(),this.addRedPoint(),Tool.callbackTime(this.onCheckOffLineExp,this,1e3),this.trigger();var t=new egret.Shape;t.graphics.beginFill(16777215,1),t.graphics.drawRect(0,0,480,136),t.graphics.endFill(),t.touchEnabled=!1,this.updateChatInfoBack(),this.saveMainviewImage(),this.setYewaiBarVisible(),this.registerChongBang(),this.checkChongBang(),0==DataManager.getInstance().rechargeManager.firstCharge&&this.getHeroData().level>=20&&(this.img_exr.visible=!0),SDKManager.getChannel()==EChannel.CHANNEL_WXGAMEBOX&&(DataManager.getInstance().wxgameManager.onupdateColletionStatus(),this.refreshIosPayHide())},t.prototype.refreshIosPayHide=function(){SDKManager.isHidePay?(this.left_btns_bar.parent&&this.left_btns_bar.parent.removeChild(this.left_btns_bar),this.left_btns_bar.visible=!1,this.vipBtn.visible=!1,this.money_add_img.visible=!1,this.gold_add_img.visible=!1):(this.left_btns_bar.parent||this.addChild(this.left_btns_bar),this.left_btns_bar.visible=!0,this.vipBtn.visible=!0,this.money_add_img.visible=!0,this.gold_add_img.visible=!0)},t.prototype.saveMainviewImage=function(){for(var e=0;e<this.numChildren;e++){var t=this.getChildAt(e);LoadManager.getInstance().addMainvewImageAry(t)}},t.prototype.onRefreshPlayerHead=function(){this.playerHead.setHead()},t.prototype.onGiftCDShow=function(){},t.prototype.hideBtnFC=function(){0!=DataManager.getInstance().rechargeManager.firstCharge&&this.btn_firstcharge&&(this.btn_firstcharge.visible=!1,this.btn_meiri.visible=!0)},t.prototype.onChangeName=function(){this.heroName.text=this.getHeroData().name},t.prototype.onHideBtnGroup=function(){this._swithBottomBar1=!1,this.btnsPanel.visible=this._swithBottomBar1,this.maskimg.visible=this._swithBottomBar1},t.prototype.delButtonAnimation=function(e){var t;e&&e.getChildByName("Activity_Button_effect")&&(t=e.getChildByName("Activity_Button_effect"),e.removeChild(t),t=null)},t.prototype.onTouchBtnShowChat=function(e){this.switchShowChatHandler(!this._swithShowChat)},t.prototype.switchShowChatHandler=function(e){if(!this._showChatPlaying){this._swithShowChat=e;var t=this._swithShowChat?41:-439;if(t!=this.chat_sys.left){this._showChatPlaying=!0;var n=egret.Tween.get(this.chat_sys);n.to({left:t},200,egret.Ease.circOut).call(function(){egret.Tween.removeTweens(this.chat_sys),n=null,this._showChatPlaying=!1},this)}}},t.prototype.onCheckOffLineExp=function(){DataManager.getInstance().playerManager.offlineData.exp>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"OffLineExpPanel")},t.prototype.showTips=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("WanbaGiftPanel",e))},t.prototype.onShowActivity=function(){this.activity||(this.activity=new ActivityContainerBar(this.group_topbar))},t.prototype.onCheckActivityBtn=function(){if(this.activity&&this.activity.checkActivityBtn(),this.btn_meiri.visible=!1,0!=DataManager.getInstance().rechargeManager.firstCharge){this.btn_firstcharge&&(this.btn_firstcharge.visible=!1);var e=DataManager.getInstance().activityManager.activity[ACTIVITY_BRANCH_TYPE.LEIJICHONGZHI];if(e){var t=DataManager.getInstance().newactivitysManager.leiji,n=t.atyuanbao,a=JsonModelManager.instance.getModelleijichongzhi()[10];n>=a.costNum?this.btn_meiri.visible=!1:this.btn_meiri.visible=!0}}this.recharge_group.visible=!1,this.getHeroData().level>=50&&(this.recharge_group.visible=!0),this.btn_chongbang.visible=!1,this.btn_chongbang.height=15,DataManager.getInstance().activityManager.activity[ACTIVITY_BRANCH_TYPE.CHONGBANG_LIBAO]&&DataManager.getInstance().newactivitysManager.chargeMoneyNum<300&&this.getHeroData().level>=10&&(this.btn_chongbang.visible=!0,this.btn_chongbang.height=90),this.btn_yueka.visible=!1,this.getHeroData().level>=20&&(this.btn_yueka.visible=!0),this.checkChongBang()},t.prototype.onTouchBottomBtn=function(e){if("bottom_96"==e.currentTarget.name&&DataManager.getInstance().newactivitysManager.blessTp>10)return void(DataManager.getInstance().newactivitysManager.blessTp>=15?GameCommon.getInstance().addAlert("明天开启"):GameCommon.getInstance().addAlert(15-DataManager.getInstance().newactivitysManager.blessTp+"天后开启"));var t=parseInt(e.currentTarget.name.replace("bottom_",""));GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t)},t.prototype.onupdateCurrency=function(e){void 0===e&&(e=null),this.money_bind.text=GameCommon.getInstance().getFormatNumberShow(this.getHeroData().money),this.money_gold.text=GameCommon.getInstance().getFormatNumberShow(this.getHeroData().gold),this.vip_label.text=""+GameCommon.getInstance().getVipName(this.getHeroData().viplevel)},t.prototype.onUpdatePlayerPower=function(){this.fight_value_label.text=this.getHeroData().playerTotalPower+""},t.prototype.onupdateExp=function(e){void 0===e&&(e=null);var t;if(t=null==e?!0:e.data){this.heroLv.text=this.getHeroData().level+Language.instance.getText("level"),DataManager.getInstance().welfareManager.isCanShowWelfare()&&(DataManager.getInstance().welfareManager.isOpenWelfare=!0);var n=SDKManager.getChannel();n==EChannel.CHANNEL_WANBA&&DataManager.getInstance().playerManager.checkDeskPoint()&&10==DataManager.getInstance().playerManager.player.level&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DeskPanel"),this.updateFunOpenTip(),this.onCheckActivityBtn(),SDKManager.getHandlerAny()&&SDKManager.getHandlerAny().uploadGameRoleInfo&&SDKManager.getHandlerAny().uploadGameRoleInfo(this.getHeroData(),!1)}},t.prototype.updateCoatard=function(){},t.prototype.updateCoatardTask=function(){},t.prototype.onOpenFirstPayWindow=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("WelfarePanel",1))},t.prototype.onRefreshWave=function(){if(GameFight.getInstance().isJackaroo)return void(this.guide_task_bar.visible=!1);if(this.guide_task_bar.visible||(this.guide_task_bar.visible=!0),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG){var e=(GameFight.getInstance().fightScene,GameFight.getInstance().fightScene.rushData.progress),t=Math.min(e,GameFight.getInstance().yewai_batch);this.bossAutoBar.maximum=e,this.bossAutoBar.value=t,this.bossAutoBar.labelDisplay.visible=!1,this.yewai_pass_num.text="第"+GameFight.getInstance().yewai_waveIndex+"关";var n=e==t;n?(this.yewaiBossAnim||(this.yewaiBossAnim=new Animation("guanqiaboss",-1),this.yewaiBossAnim.x=62,this.yewaiBossAnim.y=50),this.yewaiBossAnim.parent||this.yewai_wave_bar.addChildAt(this.yewaiBossAnim,1)):this.yewaiBossAnim&&this.yewaiBossAnim.parent&&this.yewaiBossAnim.parent.removeChild(this.yewaiBossAnim),this.onSwitchBtnForYewai(!0),this.oldYewaiWaveIndex!=GameFight.getInstance().yewai_waveIndex&&(this.cb_autoFight.visible=GameFight.getInstance().yewai_waveIndex>=GameDefine.OPEN_AutoFight_Wave,this.updateFunOpenTip(),this.onRefreshYewaiAwardDesc(),this.oldYewaiWaveIndex=GameFight.getInstance().yewai_waveIndex,this.refreshIosPayHide())}},t.prototype.onRefreshYewaiAwardDesc=function(){var e=GameCommon.getInstance().readStringToHtml("第"+("[#32db52"+GameFight.getInstance().yewai_waveIndex+"]")+"关");this.yewai_stageidx_lab.textFlow=(new egret.HtmlTextParser).parser(e),e=GameCommon.getInstance().readStringToHtml("经验："+("[#e7cf7b"+GameCommon.getInstance().getFormatNumberShow(720*GameFight.getInstance().getYewaiExp())+"]")+"/小时"),this.yewai_exp_award.textFlow=(new egret.HtmlTextParser).parser(e),e=GameCommon.getInstance().readStringToHtml("阅历："+("[#e7cf7b"+GameCommon.getInstance().getFormatNumberShow(720*GameFight.getInstance().getYewaiGold())+"]")+"/小时"),this.yewai_gold_award.textFlow=(new egret.HtmlTextParser).parser(e)},t.prototype.onTouchChallengeBossBtn=function(){GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"YeWaiChallengePanel")},t.prototype.onTouchAutoFight=function(e){var e=new egret.Event(null);GameFight.getInstance().yewai_waveIndex<=GameDefine.OPEN_AutoFight_Wave&&(this.cb_autoFight.selected=!1,GameCommon.getInstance().addAlert("通关第"+GameDefine.OPEN_AutoFight_Wave+"关开启自动战斗")),e.data=this.cb_autoFight.selected,this.onSetAutoFight(e)},t.prototype.onSetAutoFight=function(e){this.cb_autoFight.selected=e.data?e.data:!1,GameSetting.setLocalSave(GameSetting.YEWAI_AUTO_FIGHT,this.cb_autoFight.selected)},t.prototype.onTouchBtnBattle=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"BattlePanel")},t.prototype.onTouchJingjie=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TaskBasePanel",TASKPANEL_TAB.COATARDTASK))},t.prototype.onTouchRetinue=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RetinueMainPanel")},t.prototype.onTouchDSHD=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TimeLimitPlayPanel")},t.prototype.onTouchSkill=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SkillPanel")},t.prototype.onTouchBtnforge=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ForgePanel")},t.prototype.openUnionBattle=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionMainPanel",UnionDefine.TAB_BATTLE))},t.prototype.onTouchBtnLegend=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"LegendEquipPanel")},t.prototype.onTouchBtnChat=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ChatMainPanel")},t.prototype.onTouchBtnMail=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MailPanel")},t.prototype.onTouchBtnCDK=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"CDKeyPanel")},t.prototype.onTouchBtnSysOpt=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PlayerSettingPanel")},t.prototype.onTouchOffLineExp=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"OffLineExpPanel")},t.prototype.onTouchUnion=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel")},t.prototype.onTouchDup=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"DupPanel")},t.prototype.onShowFulingBoss=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FuLingMainViewPanel")},t.prototype.onShowZhuXianBoss=function(e){return DataManager.getInstance().newactivitysManager.blessTp>10?void(DataManager.getInstance().newactivitysManager.blessTp>=15?GameCommon.getInstance().addAlert("明天开启"):GameCommon.getInstance().addAlert(15-DataManager.getInstance().newactivitysManager.blessTp+"天后开启")):void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ZhuXianBossPanel")},t.prototype.onTouchBtnRank=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TOPRankingList")},t.prototype.onTouchMiniChat=function(e){var t=e.text;t&&ChatDefine.onChatHrefEvent(t)},t.prototype.onTouchMinChatLayer=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ChatMainPanel")},t.prototype.onTouchBtnBoss=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"CrossBarriersPanel")},t.prototype.onTouchBtnGotoRecharge=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onTouchfuli=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_JUBAOPEN)},t.prototype.onTouchfc=function(e){this.img_exr.visible=!1;var t=e.currentTarget;this.delButtonAnimation(t),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FirstChargePanel")},t.prototype.onTouchyueka=function(e){var t=e.currentTarget;this.delButtonAnimation(t),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_MONTHCARD)},t.prototype.onTouchMeiRi=function(e){var t=e.currentTarget;this.delButtonAnimation(t),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TakeMoneyEveryDayPanel")},t.prototype.onTouchChongbang=function(e){var t=e.currentTarget;this.delButtonAnimation(t),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_CHONGBANG)},t.prototype.onTouchBtnTiangong=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TianGongPanel")},t.prototype.onTouchBtnVip3=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ActivitysVip3Panel")},t.prototype.onTimeDown=function(){},t.prototype.addRedPoint=function(){this.points[0].register(this.btn_jingjie,new egret.Point(110,10),this,"checkZhuanShengPoint"),this.points[1].register(this.dup_btn,GameDefine.RED_MAIN_II_POS,this,"checkBtnDupPoint"),this.points[3].register(this.bottom_47,GameDefine.RED_CRICLE_STAGE_PRO,this,"checkBtnPetPoint"),this.points[4].register(this.btn_mail,new egret.Point(48,2),this,"checkBtnMailPoint"),this.points[6].register(this.bottom_52,GameDefine.RED_MAIN_II_POS,DataManager.getInstance().unionManager,"checkUnionRedPoint"),this.points[7].register(this.funBtn,new egret.Point(75,10),FunDefine,"checkFunOpenRedPoint"),this.points[8].register(this.btn_boss,GameDefine.RED_MAIN_II_POS,this,"checkBossDupRedPoint"),this.points[9].register(this.btnGrop,GameDefine.RED_MAIN_II_POS,this,"checkBtnsPoint"),this.points[10].register(this.bottom_71,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().magicManager,"checkMainXyPoint"),this.points[11].register(this.bottom_87,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().fateManager,"getFatePoint"),this.points[12].register(this.bottom_89,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().xiandanManager,"getXianShanAllPoint"),this.points[14].register(this.bottom_94,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().fuLingManager,"getFulingpoint"),this.points[15].register(this.bottom_96,GameDefine.RED_CRICLE_STAGE_PRO,this,"checkBtnZhuXianBoss"),this.points[16].register(this.bottom_97,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().bagManager,"getAllRnuesPoint"),this.points[17].register(this.bottom_108,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().playerManager,"oncheckTianshuRP"),this.points[18].register(this.bottom_110,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().yuanjieManager,"checkRedPoint"),this.points[19].register(this.bottom_111,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().wuTanManager,"checkRedPoint"),this.points[20].register(this.bottom_112,GameDefine.RED_CRICLE_STAGE_PRO,DataManager.getInstance().skillEnhantM,"checkSkillEnhantRedp")},t.prototype.trigger=function(e){void 0===e&&(e=!1);for(var t=0;t<this.points.length;t++)e?this.points[t].point&&!this.points[t].point.visible&&this.points[t].checkPoint():this.points[t].checkPoint();this.activity&&this.activity.trigger()},t.prototype.checkBtnRolePoint=function(){return FunDefine.getTabRolePoint()?!0:DataManager.getInstance().skillManager.checkMainSkillUp()?!0:DataManager.getInstance().pulseManager.getCanPulseUpgrade()?!0:FunDefine.checkSixiangPoint()?!0:FunDefine.getWuxingRedPoint()?!0:FunDefine.checkTujianRedPointAll()?!0:FunDefine.getPsychPoint()?!0:!1},t.prototype.checkBtnBlessPoint=function(){return DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.HORSE)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.CLOTHES)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.WEAPON)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.WING)?!0:DataManager.getInstance().playerManager.checkBlessUPMain(BLESS_TYPE.RING)?!0:!1},t.prototype.checkBtnBagPoint=function(){return DataManager.getInstance().bagManager.getEquipSmeltPointShow()?!0:DataManager.getInstance().bagManager.getItemCanUsePointShow()?!0:!1},t.prototype.checkZhuanShengPoint=function(){return DataManager.getInstance().playerManager.checkZhuanShengPoint()?!0:DataManager.getInstance().taskManager.getChengJiuPoint()?!0:!1},t.prototype.checkMarryPoint=function(){if(DataManager.getInstance().playerManager.player.marriId>0){if(DataManager.getInstance().ringManager.checkRedPointAll())return!0;if(FunDefine.getDupHasTimes(DUP_TYPE.DUP_MARRY))return!0;if(FunDefine.getDupHasTimes(DUP_TYPE.DUP_MARRY_EQUIP_SUIT_BOSS))return!0;if(DataManager.getInstance().marryManager.divorcePoint())return!0;if(DataManager.getInstance().marryManager.checkMarryTreePoint())return!0}return!1},t.prototype.checkBtnDupPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_DUP_CAILIAO)?FunDefine.DupCailiaoHasTimes()?!0:FunDefine.DupChallengeHasTimes()?!0:FunDefine.getDupHasTimes(DUP_TYPE.DUP_ZHUFU)?!0:FunDefine.getDupHasTimes(DUP_TYPE.DUP_TEAM)?!0:FunDefine.SixiangDupRedPoint()?!0:!1:!1},t.prototype.checkBtnZhuXianBoss=function(){return FunDefine.DupZhuXianBossTimes()?!0:!1},t.prototype.checkBtnYewaipvpPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_YEWAIPVP)?DataManager.getInstance().yewaipvpManager.checkEncounterPoint()?!0:DataManager.getInstance().arenaManager.getLadderPointShow()?!0:DataManager.getInstance().localArenaManager.getRedPointShow()?!0:DataManager.getInstance().escortManager.getShowSysRedpoint()?!0:!1:!1},t.prototype.checkBtnChallengeBossPoint=function(){return DataManager.getInstance().playerManager.checkHasBossAward()?!0:!1},t.prototype.checkBtnFightSpritePoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_FABAO)?DataManager.getInstance().magicManager.checkMagicUpgradePoint()?!0:DataManager.getInstance().magicManager.checkMagicAdvancePoint()?!0:DataManager.getInstance().magicManager.checkMagicTurnplatePoint()?!0:!1:!1},t.prototype.checkBtnMailPoint=function(){return DataManager.getInstance().mailManager.getCanShowMail()?!0:this.checkBtnFriendPoint()?!0:!1},t.prototype.checkBtnFriendPoint=function(){return DataManager.getInstance().friendManager.checkFriendRedPoint()||DataManager.getInstance().chatManager.onCheckPrivateChatRedPoint()?!0:!1},t.prototype.checkBtnChatPoint=function(){return DataManager.getInstance().chatManager.onCheckChatRedPoint()?!0:!1},t.prototype.checkBtnPetPoint=function(){return DataManager.getInstance().petManager.onCheckPetRedPoint()?!0:!1},t.prototype.checkBtnsPoint=function(){return DataManager.getInstance().magicManager.checkMainXyPoint()&&this.getHeroData().level>=JsonModelManager.instance.getModelfunctionLv()[71].level?!0:DataManager.getInstance().fateManager.getFatePoint()&&this.getHeroData().level>=JsonModelManager.instance.getModelfunctionLv()[87].level?!0:this.checkBtnPetPoint()?!0:DataManager.getInstance().xiandanManager.getXianShanAllPoint()&&this.getHeroData().level>=JsonModelManager.instance.getModelfunctionLv()[89].level?!0:this.checkBtnZhuXianBoss()?!0:DataManager.getInstance().fuLingManager.getFulingpoint()?!0:DataManager.getInstance().bagManager.getAllRnuesPoint()?!0:DataManager.getInstance().bagManager.getAllRnuesPoint()?!0:!1},t.prototype.checkBossDupRedPoint=function(){return FunDefine.getGerenBossRedPoint()?!0:FunDefine.getAllPeopleBossRedPoint()?!0:FunDefine.getSamsaraBossBackAwdRPoint()?!0:!1},t.prototype.onVipBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"VipPanel")},t.prototype.onFunOpenBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"OpenFuncView")},t.prototype.onActiveRoleBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ActivateRolePanel")},t.prototype.onCompleteJackroo=function(){GameFight.getInstance().isJackaroo||(this.updateFunOpenTip(),this.funGroup.visible=!0,this.setYewaiBarVisible())},t.prototype.updateGuideTaskList=function(){var e=DataManager.getInstance().taskManager.guideTaskData;if(e)if(e.model){var t=e.model;if(this._guideTaskId!=t.id){if(this._guideTaskId>0){var n=this.guide_taskinfo_grp;egret.Tween.removeTweens(n),egret.Tween.get(n).to({alpha:0},300,egret.Ease.sineIn).to({alpha:1},200,egret.Ease.sineInOut).call(function(){egret.Tween.removeTweens(this.guide_taskinfo_grp)},this),this.owner.iconToBagEffect(this.guide_awdicon_img)}if(119==t.eventType&&!FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)){if(DataManager.getInstance().wxgameManager.isFirstShare){var a=new Message(MESSAGE_ID.WXGAME_SHARE_LEVEL_MESSAGE);a.setBoolean(!0),a.setShort(GameDefine.FANGKUAI_FIRST_SHARE_LV),GameCommon.getInstance().sendMsgToServer(a)}return void DataManager.getInstance().taskManager.sendTaskChainCompleteMsg()}var i=t.rewards[0],o=GameCommon.getInstance().getThingModel(i.type,i.id);this.guide_awdicon_img.source=o.dropicon,this.guide_awdname_lab.text=o.name,this.guide_awdname_lab.textColor=GameCommon.getInstance().CreateNameColer(o.quality),this.guide_awdnum_lab.text="×"+i.num,t.jackaroo>0&&!e.isFinish&&Tool.callbackTime(this.owner.onStartOneGuide,this.owner,500),this._guideTaskId=t.id}var r=(e.model.param,e.progress,Language.instance.parseInsertText(t.desc,t.param));e.isFinish?(r=GameCommon.getInstance().readStringToHtml(r+("[#78FF28("+Language.instance.getText("wancheng2")+")]")),this.taskAnim||(this.taskAnim=new Animation("renwukuang",-1),this.taskAnim.x=181,this.taskAnim.y=83),this.taskAnim.parent||this.taskEffect.addChildAt(this.taskAnim,1)):(this.taskAnim&&this.taskAnim.parent&&this.taskAnim.parent.removeChild(this.taskAnim),r=GameCommon.getInstance().readStringToHtml(r+("[#FF5B5B("+e.progress+"/"+t.param+")]"))),this.guide_task_dec.textFlow=Tool.getHtmlITextElement(r)}else this.guide_task_bar.parent&&this.guide_task_bar.parent.removeChild(this.guide_task_bar)},t.prototype.onTouchGuideTaskBar=function(){var e=DataManager.getInstance().taskManager.guideTaskData;if(e&&e.model)if(e.isFinish){DataManager.getInstance().taskManager.sendTaskChainCompleteMsg();var t=new Animation("renwuwancheng",1,!0);t.x=180,t.y=85,this.taskEffect.addChild(t)}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),e.model.goType)},t.prototype.updateFunOpenTip=function(){if(GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.YEWAI_XG&&!GameFight.getInstance().isJackaroo){var e,t=[],n=this._unopenFuns?!1:!0;n&&(this._unopenFuns=[]);var a=JsonModelManager.instance.getModelfunctionLv();for(var i in a){var o=a[i];if(!o)if(e||DataManager.getInstance().playerManager.getFunIsAwarded(o.id)||(e=!0),FunDefine.isFunOpen(o.id)){if(n)continue;var r=this._unopenFuns.indexOf(o);r>=0&&(this._unopenFuns.splice(r,1),t.push(o))}else n&&this._unopenFuns.push(o)}n&&this._unopenFuns.sort(function(e,t){return FunDefine.funOpenLevel(e.id)-FunDefine.funOpenLevel(t.id)<0?-1:1}),this.funImage.visible=!1,0==this._unopenFuns.length?e?(this.funImage.visible=!0,this.funBtn.label="有奖励未领取"):this.funGroup.parent&&this.funGroup.parent.removeChild(this.funGroup):(t.length>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("OpenFunTipsBar",t)),this.funBtn.icon=this._unopenFuns[0].icon,this.funBtn.label=FunDefine.getFunOpenDesc(this._unopenFuns[0].id)),this.points[7]&&this.points[7].checkPoint()}},t.prototype.openfunRequestMsg=function(e){switch(e){case FUN_TYPE.FUN_DUP_CAILIAO:DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_CAILIAO);break;case FUN_TYPE.FUN_DUP_TIAOZHAN:DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_CHALLENGE);break;case FUN_TYPE.FUN_DUP_SIXIANG:DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_SIXIANG);break;case FUN_TYPE.FUN_DUP_ZUDUI:DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_TEAM);break;case FUN_TYPE.FUN_DUP_ZHUFU:DataManager.getInstance().dupManager.onRequestDupInofMsg(DUP_TYPE.DUP_ZHUFU)}},t.prototype.getTargetPointByFuncId=function(e){var t=null,n=JsonModelManager.instance.getModelfunctionLv()[e];if(!n)return t;switch(n.param){case"RolePanel":t=this.mainbarUI.btn_role.localToGlobal();break;case"MagicMainViewPanel":t=this.mainbarUI.btn_huanling.localToGlobal();break;case"PetMainPanel":t=this.mainbarUI.btn_xianlv.localToGlobal();break;case"ForgePanel":t=this.mainbarUI.btn_forge.localToGlobal();break;case"BagPanel":t=this.mainbarUI.btn_bag.localToGlobal();break;case"TaskBasePanel":t=this.btn_jingjie.localToGlobal();break;case"CrossBarriersPanel":t=this.btn_boss.localToGlobal();break;case"YewaiPVPPanel":t=this.mainbarUI.btn_fenZheng.localToGlobal();break;case"DupPanel":t=this.dup_btn.localToGlobal();break;case"UnionMainCityPanel":t=this.union_btn.localToGlobal()}return t},t.prototype.checkChongBang=function(){this.showOrHiddenChongBang(this.mainbarUI.btn_role,!1),this.showOrHiddenChongBang(this.mainbarUI.btn_huanling,!1),this.showOrHiddenChongBang(this.mainbarUI.btn_xianlv,!1),this.showOrHiddenChongBang(this.mainbarUI.btn_forge,!1),this.showOrHiddenChongBang(this.bottom_72,!1),this.showOrHiddenChongBang(this.bottom_47,!1);var e=DataManager.getInstance().newactivitysManager.dabiao_model;e&&(e.type>=0&&e.type<=4?FunDefine.isFunOpen(DataManager.getInstance().playerManager.getBlessFunType(e.type))&&this.showOrHiddenChongBang(this.mainbarUI.btn_huanling,!0):e.type>=5&&e.type<=9?FunDefine.isFunOpen(DataManager.getInstance().playerManager.getBlessFunType(e.type))&&this.showOrHiddenChongBang(this.mainbarUI.btn_xianlv,!0):10==e.type&&FunDefine.isFunOpen(FUN_TYPE.FUN_HONGZHUANG)?this.showOrHiddenChongBang(this.bottom_72,!0):11==e.type&&FunDefine.isFunOpen(FUN_TYPE.FUN_SIXIANG)?this.showOrHiddenChongBang(this.mainbarUI.btn_role,!0):12==e.type&&FunDefine.isFunOpen(FUN_TYPE.FUN_PULSE)?this.showOrHiddenChongBang(this.mainbarUI.btn_role,!0):13==e.type&&FunDefine.isFunOpen(FUN_TYPE.FUN_PET_LEVEL)?this.showOrHiddenChongBang(this.bottom_47,!0):14==e.type&&FunDefine.isFunOpen(FUN_TYPE.FUN_BAOSHI)&&this.showOrHiddenChongBang(this.mainbarUI.btn_forge,!0))},t.prototype.showOrHiddenChongBang=function(e,t){e&&e.getChildByName("chongbangImg")&&(e.getChildByName("chongbangImg").visible=t)},t.prototype.registerChongBang=function(){this.addChongBang(this.mainbarUI.btn_role,new egret.Point(-5,-15)),this.addChongBang(this.mainbarUI.btn_huanling,new egret.Point(-5,-15)),this.addChongBang(this.mainbarUI.btn_xianlv,new egret.Point(-5,-15)),this.addChongBang(this.mainbarUI.btn_forge,new egret.Point(-5,-15)),this.addChongBang(this.bottom_72,new egret.Point(-5,-5)),this.addChongBang(this.bottom_47,new egret.Point(-5,-5))},t.prototype.addChongBang=function(e,t){},t}(eui.Component);__reflect(MainView.prototype,"MainView",["ISDKGiftContainer"]);var OpenFuncView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(0),n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.setTitle("function_open_title_png"),this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.itemlist.itemRenderer=FuncOpenItem,this.itemlist.itemRendererSkinName=skins.OpenFuncItemSkin,this.itemlist.percentWidth=135,this.itemlist.percentHeight=210,this.itemlist.useVirtualLayout=!0,this.scroll.viewport=this.itemlist,this.itemlist.selectedIndex=0;var t=JsonModelManager.instance.getModelfunctionLv();this.funcmodels=[];for(var n in t){var a=t[n];a.functionType>0&&this.funcmodels.push(a)}this.funcmodels.sort(function(e,t){return FunDefine.funOpenLevel(e.id)-FunDefine.funOpenLevel(t.id)<0?-1:1}),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.OpenFuncViewSkin},t.prototype.onRefresh=function(){this.itemlist.dataProvider=new eui.ArrayCollection(this.funcmodels),this.onUpdate()
},t.prototype.onUpdate=function(){for(var e=0;e<this.funcmodels.length;e++){var t=this.funcmodels[e];if(FunDefine.isFunOpen(t.id)&&!DataManager.getInstance().playerManager.getFunIsAwarded(t.id)){Tool.callbackTime(this.onSelectItem,this,100,e);break}}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.FUNCTION_REWARD_MESSAGE.toString(),this.onReciveRewardMsg,this),this.reward_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.itemlist.addEventListener(egret.Event.CHANGE,this.selectedItemHandler,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FUNCTION_REWARD_MESSAGE.toString(),this.onReciveRewardMsg,this),this.reward_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.itemlist.addEventListener(egret.Event.CHANGE,this.selectedItemHandler,this)},t.prototype.onReciveRewardMsg=function(){for(var e=0;e<this.itemlist.numChildren;e++){var t=this.itemlist.getChildAt(e);t.data=t.data}this.selectedItemHandler(),this.onUpdate()},t.prototype.onSelectItem=function(e){this.scroll.viewport.scrollV=210*Math.floor(e/4),this.itemlist.selectedIndex=e,this.selectedItemHandler()},t.prototype.selectedItemHandler=function(){this.reward_grp.removeChildren();var e=this.itemlist.selectedItem;if(e){for(var t=0;t<e.rewards.length;t++){var n=e.rewards[t],a=new GoodsInstance;a.onUpdate(n.type,n.id,0,n.quality,n.num),this.reward_grp.addChild(a)}FunDefine.isFunOpen(e.id)?DataManager.getInstance().playerManager.getFunIsAwarded(e.id)?this.reward_btn.enabled=!1:this.reward_btn.enabled=!0:this.reward_btn.enabled=!1}},t.prototype.onReward=function(){var e=this.itemlist.selectedItem;if(e){var t=new Message(MESSAGE_ID.FUNCTION_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)}},t}(BaseWindowPanel);__reflect(OpenFuncView.prototype,"OpenFuncView");var FuncOpenItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.condition_lab.text=FunDefine.getFunOpenDesc(e.id),this.func_icon_img.source=e.icon,this.desc_lab.text=e.desc,FunDefine.isFunOpen(e.id)?DataManager.getInstance().playerManager.getFunIsAwarded(e.id)?this.currentState="rewarded":this.currentState="open":this.currentState="unopen"},Object.defineProperty(t.prototype,"selected",{set:function(e){egret.superSetter(t,this,"selected",e),this.select_img.visible=e},enumerable:!0,configurable:!0}),t}(eui.ItemRenderer);__reflect(FuncOpenItem.prototype,"FuncOpenItem");var OpenFunTipsBar=function(e){function t(t){var n=e.call(this,t)||this;return n.autocloseTime=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.layergrp.x=-Globar_Pos.x,this.layergrp.width=size.width,this.layergrp.height=size.height,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.OpenFunTipsBarSkin},t.prototype.onRefresh=function(){this.button_grp.removeChildren();for(var e=Math.max(this._unopenFuns.length-3,0),t=this._unopenFuns.length-1;t>=e;t--){var n=this._unopenFuns[t],a=new eui.Button;a.skinName=skins.Fun_ButtonSkin,a.icon=n.icon,a.name=""+n.id,this.button_grp.addChild(a)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.layergrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.autocloseTime=6,Tool.addTimer(this.onAutoTimeDown,this,1e3)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.layergrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.sure_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),Tool.removeTimer(this.onAutoTimeDown,this,1e3)},t.prototype.onAutoTimeDown=function(){this.autocloseTime>0?(this.autocloseTime--,this.sure_btn.label=Language.instance.getText("sure")+("("+this.autocloseTime+")")):this.onTouch()},t.prototype.onShowWithParam=function(e){this._unopenFuns=e,this._unopenFuns&&this._unopenFuns.length>0&&this.onShow()},t.prototype.onTouch=function(){for(var e=0;e<this.button_grp.numChildren;e++){var t=this.button_grp.getElementAt(e),n=parseInt(t.name),a=new FuncBody(n),i=t.localToGlobal();a.x=i.x,a.y=i.y,this.owner.addFuncToDropLayer(a)}this.onHide()},t}(BaseWindowPanel);__reflect(OpenFunTipsBar.prototype,"OpenFunTipsBar");var OtherTargetBar=function(e){function t(){var t=e.call(this)||this;return t.progressBar=new eui.ProgressBar,t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.progressBar.skinName=skins.Other_HpProBar,t.progressBar.slideDuration=200,t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.addChild(this.progressBar)},t.prototype.onTarget=function(e,t,n){this.playerHead.setHead(t,n),this.progressBar.bossname_label.text=e.playerId==DataManager.getInstance().playerManager.player.id?DataManager.getInstance().playerManager.player.name:e.name},t.prototype.onUpdateProgress=function(e,t){void 0===t&&(t=0),t>0&&(this.progressBar.maximum=t),this.progressBar.value=Math.max(0,e),this.progressBar.hp_label.text=this.progressBar.value+"/"+this.progressBar.maximum},t.prototype.onRemove=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Group);__reflect(OtherTargetBar.prototype,"OtherTargetBar");var PlayerHeadFramePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PlayerHeadOptSkin},t.prototype.onInit=function(){this.setTitle("更换头像框"),this.setTitleErji("头像框"),e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.need),this.onInitHead(),this.onRefresh();var t=this.createRedPoint();t.register(this.btn_up,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkRedPointHeadFrameUp")},t.prototype.setTitleErji=function(e){this.basicerji.label_title.text=e},t.prototype.onInitHead=function(){DataManager.getInstance().playerManager.player;this.itemList=[];var e=JsonModelManager.instance.getModeltouxiangkuang();for(var t in e){var n=new HeadFrameItem(this,e[t]);this.itemList.push(n),n.update()}this.itemList.sort(function(e,t){return e.model.order-t.model.order});for(var a=0;a<this.itemList.length;a++)this.groupList.addChild(this.itemList[a]);this.scroller.verticalScrollBar.visible=!1},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.erjiPanel.visible=!1,this.need.addEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),this.jihuoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.closeerji.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeErJiPanel,this),this.btn_change.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChange,this),this.btn_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE.toString(),this.onCallbackUp,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.need.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),this.jihuoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.closeerji.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeErJiPanel,this),this.btn_change.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChange,this),this.btn_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE.toString(),this.onCallbackUp,this)},t.prototype.onTouchUp=function(){var e=DataManager.getInstance().playerManager.player.getHeadFrameLevel(0),t=JsonModelManager.instance.getModeltouxiangkuangshengji()[e];if(t){var n=t.cost;if(GameCommon.getInstance().onCheckItemConsume(n.id,n.num)){var a=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE);this.upItem=null,a.setByte(0),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onTouchChange=function(){if(this.currItem){var e=DataManager.getInstance().playerManager.player;if(e.headFrameIndex!=this.currItem.model.id){var t=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE);t.setByte(this.currItem.model.id),GameCommon.getInstance().sendMsgToServer(t)}}},t.prototype.onCallbackUp=function(){this.onRefresh(),this.upItem&&(this.updateUpPanel(this.upItem),GameCommon.getInstance().addAnimation("tujianshengji",new egret.Point(320,390),this.erjiPanel,1))},t.prototype.updateUpPanel=function(e){var n=DataManager.getInstance().playerManager.player,a=e.model;this.playerHeadEJ.setHead(n.headIndex,a.id);var i=t.getLevel(a.id);this.lbLevelEJ.text=i.toString(),t.getLevel(a.id)>0?this.jihuoBtn.labelDisplay.text="进阶":this.jihuoBtn.labelDisplay.text="激活",this.consumItemEJ.setConsume(a.cost.type,a.cost.id,a.cost.num);for(var o="",r="",s=a.attrAry,h=0;4>h;h++)o.length>0&&(o+="\n"),o+=GameDefine.Attr_FontName[h]+"：+"+s[h]*i,r.length>0&&(r+="\n"),r+=GameDefine.Attr_FontName[h]+"：+"+s[h]*(i+1);this.curProerji.text=o,this.nextProerji.text=r},t.prototype.setUpItem=function(e){this.upItem=e,this.updateUpPanel(e),this.erjiPanel.visible=!0},t.prototype.closeErJiPanel=function(){this.erjiPanel.visible=!1},t.prototype.jihuoMethod=function(){if(this.upItem){var e=DataManager.getInstance().playerManager.player,t=this.upItem.model;if(e.coatardLv<t.tiaojian)return void GameCommon.getInstance().addAlert("error_tips_99");var n=t.cost;if(!GameCommon.getInstance().onCheckItemConsume(n.id,n.num))return;var a=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_UP_MESSAGE);a.setByte(t.id),GameCommon.getInstance().sendMsgToServer(a)}},t.prototype.omTouchHQTJ=function(){this.upItem&&GameCommon.getInstance().onShowFastBuy(this.upItem.model.cost.id)},t.getLevel=function(e){return DataManager.getInstance().playerManager.player.getHeadFrameLevel(e)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this);var t=DataManager.getInstance().playerManager.player;this.hero_headIcon.setHead(),this.onUpdateHead(t),this.updateAttri(t)},t.prototype.updateAttri=function(e){var t=e.getHeadFrameAttribute();this.powerbar.power=GameCommon.calculationFighting(t);for(var n="",a=0;4>a;a++)n+=GameDefine.Attr_FontName[a]+"：+"+t[a]+"\n";this.currPro.text=n;var i=e.getHeadFrameLevel(0);this.currProTitle.text=i+"级属性",this.nextProTitle.text=i+1+"级属性";var o=JsonModelManager.instance.getModeltouxiangkuangshengji()[i];if(o){for(var r=e.getHeadFrameAttribute(o),s="",a=0;4>a;a++)s+=GameDefine.Attr_FontName[a]+"：+"+r[a]+"\n";this.nextPro.text=s,this.groupNext.visible=!0;var h=o.cost;this.currency.setConsume(h.type,h.id,h.num),this.currency.visible=!0}else this.groupNext.visible=!1,this.currency.visible=!1,this.btn_up.visible=!1,this.btn_change.horizontalCenter="0"},t.prototype.onUpdateHead=function(e){for(var t=0;t<this.itemList.length;++t)this.itemList[t].update(),this.itemList[t].model.id==e.headFrameIndex&&this.setCurrItem(this.itemList[t])},t.prototype.setCurrItem=function(e){this.currItem&&(this.currItem.setSelect(!1),this.currItem=null),e&&(this.currItem=e,this.currItem.setSelect(!0))},t}(BaseWindowPanel);__reflect(PlayerHeadFramePanel.prototype,"PlayerHeadFramePanel");var HeadFrameItem=function(e){function t(t,n){var a=e.call(this)||this;a.systemOptPanel=t,a.model=n,a.skinName=skins.IconSettingSkin,a.selectEffct.visible=a.suo.visible=!1,a.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,a.onEventBtn,a),a.playerHead.addClickListener(a.onTouchIcon,a);var i=t.createRedPoint();return i.register(a.btn,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkRedPointHeadModel",n),a}return __extends(t,e),t.prototype.update=function(){var e=DataManager.getInstance().playerManager.player;this.playerHead.setHead(e.headIndex,this.model.id),this.currency.visible=this.lbCount.visible=!1,this.isJingJie=this.isCost=!0;var t=PlayerHeadFramePanel.getLevel(this.model.id);this.lbLevel.text=t.toString();var n=this.model.cost;n?(this.currency.setConsume(n.type,n.id,n.num),this.currency.visible=!0,this.isCost=DataManager.getInstance().bagManager.getGoodsThingNumById(n.id)>=n.num,t>0?this.btn.labelDisplay.text="进阶":this.btn.labelDisplay.text="激活",this.btn.visible=!0):(this.imgLevel.visible=this.lbLevel.visible=!1,this.btn.visible=!1,this.isJingJie=e.coatardLv>=this.model.tiaojian,this.isJingJie||(this.lbCount.text=Language.instance.getText("jingjie")+"："+e.coatardLv+"/"+this.model.tiaojian,this.lbCount.visible=!0)),this.suo.visible=0==t&&!this.isJingJie},t.prototype.onEventBtn=function(){this.systemOptPanel.setUpItem(this)},t.prototype.setSelect=function(e){this.selectEffct.visible=e},t.prototype.onTouchIcon=function(){DataManager.getInstance().playerManager.player.getHeadFrameLevel(this.model.id)>0||!this.model.cost?this.systemOptPanel.setCurrItem(this):GameCommon.getInstance().addAlert("头像框未激活！")},t}(eui.Component);__reflect(HeadFrameItem.prototype,"HeadFrameItem");var PlayerSettingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(2),n.COST_ITEM_ID=359,n.priority=PANEL_HIERARCHY_TYPE.II,n.isUpdate=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PlayerSettingSkin},t.prototype.onInit=function(){this.onRefresh(),this.points[0].register(this.changeIconBtn,new egret.Point(165,5),DataManager.getInstance().playerManager,"checkRedPointHead"),this.points[1].register(this.changeFrameBtn,new egret.Point(165,5),DataManager.getInstance().playerManager,"checkRedPointHeadFrame")},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(this.COST_ITEM_ID)},t.prototype.onRefresh=function(){this.consumItem.setConsume(GOODS_TYPE.ITEM,this.COST_ITEM_ID),this.userName.text=DataManager.getInstance().playerManager.player.name,this.userId.text="ID:"+DataManager.getInstance().playerManager.player.id,this.powerbar.power=DataManager.getInstance().playerManager.player.playerTotalPower,this.unionName.text=DataManager.getInstance().unionManager.unionInfo?"仙盟:"+DataManager.getInstance().unionManager.unionInfo.info.name:"仙盟:暂无",this.unionLv.text=DataManager.getInstance().unionManager.unionInfo?"仙盟等级:Lv."+DataManager.getInstance().unionManager.unionInfo.info.level:"仙盟等级:Lv.0",this.leagueBossName.text=DataManager.getInstance().unionManager.unionInfo?"盟主:"+DataManager.getInstance().unionManager.unionInfo.info.wangName:"盟主:暂无",this.userLv.text=Language.instance.getText("dengji")+"："+DataManager.getInstance().playerManager.player.coatardLv+"转"+DataManager.getInstance().playerManager.player.level+"级",this.userLvFZ.text=Language.instance.getText("zhangonglv")+"："+DataManager.getInstance().pvpManager.getModelCurr().lv+"级";var e=DataManager.getInstance().localArenaManager.localArenaData;e.rank>0?this.self_rank_num_label.text="竞技排名:"+e.rank:this.self_rank_num_label.text="竞技排名:未上榜",this.yewaiNum.text="野外关卡:第"+GameFight.getInstance().yewai_waveIndex+"关",this.playerHead.setHead()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.setTitle("设 置"),this.changeNameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowNameChange,this),this.changeIconBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowIconChange,this),this.changeFrameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowFrameChange,this),this.cb_sound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSoundCkBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE.toString(),this.onRefresh,this),this.updateSound()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.changeNameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowNameChange,this),this.changeIconBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowIconChange,this),this.changeFrameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowFrameChange,this),this.cb_sound.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSoundCkBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_FRAME_CHANGE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_NAME_MESSAGE.toString(),this.onRefresh,this)},t.prototype.updateSound=function(){this.updateUI(GameSetting.getLocalSetting(GameSetting.SOUND_MUTE))},t.prototype.onTouchSoundCkBtn=function(){var e=SoundFactory.soundOpen;this.updateUI(e),GameSetting.setLocalSave(GameSetting.SOUND_MUTE,e),SoundFactory.playMusic(SoundDefine.SOUND_BGM)},t.prototype.updateUI=function(e){this.cb_sound.selected=e},t.prototype.onShowNameChange=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ChangeNamePanel")},t.prototype.onShowIconChange=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"SystemOptPanel")},t.prototype.onShowFrameChange=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PlayerHeadFramePanel")},t}(BaseWindowPanel);__reflect(PlayerSettingPanel.prototype,"PlayerSettingPanel");var SamsaraFuncBar=function(e){function t(){var t=e.call(this)||this;return t._startRebornTime=0,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(){this.skinName=skins.SamsaraOptBarSkin},t.prototype.onLoadComplete=function(){this.onloadComp=!0,this.onStopSamsaraRebornTime()},t.prototype.onRegistSamsaraBar=function(){this.onloadComp&&(this.samsara_reborn_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSamraraRebornBtn,this),this.samsara_shield_cb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectShiledCB,this),this.samsara_reborn_cb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSamsaraAutoReborn,this))},t.prototype.onRemoveSamsaraBar=function(){this.onloadComp&&(this.onStopSamsaraRebornTime(),this.samsara_reborn_cb.selected=!1,this.samsara_shield_cb.selected=!1,this.samsara_reborn_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSamraraRebornBtn,this),this.samsara_shield_cb.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectShiledCB,this),this.samsara_reborn_cb.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchSamsaraAutoReborn,this))},t.prototype.onStartSamsaraRebornTime=function(e){if(void 0===e&&(e=0),this.samsara_reborn_cb.selected){if(DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.DIAMOND)>=20)return void GameFight.getInstance().onBossFightReborn(!0,!0);this.samsara_reborn_cb.selected=!1}0==this._startRebornTime&&(this.samrama_reborn_group.visible=!0,this._startRebornTime=1e3*e+egret.getTimer(),Tool.addTimer(this.onSamsaraRebornTimeDown,this,1e3))},t.prototype.onSamsaraRebornTimeDown=function(){var e=Math.ceil((this._startRebornTime-egret.getTimer())/1e3);0>=e?(this.onStopSamsaraRebornTime(),GameFight.getInstance().onBossFightReborn(!1)):this.samsara_reborn_time.text="复活倒计时："+e+"秒"},t.prototype.onStopSamsaraRebornTime=function(){this._startRebornTime=0,this.samrama_reborn_group.visible=!1,this.samsara_reborn_time.text="",Tool.removeTimer(this.onSamsaraRebornTimeDown,this,1e3)},t.prototype.onTouchSamraraRebornBtn=function(){GameFight.getInstance().onBossFightReborn()},t.prototype.onTouchSamsaraAutoReborn=function(){DataManager.getInstance().playerManager.player.getICurrency(GOODS_TYPE.DIAMOND)<20&&(this.samsara_reborn_cb.selected=!1,GameCommon.getInstance().addAlert("error_tips_2"))},t.prototype.onSelectShiledCB=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.SHIELD_OTHERBODY_EVENT),this.samsara_shield_cb.selected)},t}(eui.Component);__reflect(SamsaraFuncBar.prototype,"SamsaraFuncBar");var StoryPanel=function(e){function t(){var t=e.call(this)||this;return t.hero_X=0,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.StoryPanelSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.height=size.height},Object.defineProperty(t.prototype,"player",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.onshowStroy=function(e,t){void 0===t&&(t=null),this.onResize(),this.storyTalks=e,this.targetData=t;var n=(this.player.sex==SEX_TYPE.MALE?"nan":"nv",DataManager.getInstance().blessManager),a=n.getPlayerBlessData(BLESS_TYPE.CLOTHES);n.getBlessModelByData(a);if(t){var i=ModelManager.getInstance().getModelFigher(t.modelid);if(t.bodyType==BODY_TYPE.NPC){var o=LoadManager.getInstance().getNpcResUrl(i.avata,"stand",Direction.DOWN+"");this.targetBody?this.targetBody.onUpdateRes(o,-1,Direction.DOWN):this.targetBody=new BodyAnimation(o,-1,Direction.DOWN)}else this.targetBody=GameCommon.getInstance().getMonsterBody(this.targetBody,t.modelid,Direction.DOWN,"stand");this.targetBody.x=i.width/2}this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.continueHandler,this),this.contiune_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFinish,this),this.startPlayTalk()},t.prototype.startPlayTalk=function(){if(this.body_anim_grp.removeChildren(),0==this.storyTalks.length)return void this.onFinish();var e=this.storyTalks.shift();e?(this.bodyTalkStr=e.talkwords,0==e.self&&this.targetData?(this.body_anim_grp.addChild(this.targetBody),this.targetBody.playNum=-1,this.body_name_lab.text=this.targetData.model.name+"："):(this.body_anim_grp.addChild(this.selfBody),this.selfBody.playNum=-1,this.body_name_lab.text=Language.instance.getText("I")+"："),this.body_anim_grp.alpha=0,egret.Tween.get(this.body_anim_grp).to({alpha:1},300),this.currContIdx=0,this.autoContiune=null,this.talk_content_lab.text="",Tool.addTimer(this.storytextTimer,this,10)):this.startPlayTalk()},t.prototype.storytextTimer=function(){Tool.isNumber(this.autoContiune)?(this.autoContiune--,this.autoContiune<=0&&(Tool.removeTimer(this.storytextTimer,this,10),this.startPlayTalk())):this.currContIdx==this.bodyTalkStr.length?this.autoContiune=500:this.talk_content_lab.text+=this.bodyTalkStr.slice(this.currContIdx++,this.currContIdx)},t.prototype.continueHandler=function(){Tool.removeTimer(this.storytextTimer,this,10),this.autoContiune=null,this.currContIdx<this.bodyTalkStr.length?(this.talk_content_lab.text=this.bodyTalkStr,this.currContIdx=this.bodyTalkStr.length):this.startPlayTalk()},t.prototype.onHide=function(){this.targetBody&&(this.targetBody.onDestroy(),this.targetBody=null),this.selfBody&&(this.selfBody.onDestroy(),this.selfBody=null),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.continueHandler,this),this.contiune_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFinish,this),Tool.removeTimer(this.storytextTimer,this,10),this.parent&&this.parent.removeChild(this)},t.prototype.onFinish=function(){GameFight.getInstance().onRemoveStory()},t.prototype.onResize=function(){this.back_img.width=size.width+10},t}(eui.Component);__reflect(StoryPanel.prototype,"StoryPanel");var STORY_TYPE;!function(e){e[e.MONSTER=0]="MONSTER",e[e.BOSS=1]="BOSS",e[e.FINISH=2]="FINISH"}(STORY_TYPE||(STORY_TYPE={}));var SystemOptPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PlayerHeadOptSkin},t.prototype.onInit=function(){this.setTitle("更换头像"),this.setTitleErji("头像"),e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.need),this.onInitHead(),this.onRefresh();var t=this.createRedPoint();t.register(this.btn_up,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkRedPointHeadUp")},t.prototype.setTitleErji=function(e){this.basicerji.label_title.text=e},t.prototype.onInitHead=function(){var e=DataManager.getInstance().playerManager.player;this.itemList=[];var t=JsonModelManager.instance.getModeltouxiang();for(var n in t){var a=t[n];if(a.sex==e.sex||2==a.sex){var i=new PlayerIconItem(this,a);this.itemList.push(i),i.update()}}this.itemList.sort(function(e,t){return e.model.order-t.model.order});for(var o=0;o<this.itemList.length;o++)this.groupList.addChild(this.itemList[o]);this.scroller.verticalScrollBar.visible=!1},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.erjiPanel.visible=!1,this.need.addEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),this.jihuoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.closeerji.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeErJiPanel,this),this.btn_change.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChange,this),this.btn_up.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_UP_MESSAGE.toString(),this.onCallbackUp,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.need.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),this.jihuoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.closeerji.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeErJiPanel,this),this.btn_change.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChange,this),this.btn_up.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OPT_PLAYER_HEAD_UP_MESSAGE.toString(),this.onCallbackUp,this)},t.prototype.onTouchUp=function(){var e=DataManager.getInstance().playerManager.player.getHeadLevel(0),t=JsonModelManager.instance.getModeltouxiangshengji()[e];if(t){var n=t.cost;if(GameCommon.getInstance().onCheckItemConsume(n.id,n.num)){this.upItem=null;var a=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_UP_MESSAGE);a.setByte(0),GameCommon.getInstance().sendMsgToServer(a)}}},t.prototype.onTouchChange=function(){if(this.currItem){var e=DataManager.getInstance().playerManager.player;if(e.headIndex!=this.currItem.model.id){var t=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_MESSAGE);t.setByte(this.currItem.model.id),GameCommon.getInstance().sendMsgToServer(t)}}},t.prototype.onCallbackUp=function(){this.onRefresh(),this.upItem&&(this.updateUpPanel(this.upItem),GameCommon.getInstance().addAnimation("tujianshengji",new egret.Point(300,410),this.erjiPanel,1))},t.prototype.updateUpPanel=function(e){var n=e.model;this.playerHeadEJ.setHead(n.id);var a=t.getLevel(n.id);this.lbLevelEJ.text=a.toString(),a>0?this.jihuoBtn.labelDisplay.text="进阶":this.jihuoBtn.labelDisplay.text="激活",this.consumItemEJ.setConsume(n.cost.type,n.cost.id,n.cost.num);for(var i="",o="",r=n.attrAry,s=0;4>s;s++)i.length>0&&(i+="\n"),i+=GameDefine.Attr_FontName[s]+"：+"+r[s]*a,o.length>0&&(o+="\n"),o+=GameDefine.Attr_FontName[s]+"：+"+r[s]*(a+1);this.curProerji.text=i,this.nextProerji.text=o},t.prototype.setUpItem=function(e){this.upItem=e,this.updateUpPanel(e),this.erjiPanel.visible=!0},t.prototype.closeErJiPanel=function(){this.erjiPanel.visible=!1},t.prototype.jihuoMethod=function(){if(this.upItem){var e=DataManager.getInstance().playerManager.player,t=this.upItem.model;if(e.coatardLv<t.tiaojian)return void GameCommon.getInstance().addAlert("error_tips_99");var n=t.cost;if(!GameCommon.getInstance().onCheckItemConsume(n.id,n.num))return;var a=new Message(MESSAGE_ID.OPT_PLAYER_HEAD_UP_MESSAGE);a.setByte(t.id),GameCommon.getInstance().sendMsgToServer(a)}},t.prototype.omTouchHQTJ=function(){this.upItem&&GameCommon.getInstance().onShowFastBuy(this.upItem.model.cost.id)},t.getLevel=function(e){return DataManager.getInstance().playerManager.player.getHeadLevel(e)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this);var t=DataManager.getInstance().playerManager.player;this.hero_headIcon.setHead(),this.onUpdateHead(t),this.updateAttri(t)},t.prototype.updateAttri=function(e){var t=e.getHeadAttribute();this.powerbar.power=GameCommon.calculationFighting(t);for(var n="",a=0;4>a;a++)n+=GameDefine.Attr_FontName[a]+"：+"+t[a]+"\n";this.currPro.text=n;var i=e.getHeadLevel(0);this.currProTitle.text=i+"级属性",this.nextProTitle.text=i+1+"级属性";var o=JsonModelManager.instance.getModeltouxiangshengji()[i];if(o){for(var r=e.getHeadAttribute(o),s="",a=0;4>a;a++)s+=GameDefine.Attr_FontName[a]+"：+"+r[a]+"\n";this.nextPro.text=s,this.groupNext.visible=!0;var h=o.cost;this.currency.setConsume(h.type,h.id,h.num),this.currency.visible=!0}else this.groupNext.visible=!1,this.currency.visible=!1,this.btn_up.visible=!1,this.btn_change.horizontalCenter="0"},t.prototype.onUpdateHead=function(e){for(var t=0;t<this.itemList.length;++t)this.itemList[t].update(),this.itemList[t].model.id==e.headIndex&&this.setCurrItem(this.itemList[t])},t.prototype.setCurrItem=function(e){this.currItem&&(this.currItem.setSelect(!1),this.currItem=null),e&&(this.currItem=e,this.currItem.setSelect(!0))},t}(BaseWindowPanel);__reflect(SystemOptPanel.prototype,"SystemOptPanel");var PlayerIconItem=function(e){function t(t,n){var a=e.call(this)||this;a.systemOptPanel=t,a.model=n,a.skinName=skins.IconSettingSkin,a.selectEffct.visible=a.suo.visible=!1,a.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,a.onEventBtn,a),a.playerHead.addClickListener(a.onTouchIcon,a);var i=t.createRedPoint();return i.register(a.btn,new egret.Point(150,-5),DataManager.getInstance().playerManager,"checkRedPointHeadModel",n),a}return __extends(t,e),t.prototype.update=function(){var e=DataManager.getInstance().playerManager.player;this.playerHead.setHead(this.model.id),this.currency.visible=this.lbCount.visible=!1,this.isJingJie=this.isCost=!0;var t=SystemOptPanel.getLevel(this.model.id);this.lbLevel.text=t.toString();var n=this.model.cost;n?(this.currency.setConsume(n.type,n.id,n.num),this.currency.visible=!0,this.isCost=DataManager.getInstance().bagManager.getGoodsThingNumById(n.id)>=n.num,t>0?this.btn.labelDisplay.text="进阶":this.btn.labelDisplay.text="激活",this.btn.visible=!0):(this.imgLevel.visible=this.lbLevel.visible=!1,this.btn.visible=!1,this.isJingJie=e.coatardLv>=this.model.tiaojian,this.isJingJie||(this.lbCount.text=Language.instance.getText("jingjie")+"："+e.coatardLv+"/"+this.model.tiaojian,this.lbCount.visible=!0)),this.suo.visible=0==t&&!this.isJingJie},t.prototype.onEventBtn=function(){this.systemOptPanel.setUpItem(this)},t.prototype.setSelect=function(e){this.selectEffct.visible=e},t.prototype.onTouchIcon=function(){DataManager.getInstance().playerManager.player.getHeadLevel(this.model.id)>0||!this.model.cost?this.systemOptPanel.setCurrItem(this):GameCommon.getInstance().addAlert("头像未激活！")},t}(eui.Component);__reflect(PlayerIconItem.prototype,"PlayerIconItem");var TimeLimitPlayPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.item_list=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TimeLimitPlayPanelSkin},t.prototype.onInit=function(){var t=JsonModelManager.instance.getModeldingshihuodong();for(var n in t){var a=t[n],i=new TimeLimitPlayItem;i.onUpdate(a),this.item_list.push(i)}this.showpanel(),e.prototype.onInit.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.showpanel()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.item_list.length;t++){var n=this.item_list[t];
n.go_to_panel.addEventListener(egret.TouchEvent.TOUCH_TAP,n.jumpTO,n)}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.item_list.length;t++){var n=this.item_list[t];n.go_to_panel.removeEventListener(egret.TouchEvent.TOUCH_TAP,n.jumpTO,n)}},t.prototype.showpanel=function(){var e=this;this.item_group.removeChildren();for(var t=JsonModelManager.instance.getModeldingshihuodong(),n=0;n<this.item_list.length;n++)this.item_list[n].onUpdate(t[this.item_list[n].idx]);this.item_list=this.item_list.sort(function(t,n){return e.itemSort(t,n)});for(var n=0;n<this.item_list.length;n++)this.item_group.addChild(this.item_list[n])},t.prototype.itemSort=function(e,t){return e.isOpen>t.isOpen?-1:e.isOpen==t.isOpen&&e.order<t.order?-1:1},t}(BaseWindowPanel);__reflect(TimeLimitPlayPanel.prototype,"TimeLimitPlayPanel");var TimeLimitPlayItem=function(e){function t(){var t=e.call(this)||this;return t.day=["周日","周一","周二","周三","周四","周五","周六","周日"],t.bg=["tmlt_ttjjc_bg","tmlt_jjzx_bg","tmlt_xmmj_bg","tmlt_xmz_bg"],t.title=["tmlt_ttjjc","tmlt_jjzx","tmlt_xmmj","tmlt_xmz"],t.isOpen=0,t.once(egret.Event.COMPLETE,t.onInit,t),t.skinName=skins.TimeLimitItemSkin,t}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.onUpdate=function(e){this.idx=e.id,this.order=e.order,this.isOpen=0,this.item_name.source=this.title[this.idx]+"_png",this.item_bg.source=this.bg[this.idx]+"_jpg";var t=e.startTime,n=e.endTime;this.goType=e.goType;var a=parseInt(t.split("#")[1]),i=t.split("#")[0],o=n.split("#")[0];this.isOpen=this.isOpenMthon(a,i,o),this.isOpen?this.go_to_panel.enabled=!0:this.go_to_panel.enabled=!1,0>a?this.item_time.text="每天"+i+"--"+o:this.item_time.text="每"+this.day[a]+i+"--"+o},t.prototype.jumpTO=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.goType)},t.prototype.isOpenMthon=function(e,t,n){var a=DataManager.getInstance().playerManager.player.curServerTime,i=new Date,o=new Date,r=t.split(":"),s=n.split(":");if(i.setHours(parseInt(r[0])),i.setMinutes(parseInt(r[1])),o.setHours(parseInt(s[0])),o.setMinutes(parseInt(s[1])),a<o.getTime()&&a>i.getTime()){if(0>e)return 1;if(e>=0&&e-1==(new Date).getDay())return 1}return 0},t}(eui.ItemRenderer);__reflect(TimeLimitPlayItem.prototype,"TimeLimitPlayItem");var Welcome=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.Welcome},t.prototype.onRefresh=function(){this.reward_grp.removeChildren();var e=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.WELCOME_REWARDS));if(e)for(var t=0;t<e.length;t++){var n=new GoodsInstance;n.onUpdate(e[t].type,e[t].id),this.reward_grp.addChild(n)}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouch=function(){this.onHide()},t}(BaseWindowPanel);__reflect(Welcome.prototype,"Welcome");var OffLineExpPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.OffLineExpPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("离线收益"),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().playerManager.offlineData,t=e.offTime/1e3,n=Math.floor(t/60/60);t-=3600*n;var a=Math.floor(t/60);this.offline_time_desc.text=n+"小时"+a+"分钟(最多累计24小时收益)";var i=JsonModelManager.instance.getModelyueka()[1],o=.1,r=DataManager.getInstance().monthCardManager.card[CARD_TYPE.MONTH];r&&r.param>0?(this.yueka0.text=i.name+"+"+GameCommon.getInstance().getFormatNumberShow(Math.floor(e.moneynum*o)),this.yueka1.text=i.name+"+"+GameCommon.getInstance().getFormatNumberShow(Math.floor(e.exp*o)),this.yueka0.textColor=this.yueka1.textColor=15191930):(this.yueka0.text=this.yueka1.text=i.name+"+"+100*o+"%",this.yueka0.textColor=this.yueka1.textColor=13421772);var s=JsonModelManager.instance.getModelyueka()[2],h=.1;r=DataManager.getInstance().monthCardManager.card[CARD_TYPE.LIFELONG],r&&r.param>0?(this.yuekazz0.text=s.name+"+"+GameCommon.getInstance().getFormatNumberShow(Math.floor(e.moneynum*h)),this.yuekazz1.text=s.name+"+"+GameCommon.getInstance().getFormatNumberShow(Math.floor(e.exp*h)),this.yuekazz0.textColor=this.yuekazz1.textColor=15191930):(this.yuekazz0.text=this.yuekazz1.text=s.name+"+"+100*h+"%",this.yuekazz0.textColor=this.yuekazz1.textColor=13421772);var l=0;DataManager.getInstance().playerManager.player.isLegendActive(4)&&(l+=.05),DataManager.getInstance().playerManager.player.isLegendActive(6)&&(l+=.05);var g=0;DataManager.getInstance().playerManager.player.isLegendActive(5)&&(g+=.05),this.label_r0.text=""+e.moneynum,this.label_r1.text=""+e.exp,this.label_r2.text=String(e.equinum+e.equinumdele),this.chushou.text="自动回收:"+e.equinumdele+"件，总计:"+e.moneyRongLian+Language.instance.getText("currency4");var c="",p=Tool.getHtmlColorStr(e.exp.toString(),"28e828");p=Tool.getHtmlColorStr((2*e.exp).toString(),"28e828"),r&&r.param>0&&(c=Tool.getHtmlColorStr((2*e.anima).toString(),"28e828"),c=",灵气"+c+"点")},t.prototype.onBuyMonthCard=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("HallWelfarePanel",2))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OFFLINE_EXP_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACTIVITY_MONTHCARD_MESSAGE.toString(),this.onRefresh,this),this.btn_buy_yueka.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyMonthCard,this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OFFLINE_EXP_REWARD.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACTIVITY_MONTHCARD_MESSAGE.toString(),this.onRefresh,this),this.btn_buy_yueka.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyMonthCard,this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(OffLineExpPanel.prototype,"OffLineExpPanel");var BarText=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.Attr_Item_Skin3,t}return __extends(t,e),t.prototype.updateAttr=function(e,t,n){this.attr_name.text=GameDefine.Attr_FontName[e],this.attr_value_label.text="+"+t,n&&(this.attr_value_label.textColor=n)},t}(eui.Component);__reflect(BarText.prototype,"BarText");var PetEnchantPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.currPetID=1,n.animPos=new egret.Point(344,440),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PetEnchantPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currPetID!=t&&(this.currPetID=t,this.onRefresh())},t.prototype.models=function(e){var t=JsonModelManager.instance.getModelchongwupeiyang();for(var n in t)if(t[n].jieduan>e)return t[n]},t.prototype.onRefresh=function(){this._data=DataManager.getInstance().playerManager.player.petData,this._data.lv;var e=this._data.gradeModel;this.lab_name.text=e.jieduan+"阶",this.pet_avatar_grp.removeChildren(),GameCommon.getInstance().addAnimation("petbig"+e.waixing1,null,this.pet_avatar_grp,-1),this.updateInfo()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_diamond_random.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomDiamond,this),this.btn_diamond_randomTen.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomDiamondTen,this),this.btn_save.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSave,this),this.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCancel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_TRAIN_RANDOM_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_TRAIN_CHANGE_MESSAGE.toString(),this.update,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_diamond_random.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomDiamond,this),this.btn_diamond_randomTen.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnRandomDiamondTen,this),this.btn_save.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSave,this),this.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCancel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_TRAIN_RANDOM_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_TRAIN_CHANGE_MESSAGE.toString(),this.update,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchBtnRandomDiamondTen=function(){DataManager.getInstance().petManager.sendRandomMessage(!0,1),this.btn_diamond_random.enabled=!1,this.btn_diamond_randomTen.enabled=!1},t.prototype.onTouchBtnRandomDiamond=function(){DataManager.getInstance().petManager.sendRandomMessage(!1,1),this.btn_diamond_random.enabled=!1,this.btn_diamond_randomTen.enabled=!1},t.prototype.onTouchCheckboxDiamond=function(){},t.prototype.onTouchBtnSave=function(){var e=new Message(MESSAGE_ID.PET_TRAIN_CHANGE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.btn_diamond_random.enabled=!0,this.btn_diamond_randomTen.enabled=!0},t.prototype.onTouchBtnCancel=function(){var e=[{text:Language.instance.getText("longhunconfirm")}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,function(){this.cancel()},this)))},t.prototype.cancel=function(){var e=new Message(MESSAGE_ID.PET_TRAIN_CANCEL_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.update(),this.btn_diamond_random.enabled=!0,this.btn_diamond_randomTen.enabled=!0},t.prototype.onTouchGet=function(){GameCommon.getInstance().onShowFastBuy(GameDefine.PET_GOODS_ID,GOODS_TYPE.ITEM)},t.prototype.updateInfo=function(){var e,t=this.models(this._data.grade);this._data.gradeModel;if(0==this.attributeLayer.numChildren)for(var n=0;4>n;n++)e=new PetSoulItem,e.update(t,n,this._data.proArr[n],DataManager.getInstance().petManager.curRandomValue[n]),this.attributeLayer.addChild(e);else for(var n=0;4>n;n++)e=this.attributeLayer.getChildAt(n),e.update(t,n,this._data.proArr[n],DataManager.getInstance().petManager.curRandomValue[n]);this.consume_diamond1.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(GOODS_TYPE.GOLD,0,10*GameDefine.PET_DIAMOND_NUM)),this.consume_diamond.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(GOODS_TYPE.GOLD,0,GameDefine.PET_DIAMOND_NUM)),DataManager.getInstance().petManager.curRandomValue.length>0?(this.btn_cancel.visible=!0,this.btn_save.visible=!0,this.consume_diamond1.visible=!1,this.consume_diamond.visible=!1,this.btn_diamond_random.visible=!1,this.btn_diamond_randomTen.visible=!1):(this.btn_cancel.visible=!1,this.btn_save.visible=!1,this.btn_diamond_random.visible=!0,this.btn_diamond_random.enabled=!0,this.btn_diamond_randomTen.visible=!0,this.consume_diamond1.visible=!0,this.consume_diamond.visible=!0),this.onUpdatePlayerPower()},t.prototype.update=function(){DataManager.getInstance().petManager.clear(),this.onRefresh(),this.getPlayer().updataAttribute()},t.prototype.onUpdatePlayerPower=function(){this.power.power=DataManager.getInstance().petManager.power+""},t}(BaseTabView);__reflect(PetEnchantPanel.prototype,"PetEnchantPanel");var PetSoulItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.PetSoulItemSkin,t}return __extends(t,e),t.prototype.update=function(e,t,n,a){this.proName.text=GameDefine.Attr_FontName[t];var i=0;null!=e&&(i=e.attrAry[t]),this.progress_cur_value.value=n,this.progress_cur_value.maximum=i,a&&0!=a?(this.attr_title_img.visible=!0,a>0?(this.attr_title_img.source="pet_upIcon_png",this.label_change_value.text="+"+a,this.label_change_value.textColor=GameDefine.Attr_After_Color):(this.label_change_value.text=""+a,this.label_change_value.textColor=16711680,this.attr_title_img.source="pet_downIcon_png")):(this.attr_title_img.visible=!1,this.label_change_value.text="")},t}(eui.Component);__reflect(PetSoulItem.prototype,"PetSoulItem");var PetLingDanPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n.indexId=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicLingDanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.blessType=e,this.models=JsonModelManager.instance.getModelchongwuDan()[2],this.indexId=0,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.updateAvatarAnim=function(){for(this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var e=this.avatar_grp.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.avatar_grp.removeChild(e)}var t=DataManager.getInstance().playerManager.player.petData,n=t.gradeModel;GameCommon.getInstance().addAnimation("petbig"+n.waixing1,null,this.avatar_grp,-1),this.avatar_grp.y=270,this.avatar_grp.scaleX=.8,this.avatar_grp.scaleY=.8},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){this.updateAvatarAnim(),this.onShowInfo(this.indexId)},t.prototype.onShowInfo=function(e){this.titleName.text=this.models.name,this.indexId=e;var t=this.models;this.skillName.text=t.name;var n=DataManager.getInstance().playerManager.player.petData,a=n.danDic[2],i=(t.attrAry,""),o="";this.skillLv.text="等级:"+a,a>0?(i="宠物全属性:"+t.harm*a/100+"%\n",o="宠物全属性:"+t.harm*(a+1)/100+"%\n"):(i="宠物全属性:0%\n",o="宠物全属性:"+t.harm/100+"%\n"),this.curPro.text=i,this.nextPro.text=o,this.consumItem.setCostByAwardItem(t.cost)},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.models.cost.id,this.models.cost.num,this.models.cost.type)){var e=new Message(MESSAGE_ID.PET_DAN_MESSAGE);e.setByte(2),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(PetLingDanPanel.prototype,"PetLingDanPanel");var PetMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_PET_GRADE,n.points=RedPointManager.createPoint(3),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="PetUpgradePanel",n.btnRes="进阶",n.funcID=FUN_TYPE.FUN_PET_GRADE,n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().petManager,"onCheckPetCanUpgrade"),t.push(n);var n=new RegisterSystemParam;n.sysName="PetUpdatePanel",n.btnRes="升级",n.redP=this.points[1],n.funcID=FUN_TYPE.FUN_PET_LEVEL,n.redP.addTriggerFuc(DataManager.getInstance().petManager,"onCheckPetCanUpdate"),t.push(n);var n=new RegisterSystemParam;n.sysName="PetEnchantPanel",n.btnRes="洗髓",t.push(n),this.registerPage(t,"petGrp",GameDefine.RED_TAB_POS),this.setTitle("宠物"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(this.index){case 0:break;case 1:}e.prototype.onRefresh.call(this)},t.prototype.trigger=function(){this.points[0].checkPoint(),this.points[1].checkPoint(),this.currTabPanel&&this.currTabPanel.trigger()},t}(BaseSystemPanel);__reflect(PetMainPanel.prototype,"PetMainPanel");var PetUpdatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.currPetID=1,n.animPos=new egret.Point(n.width/2-20,350),n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PetUpdatePanelSkin},t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.points[0].register(this.btn_state,GameDefine.RED_BTN_POS,this,"onCheckPetActive"),this.points[1].register(this.btn_update,GameDefine.RED_BTN_POS,DataManager.getInstance().petManager,"onCheckPetCanUpdateByID",this.currPetID),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currPetID!=t&&(this.currPetID=t,this.onRefresh())},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_update.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showLingDanPanel,this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE,this.onUpdateCurrcy,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_update.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showLingDanPanel,this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.btn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE,this.onUpdateCurrcy,this)},t.prototype.onRefresh=function(){this._data=DataManager.getInstance().playerManager.player.petData,this.currLv=this._data.lv;var e=this._data.model,t=this._data.nextModel;this.pet_avatar_grp.removeChildren();var n=this._data.gradeModel;if(GameCommon.getInstance().addAnimation("petbig"+n.waixing1,null,this.pet_avatar_grp,-1),this.lab_name.text=this._data.lv+"级",0==this._data.lv)this.btn_update.label="激活",this.consumItem.visible=!1;else{this.consumItem.visible=!0,this.btn_update.label="一键升级",this.next_level_lab.text=this._data.lv+"级";var a;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var i=0;i<e.attrAry.length;++i)if(e.attrAry[i]>0){if(a=new AttributesText,a.updateAttr(i,e.attrAry[i]),this.curPro.addChild(a),!t)continue;a=new AttributesText,a.updateAttr(i,t.attrAry[i]),this.nextPro.addChild(a)}if(this.bar_exp.value=this._data.exp,!t)return this.currentState="max",this.btn_update.label="已满级",this.consumItem.visible=!1,void this.onUpdatePower();this.currentState="normal",this.bar_exp.maximum=t.exp}this.onUpdatePower(),this.onUpdateCurrcy(),this.trigger()},t.prototype.onUpdateBack=function(){this._data&&this._data.lv>this.currLv&&(1==this._data.lv?GameCommon.getInstance().addAnimation("jihuochenggong",new egret.Point(this.width/2-20,350),this):GameCommon.getInstance().addAnimation("shengjichenggong",new egret.Point(this.width/2-20,350),this)),this.onRefresh()},t.prototype.onTouchBtnState=function(){switch(this.btn_state.label){case Language.instance.getText("shenqijihuo"):DataManager.getInstance().petManager.onSendUpdateMessage()}},t.prototype.onTouchBtnUpdate=function(){if("激活"==this.btn_update.label){var e=new Message(MESSAGE_ID.PET_ACTIVE_MESSAGE);return void GameCommon.getInstance().sendMsgToServer(e)}var t=this._data.model;t&&GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num)&&DataManager.getInstance().petManager.onSendUpdateMessage()},t.prototype.onTouchBtnOneKey=function(){},t.prototype.onTouchBtnFetter=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PetFetterPanel")},t.prototype.onUpdatePower=function(){this.power.power=DataManager.getInstance().petManager.power.toString()},t.prototype.onUpdateCurrcy=function(){var e;e=JsonModelManager.instance.getModelchongwushengji()[this._data.lv],e||(e=JsonModelManager.instance.getModelchongwushengji()[this._data.lv-1]);GameCommon.getInstance().getThingModel(e.cost.type,e.cost.id);this.consumItem.setCostByAwardItem(e.cost)},t.prototype.onBtnAdvanceClick=function(e){this.onRefresh()},t.prototype.openStrongerMonsterPanel=function(){},t.prototype.showLingDanPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PetLingDanPanel",6))},t.prototype.showDanPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PetZiZhiDan",6))},t.prototype.onGetBtn=function(e){var t;t=JsonModelManager.instance.getModelchongwushengji()[this._data.lv],GameCommon.getInstance().onShowFastBuy(t.cost.id)},t.prototype.trigger=function(){this.points[0].checkPoint(),this.points[1].checkPoint(!0,this.currPetID)},t.prototype.onCheckPetActive=function(){return this._data?this._data.lv>0?!1:void 0:!1},t}(BaseTabView);__reflect(PetUpdatePanel.prototype,"PetUpdatePanel");var PetUpgradePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.currPetID=1,n.animPos=new egret.Point(n.width/2-20,440),n.animPos2=new egret.Point(344,530),n.points=RedPointManager.createPoint(1),n.shape=new egret.Shape,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PetUpgradePanelSkin},t.prototype.onInit=function(){this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onTouchItem=function(e){var t=parseInt(e.currentTarget.name);this.currPetID!=t&&(this.currPetID=t,this.onRefresh())},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_update.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_UPGRADE_MESSAGE.toString(),this.onUpdateBack,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showLingDanPanel,this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE,this.onUpdateCurrcy,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.btn_update.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpdate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_UPGRADE_MESSAGE.toString(),this.onUpdateBack,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showLingDanPanel,this),this.btn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDanPanel,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE,this.onUpdateCurrcy,this)},t.prototype.trigger=function(){this.points[0].checkPoint()},t.prototype.addToContainer=function(e){this.maskPro.addChild(e),e.x=this.maskPro.width/2,e.y=this.maskPro.height/2},t.prototype.getArcProgress=function(e,t,n,a){function i(e,t){t.graphics.clear(),t.graphics.lineStyle(75,255,1,!1,1,"square"),t.graphics.drawArc(11,23,137,0,e*Math.PI/180,!1),t.graphics.endFill()}var o=360*Number((t/n).toFixed(1));return this.valueLab.text=t+"/"+n,i(o,this.shape),this.cirImg.mask=this.shape,this.shape},t.prototype.onRefresh=function(){this._data=DataManager.getInstance().playerManager.player.petData,0==this._data.lv?(this.btn_update.label="激 活",this.consume.visible=!1):(this.consume.visible=!0,this.btn_update.label="进 阶"),this._data.nextGradeModel?0==this._data.nextGradeModel.exp?this.addToContainer(this.getArcProgress(!1,this._data.gradeExp,this._data.gradeModel.exp,1)):this.addToContainer(this.getArcProgress(!1,this._data.gradeExp,this._data.nextGradeModel.exp,1)):this.addToContainer(this.getArcProgress(!1,this._data.gradeExp,this._data.gradeExp,1)),this.currGrade=this._data.grade;var e=this._data.gradeModel;this.lab_name.text=this._data.gradeModel.jieduan+"阶",this._lvModel?this._lvModel.jieduan!=e.jieduan&&(this.pet_avatar_grp.removeChildren(),GameCommon.getInstance().addAnimation("petbig"+e.waixing1,null,this.pet_avatar_grp,-1)):(this.pet_avatar_grp.removeChildren(),GameCommon.getInstance().addAnimation("petbig"+e.waixing1,null,this.pet_avatar_grp,-1)),this._lvModel=e,0==this._data.lv&&(this.condition_lab.textColor=15086130);for(var t=0;10>t;++t){var n=this["star"+t];t<this._data.gradeStar?(n.alpha=1,egret.Tween.get(n).to({alpha:1},600,egret.Ease.sineOut).call(function(e){egret.Tween.removeTweens(e)},this,[n])):n.alpha=.2}var a;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var i in this._data.gradeModel.attrAry)this._data.gradeModel.attrAry[i]>0&&(a=new AttributesText,a.updateAttr(i,this._data.gradeModel.attrAry[i]),this.curPro.addChild(a),this._data.nextGradeModel&&(a=new AttributesText,a.updateAttr(i,this._data.nextGradeModel.attrAry[i]),this.nextPro.addChild(a)));return this.onUpdatePower(),this._data.nextGradeModel?void this.onUpdateCurrcy():(this.btn_update.label="已满阶",void(this.currentState="max"))},t.prototype.onTouchBtnUpdate=function(){if("激活"==this.btn_update.label){var e=new Message(MESSAGE_ID.PET_ACTIVE_MESSAGE);return void GameCommon.getInstance().sendMsgToServer(e)}if(0==this._data.lv){var e=new Message(MESSAGE_ID.PET_ACTIVE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}else{if(!this._data.nextGradeModel)return;DataManager.getInstance().petManager.onSendUpgradeMessage()}},t.prototype.openStrongerMonsterPanel=function(){},t.prototype.showLingDanPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PetLingDanPanel",6))},t.prototype.showDanPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PetZiZhiDan",6))},t.prototype.onUpdateBack=function(){this._data&&(1==this._data.lv&&0==this._data.gradeExp&&0==this._data.grade?GameCommon.getInstance().addAnimation("jihuochenggong",new egret.Point(this.width/2-20,350),this):this.currGrade<this._data.grade&&GameCommon.getInstance().addAnimation("shenzhuangjinjie",new egret.Point(this.width/2,350),this)),this.onRefresh()},t.prototype.onUpdatePower=function(){this.power.power=DataManager.getInstance().petManager.power.toString()},t.prototype.onUpdateCurrcy=function(){if(0==this._data.lv){var e=JsonModelManager.instance.getModelchongwujinjie()[0][0];this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(e.cost.type,e.cost.id,e.cost.num))}else this._data.nextGradeModel&&(0==this._data.gradeModel.cost.num&&(this.btn_update.label="突破"),this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(this._data.gradeModel.cost.type,this._data.gradeModel.cost.id,this._data.gradeModel.cost.num)))},t.prototype.onGetBtn=function(e){this._data.nextGradeModel&&GameCommon.getInstance().onShowFastBuy(this._data.nextGradeModel.cost.id,GOODS_TYPE.GOLD)},t}(BaseTabView);__reflect(PetUpgradePanel.prototype,"PetUpgradePanel");var PetZiZhiDan=function(e){function t(t){var n=e.call(this,t)||this;return n.blessType=0,n.priority=PANEL_HIERARCHY_TYPE.II,n.indexId=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MagicZiZhiDanSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.blessType=e,this.models=JsonModelManager.instance.getModelchongwuDan()[1],this.indexId=0,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PET_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnUpSkill,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PET_DAN_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onHide=function(){e.prototype.onHide.call(this)},t.prototype.updateAvatarAnim=function(){for(this.avatar_grp.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this);this.avatar_grp.numChildren>0;){var e=this.avatar_grp.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.avatar_grp.removeChild(e)}var t=DataManager.getInstance().playerManager.player.petData,n=t.gradeModel;GameCommon.getInstance().addAnimation("petbig"+n.waixing1,null,this.avatar_grp,-1),this.avatar_grp.y=270,this.avatar_grp.scaleX=.8,this.avatar_grp.scaleY=.8},t.prototype.onStartFloatAnim=function(){this.moveUp=!0,this.start_posY=this.avatar_grp.y,this.avatar_grp.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this.moveUp?(this.avatar_grp.y--,this.avatar_grp.y<this.start_posY-50&&(this.moveUp=!1)):(this.avatar_grp.y++,this.avatar_grp.y>this.start_posY&&(this.moveUp=!0))},t.prototype.onRefresh=function(){this.onShowInfo(this.indexId),this.updateAvatarAnim()},t.prototype.onShowInfo=function(e){this.titleName.text=this.models.name,this.indexId=e;var t=this.models;this.skillName.text=t.name;var n=DataManager.getInstance().playerManager.player.petData,a=n.danDic[1],i=t.attrAry,o="",r="",s=0;if(this.skillLv.text="等级:"+a,a>0)for(;s<GameDefine.ATTR_OBJ_KEYS.length;s++)i[s]>0&&(o=o+GameDefine.Attr_FontName[s]+"："+i[s]*a+"\n",r=r+GameDefine.Attr_FontName[s]+"："+i[s]*(a+1)+"\n");
else for(;s<GameDefine.ATTR_OBJ_KEYS.length;s++)i[s]>0&&(o=o+GameDefine.Attr_FontName[s]+"：0\n",r=r+GameDefine.Attr_FontName[s]+"："+i[s]+"\n");this.curPro.text=o,this.nextPro.text=r,this.consumItem.setCostByAwardItem(t.cost)},t.prototype.onTouchBtnUpSkill=function(){if(GameCommon.getInstance().onCheckItemConsume(this.models.cost.id,this.models.cost.num,this.models.cost.type)){var e=new Message(MESSAGE_ID.PET_DAN_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(PetZiZhiDan.prototype,"PetZiZhiDan");var PowerBar=function(e){function t(){var t=e.call(this)||this;return t._powerValue=0,t.w=351,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onInit,t),t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoaded=!0,this.power=this._powerValue},t.prototype.onInit=function(){},Object.defineProperty(t.prototype,"power",{set:function(e){e>0||(e=0),this._powerValue=e,this.isLoaded&&(this.power_num.text=this._powerValue+"")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSource",{set:function(e){this.zhan.source=e},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(PowerBar.prototype,"PowerBar");var FightingChangeAnim=function(e){function t(){var t=e.call(this)||this;return t._targetValue=0,t._currentValue=0,t._differenceValue=0,t._step=0,t.width=625,t.fightingNum=new eui.BitmapLabel,t.fightingNum.font="font_fight_yellow_fnt",t.fightingNum.letterSpacing=-8,t.fightingNum.x=250,t.fightingNum.y=150,t.fightingNum.scaleX=.65,t.fightingNum.scaleY=.65,t.fightingNum.verticalCenter=0,t.change_label=new eui.BitmapLabel,t.change_label.letterSpacing=-8,t.change_label.x=350,t.change_label.scaleX=.5,t.change_label.scaleY=.5,t.touchEnabled=!1,t.touchChildren=!1,t}return __extends(t,e),t.prototype.setFighting=function(){this.fightingNum.text=Math.floor(this._currentValue).toString()},t.prototype.onEnterFrame=function(e){if(0!=this._step&&(this._currentValue+=this._step,Math.abs(this._currentValue-this._targetValue)<Math.abs(this._step)&&(this._currentValue=this._targetValue),this.setFighting(),this._currentValue==this._targetValue)){this._step=0,this.change_label.alpha=.4,this.change_label.y=0,this.addChild(this.change_label);var t=egret.Tween.get(this.change_label);t.to({y:-40,alpha:1},800).call(function(){egret.Tween.removeTweens(this.change_label)},this),this._differenceValue>1e3&&this.onPlayAnim3()}this._timeStamp<egret.getTimer()&&this.onFinish()},t.prototype.show=function(e,t){this._currentValue=e,this._targetValue=t,this._differenceValue=this._targetValue-this._currentValue,this._timeStamp=egret.getTimer()+3e3,this.onPlayAnim1()},t.prototype.onPlayAnim1=function(){this._fightAnim2?this._fightAnim2.playNum=1:(this._fightAnim2=new Animation("zhandoulibianhua2",1),this._fightAnim2.x=270,this._fightAnim2.y=25),this.addChild(this._fightAnim2),this._fightAnim1?this._fightAnim1.playNum=1:(this._fightAnim1=new Animation("zhandoulibianhua",1),this._fightAnim1.x=300,this._fightAnim1.y=25),this._fightAnim1.playFinishCallBack(this.onPlayAnim2,this,this),this.addChild(this._fightAnim1)},t.prototype.onPlayAnim2=function(){this.addChild(this.fightingNum),this.setFighting(),this._step=this._differenceValue/25,this._differenceValue>0?(this.change_label.font="font_fight_green_fnt",this.change_label.text="+"+this._differenceValue.toString()):(this.change_label.font="font_fight_red_fnt",this.change_label.text=this._differenceValue.toString())},t.prototype.onPlayAnim3=function(){this._fightAnim3?this._fightAnim3.playNum=1:(this._fightAnim3=new Animation("zhandouli_baozeng_1",1),this._fightAnim3.x=0,this._fightAnim3.y=-450),this._fightAnim3.playFinishCallBack(this.onPlayAnim4,this,this),this.addChild(this._fightAnim3)},t.prototype.onPlayAnim4=function(){this._fightAnim4?this._fightAnim4.playNum=3:(this._fightAnim4=new Animation("zhandouli_baozeng_2",3),this._fightAnim4.x=0,this._fightAnim4.y=-450),this.addChild(this._fightAnim4)},t.prototype.onFinish=function(){this._step=0,this.removeChildren(),this.parent&&this.parent.removeChild(this),egret.Tween.removeTweens(this.change_label)},t}(eui.Component);__reflect(FightingChangeAnim.prototype,"FightingChangeAnim");var GameGuideBar=function(e){function t(t){var n=e.call(this)||this;return n.compTimes=0,n.OFF_GAP=20,n.ARROW_START_X=25,n.ARROW_START_Y=50,n.owner=t,n.skinName=skins.FuncGuideBarSkin,n}return __extends(t,e),t.prototype.onShow=function(e){if(e){if(this.targetButton&&(this.targetButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemove,this),this.targetButton=null),this.panel&&(this.panel=null),this.param=e,!this.param.model.target)return void this.owner.onCompleteGuide();var t=e.model;if(this.compTimes=Math.max(t.time,1),"$TabView"==t.panel)egret.is(e.parentContainer,"BaseSystemPanel")?this.panel=e.parentContainer.currTabPanel:this.panel=e.parentContainer;else if("$Mainview"==t.panel||"$MainviewBtnsBar"==t.panel||"$BaseTab"==t.panel)this.panel=e.parentContainer;else if(t.panel.indexOf("$List=")>=0){var n=void 0,a=void 0,i=0;t.panel.indexOf("$Idx=")&&(n=t.panel.indexOf("$Idx="),a=t.panel.indexOf(",",n),a=0>a?t.panel.length:a,i=parseInt(t.panel.slice(n+"$Idx=".length,a))),n=t.panel.indexOf("$List="),a=t.panel.indexOf(",",n),a=0>a?t.panel.length:a;var o=t.panel.slice(n+"$List=".length,a),r=void 0;if(r=egret.is(e.parentContainer,"BaseSystemPanel")?e.parentContainer.currTabPanel[o]:e.parentContainer[o])for(var s=0;s<r.numChildren;s++){var h=r.getChildAt(s);if(h&&i==s){this.panel=h;break}}}else if(t.panel.indexOf("$Component=")>=0){var n=t.panel.indexOf("$Component="),l=t.panel.slice(n+"$Component=".length,t.panel.length);egret.is(e.parentContainer,"BaseSystemPanel")?this.panel=e.parentContainer.currTabPanel[l]:this.panel=e.parentContainer[l]}if(!(t&&this.panel&&this.panel.parent&&this.panel.parent.parent))return e.againCount=GameDefine.JACKAROO_GUIDE_NUM,void(this.param=null);var g,c;if("$close"==t.target&&this.panel.basic){var p=this.panel.basic;p.closeBtn1?this.targetButton=p.closeBtn1:p.closeBtn2&&(this.targetButton=p.closeBtn2)}else egret.is(this.panel,"BaseSystemPanel")&&Tool.isNumber(parseInt(t.target))?this.targetButton=this.panel.getTabBtnGrp(parseInt(t.target)):this.targetButton=this.panel[t.target];if(!this.targetButton)return e.againCount=GameDefine.JACKAROO_GUIDE_NUM,void(this.param=null);Tool.isNumber(g)||(g=this.targetButton.width),Tool.isNumber(c)||(c=this.targetButton.height);var u=this.targetButton.localToGlobal();egret.is(e.parentContainer,"BaseSystemPanel")&&e.parentContainer.priority==PANEL_HIERARCHY_TYPE.I?u.x+=(this.panel.width-GameDefine.GAME_STAGE_WIDTH)/2:"$MainviewBtnsBar"==t.panel&&egret.is(this.panel.parent,"BaseSystemPanel")&&(u.x+=(this.panel.width-GameDefine.GAME_STAGE_WIDTH)/2);var d,_=0,m="down";u.x+g<100?(m="left",t.texiao>0&&(d=new egret.Point(-g/2,0)),u.x=u.x+this.OFF_GAP+g,u.y=u.y+c/2-this.height/2,_=-90):u.x+g>size.width-100?(m="right",t.texiao>0&&(d=new egret.Point(g/2,0)),u.x=u.x-this.OFF_GAP-.75*this.height,u.y=u.y+c/2-this.height/2,_=90):u.y+c<200?(m="up",t.texiao>0&&(d=new egret.Point(0,-c/2)),u.x=u.x+g/2-this.width/2,u.y=u.y+this.OFF_GAP+c,_=0):(t.texiao>0&&(d=new egret.Point(0,c/2)),u.x=u.x+g/2-this.width/2,u.y=u.y-this.OFF_GAP-this.height,_=180);var E=this.guide_arrow_img.rotation;"$Mainview"==t.panel?(u.x=u.x-this.panel.x,u.y=u.y-this.panel.y):"$MainviewBtnsBar"==t.panel?(u.x=u.x-e.parentContainer.parent.x,u.y=u.y-this.panel.localToGlobal().y):(u.x=u.x-e.parentContainer.parent.x,DataManager.IS_PC_Game||(size.height<=GameDefine.GAME_STAGE_HEIGHT?"$TabView"==t.panel&&egret.is(e.parentContainer,"BaseSystemPanel")||t.panel.indexOf("$Component=")>=0?u.y=u.y-20:t.panel.indexOf("$List=")>=0?u.y=u.y-30:"$close"==t.target&&this.panel.basic&&this.targetButton==this.panel.basic.closeBtn2&&(u.y=u.y-50):u.y=u.y-e.parentContainer.localToGlobal().y)),this.currentState=m,this.parent&&this.parent===e.parentContainer&&!this.targetPos?(this.targetPos=u,egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.guide_arrow_img),this.stopMoveFrame(),this.guide_arrow_img.rotation=E,this.anim_grp.visible=!1,egret.Tween.get(this).to({x:u.x,y:u.y},260).call(this.toNextTweenEnd,this),egret.Tween.get(this.guide_arrow_img).to({rotation:_},250)):(this.x=u.x,this.y=u.y,e.parentContainer.addChild(this),this.startMoveFrame()),this.targetButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemove,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.guideAnim?d?(this.guideAnim.x=d.x,this.guideAnim.y=d.y):(this.guideAnim.onDestroy(),this.guideAnim=null):d&&(this.guideAnim=GameCommon.getInstance().addAnimation("xinshouyindao",d,this.anim_grp,-1)),""!=t.desc?(this.desc_grp.visible=!0,this.desc_lab.text=t.desc):this.desc_grp.visible=!1}},t.prototype.toNextTweenEnd=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.guide_arrow_img),this.anim_grp.visible=!0,this.startMoveFrame()},t.prototype.startMoveFrame=function(){this._isMoving||(this._isMoving=!0,this.guide_arrow_img.x=this.ARROW_START_X,this.guide_arrow_img.y=this.ARROW_START_Y,this.moveBack=!1,this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this))},t.prototype.stopMoveFrame=function(){this._isMoving=!1,this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){switch(this.currentState){case"up":this.moveBack?(this.guide_arrow_img.y+=2,this.guide_arrow_img.y>this.ARROW_START_Y+12&&(this.moveBack=!1)):(this.guide_arrow_img.y-=2,this.guide_arrow_img.y<this.ARROW_START_Y-12&&(this.moveBack=!0));break;case"down":this.moveBack?(this.guide_arrow_img.y-=2,this.guide_arrow_img.y<this.ARROW_START_Y-12&&(this.moveBack=!1)):(this.guide_arrow_img.y+=2,this.guide_arrow_img.y>this.ARROW_START_Y+12&&(this.moveBack=!0));break;case"left":this.moveBack?(this.guide_arrow_img.x+=2,this.guide_arrow_img.x>this.ARROW_START_X+12&&(this.moveBack=!1)):(this.guide_arrow_img.x-=2,this.guide_arrow_img.x<this.ARROW_START_X-12&&(this.moveBack=!0));break;case"right":this.moveBack?(this.guide_arrow_img.x-=2,this.guide_arrow_img.x<this.ARROW_START_X-12&&(this.moveBack=!1)):(this.guide_arrow_img.x+=2,this.guide_arrow_img.x>this.ARROW_START_X+12&&(this.moveBack=!0))}},t.prototype.onRemove=function(){this.compTimes--,this.compTimes>0||(this.targetPos=null,this.param&&(this.param.isComplete=!0),this.owner.onContiuneGuide())},t.prototype.onDestroy=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.guide_arrow_img),this.param=null,this.panel=null,this.targetPos=null,this.onHide()},t.prototype.onHide=function(){this.parent&&this.parent.removeChild(this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.targetButton&&(this.targetButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemove,this),this.targetButton=null),this.guideAnim&&(this.guideAnim.onDestroy(),this.guideAnim=null),this.stopMoveFrame(),this.panel=null},t.prototype.onTouch=function(){this.targetButton&&(egret.is(this.targetButton,"eui.CheckBox")&&(this.targetButton.selected=!0),this.targetButton.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP)))},t.YEWAI_BOSS_GUIDE=1001,t.YEWAI_AUTO_FIGHT=1002,t}(eui.Component);__reflect(GameGuideBar.prototype,"GameGuideBar");var GuideParam=function(){function e(e){this.isComplete=!1,this.progress=0,this.jackarooId=e,this.progress=0,this.againCount=GameDefine.JACKAROO_GUIDE_NUM,this.models=FunDefine.getGuideModels(e)}return Object.defineProperty(e.prototype,"model",{get:function(){return this.models[this.progress]},enumerable:!0,configurable:!0}),e.prototype.onContiune=function(){this.progress=Math.min(this.models.length,this.progress+1),this.againCount=GameDefine.JACKAROO_GUIDE_NUM},Object.defineProperty(e.prototype,"isEnd",{get:function(){return this.models?this.models.length==this.progress:!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLastOne",{get:function(){return!this.models[this.progress+1]},enumerable:!0,configurable:!0}),e}();__reflect(GuideParam.prototype,"GuideParam");var PromptInfo=function(e){function t(t){var n=e.call(this)||this;return n.boo=!0,n.speed=5,n._type=t,n._label=new eui.Label,n.touchEnabled=!1,n.touchChildren=!1,n.timer||(n.timer=new egret.Timer(1500,1)),n.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,n.timerComFunc,n),n.timer.start(),n.once(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(t,e),t.prototype.onAddToStage=function(e){this.setStyle(),this._label.fontFamily=GameCommon.getFontFamily(),this._label.size=22,this._label.bold=!0,this._label.anchorOffsetX=this._label.width/2,this._label.anchorOffsetY=this._label.height/2,this.addChild(this._label)},t.prototype.setStyle=function(){switch(this._type){case PROMPT_TYPE.ERROR:this._label.textColor=16711680;var e=new eui.Image;e.y=-this._label.height/2-4,e.source="tips_alert_txt_bg2_png",e.scale9Grid=new egret.Rectangle(17,11,133,12),e.width=this._label.width+20,e.height=this._label.height+8,e.anchorOffsetX=e.width/2,this.addChild(e);var t=new eui.Image;t.y=-this._label.height/2-6,t.x=-4-e.width/2,t.source="tips_alert_warnimg_png",this.addChild(t),this._label.x=10;break;case PROMPT_TYPE.FUN:this._label.textColor=16776910;var e=new eui.Image;e.y=-this._label.height/2-4,e.source="tips_alert_txt_bg2_png",e.scale9Grid=new egret.Rectangle(17,11,133,12),e.width=this._label.width,e.height=this._label.height+8,e.anchorOffsetX=e.width/2,this.addChild(e);break;case PROMPT_TYPE.GAIN:var e=new eui.Image;e.y=-this._label.height/2-4,e.source="tips_alert_txt_bg2_png",e.scale9Grid=new egret.Rectangle(17,11,133,12),e.width=this._label.width,e.height=this._label.height+8,e.anchorOffsetX=e.width/2,this.addChild(e);break;case PROMPT_TYPE.CUSTOM:var e=new eui.Image;e.y=-this._label.height/2-4,e.source="tips_alert_txt_bg2_png",e.scale9Grid=new egret.Rectangle(17,11,133,12),e.width=this._label.width,e.height=this._label.height+8,e.anchorOffsetX=e.width/2,this.addChild(e)}},Object.defineProperty(t.prototype,"height",{get:function(){return this._label?this._label.textHeight+10:30},enumerable:!0,configurable:!0}),t.prototype.timerComFunc=function(){this.boo=!1,this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null},Object.defineProperty(t.prototype,"proboodate",{get:function(){return this.boo},enumerable:!0,configurable:!0}),t.prototype.onRemove=function(){this.removeChildren(),this._label=null,this.parent&&this.parent.removeChild(this)},t.prototype.setText=function(e){this._label.text=e},t.prototype.getText=function(){return this._label.text},t.prototype.setTextFlow=function(e){this._label.textFlow=e},Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(PromptInfo.prototype,"PromptInfo");var PromptPanel=function(e){function t(){var t=e.call(this)||this;return t._infoArray1=new Array,t._newestPromp1=null,t._infoArray2=new Array,t._newestPromp2=null,t._flydamages=[],t._rareEquip=new RareEquipCtrl,t.targetY2=5,t.targetY1=5,t._onMoveTxtAry1=[],t._onMoveTxtAry2=[],t.addEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.getInstance=function(){return this._promptPanel||(this._promptPanel=new t),this._promptPanel},t.prototype.onAddToStage=function(e){this._rareEquip.touchEnabled=!1,this._rareEquip.touchChildren=!1,this._rareEquip.horizontalCenter=!0,this.addChild(this._rareEquip),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_BROADCAST_MESSAGE.toString(),this.addMessageBar,this)},t.prototype.onEnterFrame=function(e){this._infoArray1.length>0&&(null==this._newestPromp1||this._newestPromp1.y<950-this._newestPromp1.height)&&(this._newestPromp1=this._infoArray1.shift(),this.addPrompTxtToStage(this._newestPromp1));for(var t=this._onMoveTxtAry1.length-1;t>=0;t--){var n=this._onMoveTxtAry1[t];0==n.proboodate?(this._newestPromp1==n&&(this._newestPromp1=null),n.onRemove(),n=null,this._onMoveTxtAry1.splice(t,1)):(this._onMoveTxtAry1[t+1]&&this._onMoveTxtAry1[t].y>this._onMoveTxtAry1[t+1].y-this._onMoveTxtAry1[t+1].height&&(this._onMoveTxtAry1[t].y-=10),n.y>=430?n.y-=n.speed:n.y-=Number(0))}this._infoArray2.length>0&&(null==this._newestPromp2||this._newestPromp2.y<950)&&(this._newestPromp2=this._infoArray2.shift(),this.addPrompTxtToStage(this._newestPromp2));for(var t=this._onMoveTxtAry2.length-1;t>=0;t--){var a=this._onMoveTxtAry2[t];0==a.proboodate?(this._newestPromp2==a&&(this._newestPromp2=null),a.onRemove(),a=null,this._onMoveTxtAry2.splice(t,1)):(this._onMoveTxtAry2[t+1]&&this._onMoveTxtAry2[t].y>this._onMoveTxtAry2[t+1].y-this._onMoveTxtAry2[t+1].height&&(this._onMoveTxtAry2[t].y-=10),a.y>=430?a.y-=a.speed:a.y-=Number(0))}this._fightingChangeAnim&&this._fightingChangeAnim.onEnterFrame(e);for(var i=this._flydamages.length-1;i>=0;i--){var o=this._flydamages[i];o.isFinish?(this._flydamages.splice(i,1),BodyFactory.instance.onRecoveryDamageFont(o)):o.play()}this._playerMessageBar&&this._playerMessageBar.isPlaying&&this._playerMessageBar.onMessageMove(),this._systemMessageBar&&this._systemMessageBar.isPlaying&&this._systemMessageBar.onMessageMove()},t.prototype.addPromptError=function(e,t){if(void 0===t&&(t=!0),!(t&&this._infoArray1.length>0&&this._infoArray1[this._infoArray1.length-1].getText()==e)){var n=new PromptInfo(PROMPT_TYPE.ERROR);n.setText(e),this._infoArray2.push(n)}},t.prototype.addPromptFun=function(e){var t=new PromptInfo(PROMPT_TYPE.FUN);t.setText(e),this._infoArray1.push(t)},t.prototype.addPromptGain=function(e){var t=new PromptInfo(PROMPT_TYPE.GAIN);t.setTextFlow(e),this._infoArray1.push(t)},t.prototype.addPromptCustom=function(e){var t=new PromptInfo(PROMPT_TYPE.CUSTOM);t.setTextFlow(e),this._infoArray1.push(t)},t.prototype.addPrompTxtToStage=function(e){this.addChild(e),e.type==PROMPT_TYPE.CUSTOM||e.type==PROMPT_TYPE.FUN?(this._onMoveTxtAry2.push(e),e.x=GameDefine.GAME_STAGE_WIDTH/2,e.y=size.height/2):(this._onMoveTxtAry1.push(e),e.x=GameDefine.GAME_STAGE_WIDTH/2,e.y=size.height/2)},t.prototype.fightingAnimShow=function(e,t){this._fightingChangeAnim||(this._fightingChangeAnim=new FightingChangeAnim,this._fightingChangeAnim.x=0,this._fightingChangeAnim.y=size.height-500),this._fightingChangeAnim.parent&&this._fightingChangeAnim.onFinish(),this._fightingChangeAnim.show(e,t),this.addChild(this._fightingChangeAnim)},t.prototype.getRareEquipShow=function(e){this._rareEquip.push(e)},t.prototype.onCreateDamageFont=function(e,t){var n=BodyFactory.instance.onCreateDamageFont();n.x=t.x;var a=t.data.bodyType==BODY_TYPE.PET||t.data.bodyType==BODY_TYPE.RETINUE?10:50;return n.y=t.y-(t.data.model?t.data.model.high-a:0),GameFight.getInstance().addDropBodyToLayer(n),this._flydamages.push(n),n.initFont(e),n},t.prototype.addMessageBar=function(e){var t=e.message;switch(t){case EBroadcastChannel.Player:this._playerMessageBar||(this._playerMessageBar=new PlayerMessageBar(t),this._playerMessageBar.y=340),this._playerMessageBar.parent||(this.addChild(this._playerMessageBar),this._playerMessageBar.onshowMessage());break;case EBroadcastChannel.System:this._systemMessageBar||(this._systemMessageBar=new PlayerMessageBar(t),this._systemMessageBar.y=200),this._systemMessageBar.parent||(this.addChild(this._systemMessageBar),this._systemMessageBar.onshowMessage())}},t}(egret.DisplayObjectContainer);__reflect(PromptPanel.prototype,"PromptPanel");var PROMPT_TYPE;!function(e){e[e.ERROR=0]="ERROR",e[e.FUN=1]="FUN",e[e.GAIN=2]="GAIN",e[e.CUSTOM=3]="CUSTOM"}(PROMPT_TYPE||(PROMPT_TYPE={}));var RareEquipCtrl=function(e){function t(){var t=e.call(this)||this;return t.isPlay=!1,t._queue=[],t.once(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){var t=new eui.LayoutBase;t.useVirtualLayout=!0,this._grp=new eui.Group,this._grp.layout=t,this._grp.bottom=352,this.addChild(this._grp)},t.prototype.push=function(e){this.isPlay?this._queue.push(e):(this.isPlay=!0,this.onDisappear(e))},t.prototype.play=function(){var e=this._queue.shift();e?this.onDisappear(e):this.isPlay=!1},t.prototype.onDisappear=function(e){e.y=1100,e.x=(GameDefine.GAME_STAGE_WIDTH-470)/2,this.addChild(e),egret.Tween.get(e).to({y:800},500,egret.Ease.sineIn).call(this.onBackFunc0,this,[e]).to({alpha:1},1e3,egret.Ease.sineInOut).call(this.onBackFunc,this,[e])},t.prototype.onBackFunc0=function(e){this.play()},t.prototype.onBackFunc=function(e){e.parent&&(e.parent.removeChild(e),e=null)},t}(eui.Component);__reflect(RareEquipCtrl.prototype,"RareEquipCtrl");var PsychDecompose=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychDecomposeSkin},t.prototype.onInit=function(){this.model=JsonModelManager.instance.getModelyuanshen()[1];var t=GameCommon.parseAwardItem(this.model.fenjie);this.goods=GameCommon.getInstance().getThingModel(t.type,t.id),this.setTitle("元神分解"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_decompose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.orangeLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOrange,this),this.purpleLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPurple,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_decompose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this),this.orangeLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOrange,this),this.purpleLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPurple,this)},t.prototype.onRefresh=function(){var e,t=DataManager.getInstance().psychManager.psychQueue;for(var n in t)e=t[n],e.seletced=!0;this.btn_orange.selected=this.btn_purple.selected=!0,this.onUpdateInfo(),this.onChangeHandler(),this.onShowInfo()},t.prototype.onUpdateInfo=function(){var e,t,n=DataManager.getInstance().psychManager.psychQueue;this.itemLayer.removeChildren();for(var a in n)e=n[a],t=new PsychInstance(0),t.onUpdate(e,PSYCHSTATE_TYPE.SELECT,0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemLayer.addChild(t)},t.prototype.onSetBtnSelect=function(e,t){switch(e){case GoodsQuality.Orange:this.btn_orange.selected=t;break;case GoodsQuality.Purple:this.btn_purple.selected=t}},t.prototype.onTouchItem=function(e){var t=e.currentTarget;t.thing.seletced=!t.thing.seletced,t.onChangeCheckBox(),this.onChangeHandler(),this.onShowInfo()},t.prototype.onChangeHandler=function(){var e,t=DataManager.getInstance().psychManager.psychQueue,n=!0,a=!0;for(var i in t)switch(e=t[i],e.model.pinzhi){case GoodsQuality.Orange:e.seletced||(n=!1);break;case GoodsQuality.Purple:e.seletced||(a=!1)}this.onSetBtnSelect(GoodsQuality.Orange,n),this.onSetBtnSelect(GoodsQuality.Purple,a)},t.prototype.onTouchOrange=function(e){this.btn_orange.selected=!this.btn_orange.selected,this.onSetBaseSelect(GoodsQuality.Orange,this.btn_orange.selected),this.onShowInfo()},t.prototype.onTouchPurple=function(e){this.btn_purple.selected=!this.btn_purple.selected,this.onSetBaseSelect(GoodsQuality.Purple,this.btn_purple.selected),this.onShowInfo()},t.prototype.onSetBaseSelect=function(e,t){var n,a=DataManager.getInstance().psychManager.psychQueue;for(var i in a)n=a[i],n.model.pinzhi==e&&(n.seletced=t)},t.prototype.onShowInfo=function(){for(var e,t=this.itemLayer.numChildren-1;t>=0;t--)e=this.itemLayer.getChildAt(t),e.onChangeCheckBox();this.decomposeQueue=[];var n,a=0,i=DataManager.getInstance().psychManager.psychQueue;for(var o in i)if(n=i[o],n.seletced){var r=GameCommon.parseAwardItem(n.model.fenjie);a+=r.num,this.decomposeQueue.push(n)}var r=GameCommon.parseAwardItem(this.model.fenjie),s=DataManager.getInstance().bagManager.getGoodsThingById(r.id,r.type);s?s.num:0;this.cons.text=a+""},t.prototype.onTouchBtn=function(){0==this.decomposeQueue.length?GameCommon.getInstance().addAlert("请选择元神"):(DataManager.getInstance().psychManager.onSendDecomposeMessage(this.decomposeQueue),this.onHide())},t}(BaseWindowPanel);__reflect(PsychDecompose.prototype,"PsychDecompose");var PsychInstance=function(e){function t(t){var n=e.call(this)||this;return n._type=0,n._pos=t,n.skinName=skins.PsychInstanceSkin,n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouch,n),n}return __extends(t,e),t.prototype.onUpdate=function(e,t,n){this._thing=e,this._type=t,this._own=n,this.refresh()},Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos},set:function(e){this._pos=e},enumerable:!0,configurable:!0}),t.prototype.onChangeCheckBox=function(){this.btn.selected=this._thing.seletced},t.prototype.refresh=function(){switch(this._type){case PSYCHSTATE_TYPE.LOCK:return this.currentState="lock",this.item_back.source="bag_whiteframe_png",this.item_icon.source="",this.label_lock.text=PsychDefine.PSYCH_SLOT_LOCK[this.pos],this.label_0.textFlow=[],void(this.label_1.textFlow=[]);case PSYCHSTATE_TYPE.NONE:return this.currentState="none",this.item_back.source="bag_whiteframe_png",this.item_icon.source="",this.label_0.textFlow=[],void(this.label_1.textFlow=[]);case PSYCHSTATE_TYPE.SHOWLV:this.item_back.source=GameCommon.getInstance().getIconFrame(this._thing.model.pinzhi),this.item_icon.source=this._thing.model.icon,this.label_0.textFlow=[],this.label_1.textFlow=[];break;case PSYCHSTATE_TYPE.SHOWNAME_AND_BG:this.currentState="normal",this.label_0.textFlow=new Array({text:this._thing.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._thing.model.pinzhi)}}),this.label_1.textFlow=[],this.item_back.source=GameCommon.getInstance().getIconFrame(this._thing.model.pinzhi),this.item_icon.source=this._thing.model.icon;break;case PSYCHSTATE_TYPE.SHOWNAME:this.currentState="normal",this.label_0.textFlow=new Array({text:this._thing.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this._thing.model.pinzhi)}}),this.label_1.textFlow=[],this.item_back.source=GameCommon.getInstance().getIconFrame(this._thing.model.pinzhi),this.item_icon.source=this._thing.model.icon;break;case PSYCHSTATE_TYPE.SELECT:this.currentState="select",this.label_0.textFlow=new Array({text:this._thing.model.name,style:{textColor:15326899}}),this.label_1.textFlow=new Array({text:"战力:"+this._thing.fightValue,style:{textColor:15326899}}),this.item_back.source=GameCommon.getInstance().getIconFrame(this._thing.model.pinzhi),this.item_icon.source=this._thing.model.icon,this.onChangeCheckBox();break;case PSYCHSTATE_TYPE.NOLABEL:this.currentState="noLabel",this.item_back.source=GameCommon.getInstance().getIconFrame(this._thing.model.pinzhi),this.item_icon.source=this._thing.model.icon,this.label_0.textFlow=[],this.label_1.textFlow=[]}},Object.defineProperty(t.prototype,"thing",{get:function(){return this._thing},enumerable:!0,configurable:!0}),t.prototype.playSmelt=function(){if(this._thing){var e=new Animation("ronglianchenggong",1,!0);e.x=this.width/2,e.y=this.height/2-20,this.addChild(e)}},Object.defineProperty(t.prototype,"selected",{set:function(e){this.selectLayer.visible=e,e?(this.selectedAnim||(this.selectedAnim=new Animation("zhuangbeixuanzhong",-1),this.selectLayer.addChild(this.selectedAnim),this.selectedAnim.scaleX=this.selectedAnim.scaleY=.6),this.selectedAnim.onPlay()):this.selectedAnim&&this.selectedAnim.onStop()},enumerable:!0,configurable:!0}),t.prototype.onTouch=function(e){},Object.defineProperty(t.prototype,"position",{get:function(){return this._thing?this._thing.slot:-1},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(PsychInstance.prototype,"PsychInstance");var PSYCHSTATE_TYPE;!function(e){e[e.LOCK=-1]="LOCK",e[e.NONE=0]="NONE",e[e.SHOWLV=1]="SHOWLV",e[e.SHOWNAME=2]="SHOWNAME",e[e.SHOWNAME_AND_BG=3]="SHOWNAME_AND_BG",e[e.SELECT=4]="SELECT",e[e.NOLABEL=5]="NOLABEL"}(PSYCHSTATE_TYPE||(PSYCHSTATE_TYPE={}));var PsychIntroducebar=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychIntroducebarSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.param=e,this.model=this.param.model,this.onShow()},t.prototype.onRefresh=function(){this.showAttributeInfo()},t.prototype.showAttributeInfo=function(){var e=0;this.name_label.textFlow=new Array({text:this.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this.model.pinzhi)}});var t=GameCommon.calculationFighting(this.model.attrAry);this.bmlable_power.power=t.toString(),this.pingfen_label.text="评分："+t;var n=new PsychBase;n.modelID=this.model.id,this.psych.onUpdate(n,PSYCHSTATE_TYPE.NOLABEL,0),this.psych.touchEnabled=!1;var a;this.basic_attr_layer.removeChildren();for(var e=0;e<ATTR_TYPE.SIZE;e++){var i=this.model.attrAry[e];i>0&&(a=new AttributeItem,a.data=[e,i],this.basic_attr_layer.addChild(a))}},t}(BaseWindowPanel);__reflect(PsychIntroducebar.prototype,"PsychIntroducebar");var PsychIntroducebarParam=function(){function e(e){this.model=e}return e}();__reflect(PsychIntroducebarParam.prototype,"PsychIntroducebarParam");var PsychPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=0,n.points=RedPointManager.createPoint(9),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychPanelSkin},t.prototype.onInit=function(){for(var t=0;t<GameDefine.Psych_Slot_Num;t++)this.points[t].register(this["psych"+t],new egret.Point(70,-6),DataManager.getInstance().psychManager,"getCanChangeOrUpdateBySlot");this.points[GameDefine.Psych_Slot_Num].register(this.btn_replace,new egret.Point(75,0),DataManager.getInstance().psychManager,"getCanChangePsychBySlot"),this.points[GameDefine.Psych_Slot_Num+1].register(this.btn_upgrade,GameDefine.RED_BTN_POS,DataManager.getInstance().psychManager,"getCanUpgradePsychBySlot"),GameCommon.getInstance().addUnderlineGet(this.label_get),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_preview.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPreview,this),this.btn_replace.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReplace,this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUpgrade,this),this.btn_decompose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDecompose,this),this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this["goto"],this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_EQUIP_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_UPGRADE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_DECOMPOSE_MESSAGE.toString(),this.onRefresh,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this);for(var t,n=0;n<GameDefine.Psych_Slot_Num;n++)t=this["psych"+n],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPsych,this);this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenMasterOnClick,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_preview.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnPreview,this),this.btn_replace.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReplace,this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchUpgrade,this),this.btn_decompose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchDecompose,this),this.label_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this["goto"],this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_EQUIP_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_UPGRADE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_PSYCH_DECOMPOSE_MESSAGE.toString(),this.onRefresh,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this);
for(var t,n=0;n<GameDefine.Psych_Slot_Num;n++)t=this["psych"+n],t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPsych,this);this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.strengthenMasterOnClick,this)},t.prototype.onRefresh=function(){this.onShowInfo(),this.onSelectPsych(),this.getPlayer().updataAttribute()},t.prototype.trigger=function(){for(var e=0;e<GameDefine.Psych_Slot_Num;e++)this.points[e].checkPoint(!0,0,e);this.points[GameDefine.Psych_Slot_Num].checkPoint(!0,0,this.index),this.points[GameDefine.Psych_Slot_Num+1].checkPoint(!0,0,this.index)},t.prototype.onTouchReplace=function(){this.getPlayer().getPsychIsUnlockBySlot(this.index)?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PsychSelectPanel",new PsychSelectParam(0,this.currBase.slot))):GameCommon.getInstance().addAlert(PsychDefine.PSYCH_SLOT_LOCK[this.index]+"开启")},t.prototype.onTouchDecompose=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PsychDecompose")},t.prototype.onTouchUpgrade=function(){this.nextBase&&DataManager.getInstance().psychManager.onSendPsychUpgrade(0,this.currBase.slot)},t.prototype.onTouchPsych=function(e){var t=e.currentTarget;t.position!=this.index&&(this.index=t.position,this.onRefresh()),this.getPlayer().getPsychIsUnlockBySlot(this.currBase.slot)&&0==this.currBase.modelID&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PsychSelectPanel",new PsychSelectParam(0,this.currBase.slot)))},t.prototype.onSelectPsych=function(){for(var e,t=0;t<GameDefine.Psych_Slot_Num;t++){e=this["psych"+t],e.pos=t;var n=this.getPlayerData().getPsychBySlot(t);this.getPlayer().getPsychIsUnlockBySlot(t)?n.modelID>0?e.onUpdate(n,PSYCHSTATE_TYPE.SHOWNAME_AND_BG,0):e.onUpdate(n,PSYCHSTATE_TYPE.NONE,0):e.onUpdate(n,PSYCHSTATE_TYPE.LOCK,0),t==this.index?e.selected=!0:e.selected=!1}},t.prototype.onShowInfo=function(){if(this.currBase=this.getPlayerData().getPsychBySlot(this.index),this.nextBase=DataManager.getInstance().psychManager.getNextModel(this.currBase.modelID),this.getPlayer().getPsychIsUnlockBySlot(this.index))if(this.currBase.modelID>0){this.nextBase?this.currentState="activate":this.currentState="max";var e,t=this.currBase.model,n=this.nextBase,a=t||n,i=0;this.currLayer.removeChildren(),this.nextLayer.removeChildren();for(var o in a.attrAry)a.attrAry[o]>0&&(e=new AttributesText,i=t?t.attrAry[o]:0,e.updateAttr(o,i),this.currLayer.addChild(e),e=new AttributesText,i=n?n.attrAry[o]:0,e.updateAttr(o,i),this.nextLayer.addChild(e));this.updateGoodsADD()}else this.currentState="advance",this.currLayer.removeChildren(),this.nextLayer.removeChildren();else this.currentState="advance",this.currLayer.removeChildren(),this.nextLayer.removeChildren();this.onUpdatePlayerPower()},t.prototype.updateGoodsADD=function(){this.nextBase&&(this.currency.data=new CurrencyParam("",this.nextBase.cost.thingbase,!1))},t.prototype.onUpdatePlayerPower=function(){this.power.power=DataManager.getInstance().psychManager.getJobPsychPower(0)+""},t.prototype.onChangeRole=function(){this.onRefresh(),this.trigger()},t.prototype.onTouchBtnPreview=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PsychPreviewPanel")},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype["goto"]=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_LADDER)},t.prototype.strengthenMasterOnClick=function(){},t}(BaseTabView);__reflect(PsychPanel.prototype,"PsychPanel");var Psych_TYPE;!function(e){e[e.UNKNOW=-1]="UNKNOW",e[e.INTRODUCE=0]="INTRODUCE",e[e.GATHER=1]="GATHER",e[e.DEVOUR=2]="DEVOUR",e[e.CASTING=3]="CASTING",e[e.MAIN=4]="MAIN",e[e.ESCORT=5]="ESCORT"}(Psych_TYPE||(Psych_TYPE={}));var PsychPanel_TYPE;!function(e){e[e.ESCORT=0]="ESCORT",e[e.GATHER=1]="GATHER",e[e.DEVOUR=2]="DEVOUR",e[e.CASTING=3]="CASTING"}(PsychPanel_TYPE||(PsychPanel_TYPE={}));var PsychPreviewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychPreviewPanelSkin},t.prototype.onInit=function(){this.setTitle("元神预览");for(var t,n=DataManager.getInstance().psychManager.getOneLvAllPsych(),a=0;a<n.length;a++)t=new PsychInstance(a),t.onUpdate(new PsychBase(n[a]),PSYCHSTATE_TYPE.SHOWNAME,0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemLayer.addChild(t);e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){},t.prototype.onTouchItem=function(e){var t=e.currentTarget;GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("PsychIntroducebar",new PsychIntroducebarParam(t.thing.model)))},t}(BaseWindowPanel);__reflect(PsychPreviewPanel.prototype,"PsychPreviewPanel");var PsychSelectPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychSelectPanelSkin},t.prototype.onInit=function(){this.setTitle("元神背包"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){this.itemLayer.removeChildren(),this.bar.stopAnimation(),this.bar.viewport.scrollV=0;for(var e,t,n=[],a=0;a<GameDefine.Psych_Slot_Num;a++)e=this.getPlayerData(this.param.roleID).getPsychBySlot(a),e.modelID>0&&(a==this.param.slot&&(t=e),-1==n.indexOf(e.model.type)&&n.push(e.model.type));var i,o=DataManager.getInstance().psychManager.psychQueue,r=[];for(var s in o)e=o[s],-1==n.indexOf(e.model.type)?r.push(e):t&&t.model.type==e.model.type&&t.fightValue<e.fightValue&&r.push(e);r.sort(function(e,t){return t.fightValue-e.fightValue});for(var a=0;a<r.length;a++)i=new PsychSelectItem,i.data=r[a],i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.itemLayer.addChild(i)},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onTouchItem=function(e){var t=e.currentTarget;t&&(DataManager.getInstance().psychManager.onSendPsychEquip(this.param.roleID,this.param.slot,t.data.UID),this.onHide())},t.prototype.getPlayerData=function(e){return DataManager.getInstance().playerManager.player.getPlayerData(e)},t}(BaseWindowPanel);__reflect(PsychSelectPanel.prototype,"PsychSelectPanel");var PsychSelectItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.PsychSelectItemSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){this.psych.onUpdate(this._data,PSYCHSTATE_TYPE.NOLABEL,0),this.label_name.text=this._data.model.name,this.label_grade.text="战力："+this._data.fightValue;var e,t=this._data.model.attrAry;for(var n in t)t[n]>0&&(e=new suitAttributeItem,e.data=[Language.instance.getAttrName(n)+":",""+t[n],0],this.attrLayer.addChild(e))},t}(eui.Component);__reflect(PsychSelectItem.prototype,"PsychSelectItem");var PsychSelectParam=function(){function e(e,t){this.roleID=e,this.slot=t}return e}();__reflect(PsychSelectParam.prototype,"PsychSelectParam");var PulsePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.canUp=!1,n.animPos=new egret.Point(344,440),n.animType=0,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PulsePanelSkin},t.prototype.onInit=function(){for(var t,n=0;n<GameDefine.MAX_TIER;n++)t=this["acupoint"+n],t.index=n;this.label_get.text=Language.instance.getText("huoqutujing"),GameCommon.getInstance().addUnderlineGet(this.label_get),this.label_get.touchEnabled=!0,this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.points[0].register(this.btn_advance,GameDefine.RED_BTN_POS,DataManager.getInstance().pulseManager,"getJobCanPulseUpgrade"),this.btn_advance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_PULSE_UPGRADE_MESSAGE.toString(),this.onUpgradeBack,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameDispatcher.getInstance().addEventListener(GameEvent.PULSE_UP_FAIL_EVENET.toString(),this.onFailBack,this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetBtn,this),this.btn_advance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnAdvance,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_PULSE_UPGRADE_MESSAGE.toString(),this.onUpgradeBack,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.updateGoodsADD,this),GameDispatcher.getInstance().removeEventListener(GameEvent.PULSE_UP_FAIL_EVENET.toString(),this.onFailBack,this)},t.prototype.onRefresh=function(){var e=this.getPlayerData().pulseLv,t=JsonModelManager.instance.getModeljingmai()[e],n=JsonModelManager.instance.getModeljingmai()[e+1],a=t||n;if(t?this.mountName.text=t.jieduan+"阶"+t.level+"级":1>e?this.mountName.text="1阶":this.mountName.text="",n){var i=n.gailv/100;this.gailv_lab.text=Language.instance.getText("chenggonglv","：",i,"%")}else this.gailv_lab.text="";var o;this.curPro.removeChildren(),this.nextPro.removeChildren();var r=0;for(var s in a.attrAry)a.attrAry[s]>0&&(r=t?t.attrAry[s]:0,o=new AttributesText,o.updateAttr(s,r),this.curPro.addChild(o),n&&(r=n?n.attrAry[s]:0,o=new AttributesText,o.updateAttr(s,r),this.nextPro.addChild(o)));var h;this.canUp=!1;var l=0;n?(this.currentState="normal",0==n.cost.num?(this.btn_advance.label=Language.instance.getText("jingmaichongxue"),this.currency.visible=!1,this.animType=1):(this.btn_advance.label=Language.instance.getText("jingmaitisheng"),this.currency.visible=!0,this.animType=0)):this.currentState="max",0==e&&(this.animType=0),t&&(l=t.level);for(var g=0;g<GameDefine.MAX_TIER;g++)h=this["acupoint"+g],h.data=l;this.updateConsItem(),this.onUpdatePlayerPower()},t.prototype.trigger=function(){this.points[0].checkPoint(!0),this.points[1].checkPoint()},t.prototype.onUpgradeBack=function(){this.onRefresh();for(var e,t=0;t<GameDefine.MAX_TIER;t++)e=this["acupoint"+t],e.playSuccessAnim()},t.prototype.onFailBack=function(){for(var e,t=0;t<GameDefine.MAX_TIER;t++)e=this["acupoint"+t],e.playFailAnim()},t.prototype.onUpdatePlayerPower=function(){this.powerbar.power=DataManager.getInstance().pulseManager.pulsePower()},t.prototype.updateConsItem=function(){var e=this.getPlayerData().pulseLv,t=JsonModelManager.instance.getModeljingmai()[e+1];if(t){this.cost=t.cost;var n=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id,t.cost.type);t.cost.num<=n&&0!=e&&(this.canUp=!0),this.currency.setCostByAwardItem(t.cost)}else this.cost=null,this.currency.visible=!1},t.prototype.onGetBtn=function(e){GameCommon.getInstance().onShowFastBuy(this.cost.id)},t.prototype.updateGoodsADD=function(){this.updateConsItem()},t.prototype.onTouchBtnAdvance=function(){if(this.cost&&GameCommon.getInstance().onCheckItemConsume(this.cost.id,this.cost.num)){var e=new Message(MESSAGE_ID.PLAYER_PULSE_UPGRADE_MESSAGE);e.setByte(0),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.strengthenMasterBtnOnClick=function(){},t}(BaseTabView);__reflect(PulsePanel.prototype,"PulsePanel");var PulseProgress=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.PulseProgressSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this._level=e,this.onUpdate()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(){this.thumb.visible=this.thumbBg.visible=0!=this._index,this.movie||(this.movie=new Animation("jingmai",-1)),this.animLayer.removeChildren(),this.img_Activated.visible=!1,this._index==this._level?(this.setValue(this.maximum),this.img_Activated.visible=!0,this.animLayer.addChild(this.movie)):this._index>this._level?this.setValue(0):(this.img_Activated.visible=!0,this.setValue(this.maximum)),this.movie.onPlay()},t.prototype.playSuccessAnim=function(){if(this._index==this._level){var e=new Animation("jingmai_chenggong",1,!0);e.playFinishCallBack(this.playSuccessAnim2,this),this.animLayer.addChild(e)}},t.prototype.playSuccessAnim2=function(){var e=new Animation("jingmai_zhuzixunhuan",4,!0);e.rotation=-this.rotation,this.animLayer.addChild(e)},t.prototype.playFailAnim=function(){if(this._index==this._level+1){var e=new Animation("jingmai_shibai",1,!0);this.animLayer.addChild(e)}},Object.defineProperty(t.prototype,"index",{set:function(e){this._index=e},enumerable:!0,configurable:!0}),t}(eui.ProgressBar);__reflect(PulseProgress.prototype,"PulseProgress");var BaseGiftContainer=function(){function e(){}return e.prototype.showTips=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("WanbaGiftPanel",e))},e}();__reflect(BaseGiftContainer.prototype,"BaseGiftContainer",["ISDKGiftContainer"]);var BasePayContainer=function(){function e(e){this.owner=e}return e.prototype.showTips=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertDescUI",e))},e}();__reflect(BasePayContainer.prototype,"BasePayContainer",["ISDKPayContainer"]);var SDKGiftPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.goods=new GoodsInstance,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),SDKManager.loginInfo.channel==EChannel.CHANNEL_WANBA&&this.goods.onUpdate(GOODS_TYPE.BOX,SDKWanBa.getInstance().gift),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName="skins.SDKGiftPanelSkin"},t.prototype.onShowWithParam=function(e){this.result=e.result,this.box=e.box,this.onShow()},t.prototype.onRefresh=function(){this.result?(this.goods.onUpdate(GOODS_TYPE.BOX,this.box,0,1,1),this.labelTips.text="恭喜你获得",this.imageResult.source="gift_tip_success_png",this.imageTitle.source="gift_nice_png"):(this.goods.onUpdate(GOODS_TYPE.BOX,this.box,0,1,1),this.labelTips.text="你今天已经领取过",this.imageResult.source="gift_tip_daily_png",this.imageTitle.source="gift_reward_png")},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t}(BaseWindowPanel);__reflect(SDKGiftPanel.prototype,"SDKGiftPanel");var AraneRankPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaRankPanelSkin},t.prototype.onInit=function(){this.setTitle("榜单"),this.rank_scroll.verticalScrollBar.autoVisibility=!0,this.rank_scroll.verticalScrollBar.visible=!0,this.arena_rankList.itemRenderer=AraneRankItem,this.arena_rankList.itemRendererSkinName=skins.AraneRankItemSkin,this.arena_rankList.useVirtualLayout=!0,this.rank_scroll.viewport=this.arena_rankList,this.title3_lab.text=Language.instance.getText("power"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_RANK_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResArenaRankMsg=function(e){for(var t=[],n=e.message,a=n.getByte(),i=0;a>i;i++){var o=new ArenaRankData;o.rank=i+1,o.parseMsg(n),t.push(o)}this.arena_rankList.dataProvider=new eui.ArrayCollection(t);var r=DataManager.getInstance().arenaManager.arenaData;r.rank>0?(this.label_myrank.text=r.rank+"",this.not_rank_lab.visible=!1,this.rank_num_grp.visible=!0):(this.label_myrank.text="",this.not_rank_lab.visible=!0,this.rank_num_grp.visible=!1)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_CROSS_RANK_UPDATE_MESSAGE.toString(),this.onResArenaRankMsg,this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_CROSS_RANK_UPDATE_MESSAGE.toString(),this.onResArenaRankMsg,this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(AraneRankPanel.prototype,"AraneRankPanel");var AraneRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.bg_img.source=e.rank%2==0?"public_di1_png":"public_di5_png",this.rank_num_label.text=e.rank+"",this.rank_name_label.text=e.playerData.name,this.reward_label.text=GameCommon.getInstance().getFormatNumberShow(e.playerData.fightvalue)},t}(eui.ItemRenderer);__reflect(AraneRankItem.prototype,"AraneRankItem");var ArenaHistoryPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LocalArenaHistroySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.histroy_scroll.verticalScrollBar.autoVisibility=!1,this.histroy_scroll.verticalScrollBar.visible=!1,this.histroy_List.percentWidth=554,this.histroy_List.percentHeight=65,this.histroy_List.itemRenderer=ArenaHistroyItem,this.histroy_List.itemRendererSkinName=skins.AraneHistroyItemSkin,this.histroy_List.useVirtualLayout=!0,this.histroy_scroll.viewport=this.histroy_List,this.setTitle("arena_history_title_png"),this.onRefresh()},t.prototype.onRefresh=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_RANK_HISTROY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResArenaRankMsg=function(e){for(var t=[],n=e.message,a=n.getByte(),i=0;a>i;i++){var o=new ArenaHistoryData;o.index=i,o.parseMsg(n),t.push(o)}this.histroy_List.dataProvider=new eui.ArrayCollection(t)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE.toString(),this.onResArenaRankMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_RANK_HISTROY_MESSAGE.toString(),this.onResArenaRankMsg,this)},t}(BaseWindowPanel);__reflect(ArenaHistoryPanel.prototype,"ArenaHistoryPanel");var ArenaHistroyItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.result_icon.source=e.result==FightDefine.FIGHT_RESULT_SUCCESS?"fight_win_icon_png":"fight_lose_icon_png",this.time_label.text=e.timestr;var t="",n=Tool.getHtmlColorStr(e.targetName,"28e828");if(1==e.type)if(t+="您对"+n+"发起了挑战，",e.result==FightDefine.FIGHT_RESULT_SUCCESS){var a=e.changeRank>0?"您的排名上升至"+Tool.getHtmlColorStr(e.changeRank+"","28e828")+"名":"但您的排名没有发生变化";t+="挑战成功"+a}else t+="挑战失败您的排名没有发生变化";else if(t+=n+"对您发起了挑战",e.result==FightDefine.FIGHT_RESULT_SUCCESS)t+="但没有成功击败您，您的排名没有发生变化";else{var a=e.changeRank>0?"您的排名下降至"+Tool.getHtmlColorStr(e.changeRank+"","28e828")+"名":"但您的排名没有发生变化";t+="并且击败了您，"+a}this.histroyLabel.textFlow=(new egret.HtmlTextParser).parser(t)},t}(eui.ItemRenderer);__reflect(ArenaHistroyItem.prototype,"ArenaHistroyItem");var ServerArenaAwdPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.setTitle("排名奖励"),this.scroll.verticalScrollBar.autoVisibility=!1,this.scroll.verticalScrollBar.visible=!1,this.awardList.itemRenderer=ArenaSinlgeRankAwdItem,this.awardList.itemRendererSkinName=skins.ArenaSingleAwdItemSkin,this.awardList.useVirtualLayout=!0,this.scroll.viewport=this.awardList;var e=[];for(var t in JsonModelManager.instance.getModelkuafujingjichang())e.push(JsonModelManager.instance.getModelkuafujingjichang()[t]);this.awardList.dataProvider=new eui.ArrayCollection(e)},t.prototype.onSkinName=function(){this.skinName=skins.SeverArenaAwdPanelSkin},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.sure_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t}(BaseWindowPanel);__reflect(ServerArenaAwdPanel.prototype,"ServerArenaAwdPanel");var ArenaSinlgeRankAwdItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;e.min==e.max?(this.rank_icon.source="rankbg_"+Math.min(4,e.min)+"_png",this.rank_num_label.scaleX=this.rank_num_label.scaleY=1,this.rank_num_label.text=e.min+""):(this.rank_icon.source="",this.rank_num_label.scaleX=this.rank_num_label.scaleY=.6,this.rank_num_label.text=e.min+"-"+e.max),this.award_grp.removeChildren();for(var t=0;t<e.rewards.length;t++){var n=GameCommon.getInstance().createGoodsIntance(e.rewards[t]);this.award_grp.addChild(n)}},t}(BaseListItem);__reflect(ArenaSinlgeRankAwdItem.prototype,"ArenaSinlgeRankAwdItem");var ServerArenaPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ServerArenaPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),GameCommon.getInstance().addUnderlineStr(this.explain_label),GameCommon.getInstance().addUnderlineGet(this.get_num_label),this.explainStr=Language.instance.getText("kuafujingjichang"),this.explainStr=GameCommon.getInstance().readStringToHtml(this.explainStr);for(var t=0;t<GameDefine.Arena_Enemy_Max;t++){this["arena_fightItem"+t]}var n=DataManager.getInstance().playerManager.player;this.self_name_label.text=n.name,this.self_head_icon.setHead(n.headIndex,n.headFrameIndex);for(var a=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.KUAFU_MOBAI)),i=0;i<a.length;i++){var o=GameCommon.getInstance().createGoodsIntance(a[i]);this.worship_awd_grp.addChild(o)}this.onTouchExplain(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.get_num_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGetArenaNum,this),this.arena_shop_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAraneShop,this),this.refresh_list_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendRefreshEnemyListMsg,this),this.worship_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onWorship,this),this.award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdShowPanel,this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),this.arena_rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenArenaRankPanel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_CROSS_INFO_UPDATE_MESSAGE.toString(),this.onResArenaInfoUpdateMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE.toString(),this.onUpdateArenaCount,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE.toString(),this.onUpdateEmenyList,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ARENE_CROSS_WORSHIP_MESSAGE.toString(),this.onupdateWorship,this);for(var t=0;t<GameDefine.Arena_Enemy_Max;t++){var n=this["arena_fightItem"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchArenaItem,this)}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.get_num_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchGetArenaNum,this),this.refresh_list_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendRefreshEnemyListMsg,this),this.arena_shop_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAraneShop,this),this.worship_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onWorship,this),this.award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdShowPanel,this),this.explainLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),this.arena_rank_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenArenaRankPanel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_CROSS_INFO_UPDATE_MESSAGE.toString(),this.onResArenaInfoUpdateMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE.toString(),this.onUpdateArenaCount,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE.toString(),this.onUpdateEmenyList,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ARENE_CROSS_WORSHIP_MESSAGE.toString(),this.onupdateWorship,this);for(var t=0;t<GameDefine.Arena_Enemy_Max;t++){var n=this["arena_fightItem"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchArenaItem,this)}this.examineCD(!1)},t.prototype.onTouchExplain=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",this.explainStr))},t.prototype.onRefresh=function(){this.onSendArenaInfo()},t.prototype.onSendArenaInfo=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_INFO_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResArenaInfoUpdateMsg=function(){var e=DataManager.getInstance().arenaManager.arenaData;this.currentState=e.isOpen?"fight":"worship",e.isOpen?(this.onUpdateArenaCount(),this.status_label.text="距离结束："):(this.status_label.text="距离下赛季：",this.onupdateWorship()),e.lefttime>0&&this.examineCD(!0),e.rank>0?(this.self_rank_label.text=""+e.rank,this.not_rank_lab.visible=!1):(this.self_rank_label.text="",this.not_rank_lab.visible=!0),this.jingji_num_label.text=DataManager.getInstance().playerManager.player.shengwang+"",this.fight_num_label.text=DataManager.getInstance().playerManager.player.playerTotalPower+"",this.onUpdateEmenyList()},t.prototype.onUpdateEmenyList=function(){for(var e=(DataManager.getInstance().arenaManager.arenaData,0);e<GameDefine.Arena_Enemy_Max;e++){var t=DataManager.getInstance().arenaManager.arenaData.enemyList[e],n=this["arena_fightItem"+e];n.data=t}},t.prototype.onTouchArenaItem=function(e){if(DataManager.getInstance().arenaManager.arenaData.isOpen){var t=e.currentTarget;if(t.data){var n=[{text:"是否对玩家",style:{}},{text:t.data.playerData.name,style:{textColor:2680872}},{text:"发起挑战？",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertEscort",new AlertEscortParam(n,this.onSendArenaFightMsg,this,t.data)))}}},t.prototype.onSendArenaFightMsg=function(e){GameFight.getInstance().onSendArenaFightMsg(e.rank)},t.prototype.onUpdateArenaCount=function(){var e=DataManager.getInstance().arenaManager.arenaData;this.lefttimes_lab.text=e.isOpen?e.fightCount+"/"+Constant.get(Constant.KUAFU_FIGHT_NUM):""},t.prototype.onTouchGetArenaNum=function(){var e=DataManager.getInstance().arenaManager.arenaData;if(e.isOpen){var t=Constant.get(Constant.KUAFU_FIGHT_BUY_PRICE).split(","),n=parseInt(e.buyCount<t.length?t[e.buyCount]:t[t.length-1]),a=[{text:"是否消耗"+n+"钻石购买一次挑战次数？",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(a,function(e){if(DataManager.getInstance().playerManager.player.gold<e)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var t=new Message(MESSAGE_ID.ARENE_CROSS_BUY_FIGHTCOUNT_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)},this,n)))}},t.prototype.examineCD=function(e){this._timeOpen!=e&&(this._timeOpen=e,e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3))},t.prototype.onCountDown=function(){var e=Math.ceil((DataManager.getInstance().arenaManager.arenaData.lefttime-egret.getTimer())/1e3);e>0||(e=0,this.examineCD(!1),Tool.callbackTime(this.onSendArenaInfo,this,5e3)),this.lefttime_label.text=GameCommon.getInstance().getTimeStrForSec1(e)},t.prototype.onSendRefreshEnemyListMsg=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_REFRESH_ENEMYLIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onOpenAraneShop=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PvPShopPanel")},t.prototype.onOpenAwdShowPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ServerArenaAwdPanel")},t.prototype.onOpenArenaRankPanel=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"AraneRankPanel")},t.prototype.onupdateWorship=function(){DataManager.getInstance().arenaManager.isWorship?(this.worship_btn.enabled=!1,this.worship_btn.label=Language.instance.getText("yimobai")):(this.worship_btn.enabled=!0,this.worship_btn.label=Language.instance.getText("mobai"))},t.prototype.onWorship=function(){var e=new Message(MESSAGE_ID.ARENE_CROSS_WORSHIP_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(ServerArenaPanel.prototype,"ServerArenaPanel");var AraneMatchItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.AraneMatchItemSkin},t.prototype.onInit=function(){this._data||this.dataChanged()},t.prototype.dataChanged=function(){if(this._data){var e=this._data.showAppear;this.roleAppear||(this.roleAppear=new RoleAppearBody),this.roleAppear.parent||this.role_group.addChild(this.roleAppear);for(var t=[],n=0;n<BLESS_TYPE.SIZE;n++)t[n]=e.appears[n];this.roleAppear.updateAvatarAnim(t,e.sex),this.name_label.text=this._data.playerData.name,this.power_label.text=""+this._data.playerData.fightvalue,this.rank_label.text="第 "+this._data.rank+" 名"}else this.rank_label.text="",this.name_label.text="虚席以待",this.power_label.text="",this.roleAppear&&this.roleAppear.parent&&this.roleAppear.parent.removeChild(this.roleAppear)},t}(BaseComp);__reflect(AraneMatchItem.prototype,"AraneMatchItem");var ServerPVEBossAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.currIndex=0,n.TAB_MAX=4,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.setTitle("排行奖励"),this.models=[];for(var t in JsonModelManager.instance.getModelkuafubossrewards()){var n=JsonModelManager.instance.getModelkuafubossrewards()[t];n.ranking>0&&(this.models[n.bossId-1]||(this.models[n.bossId-1]=[]),this.models[n.bossId-1].push(n))}for(var a=0;a<this.models.length;a++){this.models[a].sort(function(e,t){return e.ranking-t.ranking});var i=this.models[a][0],o=JsonModelManager.instance.getModelkuafuboss()[i.bossId];this["tab"+a].tab_name.text=o.limitLevel+"转"}this["tab"+this.currIndex].selected=!0,e.prototype.onInit.call(this),this.onRefresh()
},t.prototype.onSkinName=function(){this.skinName=skins.ServerPVEBossAwdView},t.prototype.onRefresh=function(){for(var e=this.models[this.currIndex],t=0;t<e.length&&this["award_group"+t];t++){this["award_group"+t].removeChildren();for(var n=0;n<e[t].rewards.length;n++){var a=e[t].rewards[n],i=GameCommon.getInstance().createGoodsIntance(a);this["award_group"+t].addChild(i)}}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.TAB_MAX;t++)this["tab"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.TAB_MAX;t++)this["tab"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.sure_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onTouchTabBtn=function(e){var t=e.currentTarget;t.value!=this.currIndex&&(this.currIndex=t.value,this.onRefresh())},t}(BaseWindowPanel);__reflect(ServerPVEBossAwardPanel.prototype,"ServerPVEBossAwardPanel");var ServerPVEBossDmgView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.leftCloseTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraKillerLogSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_RANK_MESSAGE.toString(),this.onResDamageRankMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_RANK_MESSAGE.toString(),this.onResDamageRankMsg,this)},Object.defineProperty(t.prototype,"data",{get:function(){return DataManager.getInstance().dupManager.crossPVEBoss},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.setTitle("伤害排行"),this.setTitlePercent(.9),this.itemGroup.itemRenderer=ServerPVEBossDmgItem,this.itemGroup.itemRendererSkinName=skins.SamsaraKillerLogItemSkin,this.itemGroup.useVirtualLayout=!1,this.boss_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){DataManager.getInstance().dupManager.sendPVEBossDmgRankRequst(this.param.bossId)},t.prototype.onRequestKillLogMsg=function(){var e=new Message(MESSAGE_ID.CROSS_PVEBOSS_RANK_MESSAGE);e.setShort(this.param.bossId),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResDamageRankMsg=function(e){this.itemGroup.dataProvider=new eui.ArrayCollection(this.data.rankList),this.boss_scroll.viewport.scrollV=0,this.param.autoClose>0?(this.leftCloseTime=this.param.autoClose,Tool.addTimer(this.autoCloseHandler,this,1e3)):this.btn_sure.label=Language.instance.getText("sure");var t=Language.instance.getText("wodepaiming",":",this.data.myRankNum>0?this.data.myRankNum+"":"weishangbang"),n="";this.param.damageVaule>0&&(n=Language.instance.getText("current2","dps",":",this.param.damageVaule+"")),this.killer_label.text=t+"   "+n},t.prototype.autoCloseHandler=function(){this.leftCloseTime--,this.btn_sure.label=Language.instance.getText("sure")+"("+this.leftCloseTime+")",this.leftCloseTime<=0&&this.onHide()},t.prototype.onShowWithParam=function(e){this.param=e,this.param&&this.onShow()},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.autoCloseHandler,this,1e3),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.CROSS_PVE_BOSS&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t}(BaseWindowPanel);__reflect(ServerPVEBossDmgView.prototype,"ServerPVEBossDmgView");var ServerPVEBossDmgItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;this.rank_num.text=""+e.rank,e.playerData.viplevel>0?this.vip_label.visible=!0:this.vip_label.visible=!1,this.name_label.text=e.playerData.name,this.power_label.text=""+e.damageValue},t}(BaseListItem);__reflect(ServerPVEBossDmgItem.prototype,"ServerPVEBossDmgItem");var ServerPVEBossDmgParam=function(){function e(e,t,n){void 0===n&&(n=0),this.autoClose=0,this.damageVaule=0,this.bossId=e,this.damageVaule=t,this.autoClose=n}return e}();__reflect(ServerPVEBossDmgParam.prototype,"ServerPVEBossDmgParam");var ServerPVEBossPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ServerPVEBossPanelSkin},Object.defineProperty(t.prototype,"bossData",{get:function(){return DataManager.getInstance().dupManager.crossPVEBoss},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){e.prototype.onInit.call(this);for(var t in JsonModelManager.instance.getModelkuafuboss()){var n=JsonModelManager.instance.getModelkuafuboss()[t],a=this["tab"+parseInt(t)];if(!a)break;a.icon=GameCommon.getInstance().getHeadIconByModelid(n.modelId),a.label=n.limitLevel+"转"}GameCommon.getInstance().addUnderlineStr(this.loop_rank_lab),GameCommon.getInstance().addUnderlineStr(this.wanfashuoming_lab),this.onTouchExplain(),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),this.fight_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterFight,this),this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyCount,this),this.award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAward,this),this.rankLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRankView,this);for(var t in JsonModelManager.instance.getModelkuafuboss()){var n=(JsonModelManager.instance.getModelkuafuboss()[t],this["tab"+parseInt(t)]);if(!n)break;n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}for(var a=0;6>a;a++)this["boximg"+a].name=a+"",this["boximg"+a].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_COUNTBUY_MESSAGE.toString(),this.onUpdateFightCount,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.explainLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),this.fight_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterFight,this),this.buy_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyCount,this),this.award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAward,this),this.rankLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRankView,this);for(var t in JsonModelManager.instance.getModelkuafuboss()){var n=(JsonModelManager.instance.getModelkuafuboss()[t],this["tab"+parseInt(t)]);if(!n)break;n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}for(var a=0;6>a;a++)this["boximg"+a].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.CROSS_PVEBOSS_COUNTBUY_MESSAGE.toString(),this.onUpdateFightCount,this),this.examineCD(!1)},t.prototype.onRefresh=function(){this.isRequestInfo=!1,this.onSendPVEBossInfoRequest()},t.prototype.onTouchExplain=function(){var e=Language.instance.getText("kuafuboss");e=GameCommon.getInstance().readStringToHtml(e),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",e)),e=null},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currTab!=t.value&&(this.currTab=t.value,this.onTabHanlder())},t.prototype.onTabHanlder=function(){var e=JsonModelManager.instance.getModelkuafuboss()[this.currTab],t=ModelManager.getInstance().getModelFigher(e.modelId);this.boss_name_lab.text=t.name,this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,e.modelId),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim),this.onUpdateFightCount(),this.onUpdateBoxStatus()},t.prototype.onUpdateFightCount=function(){if(this.currTab==this.bossData.fightID)this.fight_btn.visible=!0,this.figthstatus_grp.bottom=300,this.status_labal.text=Language.instance.getText("shengyucishu")+":",this.fight_count_lab.text=this.bossData.fightcount+"/"+Constant.get(Constant.KUAFU_BOSS_NUM),this.fight_btn.enabled=this.bossData.fightcount>0;else{this.fight_btn.visible=!1,this.fight_count_lab.text="",this.figthstatus_grp.bottom=250;var e=JsonModelManager.instance.getModelkuafuboss()[this.currTab],t=DataManager.getInstance().playerManager.player.coatardLv;e.limitLevel<=t?this.status_labal.text=this.bossData.fightID<this.currTab?"下期即可挑战":"已超过挑战等级":this.status_labal.text="达到"+e.limitLevel+"阶即可挑战"}},t.prototype.onUpdateBoxStatus=function(){this.damageAwards=[];for(var e in JsonModelManager.instance.getModelkuafubossrewards()){var t=JsonModelManager.instance.getModelkuafubossrewards()[e];t.bossId==this.currTab&&t.damage>0&&this.damageAwards.push(t)}this.damageAwards.sort(function(e,t){return e.damage-t.damage});for(var n=0;n<this.damageAwards.length;n++){var t=this.damageAwards[n],a=t.damage;t.rewards[0];if(!this["boximg"+n])break;this.bossData.myDamageNum<a?this["boximg"+n].source="cross_pveboss_box_unopen_png":this["boximg"+n].source="cross_pveboss_box_open_png",this["boxname_lab"+n].text=GameCommon.getInstance().getFormatNumberShow(t.damage)}},t.prototype.onReciveBossInfoMsg=function(){this.isRequestInfo=!1,this.examineCD(!0),this.currTab=this.bossData.fightID>0?this.bossData.fightID:1,this.total_damage_lab.text=this.bossData.myDamageNum+"",this["tab"+this.currTab].selected=!0,this.onTabHanlder()},t.prototype.examineCD=function(e){this._timeOpen!=e&&(this._timeOpen=e,e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3))},t.prototype.onCountDown=function(){var e=this.bossData.lefttime;0>=e&&(e=0,this.examineCD(!1),this.onSendPVEBossInfoRequest()),this.lefttime_label.text=Language.instance.getText(this.bossData.isOpen?"BOSS结束时间 ":"BOSS复活时间 ")+GameCommon.getInstance().getTimeStrForSec1(e)},t.prototype.onSendPVEBossInfoRequest=function(){this.isRequestInfo||(this.isRequestInfo=!0,DataManager.getInstance().dupManager.sendPVEBossInfoRequst())},t.prototype.onEnterFight=function(){GameFight.getInstance().onEnterCrossPVEBossScene()},t.prototype.onShowAward=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ServerPVEBossAwardPanel")},t.prototype.onShowRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ServerPVEBossDmgView",new ServerPVEBossDmgParam(this.bossData.fightID,0)))},t.prototype.onBuyCount=function(){if(this.bossData.isOpen){var e=Constant.get(Constant.KUAFU_BOSS_BUY).split(","),t=parseInt(this.bossData.buycount<e.length?e[this.bossData.buycount]:e[e.length-1]);if(DataManager.getInstance().playerManager.player.gold<t)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var n=[{text:"是否消耗"+t+"钻石购买一次挑战次数？",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,this.onsendBuyCountMsg,this)))}},t.prototype.onsendBuyCountMsg=function(){var e=new Message(MESSAGE_ID.CROSS_PVEBOSS_COUNTBUY_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onTouchBox=function(e){var t=e.currentTarget,n=this.damageAwards[parseInt(t.name)];if(n){var a=n.rewards[0];if(a){var i=GameCommon.getInstance().getThingModel(a.type,a.id),o=new ThingBase(i.type);o.onupdate(i.id,i.quality,0),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,GOODS_TYPE.BOX,o,0)))}}},t}(BaseTabView);__reflect(ServerPVEBossPanel.prototype,"ServerPVEBossPanel");var BatchDisposebar=function(e){function t(){var t=e.call(this)||this;return t.radio_type=-1,t.skinName=skins.BatchDisposebarSkin,t}return __extends(t,e),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t.prototype.onTouchAdd=function(){this.num+=1,this.num>this.max()&&(this.num=this.max()),this.setNum(this.num)},t.prototype.onTouchReduce=function(){if(this.num-=1,this.num<=0){if(0==this.max())return this.num=0,void this.setNum(this.num);this.num=1}this.setNum(this.num)},t.prototype.onTouchMin=function(){this.setNum(this.min())},t.prototype.onTouchMax=function(){switch(this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:this.setNum(this.max());break;case t.BATCH_TYPE_BUY:case t.BATCH_TYPE_CONNT:this.setNum(this.addTEN());break;case t.BATH_TYPE_RNUES:case t.BATH_TYPE_ZHANWEN:this.setNum(this.addTEN())}},t.prototype.onTouchBuy=function(){switch(this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:var e=new Message(MESSAGE_ID.GOODS_LIST_USE_MESSAGE);e.setByte(this._model.type),e.setShort(this._model.modelId),e.setInt(this.num),this.radio_type>=0&&e.setByte(this.radio_type),GameCommon.getInstance().sendMsgToServer(e);break;case t.BATCH_TYPE_BUY:if(this.sum>this.ownCurrency())return void GameCommon.getInstance().addAlert("当前货币不足");var e=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);e.setByte(this._model.shopType),e.setInt(this._model.id),e.setInt(this.num),GameCommon.getInstance().sendMsgToServer(e)}this.owner&&this.owner.onHide&&this.owner.onHide()},t.prototype.setNum=function(e){if(void 0!=e)switch(this.num=e,this.label_num.text=e.toString(),this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:case t.BATH_TYPE_ZHANWEN:this.label_min.text="最小",this.label_max.text="最大";break;case t.BATCH_TYPE_VIP:case t.BATCH_TYPE_BUY:this.sum=this.num*this.price;var n=this.sum>this.ownCurrency()?16711680:16777215;this.label_money.textFlow=new Array({text:this.sum.toString(),style:{textColor:n}}),this.label_min.text="-10",this.label_max.text="+10";break;case t.BATCH_TYPE_CONNT:this.updateCallFunc&&Tool.callback(this.updateCallFunc,this.updateCallObj),this.label_min.text="-10",this.label_max.text="+10"}},t.prototype.onUpdate=function(e){switch(void 0===e&&(e=null),this._model=e,this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:this.setNum(this.max()),this.modelprice=null;break;case t.BATCH_TYPE_BUY:this.img_payIcon.source=ShopPanel.getPayIcon(e.shopType),this.img_payIcon0.source=ShopPanel.getPayIcon(e.shopType),this.modelprice=GameCommon.getInstance().onParseAwardItemstr(this._model.price),this.setNum(1);break;case t.BATCH_TYPE_CONNT:this.setNum(1),this.modelprice=null;break;case t.BATCH_TYPE_VIP:this.modelprice=[],this.modelprice.push(this._model.model.cost),this.setNum(1);break;case t.BATH_TYPE_RNUES:case t.BATH_TYPE_ZHANWEN:this.setNum(this.model.maxNum)}},Object.defineProperty(t.prototype,"price",{get:function(){var e=0;if(this._model&&(this.currentState==t.BATCH_TYPE_BUY||this.currentState==t.BATCH_TYPE_VIP)){var n=100;DataManager.getInstance().shopManager.discountMap[this._model.shopType]&&(n=DataManager.getInstance().shopManager.discountMap[this._model.shopType]),e=this.modelprice?Tool.toInt(this.modelprice[0].num*n/100):Tool.toInt(this._model.price[0].num*n/100)}return e},enumerable:!0,configurable:!0}),t.prototype.ownCurrency=function(){return this.modelprice?ShopPanel.getCurrency(this.modelprice[0].type):ShopPanel.getCurrency(this._model.price[0].type)},t.prototype.min=function(){switch(this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:return 1;case t.BATH_TYPE_ZHANWEN:return 0;case t.BATCH_TYPE_BUY:var e;return e=this.num-10>=0?this.num-10:1,Math.max(e,1);case t.BATCH_TYPE_CONNT:return Math.max(this.num-10,1);case t.BATH_TYPE_RNUES:var e;return e=this.num-10>=0?this.num-10:0}},t.prototype.addTEN=function(){switch(this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:var e=DataManager.getInstance().bagManager.getGoodsThingById(this._model.modelId,GOODS_TYPE.BOX),n=e?e.num:0;return Math.max(0,n);case t.BATH_TYPE_ZHANWEN:return 0==this.max()?0:Math.min(this.max()>0?this.max():9999999);case t.BATCH_TYPE_BUY:var a;return a=this.num<=1?Math.min(10,Math.floor(this.ownCurrency()/this.price)):Math.min(this.num+10,Math.floor(this.ownCurrency()/this.price)),Math.max(a,1);case t.BATCH_TYPE_CONNT:return Math.min(this.num+10,this.max()>0?this.max():9999999);case t.BATH_TYPE_RNUES:case t.BATH_TYPE_ZHANWEN:return 0==this.max()?0:Math.min(this.num+10,this.max()>0?this.max():9999999)}},t.prototype.max=function(){switch(this.currentState){case t.BATCH_TYPE_USE:case t.BATCH_TYPE_USE2:var e=DataManager.getInstance().bagManager.getGoodsThingById(this._model.modelId,GOODS_TYPE.BOX),n=e?e.num:0;return Math.max(0,n);case t.BATCH_TYPE_BUY:return Math.max(1,Math.floor(this.ownCurrency()/this.price));case t.BATCH_TYPE_CONNT:return this.model.maxNum;case t.BATH_TYPE_RNUES:case t.BATH_TYPE_ZHANWEN:return this.model.maxNum}},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onInputChage=function(e){if(this.visible){var t=e.target,n=Tool.isNumber(parseInt(t.text))?parseInt(t.text):1;n>this.max()?(this.num=this.max(),this.setNum(this.num)):this.setNum(n)}},t.prototype.onTouchRadioButton=function(e){this.radio_type=parseInt(e.target.value)},t.prototype.onRegist=function(){this.label_num.addEventListener(egret.Event.CHANGE,this.onInputChage,this),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdd,this),this.btnReduce.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReduce,this),this.btn_min.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMin,this),this.btn_max.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMax,this),this.radio0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this)},t.prototype.onRemove=function(){this.label_num.removeEventListener(egret.Event.CHANGE,this.onInputChage,this),this.btnAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAdd,this),this.btnReduce.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchReduce,this),this.btn_min.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMin,this),this.btn_max.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMax,this),this.radio1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this),this.radio0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchRadioButton,this)},Object.defineProperty(t.prototype,"count",{get:function(){return this.num},enumerable:!0,configurable:!0}),t.prototype.onSetUpdateCall=function(e,t){this.updateCallFunc=e,this.updateCallObj=t},t.BATCH_TYPE_USE="use",t.BATCH_TYPE_BUY="buy",t.BATCH_TYPE_CONNT="count",t.BATCH_TYPE_USE2="use2",t.BATCH_TYPE_VIP="vip",t.BATH_TYPE_RNUES="rnues",t.BATH_TYPE_ZHANWEN="zhanwen",t}(eui.Component);__reflect(BatchDisposebar.prototype,"BatchDisposebar");var BatchParam=function(){function e(){this.maxNum=0}return e}();__reflect(BatchParam.prototype,"BatchParam");var PvPShopPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=0,n.priority=PANEL_HIERARCHY_TYPE.II,n.shopTps=[SHOP_TYPE.RONGYU,SHOP_TYPE.ARENA,SHOP_TYPE.SHENGWANG],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PvpShopSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("商店");var t=new eui.Button;t.skinName=skins.ScrollerTabBtnSkin;for(var n=0;3>n;n++){var a;a=new BaseTabButton("",ShopDefine.SHOP_NAMEs[this.shopTps[n]]),0==n&&(a.selected=!0),a.width=103,a.name=n+"",a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBtn,this),this.btnGroup.addChild(a)}this.currType=this.shopTps[0],this.onRefresh()},t.prototype.onEventBtn=function(e){var t=parseInt(e.target.name);this.currType=this.shopTps[t],this.index=t,this.onRefresh()},t.prototype.onRefresh=function(){this.currType=this.shopTps[this.index],this.invalidateState()},t.prototype.onDestory=function(){this.goodsLayer.removeChildren()},Object.defineProperty(t.prototype,"currType",{set:function(e){if(this._currType=e,this.scroll.stopAnimation(),this.onUpdateCurrency(),this._currType!=SHOP_TYPE.TURNPLATE)this.onRequsetDiscount();else{var t=new Message(MESSAGE_ID.PLAYER_SHENMISHOP_GOODS_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)}},enumerable:!0,configurable:!0}),t.prototype.onRequsetDiscount=function(){if(this._initDiscount)this.showGoods();else{this._initDiscount=!0;var e=new Message(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.showGoods=function(){var e,t=0;this.goodsLayer.removeChildren();var n=DataManager.getInstance().shopManager.getGoodsByTye(this._currType);if(n){var a=DataManager.getInstance().pvpManager.getModelCurr(),i=[];t=n.length;for(var o=0;t>o;o++)e=new ShopItem,e.cfgId=n[o].id,e.data=n[o],DataManager.getInstance().shopManager.restrictionBuy[n[o].id]&&DataManager.getInstance().shopManager.restrictionBuy[n[o].id]>=n[o].xiangoucishu?e.itemStgate=1:n[o].pvpLevel<=a.lv?e.itemStgate=3:e.itemStgate=2,e.img_payIcon.source=ShopPanel.getPayIcon(this._currType),i.push(e);i.sort(function(e,t){return t.itemStgate==e.itemStgate?e.cfgId-t.cfgId:t.itemStgate-e.itemStgate});for(var r in i)i[r]&&this.goodsLayer.addChild(i[r]);this.scroll.viewport.scrollV=0}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE.toString(),this.showGoods,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SHOP_BUYGOODS,this.onItemBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE.toString(),this.showGoods,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SHOP_BUYGOODS,this.onItemBack,this),this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null),this.onDestory(),this._initDiscount=!1},t.prototype.updateInfo=function(e){var t=parseInt(e);if(0==t)GameCommon.getInstance().addAlert("购买失败");else{var n=new Message(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(n),GameCommon.getInstance().addAlert("购买成功")}},t.prototype.updategoods=function(e){var t=e.message;this.timedate=t.getInt();var n=t.getByte();this.itemdata=[];for(var a=0;n>a;a++){var i=new shopdate;i.type=t.getByte(),i.id=t.getShort(),i.quality=t.getByte(),i.num=t.getInt(),i.buyNum=t.getInt(),i._discount=t.getByte(),i._$type=t.getByte(),i._$mach=t.getInt(),this.itemdata.push(i)}this.timeh=Math.floor(this.timedate/3600),this.timem=Math.floor((this.timedate-3600*this.timeh)/60),this.times=this.timedate-3600*this.timeh-60*this.timem,this.timeh<10?this.times<10?this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":"+this.times:this.times<10?this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":"+this.times,this.timer||(this.timer=new egret.Timer(1e3)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start()},t.prototype.timerFunc=function(){this.timeh=Math.floor(this.timedate/3600),this.timem=Math.floor((this.timedate-3600*this.timeh)/60),this.times=this.timedate-3600*this.timeh-60*this.timem,this.timeh<10?this.times<10?this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":"+this.times:this.times<10?this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":"+this.times,this.timedate--},t.prototype.timerComFunc=function(){this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null},t.prototype.onUpdateCurrency=function(){this._currType==SHOP_TYPE.RONGYU?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.RONGYU,0,-1)):this._currType==SHOP_TYPE.ARENA?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.RONGYU,0,-1)):this._currType==SHOP_TYPE.JIFEN?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.SHOJIFEN,0,-1)):this._currType==SHOP_TYPE.SHENGWANG?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.SHENGWANG,0,-1)):this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.GOLD,0,-1)),this.gold.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.DIAMOND,0,-1))},t.prototype.onItemBack=function(e){var t=e.data;if(this._currType==SHOP_TYPE.TURNPLATE)var n=ShopPanel.getCurrency(this._currType);else var n=ShopPanel.getCurrency(this._currType);var a=GameCommon.getInstance().onParseAwardItemstr(t.price);if(n<a[0].num)return void GameCommon.getInstance().addAlert("货币不足，无法购买");var i=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);i.setByte(t.shopType),i.setInt(t.id),i.setInt(1),GameCommon.getInstance().sendMsgToServer(i)},t}(BaseWindowPanel);__reflect(PvPShopPanel.prototype,"PvPShopPanel");var ShopPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.register=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.onRegist(),this.setTitle("商城"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){if(!this.register){e.prototype.onRegist.call(this);for(var t,n=[],a=0;a<this.types.length;a++)t=new RegisterSystemParam,t.sysName="ShopTypePanel",t.btnRes=ShopDefine.SHOP_NAMEs[this.types[a]],n.push(t);t=new RegisterSystemParam,t.sysName="ActivitysXiangouPanel",t.btnRes="限购好礼",n.push(t),this.registerPage(n,"shopGrp",GameDefine.RED_TAB_POS),this.register=!0}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.register=!1},t.prototype.onShowWithParam=function(e){this.index=e.type,this.types=e.types,this.onShow()},t.prototype.currentShopType=function(){return this.types[this.index]},t.getPayIcon=function(e){switch(e){case SHOP_TYPE.DAOJU:return"zuanshi_png";case SHOP_TYPE.JIFEN:return"djifen_png";case SHOP_TYPE.RONGYU:case SHOP_TYPE.ARENA:return"dgongxun_png";case SHOP_TYPE.SHENGWANG:return"shengwang_png";case SHOP_TYPE.TURNPLATE:return"zuanshi_png";case SHOP_TYPE.YAOQIANSHU1:case SHOP_TYPE.YAOQIANSHU2:return"turnplate_integral_icon_png"}},t.getCurrency=function(e,t){void 0===t&&(t=0);var n=0;switch(e){case GOODS_TYPE.ITEM:var a=DataManager.getInstance().bagManager.getGoodsThingById(t);n=a?a.num:0;break;default:n=DataManager.getInstance().playerManager.player.getICurrency(e)}return n},t}(BaseSystemPanel);__reflect(ShopPanel.prototype,"ShopPanel");var ShopParam=function(){function e(e,t){void 0===t&&(t=0),this.types=e,this.type=t}return e}();__reflect(ShopParam.prototype,"ShopParam");var ShopTypePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ShopPanelSkin},t.prototype.onInit=function(){this.yuanbaoNum.text="刷新"+Constant.get(Constant.SHOP_PLAYER_REFRESH),e.prototype.onInit.call(this),this.onRefresh(),this.currType=this.owner.currentShopType()},t.prototype.onRefresh=function(){this.yuanbaoimg.touchEnabled=!1;var e=this.owner.currentShopType();this.currType=e,this.invalidateState()},t.prototype.onDestory=function(){this.goodsLayer.removeChildren()},Object.defineProperty(t.prototype,"currType",{set:function(e){if(this._currType=e,this.scroll.stopAnimation(),this.onUpdateCurrency(),this._currType!=SHOP_TYPE.TURNPLATE)this.onRequsetDiscount();else{var t=new Message(MESSAGE_ID.PLAYER_SHENMISHOP_GOODS_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)}(this._currType==SHOP_TYPE.JIFEN||this._currType==SHOP_TYPE.RONGYU||this._currType==SHOP_TYPE.ARENA)&&(this.note.source="shop_text_"+this._currType+"_png",this._currType==SHOP_TYPE.JIFEN?this["goto"].parent&&this["goto"].parent.removeChild(this["goto"]):(this["goto"].parent||this.textGrp.addChild(this["goto"]),this["goto"].visible=!0,this["goto"].textColor=65280,GameCommon.getInstance().addUnderlineStr(this["goto"],"前往"),this["goto"].hasEventListener&&this["goto"].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoHandler,this),this["goto"].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoHandler,this)))},enumerable:!0,configurable:!0}),t.prototype.onRequsetDiscount=function(){if(this._initDiscount)this.showGoods();else{this._initDiscount=!0;var e=new Message(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.showGoods=function(){var e,t=0;this.goodsLayer.removeChildren();var n=DataManager.getInstance().shopManager.getGoodsByTye(this._currType);if(n){t=n.length;for(var a=0;t>a;a++)e=new ShopItem,e.data=n[a],this._currType==SHOP_TYPE.JIFEN&&(e.currentState="jifen"),e.img_payIcon.source=ShopPanel.getPayIcon(this._currType),this.goodsLayer.addChild(e);this.scroll.viewport.scrollV=0}},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.updateBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.update,this),this.onebuyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onbuyfunc,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_SHENMISHOP_GOODS_MESSAGE.toString(),this.updategoods,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_SHENMISHOP_BUY_MESSAGE.toString(),this.upbuy,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE.toString(),this.showGoods,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_SHOP_BUYGOODS,this.onItemBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.updateBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.update,this),this.onebuyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onbuyfunc,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_SHENMISHOP_GOODS_MESSAGE.toString(),this.updategoods,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_SHENMISHOP_BUY_MESSAGE.toString(),this.upbuy,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.SHOP_DISCOUNT_INFO_MESSAGE.toString(),this.showGoods,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_SHOP_BUYGOODS,this.onItemBack,this),this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null),this.onDestory(),this._initDiscount=!1
},t.prototype.onbuyfunc=function(e){var t=new Message(MESSAGE_ID.PLAYER_SHENMISHOP_BUY_MESSAGE);t.setByte(-1),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.update=function(e){var t=new Message(MESSAGE_ID.PLAYER_SHENMISHOP_UPDATE_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)},t.prototype.updateInfo=function(e){var t=parseInt(e);0==t?GameCommon.getInstance().addAlert("购买失败"):GameCommon.getInstance().addAlert("购买成功")},t.prototype.upbuy=function(e){for(var t=e.message,n=t.getByte(),a=0;n>a;a++){var i=t.getByte();this.itemdata[i].buyNum=t.getInt()}this.shenmishopdate()},t.prototype.updategoods=function(e){var t=e.message;this.timedate=t.getInt();var n=t.getByte();this.itemdata=[];for(var a=0;n>a;a++){var i=new shopdate;i.type=t.getByte(),i.id=t.getShort(),i.quality=t.getByte(),i.num=t.getInt(),i.buyNum=t.getInt(),i._discount=t.getByte(),i._$type=t.getByte(),i._$mach=t.getInt(),this.itemdata.push(i)}this.timeh=Math.floor(this.timedate/3600),this.timem=Math.floor((this.timedate-3600*this.timeh)/60),this.times=this.timedate-3600*this.timeh-60*this.timem,this.timeh<10?this.times<10?this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":"+this.times:this.times<10?this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":"+this.times,this.timer||(this.timer=new egret.Timer(1e3)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start(),this.shenmishopdate()},t.prototype.timerFunc=function(){this.timeh=Math.floor(this.timedate/3600),this.timem=Math.floor((this.timedate-3600*this.timeh)/60),this.times=this.timedate-3600*this.timeh-60*this.timem,this.timeh<10?this.times<10?this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r0"+this.timeh+":"+this.timem+":"+this.times:this.times<10?this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":0"+this.times:this.timelab.text="距离下次刷新\r"+this.timeh+":"+this.timem+":"+this.times,this.timedate--},t.prototype.timerComFunc=function(){this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer=null},t.prototype.shenmishopdate=function(){var e,t=0;this.goodsLayer.removeChildren();var n=this.itemdata;if(n){t=this.itemdata.length;for(var a=0;t>a;a++)e=new ShopItem,e.shenmmidata=n[a],e.onindex(a),n[a]._$type==SHOP_TYPE.TURNPLATE?e.img_payIcon.source=ShopPanel.getPayIcon(this._currType):e.img_payIcon.source="yuanbao_png",this.goodsLayer.addChild(e);this.scroll.viewport.scrollV=0}},t.prototype.onUpdateCurrency=function(){this._currType==SHOP_TYPE.RONGYU||this._currType==SHOP_TYPE.ARENA?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.RONGYU,0,-1)):this._currType==SHOP_TYPE.JIFEN?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.SHOJIFEN,0,-1)):this._currType==SHOP_TYPE.SHENGWANG?this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.SHENGWANG,0,-1)):this.money.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.GOLD,0,-1)),this.gold.data=new CurrencyParam("",new ThingBase(GOODS_TYPE.DIAMOND,0,-1))},t.prototype.getCurrentState=function(){return this._currType==SHOP_TYPE.DAOJU?"normal":this._currType==SHOP_TYPE.JIFEN||this._currType==SHOP_TYPE.RONGYU||this._currType==SHOP_TYPE.ARENA?"integral":this._currType==SHOP_TYPE.TURNPLATE?"refresh":void 0},t.prototype.onItemBack=function(e){var t=e.data;if(this._currType==SHOP_TYPE.TURNPLATE)var n=ShopPanel.getCurrency(this._currType);else var n=ShopPanel.getCurrency(this._currType);var a=GameCommon.getInstance().onParseAwardItemstr(t.price);if(n<a[0].num)return void GameCommon.getInstance().addAlert("货币不足，无法购买");var i=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);i.setByte(t.shopType),i.setInt(t.id),i.setInt(1),GameCommon.getInstance().sendMsgToServer(i)},t.prototype.onGotoHandler=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.getGoType())},t.prototype.getGoType=function(){return this._currType==SHOP_TYPE.RONGYU?FUN_TYPE.FUN_LADDER:this._currType==SHOP_TYPE.ARENA?FUN_TYPE.FUN_ARENA:0},t}(BaseTabView);__reflect(ShopTypePanel.prototype,"ShopTypePanel");var shopdate=function(){function e(){}return e}();__reflect(shopdate.prototype,"shopdate");var ShopItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.ShopItemSkin,t.touchEnabled=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this._data=e,this.dazheimg.visible=!1,this.label_rebate.visible=!1,this.rebateLayer.visible=!1,this.pingfen_grp.visible=!1,this.btn_buy.enabled=!0,this.btn_buy.label="购买",this.btn_buy.visible=!0,this.openDesc.visible=!1,e.xiangoucishu>0&&DataManager.getInstance().shopManager.restrictionBuy[e.id]&&DataManager.getInstance().shopManager.restrictionBuy[e.id]>=e.xiangoucishu&&(this.btn_buy.enabled=!1,this.btn_buy.label="已购买");var t=DataManager.getInstance().pvpManager.getModelCurr();e.pvpLevel>t.lv&&(this.openDesc.visible=!0,this.btn_buy.visible=!1,this.openDesc.text="战功"+e.pvpLevel+"级开启");var n=GameCommon.parseAwardItem(this._data.item);this.goods.onUpdate(n.type,n.id,0,n.quality,n.num,n.lv);var a=GameCommon.getInstance().onParseAwardItemstr(e.price),i=100;DataManager.getInstance().shopManager.discountMap[e.shopType]&&(i=DataManager.getInstance().shopManager.discountMap[e.shopType]),this.onDiscountHandler(i),a[1]?(this.label_price.text=GameCommon.getInstance().getFormatNumberShow(Tool.toInt(a[1].num*i/100)),this.label_price0.text=GameCommon.getInstance().getFormatNumberShow(Tool.toInt(a[0].num*i/100)),this.img_payIcon0.source="zuanshi_png"):this.label_price.text=GameCommon.getInstance().getFormatNumberShow(Tool.toInt(a[0].num*i/100)),this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)},enumerable:!0,configurable:!0}),t.prototype.onTouchBtn=function(){var e=GameCommon.getInstance().onParseAwardItemstr(this._data.price);if(this._data.shopType==SHOP_TYPE.JIFEN){if(e[0].num>DataManager.getInstance().playerManager.player.getICurrency(e[0].type))return void GameCommon.getInstance().addAlert("当前货币不足");var t=new Message(MESSAGE_ID.PLAYER_BUY_SHOP_GOODS_MESSAGE);t.setByte(this._data.shopType),t.setInt(this._data.id),t.setInt(1),GameCommon.getInstance().sendMsgToServer(t)}else e[1]?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.SHOP,e[1].type,this._data))):GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.SHOP,e[0].type,this._data)))},t.prototype.onDiscountHandler=function(e){this.dazheimg.visible=100>e,this.label_rebate.visible=100>e,this.rebateLayer.visible=100>e;for(var t=e.toString(),n="",a="",i=0;i<t.length;i++){var o=parseInt(t.charAt(i));if(o>0){var r=GameDefine.Chinese_Number_Ary[o];n+=r}0==i&&(a=3>o?"shop_rebate_bg1_png":6>o?"shop_rebate_bg2_png":"shop_rebate_bg3_png")}this.label_rebate.text=n+"折",this.dazheimg.source=a},Object.defineProperty(t.prototype,"shenmmidata",{set:function(e){if(this._shenmidate=e,this.dazheimg.visible=!0,this.label_rebate.visible=!0,this.rebateLayer.visible=!0,this.openDesc.visible=!1,this.goods.onUpdate(this._shenmidate.type,this._shenmidate.id,0,this._shenmidate.quality,this._shenmidate.num),0==this._shenmidate.buyNum?this.btn_buy.enabled=!1:this.btn_buy.enabled=!0,this.label_price.text=GameCommon.getInstance().getFormatNumberShow(this._shenmidate._$mach),this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn2,this),this.onDiscountHandler(this._shenmidate._discount),this._shenmidate.type==GOODS_TYPE.MASTER_EQUIP){var t=this.goods.model;t.quality=this._shenmidate.quality;var n=t.pingfenValue,a=DataManager.getInstance().playerManager.player.getPlayerDataByOccp(t.occupation),i=0;if(a){for(var o=a.getEquipByOccp(t.part),r=0;r<o.length;r++)i=0==i?o[r].pingfenValue:Math.min(i,o[r].pingfenValue);i=n-i}else i=n;i>0?this.pingfenLab.text=""+i:this.pingfen_grp.visible=!1}},enumerable:!0,configurable:!0}),t.prototype.onTouchBtn2=function(){var e=new Message(MESSAGE_ID.PLAYER_SHENMISHOP_BUY_MESSAGE);e.setByte(this.index),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onindex=function(e){this.index=e},t}(eui.Component);__reflect(ShopItem.prototype,"ShopItem");var SkillEnchantGradePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.updateBtnName=function(){this.btn_advance.label=Language.instance.getText("sixiangjinjie")},t.prototype.onUpdateAttribute=function(){for(var e=JsonModelManager.instance.getModelxinfajinjie()[this.mainPanel.curSkin_ID],t=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],n=t?t.grade:0,a=GameCommon.getInstance().getAttributeAry(),i="",o="",r=0;r<e.attrAry.length;++r){var s=e.attrAry[r];s>0&&(i=i+GameDefine.Attr_FontName[r]+"："+s*n+"\n",a[r]=s*n,o=o+GameDefine.Attr_FontName[r]+"："+s*(n+1)+"\n")}this.curPro.text=i,this.nextPro.text=o,this.powerBar.power=GameCommon.calculationFighting(a)},t.prototype.onUpdateCost=function(){var e=JsonModelManager.instance.getModelxinfaLv()[this.mainPanel.curSkin_ID],t=JsonModelManager.instance.getModelxinfajinjie()[this.mainPanel.curSkin_ID],n=this.playerData.skillEnhantDict[this.mainPanel.curSkin_ID],a=n?n.level:0;if(0==a)if(e.jihuocost){GameCommon.parseAwardItem(e.jihuocost);this.consumItem.visible=!0}else this.consumItem.visible=!1;else this.consumItem.visible||(this.consumItem.visible=!0);t&&this.consumItem.setCostByAwardItem(t.cost)},t.prototype.onAdvanceHanlde=function(){var e=JsonModelManager.instance.getModelxinfajinjie()[this.mainPanel.curSkin_ID];e&&GameCommon.getInstance().onCheckItemConsume(e.cost.id,e.cost.num,e.cost.type)&&DataManager.getInstance().skillEnhantM.onSendGradeMsg(this.mainPanel.curSkin_ID)},t.prototype.oncheckSkillTabRedPoint=function(e){for(var t=1;t<=this.SKIN_MAX_NUM;t++){var n=(e-1)*this.SKIN_MAX_NUM+t;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUpGradeByRed(n))return!0}return!1},t.prototype.oncheckSKinBtnRedPoint=function(e){if(Tool.isNumber(this.mainPanel.curSkill_ID)){var t=(this.mainPanel.curSkill_ID-1)*this.SKIN_MAX_NUM+e;if(DataManager.getInstance().skillEnhantM.checkSkillEnhantUpGradeByRed(t))return!0}return!1},t}(SkillEnchantLevelPanel);__reflect(SkillEnchantGradePanel.prototype,"SkillEnchantGradePanel");var ActJueXingDanManager=function(){function e(){}return e.prototype.parseInit=function(e){this.round=e.getByte(),this.payNum=e.getInt(),this.payMax=e.getInt(),this.checkModel()},e.prototype.checkModel=function(){return this.model=this.getModel(this.round),this.model},e.prototype.getModel=function(e){var t=JsonModelManager.instance.getModelactivityjuexingdan();for(var n in t)if(t[n].round==e)return t[n];return null},e.prototype.isPayFull=function(){return this.payNum>=this.payMax},e}();__reflect(ActJueXingDanManager.prototype,"ActJueXingDanManager");var SmeltActPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.imgFrameName="iconFrame",n.imgIconName="iconDisplay",n.buttonIndex=0,n.points=RedPointManager.createPoint(4),n.btnTp=[1,1,41,41],n.btnsubTp=[0,1,0,1],n.btnNameStr=["关卡第1","关卡2-5","全民首胜","全民2-5"],n.idx=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SmeltActPanelSkin},t.prototype.onInit=function(){this.actItemGroup.itemRenderer=SmeltActItem,this.actItemGroup.itemRendererSkinName=skins.SmeltActItemSkin,this.actItemGroup.useVirtualLayout=!0,this.bar.viewport=this.actItemGroup,e.prototype.onInit.call(this);var t=new eui.Button;t.skinName=skins.ScrollerTabBtnSkin;for(var n=0;4>n;n++){var a;a=new BaseTabButton("",this.btnNameStr[n]),0==n&&(a.selected=!0),a.width=103,a.name=n+"",a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBtn,this),this.btnGroup.addChild(a)}for(var n=0;4>n;n++)this.points[0].register(a,new egret.Point(95,-7),DataManager.getInstance().activitySmeltManager,"getSmeltPoint",this.btnTp[n],this.btnsubTp[n]),this.points[1].register(a,new egret.Point(95,-7),DataManager.getInstance().activitySmeltManager,"getSmeltPoint",this.btnTp[n],this.btnsubTp[n]),this.points[2].register(a,new egret.Point(95,-7),DataManager.getInstance().activitySmeltManager,"getSmeltPoint",this.btnTp[n],this.btnsubTp[n]),this.points[3].register(a,new egret.Point(95,-7),DataManager.getInstance().activitySmeltManager,"getSmeltPoint",this.btnTp[n],this.btnsubTp[n]);this.title_img.source="ronglian_zi1_png",this.actItemGroup.dataProvider=new eui.ArrayCollection(this.getModel(1,0)),this.onRefresh()},t.prototype.getModel=function(e,t){this.actModel=[];var n=JsonModelManager.instance.getModelkaifuduihuan();for(var a in n)if(e==n[a].type){var i=new ActSmeltData;i.tp=t,i.model=n[a],this.actModel.push(i)}return this.actModel},t.prototype.onEventBtn=function(e){var t=parseInt(e.target.name);this.title_img.source="ronglian_zi"+(t+1)+"_png",this.idx=t,this.actItemGroup.dataProvider=new eui.ArrayCollection(this.getModel(this.btnTp[t],this.btnsubTp[t]))},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.examineCD(!0),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ACT_RONGLIAN_DUIHUAN.toString(),this.updateAwardList,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ACT_RONGLIAN_DUIHUAN.toString(),this.updateAwardList,this)},t.prototype.examineCD=function(e){e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3)},t.prototype.onCountDown=function(){var e=DataManager.getInstance().activityManager.getActivityCD(ACTIVITY_BRANCH_TYPE.ACT_RONGLIAN);e>0||(e=0,this.examineCD(!1)),this.onShowCD(e)},t.prototype.onShowCD=function(e){this.timeLab.text=GameCommon.getInstance().getTimeStrForSec1(e,3)},t.prototype.onRefresh=function(){this.onRequestAwdStatusMsg()},t.prototype.onRequestAwdStatusMsg=function(){var e=new Message(MESSAGE_ID.ACT_RONGLIAN_DUIHUAN);e.setShort(0),e.setByte(99),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.updateAwardList=function(){this.actItemGroup.dataProvider=new eui.ArrayCollection(this.getModel(this.btnTp[this.idx],this.btnsubTp[this.idx]))},t}(BaseTabView);__reflect(SmeltActPanel.prototype,"SmeltActPanel");var SmeltActItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.consume.nameColor=15987699,this.btn_go.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onTouchItem=function(e){},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.hasCost=0,this.data){this.data.model.type<=1?(this.imgNum.text=this.data.model.mubiao,this.imgNum1.text="",this.zhuan.visible=!1,this.guan.visible=!0):(this.zhuan.visible=!0,this.guan.visible=!1,this.imgNum.text="",this.imgNum1.text=this.data.model.mubiao),this.m_id=this.data.model.id,this.m_tp=this.data.tp;var t=this.data.model.type+"_"+this.data.model.mubiao;if(this.desc_lab.text=Language.instance.parseInsertText("kaifuhuishou"+this.data.model.type+"_"+this.data.tp,this.data.model.mubiao),0==this.data.tp){var n=GameCommon.getInstance().onParseAwardItemstr(this.data.model.firstRewards);if(n){var a=n[0];this.item0.onUpdate(a.type,a.id),this.cost_consume.setConsume(a.type,a.id,a.num),this.cost_consume.nameColor=GameCommon.getInstance().CreateNameColer(this.cost_consume.model.quality),this.hasCost=DataManager.getInstance().bagManager.getGoodsThingNumById(a.id)}if(DataManager.getInstance().activitySmeltManager.smeltIds[t]){var i=DataManager.getInstance().activitySmeltManager.smeltIds[t];this.lastNum.text="归属者："+i,i==DataManager.getInstance().playerManager.player.name&&this.hasCost>0?(this.btn_go.visible=!0,this.cost_consume.visible=!0):(this.btn_go.visible=!1,this.cost_consume.visible=!1)}else this.lastNum.text="挑战剩余名额：1",this.btn_go.visible=!0,this.cost_consume.visible=!0;var n=GameCommon.getInstance().onParseAwardItemstr(this.data.model.firstDuihuan);n&&(this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(n[0].type,n[0].id,n[0].num)))}else{var n=GameCommon.getInstance().onParseAwardItemstr(this.data.model.otherRewards);if(n){var a=n[0];this.item0.onUpdate(a.type,a.id),this.cost_consume.setConsume(a.type,a.id,a.num),this.cost_consume.nameColor=GameCommon.getInstance().CreateNameColer(this.cost_consume.model.quality),this.hasCost=DataManager.getInstance().bagManager.getGoodsThingNumById(a.id)}var o=DataManager.getInstance().activitySmeltManager.smeltNums[t];o?o>5?(this.lastNum.text="挑战剩余名额：0",this.hasCost>0?(this.btn_go.visible=!0,this.cost_consume.visible=!0):(this.btn_go.visible=!1,this.cost_consume.visible=!1)):(this.lastNum.text="挑战剩余名额："+Math.max(0,4-o),this.btn_go.visible=!0,this.cost_consume.visible=!0):(this.lastNum.text="挑战剩余名额：4",this.btn_go.visible=!0,this.cost_consume.visible=!0);var n=GameCommon.getInstance().onParseAwardItemstr(this.data.model.otherDuihuan);n&&(this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(n[0].type,n[0].id,n[0].num)))}}},t.prototype.onTouchButton=function(){if(0==this.hasCost)return void GameCommon.getInstance().addAlert("兑换道具不足！");var e=new Message(MESSAGE_ID.ACT_RONGLIAN_DUIHUAN);e.setShort(this.m_id),e.setByte(this.m_tp),GameCommon.getInstance().sendMsgToServer(e)},t}(eui.ItemRenderer);__reflect(SmeltActItem.prototype,"SmeltActItem");var SmeltEquipPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.itemIconPosX=[173,366,67,471,32,521,72,467,191,350],n.itemIconPosY=[32,32,154,154,304,304,433,433,515,515],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SmeltEquipPanelSkin},t.prototype.onInit=function(){this.items=[];for(var t,n=0;10>n;n++)t=this["item"+n],t.onUpdate(null,SMELTINSTANCE_TYPE.NONE,0),this.items.push(t);e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_smelt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmelt,this),this.btn_smelt_all.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmeltAll,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_SMELT_COMMON_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_smelt.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmelt,this),this.btn_smelt_all.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmeltAll,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_SMELT_COMMON_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){this.currEquip=[],this.isHidePay?(this.smelt_info_grp.horizontalCenter=0,this.smeltall_info_grp.visible=!1):(this.smelt_info_grp.horizontalCenter=-140,this.smeltall_info_grp.visible=!0),this.onSmeltBack()},t.prototype.onSmeltBack=function(){this.smeltQueue={},this.blessSmeltQueue=[],0==this.currEquip.length&&(this.currEquip=this.getBag().getSmeltEquipNormal());for(var e=0,t=0,n=0;10>n;n++){this.smeltQueue[n]=this.currEquip[n];var a=this.smeltQueue[n];a?(this.items[n].onUpdate(a,SMELTINSTANCE_TYPE.SHOWLV,0),this["item_icon"+n].source=a.model.icon,e+=GameDefine.EQUIP_SMELTS[a.quality]):(t+=1,this["item_icon"+n].source="",this.items[n].onUpdate(null,SMELTINSTANCE_TYPE.NONE,0))}for(var i=this.getBag().getSmeltEquipSpecial(),o=0;o<i.length;o++)this.blessSmeltQueue.push(i[o]);if(t>0)for(var r=void 0,s=0,n=10-t;10>n;n++)r=this.blessSmeltQueue[s],s+=1,r?(this.items[n].onUpdate(r,SMELTINSTANCE_TYPE.SHOWLV,1),e+=GameDefine.EQUIP_SMELTS[r.quality]):this.items[n].onUpdate(null,SMELTINSTANCE_TYPE.NONE,1);if(this.lbGold.text="可获得"+e+"元宝",!this.isHidePay)if(DataManager.getInstance().playerManager.player.viplevel<GameDefine.ALL_SMELTS_VIPLEVEL)this.smelt_all_desc.text="VIP"+GameCommon.getInstance().getVipName(GameDefine.ALL_SMELTS_VIPLEVEL)+"开启一键回收";else{this.smelt_all_desc.text="一键回收所有装备";for(var h=0,l=0;l<this.currEquip.length;l++){var g=this.currEquip[l];h+=GameDefine.EQUIP_SMELTS[g.quality]}for(var c=0;c<this.blessSmeltQueue.length;c++){var p=this.blessSmeltQueue[c];h+=GameDefine.EQUIP_SMELTS[p.quality]}this.lbGold_all.text="可获得"+h+"元宝"}},t.prototype.getSmeltLength=function(){var e=0;for(var t in this.smeltQueue)this.smeltQueue[t]&&e++;return e},t.prototype.delSmeltQueue=function(e){this.smeltQueue[e]&&(this.smeltQueue[e].selected=!1,delete this.smeltQueue[e])},t.prototype.onTouchBtnSmelt=function(){var e=this.getSmeltLength();if(10>e){var t=this.blessSmeltQueue.length;if(t>0){var n=0;n=10-e>t?t:10-e,DataManager.getInstance().forgeManager.onSendSmeltSpecialMessage(this.blessSmeltQueue,n);for(var a=0,i=e;10>i;i++)this.items[i].playSmelt(),this.items[i].onUpdate(null,SMELTINSTANCE_TYPE.NONE,0),this.blessSmeltQueue[a]&&(this["item_icon"+i].visible=!0,egret.Tween.get(this["item_icon"+i]).to({x:295,y:358,scaleX:.5,scaleY:.5},400).call(this.onPlayDone,this)),a+=1;this.blessSmeltQueue=[]}if(0==e)return void(t>0&&this.onPlayHuishouAnim())}this.onDelaySmletHanlde(this.smeltQueue);for(var o=0,i=0;10>i&&(this.items[i].playSmelt(),this.items[i].onUpdate(null,SMELTINSTANCE_TYPE.NONE,0),this.smeltQueue[i]);i++){for(var r=this.currEquip.length-1;r>=0;r--)if(this.currEquip[r].equipId==this.smeltQueue[i].equipId){this.currEquip.splice(r,1);break}this["item_icon"+i].visible=!0,egret.Tween.get(this["item_icon"+i]).to({x:295,y:358,scaleX:.5,scaleY:.5},400).call(this.onPlayDone,this),o++}this.onPlayHuishouAnim(),Tool.callbackTime(this.onYuanbaoAnim,this,500,o),this.onSendDelaySmletMsg()},t.prototype.onPlayHuishouAnim=function(){this._aniSmelt?(this._aniSmelt.visible=!0,this._aniSmelt.playNum=1):(this._aniSmelt=new Animation("UI_huishou",1),this._aniSmelt.x=this.width/2,this._aniSmelt.y=610,this.itemLayer.addChild(this._aniSmelt))},t.prototype.onYuanbaoAnim=function(e){if(this.parent)for(var t=2*e,n=GameCommon.getInstance().getThingModel(GOODS_TYPE.GOLD,0),a=this.owner.basic.btnTopMoney,i=new egret.Point(a.x,a.y),o=0;t>o;o++){var r=new eui.Image(n.dropicon);r.width=64,r.anchorOffsetX=32,r.height=52,r.anchorOffsetY=26,r.x=this.width/2,r.y=650,this.itemLayer.addChild(r),egret.Tween.get(r).to({x:Tool.randomInt(r.x-100,r.x+100),y:Tool.randomInt(720,740)},300).wait(100+50*o).call(this.yuanbaoPlayDone,this,[r,i])}},t.prototype.yuanbaoPlayDone=function(e,t){t?(this.owner.basic.addChild(e),egret.Tween.get(e).to({x:t.x,y:t.y,scaleX:.5,scaleY:.5},500).call(this.yuanbaoPlayDone,this,[e,null])):(egret.Tween.removeTweens(e),e.parent&&e.parent.removeChild(e),e=null)},t.prototype.onPlayDone=function(){for(var e=0;10>e;e++)this["item_icon"+e].source="",this["item_icon"+e].x=this.itemIconPosX[e],this["item_icon"+e].y=this.itemIconPosY[e],this["item_icon"+e].visible=!1},t.prototype.onTouchBtnSmeltAll=function(){if(DataManager.getInstance().playerManager.player.viplevel<GameDefine.ALL_SMELTS_VIPLEVEL)return GameCommon.getInstance().addAlert("VIP"+GameCommon.getInstance().getVipName(GameDefine.ALL_SMELTS_VIPLEVEL)+"开启一键回收"),void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"VipPanel");for(var e=[],t=0;t<this.currEquip.length;t++){var n=this.currEquip[t];e.push(n)}for(var a=0;a<this.blessSmeltQueue.length;a++){var n=this.blessSmeltQueue[a];e.push(n)}var i=e.length;if(0!=i){DataManager.getInstance().forgeManager.onSendSmeltCommonMessage(e,i);for(var o=0;o<this.currEquip.length;o++)9>o&&(this.items[o].playSmelt(),this.items[o].onUpdate(null,SMELTINSTANCE_TYPE.NONE,0)),this.currEquip[o]&&this.currEquip.splice(o,1);this.onPlayHuishouAnim(),Tool.callbackTime(this.onYuanbaoAnim,this,500,9),this.onSmeltBack()}},t.prototype.onDelaySmletHanlde=function(e){this._delaysmletAry||(this._delaysmletAry=[]);for(var t in e)e[t]&&this._delaysmletAry.indexOf(e[t])<0&&this._delaysmletAry.push(e[t])},t.prototype.onSendDelaySmletMsg=function(){this._delaysmletAry&&this._delaysmletAry.length>0&&DataManager.getInstance().forgeManager.onSendSmeltCommonMessage(this._delaysmletAry,this._delaysmletAry.length),this._delaysmletAry=null},t.prototype.onTouchItem=function(e){var t=e.currentTarget;t.thing?(this.delSmeltQueue(t.thing.smeltSot),t.onUpdate(null,SMELTINSTANCE_TYPE.NONE,0)):(SmeltPanel.isClear=!1,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_CLOSE),"SmeltPanel"),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("SmeltSelectPanel",new SmeltSelectParam(0,this.smeltQueue,9,this.currEquip))))},t.prototype.onHide=function(){SmeltPanel.isClear&&(this.smeltQueue={}),this.onSendDelaySmletMsg(),this._aniSmelt&&this.itemLayer.removeChild(this._aniSmelt),this._aniSmelt=null;for(var t=this.itemLayer.numChildren-1;t>=0;t--){var n=this.itemLayer.getChildAt(t);egret.Tween.removeTweens(n),n.parent&&n.parent.removeChild(n),n=null}e.prototype.onHide.call(this)},Object.defineProperty(t.prototype,"isHidePay",{get:function(){return!FunDefine.getXYXFuncIsOpen(Constant.FANGKUAIWAN_HIDE_SHARE)},enumerable:!0,configurable:!0}),t.prototype.getBag=function(){return DataManager.getInstance().bagManager},t}(BaseTabView);__reflect(SmeltEquipPanel.prototype,"SmeltEquipPanel");var SmeltPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_EQUIP_SMELT,n.isActivity=!0,n.priority=PANEL_HIERARCHY_TYPE.II,n._hasSmeltActItem=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){this.basic.tabBtnsBar.nextImg.visible=!1,this.basic.tabBtnsBar.preImg.visible=!1,this.basic.tabBtnsBar.btnGroup.layout.gap=30,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onInitRegistPage=function(){e.prototype.onInitRegistPage.call(this),this.points=[];var t=[],n=new RegisterSystemParam;n.redP=this.createRedPoint(),n.tabBtns=[];var a=new RegisterTabBtnParam;a.sysName="SmeltEquipPanel",a.funcID=FUN_TYPE.FUN_EQUIP_SMELT,a.tabBtnRes="icon_zhuangbeihuishou_png",a.title="元宝回收",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().bagManager,"getEquipSmeltPointShow"),n.tabBtns.push(a),this.oncheckSmeltActOpen()&&(a=new RegisterTabBtnParam,a.sysName="SmeltActPanel",a.funcID=FUN_TYPE.FUN_BLESS_SMELT,a.tabBtnRes="icon_xianshihuishou_png",a.title="超值兑换",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().activitySmeltManager,"getSmeltPoint"),n.tabBtns.push(a)),t.push(n),this.registerPage(t,"smeltGrp",new egret.Point(120,-10))},t.prototype.oncheckSmeltActOpen=function(){if(DataManager.getInstance().activityManager.getActIsOpen(ACTIVITY_BRANCH_TYPE.ACT_RONGLIAN))return!0;if(!this._hasSmeltActItem)return!1;var e=JsonModelManager.instance.getModelkaifuduihuan();for(var t in e){var n=e[t],a=GameCommon.parseAwardItem(n.firstRewards),i=DataManager.getInstance().bagManager.getGoodsThingNumById(a.id,a.type);if(i>0)return!0;if(a=GameCommon.parseAwardItem(n.otherRewards),i=DataManager.getInstance().bagManager.getGoodsThingNumById(a.id,a.type),i>0)return!0}return this._hasSmeltActItem=!1,!1},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){t.isClear=!0,e.prototype.onRefresh.call(this)},t.isClear=!0,t}(BaseSystemPanel);__reflect(SmeltPanel.prototype,"SmeltPanel");var SmeltSpecialPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.animPos=new egret.Point(324,440),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SmeltSpecialPanelSkin},t.prototype.onInit=function(){this.smeltQueue=[],this.items=[];for(var t,n=0;10>n;n++)t=new SmeltInstance(n),t.onUpdate(null,SMELTINSTANCE_TYPE.NONE,1),this.itemLayer.addChild(t),this.items.push(t);this.desc_lab.text=Language.instance.getText("huanlingronglianshuoming"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_smelt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmelt,this),this.btn_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnGoto,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_SMELT_SPECIAL_MESSAGE.toString(),this.onSmeltBack,this),GameDispatcher.getInstance().addEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.onReciveBagAddMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_smelt.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnSmelt,this),this.btn_goto.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnGoto,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_SMELT_SPECIAL_MESSAGE.toString(),this.onSmeltBack,this),GameDispatcher.getInstance().removeEventListener(GameEvent.GAME_BAG_UPDATE.toString(),this.onReciveBagAddMsg,this)},t.prototype.onRefresh=function(){this.onUpdateSmeltList(),this.showSmeltValue()},t.prototype.onReciveBagAddMsg=function(e){var t=e.data;t==GOODS_TYPE.SERVANT_EQUIP&&this.onUpdateSmeltList()},t.prototype.onSmeltBack=function(){this.onRefresh()},t.prototype.onTouchBtnSmelt=function(){var e=this.smeltQueue.length;if(0!=e){DataManager.getInstance().forgeManager.onSendSmeltSpecialMessage(this.smeltQueue,e);for(var t=0;10>t;t++)this.items[t].playSmelt(),this.items[t].onUpdate(null,SMELTINSTANCE_TYPE.NONE,1);for(var n in this.smeltQueue)this.smeltQueue[n].issmelt=!0;this.smeltQueue=[]}},t.prototype.getBag=function(){return DataManager.getInstance().bagManager},t.prototype.onUpdateSmeltList=function(){this.smeltQueue=[]},t.prototype.showSmeltValue=function(){var e=1e4;this.smelt_value_lab.text=Language.instance.getText("currency22","：",this.getPlayerData().smelt+"/"+e)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onTouchBtnGoto=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_MOUNT)},t}(BaseTabView);__reflect(SmeltSpecialPanel.prototype,"SmeltSpecialPanel");var StrongerMonsterPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.StrongerMonsterSkin},t.prototype.onInit=function(){this.setTitle("进阶大师"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnjiHuo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJiHuo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.STRONGER_ACT.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnjiHuo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJiHuo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.STRONGER_ACT.toString(),this.onRefresh,this)},t.prototype.onJiHuo=function(){var e=new Message(MESSAGE_ID.STRONGER_ACT);e.setByte(this.curStrongerType),GameCommon.getInstance().sendMsgToServer(e)},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().strongerManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.curPro.removeChildren(),this.nextPro.removeChildren(),this.curStrongerType==STRONGER_MONSTER_TYPE.STRONGER_CHALLENGE_PASS?this.showChallengePass():this.curStrongerType==STRONGER_MONSTER_TYPE.STRONGER_TUJIAN_SUIT?this.showTuJianSuit():this.showStrongerMonster()},t.prototype.onShowWithParam=function(e){e instanceof Array?(this.curStrongerType=e[0],this.param=e):this.curStrongerType=e,this.onShow()},t.prototype.showStrongerMonster=function(){var e=this.manager.getCurModelByType(this.curStrongerType),t=this.manager.getNextModelByType(this.curStrongerType),n=this.manager.getStrongerValue(this.curStrongerType);
if(DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType]&&0!=DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType].lv){if(this.titleLab.text=e?"进阶大师"+this.manager.getJiHuoModelByType(this.curStrongerType).id+"级":"进阶大师0级",!t)return this.currentState="full",this.powerBar.power=GameCommon.calculationFighting(e.attrAry),void this.fillCurrAttr(e,56614);if(this.currentState="normal",DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType].lv<n){this.btnjiHuo.label="进 阶",this.titleLab.text=e?"进阶大师"+this.manager.getJiHuoModelByType(this.curStrongerType).id+"级":"进阶大师0级",this.btnjiHuo.visible=!0,this.fillCurrAttr(this.manager.getJiHuoModelByType(this.curStrongerType),56614),this.fillNextAttr(e);var a;if(e.mubiao>DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType].lv){if(this.powerBar.power=GameCommon.calculationFighting(this.manager.getNoActPro(this.curStrongerType,DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType].lv)),a=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+"("+n+"/"+e.mubiao+")"+Tool.getHtmlColorStr("(可激活)","00dd26"),!t&&e.mubiao==DataManager.getInstance().playerManager.player.strongerDict[this.curStrongerType].lv)return this.currentState="full",void this.nextPro.removeChildren()}else this.powerBar.power=GameCommon.calculationFighting(e.attrAry),a=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+"("+n+"/"+e.mubiao+")"+Tool.getHtmlColorStr("(已激活)","00dd26");o=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+Tool.getHtmlColorStr("("+n+"/"+t.mubiao+")","ff0000"),this.nextDesc.textFlow=(new egret.HtmlTextParser).parse(o),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(a)}else{if(this.btnjiHuo.label="激 活",t)if(e){this.powerBar.power=GameCommon.calculationFighting(e.attrAry);var i=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+"("+n+"/"+e.mubiao+")"+Tool.getHtmlColorStr("(已激活)","00dd26"),o=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+Tool.getHtmlColorStr("("+n+"/"+t.mubiao+")","ff0000");this.nextDesc.textFlow=(new egret.HtmlTextParser).parse(o),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(i),this.fillCurrAttr(e,56614)}else{var i=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType);this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(i),this.currentState="weijihuo",this.powerBar.power=0,this.fillCurrAttr(t)}else this.currentState="full",this.powerBar.power=GameCommon.calculationFighting(e.attrAry),this.fillCurrAttr(e,56614);this.btnjiHuo.visible=!1}}else{this.titleLab.text="进阶大师0级",this.powerBar.power=0,this.currentState="weijihuo";var r;e?(r=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+"("+n+"/"+e.mubiao+")"+Tool.getHtmlColorStr("(可激活)","00dd26"),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(r),this.fillCurrAttr(e,56614)):(r=Language.instance.parseInsertText("stronger_monster_type_"+this.curStrongerType)+"("+n+"/"+t.mubiao+")"+Tool.getHtmlColorStr("(未激活)","ff0000"),this.desc_lab.textFlow=(new egret.HtmlTextParser).parse(r),this.fillCurrAttr(t)),this.btnjiHuo.visible=!0}},t.prototype.showChallengePass=function(){var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_CHALLENGE)[0],t=JsonModelManager.instance.getModelzhuxiantai(),n=e.pass<1?1:e.pass,a=t[n-1],i=t[n];if(a){for(var o=0;10>o;o++)if(t[n+o].shuxing[0]>t[n-1].shuxing[0]){i=t[n+o];break}}else for(var o=0;10>o;o++)if(t[n+o].shuxing[0]>0){i=t[n+o];break}if(i)if(this.currentState="normal",a){if(this.desc_lab.text="第"+a.id+"关属性加成",this.nextDesc.text="通关第"+i.id+"关属性加成",0==a.shuxing[0]){var r;this.curPro.removeChildren();for(var o=0;4>o;++o)r=new AttributesText,r.scaleX=.7,r.scaleY=.7,r.updateAttr(o,0,56614),this.curPro.addChild(r)}else this.fillCurrAttr(a,56614,SHOW_ATTR_TYPE.SHUXING);this.fillNextAttr(i,5001293,SHOW_ATTR_TYPE.SHUXING);for(var o=0;10>o;o++)o>=a.shuxing.length&&a.shuxing.push(0);this.powerBar.power=GameCommon.calculationFighting(a.shuxing)}else{this.desc_lab.text="关卡第0关属性加成",this.nextDesc.text="通关第"+i.id+"关属性加成",this.powerBar.power=0,this.fillNextAttr(i,5001293,SHOW_ATTR_TYPE.SHUXING);var r;this.curPro.removeChildren();for(var o=0;4>o;++o)r=new AttributesText,r.scaleX=.7,r.scaleY=.7,r.updateAttr(o,0,56614),this.curPro.addChild(r)}else{this.fillCurrAttr(a,56614,SHOW_ATTR_TYPE.SHUXING),this.currentState="full";for(var o=0;10>o;o++)o>=a.shuxing.length&&a.shuxing.push(0);this.powerBar.power=GameCommon.calculationFighting(a.shuxing)}this.btnjiHuo.visible=!1,this.titleLab.text="挑战本等级"},t.prototype.showTuJianSuit=function(){var e=this.param[1],t=DataManager.getInstance().playerManager.player.getPlayerData(),n=0;for(var a in t.tujianDataDict){var i=t.tujianDataDict[a];0!=i.level&&i.model.type==e&&n++}var o,r,s,h=JsonModelManager.instance.getModeltujiantaozhuang()[e];for(var l in h){if(o=h[l],!(n>=o.num)){s=o;break}r=o}this.fillCurrAttr(r),this.fillNextAttr(s),r?s?this.currentState="full":this.currentState="normal":this.currentState="weijihuo",this.desc_lab.text=s?"集齐"+s.num+"张图鉴":"图鉴套装属性已激活"},t.prototype.fillCurrAttr=function(e,t,n){void 0===t&&(t=5001293),void 0===n&&(n=SHOW_ATTR_TYPE.ATTR_ARY),e&&this.fillAttr(this.curPro,t,e,n)},t.prototype.fillNextAttr=function(e,t,n){void 0===t&&(t=5001293),void 0===n&&(n=SHOW_ATTR_TYPE.ATTR_ARY),this.fillAttr(this.nextPro,t,e,n)},t.prototype.fillAttr=function(e,t,n,a){void 0===t&&(t=5001293),void 0===a&&(a=SHOW_ATTR_TYPE.ATTR_ARY);var i=n.attrAry;a==SHOW_ATTR_TYPE.SHUXING&&(i=n.shuxing);var o,r=0;for(e.removeChildren();r<GameDefine.ATTR_OBJ_KEYS.length;++r)i[r]>0&&(o=new AttributesText,o.scaleX=.7,o.scaleY=.7,o.updateAttr(r,i[r],t),e.addChild(o))},t}(BaseWindowPanel);__reflect(StrongerMonsterPanel.prototype,"StrongerMonsterPanel");var SHOW_ATTR_TYPE;!function(e){e[e.ATTR_ARY=0]="ATTR_ARY",e[e.SHUXING=1]="SHUXING"}(SHOW_ATTR_TYPE||(SHOW_ATTR_TYPE={}));var ChengJiuAwardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.imgFrameName="iconFrame",n.imgIconName="iconDisplay",n.buttonIndex=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChengJiuAwardPanel},t.prototype.onInit=function(){this.basic.label_title.text="成就奖励",this.actItemGroup.itemRenderer=ChengJiuAwardItem,this.actItemGroup.itemRendererSkinName=skins.ChengjiuAwardItem,this.actItemGroup.useVirtualLayout=!0,this.bar.viewport=this.actItemGroup,e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"getModel",{get:function(){this.cjModels=[];var e=JsonModelManager.instance.getModelchengjiuLv();for(var t in e)this.cjModels.push(e[t]);return this.cjModels},enumerable:!0,configurable:!0}),t.prototype.onEventBtn=function(e){parseInt(e.target.name)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_TASK_LV_MSG.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.REBIRTH_TASK_LV_MSG.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=this.getModel;e.sort(function(e,t){var n=2,a=2;return t.exp<=DataManager.getInstance().playerManager.player.chengjiuExp?(a=-1,DataManager.getInstance().playerManager.player.chengjiuLvDict[t.lv]&&(a=2)):a=1,e.exp<=DataManager.getInstance().playerManager.player.chengjiuExp?(n=-1,DataManager.getInstance().playerManager.player.chengjiuLvDict[e.lv]&&(n=2)):n=1,n-a}),this.actItemGroup.dataProvider=new eui.ArrayCollection(e)},t}(BaseWindowPanel);__reflect(ChengJiuAwardPanel.prototype,"ChengJiuAwardPanel");var ChengJiuAwardItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.btn_go.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onUpdate=function(){this.data&&(this.desc.text=this.data.lv+"级",this.goodData.onUpdate(this.data.rewards[0].type,this.data.rewards[0].id),this.progress_cur_value.labelDisplay.visible=!1,this.progress_cur_value1.labelDisplay.visible=!1,this.progress_cur_value1.slideDuration=0,this.progress_cur_value1.maximum=this.data.exp,this.progress_cur_value1.value=DataManager.getInstance().playerManager.player.chengjiuExp,this.desc1.text=DataManager.getInstance().playerManager.player.chengjiuExp+"/"+this.data.exp,this.goodData.currentState="notName",this.data.exp<=DataManager.getInstance().playerManager.player.chengjiuExp?DataManager.getInstance().playerManager.player.chengjiuLvDict[this.data.lv]?(this.btn_go.label="已领取",this.btn_go.enabled=!1):(this.btn_go.label="已完成",this.btn_go.enabled=!0,this.btn_go.skinName=skins.Common_ButtonSkin):(this.btn_go.label="前往",this.btn_go.enabled=!0,this.btn_go.skinName=skins.Common_ButtonBlueSkin))},t.prototype.onTouchButton=function(){if("已完成"==this.btn_go.label){var e=new Message(MESSAGE_ID.REBIRTH_TASK_LV_MSG);e.setShort(this.data.lv),GameCommon.getInstance().sendMsgToServer(e)}else if("前往"==this.btn_go.label){var t=GameCommon.getInstance().getThingModel(this.data.rewards[0].type,this.data.rewards[0].id);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),t.gotype)}},Object.defineProperty(t.prototype,"selecet",{set:function(e){},enumerable:!0,configurable:!0}),t.prototype.unSelect=function(){},t.prototype.onTouch=function(){},t}(BaseListItem);__reflect(ChengJiuAwardItem.prototype,"ChengJiuAwardItem");var ChengJiuPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.imgFrameName="iconFrame",n.imgIconName="iconDisplay",n.buttonIndex=0,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ChengJiuPanelSkin},t.prototype.onInit=function(){this.actItemGroup.itemRenderer=ChengJiuItem,this.actItemGroup.itemRendererSkinName=skins.ChengJiuItem,this.actItemGroup.useVirtualLayout=!0,this.bar.viewport=this.actItemGroup,this.points[0].register(this.btnChengJiu,GameDefine.RED_MAIN_POS,DataManager.getInstance().taskManager,"getChengJiuLvPoint"),e.prototype.onInit.call(this),this.onRefresh()},Object.defineProperty(t.prototype,"getModel",{get:function(){this.cjModels=[];var e=JsonModelManager.instance.getModelchengjiu();for(var t in e){var n=DataManager.getInstance().taskManager.coatardTasks[e[t].id],a=DataManager.getInstance().taskManager.getCurTask(n.model.id,n.count);if(a){if(n.maxnum=a.mubiao,n.progress>=a.mubiao?n.isAct=0:n.isAct=1,13==n.model.id){if(SDKManager.isHidePay)continue;n.isAct=-1}this.cjModels.push(n)}}return this.cjModels},enumerable:!0,configurable:!0}),t.prototype.onEventBtn=function(e){parseInt(e.target.name)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnChengJiu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnChengJiu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG.toString(),this.onRefresh,this)},t.prototype.onShowAward=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"ChengJiuAwardPanel")},t.prototype.onRefresh=function(){var e=this.getModel;e.sort(function(e,t){return e.isAct-t.isAct}),this.actItemGroup.dataProvider=new eui.ArrayCollection(e);var t=DataManager.getInstance().playerManager.player.chengjiuExp,n=DataManager.getInstance().taskManager.getchengjiuLevel(t);if(this.imgZhuan.text=n+"",JsonModelManager.instance.getModelchengjiuLv()[n]){this.bar_exp.maximum=JsonModelManager.instance.getModelchengjiuLv()[n].exp,this.bar_exp.value=t,this.chengjiuPro.text=t+"/"+JsonModelManager.instance.getModelchengjiuLv()[n].exp;var a=JsonModelManager.instance.getModelchengjiuLv()[n].rewards[0];this.goodData.onUpdate(a.type,a.id);var i=JsonModelManager.instance.getModelfashion();for(var o in i)if(i[o].cost.id==a.id){this.powerBar.power=GameCommon.calculationFighting(i[o].attrAry);break}}else this.bar_exp.maximum=1,this.bar_exp.value=1,this.chengjiuPro.text="全部达成";this.bar_exp.labelDisplay.visible=!1},t.prototype.trigger=function(){this.points[0].checkPoint()},t}(BaseTabView);__reflect(ChengJiuPanel.prototype,"ChengJiuPanel");var ChengJiuItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t._touchStamp=0,t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.btn_go.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.onTouchItem=function(e){},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.progress_cur_value1.value=0,this.progress_cur_value1.slideDuration=0,this.consume.nameColor=15987699,this.data){var t=this.data,n=DataManager.getInstance().taskManager.getCurTask(t.model.id,t.count);if(13==t.model.id?this.item_Di.source="public_jindi_png":this.item_Di.source="public_landi_png",n){var a=t.model.name,i=n.mubiao,o=t.progress;if(7==n.type){var r=JsonModelManager.instance.getModelzhuansheng()[i];r&&(i=r.zhuansheng);var s=JsonModelManager.instance.getModelzhuansheng()[o];s&&(o=s.zhuansheng)}13==t.model.id&&(i=GameCommon.getInstance().getVipName(n.mubiao),o=GameCommon.getInstance().getVipName(t.progress)),this.pointNum.text=n.points+"",a=a.replace("{0}",i+""),this.progress_cur_value1.maximum=i,this.progress_cur_value1.value=o,this.desc.text=a,this.proNum.text=o+"/"+i,n.rewards?(this.consume.visible=!0,this.consume.data=new CurrencyParam(Language.instance.getText("xiaohao"),new ThingBase(n.rewards[0].type,n.rewards[0].id,n.rewards[0].num))):this.consume.visible=!1}this._taskdata=t,t.maxnum<=t.progress?(this.btn_go.label="领取",this.btn_go.skinName=skins.Common_ButtonBlueSkin):(this.btn_go.label="前往",this.btn_go.skinName=skins.Common_ButtonSkin)}},t.prototype.onTouchButton=function(){if(this._taskdata)if(this._taskdata.maxnum<=this._taskdata.progress){if(this._touchStamp>egret.getTimer())return;this._touchStamp=egret.getTimer()+1e3;var e=new Message(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG);e.setShort(this._taskdata.model.id),GameCommon.getInstance().sendMsgToServer(e)}else if(36==this._taskdata.model.eventType){var t=new ChatPanelParam(CHANNEL.CURRENT,null),n=ChatDefine.DEFAULT_SHORT_CHAT[Math.floor(Math.random()*ChatDefine.DEFAULT_SHORT_CHAT.length)];t.content=Language.instance.getText(n),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",t))}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this._taskdata.model.goType)},Object.defineProperty(t.prototype,"selecet",{set:function(e){},enumerable:!0,configurable:!0}),t.prototype.unSelect=function(){},t.prototype.onTouch=function(){},t}(eui.ItemRenderer);__reflect(ChengJiuItem.prototype,"ChengJiuItem");var CoatardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.CoatardPanelSkin},t.prototype.onInit=function(){this.itemsDict={},this.points[0].register(this.btn_coatard,GameDefine.RED_BTN_POS,this,"onCheckPoint1"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_coatard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCoatard,this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.REBIRTH_TASK_INIT_MSG.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG.toString(),this.onReciveStateMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_coatard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnCoatard,this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.REBIRTH_TASK_INIT_MSG.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG.toString(),this.onReciveStateMsg,this)},t.prototype.onRefresh=function(){this.curr_coatardLv!=this.playerData.coatardLv?(this.curr_coatardLv=this.playerData.coatardLv,this.onInitTaskList()):this.onUpdateTaskList(),this.updateCoatardLv()},t.prototype.updateCoatardLv=function(){this.curr_coatard_lv.text=""+Tool.toChineseNum(this.curr_coatardLv),this.curr_coatard_name.source="coatard_tier_"+this.curr_coatardLv+"_png",this.coatard_exp_pro.value=this.finishCount,this.btn_coatard.enabled=this.coatard_exp_pro.value==this.coatard_exp_pro.maximum},Object.defineProperty(t.prototype,"finishCount",{get:function(){var e=0,t=DataManager.getInstance().taskManager.coatardTasks;for(var n in t){var a=t[n];e+=a.count}return e},enumerable:!0,configurable:!0}),t.prototype.updateOpenFunc=function(){},t.prototype.onInitTaskList=function(){},t.prototype.onReciveStateMsg=function(e){var t=e.message,n=DataManager.getInstance().taskManager.coatardTasks[t];if(n){var a=this.itemsDict[n.taskId];a&&(a.onComplete(),n.maxnum>0?(a.update(n),n.maxnum<=n.progress?this.itemsGrp.addChildAt(a,0):this.itemsGrp.addChild(a),a.onShow()):delete this.itemsDict[n.taskId],this.updateCoatardLv())}},t.prototype.onUpdateTaskList=function(){for(var e in this.itemsDict){var t=this.itemsDict[e],n=DataManager.getInstance().taskManager.coatardTasks[e];n&&(n.maxnum>0?t.update(n):(t.onComplete(),delete this.itemsDict[n.taskId]))}},t.prototype.onTouchBtnCoatard=function(){var e=new Message(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onGetBtn=function(){GameCommon.getInstance().onShowFastBuy(0,GOODS_TYPE.VIGOUR)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.trigger=function(){this.points[0].checkPoint()},t.prototype.onCheckPoint1=function(){return this.btn_coatard.enabled},t}(BaseTabView);__reflect(CoatardPanel.prototype,"CoatardPanel");var CoatardTaskItem=function(e){function t(){var t=e.call(this)||this;return t._touchStamp=0,t.once(egret.Event.COMPLETE,t.onInit,t),t.skinName=skins.CoatardItemSkin,t}return __extends(t,e),t.prototype.onInit=function(){this.button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchButton,this)},t.prototype.update=function(e){this._taskdata=e,this.task_icon.source=e.model.icon,this.task_name_lab.text=Language.instance.parseInsertText(this._taskdata.model.name,this._taskdata.maxnum),1e3==this._taskdata.model.eventType?this.task_probar.visible=!1:(this.task_probar.visible=!0,this.task_probar.maximum=this._taskdata.maxnum,this.task_probar.value=this._taskdata.progress),this._taskdata.maxnum<=this._taskdata.progress?(this.button.skinName=skins.Common_ButtonBlue2Skin,this.button.label=Language.instance.getText("wancheng")):(this.button.skinName=skins.Common_ButtonYellow,this.button.label=Language.instance.getText("qianwang"))},t.prototype.onTouchButton=function(){if(this._taskdata.maxnum<=this._taskdata.progress){if(this._touchStamp>egret.getTimer())return;this._touchStamp=egret.getTimer()+1e3;var e=new Message(MESSAGE_ID.REBIRTH_TASK_UPDATE_MSG);e.setShort(this._taskdata.taskId),GameCommon.getInstance().sendMsgToServer(e)}else if(36==this._taskdata.model.eventType){var t=new ChatPanelParam(CHANNEL.CURRENT,null),n=ChatDefine.DEFAULT_SHORT_CHAT[Math.floor(Math.random()*ChatDefine.DEFAULT_SHORT_CHAT.length)];t.content=Language.instance.getText(n),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",t))}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this._taskdata.model.goType)},t.prototype.onShow=function(e){void 0===e&&(e=500),this.anim_grp.x=this.anim_grp.width,egret.Tween.removeTweens(this.anim_grp),egret.Tween.get(this.anim_grp).to({x:0},e,egret.Ease.sineIn)},t.prototype.onComplete=function(){this.parent&&(egret.Tween.removeTweens(this.anim_grp),this.parent.removeChild(this))},t}(eui.Component);__reflect(CoatardTaskItem.prototype,"CoatardTaskItem");var JianchiPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.showAttrMax=3,n.showRewardMax=3,n.showJianImgMax=9,n.animPos=new egret.Point(344,440),n.points=RedPointManager.createPoint(1),n.taskdailyItems=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.JianchiPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.jianchi_tasklist.verticalScrollBar.autoVisibility=!0,this.jianchi_tasklist.verticalScrollBar.visible=!0,this.points[0].register(this.btn_upgrade,GameDefine.RED_BTN_POS_YELLOW_LITTLE,DataManager.getInstance().tianGongManager,"getTabJianChiRedShow"),this.imgBoxs=[],this.lbScores=[];for(var t=0;4>t;++t){this.imgBoxs[t]=this["imgBox"+t],this.imgBoxs[t].name=(t+1).toString(),this.imgBoxs[t].touchEnabled=!0,this.lbScores[t]=this["lbScore"+t];var n=JsonModelManager.instance.getModeljianchi()[t+1];this.lbScores[t].text=n.exp.toString()}var a=JsonModelManager.instance.getModeltaskDaily();for(var i in a){var o=a[i],r=new JianchiTaskItem(o);this.taskdailyItems.push(r),this.jianchi_taskgroup.addChild(r)}this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;4>t;++t)this.imgBoxs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TASK_DAILY_UPDATE_MESSAGE.toString(),this.onUpdateTaskDaily,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.JIANCHI_INFO_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),this.btn_upgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendJianchiUpMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;4>t;++t)this.imgBoxs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBox,this);GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TASK_DAILY_UPDATE_MESSAGE.toString(),this.onUpdateTaskDaily,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.JIANCHI_INFO_UPDATE_MESSAGE.toString(),this.onUpdateBack,this),this.btn_upgrade.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendJianchiUpMsg,this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.onUpdateTaskDaily(),this.onUpdateJianchi()},t.prototype.onUpdateBack=function(){this.onUpdateJianchi()},t.prototype.onUpdateTaskDaily=function(){this.jianchi_taskgroup.removeChildren();for(var e=0;e<this.taskdailyItems.length;e++){var t=this.taskdailyItems[e];t.onUpdateData()}this.taskdailyItems.sort(function(e,t){return e.model.sortIdx-t.model.sortIdx});for(var e=0;e<this.taskdailyItems.length;e++){var t=this.taskdailyItems[e];this.jianchi_taskgroup.addChild(t)}},t.prototype.setBoxState=function(e,t,n,a){n>t?this.imgBoxs[t].source="jianchi_box_2_png":a>=e.exp?this.imgBoxs[t].source="jianchi_box_1_png":this.imgBoxs[t].source="jianchi_box_0_png"},t.prototype.onUpdateJianchi=function(){for(var e=DataManager.getInstance().playerManager.player,t=e.jianchiExp,n=e.jianchiLevel,a=0,i=0;4>i;++i){var o=JsonModelManager.instance.getModeljianchi()[i+1];this.setBoxState(o,i,n,t),o.exp>a&&(a=o.exp)}this.jianchi_exp_pro.maximum=a,this.jianchi_exp_pro.value=Math.min(t,a)},t.prototype.onTouchBox=function(e){var t=e.currentTarget.name,n=JsonModelManager.instance.getModeljianchi()[t],a=n.rewards[0],i=new ThingBase(a.type);i.onupdate(a.id,a.quality,a.num),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.IMG,a.type,i)))},t.prototype.onSendJianchiUpMsg=function(){if(DataManager.getInstance().tianGongManager.getTabJianChiRedShow()){var e=new Message(MESSAGE_ID.JIANCHI_LEVELUP_MESSEAGE);GameCommon.getInstance().sendMsgToServer(e)}else GameCommon.getInstance().addAlert("error_tips_86")},t}(BaseTabView);__reflect(JianchiPanel.prototype,"JianchiPanel");var JianchiTaskItem=function(e){function t(t){var n=e.call(this)||this;return n.model=t,n.isLoadCom=!1,n.once(egret.Event.COMPLETE,n.onLoadComplete,n),n.skinName=skins.JianchiTaskItemSkin,n}return __extends(t,e),t.prototype.onLoadComplete=function(){this.isLoadCom=!0,this.task_name_label.text=this.model.name,this.task_award_label.text="活跃 +"+this.model.score,this.onUpdateData()},t.prototype.onUpdateData=function(){this.isLoadCom&&(this.item.updateByAward(this.model.rewards[0]),this.item.currentState="notName",this.model.dailytaskPro=Math.min(this.model.dailytaskPro,this.model.count),this.task_count_label.text=this.model.dailytaskPro+"/"+this.model.count,this.bar.maximum=this.model.count,this.bar.value=this.model.dailytaskPro,this.model.dailytaskPro>=this.model.count?(this.task_goto.labelDisplay.text="今日已完成",this.task_goto.enabled=!1,this.task_goto.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoHandler,this),this.model.sortIdx=this.model.id+1e4):(this.task_goto.labelDisplay.text="前 往",this.task_goto.enabled=!0,this.task_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoHandler,this),this.model.sortIdx=this.model.id))},t.prototype.onGotoHandler=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.model.goType)},t}(eui.Component);__reflect(JianchiTaskItem.prototype,"JianchiTaskItem");var TaskBasePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_JINGJIE,n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="ZhuanShengPanel",n.funcID=FUN_TYPE.FUN_JINGJIE,n.btnRes="转生",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"checkZhuanShengPoint"),t.push(n);var n=new RegisterSystemParam;n.sysName="ChengJiuPanel",n.btnRes="成就",n.funcID=FUN_TYPE.FUN_JINGJIE,n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().taskManager,"getChengJiuPoint"),t.push(n);var n=new RegisterSystemParam;n.sysName="JianchiPanel",n.btnRes="每日",n.funcID=FUN_TYPE.FUN_JIANCHI,n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().tianGongManager,"getTabJianChiRedShow"),t.push(n);var n=new RegisterSystemParam;n.sysName="VipGodArtifactPanel",n.btnRes="玄器",n.redP=this.points[3],n.redP.addTriggerFuc(DataManager.getInstance().legendManager,"oncheckAllVipActifactRedP"),t.push(n);var n=new RegisterSystemParam;n.sysName="XinFaPanel",n.btnRes="法器",n.redP=this.points[4],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"onCheckXinfaRedPoint"),t.push(n),this.registerPage(t,"tiangongGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){switch(e.prototype.onRefresh.call(this),this.basic.bgDi.visible=4!=this.index,this.index){case 0:this.setTitle("转生");break;case 1:this.setTitle("成就");break;case 2:this.setTitle("每日");break;case 3:this.setTitle("玄器");break;case 4:this.setTitle("法器")}},t}(BaseSystemPanel);__reflect(TaskBasePanel.prototype,"TaskBasePanel");var TASKPANEL_TAB;!function(e){e[e.COATARDTASK=0]="COATARDTASK"}(TASKPANEL_TAB||(TASKPANEL_TAB={}));var ZhuanShengPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n.zhuanshengId=0,n.zhuanshengId1=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ZhuanShengPanelSkin},t.prototype.onInit=function(){this.zhuanshengDict=JsonModelManager.instance.getModelzhuansheng(),GameCommon.getInstance().addUnderlineGet(this.label_get),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_tuPo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTuPo,this),this.item_icon1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE.toString(),this.onReciveStateMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.item_icon1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.btn_tuPo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnTuPo,this),this.label_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGotoBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE.toString(),this.onReciveStateMsg,this)},t.prototype.onRefresh=function(){this.onShowInfo()},t.prototype.onReciveStateMsg=function(e){this.onRefresh()},t.prototype.onShowInfo=function(){var e=JsonModelManager.instance.getModelzhuansheng()[this.playerData.zhuanshengID],t=JsonModelManager.instance.getModelzhuansheng()[this.playerData.zhuanshengID];this.imgZhuan.text=e.zhuansheng+"",this.imgDuan.text=e.duanwei+"",this.curPro.removeChildren(),this.nextPro.removeChildren();var n=JsonModelManager.instance.getModelzhuansheng()[this.playerData.zhuanshengID+1];if(t){var a;t.duanweiShuxing.indexOf("#")>=0&&(a=t.duanweiShuxing.split("#"));var i;n.duanweiShuxing.indexOf("#")>=0&&(i=n.duanweiShuxing.split("#"));for(var o,r=[0,0,0,0,0,0,0,0,0,0],s=0;s<a.length;s++){var h=a[s].split(",");o=new AttributesText,o.updateAttr(s,h[1]),this.curPro.addChild(o);var l=i[s].split(",");o=new AttributesText,o.updateAttr(s,l[1]),this.nextPro.addChild(o),r[s]=Number(h[1])}this.powerBar.power=GameCommon.calculationFighting(r)}else this.next_open_desc.text=Language.instance.getText("full_level_3");var g=n.zhuansheng;if(""==n.zhuanshengRewards)for(var s=1;10>s;s++){var c=JsonModelManager.instance.getModelzhuansheng()[this.playerData.zhuanshengID+s];if(""!=c.zhuanshengRewards){var p,u=GameCommon.getInstance().onParseAwardItemstr(c.zhuanshengRewards),d=JsonModelManager.instance.getModelchenghao();for(var _ in d)if(1==d[_].type){var m=d[_];m.cost.id==u[0].id&&(p=m)}this.titleName.text=p.name,this.titlePower.text="战力:"+GameCommon.calculationFighting(p.attrAry),this.anim?this.anim.onupdate(p):(this.anim=new TitleBody(p),this.anim.scaleX=1.2,this.anim.scaleY=1.2,this.ani.addChild(this.anim)),g=n.zhuansheng;break}}else{var p,u=GameCommon.getInstance().onParseAwardItemstr(n.zhuanshengRewards),d=JsonModelManager.instance.getModelchenghao();for(var _ in d)if(1==d[_].type){var m=d[_];m.cost.id==u[0].id&&(p=m)}this.titleName.text=p.name,this.titlePower.text="战力:"+GameCommon.calculationFighting(p.attrAry),this.anim?this.anim.onupdate(p):(this.anim=new TitleBody(p),this.anim.scaleX=1.2,this.anim.scaleY=1.2,this.ani.addChild(this.anim)),g=n.zhuansheng}var u=GameCommon.getInstance().onParseAwardItemstr(n.duanweiRewards);u&&(this.label_r.text=u[0].num+""),0==n.tiaojianGuanqia?(this.progress1.maximum=n.tiaojianLv,this.progress1.value=DataManager.getInstance().playerManager.player.level,this.desc1.text="达到"+n.tiaojianLv+"级"):(this.progress1.maximum=n.tiaojianGuanqia,this.progress1.value=GameFight.getInstance().yewai_waveIndex,this.desc1.text="关卡达到"+n.tiaojianGuanqia+"关")},t.prototype.onTouch=function(e){if(this._item.type!=GOODS_TYPE.SHOW){var t,n;this._item.type==GOODS_TYPE.MASTER_EQUIP||this._item.type==GOODS_TYPE.SERVANT_EQUIP?(t=new EquipThing(this._item.type),t.onupdate(this._item.id,this._item.quality,0),n=INTRODUCE_TYPE.EQUIP):(t=new ThingBase(this._item.type),t.onupdate(this._item.id,this._item.quality,0),n=INTRODUCE_TYPE.IMG),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(n,this._item.type,t,0)))
}},t.prototype.onTouchBtnTuPo=function(){var e=new Message(MESSAGE_ID.REBIRTH_UPGRAGE_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onGotoBtn=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_PVE)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player},enumerable:!0,configurable:!0}),t.prototype.trigger=function(){this.points[0].checkPoint()},t.prototype.onCheckPoint1=function(){return this.btn_coatard.enabled},t}(BaseTabView);__reflect(ZhuanShengPanel.prototype,"ZhuanShengPanel");var TianshiAtlasPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TianshiAtlasPanelSkin},t.prototype.onInit=function(){this.setTitle("历史天师"),this.atlas_list.itemRenderer=TianshiAtlasItem,this.atlas_list.itemRendererSkinName=skins.TianshiAtlasItemSkin,this.atlas_list.useVirtualLayout=!0,this.scroller.viewport=this.atlas_list,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},Object.defineProperty(t.prototype,"playerM",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){var e=[];for(var t in JsonModelManager.instance.getModelshareMaster()){var n=JsonModelManager.instance.getModelshareMaster()[t];e.push(n)}this.atlas_list.dataProvider=new eui.ArrayCollection(e)},t}(BaseWindowPanel);__reflect(TianshiAtlasPanel.prototype,"TianshiAtlasPanel");var TianshiAtlasItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onUpdate=function(){var e=this.data;DataManager.getInstance().playerManager.player.shareMasterId<e.id?(this.lv_lab.text="",this.atlas_img.source="",e.id==DataManager.getInstance().playerManager.player.shareMasterId+1?(this.not_open_lab.text="下级预览",this.attr_desc_lab.text=Language.instance.parseInsertText("tianshi_plus_type"+e.type,e.allplus/GameDefine.GAME_ADD_RATIO*100+"%")):(this.not_open_lab.text="暂未激活",this.attr_desc_lab.text="")):(this.not_open_lab.text="",this.lv_lab.text=Language.instance.parseInsertText("tianshi_level",e.id),this.attr_desc_lab.text=Language.instance.parseInsertText("tianshi_plus_type"+e.type,e.allplus/GameDefine.GAME_ADD_RATIO*100+"%"),this.atlas_img.source=e.pic)},t}(BaseListItem);__reflect(TianshiAtlasItem.prototype,"TianshiAtlasItem");var TianShiLevelPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.INVITE_TEXT="好友助力",n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TianshiPanelSkin},t.prototype.onInit=function(){this.ADD_EXP_PARAM=[{type:0,param:[Constant.get("DENGLU_EXP")],func:null},{type:1,param:[Constant.get("HAOYOU_LEVEL"),Constant.get("HAOYOU_EXP")],func:"onCheckCondition1"}],this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.histroy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAtlasPanel,this),this.add_condition_grp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.activate_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onActivate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XYX_SHARE_EXP_MESSAGE.toString(),this.onUpdateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XYX_SHARE_MASTER_MESSAGE.toString(),this.onUpdateInfo,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.histroy_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAtlasPanel,this),this.add_condition_grp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this),this.activate_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onActivate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XYX_SHARE_EXP_MESSAGE.toString(),this.onUpdateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XYX_SHARE_MASTER_MESSAGE.toString(),this.onUpdateInfo,this)},Object.defineProperty(t.prototype,"playerM",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.onRefresh=function(){this.playerM.onSendTianshiAwardMsg(!1)},t.prototype.onUpdateInfo=function(){this.add_condition_grp.removeChildren();var e=this.playerM.tianshiAwdNum*parseInt(Constant.get("HAOYOU_EXP")),t=JsonModelManager.instance.getModelshareMaster()[this.playerM.player.shareMasterId+1];if(this.cur_level_lab.text=Language.instance.parseInsertText("tianshi_level",this.playerM.player.shareMasterId),this.add_desc_lab.text=Language.instance.parseInsertText("tianshi_plus_type"+t.type,t.allplus/GameDefine.GAME_ADD_RATIO*100+"%"),t){this.progress.maximum=t.exp,this.progress.value=this.playerM.player.shareExp,this.progress.labelFunction=function(e,t){return DataManager.getInstance().playerManager.player.shareExp+"/"+t},this.activate_btn.enabled=!0,this.playerM.player.shareExp<t.exp?this.activate_btn.label=this.INVITE_TEXT:this.activate_btn.label=Language.instance.getText("shenqijihuo"),this.anim?this.anim.onUpdateRes(t.donghua,-1):(this.anim=new Animation(t.donghua),this.effcet_grp.addChild(this.anim));for(var n in this.ADD_EXP_PARAM){var a=this.ADD_EXP_PARAM[n],i=a.func?this[a.func]():2,o=16574620,r=(h=Language.instance).parseInsertText.apply(h,["tianshi_condition_type"+a.type].concat(a.param));switch(-1!=r.indexOf("[$tianshiInviteNum]")&&(r=r.replace("[$tianshiInviteNum]",this.playerM.tianshiInviteNum+"")),-1!=r.indexOf("[$friendNumMax]")&&(r=r.replace("[$friendNumMax]",t.friendNumMax+"")),-1!=r.indexOf("[$tianshiAwdNum]")&&(r=r.replace("[$tianshiAwdNum]",e+"")),i){case 1:o=2292736,r+="(点击可领取)";break;case 2:o=16773120,r+="(已完成)";break;default:r+="(进行中)"}var s=GameCommon.getInstance().createNormalLabel(18,o,2,2490368,egret.HorizontalAlign.CENTER);s.width=520,s.lineSpacing=5,s.text=r,1==i&&GameCommon.getInstance().addUnderlineStr(s),this.add_condition_grp.addChild(s)}}else this.progress.maximum=1,this.progress.value=1,this.progress.labelFunction=function(e,t){return"MAX"},this.activate_btn.enabled=!1,this.activate_btn.label=Language.instance.getText("full_level"),this.anim&&(this.anim.onDestroy(),this.anim=null);var h},t.prototype.onOpenAtlasPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TianshiAtlasPanel")},t.prototype.onReward=function(){var e=JsonModelManager.instance.getModelshareMaster()[this.playerM.player.shareMasterId+1];e&&e.friendNumMax>this.playerM.tianshiAwdNum&&this.playerM.tianshiInviteNum-this.playerM.tianshiAwdNum>0&&this.playerM.onSendTianshiAwardMsg()},t.prototype.onActivate=function(){if(this.activate_btn.label==this.INVITE_TEXT)SDKManager.share(this,WX_SHARE_TYPE.INVITE_FRIEND);else{var e=new Message(MESSAGE_ID.XYX_SHARE_MASTER_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onCheckCondition1=function(){var e=JsonModelManager.instance.getModelshareMaster()[this.playerM.player.shareMasterId+1];if(e){if(e.friendNumMax<=this.playerM.tianshiAwdNum)return 2;if(this.playerM.tianshiInviteNum-this.playerM.tianshiAwdNum>0)return 1}return 0},t}(BaseTabView);__reflect(TianShiLevelPanel.prototype,"TianShiLevelPanel",["ISDKShareContainer"]);var TianShiMainPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PanelSkinActivity},t.prototype.onInit=function(){this.points=[];var t=[],n=new RegisterSystemParam;n.redP=this.createRedPoint(),n.tabBtns=[];var a=new RegisterTabBtnParam;a.sysName="TianShiLevelPanel",a.tabBtnRes="icon_zhuangbeihuishou_png",a.title="天师",a.redP=this.createRedPoint(),a.redP.addTriggerFuc(DataManager.getInstance().playerManager,"oncheckTianshiRPoint"),n.tabBtns.push(a),t.push(n),this.registerPage(t,"tianshiGrp",new egret.Point(120,-10)),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseSystemPanel);__reflect(TianShiMainPanel.prototype,"TianShiMainPanel");var TIANSHI_PULS_TYPE;!function(e){e[e.FEI_JIAN=0]="FEI_JIAN",e[e.SHEN_BING=1]="SHEN_BING",e[e.SHEN_ZHUANG=2]="SHEN_ZHUANG",e[e.BAO_QI=3]="BAO_QI",e[e.XIAN_YU=4]="XIAN_YU",e[e.FORGE=5]="FORGE",e[e.PILL=6]="PILL",e[e.RUNE=7]="RUNE",e[e.RED_EQUIP=8]="RED_EQUIP",e[e.BOOK=9]="BOOK",e[e.TUJIAN=10]="TUJIAN",e[e.XINFA=11]="XINFA",e[e.GOD_ARTIFACT=12]="GOD_ARTIFACT"}(TIANSHI_PULS_TYPE||(TIANSHI_PULS_TYPE={}));var TianshuLevelUpPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TianshuUpLevelSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineGet(this.label_get),this.btnAry=[],this.points=[];var t=JsonModelManager.instance.getModeltianshushengji();for(var n in t){var a=t[n],i=new eui.RadioButton;if(i.skinName=skins.TianshuRadioButtonSkin,i.label=a.name,i.icon=a.icon,i.groupName="tianshuTabGrp",i.value=a.id,this.btnAry.push(i),!this.points[this.points.length]){var o=new redPoint;o.register(i,GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().playerManager,"oncheckRPTianshuLevelById",a.id),this.points[this.points.length]=o}this.itemlist_grp.addChild(i)}var r=new redPoint;this.points[this.points.length]=r,r.register(this.strengthenMasterBtn,new egret.Point(70,10),DataManager.getInstance().strongerManager,"getPoint",STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL),this.curTianshuId=this.btnAry[0].value,this.btnAry[0].selected=!0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onChangeTianshuHandle(),this.qianghuaPro.maximum=DataManager.getInstance().strongerManager.getNextMuBiao(STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL),this.qianghuaPro.value=DataManager.getInstance().strongerManager.getCurNumByType(STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandle,this);for(var t=0;t<this.btnAry.length;t++){var n=this.btnAry[t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabHandle,this)}this.activate_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpLevel,this),this.levelup_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpLevel,this),this.one_levelup_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onekeyUpLevel,this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandle,this);for(var t=0;t<this.btnAry.length;t++){var n=this.btnAry[t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabHandle,this)}this.activate_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpLevel,this),this.levelup_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpLevel,this),this.one_levelup_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onekeyUpLevel,this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openStrongerMonsterPanel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.trigger=function(){for(var e=0;e<this.points.length;e++)this.points[e].checkPoint()},t.prototype.onTouchTabHandle=function(e){var t=e.currentTarget;this.curTianshuId!=t.value&&(this.curTianshuId=t.value,this.onChangeTianshuHandle())},t.prototype.onChangeTianshuHandle=function(){var e=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId];if(e){this.tianshuAnim?this.tianshuAnim.onUpdateRes(e.Appearance,-1):this.tianshuAnim=GameCommon.getInstance().addAnimation(e.Appearance,null,this.effect_grp,-1);var t=this.playerData.tianshuDict[this.curTianshuId];if(t)this.activate_btn.visible&&(this.activate_btn.visible=!1),this.consumItem.visible||(this.levelup_btn.visible=!0,this.one_levelup_btn.visible=!0,this.consumItem.visible=!0,this.getGrp.visible=!0,this.jiantou.visible=!0,this.curPro.visible=!0,this.nextPro.visible=!0,this.open_desc_lab.text=""),this.label_name.text=t.level+"\n级",this.exp_probar.maximum=e.exp+5*Math.floor(t.level/10),this.exp_probar.value=t.lvExp;else{this.label_name.text="0\n级",this.exp_probar.maximum=e.exp,this.exp_probar.value=0;var n=!0,a="";if(e.tiaojian>0){var i=this.playerData.tianshuDict[this.curTianshuId-1],o=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId-1];o&&(!i||i.level<e.tiaojian)&&(n=!1,a="需"+o.name+"升到"+e.tiaojian+"级方可激活")}this.activate_btn.visible=!0,this.activate_btn.enabled=n,this.levelup_btn.visible=!1,this.one_levelup_btn.visible=!1,this.consumItem.visible=!1,this.getGrp.visible=!1,this.jiantou.visible=!1,this.curPro.visible=!1,this.nextPro.visible=!1,this.open_desc_lab.text=a}var r,s=[],h=t?t.level:0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var l in e.attrAry){if(e.attrAry[l]>0){var g=e.attrAry[l]*h;r=new AttributesText,r.updateAttr(l,g),this.curPro.addChild(r),g=e.attrAry[l]*(h+1),r=new AttributesText,r.updateAttr(l,g),this.nextPro.addChild(r)}s[l]=e.attrAry[l]*h}this.powerBar.power=GameCommon.calculationFighting(s),this.consumItem.visible&&this.consumItem.setCostByAwardItem(e.cost)}},t.prototype.onGetHandle=function(){var e=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId];e&&GameCommon.getInstance().onShowFastBuy(e.cost.id,e.cost.type)},t.prototype.openStrongerMonsterPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",STRONGER_MONSTER_TYPE.STRONGER_TIANSHU_LEVEL))},t.prototype.onUpLevel=function(){var e=this.playerData.tianshuDict[this.curTianshuId];if(e){var t=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId];if(!t)return;if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num,t.cost.type))return}var n=new Message(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE);n.setByte(0),n.setShort(this.curTianshuId),n.setByte(0),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.onekeyUpLevel=function(){var e=this.playerData.tianshuDict[this.curTianshuId];if(e){var t=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId];if(!t)return;if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num,t.cost.type))return}var n=new Message(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE);n.setByte(0),n.setShort(this.curTianshuId),n.setByte(99),GameCommon.getInstance().sendMsgToServer(n)},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(TianshuLevelUpPanel.prototype,"TianshuLevelUpPanel");var TianshuMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_TIANSHU,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="TianshuLevelUpPanel",n.btnRes="tianshu_tabicon",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"oncheckRPTianshuLevel"),t.push(n);var n=new RegisterSystemParam;n.sysName="TianshuUpgradePanel",n.btnRes="tianshu_tab2_icon",n.funcID=FUN_TYPE.FUN_TIANSHU_TUPO,n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().playerManager,"oncheckRPTianshuGrade"),t.push(n),this.registerPage(t,"tianshuGroup",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("tianshu_title_png")}e.prototype.onRefresh.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onShowWithParam=function(t){e.prototype.onShowWithParam.call(this,t)},t}(BaseSystemPanel);__reflect(TianshuMainPanel.prototype,"TianshuMainPanel");var TianshuUpgradePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TianshuUpgradeSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineGet(this.label_get),this.btnAry=[],this.points=[];var t=JsonModelManager.instance.getModeltianshushengji();for(var n in t){var a=t[n],i=new eui.RadioButton;if(i.skinName=skins.TianshuRadioButtonSkin,i.label=a.name,i.icon=a.icon,i.groupName="tianshuTabGrp",i.value=a.id,this.btnAry.push(i),!this.points[this.points.length]){var o=new redPoint;o.register(i,GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().playerManager,"oncheckRPTianshuGradeById",a.id),this.points[this.points.length]=o}this.itemlist_grp.addChild(i)}this.curTianshuId=this.btnAry[0].value,this.btnAry[0].selected=!0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onChangeTianshuHandle()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.getGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandle,this);for(var t=0;t<this.btnAry.length;t++){var n=this.btnAry[t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabHandle,this)}this.upgrade_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TIANSHU_UPGRADE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.getGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGetHandle,this);for(var t=0;t<this.btnAry.length;t++){var n=this.btnAry[t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabHandle,this)}this.upgrade_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUpgrade,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TIANSHU_UPGRADE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onTouchTabHandle=function(e){var t=e.currentTarget;this.curTianshuId!=t.value&&(this.curTianshuId=t.value,this.onChangeTianshuHandle())},t.prototype.onChangeTianshuHandle=function(){var e=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId];if(e){var t=JsonModelManager.instance.getModeltianshutupo()[this.curTianshuId];if(t){this.tianshuAnim?this.tianshuAnim.onUpdateRes(e.Appearance,-1):this.tianshuAnim=GameCommon.getInstance().addAnimation(e.Appearance,null,this.effect_grp,-1);var n=0,a=this.playerData.tianshuDict[this.curTianshuId];if(a)this.upgrade_btn.enabled||(this.upgrade_btn.enabled=!0),this.upgrade_btn.label=Language.instance.getText("shenqishengjie"),this.consumItem.visible||(this.consumItem.visible=!0,this.getGrp.visible=!0,this.open_desc_lab.text="",this.nextPro.visible=!0,this.curPro.visible=!0,this.jiantou.visible=!0),this.label_name.text=a.grade+"\n阶",n=a.grade;else{this.label_name.text="0\n阶";var i=!0,o="";if(e.tiaojian>0){var r=this.playerData.tianshuDict[this.curTianshuId-1],s=JsonModelManager.instance.getModeltianshushengji()[this.curTianshuId-1];s&&(!r||r.level<e.tiaojian)&&(i=!1,o="需"+s.name+"升到"+e.tiaojian+"级方可激活")}this.upgrade_btn.enabled=i,this.upgrade_btn.label=Language.instance.getText("shenqijihuo"),this.consumItem.visible=!1,this.getGrp.visible=!1,this.nextPro.visible=!1,this.curPro.visible=!1,this.jiantou.visible=!1,this.open_desc_lab.text=o}var h,l=[],g=a?a.grade:0;this.curPro.removeChildren(),this.nextPro.removeChildren();for(var c in t.attrAry){if(t.attrAry[c]>0){var p=t.attrAry[c]*g;h=new AttributesText,h.scaleX=.8,h.scaleY=.8,h.updateAttr(c,p),this.curPro.addChild(h),p=t.attrAry[c]*(g+1),h=new AttributesText,h.scaleX=.8,h.scaleY=.8,h.updateAttr(c,p),this.nextPro.addChild(h)}l[c]=t.attrAry[c]*g}for(var c in t.attrAry){var u=GameDefine.getAttrPlusKey(parseInt(c)+GameDefine.ATTR_OBJ_KEYS.length);if(t[u]&&t[u]>0){var p=t[u]*g/GameDefine.GAME_ADD_RATIO*100;h=new AttributesText,h.scaleX=.8,h.scaleY=.8,h.updateAttr(c,p.toFixed(2)+"%"),this.curPro.addChild(h),p=t[u]*(g+1)/GameDefine.GAME_ADD_RATIO*100,h=new AttributesText,h.scaleX=.8,h.scaleY=.8,h.updateAttr(c,p.toFixed(2)+"%"),this.nextPro.addChild(h)}}this.powerBar.power=GameCommon.calculationFighting(l),this.consumItem.visible&&this.consumItem.setCostByAwardItem(t.cost)}}},t.prototype.onGetHandle=function(){var e=JsonModelManager.instance.getModeltianshutupo()[this.curTianshuId];e&&GameCommon.getInstance().onShowFastBuy(e.cost.id,e.cost.type)},t.prototype.onUpgrade=function(){var e=this.playerData.tianshuDict[this.curTianshuId];if(e){var t=JsonModelManager.instance.getModeltianshutupo()[this.curTianshuId];if(!t)return;var n=new Message(MESSAGE_ID.TIANSHU_UPGRADE_MESSAGE);n.setByte(0),n.setShort(this.curTianshuId),GameCommon.getInstance().sendMsgToServer(n)}else{var a=new Message(MESSAGE_ID.TIANSHU_LEVELUP_MESSAGE);a.setByte(0),a.setShort(this.curTianshuId),a.setByte(0),GameCommon.getInstance().sendMsgToServer(a)}},Object.defineProperty(t.prototype,"playerData",{get:function(){return DataManager.getInstance().playerManager.player.getPlayerData()},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(TianshuUpgradePanel.prototype,"TianshuUpgradePanel");var RoleTitlePanel=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.titleIdNow=1,t.titleTab=0,t}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RoleTitlePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.list.itemRenderer=TitleItem,this.list.useVirtualLayout=!1,this.onRefresh()},t.prototype.onRefresh=function(){for(var e=DataManager.getInstance().titleManager.getTitleArray(this.titleTab),t=GameCommon.getInstance().getAttributeAry(),n=0,a=0;a<e.length;a++){n++;var i=e[a];if(DataManager.getInstance().titleManager.isTitleActive(i.id))for(var o=DataManager.getInstance().titleManager.getTitleData(i.id),r=0;r<ATTR_TYPE.SIZE;++r)t[r]+=GameCommon.getInstance().getAttributeAry(i)[r]*o.lv}var s;s=this.powerbar,s.power=(GameCommon.calculationFighting(t)*DataManager.getInstance().playerManager.player.playerDatas.length).toString(),this.titleList=[];for(var h in e)this.curType==e[h].type&&this.titleList.push(e[h]);this.list.dataProvider=new eui.ArrayCollection(this.titleList)},Object.defineProperty(t.prototype,"curType",{get:function(){return this.owner.subTab},enumerable:!0,configurable:!0}),t.prototype.onRefreshNow=function(){0!=DataManager.getInstance().titleManager.curTitleId&&(this.titleIdNow=DataManager.getInstance().titleManager.curTitleId);for(var e=DataManager.getInstance().titleManager.getTitleArray(this.titleTab),t=GameCommon.getInstance().getAttributeAry(),n=0,a=0;a<e.length;a++){n++;var i=e[a];if(DataManager.getInstance().titleManager.isTitleActive(i.id))for(var o=DataManager.getInstance().titleManager.getTitleData(i.id),r=0;r<ATTR_TYPE.SIZE;++r)t[r]+=GameCommon.getInstance().getAttributeAry(i)[r]*o.lv}var s;s=this.powerbar,s.power=(GameCommon.calculationFighting(t)*DataManager.getInstance().playerManager.player.playerDatas.length).toString(),this.titleList=[];for(var h in e)this.curType==e[h].type&&this.titleList.push(e[h]);this.list.dataProvider=new eui.ArrayCollection(this.titleList)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemBtn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TITLE_WEAR_MESSAGE.toString(),this.onRefreshNow,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TITLE_JIHUO_MESSAGE.toString(),this.onRefreshNow,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemBtn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TITLE_WEAR_MESSAGE.toString(),this.onRefreshNow,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TITLE_JIHUO_MESSAGE.toString(),this.onRefreshNow,this)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onItemBtn=function(e){console.log(e.itemIndex);var t=e.itemRenderer;this.onItemBtnMethod(t)},t.prototype.onItemBtnMethod=function(e){this.currentItem=e,this.titleIdNow=DataManager.getInstance().titleManager.curTitleId},t}(BaseTabView);__reflect(RoleTitlePanel.prototype,"RoleTitlePanel");var TitleItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.TitleItemSkin,t.once(egret.Event.COMPLETE,t.onComplete,t),t.once(egret.Event.ADDED,t.onRegist,t),t}return __extends(t,e),t.prototype.onRegist=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleUpLv,this)},t.prototype.onRemove=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleUpLv,this)},t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){this.titleId=this.data.id,this.name="TitleItem_"+this.titleId;var e=JsonModelManager.instance.getModelchenghao()[this.titleId];if(this.desc.text=e.name,this.updateWeared(0),DataManager.getInstance().titleManager.isTitleActive(this.titleId)){DataManager.getInstance().playerManager.player.getPlayerData().titleId==this.titleId&&this.updateWeared(1);var t=DataManager.getInstance().titleManager.getTitleData(e.id);t.time<0||-1==e.time?this.currentState="lv":this.currentState="normal",-1==t.time?this.timeLabel.text="Lv."+t.lv:(this.timeLabel.visible=!0,Tool.addTimer(this.onCountDown,this,6e4));var n=GameCommon.getInstance().getAttributeAry();n[ATTR_TYPE.HP]=e.hp*t.lv,n[ATTR_TYPE.ATTACK]=e.attack*t.lv,n[ATTR_TYPE.PHYDEF]=e.phyDef*t.lv,n[ATTR_TYPE.MAGICDEF]=e.magicDef*t.lv;var a;a=this.powerbar0,a.power=GameCommon.calculationFighting(n)}else{this.timeLabel.text="未拥有";var n=GameCommon.getInstance().getAttributeAry();n[ATTR_TYPE.HP]=e.hp,n[ATTR_TYPE.ATTACK]=e.attack,n[ATTR_TYPE.PHYDEF]=e.phyDef,n[ATTR_TYPE.MAGICDEF]=e.magicDef;var a;a=this.powerbar0,a.power=GameCommon.calculationFighting(n)}if(this.anim?this.anim.onupdate(e):(this.anim=new TitleBody(e),this.anim.scaleX=.7,this.anim.scaleY=.7,this.ani.addChild(this.anim)),e.cost.id&&e.time<0){var i=DataManager.getInstance().bagManager.getGoodsThingById(e.cost.id,e.cost.type),o=i?i.num:0;this.newPoint.visible=o>0}},t.prototype.onCountDown=function(){var e=DataManager.getInstance().titleManager.getTitleCountDown(this.titleId);e>0?this.timeLabel.text="期限："+Tool.getDayHourMinuteTimeStr(e):Tool.removeTimer(this.onCountDown,this)},t.prototype.onTitleUpLv=function(){DataManager.getInstance().titleManager.curTitleId=this.titleId,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TitleUpLvPanel",this.titleId))},t.prototype.updateWeared=function(e){0==e?this.titleWeared.visible=!1:1==e&&(this.titleWeared.visible=!0)},t}(eui.ItemRenderer);__reflect(TitleItem.prototype,"TitleItem");var TitleUpLvPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("称号"),this.onRefresh()},t.prototype.onShowWithParam=function(e){this.titleId=e,this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.lvUpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleUpLv,this),this.chuandaiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleBtn,this),this.btnJiHuo.addEventListener(egret.TouchEvent.TOUCH_END,this.onTitleJiHuo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TITLE_WEAR_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TITLE_JIHUO_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.lvUpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleUpLv,this),this.chuandaiBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTitleBtn,this),this.btnJiHuo.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTitleJiHuo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TITLE_WEAR_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TITLE_JIHUO_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRefresh=function(){var e=JsonModelManager.instance.getModelchenghao()[this.titleId];this.desc.text=e.desc;var t=GameCommon.getInstance().getAttributeAry();t[ATTR_TYPE.HP]=e.hp,t[ATTR_TYPE.ATTACK]=e.attack,t[ATTR_TYPE.PHYDEF]=e.phyDef,t[ATTR_TYPE.MAGICDEF]=e.magicDef;var n="",a=(GameCommon.getInstance().getAttributeAry(),""),i=DataManager.getInstance().titleManager.getTitleData(e.id),o=0;i&&(o=i.lv);for(var r=0;r<ATTR_TYPE.SIZE;++r)t[r]+=GameCommon.getInstance().getAttributeAry(e)[r]*o;for(var s=0;s<e.attrAry.length;++s)e.attrAry[s]>0&&(n=n+GameDefine.Attr_FontName[s]+"："+e.attrAry[s]*o+"\n",a=a+GameDefine.Attr_FontName[s]+"："+e.attrAry[s]*(o+1)+"\n");this.titleItem.data=e,this.curPro.text=n,this.nextPro.text=a,DataManager.getInstance().titleManager.isTitleActive(this.titleId)?(this.consumItem.visible=!0,this.chuandaiBtn.visible=!0,DataManager.getInstance().playerManager.player.getPlayerData().titleId==this.titleId?this.chuandaiBtn.label="卸 下":this.chuandaiBtn.label="穿 戴",i.time<0||-1==e.time?(this.currentState="uplv",this.btnJiHuo.visible=!1,this.upInfo(e)):(this.currentState="normal",this.btnJiHuo.visible=!1,this.consumItem.visible=!1)):-1==e.time?(this.currentState="normal",this.btnJiHuo.visible=!0,this.chuandaiBtn.visible=!1,this.consumItem.visible=!0,this.upInfo(e)):(this.currentState="noUp",this.curPro.text=a,this.btnJiHuo.visible=!1,this.chuandaiBtn.visible=!1,this.consumItem.visible=!1)},t.prototype.upInfo=function(e){GameCommon.getInstance().getThingModel(e.cost.type,e.cost.id);this.consumItem.setCostByAwardItem(e.cost)},t.prototype.onSkinName=function(){this.skinName=skins.TitleUpLvSkin},t.prototype.onTitleUpLv=function(){var e=new Message(MESSAGE_ID.TITLE_JIHUO_MESSAGE);e.setShort(this.titleId),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onChangeRole=function(){this.onRefresh()},t.prototype.getPlayerjiaoseData=function(){return DataManager.getInstance().playerManager.player.getPlayerData()},t.prototype.onTitleBtn=function(){DataManager.getInstance().titleManager.curTitleId=this.titleId,this.dispatchEvent(new egret.Event(egret.TouchEvent.TOUCH_CANCEL));var e=new Message(MESSAGE_ID.TITLE_WEAR_MESSAGE);e.setByte(0),DataManager.getInstance().playerManager.player.getPlayerData().titleId==this.titleId?e.setShort(0):e.setShort(this.titleId),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onTitleJiHuo=function(){DataManager.getInstance().titleManager.curTitleId=this.titleId,this.dispatchEvent(new egret.Event(egret.TouchEvent.TOUCH_CANCEL));var e=new Message(MESSAGE_ID.TITLE_JIHUO_MESSAGE);e.setShort(this.titleId),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(TitleUpLvPanel.prototype,"TitleUpLvPanel");var OtherCoatardPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.CoatardPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherCoatardPanel.prototype,"OtherCoatardPanel");var OtherForgePanel=function(e){function t(t){var n=e.call(this,t)||this;
return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherForgePanel.prototype,"OtherForgePanel");var OtherjingmaiPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PulsePanelSkin},t.prototype.onInit=function(){this.onebuyBtn.visible=!1,this.btn_advance.visible=!1,this.currency.visible=!1,this.role_list_bar.registFuncBack(this.onChangeRole,this);for(var t,n=0;9>n;n++)t=this["acupoint"+n],t.index=n;e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.prototype.onRefresh=function(){for(var e=DataManager.getInstance().topRankManager.otherindexdate().Otherplayerarr,t=[],n=0;n<e.length;n++)t.push(e[n].occupation);this.role_list_bar&&this.role_list_bar.registOtherBar(t);var a=DataManager.getInstance().topRankManager.otherindexdate().Otherplayerarr[this.role_list_bar.index].jingmailv,i=JsonModelManager.instance.getModeljingmai()[a+1],o=JsonModelManager.instance.getModeljingmai()[a+2],r=i||o;o&&(r=o),this.label_currTeir.text=i.jieduan+"阶";var s;this.currLayer.removeChildren(),this.nextLayer.removeChildren();var h=0;for(var l in r.attrAry)r.attrAry[l]>0&&(s=new suitAttributeItem,h=i?i.attrAry[l]:0,s.data=[GameDefine.Attr_Name[l]+":","+"+h,0],this.currLayer.addChild(s),s=new suitAttributeItem,h=o?o.attrAry[l]:0,s.data=[GameDefine.Attr_Name[l]+":","+"+h,h],this.nextLayer.addChild(s));for(var g,n=0;9>n;n++)g=this["acupoint"+n],g.data=a%9;o&&0==o.cost.num?this.btn_advance.label="免费升阶":this.btn_advance.label="提升",this.onUpdatePlayerPower(),this.updateConsItem()},t.prototype.onUpdatePlayerPower=function(){var e=JsonModelManager.instance.getModeljingmai()[DataManager.getInstance().topRankManager.otherindexdate().Otherplayerarr[this.role_list_bar.index].jingmailv];this.powerbar.power=String(e?GameCommon.calculationFighting(e.attrAry):0)},t.prototype.updateConsItem=function(){var e=DataManager.getInstance().topRankManager.otherindexdate().Otherplayerarr[this.role_list_bar.index].jingmailv;JsonModelManager.instance.getModeljingmai()[e+2]},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.updateGoodsADD=function(){this.updateConsItem(),this.onUpdatePlayerPower()},t.prototype.onTouchBtnAdvance=function(){var e=new Message(MESSAGE_ID.PLAYER_PULSE_UPGRADE_MESSAGE);e.setByte(this.role_list_bar.index),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onChangeRole=function(){this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(this.role_list_bar.index)},t}(BaseTabView);__reflect(OtherjingmaiPanel.prototype,"OtherjingmaiPanel");var OtherLegendEquipPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherLegendEquipPanel.prototype,"OtherLegendEquipPanel");var OtherOrangePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.OrangePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherOrangePanel.prototype,"OtherOrangePanel");var OtherPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="OtherplayerDate",n.btnRes="角色",t.push(n),this.registerPage(t,"roleGrp"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("角色");break;case 1:this.setTitle("");break;case 2:this.setTitle("pulse_title_png");break;case 3:this.setTitle("pulse_title_png")}e.prototype.onRefresh.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onTouchTabBtn=function(e){e.currentTarget.name},t}(BaseSystemPanel);__reflect(OtherPanel.prototype,"OtherPanel");var OtherplayerDate=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.OtherSkin},t.prototype.onInit=function(){for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this["equip_bar"+t];n.shieldTip=!0,n.pos=t}this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e,t=DataManager.getInstance().topRankManager.otherindexdate().otherzhuan,n=(JsonModelManager.instance.getModelzhuansheng()[t],DataManager.getInstance().topRankManager.otherindexdate());this.userName.text=n.othername+"";var a=n.Otherplayerarr[0];this.userId.text=n.otherid+"",this.userLv.text=n.otherzhuan+"转"+n.otherlv+"级";var i=GameCommon.getInstance().getVipLevel(n.othervip);this.vip.text="VIP"+GameCommon.getInstance().getVipName(i);var o=new Array;o.push({text:"战功Lv：",style:{textColor:16767595,stroke:2,strokeColor:2622982}}),o.push({text:n.zhangongLv+""}),this.zhangong.textFlow=o;for(var r=0;r<n.attributes.length;r++){var s=new Array;s.push({text:GameDefine.Attr_FontName[r]+"：",style:{textColor:16767595,stroke:2,strokeColor:2622982}}),s.push({text:n.attributes[r]+""}),this["attPro"+r].textFlow=s}for(var r=0;r<GameDefine.Equip_Slot_Num;r++){var h=a?a.equipdatearr[r]:null;if(e=this["equip_bar"+r],h&&h.model){var l=0;a&&(l=a.equipgroovearr[r].quenchingLv),e.onUpdate(h,l)}else e.pos=r,e.onUpdate(h,0);var g=new EquipSlotThing;a&&(g.infuseLv=a.equipgroovearr[r].zhuling,g.intensifyLv=a.equipgroovearr[r].qianghua,g.gemLv=a.equipgroovearr[r].baoshi,g.zhLv=a.equipgroovearr[r].zhuhun,g.quenchingLv=a.equipgroovearr[r].quenchingLv,g.quenchingExp=a.equipgroovearr[r].quenchingExp),e.showSoulFrame(g.zhLv>0),e.forgeInfo=g}for(var r=0;r<BLESS_TYPE.SIZE;r++){var s=new Array;s.push({text:Language.instance.getText("bless"+r+"_name")+"：",style:{textColor:16767595,stroke:2,strokeColor:2622982}}),s.push({text:a.blessstagedata[r]+"级"}),this["bless_txt"+r].textFlow=s;var c=new Array;c.push({text:"战力：",style:{textColor:16767595,stroke:2,strokeColor:2622982}}),c.push({text:a.blessPowerdata[r]+""}),this["power"+r].textFlow=c}this.onupdateFightPower(),this.onUpdateAvata()},t.prototype.onupdateFightPower=function(){this.powerbar.power=this.getPlayerData().figthPower},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this["equip_bar"+t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<GameDefine.Equip_Slot_Num;t++){var n=this["equip_bar"+t];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)}},t.prototype.onTouch=function(e){if(this.getPlayerData()){var t=e.currentTarget,n=t.getEquipThing();n&&n.model&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ItemIntroducebar",new IntroduceBarParam(INTRODUCE_TYPE.OTHER_CLOHT,GOODS_TYPE.MASTER_EQUIP,this.getPlayerData(),0,t.pos,this.getPlayerData().occupation)))}},t.prototype.onUpdateAvata=function(){},t.prototype.getPlayerData=function(){return DataManager.getInstance().topRankManager.otherindexdate().Otherplayerarr[0]},t}(BaseWindowPanel);__reflect(OtherplayerDate.prototype,"OtherplayerDate");var OtherPsychPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PsychPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherPsychPanel.prototype,"OtherPsychPanel");var OtherPulsePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.PulsePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherPulsePanel.prototype,"OtherPulsePanel");var OtherSkillPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.redPointLayer.visible=!1,this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(OtherSkillPanel.prototype,"OtherSkillPanel");var TopRankActivityPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TopRankActivitySkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onInit=function(){this.setTitle("排行"),this.itemGroup.itemRenderer=TopRankActivityItem,this.itemGroup.itemRendererSkinName=skins.TopRankSimpleItemSkin,this.itemGroup.useVirtualLayout=!1,this.top_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().topRankManager;this.currType=e.lastRankType,this.onRefreshTitle(),this.itemGroup.dataProvider=new eui.ArrayCollection(e.lastDataList)},t.prototype.onRefreshTitle=function(){this.currentState="lineThree",this.currType==TopRankManager.RANK_SIMPLE_TYPE_DABIAO?this.label_value_name.text=DataManager.getInstance().newactivitysManager.dabiao_model.ranktitle:this.currType==TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_TARGET?this.label_value_name.text="消费钻石":this.currType==TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_PAYTARGET?this.label_value_name.text="充值钻石":this.currType==TopRankManager.RANK_SIMPLE_TYPE_FESTIVAL_ZHUANPAN&&(this.label_value_name.text="转盘次数")},t}(BaseWindowPanel);__reflect(TopRankActivityPanel.prototype,"TopRankActivityPanel");var TopRankActivityItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){var e=this.data;this.label_rank.text=e.rank+"",e.vip>0?(this.label_vip.visible=!0,this.label_vip.source="vip_v_png"):(this.label_vip.visible=!1,this.label_vip.source=""),this.label_name.text=e.name,e.fighting>=0?this.label_value.text=e.value+"阶"+e.fighting+"星":this.label_value.text=e.value+""},t}(eui.ItemRenderer);__reflect(TopRankActivityItem.prototype,"TopRankActivityItem");var TOPRankingList=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_TOPRANK,n.rankTab="tabBtn_rank",n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){var t=[];this.basic.bgDi.visible=!1;var n=new RegisterSystemParam;n.sysName="TOPRankTypeListPanel",n.btnRes="排行",t.push(n),this.setTitle("排行榜"),this.registerPage(t,"bagGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseSystemPanel);__reflect(TOPRankingList.prototype,"TOPRankingList");var TopRankSimplePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TopRankSimpleSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onInit=function(){this.itemGroup.itemRenderer=TopRankSimpleItem,this.itemGroup.itemRendererSkinName=skins.TopRankSimpleItemSkin,this.itemGroup.useVirtualLayout=!0,this.top_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().topRankManager;this.currType=e.lastRankType,this.onRefreshTitle(),this.itemGroup.dataProvider=new eui.ArrayCollection(e.lastDataList)},t.prototype.onRefreshTitle=function(){this.setTitle("排名"),this.label_value_name.text="关卡"},t.prototype.onShowWithParam=function(t){var n=DataManager.getInstance().topRankManager;n.lastRankType=t.currType,n.lastDataList=t.dataList,e.prototype.onShowWithParam.call(this,t)},t.ADD_STR="关",t.NAME2_VISIBLE=!0,t}(BaseWindowPanel);__reflect(TopRankSimplePanel.prototype,"TopRankSimplePanel");var TopRankSimpleItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){var e=this.data;this.label_rank.text=e.rank+"",this.bg_img.source=e.rank%2==0?"public_di1_png":"public_di5_png",e.vip>0?(this.label_vip.visible=!0,this.label_vip.source="vip_v_png"):(this.label_vip.visible=!1,this.label_vip.source=""),this.label_name.text=e.name+"",this.label_value.text=GameCommon.getInstance().getFormatNumberShow(e.value)+TopRankSimplePanel.ADD_STR},t}(eui.ItemRenderer);__reflect(TopRankSimpleItem.prototype,"TopRankSimpleItem");var TopRankSimpleParam=function(){function e(){}return e}();__reflect(TopRankSimpleParam.prototype,"TopRankSimpleParam");var TOPRankTypeListPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TOPRankingListSkin},t.prototype.onInit=function(){this.tabs=[];for(var t=0;t<TOPRANK_TYPE.NUM;t++){this.tabs.push(this["layer_tab"+t]);var n=this["layer_tab"+t];n.name=""+t,n.iconDisplay.source="rankIcon_"+t+"_png",n.iconFrame.visible=!1}this.listLayer.itemRenderer=TopRankItem,this.listLayer.itemRendererSkinName=skins.TopRankItemSkin,this.listLayer.useVirtualLayout=!0,this.bar.viewport=this.listLayer,this.bar.verticalScrollBar.autoVisibility=!1,this.bar.verticalScrollBar.visible=!1,this.roleAppear=new RoleAppearBody,this.hero_show_group.addChild(this.roleAppear),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){if(t.tab==TOPRANK_TYPE.FIELD_PVP){var e=new Message(MESSAGE_ID.PAIHANGBANG_ZAOYUBANG_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onSelected()}else this.onSelected()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.tabs.length;t++)this.tabs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.firstLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFirst,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_TOPRANK_INFO_MESSAGE.toString(),this.onInfoReturn,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.OTHER_MESSAGE.toString(),this.otherdate,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PAIHANGBANG_ZAOYUBANG_MESSAGE.toString(),this.zaoyudate,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.tabs.length;t++)this.tabs[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.firstLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFirst,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_TOPRANK_INFO_MESSAGE.toString(),this.onInfoReturn,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.OTHER_MESSAGE.toString(),this.otherdate,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PAIHANGBANG_ZAOYUBANG_MESSAGE.toString(),this.zaoyudate,this)},t.prototype.GetTopManager=function(){return DataManager.getInstance().topRankManager},t.prototype.otherdate=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"OtherplayerDate")},t.prototype.onShowMyRankInfo=function(){var e=this.GetTopManager().myRanks[t.tab];1>e||void 0==e?this.label_myRank.text="我的排名: 未上榜        战斗力:"+DataManager.getInstance().playerManager.player.playerTotalPower:this.label_myRank.text="我的排名: "+e+"        战斗力:"+DataManager.getInstance().playerManager.player.playerTotalPower},t.prototype.updateAvatarAnim=function(){this.roleAppear.updateAvatarAnim(this.jiaose.appears,this.jiaose.sex)},t.prototype.onUpdateAvata=function(){if(this.chenghaobox.numChildren>0&&this.chenghaobox.removeChildren(),this.hero_show_group.visible=this.jiaose?!0:!1,this.jiaose){this.updateAvatarAnim();var e=JsonModelManager.instance.getModelchenghao()[t.tab+1];this.titleBody?this.titleBody.onupdate(e):this.titleBody=new TitleBody(e),this.chenghaobox.addChild(this.titleBody)}},t.prototype.zaoyudate=function(){this.data=DataManager.getInstance().topRankManager.zaoyuList,this.jiaose=DataManager.getInstance().topRankManager.outline1st[t.tab],this.onUpdateRankListHandler()},t.prototype.onInfoReturn=function(){if(t.tab==TOPRANK_TYPE.FIELD_PVP){var e=new Message(MESSAGE_ID.PAIHANGBANG_ZAOYUBANG_MESSAGE);return void GameCommon.getInstance().sendMsgToServer(e)}this.data=DataManager.getInstance().topRankManager.getTabInfo(t.tab),this.jiaose=DataManager.getInstance().topRankManager.outline1st[t.tab],this.onUpdateRankListHandler()},t.prototype.onUpdateRankListHandler=function(){if(!this.data||this.data.length<=1)if(this.layer_left.visible=!1,this.nulldateLab.visible=!0,this.data1st=null,this.item.data=null,0==this.data.length)this.jiaose=null,this.item.data=null,this.item.onInit(),this.hero_show_group.visible=!1,this.chenghaobox.numChildren>0&&this.chenghaobox.removeChildren();else{var e=this.data.concat();this.data1st=e.shift(),this.nulldateLab.visible=!1,this.item.data=this.data1st}else{this.layer_left.visible=!0;var e=this.data.concat();this.bar.stopAnimation(),this.bar.viewport.scrollV=0,this.data1st=e.shift(),this.nulldateLab.visible=!1,this.item.data=this.data1st,this.listLayer.dataProvider=new eui.ArrayCollection(e)}this.onShowMyRankInfo(),this.onUpdateAvata()},t.prototype.onTouchItem=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"OtherplayerDate")},t.prototype.onSelected=function(){for(var e=0;e<TOPRANK_TYPE.NUM;e++){var n=this["layer_tab"+e];n.iconFrame.visible=!1}this["layer_tab"+t.tab].iconFrame.visible=!0,this.rankName.text=t.rankTypeNames[t.tab],DataManager.getInstance().topRankManager.getTabInfo(t.tab)?this.onInfoReturn():this.onSendGetInfo()},t.prototype.onTouchFirst=function(){if(this.data1st){var e=new Message(MESSAGE_ID.OTHER_MESSAGE);e.setInt(this.data1st.id),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onTouchTab=function(e){var n=e.target.name;this["layer_tab"+t.tab].iconFrame.visible=!1,t.tab=parseInt(n),this["layer_tab"+t.tab].iconFrame.visible=!0,this.rankName.text=t.rankTypeNames[t.tab],this.onRefresh()},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t.prototype.getPlayerjiaoseData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(0)},t.prototype.onSendGetInfo=function(){var e=new Message(MESSAGE_ID.GAME_TOPRANK_INFO_MESSAGE);e.setByte(t.tab);t.tab;GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onShow=function(){e.prototype.onShow.call(this)},t.tab=0,t.rankTypeNames=["战力榜","转生榜","战功榜","成就榜","飞剑榜","神装榜","神兵榜","仙羽榜","宝器榜","宠物榜","试炼榜"],t}(BaseTabView);__reflect(TOPRankTypeListPanel.prototype,"TOPRankTypeListPanel");var TopRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;if(e){switch(this.currentState="normal",this.bmt_rank.visible=!1,this.powerbar&&(this.powerbar.visible=!1),this.rankDi&&(this.rankDi.visible=e.rank%2==0),e.rank){case 1:this.rank_img.visible=!0,this.rank_img.source="rank_1_png",this.bmt_rank.visible=!1;break;default:this.rank_img.visible=!1,this.rank_img.source="",this.bmt_rank.visible=!0,this.bmt_rank.text=e.rank.toString()}var t=new Array;switch(this.awardLayer.visible=TOPRankTypeListPanel.tab==TOPRANK_TYPE.FIELD_PVP,this.img_title.visible=TOPRankTypeListPanel.tab!=TOPRANK_TYPE.FIELD_PVP,this.label_vip.visible=!this.awardLayer.visible||1!=e.rank,TOPRankTypeListPanel.tab){case TOPRANK_TYPE.LEVEL:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.label_info.text=e.name,t.push({text:"等级："+this.getlevelStr(e),style:{textColor:14867089}}),t.push({text:"\n",style:{}}),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=this.getlevelStr(e)+" ",e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.CHENGJIU:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.label_info.text=e.name,t.push({text:"成就:"+e.info1,style:{textColor:14867089}}),t.push({text:"\n",style:{}}),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=e.info1,e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.FIGHTING:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.label_info.text=e.name,t.push({text:"等级："+this.getlevelStr(e),style:{textColor:14867089}}),t.push({text:"\n",style:{}}),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=e.info1,e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.ZHANGONG:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.label_info.text=e.name,t.push({text:"战功:"+e.info1,style:{textColor:14867089}}),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=e.info1,e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.HORSE:case TOPRANK_TYPE.CLOTHES:case TOPRANK_TYPE.WEAPON:case TOPRANK_TYPE.WING:var n=Tool.toInt(e.info1/10),a=e.info1%10;1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info.text=e.name,t.push({text:"阶段："+n+"级"+a+"星",style:{textColor:14867089}}),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=n+"级"+a+"星",e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.MAGIC:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info.text=e.name,t.push({text:"阶段："+e.info1+"级",style:{textColor:14867089}}),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=e.info1+"级",e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.CHONGWU:1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.powerbar&&(this.powerbar.visible=!0,this.powerbar.power=e.fightvalue),this.label_info.text=e.name,t.push({text:"阶段："+e.info1+"阶",style:{textColor:14867089}}),this.label_info1.textFlow=t):(this.label_info.text=e.name,this.label_info1.text=e.info1+"阶",e.rank<=10?(this.img_title.visible=!0,this.img_title.source="xiaochenghao"+(TOPRankTypeListPanel.tab+101)+"_png",this.img_title.scaleX=.8,this.img_title.scaleY=.8):this.img_title.visible=!1);break;case TOPRANK_TYPE.FIELD_PVP:this.currentState="shengwang",1==e.rank?(e.viplevel>0&&(this.label_vip.source="vip_v_png"),this.label_info.text=e.name,t.push({text:"奖励：",style:{textColor:14867089}}),this.label_info1.textFlow=t,this.label_info2.text="声望"+e.info1):(this.label_info.text=e.name,this.label_info1.text="声望"+e.info1,this.img_title.visible=!1);for(var i=this.getRankAwdModel(e.rank),o=0;2>o;o++)if(i.rewards.length>o){var r=GameCommon.getInstance().getThingModel(i.rewards[o].type,i.rewards[o].id);this["awd_icon"+o].source=r.dropicon,this["awd_num_label"+o].text=i.rewards[o].num+""}else this.awardLayer.visible=!1}e.viplevel>0?this.label_vip.visible=!0:this.label_vip.visible=!1,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)}},t.prototype.getlevelStr=function(e){return e.rebirthLv+"转"+e.level+"级"},t.prototype.getRankAwdModel=function(e){var t=JsonModelManager.instance.getModelzaoyubang();for(var n in t){var a=t[n];if(a.rankMax>e)return a}return t[t.length]},t.prototype.onInit=function(){this.powerbar.power=0,this.awardLayer.visible=!1,this.label_info.text="暂无榜首",this.label_info1.text=""},t.prototype.onTouchItem=function(){if(this.data){var e=new Message(MESSAGE_ID.OTHER_MESSAGE);e.setInt(this.data.id),GameCommon.getInstance().sendMsgToServer(e)}},t}(eui.ItemRenderer);__reflect(TopRankItem.prototype,"TopRankItem");var TOPRANK_TYPE;!function(e){e[e.FIGHTING=0]="FIGHTING",e[e.LEVEL=1]="LEVEL",e[e.ZHANGONG=2]="ZHANGONG",e[e.CHENGJIU=3]="CHENGJIU",e[e.HORSE=4]="HORSE",e[e.CLOTHES=5]="CLOTHES",e[e.WEAPON=6]="WEAPON",e[e.WING=7]="WING",e[e.MAGIC=8]="MAGIC",e[e.CHONGWU=9]="CHONGWU",e[e.FIELD_PVP=10]="FIELD_PVP",e[e.NUM=11]="NUM"}(TOPRANK_TYPE||(TOPRANK_TYPE={}));var TuJianPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.TuJianPanelSkin},t.prototype.onInit=function(){this.tujianGroup.itemRenderer=TuJianItem,this.tujianGroup.itemRendererSkinName=skins.TuJianItemSkin,this.tujianGroup.useVirtualLayout=!0,this.bar1.viewport=this.tujianGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TUJIAN_MESSAGE.toString(),this.onRefresh,this),e.prototype.onRegist.call(this),this.strengthenMasterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSuitBtnClick,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TUJIAN_MESSAGE.toString(),this.onRefresh,this),e.prototype.onRemove.call(this),this.strengthenMasterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSuitBtnClick,this)},t.prototype.onRefresh=function(){this.onUpdate()},t.prototype.onUpdate=function(){var e=DataManager.getInstance().playerManager.player.getPlayerData().tujianDataDict,t=GameCommon.getInstance().getAttributeAry(),n=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.TUJIAN);this.tujianList=[];for(var a in e){var i=e[a],o=i.model;if(this.curType==o.type){if(i.level>0)for(var r=0;r<ATTR_TYPE.SIZE;++r)i.attrAry[r]>0&&(t[r]+=i.attrAry[r]+Tool.toInt(i.attrAry[r]*n/GameDefine.GAME_ADD_RATIO));this.tujianList.push(i),this.tujianName.text=o.typeName}}this.powerbar.power=GameCommon.calculationFighting(t).toString(),this.tujianGroup.dataProvider=new eui.ArrayCollection(this.tujianList)},t.prototype.onSuitBtnClick=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("StrongerMonsterPanel",[STRONGER_MONSTER_TYPE.STRONGER_TUJIAN_SUIT,this.curType]))},Object.defineProperty(t.prototype,"curType",{get:function(){return this.owner.subTab},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(TuJianPanel.prototype,"TuJianPanel");var TuJianItem=function(e){function t(){var t=e.call(this)||this;return t.points=RedPointManager.createPoint(1),t}return __extends(t,e),t.prototype.onInit=function(){this.btnGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this)},t.prototype.onTouchItem=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TuJianUpGrade",this.data))},t.prototype.onUpdate=function(){var e=this.data;e&&(this.attr=e.attrAry,e.level>0?(this.jihuo.visible=!1,this.tujian_name.text=e.model.name+e.level+"级",this.tujiam_cover.source="tujian_kuang_di"+e.model.pinzhi+"_png"):(this.jihuo.visible=!0,this.tujian_name.text=e.model.name,this.tujiam_cover.source="tujian_weijihuo_png"),this.powerbar.power=GameCommon.calculationFighting(this.attr).toString(),this.animation.source=e.model.waixing1+"_png",this.points[0].register(this,GameDefine.RED_TUJIAN_SLOT,FunDefine,"checkTujianRedPointByClass",e.id))},t}(BaseListItem);__reflect(TuJianItem.prototype,"TuJianItem");var TujianTabItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.setSkinName=function(){this.skinName=skins.TujianTabItemSkin},t.prototype.onInit=function(){this._tabBack&&(this.tabBack=this._tabBack),this._tabFace&&(this.tabFace=this._tabFace)},Object.defineProperty(t.prototype,"tabBack",{set:function(e){this._tabBack=e,this.tab_back&&(this.tab_back.source=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabFace",{set:function(e){this._tabFace=e,this.tab_face&&(this.tab_face.source=e)},enumerable:!0,configurable:!0}),t}(BaseComp);__reflect(TujianTabItem.prototype,"TujianTabItem");var TuJianUpGrade=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onShowWithParam=function(e){this.tujianData=e,this.onShow()},t.prototype.onShow=function(){this.tujianData&&(this.width=size.width,this.height=size.height,e.prototype.onShow.call(this))},t.prototype.onSkinName=function(){this.skinName=skins.TuJianUpGradeSkin},t.prototype.onInit=function(){this.setTitle("图鉴升级"),GameCommon.getInstance().addUnderlineGet(this.label_get),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.updateTJNPanel(),this.updateNextAttr()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.jihuoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.tips_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.label_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.TUJIAN_MESSAGE.toString(),this.msgCallBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.jihuoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jihuoMethod,this),this.tips_mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.label_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.omTouchHQTJ,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.TUJIAN_MESSAGE.toString(),this.msgCallBack,this)
},t.prototype.jihuoMethod=function(){if("已满级"==this.jihuoBtn.label)return void GameCommon.getInstance().addAlert("图鉴已满级了");var e=this.tujianData.model;if(GameCommon.getInstance().onCheckItemConsume(e.cost.id,this.tujianData.costNum,e.cost.type)){var t=new Message(MESSAGE_ID.TUJIAN_MESSAGE);t.setByte(0),t.setShort(this.tujianData.id),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.msgCallBack=function(e){this.updateTJNPanel(),this.updateNextAttr(),GameCommon.getInstance().addAnimation("tujianshengji",new egret.Point(320,390),this.tips_mask,1)},t.prototype.updateTJNPanel=function(){this.tujianData.level<GameDefine.Tujian_MAX_Lv?(this.tujianData.level>0?this.jihuoBtn.label="升 级":this.jihuoBtn.label="激 活",this.currentState="normal",this.consumItem.visible=!0,this.consumItem.nameColor=15987699,this.consumItem.setCostByAwardItem(this.tujianData.model.cost)):(this.currentState="max",this.jihuoBtn.label="已满级",this.consumItem.visible=!1)},t.prototype.onUpdataInfo=function(){var e=this.tujianData;e&&(this.attr=e.attrAry,e.level>0?(this.jihuo.visible=!1,this.tujian_name.text=e.model.name+e.level+"级",this.tujiam_cover.source="tujian_kuang_di"+e.model.pinzhi+"_png"):(this.jihuo.visible=!0,this.tujian_name.text=e.model.name,this.tujiam_cover.source="tujian_weijihuo_png"),this.powerbar.power=GameCommon.calculationFighting(this.attr).toString(),this.animation.source=e.model.waixing1+"_png")},t.prototype.updateNextAttr=function(){this.onUpdataInfo();var e,t=this.tujianData.model,n=0;this.curPro.removeChildren(),this.nextPro.removeChildren();var a=this.tujianData.attrAry,i=this.tujianData.nextAttrAty;for(var o in a)t.attrAry[o]>0&&(n=a[o],e=new AttributesText,e.updateAttr(o,n),this.curPro.addChild(e),this.tujianData.level<GameDefine.Tujian_MAX_Lv&&(n=i[o],e=new AttributesText,e.updateAttr(o,n),this.nextPro.addChild(e)))},t.prototype.omTouchHQTJ=function(){GameCommon.getInstance().onShowFastBuy(this.tujianData.model.cost.id)},t}(BaseWindowPanel);__reflect(TuJianUpGrade.prototype,"TuJianUpGrade");var TurnplateBase=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onInitData=function(e,t){this.gainId=t;for(var n,a,i=[],o=JsonModelManager.instance.getModelgain()[this.gainId],r=GameCommon.getInstance().onParseGainItemstr(o.item,GOODS_TYPE.ITEM),s=GameCommon.getInstance().onParseGainItemstr(o.item,GOODS_TYPE.ITEM),h=GameCommon.getInstance().concatAwardAry([r,s]).concat(),l=0,g=0;e>g;g++)n=this["goods"+g],a=h[l],n.onUpdate(a.type,a.id,0,a.quality,a.num),i.push(n),l++,l==h.length&&(l=0)},t.prototype.onInit=function(){e.prototype.onInit.call(this)},t.prototype.onGetBtn=function(e){throw"需重写方法: protected onGetBtn(event: TouchEvent): void"},t}(BaseTabView);__reflect(TurnplateBase.prototype,"TurnplateBase");var UnionAppPointPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.Postion_Size=5,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionAppPointSkin},t.prototype.onShowWithParam=function(t){this.optUnionMember=t,this.optUnionMember&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onInit=function(){this.postion_groups=[],this.postion_cbs=[];for(var t=1;t<=this.Postion_Size;t++)this.postion_cbs[t]=this["postion_cb"+t],this.postion_cbs[t].touchEnabled=!1,this.postion_groups[t]=this["postion_group"+t],this.postion_groups[t].name=t+"";this.setTitle("职位任命"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){for(var e=DataManager.getInstance().unionManager.unionInfo.selfData.postion,t=1;t<=this.Postion_Size;t++)t>e||e==UNION_POSTION.WANG?(Tool.setDisplayGray(this.postion_groups[t],!1),this.postion_groups[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCheckBox,this)):Tool.setDisplayGray(this.postion_groups[t],!0),this.postion_cbs[t].selected=!1;this.onChangePostionHandler(this.optUnionMember.postion)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAppPointHandler,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=1;t<=this.Postion_Size;t++)this.postion_groups[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCheckBox,this);this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchAppPointHandler,this)},t.prototype.onTouchCheckBox=function(e){var t=parseInt(e.currentTarget.name);this.onChangePostionHandler(t)},t.prototype.onChangePostionHandler=function(e){for(var t=1;t<=this.Postion_Size;t++)this.postion_cbs[t].selected=!1;this.postion_cbs[e].selected=!0,this._selectedPostion=e},t.prototype.onTouchAppPointHandler=function(){if(this.optUnionMember.postion!=this._selectedPostion){var e,t=UnionDefine.Union_Postions[this._selectedPostion];if(this._selectedPostion==UNION_POSTION.WANG)e=[{text:"您确定要将"+t+"职位转让给"+this.optUnionMember.playerdata.name+"？（转让成后您降职成为盟众，请慎重考虑）",style:{textColor:15086130}}];else{var n=this.optUnionMember.postion>this._selectedPostion?"提升":"降职";e=[{text:"您确定要将"+this.optUnionMember.playerdata.name+n+"至"+t+"职位？",style:{textColor:2680872}}]}GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,this.onAppPoint,this)))}else this.onHide()},t.prototype.onAppPoint=function(){var e=new Message(MESSAGE_ID.UNION_POSTION_MESSAGE);e.setInt(this.optUnionMember.playerdata.id),e.setByte(this._selectedPostion),GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t}(BaseWindowPanel);__reflect(UnionAppPointPanel.prototype,"UnionAppPointPanel");var UnionBossFightPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_GEREN_BOSS,n.points=RedPointManager.createPoint(2),n}return __extends(t,e),t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="UnionBossView",n.btnRes="秘境",n.funcID=FUN_TYPE.FUN_UNION_BOSS_FAM,n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().unionManager,"checkUnionBossDupPoint"),t.push(n);var n=new RegisterSystemParam;n.sysName="MysteriousBossSummonPannel",n.btnRes="召唤",n.funcID=FUN_TYPE.FUN_UNION_BOSS_SUMMON,n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().unionManager,"checkMyBossRedPoint"),t.push(n),this.registerPage(t,"UnionBossFightGrp"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onTouchCloseBtn=function(){e.prototype.onTouchCloseBtn.call(this),this.onTouchBack()},t.prototype.onTouchBack=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel")},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("仙盟秘境");break;case 1:this.setTitle("仙盟召唤")}e.prototype.onRefresh.call(this)},t.prototype.onShowWithParam=function(e){this.index=e,this.onShow()},t}(BaseSystemPanel);__reflect(UnionBossFightPanel.prototype,"UnionBossFightPanel");var UnionBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.guildBossArr=new Array,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionBossViewSkin},t.prototype.onInit=function(){this.selectIndex=0,this.tabs=[];for(var t=0;6>t;++t){var n=this.models[t];this.tabs[t]=this["tab"+t],this.tabs[t].name=t.toString(),this.tabs[t].label=n.name}e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequetBossInfoMsg()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.tabs.length;t++)this.tabs[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BOSS_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BOSS_LIST_MESSAGE.toString(),this.onReciveBossListMsg,this),this.onchangeTab(0)},t.prototype.onRemove=function(){for(var e=0;e<this.tabs.length;e++)this.tabs[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this);Tool.removeTimer(this.refreshTimeDown,this,1e3),this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallenge,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BOSS_INFO_MESSAGE.toString(),this.onReciveBossInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BOSS_LIST_MESSAGE.toString(),this.onReciveBossListMsg,this),this.isRequst=!1},t.prototype.onChallenge=function(){GameFight.getInstance().onEnterUnionBossScene(this.curBossInfo.id)},t.prototype.onTouchTab=function(e){var t=parseInt(e.currentTarget.name);this.selectIndex!=t&&(this.onchangeTab(t),this.runTimerDown())},t.prototype.runTimerDown=function(){},t.prototype.onchangeTab=function(e){this.tabs[this.selectIndex].selected=!1,this.tabs[e].selected=!0,this.selectIndex=e,this.curBossInfo=this.models[e];var t=(DataManager.getInstance().dupManager.allpeoplebossData.xuezhanInfos[e],ModelManager.getInstance().getModelFigher(this.curBossInfo.bossId));this.boss_name_lab.text=this.curBossInfo.name,this.belongers_lab.text="挑战次数:"+DataManager.getInstance().unionManager.unionbossCount,this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,this.curBossInfo.bossId),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim),this.reward_grp.removeChildren();for(var n=0;n<this.curBossInfo.rewards.length;n++){var a=this.curBossInfo.rewards[n],i=GameCommon.getInstance().createGoodsIntance(a);this.reward_grp.addChild(i)}this.boss_hp_probar.maximum=t.hp,this.boss_hp_probar.minimum=t.hp,this.boss_hp_probar.value=100,this.onUpdateStatus(this.models[e].unionBossStatus)},t.prototype.onUpdateStatus=function(e){switch(Tool.removeTimer(this.refreshTimeDown,this),this.reborn_time_lab.text="",e){case UNION_BOSS_STATUS.REBORN:this.challenge_btn.label="挑战",this.challenge_btn.enabled=!0;break;case UNION_BOSS_STATUS.FIGTHING:break;case UNION_BOSS_STATUS.DEATH:this.challenge_btn.label="等待刷新",this.challenge_btn.enabled=!1,this.leftRefreshTime>0&&Tool.addTimer(this.refreshTimeDown,this,1e3);break;case UNION_BOSS_STATUS.CLOSE:this.challenge_btn.label="未开启",this.challenge_btn.enabled=!1}},Object.defineProperty(t.prototype,"models",{get:function(){var e;e=JsonModelManager.instance.getModelguildBoss();var t=0;for(var n in e)this.guildBossArr[t]=e[n],t+=1;return this.guildBossArr},enumerable:!0,configurable:!0}),t.prototype.onRequetBossInfoMsg=function(){if(!this.isRequst){this.isRequst=!0,this.reborn_time_lab.text="正在刷新";var e=new Message(MESSAGE_ID.UNION_BOSS_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onReciveBossInfoMsg=function(){this.isRequst=!1},t.prototype.onReciveBossListMsg=function(){this.selectIndex?this.onchangeTab(this.selectIndex):this.onchangeTab(0)},t.prototype.refreshTimeDown=function(){this.reborn_time_lab.text="复活时间："+GameCommon.getInstance().getTimeStrForSec2(this.leftRefreshTime,!1),this.leftRefreshTime<=0&&(this.onRequetBossInfoMsg(),Tool.removeTimer(this.refreshTimeDown,this,1e3))},Object.defineProperty(t.prototype,"leftRefreshTime",{get:function(){return Math.floor((DataManager.getInstance().unionManager.unionbossTime-egret.getTimer())/1e3)},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(UnionBossView.prototype,"UnionBossView");var UnionBossItem=function(e){function t(t){var n=e.call(this)||this;return n.isInit=!0,n.model=t,n.once(egret.Event.COMPLETE,n.onComplete,n),n.skinName=skins.UnionBossItemSkin,n}return __extends(t,e),t.prototype.onComplete=function(){this.isInit=!1;for(var e=0;e<this.model.rewards.length;e++){var t=this.model.rewards[e],n=new GoodsInstance;n.onUpdate(t.type,t.id,0,t.quality,t.num),this.award_group.addChild(n)}this.dataChanged()},t.prototype.dataChanged=function(){if(!this.isInit){this.monsterIcon_img.source=this.model.icon,this.monster_name_label.text=this.model.name,this.nanduImg.source="unionboss_nandu"+this.model.nandu+"_png";var e="",t=!1;switch(this.model.unionBossStatus){case UNION_BOSS_STATUS.REBORN:e="挑战",t=!0;break;case UNION_BOSS_STATUS.FIGTHING:e="正在被挑战";break;case UNION_BOSS_STATUS.DEATH:e="等待刷新";break;case UNION_BOSS_STATUS.CLOSE:e="未开启"}GameCommon.getInstance().onButtonEnable(this.btn_enter,t),this.btn_enter.label=e}},t.prototype.registTouchBtn=function(){this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChanllenge,this)},t.prototype.removeTouchBtn=function(){this.btn_enter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChanllenge,this)},t.prototype.onChanllenge=function(){GameFight.getInstance().onEnterUnionBossScene(this.model.id)},t}(eui.Component);__reflect(UnionBossItem.prototype,"UnionBossItem");var UnionCopyView=function(e){function t(t){var n=e.call(this,t)||this;return n.Max_Show_Rank=3,n.today_maxWave=0,n.Page_Show_Num=4,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionDupSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineStr(this.loop_rank_label),this.Max_Page_Num=Math.ceil(JsonModelManager.instance.getModelguildBoss().length/UnionDefine.Union_Dup_AwardWave/this.Page_Show_Num),this.currPageNum=1,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestDupInofMsg(),this.onRequestDupRankMsg()},t.prototype.onRequestDupInofMsg=function(){var e=new Message(MESSAGE_ID.GAME_DUP_INFO_MESSAGE);e.setByte(DUP_TYPE.DUP_UNION),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRequestDupRankMsg=function(){var e=new Message(MESSAGE_ID.UNION_DUP_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DUP_RANK_MESSAGE.toString(),this.onResDupRankMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.GAME_DUP_BUYNUM_MESSAGE.toString(),this.onResDupSweepMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DUP_REWARD_MESSAGE.toString(),this.onResGetPassReward,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DUP_ZHUWEI_MESSAGE.toString(),this.onRefreshCheerInfo,this),this.btn_challenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallange,this),this.btn_saodang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodang,this),this.btn_zhuwei.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendCheerMsg,this),this.btn_reward_all.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendGetPassAward,this),this.left_page_btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchPageBtn,this),this.right_page_btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchPageBtn,this),this.loop_rank_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRank,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_INFO_MESSAGE.toString(),this.onResDupInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DUP_RANK_MESSAGE.toString(),this.onResDupRankMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.GAME_DUP_BUYNUM_MESSAGE.toString(),this.onResDupSweepMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DUP_REWARD_MESSAGE.toString(),this.onResGetPassReward,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DUP_ZHUWEI_MESSAGE.toString(),this.onRefreshCheerInfo,this),this.btn_challenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChallange,this),this.btn_saodang.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSaodang,this),this.btn_zhuwei.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendCheerMsg,this),this.btn_reward_all.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendGetPassAward,this),this.left_page_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPageBtn,this),this.right_page_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPageBtn,this),this.loop_rank_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRank,this),this.awardbox_grp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdNotice,this)},t.prototype.onResDupInfoMsg=function(){var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_UNION)[0];this.onUpdateSweep();var t=JsonModelManager.instance.getModelguildBoss().length,n=e.pass-1;this.curr_wavenum_label.text=t>n?n+"关":t+"关",e.pass>t?this.end_label.text="恭喜您通关全部关卡":this.end_label.text="当前第"+e.pass+"关",GameCommon.getInstance().onButtonEnable(this.btn_challenge,e.pass<=t),this.award_wave_item.visible=e.pass<t;JsonModelManager.instance.getModelguildBoss()[e.pass-1]},t.prototype.onResDupRankMsg=function(e){var t=e.message;this.rankData||(this.rankData=new TopRankSimpleParam,this.rankData.currType=TopRankManager.RANK_SIMPLE_TYPE_UNIONDUP),this.rankData.dataList=[];for(var n=t.getByte(),a=0;n>a;a++){var i=new TopRankSimple;i.rank=a+1,i.name=t.getString(),i.vip=t.getInt(),i.vip=GameCommon.getInstance().getVipLevel(i.vip),i.value=t.getShort(),this.rankData.dataList.push(i)}this.rank_null_label.visible=0==n;for(var a=0;a<this.Max_Show_Rank;a++)this.rankData.dataList.length>a?(this["rank_group"+a].visible=!0,this["label_rank_vip"+a].text=this.rankData.dataList[a].vip+"",this["label_rank_name"+a].text=this.rankData.dataList[a].name,this["label_rank_value"+a].text=this.rankData.dataList[a].value+"关"):this["rank_group"+a].visible=!1;var o=t.getShort();this.not_passdup_desc.visible=0==o,this.passdup_desc_grp.visible=o>0,o>0&&(this.pass_num_label.text=o+"",this.attr_rate_label.text="-"+DupDefine.UnionDup_Derate_Rate+"%");var r=t.getBoolean();this.not_yes_best_desc.visible=!r,this.yes_best_grp.visible=r,r&&(this.yesBestData||(this.yesBestData=new UnionDupYesFirstData),this.yesBestData.onParse(t),this.best_player_name.text=this.yesBestData.name,this.best_wavenum_label.text=this.yesBestData.passNum+"关",this.zhuwei_attr_label.text="攻血+"+DataManager.getInstance().unionManager.getCheerAttrAddRate(this.yesBestData.cheerNum)+"%");var s=t.getBoolean();this.btn_zhuwei.label=s?"已助威":"助威",GameCommon.getInstance().onButtonEnable(this.btn_zhuwei,!s);var h=t.getBoolean();DataManager.getInstance().unionManager.hasDupPassAward=!h&&this.today_maxWave>=UnionDefine.Union_Dup_AwardWave,this.btn_reward_all.label=h?"已领取":"一键领取",h?this.awardbox_grp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdNotice,this):this.awardbox_grp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdNotice,this),this.today_maxWave=t.getShort(),GameCommon.getInstance().onButtonEnable(this.btn_reward_all,!h&&this.today_maxWave>=UnionDefine.Union_Dup_AwardWave),this.onUpdatePassAward()},t.prototype.onResGetPassReward=function(e){var t=e.message,n=new AwardNoticeParam;n.desc="获得奖励如下：",n.itemAwards=[];for(var a=t.getByte(),i=0;a>i;i++){var o=new AwardItem(GOODS_TYPE.SERVANT_EQUIP,t.getShort());n.itemAwards.push(o)}n.itemAwards.push(new AwardItem(GOODS_TYPE.GOLD,0,t.getInt())),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",n)),this.btn_reward_all.label="已领取",GameCommon.getInstance().onButtonEnable(this.btn_reward_all,!1),this.onUpdatePassAward()},t.prototype.onTouchPageBtn=function(e){var t=e.currentTarget.name;"btn_right"==t?this.currPageNum=this._currPageNum+1:"btn_left"==t&&(this.currPageNum=this._currPageNum-1),this.onUpdatePassAward()},t.prototype.onUpdatePassAward=function(){for(var e=!this.btn_reward_all.enabled,t=0;t<this.Page_Show_Num;t++){var n=((this._currPageNum-1)*this.Page_Show_Num+t+1)*UnionDefine.Union_Dup_AwardWave;n<=JsonModelManager.instance.getModelguildBoss().length?(this["grp_pass_award"+t].visible=!0,this["award_wavenum_label"+t].text="第"+n+"关奖励",n>this.today_maxWave?(this["award_boxImg"+t].source="newactivity_box1_png",this["awarded_grp"+t].visible=!1,this.awardbox_grp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdNotice,this)):e?(this["award_boxImg"+t].source="newactivity_box3_png",this["awarded_grp"+t].visible=!0):(this["award_boxImg"+t].source="newactivity_box2_png",this["awarded_grp"+t].visible=!1)):this["grp_pass_award"+t].visible=!1}},Object.defineProperty(t.prototype,"currPageNum",{set:function(e){this._currPageNum=0>=e?1:e>this.Max_Page_Num?this.Max_Page_Num:e,GameCommon.getInstance().onButtonEnable(this.left_page_btn,this._currPageNum>1),this.left_page_btn.visible=this.left_page_btn.enabled,GameCommon.getInstance().onButtonEnable(this.right_page_btn,this._currPageNum<this.Max_Page_Num),this.right_page_btn.visible=this.right_page_btn.enabled},enumerable:!0,configurable:!0}),t.prototype.onRefreshCheerInfo=function(e){GameCommon.getInstance().addAlert("助威成功");var t=e.message;this.yesBestData&&(this.yesBestData.cheerNum=t.getShort(),this.zhuwei_attr_label.text="攻血+"+DataManager.getInstance().unionManager.getCheerAttrAddRate(this.yesBestData.cheerNum)+"%",this.btn_zhuwei.label="已助威",GameCommon.getInstance().onButtonEnable(this.btn_zhuwei,!1))},t.prototype.onChallange=function(){var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_UNION)[0];GameFight.getInstance().onSendEnterDupMsg(e.id)},t.prototype.onResDupSweepMsg=function(e){this.onUpdateSweep();var t=e.message,n=new AwardNoticeParam;n.desc="扫荡成功获得以下奖励",n.itemAwards=[];for(var a=t.getByte(),i=0;a>i;i++){var o=new AwardItem(GOODS_TYPE.SERVANT_EQUIP,t.getShort());n.itemAwards.push(o)}n.itemAwards.push(new AwardItem(GOODS_TYPE.GOLD,0,t.getInt())),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AwardNoticePanel",n)),this.onRequestDupRankMsg()},t.prototype.onUpdateSweep=function(){var e=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_UNION)[0];this.saodang_num_label.text=e.leftSweepNum+"/"+e.totalSweepNum,GameCommon.getInstance().onButtonEnable(this.btn_saodang,e.leftSweepNum>0&&e.pass>1),this.btn_saodang.label=e.leftSweepNum>0?"扫荡":"已扫荡"},t.prototype.onSaodang=function(e){var t=DataManager.getInstance().dupManager.getDupInfolistByType(DUP_TYPE.DUP_UNION)[0],n=[{text:"是否确认扫荡至第"+(t.pass-1)+"关？（每天仅有一次扫荡机会）",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,function(){var e=new Message(MESSAGE_ID.GAME_DUP_BUYNUM_MESSAGE);e.setByte(t.id),GameCommon.getInstance().sendMsgToServer(e)},this)))},t.prototype.onOpenRank=function(){TopRankSimplePanel.NAME2_VISIBLE=!1,TopRankSimplePanel.ADD_STR="关",GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TopRankSimplePanel",this.rankData))},t.prototype.onOpenAwdNotice=function(){var e=[{text:"可随机获得坐骑装备、银币",style:{}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,null,this)))},t.prototype.onSendCheerMsg=function(){var e=new Message(MESSAGE_ID.UNION_DUP_ZHUWEI_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onSendGetPassAward=function(){var e=new Message(MESSAGE_ID.UNION_DUP_REWARD_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(UnionCopyView.prototype,"UnionCopyView");var UnionDupYesFirstData=function(){function e(){}return e.prototype.onParse=function(e){this.playerid=e.getInt(),this.name=e.getString(),this.headIndex=e.getByte(),this.headFrame=e.getByte(),this.passNum=e.getShort(),this.cheerNum=e.getShort()},Object.defineProperty(e.prototype,"cheerNum",{get:function(){return this._cheerNum},set:function(e){this._cheerNum=e},enumerable:!0,configurable:!0}),e}();__reflect(UnionDupYesFirstData.prototype,"UnionDupYesFirstData");var UnionCreatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.badgeIndex=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionCreatePanelSkin},t.prototype.onInit=function(){this.Union_Create_Consume=parseInt(Constant.get(Constant.CREATE_GANG_DIAMOND)),this.consume_label.text=this.Union_Create_Consume+"";for(var t=1;4>=t;t++)this["badges_icon_ck"+t].name=t+"";for(var t=1;t<=UnionDefine.Union_Badges_ColorNum;t++)this["badges_color_ck"+t].name=t+"";this.setTitle("创建仙盟"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.union_name_label.text="",this.union_name_input.text="",this.curSelectedIcon_ck&&(this.curSelectedIcon_ck.selected=!1),this.curSelectedIcon_ck=this.badges_icon_ck1,this.curSelectedIcon_ck.selected=!0,this.curSelectedColor_ck&&(this.curSelectedColor_ck.selected=!1),this.curSelectedColor_ck=this.badges_color_ck1,this.curSelectedColor_ck.selected=!0,this.onUpdateBadgesStyle()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.create_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreate,this),this.union_name_input.addEventListener(egret.TextEvent.CHANGE,this.onInputUnionName,this);for(var t=1;t<=UnionDefine.Union_Badges_IconNum;t++)this["badges_icon_Layer"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeletedBadgesIcon,this);for(var t=1;t<=UnionDefine.Union_Badges_ColorNum;t++)this["badges_color_Layer"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeletedBadgesColor,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.create_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreate,this),this.union_name_input.removeEventListener(egret.TextEvent.CHANGE,this.onInputUnionName,this);for(var t=1;t<=UnionDefine.Union_Badges_IconNum;t++)this["badges_icon_Layer"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeletedBadgesIcon,this);for(var t=1;t<=UnionDefine.Union_Badges_ColorNum;t++)this["badges_color_Layer"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSeletedBadgesColor,this)},t.prototype.onSeletedBadgesIcon=function(e){var t=this[e.currentTarget.name];this.curSelectedIcon_ck&&(this.curSelectedIcon_ck.selected=!1),this.curSelectedIcon_ck=t,this.curSelectedIcon_ck.selected=!0,this.onUpdateBadgesStyle()},t.prototype.onSeletedBadgesColor=function(e){var t=this[e.currentTarget.name];this.curSelectedColor_ck&&(this.curSelectedColor_ck.selected=!1),this.curSelectedColor_ck=t,this.curSelectedColor_ck.selected=!0,this.onUpdateBadgesStyle()},t.prototype.onUpdateBadgesStyle=function(){var e=parseInt(this.curSelectedColor_ck.name);this.uinon_badges.badges_bg.source="union_badges_bg"+e+"_png";var t=parseInt(this.curSelectedIcon_ck.name);this.uinon_badges.badges_icon.source="union_badges_icon"+t+"_png",this.badgeIndex=(e-1)*UnionDefine.Union_Badges_ColorNum+t-1},t.prototype.onInputUnionName=function(e){this.union_name_label.text=e.currentTarget.text},t.prototype.onCreate=function(){if(""==this.union_name_label.text)return void GameCommon.getInstance().addAlert("帮会名称不能为空");if(DataManager.getInstance().playerManager.player.money<this.Union_Create_Consume&&DataManager.getInstance().playerManager.player.gold<this.Union_Create_Consume)return void GameCommon.getInstance().addAlert("error_tips_2");var e=new Message(MESSAGE_ID.UNION_CREATE_MESSAGE);e.setString(this.union_name_label.text),e.setByte(this.badgeIndex),GameCommon.getInstance().sendMsgToServer(e),this.onHide()},t}(BaseWindowPanel);__reflect(UnionCreatePanel.prototype,"UnionCreatePanel");var UnionHallPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.I,n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionHallSkin},t.prototype.onInit=function(){this.setTitle("仙盟大厅"),GameCommon.getInstance().addUnderlineStr(this.xuanyan_change_lab),GameCommon.getInstance().addUnderlineStr(this.notice_change_lab),this.points[0].register(this.tribute_btn,new egret.Point(75,60),DataManager.getInstance().unionManager,"checkTributeRedPoint"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.log_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this),this.manager_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openMemberListView,this),this.tribute_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openTributePanel,this),this.chat_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionChatPanel,this),this.notice_change_lab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeGonggao,this),this.xuanyan_change_lab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeXuanyan,this),this.zhuanpan_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openZhuanpanView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onUpdateUnionLevel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE.toString(),this.onUpdateXuanyan,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE.toString(),this.onUpdateGongao,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_QUIT_MESSAGE.toString(),this.onResUnionInfoMsg,this),this.onReqMemberListMsg()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.log_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this),this.manager_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openMemberListView,this),this.tribute_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openTributePanel,this),this.chat_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionChatPanel,this),this.notice_change_lab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeGonggao,this),this.xuanyan_change_lab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeXuanyan,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onUpdateUnionLevel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE.toString(),this.onUpdateXuanyan,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE.toString(),this.onUpdateGongao,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_QUIT_MESSAGE.toString(),this.onResUnionInfoMsg,this)},t.prototype.onupdateUnionInfo=function(){var e=DataManager.getInstance().unionManager.unionInfo;this.union_name_label.text=e.info.name,this.member_num_label.text=e.info.memberCount+"/"+e.getUnionLevelModel().renshuMax,this.wang_name_label.text=e.info.wangName;var t=Tool.toInt(e.info.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.union_badges.badges_bg.source="union_badges_bg"+t+"_png";var n=e.info.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.union_badges.badges_icon.source="union_badges_icon"+n+"_png",this.onUpdateUnionLevel(),this.onUpdateXuanyan(),this.onUpdateGongao(),this.notice_change_lab.visible=this.getAuthority(),this.xuanyan_change_lab.visible=this.getAuthority()},t.prototype.onUpdateUnionLevel=function(){var e=DataManager.getInstance().unionManager.unionInfo;0==e.getUnionLevelModel().exp?(this.union_exp_pro.maximum=1,this.union_exp_pro.value=1,this.union_exp_pro.labelFunction=function(e,t){return"Max"}):(this.union_exp_pro.maximum=e.getUnionLevelModel().exp,this.union_exp_pro.value=e.unionExp),this.union_level_label.text="仙盟等级： "+e.info.level+"级",this.member_num_label.text=e.info.memberCount+"/"+e.getUnionLevelModel().renshuMax},t.prototype.onReqMemberListMsg=function(){DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.onResMemberListMsg=function(){this.onupdateUnionInfo()
},t.prototype.openMemberListView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMemberListPanel")},t.prototype.openLogView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionRankView",UNIONBATTLE_RANKTYPE.UNION_BALLTE))},t.prototype.openZhuanpanView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTurnplatePanel")},t.prototype.onChangeXuanyan=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionInputPanel",UnionInputPanel.Type_Xuanyan))},t.prototype.onUpdateXuanyan=function(){this.xuanyan_label.text=DataManager.getInstance().unionManager.unionInfo.info.xuanyan},t.prototype.onChangeGonggao=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionInputPanel",UnionInputPanel.Type_Gonggao))},t.prototype.onUpdateGongao=function(){this.union_notice_label.text=DataManager.getInstance().unionManager.unionInfo.noticeStr},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG||e.postion==UNION_POSTION.ZHANGLAO:!1},t.prototype.openUnionChatPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",new ChatPanelParam(CHANNEL.GUILD,null)))},t.prototype.openTributePanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTributePanel")},t.prototype.onTouchBack=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel")},t.prototype.onResUnionInfoMsg=function(){DataManager.getInstance().unionManager.unionInfo||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionListPanel"),e.prototype.onRefresh.call(this)},t.prototype.unOpenAltet=function(){GameCommon.getInstance().addAlert("功能暂未开启，敬请期待!")},t.prototype.getStyle=function(){return""},t.prototype.onTouchCloseBtn=function(){e.prototype.onTouchCloseBtn.call(this),this.onTouchBack()},t}(BaseWindowPanel);__reflect(UnionHallPanel.prototype,"UnionHallPanel");var UnionInputPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.inputType=1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionInputSkin},t.prototype.onShowWithParam=function(e){this.inputType=e,this.inputType&&this.onShow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeNotice,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeNotice,this)},t.prototype.onInit=function(){this.input_notice.textDisplay.verticalAlign=egret.VerticalAlign.TOP,this.input_notice.textDisplay.multiline=!0,this.input_notice.textDisplay.lineSpacing=8,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var n=DataManager.getInstance().unionManager.unionInfo;this.inputType==t.Type_Xuanyan?(this.setTitle("union_xuanyan_title_png"),this.input_desc.text="请输入仙盟宣言（10个字以内）",this.input_notice.text=n.info.xuanyan,this.input_notice.maxChars=10):this.inputType==t.Type_Gonggao&&(this.setTitle("union_gonggao_title_png"),this.input_desc.text="请输入仙盟公告（30个字以内）",this.input_notice.text=n.noticeStr,this.input_notice.maxChars=30),e.prototype.onRefresh.call(this)},t.prototype.onChangeNotice=function(){var e=this.input_notice.text;if(""==e)return void GameCommon.getInstance().addAlert("内容不能为空");if(this.inputType==t.Type_Xuanyan){if(e!=DataManager.getInstance().unionManager.unionInfo.info.xuanyan){var n=new Message(MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE);n.setString(e),GameCommon.getInstance().sendMsgToServer(n)}}else if(this.inputType==t.Type_Gonggao&&e!=DataManager.getInstance().unionManager.unionInfo.noticeStr){var a=new Message(MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE);a.setString(e),GameCommon.getInstance().sendMsgToServer(a)}this.onHide()},t.Type_Xuanyan=1,t.Type_Gonggao=2,t}(BaseWindowPanel);__reflect(UnionInputPanel.prototype,"UnionInputPanel");var UnionHallView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionHallSkin},t.prototype.onRegist=function(){this.log_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this),this.manager_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openMemberListView,this),this.rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openRankView,this),this.skill_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionSkill,this),this.tribute_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openTributePanel,this),this.chat_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionChatPanel,this),this.notice_change_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeGonggao,this),this.xuanyan_change_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeXuanyan,this),this.task_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openTaskView,this),this.zhuanpan_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openZhuanpanView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onUpdateUnionLevel,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE.toString(),this.onUpdateXuanyan,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE.toString(),this.onUpdateGongao,this),this.onReqMemberListMsg(),this.isRegistPoint||(this.isRegistPoint=!0,this.points[0].register(this.skill_btn,GameDefine.RED_MAIN_II_POS,DataManager.getInstance().unionManager,"checkUnionSkillRedPoint"))},t.prototype.onRemove=function(){this.log_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this),this.manager_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openMemberListView,this),this.rank_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openRankView,this),this.skill_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionSkill,this),this.tribute_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openTributePanel,this),this.chat_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openUnionChatPanel,this),this.notice_change_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeGonggao,this),this.xuanyan_change_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeXuanyan,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onUpdateUnionLevel,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_CHANGE_XUYAN_MESSAGE.toString(),this.onUpdateXuanyan,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_CHANGE_NOTICE_MESSAGE.toString(),this.onUpdateGongao,this)},t.prototype.onupdateUnionInfo=function(){var e=DataManager.getInstance().unionManager.unionInfo;this.union_name_label.text=e.info.name;var t=Tool.toInt(e.info.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.union_badges.badges_bg.source="union_badges_bg"+t+"_png";var n=e.info.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.union_badges.badges_icon.source="union_badges_icon"+n+"_png",this.wang_name_label.text=e.info.wangName,this.onUpdateUnionLevel(),this.onUpdateXuanyan(),this.onUpdateGongao(),this.notice_change_btn.visible=this.getAuthority(),this.xuanyan_change_btn.visible=this.getAuthority()},t.prototype.onUpdateUnionLevel=function(){var e=DataManager.getInstance().unionManager.unionInfo;0==e.getUnionLevelModel().exp?(this.union_exp_pro.maximum=1,this.union_exp_pro.value=1,this.union_exp_pro.labelFunction=function(e,t){return"Max"}):(this.union_exp_pro.maximum=e.getUnionLevelModel().exp,this.union_exp_pro.value=e.unionExp),this.union_level_label.text=""+e.info.level,this.member_num_label.text=e.info.memberCount+"/"+e.getUnionLevelModel().renshuMax},t.prototype.onReqMemberListMsg=function(){DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.onResMemberListMsg=function(){this.onupdateUnionInfo()},t.prototype.openMemberListView=function(){this.owner.onShowAlertByName("UnionMemberListView")},t.prototype.openRankView=function(){this.owner.onShowAlertByName("UnionRankView")},t.prototype.openLogView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionRankView",UNIONBATTLE_RANKTYPE.UNION_BALLTE))},t.prototype.openTaskView=function(){this.owner.onShowAlertByName("UnionTaskView")},t.prototype.openZhuanpanView=function(){this.owner.onShowAlertByName("UnionTurnplatePanel")},t.prototype.onChangeXuanyan=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionInputPanel",UnionInputPanel.Type_Xuanyan))},t.prototype.onUpdateXuanyan=function(){this.xuanyan_label.text=DataManager.getInstance().unionManager.unionInfo.info.xuanyan},t.prototype.onChangeGonggao=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionInputPanel",UnionInputPanel.Type_Gonggao))},t.prototype.onUpdateGongao=function(){this.union_notice_label.text=DataManager.getInstance().unionManager.unionInfo.noticeStr},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG||e.postion==UNION_POSTION.ZHANGLAO:!1},t.prototype.openUnionChatPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",new ChatPanelParam(CHANNEL.GUILD,null)))},t.prototype.openTributePanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTributePanel")},t.prototype.openUnionSkill=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionSkillPanel")},t.prototype.unOpenAltet=function(){GameCommon.getInstance().addAlert("功能暂未开启，敬请期待!")},t.prototype.getStyle=function(){return""},t}(BaseTabView);__reflect(UnionHallView.prototype,"UnionHallView",["IUnionView"]);var UnionLimitLevelPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionLimitSkin},t.prototype.onInit=function(){this.setTitle("权限设置"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.limit_input.text=DataManager.getInstance().unionManager.unionInfo.info.applyLevel+""},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this)},t.prototype.onHide=function(){e.prototype.onHide.call(this);var t=parseInt(this.limit_input.text);if(Tool.isNumber(t)&&t!=DataManager.getInstance().unionManager.unionInfo.info.applyLevel){var n=new Message(MESSAGE_ID.UNION_CHANGE_LVLIMIT_MESSAGE);n.setShort(t),GameCommon.getInstance().sendMsgToServer(n)}},t}(BaseWindowPanel);__reflect(UnionLimitLevelPanel.prototype,"UnionLimitLevelPanel");var UnionListPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionListPanelSkin},t.prototype.onInit=function(){this.list_scroll.verticalScrollBar.autoVisibility=!0,this.union_list.percentWidth=600,this.union_list.percentHeight=168,this.union_list.itemRenderer=UnionListItem,this.union_list.itemRendererSkinName=skins.UnionListItemSkin,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,this.setTitle("仙盟"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){DataManager.getInstance().unionManager.onReqUnionInfoMsg()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.left_page_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPageDown,this),this.right_page_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPageUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this),this.create_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openCreateUnion,this),Tool.addTimer(this.updateJoinCDTime,this,1e3),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.onResUnionInfoMsg,this),this.onReqUnionListMsg(1)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.left_page_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPageDown,this),this.right_page_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPageUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this),this.create_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openCreateUnion,this),Tool.removeTimer(this.updateJoinCDTime,this,1e3),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.onResUnionInfoMsg,this)},t.prototype.onReqUnionListMsg=function(e){var t=new Message(MESSAGE_ID.UNION_LIST_MESSAGE);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.onPageDown=function(){var e=DataManager.getInstance().unionManager.applyPageNum-1;e>0&&this.onReqUnionListMsg(e)},t.prototype.onPageUp=function(){var e=DataManager.getInstance().unionManager.applyPageNum+1;e<=DataManager.getInstance().unionManager.applyPageTotal&&this.onReqUnionListMsg(e)},t.prototype.onResUnionListMsg=function(){this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.applyUnionList),this.list_null_label.visible=0==DataManager.getInstance().unionManager.applyUnionList.length,this.page_num_label.text=DataManager.getInstance().unionManager.applyPageNum+"/"+DataManager.getInstance().unionManager.applyPageTotal},t.prototype.openCreateUnion=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionCreatePanel")},t.prototype.updateJoinCDTime=function(){var e=Math.ceil((DataManager.getInstance().unionManager.joinCDTime-egret.getTimer())/1e3);if(e>0){var t=Tool.getTimeStr(e);this.apply_time_label.textColor=15086130,this.apply_time_label.text="申请倒计时："+t}else this.apply_time_label.textColor=2680872,this.apply_time_label.text="当前可申请加入仙盟",Tool.removeTimer(this.updateJoinCDTime,this,1e3)},t.prototype.onResUnionInfoMsg=function(){DataManager.getInstance().unionManager.unionInfo&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel"),e.prototype.onRefresh.call(this)},t}(BaseWindowPanel);__reflect(UnionListPanel.prototype,"UnionListPanel");var UnionListItem=function(e){function t(){var t=e.call(this)||this;return t.applyTime=0,t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.apply_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchApplyBtn,this)},t.prototype.dataChanged=function(){var e=this.data,t=Tool.toInt(e.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.union_badges.badges_bg.source="union_badges_bg"+t+"_png";var n=e.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.union_badges.badges_icon.source="union_badges_icon"+n+"_png",this.union_name_label.text=e.name,this.union_level_label.text=e.level+"级";var a=JsonModelManager.instance.getModelguildLv()[e.level-1];this.member_num_label.text="人数："+e.memberCount+"/"+(a?a.renshuMax:0),this.xuanyan_label.text=e.xuanyan,this.apply_num_label.text=e.applyLevel>0?"申请条件："+Language.instance.getText("coatard_level"+e.applyLevel,"jingjie"):""},t.prototype.onTouchApplyBtn=function(){if(!(this.applyTime-egret.getTimer()>0)){this.applyTime=egret.getTimer()+2e3;var e=new Message(MESSAGE_ID.UNION_APPLY_JOIN_MESSAGE);e.setInt(this.data.id),GameCommon.getInstance().sendMsgToServer(e)}},t}(eui.ItemRenderer);__reflect(UnionListItem.prototype,"UnionListItem");var UnionLogPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionLogPanelSkin},t.prototype.onInit=function(){this.list_scroll.verticalScrollBar.autoVisibility=!0,this.union_list.percentWidth=525,this.union_list.percentHeight=90,this.union_list.itemRenderer=UnionLogItem,this.union_list.itemRendererSkinName=skins.UnionLogItemSkin,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,this.setTitle("union_log_title_png"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this),this.onReqUnionLogMsg()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this)},t.prototype.onReqUnionLogMsg=function(){var e=new Message(MESSAGE_ID.UNION_LOG_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionLogMsg=function(){this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.unionLogs)},t}(BaseWindowPanel);__reflect(UnionLogPanel.prototype,"UnionLogPanel");var UnionLogView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionLogPanelSkin},t.prototype.onInit=function(){this.list_scroll.verticalScrollBar.autoVisibility=!0,this.union_list.percentWidth=638,this.union_list.percentHeight=92,this.union_list.itemRenderer=UnionLogItem,this.union_list.itemRendererSkinName=skins.UnionLogItemSkin,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this),this.onReqUnionLogMsg()},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this)},t.prototype.onReqUnionLogMsg=function(){var e=new Message(MESSAGE_ID.UNION_LOG_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionLogMsg=function(){this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.unionLogs)},t.prototype.getStyle=function(){return"bg_style1"},t}(BaseTabView);__reflect(UnionLogView.prototype,"UnionLogView");var UnionMainCityPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionMainCityPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("仙盟"),this.btnIcons=[];for(var t=0;8>t;++t)this.btnIcons[t]=this["btnIcon"+t],this.btnIcons[t].name=t.toString(),7>t&&this.createRedPoint().register(this.btnIcons[t],new egret.Point(90,10),this,"checkRedPoint",this.btnIcons[t]);this.onRefresh()},t.prototype.checkRedPoint=function(e){var t=parseInt(e.name);switch(t){case 0:return DataManager.getInstance().unionManager.checkUnionSkillRedPoint();case 1:return!1;case 2:return DataManager.getInstance().unionManager.checkTributeRedPoint();case 3:return!1;case 4:return DataManager.getInstance().unionManager.checkUnionBossPoint();case 5:return!1;case 6:return!1}return!1},t.prototype.onRefresh=function(){this.trigger(),DataManager.getInstance().unionManager.onReqUnionInfoMsg(),DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.btnIcons.length;++t)this.btnIcons[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this);GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE.toString(),this.onResUnionBattleGroup,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.updateInfo,this),this.onReqUnionBattleGroup()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.btnIcons.length;++t)this.btnIcons[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this);GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.updateInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.updateMember,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE.toString(),this.onResUnionBattleGroup,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.updateInfo,this)},t.prototype.onTouchBtn=function(e){switch(parseInt(e.currentTarget.name)){case 0:this.onOpenSkill();break;case 1:this.onOpenGangFight();break;case 2:this.openTributePanel();break;case 3:this.openZhuanpanView();break;case 4:this.onOpenDungeon();break;case 5:this.openUnionChatPanel();break;case 6:this.onOpenRank();break;case 7:this.openMemberListView()}},t.prototype.updateInfo=function(){var e=DataManager.getInstance().unionManager.unionInfo;if(e){this.lbName.text="仙盟："+e.info.name,this.lbMaster.text="盟主："+e.info.wangName,this.lbNumber.text="盟众："+e.info.memberCount+"/"+e.getUnionLevelModel().renshuMax,this.lbLevel.text="仙盟等级： "+e.info.level+"级";var t=Tool.toInt(e.info.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.union_badges.badges_bg.source="union_badges_bg"+t+"_png";var n=e.info.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.union_badges.badges_icon.source="union_badges_icon"+n+"_png",0==e.getUnionLevelModel().exp?(this.union_exp_pro.maximum=1,this.union_exp_pro.value=1,this.union_exp_pro.labelFunction=function(e,t){return"Max"}):(this.union_exp_pro.maximum=e.getUnionLevelModel().exp,this.union_exp_pro.value=e.unionExp)}},t.prototype.updateMember=function(){DataManager.getInstance().unionManager.unionInfo;this.union_list.itemRenderer=UnionMainCityMemberItem,this.union_list.itemRendererSkinName=skins.UnionMainCityMemberItemSkin;var e=DataManager.getInstance().unionManager.unionInfo.unionMemberList;e.sort(function(e,t){return e.postion-t.postion}),this.union_list.dataProvider=new eui.ArrayCollection(e)},t.prototype.onOpenHall=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionHallPanel")},t.prototype.openUnionChatPanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ChatMainPanel",new ChatPanelParam(CHANNEL.CURRENT,null)))},t.prototype.openTributePanel=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTributePanel")},t.prototype.openMemberListView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMemberListPanel")},t.prototype.openZhuanpanView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTurnplatePanel")},t.prototype.onOpenDungeon=function(){FunDefine.onIsLockandErrorHint(FUN_TYPE.FUN_UNION_BOSS_FAM)||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionBossFightPanel")},t.prototype.onOpenShilian=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionBossFightPanel")},t.prototype.onOpenGangFight=function(){GameCommon.getInstance().addAlert("敬请期待")},t.prototype.onOpenRank=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionRankView")},t.prototype.onOpenTask=function(){this.unOpenAltet()},t.prototype.onOpenSkill=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionSkillPanel")},t.prototype.unOpenAltet=function(){GameCommon.getInstance().addAlert("功能暂未开启，敬请期待!")},t.prototype.onShow=function(){return DataManager.getInstance().unionManager.unionInfo?void e.prototype.onShow.call(this):void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionListPanel")},t.prototype.onReqUnionBattleGroup=function(){this.timedown_label.text="",this.examineCD(!1);var e=new Message(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE);e.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionBattleGroup=function(){this.battleInfo.state==UNIONBATTLE_STATE.NOT?this.time_desc_label.text=Language.instance.getText("unionbattle_NOT_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.READY?this.time_desc_label.text=Language.instance.getText("unionbattle_READY_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.FIGHT?this.time_desc_label.text=Language.instance.getText("unionbattle_FIGHT_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.RESULT&&(this.time_desc_label.text=Language.instance.getText("unionbattle_RESULT_timedesc")),this.battleInfo.state==UNIONBATTLE_STATE.FIGHT?(this.examineCD(!1),this.timedown_label.text=""):this.examineCD(!0)},t.prototype.examineCD=function(e){this._timeOpen!=e&&(this._timeOpen=e,e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3))},t.prototype.onCountDown=function(){var e=Math.ceil((this.battleInfo.timecount-egret.getTimer())/1e3);e>0||(e=0,this.examineCD(!1),this.onReqUnionBattleGroup()),this.timedown_label.text=GameCommon.getInstance().getTimeStrForSec1(e)},Object.defineProperty(t.prototype,"battleInfo",{get:function(){return DataManager.getInstance().unionManager.unionbattleInfo},enumerable:!0,configurable:!0}),t}(BaseWindowPanel);__reflect(UnionMainCityPanel.prototype,"UnionMainCityPanel");var UnionMainCityMemberItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouch=function(){var e=this.data;e.playerdata.id!=DataManager.getInstance().playerManager.player.id&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionMemberInfoView",e))},t.prototype.dataChanged=function(){var e=this.data;DataManager.getInstance().unionManager.unionInfo.selfData;e.playerdata.id==DataManager.getInstance().playerManager.player.id&&this.setSelf(),this.union_name_label.text=e.playerdata.name,this.union_postion_label.text=UnionDefine.Union_Postions[e.postion],this.donate_label.text=e.donate.toString();var t=DataManager.getInstance().friendManager.getOnlineTime(e.offLineTime).split("|");"online"==t[1]?this.online_time_label.text="在线":this.online_time_label.text=t[0]+DataManager.getInstance().friendManager.getOnlineStr(t[1])},t.prototype.setSelf=function(){this.union_name_label.textColor=this.union_postion_label.textColor=this.online_time_label.textColor=this.donate_label.textColor=1103605},t}(eui.ItemRenderer);__reflect(UnionMainCityMemberItem.prototype,"UnionMainCityMemberItem");var UnionMemberInfoView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionMemberInfoSkin},t.prototype.onShowWithParam=function(e){this.data=e,this.onShow()},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("仙盟成员")},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.appoint_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAppoint,this),this.delete_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDelete,this),this.impeachmentBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onImpeachment,this),this.updateInfo()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.appoint_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAppoint,this),this.delete_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDelete,this),this.impeachmentBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onImpeachment,this)},t.prototype.updateInfo=function(){var e=this.data;this.playerHead.setHead(e.playerdata.headindex,e.playerdata.headFrame),this.union_name_label.text=e.playerdata.name,this.union_level_label.text="等级："+e.playerdata.level,this.union_postion_label.text="职位："+UnionDefine.Union_Postions[e.postion],this.power_label.text="战力："+e.playerdata.fightvalue,this.donate_label.text="贡献："+e.donate;var t=DataManager.getInstance().friendManager.getOnlineTime(e.offLineTime).split("|");if("online"==t[1]?this.online_label.text="贡献：在线":this.online_label.text="贡献："+t[0]+DataManager.getInstance().friendManager.getOnlineStr(t[1]),e.playerdata.viplevel>0?this.vip_group.visible=!0:this.vip_group.visible=!1,this.impeachmentBtn.visible=this.opt_group.visible=!1,e.playerdata.id!=DataManager.getInstance().playerManager.player.id){var n=DataManager.getInstance().unionManager.unionInfo.selfData;e.postion>DataManager.getInstance().unionManager.unionInfo.selfData.postion&&(n.postion==UNION_POSTION.WANG||n.postion==UNION_POSTION.FUBANG||n.postion==UNION_POSTION.ZHANGLAO)&&(this.opt_group.visible=!0),e.postion==UNION_POSTION.WANG&&1==DataManager.getInstance().unionManager.unionInfo.isImpeachment&&(this.impeachmentBtn.visible=!0)}},t.prototype.onAppoint=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionAppPointPanel",this.data)),this.onHide()},t.prototype.onDelete=function(){var e=this,t=[{text:"是否将"+this.data.playerdata.name+"请离仙盟？（请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,function(t){var n=new Message(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE);n.setInt(t),GameCommon.getInstance().sendMsgToServer(n),e.onHide()},this,this.data.playerdata.id)))},t.prototype.onImpeachment=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam("此位不负责盟主已经连续7天未上线了，上仙是否准备消耗500钻石将其弹劾取代其盟主之位？",this.sendImpeachment,this)))},t.prototype.sendImpeachment=function(){var e=new Message(MESSAGE_ID.UNION_IMPEACHMENT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(BaseWindowPanel);__reflect(UnionMemberInfoView.prototype,"UnionMemberInfoView");
var UnionMemberListPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.currTabIndex=-1,n.reqMemberListTime=0,n.reqApplyListTime=0,n.applyplayerList=[],n.changeAutoDoptTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionMemberPanelSkin},t.prototype.onInit=function(){this.tabbtn_groups=[],this.tab_btns=[];for(var t=["","审核","日志"],n=0;3>n;++n)this.tab_btns[n]=this["tab_btn"+n],this.tab_btns[n].tab_name.text=t[n],this.tabbtn_groups[n]=this["tabbtn_group"+n],this.tabbtn_groups[n].name=n.toString();this.list_scroll.verticalScrollBar.autoVisibility=!1,this.list_scroll.verticalScrollBar.visible=!1,this.list_scroll.viewport=this.union_list,this.setTitle("仙盟管理"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.exit_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitOrDissolved,this),this.auto_adopt_cb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAutoDopt,this),this.limit_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openLvLimitView,this),this.agree_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeAll,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE.toString(),this.onResApplyPlayerListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE.toString(),this.onResOperationMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_REVIEW_AGREE_ALL.toString(),this.onResAgreeAllMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.onResUnionInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_QUIT_MESSAGE.toString(),this.onResUnionInfoMsg,this);for(var t=0;3>t;++t)this.tabbtn_groups[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.auto_adopt_cb.selected=DataManager.getInstance().unionManager.unionInfo.autoAdopt,this.tab_group.removeChildren(),this.tab_group.addChild(this.tabbtn_groups[2]),this.getAuthority()&&this.tab_group.addChild(this.tabbtn_groups[1]),this.onchangeTabHandler(2)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.exit_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitOrDissolved,this),this.auto_adopt_cb.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAutoDopt,this),this.limit_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openLvLimitView,this),this.agree_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeAll,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE.toString(),this.onResApplyPlayerListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE.toString(),this.onResOperationMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_REVIEW_AGREE_ALL.toString(),this.onResAgreeAllMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LOG_MESSAGE.toString(),this.onResUnionLogMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_INFO_MESSAGE.toString(),this.onResUnionInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_QUIT_MESSAGE.toString(),this.onResUnionInfoMsg,this);for(var t=0;3>t;++t)this.tabbtn_groups[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this);this.union_list.dataProvider=null,this.tab_btns[this.currTabIndex].selected=!1,this.currTabIndex=-1},t.prototype.onTouchTabBtn=function(e){var t=parseInt(e.currentTarget.name);this.onchangeTabHandler(t)},t.prototype.onchangeTabHandler=function(e){if(this.currTabIndex!=e){switch(this.limit_group.visible=!1,this.agree_btn.visible=!1,this.exit_btn.visible=!1,this.currTabIndex=e,this.union_list.dataProvider=null,e){case 0:break;case 1:this.setTitle("仙盟审核"),this.getAuthority()&&(this.limit_group.visible=!0,this.agree_btn.visible=!0,this.onReqApplyPlayerListMsg());break;case 2:this.exit_btn.visible=!0,this.setTitle("仙盟日志"),this.onReqUnionLogMsg()}this.tab_btns[this.currTabIndex].selected=!0}},t.prototype.onReqMemberListMsg=function(){return this.reqMemberListTime-egret.getTimer()>0?void this.onResMemberListMsg():(this.reqMemberListTime=egret.getTimer()+2e3,void DataManager.getInstance().unionManager.onReqUnionMember())},t.prototype.onResMemberListMsg=function(){this.getAuthority()&&this.tab_group.addChild(this.tabbtn_groups[1]);var e=DataManager.getInstance().unionManager.unionInfo.selfData;this.exit_btn.label=e&&e.postion==UNION_POSTION.WANG?"解散仙盟":"退出仙盟",this.union_list.itemRenderer=UnionMemberItem,this.union_list.itemRendererSkinName=skins.UnionMemberItemSkin;var t=DataManager.getInstance().unionManager.unionInfo.unionMemberList;t.sort(function(e,t){return e.postion-t.postion}),this.union_list.dataProvider=new eui.ArrayCollection(t)},t.prototype.onReqApplyPlayerListMsg=function(){if(!(this.reqApplyListTime-egret.getTimer()>0)){this.reqApplyListTime=egret.getTimer()+2e3;var e=new Message(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onResApplyPlayerListMsg=function(e){var t=e.message;this.union_list.itemRenderer=ApplyPlayerItem,this.union_list.itemRendererSkinName=skins.UnionJoinItemSkin;for(var n=this.applyplayerList.length-1;n>=0;n--)this.applyplayerList[0]=null,this.applyplayerList.splice(n,1);for(var a=t.getShort(),n=0;a>n;n++){var i=new SimplePlayerData;i.parseMsg(t),this.applyplayerList.push(i)}this.union_list.dataProvider=new eui.ArrayCollection(this.applyplayerList)},t.prototype.onResOperationMsg=function(e){for(var t=!1,n=e.message,a=n.getInt(),i=n.getByte(),o=this.applyplayerList.length-1;o>=0;o--)if(a==this.applyplayerList[o].id){if(i>0){var r=1==i?"通过":"拒绝";GameCommon.getInstance().addAlert("您已"+r+"玩家"+this.applyplayerList[o].name+"的申请")}this.applyplayerList[o]=null,this.applyplayerList.splice(o,1),t=!0;break}t&&(this.union_list.dataProvider=new eui.ArrayCollection(this.applyplayerList))},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG||e.postion==UNION_POSTION.ZHANGLAO:!1},t.prototype.onChangeAutoDopt=function(){if(this.changeAutoDoptTime-egret.getTimer()>0)return this.auto_adopt_cb.selected=DataManager.getInstance().unionManager.unionInfo.autoAdopt,void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(78));if(this.changeAutoDoptTime=egret.getTimer()+2e3,this.auto_adopt_cb.selected!=DataManager.getInstance().unionManager.unionInfo.autoAdopt){var e=new Message(MESSAGE_ID.UNION_CHANGE_AUTOADOPT_MESSAGE);e.setBoolean(this.auto_adopt_cb.selected),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.openLvLimitView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionLimitLevelPanel")},t.prototype.onAgreeAll=function(){var e=new Message(MESSAGE_ID.UNION_REVIEW_AGREE_ALL);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResAgreeAllMsg=function(e){GameCommon.getInstance().addAlert("您已同意全部玩家的申请"),this.applyplayerList=[],this.union_list.dataProvider=new eui.ArrayCollection(this.applyplayerList)},t.prototype.onQuitOrDissolved=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;if(e&&e.postion==UNION_POSTION.WANG){var t=[{text:"您确定要将仙盟解散？（解散后仙盟将无法找回，请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,function(){var e=new Message(MESSAGE_ID.UNION_DISSOLVED_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},this)))}else{var n=[{text:"您确定要退出仙盟？（请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,function(){var e=new Message(MESSAGE_ID.UNION_QUIT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},this)))}},t.prototype.onResUnionInfoMsg=function(){DataManager.getInstance().unionManager.unionInfo||(this.onHide(),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel"))},t.prototype.onResUnionLogMsg=function(){this.union_list.itemRenderer=UnionLogItem,this.union_list.itemRendererSkinName=skins.UnionLogItemSkin,this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.unionLogs)},t.prototype.onReqUnionLogMsg=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;this.exit_btn.label=e&&e.postion==UNION_POSTION.WANG?"解散仙盟":"退出仙盟";var t=new Message(MESSAGE_ID.UNION_LOG_MESSAGE);GameCommon.getInstance().sendMsgToServer(t)},t}(BaseWindowPanel);__reflect(UnionMemberListPanel.prototype,"UnionMemberListPanel");var UnionMemberItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.appoint_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAppoint,this),this.delete_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDelete,this)},t.prototype.dataChanged=function(){var e=this.data,t=DataManager.getInstance().unionManager.unionInfo.selfData;(t.postion==UNION_POSTION.WANG||t.postion==UNION_POSTION.FUBANG||t.postion==UNION_POSTION.ZHANGLAO)&&e.playerdata.id!=DataManager.getInstance().playerManager.player.id&&e.postion>DataManager.getInstance().unionManager.unionInfo.selfData.postion?this.opt_group.visible=!0:this.opt_group.visible=!1,this.union_name_label.text=e.playerdata.name,this.union_level_label.text=e.playerdata.level+"级",this.union_postion_icon.source=UnionDefine.Union_Postion_Icons[e.postion],this.playerHead.setHead(e.playerdata.headindex,e.playerdata.headFrame),e.playerdata.viplevel>0?this.vip_group.visible=!0:this.vip_group.visible=!1,this.power_label.text="战力："+e.playerdata.fightvalue,this.donate_label.text="贡献："+e.donate;var n=DataManager.getInstance().friendManager.getOnlineTime(e.offLineTime).split("|");"online"==n[1]?this.online_time_label.visible=!1:(this.online_time_label.visible=!0,this.online_time_label.text=n[0]),this.online_status.source="friend_"+n[1]+"_png",e.postion==UNION_POSTION.WANG&&1==DataManager.getInstance().unionManager.unionInfo.isImpeachment?(this.impeachmentBtn.visible=!0,this.impeachmentBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onImpeachment,this)):this.impeachmentBtn.visible=!1},t.prototype.onAppoint=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionAppPointPanel",this.data))},t.prototype.onDelete=function(){var e=[{text:"是否将"+this.data.playerdata.name+"请离仙盟？（请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,function(e){var t=new Message(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE);t.setInt(e),GameCommon.getInstance().sendMsgToServer(t)},this,this.data.playerdata.id)))},t.prototype.onImpeachment=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam("此位不负责盟主已经连续7天未上线了，上仙是否准备消耗500钻石将其弹劾取代其盟主之位？",this.sendImpeachment,this)))},t.prototype.sendImpeachment=function(){var e=new Message(MESSAGE_ID.UNION_IMPEACHMENT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t}(eui.ItemRenderer);__reflect(UnionMemberItem.prototype,"UnionMemberItem");var ApplyPlayerItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.sure_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSure,this),this.refuse_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuse,this)},t.prototype.dataChanged=function(){var e=this.data;this.union_name_label.text="昵称："+e.name,this.union_level_label.text="等级："+e.level+"级",this.playerHead.setHead(e.headindex,e.headFrame),e.viplevel>0?this.vip_group.visible=!0:this.vip_group.visible=!1,this.power_label.text="战力："+e.fightvalue},t.prototype.onSure=function(){var e=new Message(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE);e.setInt(this.data.id),e.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRefuse=function(){var e=new Message(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE);e.setInt(this.data.id),e.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(e)},t}(eui.ItemRenderer);__reflect(ApplyPlayerItem.prototype,"ApplyPlayerItem");var UnionLogItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){var e=this.data;this.log_label.textFlow=(new egret.HtmlTextParser).parser(e)},t}(eui.ItemRenderer);__reflect(UnionLogItem.prototype,"UnionLogItem");var UnionMemberListView=function(e){function t(t){var n=e.call(this,t)||this;return n.currTabIndex=-1,n.reqMemberListTime=0,n.reqApplyListTime=0,n.applyplayerList=[],n.changeAutoDoptTime=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionMemberPanelSkin},t.prototype.onInit=function(){this.list_scroll.verticalScrollBar.autoVisibility=!0,this.union_list.percentWidth=620,this.union_list.percentHeight=150,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,this.tabbtn_group0.name="0",this.tabbtn_group1.name="1",e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){this.exit_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitOrDissolved,this),this.auto_adopt_cb.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAutoDopt,this),this.limit_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openLvLimitView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE.toString(),this.onResApplyPlayerListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE.toString(),this.onResOperationMsg,this),this.tabbtn_group0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this),this.tabbtn_group1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this),this.auto_adopt_cb.selected=DataManager.getInstance().unionManager.unionInfo.autoAdopt,this.tab_group.removeChildren(),this.tab_group.addChild(this.tabbtn_group0),this.onchangeTabHandler(0)},t.prototype.onRemove=function(){this.exit_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onQuitOrDissolved,this),this.auto_adopt_cb.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAutoDopt,this),this.limit_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openLvLimitView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_POSTION_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_DELETE_MEMBER_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE.toString(),this.onResApplyPlayerListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_REVIEW_OPERATION_MESSAGE.toString(),this.onResOperationMsg,this),this.tabbtn_group0.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this),this.tabbtn_group1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this),this.union_list.dataProvider=null,this["tab_btn"+this.currTabIndex].selected=!1,this.currTabIndex=-1},t.prototype.onTouchTabBtn=function(e){var t=parseInt(e.currentTarget.name);this.onchangeTabHandler(t)},t.prototype.onchangeTabHandler=function(e){if(this.currTabIndex!=e){switch(this.recruit_group.visible=!1,this.limit_group.visible=!1,this.currTabIndex=e,this.union_list.dataProvider=null,e){case 0:this.recruit_group.visible=!0,this.onReqMemberListMsg();break;case 1:this.getAuthority()&&(this.limit_group.visible=!0,this.onReqApplyPlayerListMsg())}this["tab_btn"+this.currTabIndex].selected=!0}},t.prototype.onReqMemberListMsg=function(){if(this.reqMemberListTime-egret.getTimer()>0)return void this.onResMemberListMsg();this.reqMemberListTime=egret.getTimer()+2e3;var e=new Message(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResMemberListMsg=function(){this.getAuthority()&&this.tab_group.addChild(this.tabbtn_group1);var e=DataManager.getInstance().unionManager.unionInfo.selfData;this.exit_btn.label=e&&e.postion==UNION_POSTION.WANG?"解散帮会":"退出帮会",this.union_list.itemRenderer=UnionMemberItem,this.union_list.itemRendererSkinName=skins.UnionMemberItemSkin,DataManager.getInstance().unionManager.unionInfo.unionMemberList.sort(function(e,t){return e.postion-t.postion}),this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.unionInfo.unionMemberList)},t.prototype.onReqApplyPlayerListMsg=function(){if(!(this.reqApplyListTime-egret.getTimer()>0)){this.reqApplyListTime=egret.getTimer()+2e3;var e=new Message(MESSAGE_ID.UNION_REVIEW_LIST_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.onResApplyPlayerListMsg=function(e){var t=e.message;this.union_list.itemRenderer=ApplyPlayerItem,this.union_list.itemRendererSkinName=skins.UnionJoinItemSkin;for(var n=this.applyplayerList.length-1;n>=0;n--)this.applyplayerList[0]=null,this.applyplayerList.splice(n,1);for(var a=t.getShort(),n=0;a>n;n++){var i=new SimplePlayerData;i.parseMsg(t),this.applyplayerList.push(i)}this.union_list.dataProvider=new eui.ArrayCollection(this.applyplayerList)},t.prototype.onResOperationMsg=function(e){for(var t=!1,n=e.message,a=n.getInt(),i=n.getByte(),o=this.applyplayerList.length-1;o>=0;o--)if(a==this.applyplayerList[o].id){if(i>0){var r=1==i?"通过":"拒绝";GameCommon.getInstance().addAlert("您已"+r+"玩家"+this.applyplayerList[o].name+"的申请")}this.applyplayerList[o]=null,this.applyplayerList.splice(o,1),t=!0;break}t&&(this.union_list.dataProvider=new eui.ArrayCollection(this.applyplayerList))},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG||e.postion==UNION_POSTION.ZHANGLAO:!1},t.prototype.onChangeAutoDopt=function(){if(this.changeAutoDoptTime-egret.getTimer()>0)return this.auto_adopt_cb.selected=DataManager.getInstance().unionManager.unionInfo.autoAdopt,void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(78));if(this.changeAutoDoptTime=egret.getTimer()+2e3,this.auto_adopt_cb.selected!=DataManager.getInstance().unionManager.unionInfo.autoAdopt){var e=new Message(MESSAGE_ID.UNION_CHANGE_AUTOADOPT_MESSAGE);e.setBoolean(this.auto_adopt_cb.selected),GameCommon.getInstance().sendMsgToServer(e)}},t.prototype.openLvLimitView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionLimitLevelPanel")},t.prototype.onQuitOrDissolved=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;if(e&&e.postion==UNION_POSTION.WANG){var t=[{text:"您确定要将帮会解散？（解散后帮会将无法找回，请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(t,function(){var e=new Message(MESSAGE_ID.UNION_DISSOLVED_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},this)))}else{var n=[{text:"您确定要退出公会？（请慎重考虑）",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(n,function(){var e=new Message(MESSAGE_ID.UNION_QUIT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},this)))}},t.prototype.getStyle=function(){return"bg_style1"},t}(BaseTabView);__reflect(UnionMemberListView.prototype,"UnionMemberListView");var UnionPrizeRecordPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionPrizeRecordPanelSkin},t.prototype.onInit=function(){this.setTitle("仙盟"),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.label_record.textFlow=DataManager.getInstance().unionManager.getTextFlow()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE.toString(),this.onRefresh,this),DataManager.getInstance().unionManager.onReqUnionPrizeRecord()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE.toString(),this.onRefresh,this)},t}(BaseWindowPanel);__reflect(UnionPrizeRecordPanel.prototype,"UnionPrizeRecordPanel");var UnionRankView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionRankPanelSkin},t.prototype.onInit=function(){this.list_scroll.verticalScrollBar.autoVisibility=!0,this.union_list.percentWidth=620,this.union_list.percentHeight=136,this.union_list.itemRenderer=UnionRankItem,this.union_list.itemRendererSkinName=skins.UnionRankItemSkin,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,e.prototype.onInit.call(this),this.setTitle("仙盟排行"),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this),this.onReqUnionListMsg()},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this),e.prototype.onRemove.call(this)},t.prototype.onReqUnionListMsg=function(){var e=new Message(MESSAGE_ID.UNION_LIST_MESSAGE);e.setShort(1),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionListMsg=function(){for(var e=[],t=0;t<DataManager.getInstance().unionManager.applyUnionList.length;t++)e.push({info:DataManager.getInstance().unionManager.applyUnionList[t],rank:t+1});this.union_list.dataProvider=new eui.ArrayCollection(e)},t}(BaseWindowPanel);__reflect(UnionRankView.prototype,"UnionRankView");var UnionRankItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){},t.prototype.dataChanged=function(){var e=this.data.info,t=this.data.rank,n=Tool.toInt(e.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.union_badges.badges_bg.source="union_badges_bg"+n+"_png";var a=e.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.union_badges.badges_icon.source="union_badges_icon"+a+"_png",this.union_name_label.textFlow=(new egret.HtmlTextParser).parser(e.name),this.unionLv.text="等级:"+e.level+"级",this.mamber_Name.text="盟主:"+e.wangName;var i=JsonModelManager.instance.getModelguildLv()[e.level-1];this.member_num_label.text="盟众:"+e.memberCount+"/"+(i?i.renshuMax:0),this.rank_num.text=t.toString(),t>4?this.rank_icon.source="rankbg_4_png":this.rank_icon.source="rankbg_"+t+"_png"},t}(eui.ItemRenderer);__reflect(UnionRankItem.prototype,"UnionRankItem");var UnionSearchPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionCreatePanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t}(BaseWindowPanel);__reflect(UnionSearchPanel.prototype,"UnionSearchPanel");var UnionSkillPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.selectedIdx=0,n.currentSelect=1,n.lastSelect=1,n.points=RedPointManager.createPoint(5),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionSkillSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("修炼阁");for(var t=0;t<UnionDefine.Union_Skill_Max;t++)3>t?this.points[t].register(this["group"+(t+1)],GameDefine.RED_GOODSINSTANCE_POS,DataManager.getInstance().unionManager,"checkUnionSkillOnePoint",0,t+1):this.points[t].register(this["group"+(t+1)],new egret.Point(100,25),DataManager.getInstance().unionManager,"checkUnionSkillOnePoint",0,t+1);this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.x=58,this.selectedAnim.y=58,this.selectedAnim.onPlay(),this.group1.addChildAt(this.selectedAnim,2),this.selectedAnim2=new Animation("gonghuijineng_2",-1),this.selectedAnim2.x=70,this.selectedAnim2.y=94,this.selectedAnim2.onPlay(),this.group1.data=1,this.group2.data=2,this.group3.data=3,this.group4.data=4,this.group5.data=5,this.onRefresh()},t.prototype.onRefresh=function(){var e=this.currentSelect,t=this.getPlayerData().getUnionSkill2(e),n=0,a=1;t&&(n=t.level,a=n+1);var i=JsonModelManager.instance.getModelguildSkill()[e][n-1],o=JsonModelManager.instance.getModelguildSkill()[e][a-1];this.levelLabel.text=n+"级";var r=i||o;if(this.nameLabel.text=r.name,1==r.type?this.progressBar.visible=!1:(o?(this.progressBar.visible=!0,this.progressBar.maximum=o.expMax):this.progressBar.visible=!1,t?this.progressBar.value=t.exp:this.progressBar.value=0),i){for(var s="",h=0;h<ATTR_TYPE.SIZE;++h)i.attrAry[h]>0&&(s.length>0&&(s+="\n"),s+=Language.instance.getAttrName(h)+"+"+i.attrAry[h]);i.attPlus>0&&(s.length>0&&(s+="\n"),s+="攻击加成：+"+i.attPlus/100+"%"),i.hpPlus>0&&(s.length>0&&(s+="\n"),s+="生命加成：+"+i.hpPlus/100+"%"),this.attrLabel1.text=s}else this.attrLabel1.text="";for(var l="",h=0;h<ATTR_TYPE.SIZE;++h)o.attrAry[h]>0&&(l.length>0&&(l+="\n"),l+=Language.instance.getAttrName(h)+"+"+o.attrAry[h]);o.attPlus>0&&(l.length>0&&(l+="\n"),l+="攻击加成：+"+o.attPlus/100+"%"),o.hpPlus>0&&(l.length>0&&(l+="\n"),l+="生命加成：+"+o.hpPlus/100+"%"),this.attrLabel2.text=l,this.consume1.setLabel(o.costList[0].type,0,DataManager.getInstance().playerManager.player.donate,o.costList[0].num),this.consume2.data=new CurrencyParam("",new ThingBase(o.costList[1].type,0,o.costList[1].num)),this.trigger()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.group1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.btnUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnUp,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_SKILL2_UPGRADE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.group1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.group5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectSkill,this),this.btnUp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnUp,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_SKILL2_UPGRADE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onSelectSkill=function(e){var t=e.currentTarget;this.currentSelect=t.data,this.clearAnim(),this.currentSelect<=3?t.addChildAt(this.selectedAnim,2):t.addChildAt(this.selectedAnim2,2),this.lastSelect=this.currentSelect,this.onRefresh()},t.prototype.clearAnim=function(){1==this.lastSelect&&this.group1.removeChildAt(2),2==this.lastSelect&&this.group2.removeChildAt(2),3==this.lastSelect&&this.group3.removeChildAt(2),4==this.lastSelect&&this.group4.removeChildAt(2),5==this.lastSelect&&this.group5.removeChildAt(2)},t.prototype.onChangeRole=function(){this.progressBar.value=0,this.onRefresh()},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player.getPlayerData(this.selectedIdx)},t.prototype.onBtnUp=function(){var e=new Message(MESSAGE_ID.UNION_SKILL2_UPGRADE_MESSAGE);e.setByte(this.selectedIdx),e.setByte(this.currentSelect),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.trigger=function(){for(var e=0;e<UnionDefine.Union_Skill_Max;e++)this.points[e].checkPoint(!0,0,e+1)},t}(BaseWindowPanel);__reflect(UnionSkillPanel.prototype,"UnionSkillPanel");var UnionTaskView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionTaskViewSkin},t.prototype.onInit=function(){this.union_list.percentWidth=620,this.union_list.percentHeight=130,this.union_list.itemRenderer=UnionTaskItem,this.union_list.itemRendererSkinName=skins.UnionTaskItemSkin,this.union_list.useVirtualLayout=!0,this.list_scroll.viewport=this.union_list,DataManager.getInstance().unionManager.onSendTaskMessage(),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.union_list.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.getUnionTaskData())},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TASK_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TASK_UPDATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TASK_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TASK_UPDATE_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onRefresh,this)},t}(BaseTabView);__reflect(UnionTaskView.prototype,"UnionTaskView");var UnionTaskItem=function(e){function t(){var t=e.call(this)||this;return t.isCanDo=!1,t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.btn_goto.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtn,this)
},t.prototype.dataChanged=function(){this.isCanDo=!1;var e,t;0==this.data.id?(e=10,this.icon_task.source="tongqian_png",this.label_desc.text="消耗20万银币上一炷香",this.btn_goto.label="捐献",this.label_exp.text="帮会经验+10",this.label_donate.text="帮贡+10"):(this.icon_task.source="union_task_icon_png",this.btn_goto.label="前往",this.model=JsonModelManager.instance.getModelguildTask()[this.data.id],this.model&&(e=this.model.count,this.label_desc.text=this.model.name,this.label_exp.text="帮会经验+"+this.model.guildExp,this.label_donate.text="帮贡+"+this.model.guildExp)),t=this.data.param>e?e:this.data.param,this.label_progress.text=t+"/"+e,t>=e?(this.btn_goto.label="已完成",GameCommon.getInstance().onButtonEnable(this.btn_goto,!1)):(this.isCanDo=!0,GameCommon.getInstance().onButtonEnable(this.btn_goto,!0))},t.prototype.onTouchBtn=function(){if(this.isCanDo)if(0==this.data.id){var e=new Message(MESSAGE_ID.UNION_TRIBUTE_MESSAGE);e.setByte(1),GameCommon.getInstance().sendMsgToServer(e)}else GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),this.model.goType)},t}(eui.ItemRenderer);__reflect(UnionTaskItem.prototype,"UnionTaskItem");var UnionTributePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionTributeSkin},t.prototype.onInit=function(){this.setTitle("仙盟上香"),this.tributeItems=[];for(var t in JsonModelManager.instance.getModelguildShangxiang()){var n=JsonModelManager.instance.getModelguildShangxiang()[t],a=new UnionTributeItem(n);a.tribute_btn.name=t+"",this.tribute_group.addChild(a),this.tributeItems.push(a)}e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){for(var e=0;e<this.tributeItems.length;e++){var t=this.tributeItems[e];t.onUpdateNums()}this.updateMoney()},t.prototype.updateMoney=function(){var e=DataManager.getInstance().playerManager.player;this.gold_num_label.text=GameCommon.getInstance().getFormatNumberShow(e.gold),this.bandgold_num_label.text=GameCommon.getInstance().getFormatNumberShow(e.money)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.updateMoney,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().removeEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.updateMoney,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TRIBUTE_MESSAGE.toString(),this.onRefresh,this)},t.prototype.trigger=function(){e.prototype.trigger.call(this);for(var t=0;t<this.tributeItems.length;t++){var n=this.tributeItems[t];n.onUpdateNums(),n.points[0].checkPoint()}},t}(BaseWindowPanel);__reflect(UnionTributePanel.prototype,"UnionTributePanel");var UnionTributeItem=function(e){function t(t){var n=e.call(this)||this;return n.points=RedPointManager.createPoint(1),n.isUpTribute=!1,n.tributeNum=0,n.tributeModel=t,n.once(egret.Event.COMPLETE,n.onComplete,n),n.skinName=skins.TributeItemSkin,n}return __extends(t,e),t.prototype.onComplete=function(){this.tribute_icon.source="tribute_icon"+this.tributeModel.id+"_png",this.tribute_text.source="tribute_text"+this.tributeModel.id+"_png",this.tribute_desc.textFlow=(new egret.HtmlTextParser).parser("可获得\r盟贡 "+this.tributeModel.banggong+"\r仙盟经验 "+this.tributeModel.guildExp),this.tribute_cost.nameColor=15987699,this.tribute_cost.data=new CurrencyParam("消耗",new ThingBase(this.tributeModel.cost.type,0,this.tributeModel.cost.num)),this.tribute_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.TributeHandler,this),this.points[0].register(this.tribute_btn,new egret.Point(150,-10),this,"checkRedPoint")},t.prototype.onUpdateNums=function(){if(1==this.tributeModel.id)this.max=10,this.useTime=DataManager.getInstance().unionManager.unionInfo.tributeNum,this.remain=this.max-this.useTime;else{var e=DataManager.getInstance().playerManager.player.viplevel;this.max=0;var t=JsonModelManager.instance.getModelvip()[e-1];if(t)for(var n,a=t.weals.split("#"),i=0;i<a.length;i++)if(n=a[i].split(","),6==parseInt(n[0])){this.max=parseInt(n[1]);break}this.useTime=DataManager.getInstance().unionManager.unionInfo.tributeVipNum,this.remain=this.max-this.useTime}this.tribute_btn.label="上香("+(this.useTime+this.tributeNum+"/"+this.max)+")",0!=this.remain?this.tribute_btn.enabled=!0:this.tribute_btn.enabled=!1},t.prototype.TributeHandler=function(e){var t=parseInt(e.currentTarget.name);if(t>1){if(this.remain<=0)return void GameCommon.getInstance().addAlert("您当前已达上限，提高VIP等级可扩展次数");var n=JsonModelManager.instance.getModelguildShangxiang()[t],a=GameCommon.getInstance().getThingModel(n.cost.type,n.cost.id),i=n.cost.num+a.name,o=[{text:"是否消耗"+i+"进行一次仙盟上香？",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(o,function(e){this.onTribute(e)},this,t)))}else{if(this.tributeNum>0&&this.max-(this.useTime+this.tributeNum)<=0)return this.tribute_btn.enabled=!1,void this.onSendTribute();if(this.remain<=0)return void GameCommon.getInstance().addAlert("您今日上香已达上限");var r=DataManager.getInstance().playerManager.player.getICurrency(4);if(r<this.tributeModel.cost.num*(this.tributeNum+1))return void GameCommon.getInstance().addAlert("货币不足");this.onSendTributeCount()}},t.prototype.onSendTribute=function(){if(!(this.max-(this.useTime+this.tributeNum)<0||0==this.tributeNum)){this.isUpTribute=!1;var e=JsonModelManager.instance.getModelguildShangxiang()[1],t=new Message(MESSAGE_ID.UNION_TRIBUTE_MESSAGE);t.setByte(e.id),t.setByte(this.tributeNum),GameCommon.getInstance().sendMsgToServer(t),this.tributeNum=0}},t.prototype.onSendTributeCount=function(){GameCommon.getInstance().addAlert("上香成功"),this.isUpTribute||(this.isUpTribute=!0,Tool.callbackTime(this.onSendTribute,this,2e3)),this.tributeNum=this.tributeNum+1,this.remain=this.max-(this.useTime+this.tributeNum),this.tribute_btn.label="上香("+(this.useTime+this.tributeNum+"/"+this.max)+")"},t.prototype.onHide=function(){this.tributeNum>0&&this.onSendTribute()},t.prototype.onTribute=function(e){var t=JsonModelManager.instance.getModelguildShangxiang()[e];switch(e){case 2:if(!GameCommon.getInstance().onCheckItemConsume(t.cost.id,t.cost.num,t.cost.type))return}var n=new Message(MESSAGE_ID.UNION_TRIBUTE_MESSAGE);n.setByte(t.id),n.setByte(1),GameCommon.getInstance().sendMsgToServer(n)},t.prototype.checkRedPoint=function(){return 1==this.tributeModel.id&&DataManager.getInstance().unionManager.checkTributeRedPoint()?!0:!1},t}(eui.Component);__reflect(UnionTributeItem.prototype,"UnionTributeItem");var UnionTurnplatePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.pay=100,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionTurnplateSkin},t.prototype.onInit=function(){this.onInitData(7,GameDefine.UNION_TURNPLATE_GAINID),this.label_goldOne.text=this.pay.toString(),this.setTitle("仙盟密阁"),this.btn_one.touchEnabled=!0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onInitData=function(e,t){this.gainId=t;for(var n,a,i=[],o=(JsonModelManager.instance.getModelgain()[this.gainId],GameCommon.getInstance().onParseAwardItemstr(GameDefine.UNION_TURNPLATE_SHOW)),r=0,s=0;e>s;s++)n=this["goods"+s],a=o[r],n.onUpdate(a.type,a.id,0,a.quality,a.num),i.push(n),r++,r==o.length&&(r=0)},t.prototype.onRefresh=function(){this.onUpdateCurrency(),this.onRunALottery()},t.prototype.onUpdateCurrency=function(e){void 0===e&&(e=null),this.label_points.text=DataManager.getInstance().playerManager.player.donate+""},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_one.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_TURNPLATE_FILT_MESSAGE.toString(),this.onRunALottery,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE.toString(),this.onRecordUpdate,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_one.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchBtnOne,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onUpdateCurrency,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_TURNPLATE_FILT_MESSAGE.toString(),this.onRunALottery,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_PRIZE_RECORD_MESSAGE.toString(),this.onRecordUpdate,this)},t.prototype.onRunALottery=function(){this.btn_one.touchEnabled=!0,DataManager.getInstance().unionManager.onReqUnionPrizeRecord(),this.onRecordUpdate()},t.prototype.onTouchRecord=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionPrizeRecordPanel")},t.prototype.onRecordUpdate=function(){var e=DataManager.getInstance().unionManager.unionInfo.info.level,t=JsonModelManager.instance.getModelguildLv()[e-1];this.label_time.textFlow=(new egret.HtmlTextParser).parser('今日剩余次数：<font color="#28E828">'+(t.zhuanpanMax-DataManager.getInstance().unionManager.unionInfo.turnplateNum)+"</font>"),this.label_info.textFlow=DataManager.getInstance().unionManager.getTextFlow(3)},t.prototype.onTouchBtnOne=function(){var e=DataManager.getInstance().unionManager.unionInfo.info.level,t=JsonModelManager.instance.getModelguildLv()[e-1];return t.zhuanpanMax<=DataManager.getInstance().unionManager.unionInfo.turnplateNum?void GameCommon.getInstance().addAlert("今日转盘次数已达上限"):void this.onSendMessage(0)},t.prototype.onGetBtn=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionTributePanel")},t.prototype.onSendMessage=function(e){if(DataManager.getInstance().playerManager.player.donate<this.pay)return void GameCommon.getInstance().addAlert("仙盟贡献不足");var t=new Message(MESSAGE_ID.UNION_TURNPLATE_FILT_MESSAGE);t.setByte(e),GameCommon.getInstance().sendMsgToServer(t),this.btn_one.touchEnabled=!1},t}(BaseWindowPanel);__reflect(UnionTurnplatePanel.prototype,"UnionTurnplatePanel");var UnionAllotAlertPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionAllotAlertViewSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=this.allotParam.awardItem;this.depot_goods.currentState="notName",this.depot_goods.onUpdate(e.type,e.id,0,e.quality,e.num,e.lv),this.havItemNum.text="当前拥有: "+e.num;var t=GameCommon.getInstance().getThingModel(e.type,e.id,e.quality);t&&(this.itemName.text=t.name),this.playerHead.setHead(this.allotParam.playerdata.headindex,this.allotParam.playerdata.headFrame),this.vip_label.text=""+GameCommon.getInstance().getVipName(this.allotParam.playerdata.viplevel),this.name_label.text=this.allotParam.playerdata.name,this.level_label.text=(this.allotParam.playerdata.rebirthLv>0?this.allotParam.playerdata.rebirthLv+"转":"")+this.allotParam.playerdata.level+"级"},t.prototype.onShowWithParam=function(e){this.allotParam=e,this.onShow()},t.prototype.onShow=function(){this.allotParam&&e.prototype.onShow.call(this)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_min.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btnReduce.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btn_max.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendAllotAwdMsg,this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.onReset()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_min.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btnReduce.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btnAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btn_max.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeAllotNum,this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendAllotAwdMsg,this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.allotParam=null},t.prototype.onReset=function(){this.allotParam.num>0?this.label_num.text="1":this.label_num.text="0"},Object.defineProperty(t.prototype,"allotNum",{get:function(){return parseInt(this.label_num.text)},set:function(e){e!=this.allotNum&&(e=Math.max(e,0),e=Math.min(e,this.allotParam.awardItem.num),this.label_num.text=""+e)},enumerable:!0,configurable:!0}),t.prototype.onChangeAllotNum=function(e){var t=e.currentTarget.name,n=this.allotNum;"0"!=this.label_num.text&&("Min"==t?(n-=10,1>=n&&(n=1)):"Reduce"==t?n>1&&(n-=1):"Add"==t?(n<this.allotParam.awardItem.num&&(n+=1),n>this.allotParam.num&&(n=this.allotParam.num)):"Max"==t&&(n+=10,n>this.allotParam.awardItem.num&&(n=this.allotParam.awardItem.num),n>this.allotParam.num&&(n=this.allotParam.num)),this.allotNum=n)},t.prototype.onSendAllotAwdMsg=function(){var e=new Message(MESSAGE_ID.UNION_BATTLE_ALLOT_MESSAGE);return 0==this.allotNum?void GameCommon.getInstance().addAlert("物品不足或该员分配数量已达到上限!"):(e.setInt(this.allotParam.playerdata.id),e.setShort(this.allotParam.awardItem.id),e.setShort(this.allotNum),GameCommon.getInstance().sendMsgToServer(e),void this.onHide())},t}(BaseWindowPanel);__reflect(UnionAllotAlertPanel.prototype,"UnionAllotAlertPanel");var UnionAllotParam=function(){function e(e,t,n){this.awardItem=e,this.playerdata=t,this.num=n}return e}();__reflect(UnionAllotParam.prototype,"UnionAllotParam");var UnionBattleAwdPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.rewardArr=new Array,n}return __extends(t,e),t.prototype.getTabButtonSkin=function(e){var t=new BaseTabButton2("");return t.label=e,t},t.prototype.onInit=function(){this.awardList.itemRenderer=UnionBattleAwdItem,this.awardList.itemRendererSkinName=skins.UnionBattleAwdItemSkin,this.awardList.useVirtualLayout=!0,this.scroll.viewport=this.awardList,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleAwdSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onRefresh=function(){this.onRefreshSuperAwd(),this.awardList.dataProvider=new eui.ArrayCollection(this.models)},t.prototype.onRefreshSuperAwd=function(){if(0==this.super_awd_grp.numChildren){this.super_awd_grp.removeChildren();for(var e=JsonModelManager.instance.getModelguildspecialreward()[1],t=GameCommon.getInstance().onParseAwardItemstr(e.huizhangReward+"#"+e.huiyuanReward),n=0;n<t.length;n++){var a=new GoodsInstance,i=t[n];a.onUpdate(i.type,i.id,0,i.quality,i.num),this.super_awd_grp.addChild(a)}}},Object.defineProperty(t.prototype,"models",{get:function(){var e;e=JsonModelManager.instance.getModelguildreward();var t=0;for(var n in e)this.rewardArr[t]=e[n],t+=1;return this.rewardArr},enumerable:!0,configurable:!0}),t.prototype.onClose=function(){this.onHide()},t}(BaseWindowPanel);__reflect(UnionBattleAwdPanel.prototype,"UnionBattleAwdPanel");var UnionBattleAwdItem1=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;e.id>3?(this.rank_icon.visible=!1,this.rank_num_group.visible=!0,this.rank_num_label.text=""+e.id):(this.rank_icon.visible=!0,this.rank_num_group.visible=!1,this.rank_icon.source="rank_itemtitle"+e.id+"_png"),this.award_grp.removeChildren();for(var t=GameCommon.getInstance().onParseAwardItemstr(e.cangkuReward),n=0;n<t.length;n++){var a=new GoodsInstance,i=t[n];a.onUpdate(i.type,i.id,0,i.quality,i.num,i.lv),this.award_grp.addChild(a)}},t}(eui.ItemRenderer);__reflect(UnionBattleAwdItem1.prototype,"UnionBattleAwdItem1");var UnionBattleAwdItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.rank_icon.source="rankbg_"+e.id+"_png",this.rank_num_lab.text=e.id,this.award_grp.removeChildren();for(var t=GameCommon.getInstance().onParseAwardItemstr(e.tongyongReward),n=GameCommon.getInstance().onParseAwardItemstr(e.cangkuReward),a=0;a<t.length;a++){var i=new GoodsInstance,o=t[a];i.onUpdate(o.type,o.id,0,o.quality,o.num,o.lv),this.award_grp.addChild(i)}for(var r=0;r<n.length;r++){var i=new GoodsInstance,o=n[r];i.onUpdate(o.type,o.id,0,o.quality,o.num,o.lv),this.award_grp.addChild(i)}},t}(eui.ItemRenderer);__reflect(UnionBattleAwdItem.prototype,"UnionBattleAwdItem");var UnionBattleGroupView=function(e){function t(t){var n=e.call(this,t)||this;return n.Groups_SortAry=[1,4,2,3],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleGroupSkin},t.prototype.onInit=function(){GameCommon.getInstance().addUnderlineStr(this.explain_label),GameCommon.getInstance().addUnderlineStr(this.loop_rank),GameCommon.getInstance().addUnderlineStr(this.award_btn),GameCommon.getInstance().addUnderlineStr(this.cangku_btn),this.setTitle("仙盟战"),e.prototype.onInit.call(this),this.onRefresh(),this.mini_explain_label.text=Language.instance.getText("unionbattle_explain2");for(var t=GameCommon.getInstance().onParseAwardItemstr("3,48,1#2,152,1#3,49,1#3,83,20#3,76,5"),n=0;n<t.length;n++){var a=GameCommon.getInstance().createGoodsIntance(t[n]);this.zhizun_awd_grp.addChild(a)}this.basic2.closeBtn2.visible=!1,this.basic2.label_title.text="至尊奖励",this.zhizun_explain_layer.visible=!0},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closebtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHideZhizunLayer,this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHideZhizunLayer,this),this.btn_join.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoinBattle,this),this.award_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdView,this),this.cangku_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenDepotView,this),this.loop_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRankView,this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE.toString(),this.onResUnionBattleGroup,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this);for(var t=0;t<this.roundMax;t++)for(var n=Math.pow(2,this.roundMax-t),a=0;n>a;a++){var i=Tool.toInt(a/2),o=this["round"+t+"_witnessbtn"+i];o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onWitnessBattle,this)}this.onReqUnionBattleGroup()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closebtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHideZhizunLayer,this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHideZhizunLayer,this),this.btn_join.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onJoinBattle,this),this.award_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAwdView,this),this.cangku_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenDepotView,this),this.loop_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenRankView,this),this.explainLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE.toString(),this.onResUnionBattleGroup,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_LIST_MESSAGE.toString(),this.onResUnionListMsg,this);for(var t=0;t<this.roundMax;t++)for(var n=Math.pow(2,this.roundMax-t),a=0;n>a;a++){var i=Tool.toInt(a/2),o=this["round"+t+"_witnessbtn"+i];o.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onWitnessBattle,this)}this.examineCD(!1)},t.prototype.onHideZhizunLayer=function(){this.zhizun_explain_layer.visible=!1},t.prototype.onReqUnionListMsg=function(e){var t=new Message(MESSAGE_ID.UNION_LIST_MESSAGE);t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)},t.prototype.onReqUnionBattleGroup=function(){this.timedown_label.text="",this.examineCD(!1);var e=new Message(MESSAGE_ID.UNION_BATTLE_GROUPINFO_MESSAGE);e.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionBattleGroup=function(){if(this.battleInfo.state==UNIONBATTLE_STATE.NOT?this.time_desc_label.text=Language.instance.getText("unionbattle_NOT_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.READY?this.time_desc_label.text=Language.instance.getText("unionbattle_READY_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.FIGHT?this.time_desc_label.text=Language.instance.getText("unionbattle_FIGHT_timedesc"):this.battleInfo.state==UNIONBATTLE_STATE.RESULT&&(this.time_desc_label.text=Language.instance.getText("unionbattle_RESULT_timedesc")),this.battleInfo.state==UNIONBATTLE_STATE.FIGHT?(this.examineCD(!1),this.timedown_label.text=""):this.examineCD(!0),this.btn_join.visible=this.battleInfo.canJoin&&this.battleInfo.state==UNIONBATTLE_STATE.FIGHT,this.battleInfo.joinUnions.length>0)for(var e=0,t=0;t<=this.roundMax;t++){for(var n=[],a=0;a<this.battleInfo.joinUnions.length;a++){var i=this.battleInfo.joinUnions[a];i.roundCount>e&&n.push(i)}this.onRefreshGroupInfo(n,e),e++}else{var o=new Message(MESSAGE_ID.UNION_LIST_MESSAGE);o.setShort(1),GameCommon.getInstance().sendMsgToServer(o)}},t.prototype.onResUnionListMsg=function(){if(this.battleInfo.state==UNIONBATTLE_STATE.NOT){for(var e=[],t=!0,n=0;n<this.Groups_SortAry.length;n++){var a=this.Groups_SortAry[n]-1,i=DataManager.getInstance().unionManager.applyUnionList[a],o=null;t=n%2!=0||i?!0:!1,i?(o=new FightUnionInfo,o.name=i.name,o.badgesIndex=i.badgesIndex):!i&&t&&(o=new FightUnionInfo,o.name=""),o&&(o.roundCount=0,o.state=UNIONBATTLE_RESULT.UNRESULT),e.push(o)}for(var n=0;n<=this.roundMax;n++)0==n?this.onRefreshGroupInfo(e,n):this.onRefreshGroupInfo(null,n)}},t.prototype.onRefreshGroupInfo=function(e,t){for(var n=Math.pow(2,this.roundMax-t),a=[],i=0;n>i;i++){var o=this["round"+t+"_ubgroupbar"+i],r=e?e[i]:null;if(r?o.updateData(r,t):o.onReset(),o.setBadgesBg(),t>=this.roundMax)break;if(!a[Tool.toInt(i/2)]){var s=Tool.toInt(i/2),h=this["round"+t+"_line"+s],l=this["round"+t+"_witnessbtn"+s];if(l.visible=!1,!r){h.currentState="normal";continue}r.state==UNIONBATTLE_RESULT.WIN||r.roundCount-1>t?h.currentState=i%2==0?"left":"right":r.state==UNIONBATTLE_RESULT.LOSE?h.currentState=i%2==0?"right":"left":r.state==UNIONBATTLE_RESULT.UNRESULT&&(h.currentState="normal",this.battleInfo.canJoin||this.battleInfo.state!=UNIONBATTLE_STATE.FIGHT||(l.visible=!0,l.name=r.unionId+"")),a[Tool.toInt(i/2)]=r.state}}},t.prototype.examineCD=function(e){this._timeOpen!=e&&(this._timeOpen=e,e?Tool.addTimer(this.onCountDown,this,1e3):Tool.removeTimer(this.onCountDown,this,1e3))},t.prototype.onCountDown=function(){var e=Math.ceil((this.battleInfo.timecount-egret.getTimer())/1e3);e>0||(e=0,this.examineCD(!1),this.onReqUnionBattleGroup()),this.timedown_label.text=GameCommon.getInstance().getTimeStrForSec1(e)},Object.defineProperty(t.prototype,"battleInfo",{get:function(){return DataManager.getInstance().unionManager.unionbattleInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roundMax",{get:function(){return Math.round(Math.sqrt(UnionDefine.Union_Battle_JoinMax))},enumerable:!0,configurable:!0}),t.prototype.onOpenAwdView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionBattleAwdPanel")},t.prototype.onJoinBattle=function(){GameFight.getInstance().onSendUnionBattleFightMsg(this.battleInfo.myUnionFightInfo.unionId)},t.prototype.onWitnessBattle=function(e){var t=parseInt(e.currentTarget.name);GameFight.getInstance().onSendUnionBattleFightMsg(t)},t.prototype.onOpenDepotView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionBattleWarehousePanel")},t.prototype.onOpenRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionRankView",UNIONBATTLE_RANKTYPE.UNION_BALLTE))},t.prototype.onOpenSingleRankView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionBattleRankPanel",UNIONBATTLE_RANKTYPE.UNION_SINGLE))},t.prototype.onTouchBack=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"UnionMainCityPanel")},t.prototype.onTouchExplain=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",GameCommon.getInstance().readStringToHtml(Language.instance.getText("unionbattle_explain"))))},t.prototype.onTouchCloseBtn=function(){e.prototype.onTouchCloseBtn.call(this),this.onTouchBack()},t}(BaseWindowPanel);__reflect(UnionBattleGroupView.prototype,"UnionBattleGroupView");var UnionBattleGroupBar=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.updateData=function(e,t){if(this.animGrp.removeChildren(),e)if(e.name){this.union_name_label.textColor=16777215,this.union_name_label.text=GameCommon.getInstance().getOutServerName(e.name),this.fail_img.visible=e.state==UNIONBATTLE_RESULT.LOSE&&e.roundCount-1<=t;var n=Tool.toInt(e.badgesIndex/UnionDefine.Union_Badges_ColorNum)+1;this.badges_bg.source="union_badges_bg"+n+"_png";var a=e.badgesIndex%UnionDefine.Union_Badges_IconNum+1;this.badges_icon.source="union_badges_icon"+a+"_png",e.name==DataManager.getInstance().unionManager.unionInfo.info.name&&GameCommon.getInstance().addAnimation("xianmengqizhi",null,this.animGrp,-1)}else this.onNullHandler();else this.onReset()},t.prototype.onNullHandler=function(){this.fail_img.visible=!0,this.badges_bg.source="union_badges_bg1_png",this.badges_icon.source="",this.union_name_label.textColor=16776960,this.union_name_label.text=Language.instance.getText("lunkong")},t.prototype.onReset=function(){this.fail_img.visible=!1,this.badges_bg.source="union_badges_bg1_png",this.badges_icon.source="",this.union_name_label.text=""},t.prototype.setBadgesBg=function(e){void 0===e&&(e=!1),this.badges_bg.visible=e},t}(eui.Component);__reflect(UnionBattleGroupBar.prototype,"UnionBattleGroupBar");var UnionBattleGroupLine=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.BattleGroupLineSkin,t}return __extends(t,e),t}(eui.Component);__reflect(UnionBattleGroupLine.prototype,"UnionBattleGroupLine");var UnionBattleMemberCangKuPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh(),this.setTitle("unionck_png")},t.prototype.onShowWithParam=function(e){this.allotParam=e,this.onShow()},t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleAllotBarSkin},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.onUpdate()},t.prototype.onUpdate=function(){this.onReqMemberListMsg()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this),this.onCleanMemberList()},t.prototype.onReqMemberListMsg=function(){DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.onResUnionDepotInfoMsg=function(){for(var e=DataManager.getInstance().unionManager.unionbattleInfo,t=0;t<e.depotThings.length;t++)e.depotThings[t].id==this.allotParam.awardItem.id&&(this.allotParam.awardItem.num=e.depotThings[t].num,this.onReqMemberListMsg())},t.prototype.onResMemberListMsg=function(){this.onCleanMemberList();for(var e=new Array,t=DataManager.getInstance().unionManager.unionInfo,n=0;n<t.unionMemberList.length;n++){var a=t.unionMemberList[n];e.push(a);var i=new UnionBattleHead;i.onUpdate(this.allotParam.awardItem,a,this.models),this.member_list.addChild(i)}},Object.defineProperty(t.prototype,"models",{get:function(){if(!this.rewardMaxArr){var e=JsonModelManager.instance.getModelguildreward()[1];this.rewardMaxArr=GameCommon.getInstance().onParseAwardItemstr(e.max)}return this.rewardMaxArr},enumerable:!0,configurable:!0}),t.prototype.onCleanMemberList=function(){if(this.member_list.numChildren>0)for(var e=this.member_list.numChildren-1;e>=0;e--){var t=this.member_list.getChildAt(e);t&&this.member_list.removeChild(t)}},t}(BaseWindowPanel);__reflect(UnionBattleMemberCangKuPanel.prototype,"UnionBattleMemberCangKuPanel");var UnionBattleHead=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.skinName=skins.UnionBattleHeadSkin,t}return __extends(t,e),t.prototype.dataChanged=function(){},t.prototype.onUpdate=function(e,t,n){this.awardItem=e,this.awardMax=n,this.memberInfo=t;DataManager.getInstance().unionManager.unionInfo;this.playerHead.setHead(t.playerdata.headindex,t.playerdata.headFrame),t.playerdata.rebirthLv>1?this.userName.text=GameCommon.getInstance().getOutServerName(t.playerdata.name)+"  "+t.playerdata.rebirthLv+"阶"+t.playerdata.level+"级":this.userName.text=GameCommon.getInstance().getOutServerName(t.playerdata.name)+"  "+t.playerdata.level+"级",this.userPower.text="战力"+t.playerdata.fightvalue,this.userGongXian.text="贡献"+t.donate,this.refresh()},t.prototype.onLoadComplete=function(){this.btn_fenpei.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.refresh()},t.prototype.onTouch=function(){for(var e=(new Array,DataManager.getInstance().unionManager.unionInfo),t=0;t<e.unionMemberList.length;t++){var n=e.unionMemberList[t];if(n.playerdata.id==this.memberInfo.playerdata.id){this.memberInfo=n;break}}for(var a=0,t=0;t<this.awardMax.length;t++)this.awardMax[t].id==this.awardItem.id&&(a=this.memberInfo.receiveSize>0&&this.memberInfo.receiveNum[this.awardItem.id]?this.awardMax[t].num-this.memberInfo.receiveNum[this.awardItem.id]:this.awardMax[t].num);GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionAllotAlertPanel",new UnionAllotParam(this.awardItem,this.memberInfo.playerdata,a)))},t.prototype.refresh=function(){},t}(eui.Component);__reflect(UnionBattleHead.prototype,"UnionBattleHead");var UnionAllotParam1=function(){function e(e){this.awardItem=e}return e}();__reflect(UnionAllotParam1.prototype,"UnionAllotParam1");var UnionBattleRankPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.Rank_TYPE=UNIONBATTLE_RANKTYPE.UNION_BALLTE,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleRankSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_RANK_MESSAGE.toString(),this.onResBaltteRankMsg,this)
},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_RANK_MESSAGE.toString(),this.onResBaltteRankMsg,this)},t.prototype.onInit=function(){this.itemGroup.itemRenderer=UnionBattleRankItem,this.itemGroup.itemRendererSkinName=skins.UnionBattleRankItemSkin,this.itemGroup.useVirtualLayout=!0,this.boss_scroll.viewport=this.itemGroup,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.onRequestRankInfoMsg(),this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_SINGLE?this.tabtitle_name_label.text="玩家名称":this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_BALLTE},t.prototype.onRequestRankInfoMsg=function(){if(this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_BALLTE){var e=new Message(MESSAGE_ID.UNION_BATTLE_RANK_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)}else this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_SINGLE&&GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResBaltteRankMsg=function(){if(this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_SINGLE){var e=DataManager.getInstance().unionManager.unionbattleInfo.singleRanks,t=e.shift();this.myrank_label.text="我的排名："+(t.rank>0?t.rank+"":"暂无"),this.mystar_count_label.text=""+t.starCount,this.my_score_label.text=GameCommon.getInstance().getFormatNumberShow(t.scoreCount),this.itemGroup.dataProvider=new eui.ArrayCollection(e)}else this.Rank_TYPE==UNIONBATTLE_RANKTYPE.UNION_BALLTE&&(this.itemGroup.dataProvider=new eui.ArrayCollection(DataManager.getInstance().unionManager.unionbattleInfo.rankDatas))},t.prototype.onShowWithParam=function(e){this.Rank_TYPE=e,this.onShow()},t}(BaseWindowPanel);__reflect(UnionBattleRankPanel.prototype,"UnionBattleRankPanel");var UnionBattleRankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;e.rank>3?this.rank_icon.visible=!1:(this.rank_icon.visible=!0,this.rank_icon.source="rank_itemtitle"+e.rank+"_png"),this.name_label.text=e.name,this.mystar_count_label.text=""+e.starCount,this.my_score_label.text=GameCommon.getInstance().getFormatNumberShow(e.scoreCount)},t}(eui.ItemRenderer);__reflect(UnionBattleRankItem.prototype,"UnionBattleRankItem");var UNIONBATTLE_RANKTYPE;!function(e){e[e.UNION_BALLTE=0]="UNION_BALLTE",e[e.UNION_SINGLE=1]="UNION_SINGLE"}(UNIONBATTLE_RANKTYPE||(UNIONBATTLE_RANKTYPE={}));var UnionBattleResultPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleWinSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this)},t.prototype.onShowWithParam=function(t){if(this.isloadComp){this.result_des_lab.text="",this.special_des_lab.text="";for(var n=this.award_groud.numChildren-1;n>=0;n--){var a=this.award_groud.getChildAt(n);egret.Tween.removeTweens(a),this.award_groud.removeChild(a),a=null}for(var n=this.special_awd_grp.numChildren-1;n>=0;n--){var a=this.special_awd_grp.getChildAt(n);egret.Tween.removeTweens(a),this.special_awd_grp.removeChild(a),a=null}}this.param=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameFight.getInstance().fightsceneTpye==FIGHT_SCENE.UNION_BATTLE&&GameFight.getInstance().fightScene.onQuitScene()},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.param.contiuneDesc?(this.currentState="contiune",this.labelAlert.text=this.param.contiuneDesc):(this.currentState="result",this.anim_grp1.x=550,this.anim_grp1.alpha=0,this.result_des_lab.textFlow=(new egret.HtmlTextParser).parser(this.param.resultParam),egret.Tween.get(this.anim_grp1).to({x:90,alpha:1},1e3,egret.Ease.cubicIn),this.anim_grp2.x=550,this.anim_grp2.alpha=0,egret.Tween.get(this.anim_grp2).to({x:550},500).to({x:90,alpha:1},1e3,egret.Ease.cubicIn).call(function(){this.param.awardList.length>0&&this.onPlayAwardAnim(this.param.awardList,this.award_groud)},this),this.anim_grp3.x=550,this.anim_grp3.alpha=0,egret.Tween.get(this.anim_grp3).to({x:550},1e3).to({x:90,alpha:1},1e3,egret.Ease.cubicIn).call(function(){this.param.specialAwdList&&this.onPlayAwardAnim(this.param.specialAwdList,this.special_awd_grp)},this)),this._showleftTime=11,Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.onPlayAwardAnim=function(e,t){for(var n=0;n<e.length;n++){var a=e[n],i=GameCommon.getInstance().createGoodsIntance(a),o=new eui.Group;o.width=90,o.height=110,o.addChild(i),i.y=200,i.alpha=0,t.addChild(o),egret.Tween.get(i).to({y:200},100*n).to({alpha:1,y:0},300,egret.Ease.sineInOut)}},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onTouchCloseBtn()):void(this.btn_sure.label=Language.instance.getText("sure")+("("+this._showleftTime+")"))},t}(BaseWindowPanel);__reflect(UnionBattleResultPanel.prototype,"UnionBattleResultPanel");var UnionBattleResultParam=function(){function e(){}return e}();__reflect(UnionBattleResultParam.prototype,"UnionBattleResultParam");var UnionBattleWarehousePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onInit=function(){this.cacheitemAry=[],e.prototype.onInit.call(this),this.onRefresh(),this.cangkuPanel.visible=!0,this.memberPanel.visible=!1},t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleWarehousePanelSkin},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.onUpdate()},t.prototype.onUpdate=function(){},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this),this.onReqUnionDepotInfoMsg()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this),this.onClearDepotList()},t.prototype.onReqUnionDepotInfoMsg=function(){this.onReqMemberListMsg();var e=new Message(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionDepotInfoMsg=function(){this.onClearDepotList();for(var e=DataManager.getInstance().unionManager.unionbattleInfo,t=0;t<e.depotThings.length;t++){var n=this.onCreateDepotItem();n.btn_fenpei.name=""+t,n.onUpdate(e.depotThings[t]),this.depot_list.addChild(n),this.getAuthority()?(n.btn_fenpei.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAllotBar,this),GameCommon.getInstance().onButtonEnable(n.btn_fenpei,!0)):GameCommon.getInstance().onButtonEnable(n.btn_fenpei,!1)}},t.prototype.onCreateDepotItem=function(){return this.cacheitemAry.length>0?this.cacheitemAry.shift():new UnionBattleWarehouseItem},t.prototype.onClearDepotList=function(){if(this.depot_list.numChildren>0)for(var e=this.depot_list.numChildren-1;e>=0;e--){var t=this.depot_list.getChildAt(e);t&&(t.btn_fenpei.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAllotBar,this),this.depot_list.removeChild(t),this.cacheitemAry.indexOf(t)<0&&this.cacheitemAry.push(t))}},t.prototype.onShowAllotBar=function(e){var t=parseInt(e.currentTarget.name);this.currSelectIndex=t;var n=this.depot_list.getChildAt(this.currSelectIndex);n&&(this.currSelectIndex=null),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("UnionBattleMemberCangKuPanel",new UnionAllotParam1(n.awardItem)))},t.prototype.onReqMemberListMsg=function(){DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG:!1},t.prototype.getStyle=function(){return"bg_style1"},t}(BaseWindowPanel);__reflect(UnionBattleWarehousePanel.prototype,"UnionBattleWarehousePanel");var UnionBattleWarehouseItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.UnionBattleWarehouseItemSkin,t}return __extends(t,e),t.prototype.onUpdate=function(e){this.awardItem=e;var t=GameCommon.getInstance().getThingModel(e.type,e.id,e.quality);t&&(this.desc.text=t.des),this.goods.onUpdate(e.type,e.id,0,e.quality,e.num)},t}(eui.Component);__reflect(UnionBattleWarehouseItem.prototype,"UnionBattleWarehouseItem");var UnionDepotView=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.UnionBattleDepotSkin},t.prototype.onInit=function(){this.cacheitemAry=[],this.allotBar=new UnionDepotAllotBar1,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),this.onReqUnionDepotInfoMsg()},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE.toString(),this.onResUnionDepotInfoMsg,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.UNION_MEMBER_LIST_MESSAGE.toString(),this.onResMemberListMsg,this),this.onClearDepotList(),this.allotBar.onHide()},t.prototype.onReqUnionDepotInfoMsg=function(){var e=new Message(MESSAGE_ID.UNION_BATTLE_DEPOT_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResUnionDepotInfoMsg=function(){this.onClearDepotList();for(var e=DataManager.getInstance().unionManager.unionbattleInfo,t=JsonModelManager.instance.getModelguildspecialreward().reward,n=0;n<t.length;n++){var a=new UnionBattleWarehouseItem,i=t[n];this.getAuthority()&&(a.btn_fenpei.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAllotBar,this),GameCommon.getInstance().onButtonEnable(a.btn_fenpei,!0)),a.onUpdate(i),this.depot_list.addChild(a)}for(var n=0;n<e.depotThings.length;n++){var o=this.onCreateDepotItem();o.allot_btn.name=""+n,o.update(e.depotThings[n]),this.depot_list.addChild(o),this.getAuthority()?(o.allot_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAllotBar,this),GameCommon.getInstance().onButtonEnable(o.allot_btn,!0)):GameCommon.getInstance().onButtonEnable(o.allot_btn,!1)}},t.prototype.onCreateDepotItem=function(){return this.cacheitemAry.length>0?this.cacheitemAry.shift():new UnionDepotItem},t.prototype.onClearDepotList=function(){},t.prototype.onShowAllotBar=function(e){var t=parseInt(e.currentTarget.name);this.currSelectIndex=t,this.onReqMemberListMsg()},t.prototype.onReqMemberListMsg=function(){DataManager.getInstance().unionManager.onReqUnionMember()},t.prototype.onResMemberListMsg=function(){var e=this.depot_list.getChildAt(this.currSelectIndex);e&&(this.allotBar.onShow(e),this.currSelectIndex>2&&(this.list_scroll.stopAnimation(),this.list_scroll.viewport.scrollV=140*this.currSelectIndex),this.currSelectIndex=null)},t.prototype.getAuthority=function(){var e=DataManager.getInstance().unionManager.unionInfo.selfData;return e?e.postion==UNION_POSTION.WANG||e.postion==UNION_POSTION.FUBANG:!1},t.prototype.getStyle=function(){return"bg_style1"},t}(BaseTabView);__reflect(UnionDepotView.prototype,"UnionDepotView");var UnionDepotItem=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.UnionBattleDepotItemSkin,t}return __extends(t,e),t.prototype.update=function(e){this.awardItem=e,this.goodsitem.onUpdate(e.type,e.id,0,e.quality,e.num,e.lv),this.name_label.textFlow=new Array({text:this.goodsitem.model.name,style:{textColor:GameCommon.getInstance().CreateNameColer(this.goodsitem.model.quality)}}),this.num_label.text=""+e.num},t.prototype.onShowAllotBar=function(e){this.allot_grp.addChild(e)},t}(eui.Component);__reflect(UnionDepotItem.prototype,"UnionDepotItem");var UnionDepotAllotBar1=function(e){function t(){var t=e.call(this)||this;return t.isHide=!0,t.skinName=skins.UnionBattleAllotBarSkin,t}return __extends(t,e),t.prototype.onShow=function(e){this.depotItem=e,this.isHide||this.onHide(),e.onShowAllotBar(this),this.shrink_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this);var t=DataManager.getInstance().unionManager.unionInfo;this.memberItems=[];for(var n=0;n<t.unionMemberList.length;n++){var a=t.unionMemberList[n],i=new eui.Component;i.skinName=skins.HeadIconItemSkin,i.member_data=a,i.head_icon.source=GameCommon.getInstance().getBigHeadByOccpation(a.playerdata.headindex),i.head_frame.source=GameCommon.getInstance().getHeadFrameByIndex(a.playerdata.headFrame),i.name_label.text=GameCommon.getInstance().getOutServerName(a.playerdata.name),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAllotAlert,this),this.memberItems.push(i),this.member_list.addChild(i)}this.isHide=!1},t.prototype.onHide=function(){if(this.parent&&this.parent.removeChild(this),this.shrink_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.memberItems){for(var e=this.memberItems.length-1;e>=0;e--){var t=this.memberItems[e];t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenAllotAlert,this),t.parent&&t.parent.removeChild(t),this.memberItems.splice(e,1)}this.memberItems=null}this.isHide=!0},t.prototype.onOpenAllotAlert=function(e){e.currentTarget.member_data},t}(eui.Component);__reflect(UnionDepotAllotBar1.prototype,"UnionDepotAllotBar1");var UnionInspirePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.inspireCount=0,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.LadderInspireSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=GameCommon.getInstance().readStringToHtml("[#5aff91"+20*this.inspireCount+"%]");if(this.add_desc_lab.textFlow=(new egret.HtmlTextParser).parse(Language.instance.parseInsertText("unionbattle_insprite",e)),this.times_lab.text=Language.instance.getText("current","yiguwu")+":"+this.inspireCount+"/"+UnionDefine.UNIONBATTLE_BUFF_MAX,this.inspireCount<UnionDefine.UNIONBATTLE_BUFF_MAX){var t=Constant.get(Constant.GANG_WAR_BUFF_DIAMOND_COST);this.costGold=parseInt(t),this.buy_button.label=Language.instance.getText("inspire"," ",this.costGold,"currency5"),this.buy_button.enabled=!0}else this.buy_button.label=Language.instance.getText("error_tips_7"),this.buy_button.enabled=!1},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.closeBtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.buy_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.closeBtn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCloseBtn,this),this.buy_button.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInspire,this)},t.prototype.onInspire=function(){var e=new Message(MESSAGE_ID.UNION_BATTLE_BUYBUFF_MESSAGE);GameCommon.getInstance().sendMsgToServer(e),this.onTouchCloseBtn()},t.prototype.onShowWithParam=function(e){this.inspireCount=e,this.onShow()},t}(BaseWindowPanel);__reflect(UnionInspirePanel.prototype,"UnionInspirePanel");var MysteriousBossSummonPannel=function(e){function t(t){var n=e.call(this,t)||this;return n.tab_now=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.MysteriousBossPannelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var t=JsonModelManager.instance.getModelzhaohuanboss()[0];this.bossAnim=GameCommon.getInstance().getMonsterBody(this.bossAnim,t.modelId),this.bossAnim.parent||this.boss_avatar_grp.addChild(this.bossAnim),this.boss_cover.source=t.uncall;var n=GameCommon.getInstance().onParseAwardItemstr(t.yulan);this.reward_grp.removeChildren();for(var a=0;a<n.length;a++){var i=n[a],o=GameCommon.getInstance().createGoodsIntance(i);this.reward_grp.addChild(o)}this.intervalId&&egret.clearTimeout(this.intervalId),GameCommon.getInstance().addUnderlineStr(this.loop_award_label);var r=new Message(MESSAGE_ID.MYSTERIOUS_BOSS_INFO);r.setBoolean(!1),GameCommon.getInstance().sendMsgToServer(r),e.prototype.onRefresh.call(this)},t.prototype.onUpdateServerInfo=function(){this.countDown=DataManager.getInstance().unionManager.countDown+1e3,this.durationTime=DataManager.getInstance().unionManager.durTime+1e3,this.updateTimeLabel()},t.prototype.updateTimeLabel=function(){var e=(JsonModelManager.instance.getModelzhaohuanboss()[0],DataManager.getInstance().unionManager.isMSBReward),t=DataManager.getInstance().unionManager.isOldBig;this.countDown=this.countDown-1e3,this.durationTime=this.durationTime-1e3,this.time_label.textColor=1899525,this.time_label.text="",this.countDown<=0?(this.open_time_lab.text="神秘boss已经可以召唤",this.summon_btn.label="召 唤",this.summon_btn.enabled=t,this.boss_cover.visible=!0,this.boss_avatar_grp.visible=!1):(this.open_time_lab.text=GameCommon.getInstance().getTimeStrForSec1(this.countDown/1e3,2)+"后可以召唤",this.durationTime<=0?this.bossBEKilled(!0):this.bossBEKilled(e),this.intervalId=Tool.callbackTime(this.updateTimeLabel,this,1e3))},t.prototype.bossBEKilled=function(e){if(e)this.summon_btn.label="等待召唤",this.summon_btn.enabled=!1,this.boss_cover.visible=!0,this.boss_avatar_grp.visible=!1;else{if(this.summon_btn.label="挑 战",this.summon_btn.enabled=!0,this.boss_cover.visible=!1,this.open_time_lab.text="正在挑战中：",this.durationTime<6e4&&(this.time_label.textColor=16711680),this.time_label.text=GameCommon.getInstance().getTimeStrForSec1(this.durationTime/1e3,2),!this.boss_avatar_grp.visible){var t=new egret.Point(0,0);this.boss_avatar_grp.visible=!0,GameCommon.getInstance().addAnimation("qihunshengji",t,this.boss_avatar_grp)}DataManager.getInstance().dupManager.mysteriousData.rebornLefttime>0&&(this.rebornlefttime=DataManager.getInstance().dupManager.mysteriousData.rebornLefttime,this.rebornTimeDown())}},t.prototype.onRegist=function(){this.loop_award_label.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToRewards,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_INFO.toString(),this.onUpdateServerInfo,this),this.summon_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){this.loop_award_label.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpToRewards,this),this.summon_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.MYSTERIOUS_BOSS_INFO.toString(),this.onUpdateServerInfo,this),e.prototype.onRemove.call(this)},t.prototype.jumpToRewards=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"MysteriousRewardsPanel")},t.prototype.rebornTimeDown=function(){0==this.rebornlefttime?(this.summon_btn.label=Language.instance.getText("challenge"),Tool.removeTimer(this.rebornTimeDown,this,1e3)):(this.summon_btn.label=Language.instance.getText("reborn")+"("+this.rebornlefttime+"s)",this.rebornlefttime--)},t.prototype.onClick=function(e){var t=e.currentTarget;if("召 唤"==t.label){var n=new Message(MESSAGE_ID.MYSTERIOUS_BOSS_INFO);n.setBoolean(!0),GameCommon.getInstance().sendMsgToServer(n)}else if("挑 战"==t.label){if(this.touchTime>egret.getTimer())return void GameCommon.getInstance().addAlert("error_tips_78");this.touchTime=egret.getTimer()+2e3,GameFight.getInstance().onEnterMysteriousBossScene()}else if("等待召唤"==t.label);else if(this.rebornlefttime>0)return void GameFight.getInstance().onMyBossFightReborn()},t}(BaseTabView);__reflect(MysteriousBossSummonPannel.prototype,"MysteriousBossSummonPannel");var MysteriousRewardsPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.reward_keys=["firstReward","secondReward","Reward345","canyuReward","killReward"],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.SamsaraAwdViewSkin},t.prototype.onInit=function(){this.setTitle("奖励"),this.bossReawards=JsonModelManager.instance.getModelzhaohuanrewards(),this.award_groups=[],this.items=[];for(var e=0;5>e;++e)this.award_groups[e]=this["award_group"+e],this.items[e]=this["item_"+e];this.tabBtns=[];for(var t=["成功奖励","失败奖励"],e=0;4>e;++e)this.tabBtns[e]=this["tab"+e],this.tabBtns[e].value=e,t[e]?this.tabBtns[e].tab_name.text=t[e]:this.tabBtns[e].visible=!1;this.currIndex=0,this.updateUI()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var t=0;t<this.tabBtns.length;t++)this.tabBtns[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this);for(var t=0;t<this.tabBtns.length;t++)this.tabBtns[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTabBtn,this)},t.prototype.onTouchTabBtn=function(e){var t=e.currentTarget;t.value!=this.currIndex&&(this.currIndex=t.value,this.updateUI())},t.prototype.updateTabs=function(){for(var e=0;e<this.tabBtns.length;e++)this.tabBtns[e].selected=e==this.currIndex},t.prototype.updateUI=function(){this.updateTabs();for(var e=this.bossReawards[this.currIndex],t=0;t<this.reward_keys.length;t++){var n=this.reward_keys[t],a=GameCommon.getInstance().onParseAwardItemstr(e[n]);if(a){for(var i=Math.max(this.award_groups[t].numChildren,a.length),o=0;i>o;o++){this.award_groups[t].numChildren<=o&&this.award_groups[t].addChild(new GoodsInstance);var r=this.award_groups[t].getChildAt(o);if(a.length>o){var s=a[o];r.onUpdate(s.type,s.id,0,s.quality,s.num),r.visible=!0}else r.visible=!1}this.items[t].visible=!0}else this.items[t].visible=!1}},t}(BaseWindowPanel);__reflect(MysteriousRewardsPanel.prototype,"MysteriousRewardsPanel");var WaitLoadingPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.WaitLoadingPanel,t}return __extends(t,e),t.prototype.resetPanel=function(e,t){this.width=e,this.height=t},t.prototype.loadStart=function(){this.isLoading||(this.isLoading=!0,this.visible=!0,this.start())},t.prototype.loadClose=function(){this.visible=!1,this.isLoading=!1,this.stop()},t.prototype.start=function(){var e=this.imgLoading;e.rotation=0;var t=egret.Tween.get(e,{loop:!0});t.to({rotation:360},3600),t.call(function(){e.rotation=0},this)},t.prototype.stop=function(){egret.Tween.removeTweens(this.imgLoading)},t}(eui.Component);__reflect(WaitLoadingPanel.prototype,"WaitLoadingPanel");var WuTanAlertBuy=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuTanAlertBuySkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("武坛"),this.onRefresh()},t.prototype.onRefresh=function(){var e=this.param.param,t=e.getModel();this.exp_lab.text=WuTanManager.fontExp+"："+WuTanManager.getValueExp(t)+"/分钟",this.zhangong_lab.text=WuTanManager.fontGas+"："+WuTanManager.getValueGas(t)+"/分钟";var n=e.getRewardBox();n?this.good.onUpdate(n.type,n.id,n.uid,n.quality,n.num):this.good.visible=this.lbAlert.visible=!1;for(var a=e.getModel().costList,i=0;i<a.length;++i)this["cost_num_lab"+i]&&(this["cost_num_lab"+i].text=""+a[i].num);this.costList=a},t.prototype.onEventOk=function(){WuTanManager.isCost(this.costList)&&(this.onEventBack(),egret.callLater(this.param.callback,this.param.target,this.param.param))},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t}(BaseWindowPanel);__reflect(WuTanAlertBuy.prototype,"WuTanAlertBuy");var WuTanAlertFight=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuTanAlertFightSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=this.param.param,t=e.getModel();this.exp_lab.text=WuTanManager.fontExp+"："+WuTanManager.getValueExp(t)+"/分钟",this.zhangong_lab.text=WuTanManager.fontGas+"："+WuTanManager.getValueGas(t)+"/分钟",this.my_head_img.setHead(),this.my_name_label.text=DataManager.getInstance().playerManager.player.name,this.my_fightvalue_label.text=DataManager.getInstance().playerManager.player.playerTotalPower.toString(),this.target_head_img.setHead(e.playerData.headindex,e.playerData.headFrame),this.target_name_label.text=e.playerData.name,this.target_fightvalue_label.text=e.playerData.fightvalue.toString();var n=e.getRewardBox();n?this.good.onUpdate(n.type,n.id,n.uid,n.quality,n.num):this.good.visible=this.lbAlert.visible=!1;for(var a=e.getModel().costList,i=0;i<a.length;++i)this["cost_num_lab"+i]&&(this["cost_num_lab"+i].text=""+a[i].num);this.costList=a},t.prototype.onEventOk=function(){WuTanManager.isCost(this.costList)&&(this.onEventBack(),egret.callLater(this.param.callback,this.param.target,this.param.param))},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnOk.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventOk,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t}(BaseWindowPanel);__reflect(WuTanAlertFight.prototype,"WuTanAlertFight");var WuTanAlertParam=function(){function e(e,t,n){void 0===n&&(n=null),this.callback=e,this.target=t,this.param=n}return e}();__reflect(WuTanAlertParam.prototype,"WuTanAlertParam");var WuTanAlertSelf=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuTanAlertSelfSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){var e=this.param.param;e.getModel();this.timeStart=e.timeStart,this.my_head_img.setHead(),this.my_name_label.text=DataManager.getInstance().playerManager.player.name,this.my_fightvalue_label.text=DataManager.getInstance().playerManager.player.playerTotalPower.toString();var t=e.getRewardBox();t?this.good.onUpdate(t.type,t.id,t.uid,t.quality,t.num):this.good.visible=this.lbAlert.visible=!1},t.prototype.onShowWithParam=function(e){this.param=e,this.onShow()},t.prototype.onEventBack=function(){this.onHide()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onEventBack,this),this.examineCD()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.examineCD(!1),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onEventBack,this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventBack,this)},t.prototype.examineCD=function(e){void 0===e&&(e=!0),e?Tool.addTimer(this.updateTime,this,1e3):Tool.removeTimer(this.updateTime,this,1e3)},t.prototype.updateTime=function(){var e=Math.min(Tool.getCurrTime()-this.timeStart,432e5);this.lbTime.text=Tool.getTimeStr(e/1e3)},t}(BaseWindowPanel);__reflect(WuTanAlertSelf.prototype,"WuTanAlertSelf");var WuTanManager=function(){function e(){this.isWuTan=!0,this.myType=0,this.myIdx=0}return e.prototype.sendInfoMessage=function(){var e=new Message(MESSAGE_ID.WUTAN_INFO_GET_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseInfo=function(e){var t=e.getByte();this.numberList=[];for(var n=0;t>n;++n)this.numberList[n]=e.getInt();GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.sendListRefresh=function(){this.sendListMessage(this.type,0,3)},e.prototype.sendListMessage=function(e,t,n){this.type=e;var a=new Message(MESSAGE_ID.WUTAN_LIST_GET_MESSAGE);a.setShort(e),a.setInt(t),a.setInt(n),GameCommon.getInstance().sendMsgToServer(a)},e.prototype.parseList=function(e){var t=new WuTanResponseInfo;t.parseMsg(e),GameCommon.getInstance().receiveMsgToClient(e,t)},e.prototype.sendBuyMessage=function(e,t){this.type=e;var n=new Message(MESSAGE_ID.WUTAN_BUY_MESSAGE);n.setShort(e),n.setShort(t),GameCommon.getInstance().sendMsgToServer(n)},e.prototype.parseBuy=function(e){var t=e.getByte();t&&(this.setWuTanUp(),this.sendListRefresh(),this.sendInfoMessage())},e.prototype.setWuTanUp=function(){this.isWuTan=!0},e.prototype.parseRefresh=function(e){this.setMyType(e.getShort(),e.getShort())},e.prototype.setMyType=function(e,t){this.isWuTan=0!=e,this.myType!=e&&(this.myType=e,this.myIdx=t,GameCommon.getInstance().onDispatchEvent(MESSAGE_ID.WUTAN_HEART_MESSAGE))},e.prototype.setFightData=function(e,t){this.fightType=e,this.fightIdx=t},e.prototype.clearFightData=function(){this.fightType=this.fightIdx=-1},e.prototype.checkRedPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_WUTAN)?!this.isWuTan:!1},e.prototype.checkRedPointItem=function(e){return!this.isWuTan&&this.numberList?this.numberList[e]<this.getModel(e+1,4).num+3:!1},e.isCost=function(e){if(e)for(var t=0;t<e.length;++t)if(!GameCommon.getInstance().onCheckItemConsume(e[t].id,e[t].num,e[t].type))return!1;return!0},e.prototype.getModel=function(e,t){var n=JsonModelManager.instance.getModelwutan();for(var a in n){var i=n[a];if(i.type==e&&i.weizhi==t)return i}return null},e.getValueExp=function(e){return e.exp},e.getValueGas=function(e){return DataManager.getInstance().pvpManager.getCostZhanGong(e.rewards)},e.getValue=function(e){var t=e.split(",");return parseInt(t[2])},e.wutanCount=5,e.fontExp="经验",e.fontGas="战功",e}();__reflect(WuTanManager.prototype,"WuTanManager");var WuTanPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuTanPanelSkin},t.prototype.onInit=function(){this.wutanManager=DataManager.getInstance().wuTanManager,e.prototype.onInit.call(this),this.initUI(),this.onTouchExplain()},t.prototype.initUI=function(){this.actionTop=[],this.buildList=[],this.lbInfos=[],this.groupNameBGs=[];for(var e=0;e<WuTanManager.wutanCount;++e){this.lbInfos[e]=this["lbInfo"+e],this.groupNameBGs[e]=this["groupNameBG"+e];var t=this["group"+e];t.touchChildren=!1,t.touchEnabled=!0,t.name=e.toString(),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventTan,this),this.buildList[e]=this["imgBuild"+e],this.actionTop[e]=this.buildList[e].y-20;this.wutanManager.getModel(e+1,1);this.lbInfos[e].text="",this.initRed(this["groupRed"+e],new egret.Point(48,0),e)}},t.prototype.initRed=function(e,t,n){var a=new redPoint;a.register(e,t,this.wutanManager,"checkRedPointItem",n),this.points.push(a)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btnLeft.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLeft,this),this.btnRight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventRight,this),this.explainLayer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUTAN_INFO_GET_MESSAGE.toString(),this.onCallInfo,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onCallRefresh,this),this.actionLogoShow();
for(var t=0;t<WuTanManager.wutanCount;++t)this.lbInfos[t].text="";this.wutanManager.sendInfoMessage(),this.checkAutoUI()},t.prototype.checkAutoUI=function(){this.wutanManager.fightType>0&&this.openWuTan(this.wutanManager.fightType-1),this.wutanManager.clearFightData()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnLeft.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLeft,this),this.btnRight.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventRight,this),this.explainLayer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchExplain,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUTAN_INFO_GET_MESSAGE.toString(),this.onCallInfo,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onCallRefresh,this),this.actionLogoClose()},t.prototype.actionLogoShow=function(){for(var e=30,t=0;t<this.buildList.length;++t){var n=5e3+Tool.randomInt(-300,300),a=Tool.randomInt(0,100)/100;this.buildList[t].y=this.actionTop[t]+e*a;var i=egret.Tween.get(this.buildList[t],{loop:!0});i.to({y:this.actionTop[t]},n*a),i.to({y:this.actionTop[t]+e},n),i.to({y:this.actionTop[t]+e*a},n*(1-a))}},t.prototype.actionLogoClose=function(){for(var e=0;e<this.buildList.length;++e)egret.Tween.removeTweens(this.buildList[e])},t.prototype.onCallRefresh=function(){this.wutanManager.sendInfoMessage()},t.prototype.onCallInfo=function(){for(var e=this.wutanManager.numberList,t=0;t<WuTanManager.wutanCount;++t){var n=this.wutanManager.getModel(t+1,4),a=n.num+3;this.lbInfos[t].text="剩余"+(a-e[t])+"/"+a+"位置",this.groupNameBGs[t].source=this.wutanManager.myType==t+1?"samsara_item_title_bg_png":"samsara_item_title_bg_gray_png"}},t.prototype.onTouchExplain=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("ExplainPanel",Language.instance.getText("wutan_jieshao")))},t.prototype.onEventTan=function(e){this.openWuTan(parseInt(e.target.name))},t.prototype.openWuTan=function(e){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("WuTanPanel2",e))},t.prototype.onEventLeft=function(){},t.prototype.onEventRight=function(){},t}(BaseTabView);__reflect(WuTanPanel.prototype,"WuTanPanel");var WuTanPanel2=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.WuTanPanel2Skin},t.prototype.onShowWithParam=function(e){this.type=e+1,this.onShow()},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("武坛"),this.initUI()},t.prototype.initUI=function(){this.wutanManager=DataManager.getInstance().wuTanManager,this.itemTops=[];for(var e=0;3>e;e++)this.itemTops[e]=this["topitem"+e],this.itemTops[e].name=e.toString(),this.itemTops[e].touchChildren=!1,this.itemTops[e].touchEnabled=!0,this.itemTops[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventTop,this);this.itemDowns=[];for(var e=0;e<t.pageNum;e++)this.itemDowns[e]=new WuTanItemDown(this),this.groupScroller.addChild(this.itemDowns[e]),this.itemDowns[e].update(null)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this);for(var n=0;n<t.pageNum;n++)this.itemDowns[n].update(null);this.btnLeft.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLeft,this),this.btnRight.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventRight,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUTAN_LIST_GET_MESSAGE.toString(),this.onCallList,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onCallRefresh,this);var a=this.wutanManager.getModel(this.type,4);this.lbTopMin1.text=WuTanManager.fontExp+"："+60*WuTanManager.getValueExp(a)+"/小时",this.lbTopMin2.text=WuTanManager.fontGas+"："+60*WuTanManager.getValueGas(a)+"/小时",this.pageMax=Math.floor(a.num/t.pageNum)+(a.num%t.pageNum>0?1:0),this.itemMax=a.num+3,this.currPage=0,this.sendPageReq()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnLeft.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventLeft,this),this.btnRight.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventRight,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUTAN_LIST_GET_MESSAGE.toString(),this.onCallList,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.WUTAN_HEART_MESSAGE.toString(),this.onCallRefresh,this)},t.prototype.sendPageReq=function(e){if(void 0===e&&(e=-1),0>e)this.wutanManager.sendListMessage(this.type,0,3);else{var n=e*t.pageNum+3,a=Math.min(this.itemMax-n,t.pageNum);this.wutanManager.sendListMessage(this.type,n,a)}},t.prototype.onCallRefresh=function(){this.sendPageReq()},t.prototype.onCallList=function(e){var n=e.message;if(this.type=n.type,n.isTop())for(var a=0;a<n.bodySize;++a)this.itemTops[a].update(n.bodyList[a]);else for(var a=0;a<t.pageNum;++a)n.bodyList[a]?(this.itemDowns[a].update(n.bodyList[a]),this.itemDowns[a].visible=!0):this.itemDowns[a].visible=!1;n.isTop()?this.sendPageReq(this.currPage):(this.currPage=Math.floor((n.startIdx-3)/t.pageNum),this.lbPage.text=this.currPage+1+"/"+this.pageMax)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onEventLeft=function(){this.currPage>0&&(--this.currPage,this.sendPageReq(this.currPage))},t.prototype.onEventRight=function(){this.currPage<this.pageMax-1&&(++this.currPage,this.sendPageReq(this.currPage))},t.prototype.onEventTop=function(e){var t=this.itemTops[parseInt(e.target.name)].data;this.onEventBody(t)},t.prototype.onEventBody=function(e){if(e){var t=null;t=e.isEmpty()?new WindowParam("WuTanAlertBuy",new WuTanAlertParam(this.onDealBuy,this,e)):e.isSelf()?new WindowParam("WuTanAlertSelf",new WuTanAlertParam(null,null,e)):new WindowParam("WuTanAlertFight",new WuTanAlertParam(this.onDealFight,this,e)),t&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),t)}else egret.log("onEventBody - null")},t.prototype.onDealBuy=function(e){this.wutanManager.sendBuyMessage(this.type,e.towerIdx)},t.prototype.onDealFight=function(e){this.wutanManager.setFightData(this.type,e.towerIdx),GameFight.getInstance().onEnterWuTanScene(this.type,e.towerIdx,e.playerData.id)},t.pageNum=6,t}(BaseWindowPanel);__reflect(WuTanPanel2.prototype,"WuTanPanel2");var WuTanItemTop=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onInit,t),t}return __extends(t,e),t.prototype.onInit=function(){},t.prototype.update=function(e){if(this.data=e,null==e||e.isEmpty())this.currentState="DEFAULT";else{this.currentState="INFO",this.name_lab.text=e.playerData.name,this.power_lab.text=""+e.playerData.fightvalue,this.roleAppear||(this.roleAppear=new RoleAppearBody,this.roleGroup.addChild(this.roleAppear));for(var t=[],n=0;n<BLESS_TYPE.SIZE;n++)t[n]=e.showAppear.appears[n];this.roleAppear.updateAvatarAnim(t,e.showAppear.sex),this.exp_lab.text="经验："+60*WuTanManager.getValueExp(e.getModel())+"/小时",this.zhangong_lab.text="战功："+60*WuTanManager.getValueGas(e.getModel())+"/小时"}},t}(eui.Component);__reflect(WuTanItemTop.prototype,"WuTanItemTop");var WuTanItemDown=function(e){function t(t){var n=e.call(this)||this;return n.wuTanPanel2=t,n.skinName=skins.WuTanItemSkin,n.groupBtn.touchChildren=!1,n.groupBtn.touchEnabled=!0,n.groupBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onEventTouch,n),n}return __extends(t,e),t.prototype.update=function(e){this.data=e,null==e||e.isEmpty()?(this.currentState="DEFAULT",this.imgHead.onClear()):(this.currentState="INFO",this.lbInfo.text=e.playerData.name,this.power_lb.text=""+e.playerData.fightvalue,this.imgHead.setHead(e.playerData.headindex,e.playerData.headFrame))},t.prototype.onEventTouch=function(){this.wuTanPanel2.onEventBody(this.data)},t}(eui.Component);__reflect(WuTanItemDown.prototype,"WuTanItemDown");var WuTanResponseInfo=function(){function e(){this.bodyList=[]}return e.prototype.parseMsg=function(e){try{this.type=e.getShort(),this.startIdx=e.getInt(),this.bodySize=e.getByte();for(var t=0;t<this.bodySize;++t)this.bodyList[t]||(this.bodyList[t]=new WuTanListbody),this.bodyList[t].parseMsg(this.type,e,this.startIdx+t,t,this.isTop())}catch(n){egret.error("WuTanResponseInfo - parseMsg - error")}},e.prototype.isTop=function(){return 0==this.startIdx},e}();__reflect(WuTanResponseInfo.prototype,"WuTanResponseInfo");var WuTanListbody=function(){function e(){}return e.prototype.parseMsg=function(e,t,n,a,i){this.type=e,this.towerIdx=n,this.posIdx=a,this.playerData=new SimplePlayerData,this.playerData.parseMsg(t);var o=(t.getInt(),t.getLong(),t.getInt(),t.getInt());this.timeStart=Tool.getCurrTime()-1e3*o,i&&!this.isEmpty()&&(this.showAppear=new AppearPlayerData,this.showAppear.parseMsg(t)),this.model=DataManager.getInstance().wuTanManager.getModel(this.type,Math.min(this.towerIdx+1,4)),this.isSelf()&&DataManager.getInstance().wuTanManager.setMyType(e,n)},e.prototype.isEmpty=function(){return 0==parseInt(this.playerData.id)},e.prototype.isSelf=function(){return DataManager.getInstance().playerManager.player.id==parseInt(this.playerData.id)},e.prototype.getModel=function(){return this.model},e.prototype.getRewardBox=function(){return GameCommon.parseAwardItem(this.model.boxRewards)},e}();__reflect(WuTanListbody.prototype,"WuTanListbody");var XianDanDupPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.startX=0,n.startY=0,n.isDrag=!0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XianDanDupPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this);var t=DataManager.getInstance().xiandanManager.allCfg;this.progress.minimum=0,this.progress.maximum=30,this.curDanLuProgress.slideDuration=0,this.caoYaoPro.visible=!1,this.curDanLuProgress.minimum=0,this.curGroup.visible=!1,this.btnPanels=[],this.btnListY=[];for(var n=0;6>n;++n){var a=n+1;this.btnPanels[n]=this["btnPanel"+a],this.btnListY[n]=this.btnPanels[n].y,t[n]?(this["lbTitle"+a].text=t[n].name,this.btnPanels[n].name=n.toString(),this.btnPanels[n].addEventListener(egret.TouchEvent.TOUCH_TAP,this.challengeDup,this)):this.btnPanels[n].visible=!1}this.onRefresh()},t.prototype.onRefresh=function(){this.onRefreshXianShan();var e=this.cupShanId,t=this.getPlayer().xianDanRolls,n=DataManager.getInstance().xiandanManager.allCfg;t[e]&&5>e&&t[e].chouquNum>=n[e].times*n[e].max&&(e+=1);var a=2410-this.scroller.height,i=0;switch(e){case 0:i=0;break;case 1:i=100;break;case 2:i=780;break;case 3:i=900;break;default:i=a}i=i>a?a:i,this.scroller.viewport.scrollV=i,this.curDanLuProgress.slideDuration=0,this.curGroup.parent!=this.btnPanels[this.cupShanId]&&(this.curGroup.parent.removeChild(this.curGroup),this.btnPanels[this.cupShanId].addChild(this.curGroup)),this.curGroup.x=this.btnPanels[this.cupShanId].width/2-100,this.curGroup.y=this.btnPanels[this.cupShanId].height-50,this.onRefreshenergy(),this.onRefreshBoss()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.bossBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBossView,this),this.btnchallenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBossView,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PILL_HIDE_BOSS_MESSAGE.toString(),this.onRefreshBoss,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ENERGY_MESSAGE.toString(),this.onRefreshenergy,this),GameDispatcher.getInstance().addEventListener(GameEvent.XIANSHAN_REFRESH.toString(),this.onRefreshXianShan,this);for(var t=0;t<this.btnPanels.length;++t){var n=Tool.randomInt(0,100)/100,a=3e3,i=egret.Tween.get(this.btnPanels[t],{loop:!0});this.btnPanels[t].y=this.btnListY[t]-40*n,Tool.randomInt(0,100)>50?(i.to({y:this.btnListY[t]-40},a*(1-n)),i.to({y:this.btnListY[t]},a),i.to({y:this.btnListY[t]-40*n},a*n)):(i.to({y:this.btnListY[t]},a*n),i.to({y:this.btnListY[t]-40},a),i.to({y:this.btnListY[t]-40*n},a*(1-n)))}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.bossBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBossView,this),this.btnchallenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBossView,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PILL_HIDE_BOSS_MESSAGE.toString(),this.onRefreshBoss,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ENERGY_MESSAGE.toString(),this.onRefreshenergy,this),GameDispatcher.getInstance().removeEventListener(GameEvent.XIANSHAN_REFRESH.toString(),this.onRefreshXianShan,this);for(var t=0;t<this.btnPanels.length;++t)egret.Tween.removeTweens(this.btnPanels[t])},t.prototype.onRefreshenergy=function(){this.progress.value=DataManager.getInstance().xiandanManager.energy,this.caoYaoPro.text=DataManager.getInstance().xiandanManager.energy+"/30"},t.prototype.onRefreshBoss=function(){this.bossBtn.visible=!1},t.prototype.onChallenge=function(){},t.prototype.onShowBossView=function(){},t.prototype.onRefreshXianShan=function(){var e=DataManager.getInstance().xiandanManager.allCfg;this.curGroup.visible=!1;var t=DataManager.getInstance().xiandanManager.curLayer,n=this.getPlayer().xianDanRolls;this.cupShanId=0,t>0&&(this.cupShanId=t-1);for(var a=0,i=0;6>i;++i)this.cupShanId>i?this.setShanState(i,1):this.cupShanId==i?(a=i,this.setShanState(i,2),this.curGroup.visible=!0,this.curDanLuProgress.maximum=e[i].times,n[i]?(n[i].chouquNum>=e[i].times*e[i].max?(a=i+1,this.curDanLuPro.text="悟性:Lv"+Math.floor(n[i].chouquNum/e[i].times)):this.curDanLuPro.text="悟性:Lv"+Math.floor(n[i].chouquNum/e[i].times),this.curDanLuProgress.value=n[i].chouquNum%e[i].times):(this.curDanLuPro.text="悟性:Lv0",this.curDanLuProgress.value=0)):this.setShanState(i,i==a?1:0)},t.prototype.setShanState=function(e,t){Tool.setDisplayGray(this.btnPanels[e],0==t)},t.prototype.touchBeginHandler=function(e){this.bg.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginHandler,this),this.bg.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandler,this),this.bg.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEndHandler,this),this.isDrag=!0,this.startX=e.localX,this.startY=e.localY},t.prototype.touchMoveHandler=function(e){e.localX-this.startX;(e.localX-this.startX>4||e.localX-this.startX<-4)&&(this.isDrag=!1),(e.localY-this.startY>4||e.localY-this.startY<-4)&&(this.isDrag=!1)},t.prototype.touchEndHandler=function(e){this.startX=e.localX,this.startX==e.localX&&this.startY==e.localY&&(this.isDrag=!0)},t.prototype.challengeDup=function(e){this.isDrag=!1;var t=Number(e.target.name);return DataManager.getInstance().xiandanManager.curLayer>t?void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("XianDanDupView",t)):t==DataManager.getInstance().xiandanManager.curLayer&&this.getPlayer().xianDanRolls[t-1]&&this.getPlayer().xianDanRolls[t-1].chouquNum>=DataManager.getInstance().xiandanManager.allCfg[t-1].times*DataManager.getInstance().xiandanManager.allCfg[t-1].max?void GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("XianDanDupView",t)):void GameCommon.getInstance().addAlert("上一仙炉未炼制到满级!")},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseTabView);__reflect(XianDanDupPanel.prototype,"XianDanDupPanel");var XianDanDupView=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n.effectStats=0,n.isFlg=!0,n}return __extends(t,e),t.prototype.onInit=function(){e.prototype.onInit.call(this),this.progress.slideDuration=500,this.onRefresh()},t.prototype.onSkinName=function(){this.skinName=skins.XianDanChallengeSkin},t.prototype.onShowWithParam=function(t){this.param=t,e.prototype.onShowWithParam.call(this,t)},t.prototype.initUI=function(){for(var e=this.param;this.monsterbody_group.numChildren>0;){var t=this.monsterbody_group.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.monsterbody_group.removeChild(t)}for(;this.danlu_group.numChildren>0;){var t=this.danlu_group.getChildAt(0);egret.is(t,"BodyAnimation")||egret.is(t,"Animation")?t.onDestroy():this.danlu_group.removeChild(t)}var n=JsonModelManager.instance.getModelxianshan()[e];if(this.xiaohao=n.caoyao,DataManager.getInstance().xiandanManager.curLayer-1<e){this.bossPanel.visible=!0,this.danluPanel.visible=!1;var a;n.fightId>0&&(a=GameCommon.getInstance().getMonsterBody(a,n.fightId),a.parent||(a.scaleX=1.5,a.scaleY=1.5,a.y=50,this.monsterbody_group.addChild(a)));var i=ModelManager.getInstance().getModelFigher(n.fightId);this.bossName.text=i.name}else{this.bossPanel.visible=!1,this.danluPanel.visible=!0,this.progress.minimum=0,this.progress.maximum=n.times,this.getPlayer().xianDanRolls[e]?(Math.floor(this.getPlayer().xianDanRolls[e].chouquNum/n.times)>n.max?this.curLv.text="悟性 "+n.max+"/"+n.max:this.curLv.text="悟性 "+Math.floor(this.getPlayer().xianDanRolls[e].chouquNum/n.times)+"/"+n.max,this.progress.value=this.getPlayer().xianDanRolls[e].chouquNum%n.times):(this.curLv.text="悟性 0/"+n.max,this.progress.value=0),this.curDanNum.text=" 悟性达到"+n.max+"级可前往下一座仙山",this.curDanNum1.text="悟性每提升一级必定会有丹药奖励";var o=new Animation("xianlu_"+(e+1));switch(n.id){case 0:o.x=18,o.y=-30;break;case 1:o.x=4,o.y=-25;break;case 2:o.y=-15;break;case 3:o.y=-30,o.x=15;break;case 4:o.y=-30,o.x=10}this.danlu_group.addChild(o),this.danluDesc.text=Language.instance.getText("danlu_"+(e+1))}this.setTitle(n.name),this.dupId=n.fightId,this.updateGoodsADD()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.onUpdate()},t.prototype.onUpdate=function(){if(1==DataManager.getInstance().xiandanManager.stats||2==DataManager.getInstance().xiandanManager.stats){for(this.isFlg=!1;this.danlu_groupEffect.numChildren>0;){var e=this.danlu_groupEffect.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.danlu_groupEffect.removeChild(e)}var t=new Animation("liandan_1");if(t.autoRemove=!1,t.playNum=.5,this.effectStats=DataManager.getInstance().xiandanManager.stats,this.danlu_groupEffect.addChild(t),t.y=0,2==this.effectStats){this.effectStats=0,DataManager.getInstance().xiandanManager.stats=0;var t=new Animation("liandan_2");t.autoRemove=!1,t.playNum=1,t.playFinishCallBack(this.onAnimFinish1,this),this.danlu_groupEffect.addChild(t),t.y=50}else t.playFinishCallBack(this.onAnimFinish,this)}else this.isFlg=!0;if(this.getPlayer().xianDanRolls[this.param]){var n=JsonModelManager.instance.getModelxianshan()[this.param];Math.floor(this.getPlayer().xianDanRolls[this.param].chouquNum/n.times)>n.max?this.curLv.text="悟性 "+n.max+"/"+n.max:this.curLv.text="悟性 "+Math.floor(this.getPlayer().xianDanRolls[this.param].chouquNum/n.times)+"/"+n.max,this.progress.maximum=n.times,this.progress.value=this.getPlayer().xianDanRolls[this.param].chouquNum%n.times}this.updateGoodsADD()},t.prototype.onAnimFinish=function(){for(;this.danlu_groupEffect.numChildren>0;){var e=this.danlu_groupEffect.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.danlu_groupEffect.removeChild(e)}this.effectStats=0,DataManager.getInstance().xiandanManager.stats=0;var t=new TurnplateAwardParam;t.desc="恭喜炼丹时意外获得",t.titleSource="",t.itemAwards=DataManager.getInstance().xiandanManager.awards,t.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardSmallPanel",t)),this.isFlg=!0,this.onRefresh()},t.prototype.onAnimFinish1=function(){for(;this.danlu_groupEffect.numChildren>0;){var e=this.danlu_groupEffect.getChildAt(0);egret.is(e,"BodyAnimation")||egret.is(e,"Animation")?e.onDestroy():this.danlu_groupEffect.removeChild(e)}var t=new TurnplateAwardParam;t.desc="恭喜炼丹成功",t.titleSource="",t.itemAwards=DataManager.getInstance().xiandanManager.awards,t.autocloseTime=11,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("TreasureAwardSmallPanel",t)),this.isFlg=!0,this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.initUI(),this.btnChallenge.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendChallenge,this),this.btnLianDan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendLianDan,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PILL_ROLL_MESSAGE.toString(),this.onRefresh,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.XIANSHAN_REFRESH)),this.btnChallenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendChallenge,this),this.btnLianDan.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendLianDan,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PILL_ROLL_MESSAGE.toString(),this.onRefresh,this)},t.prototype.updateGoodsADD=function(){this.consume_name_label.text="草药",DataManager.getInstance().xiandanManager.energy>=this.xiaohao?this.consume_num_label.textColor=65280:this.consume_num_label.textColor=16711680,this.consume_num_label.textFlow=(new egret.HtmlTextParser).parser(DataManager.getInstance().xiandanManager.energy+"/"+this.xiaohao)},t.prototype.onSendChallenge=function(){GameFight.getInstance().onSendEnterDupMsg(27)},t.prototype.onSendLianDan=function(){if(this.isFlg){var e=new Message(MESSAGE_ID.PILL_ROLL_MESSAGE);e.setShort(this.param),GameCommon.getInstance().sendMsgToServer(e),this.isFlg=!1}},t.prototype.getPlayer=function(){return DataManager.getInstance().playerManager.player},t}(BaseWindowPanel);__reflect(XianDanDupView.prototype,"XianDanDupView");var XianDanInfo=function(){function e(){}return e.prototype.onParseXianDanInitMsg=function(e,t){this.UID=e,this.shiyongNum=t.getInt(),this.havepill=t.getInt()},e}();__reflect(XianDanInfo.prototype,"XianDanInfo");var XianDanMainViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(5),n.tabs={},n.tabFs={},n.tabNum=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.setTitle("xianshanTitle_png");var t=[],n=new RegisterSystemParam;n.sysName="XianDanDupPanel",n.btnRes="仙山",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianShanPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="XianDanTabView",n.btnRes="少阴丹",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",1),t.push(n),n=new RegisterSystemParam,n.sysName="XianDanTabView",n.btnRes="少阳丹",n.redP=this.points[2],n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",2),t.push(n),n=new RegisterSystemParam,n.sysName="XianDanTabView",n.btnRes="老阴丹",n.redP=this.points[3],n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",3),t.push(n),n=new RegisterSystemParam,n.sysName="XianDanTabView",n.btnRes="老阳丹",n.redP=this.points[4],n.redP.addTriggerFuc(DataManager.getInstance().xiandanManager,"getXianDanPoint",4),t.push(n),this.registerPage(t,"XianDanGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),this.index>0&&GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.XIANDAN_TAB_REFRESH),this.index)},t}(BaseSystemPanel);__reflect(XianDanMainViewPanel.prototype,"XianDanMainViewPanel");var XianDanManager=function(){function e(){this.curLayer=1,this.energy=0,this.bossSize=0,this.bossState=0,this.stats=0,this.curDanId=0,this.awards=[],this.danBtnStatus=!0,this.yilingEnergy=0}return e.prototype.parseFate=function(e){for(var t=e.getShort(),n=0;t>n;n++);},e.prototype.parseBossState=function(e){this.bossState=e.getShort()},e.prototype.parseBossSize=function(e){this.bossSize=e.getShort()},e.prototype.parseXianDanGain=function(e){var t=(new XianDanRollData,e.getShort());DataManager.getInstance().playerManager.player.xianDanRolls[t]||(DataManager.getInstance().playerManager.player.xianDanRolls[t]=new XianDanRollData),DataManager.getInstance().playerManager.player.xianDanRolls[t].onParseXianDanInitMsg(t,e);for(var n=e.getByte(),a=[],i=0;n>i;i++){var o=new AwardItem;o.type=e.getByte(),o.id=e.getShort(),o.quality=e.getByte(),o.num=e.getInt(),o.quality=o.type==GOODS_TYPE.MASTER_EQUIP||o.type==GOODS_TYPE.SERVANT_EQUIP?o.quality:-1,a.push(o)}this.awards=a,this.stats=e.getByte()},e.prototype.getXianShanBossPoint=function(){return 1==this.bossState},Object.defineProperty(e.prototype,"allCfg",{get:function(){return this._xianshanCfgs||(this._xianshanCfgs=JsonModelManager.instance.getModelxianshan()),this._xianshanCfgs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allXianDanCfg",{get:function(){return this._xiandanCfgs||(this._xiandanCfgs=JsonModelManager.instance.getModelxiandan()),this._xiandanCfgs},enumerable:!0,configurable:!0}),e.prototype.getXianShanAllPoint=function(){return this.getXianShanPoint()?!0:this.getXianDanPoint(0)?!0:!1},e.prototype.getXianShanPoint=function(){return FunDefine.isFunOpen(FUN_TYPE.FUN_XIANSHAN)?this.energy>0:!1},e.prototype.getXianDanPoint=function(e){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_XIANSHAN))return!1;if(e>0){for(var t=8*(e-1);8*e>t;t++)if(DataManager.getInstance().playerManager.player.xianDans[t+1]&&DataManager.getInstance().playerManager.player.xianDans[t+1].havepill>0)return!0}else for(var n in DataManager.getInstance().playerManager.player.xianDans)if(DataManager.getInstance().playerManager.player.xianDans[n]&&DataManager.getInstance().playerManager.player.xianDans[n].havepill>0)return!0;return!1},e.prototype.getXianDanAllProTimes=function(e){var t;t=e.effect.split("#");for(var n=0,a=0;a<t.length;a++){var i=t[a].split(",");if(DataManager.getInstance().playerManager.player.xianDans[e.id].shiyongNum>=Number(i[0]))n=Number(i[1]);else if(0>=a)return 0}return n},e.prototype.getXianDanPro=function(e,t,n){var a,i;this._xiandanCfgs||(this._xiandanCfgs=this.allXianDanCfg),a=this._xiandanCfgs[e].effect.split("#");for(var o=0;o<a.length;o++){var r=a[o].split(",");if(t<Number(r[0]))return 0==o?n?a[o].split(","):(i=[],i.push("0"),i.push("0"),i):n?a[o].split(","):a[o-1].split(",")}},e}();__reflect(XianDanManager.prototype,"XianDanManager");var XianDanRollData=function(){function e(){}return e.prototype.onParseXianDanInitMsg=function(e,t){this.UID=e,this.chouquNum=t.getInt()},e}();__reflect(XianDanRollData.prototype,"XianDanRollData");var XianDanTabView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(7),n.bo=!1,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XianDanViewSkin},t.prototype.onInit=function(){this.scroll.verticalScrollBar.autoVisibility=!0,this.awardList.itemRenderer=XianDanItem,this.awardList.itemRendererSkinName=skins.XianDanItemSkin,this.awardList.useVirtualLayout=!0,this.scroll.viewport=this.awardList,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){this.index=this.getRegisterSystemParam().index-1,this.onTab(this.index)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameDispatcher.getInstance().addEventListener(GameEvent.XIANDAN_TAB_REFRESH,this.onTab,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PILL_MESSAGE.toString(),this.onRefreshXianDan,this)},t.prototype.onRemove=function(){GameDispatcher.getInstance().removeEventListener(GameEvent.XIANDAN_TAB_REFRESH,this.onTab,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PILL_MESSAGE.toString(),this.onRefreshXianDan,this)},t.prototype.onTab=function(e){this.scroll.stopAnimation(),this.scroll.viewport.scrollV=0,this.awardList.dataProvider=new eui.ArrayCollection(this.models),this.onRefreshXianDan()},t.prototype.onRefreshXianDan=function(){if(this.onUpData(),this.awardList.numChildren>0)for(var e=this.awardList.numChildren-1;e>=0;e--){var t=this.awardList.getChildAt(e);if(t&&DataManager.getInstance().playerManager.player.xianDans[DataManager.getInstance().xiandanManager.curDanId]&&t.xianDanId==DataManager.getInstance().xiandanManager.curDanId){t.onUpdate(JsonModelManager.instance.getModelxiandan()[t.xianDanId]);break}}},t.prototype.onUpData=function(){this.rewardArr=this.models;for(var e=JsonModelManager.instance.getModelxiandan(),t=[],n=[],a=0;10>a;a++)t[a]=0,n[a]=0;for(var i in e)for(var o=0;o<e[i].attrAry.length;o++){var r=e[i].attrAry[o];if(DataManager.getInstance().playerManager.player.xianDans[e[i].id]&&DataManager.getInstance().playerManager.player.xianDans[e[i].id].shiyongNum>0&&r>0){var s;s=e[i].effect.split("#"),n[o]=n[o]+DataManager.getInstance().xiandanManager.getXianDanAllProTimes(e[i]),t[o]=t[o]+r*DataManager.getInstance().playerManager.player.xianDans[e[i].id].shiyongNum}else;}this.xianDan_buff_attr1.text="",this.xianDan_buff_attr2.text="";for(var h=0;4>h;h++){var r=t[h];this.xianDan_buff_attr1.text+=GameDefine.Attr_FontName[h]+"+"+r+"\n";var l=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.PILL);t[h]+=Tool.toInt(r*l/GameDefine.GAME_ADD_RATIO)}""==this.xianDan_buff_attr1.text;for(var h=0;4>h;h++){var r=n[h];this.xianDan_buff_attr2.text+=GameDefine.Attr_FontName[h]+"+"+r/100+"%\n"}var g=GameCommon.calculationFighting(t);this.powerBar.power=g.toString()},t.prototype.onClearDepotList=function(){if(this.awardList.numChildren>0)for(var e=this.awardList.numChildren-1;e>=0;e--){var t=this.awardList.getChildAt(e);t&&this.awardList.removeChild(t)}},Object.defineProperty(t.prototype,"models",{get:function(){var e=[],t=JsonModelManager.instance.getModelxiandan();for(var n in t)t[n].type==this.index&&e.push(t[n]);return e},enumerable:!0,configurable:!0}),t.prototype.onClose=function(){this.onHide()},t}(BaseTabView);__reflect(XianDanTabView.prototype,"XianDanTabView");var XianDanItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.progress.slideDuration=0,this.btnRefine.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.dataChanged=function(){this.progress.slideDuration=0;var e=this.data;this.progress.value=0,this.curXianDan=0,this.onUpdate(e)},t.prototype.onTouch=function(){if(this.data&&DataManager.getInstance().xiandanManager.danBtnStatus)if(this.curXianDan>0){DataManager.getInstance().xiandanManager.danBtnStatus=!1;var e=new Message(MESSAGE_ID.PILL_USE_MESSAGE);e.setShort(this.xianDanId),GameCommon.getInstance().sendMsgToServer(e)}else GameCommon.getInstance().addAlert("仙丹不足,请前往炼丹炉炼制")},t.prototype.onUpdate=function(e){this.xianDanId=e.id,this.item_icon.source=e.icon;var t=[];t.push({text:e.name,style:{textColor:GameCommon.getInstance().CreateNameColer(e.quality)}}),this.name_label.textFlow=t,this.progress.minimum=0;var n=0;this.haveNum.text="剩余:0",this.item_frame.source=GameCommon.getInstance().getIconFrame(e.quality),DataManager.getInstance().playerManager.player.xianDans[e.id]&&(this.curXianDan=DataManager.getInstance().playerManager.player.xianDans[e.id].havepill,this.haveNum.text="剩余:"+DataManager.getInstance().playerManager.player.xianDans[e.id].havepill,n=DataManager.getInstance().playerManager.player.xianDans[e.id].shiyongNum,this._shiyongNUm=DataManager.getInstance().playerManager.player.xianDans[e.id].shiyongNum);var a=DataManager.getInstance().xiandanManager.getXianDanPro(e.id,n,!0);if(this.progress.maximum=Number(a[0]),DataManager.getInstance().playerManager.player.xianDans[e.id]){var i,o=0;i=e.effect.split("#");for(var r=0;r<i.length;r++){var s=i[r].split(",");if(o+=Number(s[0]),n>0){if(0==r&&n<Number(s[0])){this.progress.value=n,this.roValue.text=n+"/"+a[0];break}this.progress.value=n-(o-Number(s[0])),this.roValue.text=n-(o-Number(s[0]))+"/"+a[0];break}}}else this.roValue.text="0/"+a[0];this.pro1.text="";
for(var r=(DataManager.getInstance().xiandanManager.getXianDanPro(e.id,n,!1),0);r<e.attrAry.length;r++){var h=e.attrAry[r];if(h>0){var l=[];l.push({text:"每注入一颗丹药可提高"+GameDefine.Attr_FontName[r],style:{textColor:16771255}}),l.push({text:"+"+h,style:{textColor:65280}}),this.pro1Desc.textFlow=l;var g=[],c="注入"+a[0]+"颗可提高角色总"+GameDefine.Attr_FontName[r];return g.push({text:c,style:{textColor:16777215}}),g.push({text:"+"+Number(a[1])/100+"%",style:{textColor:65280}}),void(this.lableDesc.textFlow=g)}}},t}(eui.ItemRenderer);__reflect(XianDanItem.prototype,"XianDanItem");var XianShanBossView=function(e){function t(t){var n=e.call(this,t)||this;return n.MAX_ITEM_NUM=5,n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XianShanBossViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.BOSS_PILL_INFO_MESSAGE.toString(),this.onResBossListInfoMsg,this),this.onRequsetBossListInfoMsg(),this.bossAnim&&this.bossAnim.onReLoad()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.BOSS_PILL_INFO_MESSAGE.toString(),this.onResBossListInfoMsg,this)},t.prototype.onInit=function(){this.boss_scroll.verticalScrollBar.autoVisibility=!1,this.boss_scroll.verticalScrollBar.visible=!1,this.allpeopleItems=[],e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRequsetBossListInfoMsg=function(){var e=new Message(MESSAGE_ID.BOSS_PILL_INFO_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.onResBossListInfoMsg=function(){for(var e=DataManager.getInstance().dupManager.allpeoplebossData,t=0;t<this.allpeopleItems.length;t++){var n=this.allpeopleItems[t];n&&(n.btn_challenge.removeEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouchChallengeBtn,n),Tool.removeTimer(n.updateRebronTime,n,1e3)),this.allpeopleItems[t]=null,delete this.allpeopleItems[t]}for(;this.itemGroup.numChildren>0;){var a=this.itemGroup.getChildAt(0);this.itemGroup.removeChild(a)}for(var i=0;i<e.xianshanInfos.length;i++){var o=e.xianshanInfos[i];if(o&&!(o.rebirthTime<=0)){var r=JsonModelManager.instance.getModelxianshanzhaohuan()[o.id],n=new XianShanBossItem(r,o);Tool.addTimer(n.updateRebronTime,n,1e3),n.btn_challenge.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouchChallengeBtn,n),this.allpeopleItems.push(n),this.itemGroup.addChild(n),n.y=160*this.allpeopleItems.length-150}}},t}(BaseWindowPanel);__reflect(XianShanBossView.prototype,"XianShanBossView");var XianShanBossItem=function(e){function t(t,n){var a=e.call(this)||this;return a.model=t,a.once(egret.Event.COMPLETE,a.onInit,a),a.skinName=skins.XianDanBossItemSkin,a.info=n,a.onUpdate(),a}return __extends(t,e),t.prototype.onInit=function(){this.monster_name_label.text=this.bossFightter.name,this.monsterIcon_img.source=this.bossFightter.avata+"_icon_png";for(var e=0;e<this.model.rewards.length;e++){var t=this.model.rewards[e],n=new GoodsInstance;n.scaleX=.8,n.scaleY=.8,n.onUpdate(t.type,t.id,0,t.quality,t.num),this.award_group.addChild(n)}},t.prototype.onUpdate=function(){this.bosshp_probar.text=Math.min(100,Math.ceil(this.info.leftHp/this.bossFightter.hp*100))+"%",this.isOpen=this.info.rebirthTime>0,this.joinNum_label.text=this.info.guishuName},Object.defineProperty(t.prototype,"bossFightter",{get:function(){return ModelManager.getInstance().getModelFigher(this.model.modelId)},enumerable:!0,configurable:!0}),t.prototype.updateRebronTime=function(){this.info&&this.isOpen&&(this.info.rebirthTime>0?this.time_label.text="剩余时间:"+Tool.getTimeStr(this.info.rebirthTime):this.time_label.text=Language.instance.getText("houchongsheng"))},t.prototype.onTouchChallengeBtn=function(e){GameFight.getInstance().onEnterXianShanBossScene(this.info.bossID)},t}(eui.Component);__reflect(XianShanBossItem.prototype,"XianShanBossItem");var XinFaPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.btnNames=["z_btn_xf_zi_png","z_btn_xf_cheng_png","z_btn_xf_hong_png","z_btn_xf_jin_png"],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XinfaPanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XINFA_TUJIAN_MESSAGE.toString(),this.onRefresh,this);for(var t=0;4>t;t++)this["tab"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XINFA_TUJIAN_MESSAGE.toString(),this.onRefresh,this);for(var t=0;4>t;t++)this["tab"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)},Object.defineProperty(t.prototype,"manager",{get:function(){return DataManager.getInstance().playerManager},enumerable:!0,configurable:!0}),t.prototype.onInit=function(){this.scroller.verticalScrollBar.autoVisibility=!1,this.scroller.verticalScrollBar.visible=!1,this.xinfaList.itemRenderer=XinfaItem,this.xinfaList.itemRendererSkinName=skins.XinfaItemSkin,this.xinfaList.useVirtualLayout=!0,this.scroller.viewport=this.xinfaList,this.points=[];for(var t=new egret.Point(60,5),n=0;4>n;n++)this.points[n]=new redPoint,this["tab"+n].iconDisplay.source=this.btnNames[n],this.points[n].register(this["tab"+n],t,this,"onCheckRPointForQuality",this["tab"+n].value);this.currTabId=this.tab0.value,this.tab0.selected=!0,e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onChangeBtn=function(){for(var e=0;4>e;e++)this.currTabId==this["tab"+e].value?this["tab"+e].iconFrame.visible=!0:this["tab"+e].iconFrame.visible=!1},t.prototype.onRefresh=function(){this.onChangeBtn();var e=this.manager.xinfaAddLevel,t=this.manager.xinfaAddRatio,n=this.manager.getAllXinfaAttrAry();if(t+=this.manager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.XINFA),t>0)for(var a=0;a<=ATTR_TYPE.MAGICDEF;++a)n[a]+=Tool.toInt(n[a]*t/GameDefine.GAME_ADD_RATIO);var i=GameCommon.calculationFighting(n);this.powerbar.power=i,e>0?this.grade_name_lab.text="法器"+e+"阶":this.grade_name_lab.text="法器未激活";for(var o="",r=0;r<=ATTR_TYPE.MAGICDEF;r++)o+=Language.instance.getAttrName(r)+Language.instance.getText("shuxingjiacheng")+":"+(t/100).toFixed(1)+"%",r<ATTR_TYPE.MAGICDEF&&(o+="\n");this.curr_addattr_lab.text=o;var s=this.manager.xinfaAddTotalExp,h=this.manager.xinfaUpExp;h>0?(this.addexp_probar.slideDuration=500,this.addexp_probar.maximum=h,this.addexp_probar.value=s):(this.addexp_probar.slideDuration=0,this.addexp_probar.maximum=1,this.addexp_probar.value=1,this.addexp_probar.labelDisplay.text="MAX"),this.onTabHanlder()},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.currTabId!=t.value&&(this.currTabId=t.value,this.onTabHanlder()),this.onChangeBtn()},t.prototype.onTabHanlder=function(){var e=[];for(var t in JsonModelManager.instance.getModeltujian2()){var n=JsonModelManager.instance.getModeltujian2()[t];n.pinzhi==this.currTabId&&e.push(n)}this.xinfaList.dataProvider=new eui.ArrayCollection(e)},t.prototype.onCheckRPointForQuality=function(e){for(var t in JsonModelManager.instance.getModeltujian2()){var n=JsonModelManager.instance.getModeltujian2()[t];if(n.pinzhi==e&&this.manager.onCheckOneXinfaRedPoint(n.id))return!0}return!1},t}(BaseTabView);__reflect(XinFaPanel.prototype,"XinFaPanel");var XinfaItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onComplete,t),t}return __extends(t,e),t.prototype.onComplete=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.dataChanged=function(){var e=DataManager.getInstance().playerManager,t=this.data,n=e.getXinfaDataByID(t.id);this.name_label.text=t.name,this.icon_img.source=t.waixing1,this.frame_img.source="xinfa_border_"+t.pinzhi+"_png",this.nameframe_img.source="xinfa_namebg_"+t.pinzhi+"_png",this.level_label.text=n.level+Language.instance.getText("level");var a=e.getoneXinfaUpCostByID(t.id);this.consume_probar.maximum=a;var i=DataManager.getInstance().bagManager.getGoodsThingNumById(t.cost.id);this.consume_probar.value=i,this.redponit_img.visible=i>=a,this._level=n.level,n.level>=500&&(this.redponit_img.visible=!1,this.consume_probar.visible=!1)},t.prototype.onTouch=function(){this._level>=500||GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("XinfaUpgradePanel",this.data))},t}(eui.ItemRenderer);__reflect(XinfaItem.prototype,"XinfaItem");var XinfaUpgradePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.XinfaUpgradePanelSkin},t.prototype.onShowWithParam=function(t){this.model=t,this.model&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.setTitle("法 器"),this.onRefresh()},t.prototype.onRefresh=function(){var e=DataManager.getInstance().playerManager.getXinfaDataByID(this.model.id);this.name_label.text=this.model.name,this.icon_img.source=this.model.waixing1,this.frame_img.source="xinfa_border_"+this.model.pinzhi+"_png",this.nameframe_img.source="xinfa_namebg_"+this.model.pinzhi+"_png",this.level_label.text=e.level+Language.instance.getText("level");for(var t=e.level,n="",a="",i=0;i<ATTR_TYPE.SIZE;i++){var o=this.model.attrAry[i];o>0&&(n+=Language.instance.getAttrName(i)+"+"+o*t,a+=Language.instance.getAttrName(i)+"+"+o*(t+1)),i<ATTR_TYPE.SIZE-1&&(n+="\n",a+="\n")}this.cur_attr_lab.text=n,this.next_attr_lab.text=a;DataManager.getInstance().playerManager.getoneXinfaUpCostByID(this.model.id);this.consumItem.setCostByAwardItem(this.model.cost)},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.XINFA_TUJIAN_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.XINFA_TUJIAN_MESSAGE.toString(),this.onRefresh,this),this.upgrade_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendUpgradeMsg,this)},t.prototype.onSendUpgradeMsg=function(){var e=DataManager.getInstance().playerManager.getoneXinfaUpCostByID(this.model.id);if(GameCommon.getInstance().onCheckItemConsume(this.model.cost.id,e)){var t=new Message(MESSAGE_ID.XINFA_TUJIAN_MESSAGE);t.setByte(0),t.setShort(this.model.id),GameCommon.getInstance().sendMsgToServer(t)}},t}(BaseWindowPanel);__reflect(XinfaUpgradePanel.prototype,"XinfaUpgradePanel");var EncounterLogPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.priority=PANEL_HIERARCHY_TYPE.II,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EncounterLogPanelSkin},t.prototype.onInit=function(){this.itemGroup.itemRenderer=EncounterLogItem,this.itemGroup.itemRendererSkinName=skins.EncounterLogItemSkin,this.itemGroup.useVirtualLayout=!1,this.scroll.viewport=this.itemGroup,this.basic.label_title.text="战斗记录",e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YEWAIPVP_FIGHT_LOG_MSG.toString(),this.onResPVPLogMsg,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.YEWAIPVP_FIGHT_LOG_MSG.toString(),this.onResPVPLogMsg,this)},t.prototype.onRefresh=function(){this.onRequetPVPLogMsg()},t.prototype.onRequetPVPLogMsg=function(){var e=new Message(MESSAGE_ID.YEWAIPVP_FIGHT_LOG_MSG);GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onResPVPLogMsg=function(e){for(var t=[],n=e.message,a=n.getByte(),i=0;a>i;i++){var o=new EncounterLogItemData;o.onParse(n),t.push(o)}this.itemGroup.dataProvider=new eui.ArrayCollection(t)},t}(BaseWindowPanel);__reflect(EncounterLogPanel.prototype,"EncounterLogPanel");var EncounterLogItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.result_icon.source=e.result>0?"fight_win_icon_png":"fight_lose_icon_png",this.name_label.text=e.name,this.time_desc_label.text=e.timedesc;for(var t=0;t<e.awarditems.length;t++){var n=this["goods_item"+t];if(!n)break;if(e.awarditems.length>t){var a=e.awarditems[t];n.visible=!0,n.onUpdate(a.type,a.id,0,a.quality,a.num)}else n.visible=!1}},t}(eui.ItemRenderer);__reflect(EncounterLogItem.prototype,"EncounterLogItem");var EncounterLogItemData=function(){function e(){}return e.prototype.onParse=function(e){this.name=e.getString(),this.result=e.getByte(),this.timedesc=e.getString();var t=e.getInt(),n=e.getByte();this.result==FightDefine.FIGHT_RESULT_SUCCESS?this.awarditems=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.FIELD_PVP_REWARD_SUCC)):this.awarditems=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.FIELD_PVP_REWARD_FAIL)),this.awarditems.push(new AwardItem(GOODS_TYPE.EXP,0,t)),this.awarditems.push(new AwardItem(GOODS_TYPE.SHOW,0,n))},e}();__reflect(EncounterLogItemData.prototype,"EncounterLogItemData");var EncounterPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.EncounterPanelSkin},t.prototype.onInit=function(){this.items=[],e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){GameFight.getInstance().onRequstYewaiFightterInfoMsg()},t.prototype.onRegist=function(){GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YEWAIPVP_FIGHTTER_INFO_MSG.toString(),this.onReceiveFigtterMsg,this),this.loop_rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openRankView,this),this.fight_log_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this)},t.prototype.onRemove=function(){GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.YEWAIPVP_FIGHTTER_INFO_MSG.toString(),this.onReceiveFigtterMsg,this),this.loop_rank_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openRankView,this),this.fight_log_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openLogView,this),this.onDestroyItems()},t.prototype.onDestroyItems=function(){for(var e=this.itemGroup.numChildren-1;e>=0;e--){var t=this.itemGroup.getChildAt(e);t.onDestory()}},t.prototype.onReceiveFigtterMsg=function(){var e=DataManager.getInstance().yewaipvpManager;this.prestige_label.text=e.prestige+" ",this.rank_null_lab.text=e.myrankNum>0?"":Language.instance.getText("zanwupaiming"),e.myrankNum>0?(this.rank_label.text=""+e.myrankNum,this.rank_grp.visible=!0):this.rank_grp.visible=!1;for(var t=this.getRankAwdModel(e.myrankNum),n=0;2>n;n++)if(t.rewards.length>n){this["awd_group"+n].visible=!0;var a=GameCommon.getInstance().getThingModel(t.rewards[n].type,t.rewards[n].id);this["awd_icon"+n].source=a.dropicon,this["awd_num_label"+n].text=t.rewards[n].num+""}else this["awd_group"+n].visible=!1;this.onDestroyItems();var n=0;for(n=0;n<FightDefine.PVP_MAX_NUM;n++){this.items.length<=n&&(this.items[n]=new EncounterItem(n));var i=this.items[n];if(!(e.pvpfightterInfos.length>n)){i.data=null,i.onShow(this.itemGroup);break}i.data=e.pvpfightterInfos[n],i.onShow(this.itemGroup)}},t.prototype.getRankAwdModel=function(e){var t=JsonModelManager.instance.getModelzaoyubang();for(var n in t){var a=t[n];if(a.rankMax>e&&e>0)return a;if(e+a.rankMax<0)return a}return t[t.length]},t.prototype.openRankView=function(){TOPRankTypeListPanel.tab=TOPRANK_TYPE.FIELD_PVP,GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"TOPRankingList")},t.prototype.openLogView=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"EncounterLogPanel")},t}(BaseTabView);__reflect(EncounterPanel.prototype,"EncounterPanel");var EncounterItem=function(e){function t(t){var n=e.call(this)||this;return n.index=t,n.skinName=skins.EncounterItemSkin,n}return __extends(t,e),t.prototype.onInit=function(){this._data||this.updateFindInfo()},t.prototype.onRegist=function(){this.challenge_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this),this.btn_find.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFindBtn,this)},t.prototype.onRemove=function(){this.challenge_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchChallengeBtn,this),this.btn_find.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchFindBtn,this),Tool.removeTimer(this.onTimedownHandler,this,1e3)},t.prototype.dataChanged=function(){this._data?this.updatePKInfo():this.updateFindInfo()},t.prototype.updatePKInfo=function(){this.currentState="fight";var e=this._data,t=15*GameFight.getInstance().getYewaiExp();this.name_label.text=e.playerName,this.coatard_lv_lab.text=e.reinLv+"转"+e.duanLv+"段",this.level_label.text=e.level+"级",this.award_exp_label.text=t+"";for(var n=GameCommon.getInstance().onParseAwardItemstr(Constant.get(Constant.FIELD_PVP_REWARD_SUCC)),a=0;2>a;a++){var i=n[a];if(i){var o=GameCommon.getInstance().getThingModel(i.type,i.id);this["awd_icon"+a].source=o.dropicon,this["awd_num_lab"+a].text=i.num+""}else this["awd_icon"+a].source="",this["awd_num_lab"+a].text=""}this.head_icon.setHead(e.headIndex,e.headFrame)},t.prototype.updateFindInfo=function(){this.currentState="find",Tool.addTimer(this.onTimedownHandler,this,1e3)},t.prototype.getRefreshTimeDesc=function(){var e=Tool.getTimeStr(DataManager.getInstance().yewaipvpManager.resetTime);return e},t.prototype.onTimedownHandler=function(){this.refresh_time_label.textFlow=(new egret.HtmlTextParser).parse(Tool.getHtmlColorStr(this.getRefreshTimeDesc(),"FF0000")+"后出现新的敌人"),DataManager.getInstance().yewaipvpManager.resetTime<=0&&(Tool.removeTimer(this.onTimedownHandler,this,1e3),GameFight.getInstance().onRequstYewaiFightterInfoMsg())},t.prototype.onTouchChallengeBtn=function(){GameFight.getInstance().onSendYewaiPVPPKMsg(this.index)},t.prototype.onTouchFindBtn=function(){var e=[{text:"是否花费"+Constant.get(Constant.SEARCH_CHALLENGE_DIAMOND)+"钻石进行一次寻敌？",style:{textColor:15086130}}];GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN_WITH_PARAM),new WindowParam("AlertFrameUI",new AlertFrameParam(e,function(){if(DataManager.getInstance().playerManager.player.gold<10)return void GameCommon.getInstance().addAlert(GameErrorTip.getInstance().getGameErrorTip(2));var e=new Message(MESSAGE_ID.YEWAIPVP_FIND_FIGHTTER_MSG);GameCommon.getInstance().sendMsgToServer(e)},this)))},t}(BaseComp);__reflect(EncounterItem.prototype,"EncounterItem");var PVPManager=function(){function e(){this.list=[FUN_TYPE.FUN_ARENA,FUN_TYPE.FUN_YEWAIPVP,FUN_TYPE.FUN_LADDER,FUN_TYPE.FUN_DUJIE,FUN_TYPE.FUN_SERVERFIGHT_ARENA,FUN_TYPE.FUN_WUTAN],this.pvpExp=0,this.PVPDataMap={};for(var e=0;e<this.funcList.length;++e){var t=new PVPData(this.funcList[e]);this.PVPDataMap[t.type]=t}}return e.prototype.sendPVPInfo=function(){var e=new Message(MESSAGE_ID.ZHANGONG_INFO_GET_MESSAGE);GameCommon.getInstance().sendMsgToServer(e)},e.prototype.parseInit=function(e){this.pvpExp=e.getInt(),this.checkModels()},e.prototype.parseMsg=function(e){this.pvpExp=e.getInt();for(var t=e.getShort(),n=0;t>n;++n){var a=e.getByte(),i=this.getFuncId(a);this.PVPDataMap[i].parseMsg(e)}this.checkModels(),GameCommon.getInstance().receiveMsgToClient(e)},e.prototype.updatePvpExp=function(e){this.pvpExp+=e,this.checkModels()},e.prototype.checkModels=function(){this.currModel=this.nextModel=null;var e=JsonModelManager.instance.getModelPVPLV();for(var t in e){var n=e[t];if(!(this.pvpExp>=n.zhangong)){this.nextModel=n;break}this.currModel=n}},e.prototype.getCurrLevel=function(){return this.currModel?this.currModel.lv:0},e.prototype.getModelCurr=function(){return this.currModel},e.prototype.getModelNext=function(){return this.nextModel},e.prototype.getCostZhanGongByStr=function(e){if(e){var t=GameCommon.getInstance().onParseAwardItemstr(e);if(t)return this.getCostZhanGong(t)}return 0},e.prototype.getCostZhanGong=function(e){if(e&&e instanceof Array&&e.length>0)for(var t=0;t<e.length;++t)if(e[t].type==GOODS_TYPE.ZHANGONG)return e[t].num;return 0},e.prototype.getFuncId=function(e){return this.list[e]},Object.defineProperty(e.prototype,"funcList",{get:function(){return this.list},enumerable:!0,configurable:!0}),e}();__reflect(PVPManager.prototype,"PVPManager");var PVPData=function(){function e(e){this.zhangong=0,this.value="-1",this.type=e}return e.prototype.parseMsg=function(e){this.zhangong=e.getInt(),this.value=e.getString()},e.prototype.isHasRank=function(){return this.value&&"-1"!=this.value?!0:!1},e.prototype.getRank=function(){return this.isHasRank()?parseInt(this.value):-1},e}();__reflect(PVPData.prototype,"PVPData");var RecordPVPPanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.RecordPVPPanelSkin},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.recordPVPItems=[];for(var t=this.pvpManager.funcList,n=0;n<t.length;++n){var a=new RecordPVPItem(t[n],this.pvpManager.PVPDataMap[t[n]]);a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchItem,this),this.recordPVPItems.push(a)}this.recordPVPItems.sort(function(e,t){return e.model.pvpLv-t.model.pvpLv});for(var n=0;n<this.recordPVPItems.length;++n)this.scrollerGroup.addChild(this.recordPVPItems[n])},t.prototype.onRegist=function(){this.btnShop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventShop,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.ZHANGONG_INFO_GET_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onRefresh,this),this.pvpManager.sendPVPInfo()},t.prototype.onRemove=function(){this.btnShop.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventShop,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.ZHANGONG_INFO_GET_MESSAGE.toString(),this.onRefresh,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.PLAYER_CURRENCY_UPDATE.toString(),this.onRefresh,this)},t.prototype.onTouchItem=function(e){var t=e.target,n=0,a=0;switch(t.funType){case FUN_TYPE.FUN_ARENA:n=1,a=1;break;case FUN_TYPE.FUN_LADDER:n=1,a=2;break;case FUN_TYPE.FUN_YEWAIPVP:n=1,a=0;break;case FUN_TYPE.FUN_DUJIE:n=1,a=3;break;case FUN_TYPE.FUN_SERVERFIGHT_ARENA:n=2,a=0;break;case FUN_TYPE.FUN_WUTAN:n=4,a=0}n>0&&this.owner.setPageTab(n,a)},t.prototype.onRefresh=function(){if(e.prototype.onRefresh.call(this),this.pvpManager.getModelNext()){var t=this.pvpManager.getModelNext().miaoshu;t?this.lbDesc.text=t:this.lbDesc.text="",this.barExp.maximum=this.pvpManager.getModelNext().zhangong,this.barExp.value=this.pvpManager.pvpExp,this.lbMax.text="",this.lbLevel.text=this.pvpManager.getModelCurr().lv.toString();var n=this.pvpManager.getModelNext().rewards;n&&this.reward.updateByAward(n[0])}else this.lbDesc.text="敬请期待",this.barExp.maximum=this.pvpManager.getModelCurr().zhangong,this.barExp.value=this.pvpManager.pvpExp,this.groupLevel.horizontalCenter="0",this.groupInfo.visible=!1,this.lbLevel.text="",this.lbMax.text="已满级";this.barExp.labelDisplay.size=22,this.barExp.labelDisplay.visible=!0;for(var a=0;a<this.recordPVPItems.length;++a)this.recordPVPItems[a].update()},t.prototype.onEventShop=function(){GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"PvPShopPanel")},Object.defineProperty(t.prototype,"pvpManager",{get:function(){return DataManager.getInstance().pvpManager},enumerable:!0,configurable:!0}),t}(BaseTabView);__reflect(RecordPVPPanel.prototype,"RecordPVPPanel");var RecordPVPItem=function(e){function t(t,n){var a=e.call(this)||this;return a.skinName=skins.RecordPVPItemSkin,a.funType=t,a.pvpData=n,a.onInit(),a.update(),a}return __extends(t,e),t.prototype.onInit=function(){this.model=JsonModelManager.instance.getModelfunctionLv()[this.funType];var e=this.model.desc;2==e.length&&(e=e[0]+"\n\n"+e[1]),this.lbTitle.text=e,this.initLogo()},t.prototype.initLogo=function(){switch(this.funType){case FUN_TYPE.FUN_ARENA:this.imgLogo.source="z_pvp_logo_jingjichang_png";break;case FUN_TYPE.FUN_LADDER:this.imgLogo.source="z_pvp_logo_tianti_png";break;case FUN_TYPE.FUN_YEWAIPVP:this.imgLogo.source="z_pvp_logo_zaoyuzhan_png";break;case FUN_TYPE.FUN_DUJIE:this.imgLogo.source="z_pvp_logo_husong_png";break;case FUN_TYPE.FUN_SERVERFIGHT_ARENA:this.imgLogo.source="z_pvp_logo_kuafujingji_png";break;case FUN_TYPE.FUN_WUTAN:this.imgLogo.source="z_pvp_logo_wutan_png"}},t.prototype.update=function(){FunDefine.isFunOpen(this.funType)?(this.updateValueDay(),Tool.setDisplayGray(this.group,!1)):(this.setClose(),this.lbRank.text="战功"+this.model.pvpLv+"级开启",Tool.setDisplayGray(this.group))},t.prototype.setClose=function(){this.lbGet.text=this.lbUnget.text=""},t.prototype.updateValueDay=function(){switch(this.lbGet.text="已获得"+this.pvpData.zhangong+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG),this.pvpData.isHasRank()?this.lbRank.text="当前排名："+this.pvpData.getRank():this.lbRank.text="未上榜",this.funType){case FUN_TYPE.FUN_ARENA:this.lbUnget.text="凌晨结算可获得:\n"+this.getZGArane()+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG);break;case FUN_TYPE.FUN_LADDER:this.updateTianTi();break;case FUN_TYPE.FUN_YEWAIPVP:this.lbUnget.text="凌晨结算可获得:\n"+this.getZGZY()+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG);break;case FUN_TYPE.FUN_DUJIE:this.updateHuSong();break;case FUN_TYPE.FUN_SERVERFIGHT_ARENA:this.lbUnget.text="凌晨结算可获得:\n"+this.getZGKFJJC()+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG);break;case FUN_TYPE.FUN_WUTAN:this.getZGWT()}},Object.defineProperty(t.prototype,"pvpManager",{get:function(){return DataManager.getInstance().pvpManager},enumerable:!0,configurable:!0}),t.prototype.getZGArane=function(){if(this.pvpData.isHasRank()){var e=this.pvpData.getRank(),t=JsonModelManager.instance.getModelarenaRankReward(),n=void 0,a=void 0;for(var i in t){if(n=t[i],n.highRank>=e&&n.lowRank<=e)return this.pvpManager.getCostZhanGongByStr(n.rate);(!a||n.level>a.level)&&(a=n)}if(a)return this.pvpManager.getCostZhanGongByStr(a.rate)}return 0},t.prototype.updateTianTi=function(){var e=0;if(this.pvpData.isHasRank()){var t=this.pvpData.value.split("_"),n=parseInt(t[0]),a=parseInt(t[1]),i=0;if(a>0){var o=JsonModelManager.instance.getModelttre(),r=null;for(var s in o){var h=o[s];if(a<=h.maxjifen){i=h.type;break}(!r||h.maxjifen>r.maxjifen)&&(r=h)}0==i&&(i=r.type)}var l=JsonModelManager.instance.getModelttjjc();for(var s in l){var h=l[s];4==i&&n>0&&n>=h.min&&n<h.max&&(e+=this.pvpManager.getCostZhanGong(h.rewards)),i==h.lv&&(e+=this.pvpManager.getCostZhanGong(h.rewards))}n>0?this.lbRank.text="当前排名："+n:this.lbRank.text="未上榜"}this.lbUnget.text="凌晨结算可获得:\n"+e+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG)},t.prototype.getZGZY=function(){if(this.pvpData.isHasRank()){var e=this.pvpData.getRank(),t=JsonModelManager.instance.getModelzaoyubang(),n=void 0,a=void 0;for(var i in t){if(n=t[i],n.rankMax>=e&&n.rankMin<=e)return this.pvpManager.getCostZhanGong(n.rewards);(!a||n.id>a.id)&&(a=n)}if(a)return this.lbRank.text="未上榜",this.pvpManager.getCostZhanGong(a.rewards)}return 0},t.prototype.updateHuSong=function(){var e=this.pvpData.getRank(),t=JsonModelManager.instance.getModeldujie()[e];t?(this.lbRank.text=t.name,this.lbUnget.text="护送完成可获得:\n"+this.pvpManager.getCostZhanGongByStr(t.jiangli)+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG)):(this.lbRank.text="未护送",this.lbUnget.text="当前没有护送中")},t.prototype.getZGKFJJC=function(){var e,t=this.pvpData.getRank(),n=JsonModelManager.instance.getModelkuafujingjichang();for(var a in n)if(e=n[a],e.max>=t&&e.min<=t)return this.pvpManager.getCostZhanGong(e.rewards);return 0},t.prototype.getZGWT=function(){if(this.pvpData.isHasRank()){var e=this.pvpData.value.split("_"),t=parseInt(e[0]),n=parseInt(e[1]);n=n>4?4:n;var a=DataManager.getInstance().wuTanManager.getModel(t,n);if(a)return this.lbRank.text=a.name+"：第"+(n+1)+"位",void(this.lbUnget.text="守坛完成可获得：\n"+this.pvpManager.getCostZhanGong(a.rewards)+Language.instance.getText("currency"+GOODS_TYPE.ZHANGONG))}this.lbRank.text="未上坛",this.lbUnget.text="当前未上坛位"},t}(eui.Button);__reflect(RecordPVPItem.prototype,"RecordPVPItem");var YewaiPVPLosePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.biangqiangAllGotype=[2,4,17,18,19,20,5,57],n.priority=PANEL_HIERARCHY_TYPE.II,n.allbianqiangBtns=[],n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.YewaiPVPLosePanelSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.banGo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goRecharge,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.addGotypeEventListener()}},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHide,this),this.banGo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goRecharge,this);for(var t=0;t<this.allbianqiangBtns.length;t++){var n=this.allbianqiangBtns[t];n.removeGotypeEventListener()}},t.prototype.onHide=function(){e.prototype.onHide.call(this),Tool.removeTimer(this.onCloseTimedown,this,1e3),GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.GAME_CLOSE_RESULT_VIEW))},t.prototype.goRecharge=function(){0==DataManager.getInstance().rechargeManager.firstCharge?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"FirstChargePanel"):DataManager.getInstance().newactivitysManager.chargeMoneyNum<188&&DataManager.getInstance().newactivitysManager.chargeMoneyNum>=0?GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_GOTYPE_OPEN_WINDOW),FUN_TYPE.FUN_CHONGBANG):GameDispatcher.getInstance().dispatchEvent(new egret.Event(GameEvent.MODULE_WINDOW_OPEN),"RechargePanel")},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this),0==DataManager.getInstance().rechargeManager.firstCharge?(this.banImg.source="result_desc1_png",this.imgDi.source="result_Img1_png"):DataManager.getInstance().newactivitysManager.chargeMoneyNum<188&&DataManager.getInstance().newactivitysManager.chargeMoneyNum>=0?(this.banImg.source="result_desc2_png",this.imgDi.source="result_Img2_png"):(this.banImg.source="result_vipDesc"+this.getPlayerData().viplevel+"_png",this.imgDi.source="result_Img3_png"),this.onPlayAwardAnim(),this._showleftTime=6,Tool.addTimer(this.onCloseTimedown,this,1e3)},t.prototype.getPlayerData=function(){return DataManager.getInstance().playerManager.player},t.prototype.onShowWithParam=function(t){this.itemAwards=t,this.itemAwards&&e.prototype.onShowWithParam.call(this,t)},t.prototype.onPlayAwardAnim=function(){this.ondestory();for(var e=0;e<this.itemAwards.length;e++){var t=this.itemAwards[e],n=new GoodsInstance;this.award_groud.addChild(n),n.onUpdate(t.type,t.id,0,t.quality,t.num)}},t.prototype.ondestory=function(){for(var e=this.award_groud.numChildren-1;e>=0;e--){var t=this.award_groud.getChildAt(e);egret.Tween.removeTweens(t),this.award_groud.removeChild(t),t=null}this.award_groud.removeChildren()},t.prototype.onCloseTimedown=function(){return this._showleftTime--,this._showleftTime<0?(Tool.removeTimer(this.onCloseTimedown,this,1e3),void this.onHide()):void(this.btn_sure.label="离开("+this._showleftTime+")")},t}(BaseWindowPanel);__reflect(YewaiPVPLosePanel.prototype,"YewaiPVPLosePanel");var YewaiPVPPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.funcID=FUN_TYPE.FUN_YEWAIPVP,n}return __extends(t,e),t.prototype.onInit=function(){var t,n,a=[];n=new RegisterSystemParam,n.sysName="RecordPVPPanel",n.btnRes="战绩",n.funcID=FUN_TYPE.FUN_ZHANGONG_RECORD,a.push(n),n=new RegisterSystemParam,n.btnRes="战场",n.funcID=FUN_TYPE.FUN_YEWAIPVP,n.redP=this.createRedPoint(),a.push(n),n.tabBtns=[],t=new RegisterTabBtnParam,t.sysName="EncounterPanel",t.tabBtnRes="z_btn_icon_shilian_png",t.title="试炼",t.funcID=FUN_TYPE.FUN_YEWAIPVP,t.redP=this.createRedPoint(),t.redP.addTriggerFuc(DataManager.getInstance().yewaipvpManager,"checkEncounterPoint"),n.tabBtns.push(t),t=new RegisterTabBtnParam,t.sysName="LocalArenaPanel",t.tabBtnRes="z_btn_icon_jingjichang_png",t.title="竞技场",t.funcID=FUN_TYPE.FUN_ARENA,t.redP=this.createRedPoint(),t.redP.addTriggerFuc(DataManager.getInstance().localArenaManager,"getRedPointShow"),n.tabBtns.push(t),t=new RegisterTabBtnParam,t.sysName="LadderArenaPanel",t.tabBtnRes="z_btn_icon_tianti_png",t.title="天梯",t.funcID=FUN_TYPE.FUN_LADDER,t.redP=this.createRedPoint(),t.redP.addTriggerFuc(DataManager.getInstance().arenaManager,"getLadderPointShow"),n.tabBtns.push(t),t=new RegisterTabBtnParam,t.sysName="EscortPanel",t.tabBtnRes="z_btn_icon_husong_png",t.title="护送",t.funcID=FUN_TYPE.FUN_DUJIE,t.redP=this.createRedPoint(),t.redP.addTriggerFuc(DataManager.getInstance().escortManager,"getShowSysRedpoint"),n.tabBtns.push(t),n=new RegisterSystemParam,n.sysName="ServerArenaPanel",n.btnRes="竞技",n.funcID=FUN_TYPE.FUN_SERVERFIGHT_ARENA,n.redP=this.createRedPoint(),n.redP.addTriggerFuc(FunDefine,"getCrossArenaPoint"),a.push(n),n=new RegisterSystemParam,n.sysName="ServerPVEBossPanel",n.btnRes="诛仙",n.funcID=FUN_TYPE.FUN_SERVERPVEBOSS,n.redP=this.createRedPoint(),n.redP.addTriggerFuc(FunDefine,"getCrossPVEBOSSPoint"),a.push(n),n=new RegisterSystemParam,n.sysName="WuTanPanel",n.btnRes="武坛",n.funcID=FUN_TYPE.FUN_WUTAN,n.redP=this.createRedPoint(),n.redP.addTriggerFuc(DataManager.getInstance().wuTanManager,"checkRedPoint"),a.push(n),this.registerPage(a,"yewaipvpGrp"),e.prototype.onInit.call(this),this.onRefresh()
},t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onRefresh=function(){switch(this.index){case 0:this.setTitle("PVP");break;case 1:this.setTitle("PVP");break;case 2:this.setTitle("竞技");break;case 3:this.setTitle("诛仙");break;case 4:this.setTitle("武坛")}e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(YewaiPVPPanel.prototype,"YewaiPVPPanel");var YuanJieMainPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(1),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin},t.prototype.onInit=function(){this.setTitle("yuanjie_title_png");var t=[],n=new RegisterSystemParam;n.sysName="YuanJiePanel",n.btnRes="yuanjie_btn_2",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().yuanjieManager,"checkRedPoint"),t.push(n),this.registerPage(t,"yuanjiemainGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t}(BaseSystemPanel);__reflect(YuanJieMainPanel.prototype,"YuanJieMainPanel");var YuanJieManager=function(){function e(){this.yjExp=0}return e.prototype.checkRedPoint=function(){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_YUANJIE))return!1;for(var e=this.getModelYuanJie(),t=0;t<e.length;++t)if(this.checkRedPointItem(e[t]))return!0;return!1},e.prototype.checkRedPointItem=function(e){if(!FunDefine.isFunOpen(FUN_TYPE.FUN_YUANJIE))return!1;if(e){var t=e.cost;if(t)return DataManager.getInstance().bagManager.getGoodsThingNumById(t.id,t.type)>=t.num}return!1},e.prototype.getModelYuanJie=function(){if(!this.yuanJie){this.yuanJie=[];var e=JsonModelManager.instance.getModelyuanjie();for(var t in e){var n=e[t];this.yuanJie[n.id-1]=n}}return this.yuanJie},e.prototype.getModelYuanJieLv=function(){if(!this.yuanJieLevel){this.yuanJieLevel=[];var e=JsonModelManager.instance.getModelyuanjielv();for(var t in e){var n=e[t];this.yuanJieLevel[n.id-1]=n}}return this.yuanJieLevel},e.prototype.getAttributePlus=function(e){var t=GameCommon.getInstance().getAttributeAry();if(e)for(var n=0;n<GameDefine.YUANJIE_ATTR.length;n++){var a=GameDefine.YUANJIE_ATTR[n],i=GameDefine.ATTR_OBJ_KEYS[a]+"plus";e[i]>0&&(t[a]=e[i])}return t},e.prototype.getYuanJieModelCurr=function(){var e=DataManager.getInstance().yuanjieManager.getModelYuanJieLv(),t=this.yjExp;if(t>=e[0].max){if(t>=e[e.length-1].max)return e[e.length-1];for(var n=1;n<e.length;++n)if(t<e[n].max&&t>=e[n-1].max)return e[n-1]}return null},e.prototype.getYuanJieModelNext=function(){var e=DataManager.getInstance().yuanjieManager.getModelYuanJieLv(),t=this.yjExp;if(t>=e[0].max){if(t>=e[e.length-1].max)return e[e.length-1];for(var n=1;n<e.length;++n)if(t<e[n].max&&t>=e[n-1].max)return e[n]}return e[0]},e}();__reflect(YuanJieManager.prototype,"YuanJieManager");var YuanJiePanel=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.YuanJiePanelSkin},t.prototype.onInit=function(){this.yjManager=DataManager.getInstance().yuanjieManager,this.basic.label_title.text="元戒进阶",this.basic.closeBtn2.visible=!1,e.prototype.onInit.call(this),this.initUI(),this.initRedPoint(),this.groupLogoY=this.groupLogo.y},t.prototype.actionLogoShow=function(){this.groupLogo.y=this.groupLogoY;var e=750,t=egret.Tween.get(this.groupLogo,{loop:!0});t.to({y:this.groupLogoY-20},e),t.to({y:this.groupLogoY+20},2*e),t.to({y:this.groupLogoY},e)},t.prototype.actionLogoClose=function(){egret.Tween.removeTweens(this.groupLogo)},t.prototype.initRedPoint=function(){this.points=RedPointManager.createPoint(4);for(var e=this.yjManager.getModelYuanJie(),t=0;3>t;++t)this.points[t].register(this.itemGroups[t],new egret.Point(65,0),this.yjManager,"checkRedPointItem",e[t]);this.points[3].register(this.btnZhuYuan,GameDefine.RED_BTN_POS,this,"checkRedPointBtn")},t.prototype.initUI=function(){this.currIdx=0,this.itemGroups=[],this.itemBGs=[],this.itemNames=[];for(var e=this.yjManager.getModelYuanJie(),t=0;3>t;++t)this.itemGroups[t]=this["itemGroup"+t],this.itemBGs[t]=this["itemBg"+t],this.itemNames[t]=this["itemName"+t],this.itemBGs[t].touchEnabled=this.itemNames[t].touchEnabled=!1,this.itemNames[t].text=GameCommon.getInstance().getThingModel(e[t].cost.type,e[t].cost.id).name,this.itemGroups[t].touchEnabled=!0,this.itemGroups[t].name=t.toString(),this.itemGroups[t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectItem,this)},t.prototype.updateUI=function(){for(var e=0;3>e;++e)this.itemBGs[e].source=e==this.currIdx?"yuandi2_png":"yuandi1_png";for(var t="",n="",a=GameCommon.getInstance().getAttributeAry(),i=DataManager.getInstance().playerManager.player.getPlayerData(0).yuanjie,e=0;e<GameDefine.YUANJIE_ATTR.length;e++)a[GameDefine.YUANJIE_ATTR[e]]+=i[e],e<GameDefine.YUANJIE_ATTR.length/2?t+=GameDefine.Attr_FontName[GameDefine.YUANJIE_ATTR[e]]+"：+"+i[e]+"\n":n+=GameDefine.Attr_FontName[GameDefine.YUANJIE_ATTR[e]]+"：+"+i[e]+"\n";this.curPro.text=t,this.nextPro.text=n;var o=this.yjManager.getYuanJieModelCurr();o?this.lbLevel.text="Lv"+o.id:this.lbLevel.text="Lv0";var r=this.yjManager.getAttributePlus(o),s=this.yjManager.getYuanJieModelNext(),h=this.yjManager.getAttributePlus(s);t="",n="";for(var e=0;4>e;++e){var l=GameDefine.YUANJIE_ATTR[e];t+=GameDefine.Attr_FontName[l]+"加成:"+(r[e]/100).toFixed(1)+"%\n",n+=GameDefine.Attr_FontName[l]+"加成:"+(h[e]/100).toFixed(1)+"%\n"}this.attriLeft.text=t,this.attriRight.text=n;var g=this.getModelCurr();this.currency.setCostByAwardItem(g.cost),this.powerbar.power=GameCommon.calculationFighting(a);var c=0,p=0;s&&(o?(this.imgLogo.source=o.waixing+"_png",o==s?c=p=s.max:(c=this.yjManager.yjExp-o.max,p=s.max-o.max)):(this.imgLogo.source=s.waixing+"_png",c=this.yjManager.yjExp,p=s.max)),this.progressExp.maximum=p,this.progressExp.value=c},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),this.onZhuYuanCall(),this.groupAttribute.visible=!1,this.btnZhuYuan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventZhuYuan,this),this.btnAttribute.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventAttributeShow,this),this.groupAttribute.touchEnabled=!0,this.groupAttribute.touchChildren=!1,this.groupAttribute.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventAttributeClose,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.YUANJIE_MESSAGE.toString(),this.onZhuYuanCall,this),this.actionLogoShow()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.btnZhuYuan.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventZhuYuan,this),this.btnAttribute.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventAttributeShow,this),this.groupAttribute.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEventAttributeClose,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.FULING_MESSAGE.toString(),this.onZhuYuanCall,this),this.actionLogoClose()},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t.prototype.getModelCurr=function(){return this.yjManager.getModelYuanJie()[this.currIdx]},t.prototype.onEventAttributeShow=function(){this.groupAttribute.visible=!0},t.prototype.onEventAttributeClose=function(){this.groupAttribute.visible=!1},t.prototype.onEventZhuYuan=function(){var e=this.getModelCurr().cost;if(GameCommon.getInstance().onCheckItemConsume(e.id,e.num,e.type)){var t=new Message(MESSAGE_ID.YUANJIE_MESSAGE);t.setByte(0),t.setShort(this.getModelCurr().id),GameCommon.getInstance().sendMsgToServer(t)}},t.prototype.onZhuYuanCall=function(){this.updateUI()},t.prototype.onSelectItem=function(e){var t=parseInt(e.target.name);t!=this.currIdx&&(this.currIdx=t,this.updateUI())},t.prototype.checkRedPointBtn=function(){return this.yjManager.checkRedPointItem(this.getModelCurr())},t}(BaseTabView);__reflect(YuanJiePanel.prototype,"YuanJiePanel");var ZhanWenComposePanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=1,n.tabindex=2,n.ZHANWEN_NAMEs=["金战纹","木战纹","水战纹","火战纹","土战纹"],n.points=RedPointManager.createPoint(5),n.priority=PANEL_HIERARCHY_TYPE.II,n.rewardArr=new Array,n.effEctScale=0,n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ZhanWenComposeSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RUNE_COMPOS.toString(),this.onheChengRefresh,this),this.btn_xiangqian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeCheng,this),this.batch_bar.onRegist()},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.batch_bar.onRemove(),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RUNE_COMPOS.toString(),this.onheChengRefresh,this),this.btn_xiangqian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeCheng,this)},t.prototype.onInit=function(){this.runesData=[];for(var t=1;t<=this.ZHANWEN_NAMEs.length;t++){this["tab"+t].onUpdate(!1),this["tab"+t].onInit(t),this["tab"+t].name_lab.text=this.ZHANWEN_NAMEs[t-1],this["tab"+t].selectIcon.name=t+"",this["tab"+t].selectIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),this["tab"+t].itemList.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClockText,this),this.points[t-1].register(this["tab"+t],new egret.Point(155,10),DataManager.getInstance().bagManager,"getRnuesLvPoint",t-1);for(var n=this.models(t),a=1;a<n.length;a++)this["tab"+t]["tab"+(a+1)].onUpdate(n[a]),this["tab"+t]["tab"+(a+1)].isSelect(!1)}this.tab1.tab2.isSelect(!0),this.tab1.onUpdate(!0),this.batch_bar.onSetUpdateCall(this.onBatchUpdateHandler,this),e.prototype.onInit.call(this),this.onRefresh(),this.showInfo()},t.prototype.models=function(e){this.rewardArr=[];for(var t in JsonModelManager.instance.getModelzhanwen())JsonModelManager.instance.getModelzhanwen()[t].type==e-1&&this.rewardArr.push(JsonModelManager.instance.getModelzhanwen()[t]);return this.rewardArr},t.prototype.checkPoint1=function(e){for(var t=this.models(this.index),n=0;n<t.length;n++)if(DataManager.getInstance().bagManager.getRnuesList(t[n].id)>1)return n+2;return 2},t.prototype.onClockText=function(e){var t=Number(e.target.name);this["tab"+this.index]["tab"+this.tabindex].isSelect(!1),this["tab"+this.index]["tab"+t].isSelect(!0),this.tabindex=t,this.showInfo()},t.prototype.onBatchUpdateHandler=function(){},t.prototype.showInfo=function(){var e=this.models(this.index)[this.tabindex-2],t=this.models(this.index)[this.tabindex-1];if(this._curModel=e,!t){this.item2.onUpdate(26,e.id);var n=DataManager.getInstance().bagManager.getRnuesList(e.id);this.curNum.text="当前拥有数量:"+n;var a=new BatchParam;return a.maxNum=Math.floor(n/2),void this.batch_bar.onUpdate(a)}this.item1.onUpdate(26,t.id),this.item2.onUpdate(26,e.id);var n=DataManager.getInstance().bagManager.getRnuesList(e.id);this.curNum.text="当前拥有数量:"+n;var a=new BatchParam;a.maxNum=Math.floor(n/2),this.batch_bar.onUpdate(a)},t.prototype.onheChengRefresh=function(){this["tab"+this.index]["tab"+this.tabindex].isSelect(!1),this.tabindex+1<=13?(this.tabindex=this.tabindex+1,this["tab"+this.index]["tab"+this.tabindex].isSelect(!0)):this["tab"+this.index]["tab"+this.tabindex].isSelect(!0);for(var e=this.models(this.index),t=1;t<e.length;t++)this["tab"+this.index]["tab"+(t+1)].setName();this.showInfo(),this.okAnim?(this.okAnim.visible=!0,this.okAnim.playNum=1):(this.okAnim=new Animation("zhuangbeiqianghua",1,!1),this.animLayer.addChild(this.okAnim)),this.okAnim.playFinishCallBack(this.onAnimPlayEnd,this)},t.prototype.onAnimPlayEnd=function(){this.okAnim&&(this.okAnim.visible=!1)},t.prototype.effectName=function(e){var t=1,n="";switch(e){case GoodsQuality.Red:n="hongzhuang";break;case GoodsQuality.Gold:n="jinzhuang",t=.8;break;case GoodsQuality.Orange:n="chengzhuang",t=.95}return this.effEctScale=t,n},t.prototype.onTab=function(e){var t=Number(e.currentTarget.name);this["tab"+this.index]["tab"+this.tabindex].isSelect(!1),this.index==t?this["tab"+t].onUpdate(!this["tab"+t].bool):(this["tab"+this.index].onUpdate(!1),this["tab"+t].onUpdate(!0)),this.index=t,this.tabindex=this.checkPoint1(this.index),this.tabindex>13&&(this.tabindex=13),this["tab"+this.index]["tab"+this.tabindex].isSelect(!0),this.showInfo()},t.prototype.onRefresh=function(){for(var e=this.models(this.index),t=1;t<e.length;t++)this["tab"+this.index]["tab"+(t+1)].onUpdate(e[t]),this["tab"+this.index]["tab"+(t+1)].isSelect(!1),this["tab"+this.index]["tab"+(t+1)].setName();this.tabindex=this.checkPoint1(this.index),this.tabindex>13&&(this.tabindex=13),this["tab"+this.index]["tab"+this.tabindex].isSelect(!0)},t.prototype.onResBossListInfoMsg=function(){for(var e=DataManager.getInstance().dupManager.allpeoplebossData,t=1;10>t;t++){var n=e.xuezhanInfos[t];if(!n)break;var a=ModelManager.getInstance().getModelFigher(n.bossID),i=this["tab"+t];i.label=a.name,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}if(Tool.isNumber(this.selectIndex)){var o=this.selectIndex;this.selectIndex=null,this.onchangeTab(o)}else this.onchangeTab(0)},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.onchangeTab(t.value)},t.prototype.onchangeTab=function(e){this.selectIndex!=e&&(this.selectIndex=e)},t.prototype.onHeCheng=function(){if(!(DataManager.getInstance().bagManager.getRnuesList(this._curModel.id)<2||this.batch_bar.count<=0)){var e=this.batch_bar.count,t=new Message(MESSAGE_ID.RUNE_COMPOS);t.setShort(this._curModel.id),t.setShort(e),GameCommon.getInstance().sendMsgToServer(t)}},t}(BaseTabView);__reflect(ZhanWenComposePanel.prototype,"ZhanWenComposePanel");var ZhanWenTabBtnItem=function(e){function t(){var t=e.call(this)||this;return t.index=1,t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddStage,t),t.skinName=skins.ZhanWenTabBtnSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.itemList.visible=!1},t.prototype.onInit=function(e){this.index=e,this.nameImg.source="wx_newIcon"+e+"_png"},t.prototype.onAddStage=function(){this.touchEnabled=!1},t.prototype.onUpdate=function(e){this.bool=e,e?(this.itemList.visible=!0,this.height=420):(this.itemList.visible=!1,this.height=64)},t.prototype.onTouch=function(e){Tool.log("wodetian")},t}(eui.Component);__reflect(ZhanWenTabBtnItem.prototype,"ZhanWenTabBtnItem");var ZhanWenItemLabelItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddStage,t),t.skinName=skins.ZhanWenLabelSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){},t.prototype.setName=function(){if(DataManager.getInstance().bagManager.getRnuesList(this.model_Cfg.id-1)>1){var e=this.model_Cfg.name+"(<font color=#00ff00>"+Tool.toInt(DataManager.getInstance().bagManager.getRnuesList(this.model_Cfg.id-1)/2)+"</font>)";this.nameLable.textFlow=(new egret.HtmlTextParser).parser(GameCommon.getInstance().readStringToHtml(e))}else this.nameLable.text=this.model_Cfg.name},t.prototype.isSelect=function(e){this.selectImg.source=e?"zwBtn2_png":"zwBtn3_png"},t.prototype.onAddStage=function(){},t.prototype.onUpdate=function(e){this.model_Cfg=e,this.name=e.level.toString(),this.setName()},t.prototype.onTouch=function(e){},t}(eui.Component);__reflect(ZhanWenItemLabelItem.prototype,"ZhanWenItemLabelItem");var ZhanWenMainView=function(e){function t(t){var n=e.call(this,t)||this;return n.points=RedPointManager.createPoint(3),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.BasicSkin,this.setTitle("zhanwen_Title_png")},t.prototype.onInit=function(){var t=[],n=new RegisterSystemParam;n.sysName="ZhanWenViewPanel",n.btnRes="zhanwen_btn",n.redP=this.points[0],n.redP.addTriggerFuc(DataManager.getInstance().bagManager,"checkAllEquipPointPoint"),t.push(n),n=new RegisterSystemParam,n.sysName="ZhanWenComposePanel",n.btnRes="zhanwen_hecheng",n.redP=this.points[1],n.redP.addTriggerFuc(DataManager.getInstance().bagManager,"getRnuesLvPoint"),t.push(n),this.registerPage(t,"zhanwenGrp",GameDefine.RED_TAB_POS),e.prototype.onInit.call(this),this.onRefresh()},t.prototype.onRegist=function(){e.prototype.onRegist.call(this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this)},t.prototype.onRefresh=function(){e.prototype.onRefresh.call(this)},t}(BaseSystemPanel);__reflect(ZhanWenMainView.prototype,"ZhanWenMainView");var ZhanWenViewPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.index=1,n.points=RedPointManager.createPoint(12),n}return __extends(t,e),t.prototype.onSkinName=function(){this.skinName=skins.ZhanWenViewSkin},t.prototype.onRegist=function(){e.prototype.onRegist.call(this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RUNE_WEAR.toString(),this.showPower,this),GameCommon.getInstance().addMsgEventListener(MESSAGE_ID.RUNE_COMPOSE_QUICK.toString(),this.showPower,this),this.btn_xiangqian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipSend,this),this.btn_levelUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeCheng,this)},t.prototype.onRemove=function(){e.prototype.onRemove.call(this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RUNE_WEAR.toString(),this.showPower,this),GameCommon.getInstance().removeMsgEventListener(MESSAGE_ID.RUNE_COMPOSE_QUICK.toString(),this.showPower,this),this.btn_xiangqian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEquipSend,this),this.btn_levelUp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeCheng,this)},t.prototype.onInit=function(){this.runesData=[],this.points[0].register(this.btn_levelUp,new egret.Point(135,-5),DataManager.getInstance().bagManager,"onGetEquipLvUpPoint",1);for(var t=1;10>=t;t++)this["tab"+t].icon.source="zhanwenSlot"+Math.ceil(t/2)+"_png",this["tab"+t].onUpdate(Language.instance.getText("zhanwen_"+t)),this["tab"+t].name=t+"",this["tab"+t].selected=!1,this["tab"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),this.points[t].register(this["tab"+t],new egret.Point(10,10),DataManager.getInstance().bagManager,"checkAllEquipPointPoint",t);this.points[11].register(this.btn_xiangqian,new egret.Point(135,-5),DataManager.getInstance().bagManager,"getEquipRnuesPoint",1),this.tab1.selected=!0,e.prototype.onInit.call(this),this.showPower()},t.prototype.onTab=function(e){var t=Number(e.currentTarget.name);this.index!=t&&(this["tab"+this.index].selected=!1,this.index=t,this.points[11].register(this.btn_xiangqian,new egret.Point(135,-5),DataManager.getInstance().bagManager,"getEquipRnuesPoint",t),this.points[0].register(this.btn_levelUp,new egret.Point(135,-5),DataManager.getInstance().bagManager,"onGetEquipLvUpPoint",t),this["tab"+this.index].selected=!0,this.showInfo())},t.prototype.onRefresh=function(){this.showInfo()},t.prototype.showPower=function(){for(var e="",t="",n=GameCommon.getInstance().getAttributeAry(),a=0,i=0;50>i;i++){var o=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[i];if(o>0)for(var r=JsonModelManager.instance.getModelzhanwen()[o],s=0;s<n.length;s++)n[s]+=r.attrAry[s]}for(var a=0,i=0;i<n.length;i++){a+=1,a%2==0?e=e+GameDefine.Attr_FontName[i]+"："+n[i]+"\n":t=t+GameDefine.Attr_FontName[i]+"："+n[i]+"\n";var h=DataManager.getInstance().playerManager.getTianshiAttrPlusByType(TIANSHI_PULS_TYPE.RUNE);n[s]+=Tool.toInt(r.attrAry[s]*h/GameDefine.GAME_ADD_RATIO)}this.powerBar.power=GameCommon.calculationFighting(n),this.curPro.text=e,this.nextPro.text=t,this.showInfo()},t.prototype.showInfo=function(){for(var e=0,t=5*this.index-5;t<5*this.index;t++){e+=1,this["item"+e].name_label.text="",this["item"+e].item_icon.source="zw_icondi_"+e+"_png",this["item"+e].item_frame.source="bag_whiteframe_png",this["item"+e].currentState="notName",this["item"+e].remAnimation();var n=DataManager.getInstance().playerManager.player.getPlayerData().rnuesList[t];n>0&&(this["item"+e].onUpdate(26,n),this["item"+e].currentState="normal")}},t.prototype.onResBossListInfoMsg=function(){for(var e=DataManager.getInstance().dupManager.allpeoplebossData,t=1;10>t;t++){var n=e.xuezhanInfos[t];if(!n)break;var a=ModelManager.getInstance().getModelFigher(n.bossID),i=this["tab"+t];i.label=a.name,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTab,this)}if(Tool.isNumber(this.selectIndex)){var o=this.selectIndex;this.selectIndex=null,this.onchangeTab(o)}else this.onchangeTab(0)},t.prototype.onTouchTab=function(e){var t=e.currentTarget;this.onchangeTab(t.value)},t.prototype.onchangeTab=function(e){this.selectIndex!=e&&(this.selectIndex=e)},t.prototype.onEquipSend=function(){var e=new Message(MESSAGE_ID.RUNE_WEAR);e.setByte(0),e.setByte(this.index),GameCommon.getInstance().sendMsgToServer(e)},t.prototype.onHeCheng=function(){var e=new Message(MESSAGE_ID.RUNE_COMPOSE_QUICK);e.setByte(0),e.setByte(this.index),GameCommon.getInstance().sendMsgToServer(e)},t}(BaseTabView);__reflect(ZhanWenViewPanel.prototype,"ZhanWenViewPanel");var ZhanWenItem=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.COMPLETE,t.onLoadComplete,t),t.once(egret.Event.ADDED_TO_STAGE,t.onAddStage,t),t.skinName=skins.ZhanWenItemSkin,t}return __extends(t,e),t.prototype.onLoadComplete=function(){this.labName.visible=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onAddStage=function(){this.touchEnabled=!1},Object.defineProperty(t.prototype,"selected",{set:function(e){this.selectImg.visible=e,e?(this.selectedAnim||(this.selectedAnim=new Animation("gonghuijineng_1",-1),this.selectedAnim.scaleX=.75,this.selectedAnim.scaleY=.75,this.selectedAnim.y=41,this.selectedAnim.x=50,this.selectImg.addChild(this.selectedAnim)),this.selectedAnim.onPlay()):this.selectedAnim&&this.selectedAnim.onStop()},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(e){this.labName.text=e},t.prototype.onTouch=function(e){Tool.log("wodetian")},t}(eui.Component);__reflect(ZhanWenItem.prototype,"ZhanWenItem"),window.Main=Main,window.BaseBody=BaseBody,window.BaseWindowPanel=BaseWindowPanel,window.WindowParam=WindowParam,window.ActionBody=ActionBody,window.BodyHead=BodyHead,window.BaseListItem=BaseListItem,window.BaseSystemPanel=BaseSystemPanel,window.RegisterSystemParam=RegisterSystemParam,window.RegisterTabBtnParam=RegisterTabBtnParam,window.BaseTabView=BaseTabView,window.BaseTipsBar=BaseTipsBar,window.BaseFightScene=BaseFightScene,window.RushEnemyData=RushEnemyData,window.SkillEnchantLevelPanel=SkillEnchantLevelPanel,window.SkillEffectBase=SkillEffectBase,window.BaseComp=BaseComp,window.MonsterBody=MonsterBody,window.ActivityZhongqiuBase=ActivityZhongqiuBase,window.ActivityLabaBase=ActivityLabaBase,window.HefuTreasurePanel=HefuTreasurePanel,window.FriendMainPanel=FriendMainPanel,window.FriendItemRenderer=FriendItemRenderer,window.PlayerHeadPanel=PlayerHeadPanel,window.ClothEquipTips=ClothEquipTips,window.GoodsInstance=GoodsInstance,window.TurnplatePanel=TurnplatePanel,window.BodyFactory=BodyFactory,window.BossBody=BossBody,window.CurvilinearBody=CurvilinearBody,window.DropBody=DropBody,window.EffectBody=EffectBody,window.SkillEffectBody=SkillEffectBody,window.FlyFontBody=FlyFontBody,window.FuncBody=FuncBody,window.MagicBody=MagicBody,window.NpcBody=NpcBody,window.AllPeopleBossFight=AllPeopleBossFight,window.PetBody=PetBody,window.CrossPVEBossFight=CrossPVEBossFight,window.DiFuDupFight=DiFuDupFight,window.DupFight=DupFight,window.EscortFight=EscortFight,window.LadderFight=LadderFight,window.LocalArenaFight=LocalArenaFight,window.MysBossFight=MysBossFight,window.RevengeFight=RevengeFight,window.SamsaraBossFight=SamsaraBossFight,window.ServerCrossAraneFight=ServerCrossAraneFight,window.UnionBattleFight=UnionBattleFight,window.UnionBossFight=UnionBossFight,window.WuTanFight=WuTanFight,window.YewaiBossFight=YewaiBossFight,window.YewaiPVEFight=YewaiPVEFight,window.YewaiPVPFight=YewaiPVPFight,window.PlayerBody=PlayerBody,window.RetinueBody=RetinueBody,window.RoleAppearBody=RoleAppearBody,window.ShadowBody=ShadowBody,window.TitleBody=TitleBody,window.BaihuSkillEffect=BaihuSkillEffect,window.BossSkillStyle1Effect=BossSkillStyle1Effect,window.BossSkillStyle2Effect=BossSkillStyle2Effect,window.CommonSkillEffect=CommonSkillEffect,window.FabaoSkillEffect=FabaoSkillEffect,window.FeijianSkillEffect=FeijianSkillEffect,window.SkillEffParam=SkillEffParam,window.SkillParam=SkillParam,window.JianQiSkillEffect=JianQiSkillEffect,window.QingLongSkillEffect=QingLongSkillEffect,window.RetinueSkillEffect=RetinueSkillEffect,window.ShenbingSkillEffect=ShenbingSkillEffect,window.SkillEffectManager=SkillEffectManager,window.XianyuSkillEffect=XianyuSkillEffect,window.XuanWuSkillEffect=XuanWuSkillEffect,window.ZhuQueSkillEffect=ZhuQueSkillEffect,window.ActivityContainerBar=ActivityContainerBar,window.OnlineGiftPanel=OnlineGiftPanel,window.Activity666MainPanel=Activity666MainPanel,window.Activity666Manager=Activity666Manager,window.Activity666Panel=Activity666Panel,window.Activity666RankPanel=Activity666RankPanel,window.Act666RankItem=Act666RankItem,window.ActivityXLDHPanel=ActivityXLDHPanel,window.ActivityLeiChongPanel=ActivityLeiChongPanel,window.OpenServerLeiChongItemData=OpenServerLeiChongItemData,window.ActivityLeiChongItem=ActivityLeiChongItem,window.ActivitysdabiaoPanel=ActivitysdabiaoPanel,window.ActivitySignPanel=ActivitySignPanel,window.SignRewardInstance=SignRewardInstance,window.ActivitysLeijiPanel=ActivitysLeijiPanel,window.ActivitysChongzhiitem=ActivitysChongzhiitem,window.ActivitysTargetRankPanel=ActivitysTargetRankPanel,window.ShenQiTreasureRank=ShenQiTreasureRank,window.ActivitysTargetRechargePanel=ActivitysTargetRechargePanel,window.ActivitysXianFengPanel=ActivitysXianFengPanel,window.ActivityXianFengitem=ActivityXianFengitem,window.ActXianfengData=ActXianfengData,window.ActivitysXiangouPanel=ActivitysXiangouPanel,window.ActivityitemFace=ActivityitemFace,window.LianXuLeiChongPanel=LianXuLeiChongPanel,window.ActivityCDKPanel=ActivityCDKPanel,window.ActivityCoatardPanel=ActivityCoatardPanel,window.ActivityCoatardItem=ActivityCoatardItem,window.ActivityNoticePanel=ActivityNoticePanel,window.ActivityPayGiftPanel=ActivityPayGiftPanel,window.PayGiftItem=PayGiftItem,window.ActivityYaoqianshuPanel=ActivityYaoqianshuPanel,window.ActivityYuekaPanel=ActivityYuekaPanel,window.ActivityZhongqiuDan=ActivityZhongqiuDan,window.ActivityZhongqiuDraw=ActivityZhongqiuDraw,window.ActivityZhongqiuPoker=ActivityZhongqiuPoker,window.ActivityZhongqiuTurntable=ActivityZhongqiuTurntable,window.ActivityZQManager=ActivityZQManager,window.ActivityLabaManager=ActivityLabaManager,window.ActivityZhuanpan=ActivityZhuanpan,window.ActivityZhuanpanDan=ActivityZhuanpanDan,window.ActivityZhuanpanDraw=ActivityZhuanpanDraw,window.ActivityZhuanpanPoker=ActivityZhuanpanPoker,window.ActivityZhuanpanRank=ActivityZhuanpanRank,window.ZhuanpanRankItem=ZhuanpanRankItem,window.ActivityZhuanpanTurntable=ActivityZhuanpanTurntable,window.ActivityZPPanel=ActivityZPPanel,window.ItemBody=ItemBody,window.ClientDownLoadPanel=ClientDownLoadPanel,window.ClientFoursPanel=ClientFoursPanel,window.ActConsumeRewardPanel=ActConsumeRewardPanel,window.ActConsumeRewardItem=ActConsumeRewardItem,window.ActivityConsumeMainPanel=ActivityConsumeMainPanel,window.DeskPanel=DeskPanel,window.FestivalFullMoonPanel=FestivalFullMoonPanel,window.FocusPanel=FocusPanel,window.VerifyPanel=VerifyPanel,window.WanbaGiftPanel=WanbaGiftPanel,window.WanbaVIPGiftPanel=WanbaVIPGiftPanel,window.WanbaVIPGiftItem=WanbaVIPGiftItem,window.WanbaVIPGiftParam=WanbaVIPGiftParam,window.FundPanel=FundPanel,window.FundItem=FundItem,window.HallActivityPanel=HallActivityPanel,window.HallWelfarePanel=HallWelfarePanel,window.InvestPanel=InvestPanel,window.InvestItem=InvestItem,window.RebatePanel=RebatePanel,window.SaveBuyActivityPanel=SaveBuyActivityPanel,window.TargetMainPanel=TargetMainPanel,window.ThousandFoldPanel=ThousandFoldPanel,window.TLGiftPanel=TLGiftPanel,window.TLGiftItem=TLGiftItem,window.TLShopPanel=TLShopPanel,window.TLShopItem=TLShopItem,window.TurnplateAwardPanel=TurnplateAwardPanel,window.TurnplateAwardParam=TurnplateAwardParam,window.VIPTLGiftPanel=VIPTLGiftPanel,window.VipTLGiftItem=VipTLGiftItem,window.HefuActivityPanel=HefuActivityPanel,window.HefuChouqianPanel=HefuChouqianPanel,window.HefuFanpaiPanel=HefuFanpaiPanel,window.HefuMissionPanel=HefuMissionPanel,window.HefuMissionItem=HefuMissionItem,window.HefuPayGiftPanel=HefuPayGiftPanel,window.HefuActDanChongItem=HefuActDanChongItem,window.HefuRankPanel=HefuRankPanel,window.HefuActRankItem=HefuActRankItem,window.HefuRechargePanel=HefuRechargePanel,window.HefuXunBaoPanel=HefuXunBaoPanel,window.HefuZaDanPanel=HefuZaDanPanel,window.NewHefuActivityPanel=NewHefuActivityPanel,window.ActJueXingDanPanel=ActJueXingDanPanel,window.LuckTurnplatePanel=LuckTurnplatePanel,window.LuckTurnplateWinPanel=LuckTurnplateWinPanel,window.LiuYiActivityPanel=LiuYiActivityPanel,window.LiuYiDanChongPanel=LiuYiDanChongPanel,window.ActivityDanChongItem=ActivityDanChongItem,window.LiuYiLoginActivityPanel=LiuYiLoginActivityPanel,window.LiuyiMissionPanel=LiuyiMissionPanel,window.LiuyiMissionItem=LiuyiMissionItem,window.LiuYiTreasurePanel=LiuYiTreasurePanel,window.LiuyiTreasureRankPanel=LiuyiTreasureRankPanel,window.LiuyiTreasureItem=LiuyiTreasureItem,window.ActivityPublicPanel=ActivityPublicPanel,window.FirstChargePanel=FirstChargePanel,window.GodWeaponRechargePanel=GodWeaponRechargePanel,window.RechargeOnePanel=RechargeOnePanel,window.RechargePanel=RechargePanel,window.RechargeItem=RechargeItem,window.TakeMoneyEveryDayPanel=TakeMoneyEveryDayPanel,window.TakeURMoneyGiveUArtifactPanel=TakeURMoneyGiveUArtifactPanel,window.SevenDayCarnivalPanel=SevenDayCarnivalPanel,window.SevDayObjectiveItem=SevDayObjectiveItem,window.ShareInfoPanel=ShareInfoPanel,window.ShareRewardItem=ShareRewardItem,window.WXCollectionGameView=WXCollectionGameView,window.WXFirstSharePanel=WXFirstSharePanel,window.WXShareLevelAwardPanel=WXShareLevelAwardPanel,window.WXShareMainView=WXShareMainView,window.WXShareAwardItem=WXShareAwardItem,window.WXFriendInviteAwardItem=WXFriendInviteAwardItem,window.ShenQiActPanel=ShenQiActPanel,window.ShenQiTreasurePanel=ShenQiTreasurePanel,window.ShenQiTreasureRankPanel=ShenQiTreasureRankPanel,window.Sign8Panel=Sign8Panel,window.Sign8Item=Sign8Item,window.ExchangeDebrisPanel=ExchangeDebrisPanel,window.TreasureRankListPanel=TreasureRankListPanel,window.TreasureListItemRenderer=TreasureListItemRenderer,window.TreasureRankPanel=TreasureRankPanel,window.TreasureRankItem=TreasureRankItem,window.ActivityCrossPayRankPanel=ActivityCrossPayRankPanel,window.CrossPayRankItem=CrossPayRankItem,window.ActivityTuangouMainPanel=ActivityTuangouMainPanel,window.ActivityZhongchouPanel=ActivityZhongchouPanel,window.ActZhongchouItem=ActZhongchouItem,window.ActivitysVipXiangouPanel=ActivitysVipXiangouPanel,window.VipLimitItem=VipLimitItem,window.VipActMainView=VipActMainView,window.VipPanel=VipPanel,window.VipZhuanPanPanel=VipZhuanPanPanel,window.WuYiActivityPanel=WuYiActivityPanel,window.WuYiLoginActivityPanel=WuYiLoginActivityPanel,window.WuYiSaleActivityPanel=WuYiSaleActivityPanel,window.WuyiTreasurePanel=WuyiTreasurePanel,window.ActivityYugaoPanel=ActivityYugaoPanel,window.AlertDescUI=AlertDescUI,window.AlertDisconnect=AlertDisconnect,window.AlertEscort=AlertEscort,window.AlertEscortParam=AlertEscortParam,window.AlertFrameUI=AlertFrameUI,window.AlertFrameParam=AlertFrameParam,window.AlertReLogin=AlertReLogin,window.AwardNoticePanel=AwardNoticePanel,window.AwardNoticeParam=AwardNoticeParam,window.BlessUpDanPanel=BlessUpDanPanel,window.ExplainPanel=ExplainPanel,window.FastBuyPanel=FastBuyPanel,window.StrongerButton=StrongerButton,window.FastGetItem=FastGetItem,window.FuncTipsBar=FuncTipsBar,window.FuncTipsObj=FuncTipsObj,window.ObtainHintEquip=ObtainHintEquip,window.ObtainHintSys=ObtainHintSys,window.ObtainHintParam=ObtainHintParam,window.ObtainHintUseGoods=ObtainHintUseGoods,window.RareEquip=RareEquip,window.LocalArenaFirstAwdPanel=LocalArenaFirstAwdPanel,window.LocalArenaFirstAwdItem=LocalArenaFirstAwdItem,window.LocalArenaHistoryPanel=LocalArenaHistoryPanel,window.LocalArenaPanel=LocalArenaPanel,window.LocalArenaMatchItem=LocalArenaMatchItem,window.LocalArenaRankPanel=LocalArenaRankPanel,window.LocalAraneRankItem=LocalAraneRankItem,window.LocalArenaWinPanel=LocalArenaWinPanel,window.AttributeItem=AttributeItem,window.BagPanel=BagPanel,window.BagTypePanel=BagTypePanel,window.BagItemRenderer=BagItemRenderer,window.PlayerMessageBar=PlayerMessageBar,window.SystemMessageBar=SystemMessageBar,window.ChatChannelCD=ChatChannelCD,window.ChatMainPanel=ChatMainPanel,window.ChatPanelParam=ChatPanelParam,window.ChatPanel=ChatPanel,window.ChatBubble=ChatBubble,window.ChatPrivatePanel=ChatPrivatePanel,window.Emoji=Emoji,window.RichTextField=RichTextField,window.ConsumeBar=ConsumeBar,window.ConsumeBar2=ConsumeBar2,window.CurrencyBar=CurrencyBar,window.CurrencyParam=CurrencyParam,window.DamageRankBar=DamageRankBar,window.DamageRankItem=DamageRankItem,window.BossDamageParam=BossDamageParam,window.GameLoadingUIByGroup=GameLoadingUIByGroup,window.PlayerHeadUI=PlayerHeadUI,window.ScrollerTabBtnsBar=ScrollerTabBtnsBar,window.TimesBar=TimesBar,window.TreasureAwardSmallPanel=TreasureAwardSmallPanel,window.AllPeopleBossView=AllPeopleBossView,window.AllPeopleBossItem=AllPeopleBossItem,window.AllPeopleRemindPanel=AllPeopleRemindPanel,window.AllPeopleRemindItem=AllPeopleRemindItem,window.CrossBarriersPanel=CrossBarriersPanel,window.MyBossKillPanel=MyBossKillPanel,window.MyBossKillLogItem=MyBossKillLogItem,window.MyBossKillLogParam=MyBossKillLogParam,window.PersonallyBossView=PersonallyBossView,window.PersonallyBossItem=PersonallyBossItem,window.PersonallyItemData=PersonallyItemData,window.SamsaraAwardPanel=SamsaraAwardPanel,window.SamsaraBossKillLogPanel=SamsaraBossKillLogPanel,window.SamsaraBossKillLogItem=SamsaraBossKillLogItem,window.SamsaraBossKillLogParam=SamsaraBossKillLogParam,window.SamsaraBossView=SamsaraBossView,window.SamsaraBossItem=SamsaraBossItem,window.SamsaraBossBackAwdPanel=SamsaraBossBackAwdPanel,window.VIPTeamBossView=VIPTeamBossView,window.VIPTeamBossBar=VIPTeamBossBar,window.XuezhanBossView=XuezhanBossView,window.ZhuXianBossMain=ZhuXianBossMain,window.ZhuXianBossPanel=ZhuXianBossPanel,window.DomAdvancePanel=DomAdvancePanel,window.DomDecomposePanel=DomDecomposePanel,window.DomUpgradePanel=DomUpgradePanel,window.DragonSoulPanel=DragonSoulPanel,window.DragonSoulItem=DragonSoulItem,window.BlessDupView=BlessDupView,window.CailiaoDupView=CailiaoDupView,window.CailiaoDupItem=CailiaoDupItem,window.ChallengeDupView=ChallengeDupView,window.DupLosePanel=DupLosePanel,window.DupPanel=DupPanel,window.DupWinPanel=DupWinPanel,window.SixiangDupResultPanel=SixiangDupResultPanel,window.DupWinParam=DupWinParam,window.SixiangDupView=SixiangDupView,window.TeamDupReadyPanel=TeamDupReadyPanel,window.TeamDupView=TeamDupView,window.TeamDupInfoItem=TeamDupInfoItem,window.XuezhanBuffPanel=XuezhanBuffPanel,window.XuezhanBuffItem=XuezhanBuffItem,window.XuezhanView=XuezhanView,window.YeWaiChallengePanel=YeWaiChallengePanel,window.YewaiFieldWinPanel=YewaiFieldWinPanel,window.CelestialPanel=CelestialPanel,window.EquipDepotPanel=EquipDepotPanel,window.DepotItemRenderer=DepotItemRenderer,window.EquipNBPanel=EquipNBPanel,window.OrangePanel=OrangePanel,window.OrangeResPanel=OrangeResPanel,window.OrangeItem=OrangeItem,window.QihunPanel=QihunPanel,window.TreasureAwardPanel=TreasureAwardPanel,window.TreasurePanel=TreasurePanel,window.EscortAwardPanel=EscortAwardPanel,window.EscortBeRobPanel=EscortBeRobPanel,window.EscortPanel=EscortPanel,window.EscortProgressBar=EscortProgressBar,window.EscortCar=EscortCar,window.EscortRevengePanel=EscortRevengePanel,window.EscortRobPanel=EscortRobPanel,window.EscortRobitem=EscortRobitem,window.SonniePanel=SonniePanel,window.SonnieItem=SonnieItem,window.ArenaWinPanel=ArenaWinPanel,window.LadderArenaParam=LadderArenaParam,window.BattlePanel=BattlePanel,window.LadderAwardPanel=LadderAwardPanel,window.LadderAraneRankPanel=LadderAraneRankPanel,window.LadderAraneRankItem=LadderAraneRankItem,window.LadderArenaPanel=LadderArenaPanel,window.LadderAreneItem=LadderAreneItem,window.LadderReadyPanel=LadderReadyPanel,window.LadderInspirePanel=LadderInspirePanel,window.RevivePanel=RevivePanel,window.FSAdvancePanel=FSAdvancePanel,window.FSTreasurePanel=FSTreasurePanel,window.FSTreasureItem=FSTreasureItem,window.FSUpgradePanel=FSUpgradePanel,window.ForgePanel=ForgePanel,window.ForgeSlot=ForgeSlot,window.suitAttributeItem=suitAttributeItem,window.ForgePosInfo=ForgePosInfo,window.GemInlayPanel=GemInlayPanel,window.GemInlayItem=GemInlayItem,window.InfusePanel=InfusePanel,window.IntensifyPanel=IntensifyPanel,window.QuenchingPanel=QuenchingPanel,window.SmeltSelectPanel=SmeltSelectPanel,window.SmeltSelectParam=SmeltSelectParam,window.ZhuHunPanel=ZhuHunPanel,window.FriendAddPanel=FriendAddPanel,window.FriendApplyPanel=FriendApplyPanel,window.FriendApplyItemRenderer=FriendApplyItemRenderer,window.FriendBlackList=FriendBlackList,window.FriendBlackListItemRenderer=FriendBlackListItemRenderer,window.FriendFuncPanel=FriendFuncPanel,window.FriendFuncParam=FriendFuncParam,window.FriendListChatPanel=FriendListChatPanel,window.FriendChatItemRenderer=FriendChatItemRenderer,window.FriendListPanel=FriendListPanel,window.FriendListItemRenderer=FriendListItemRenderer,window.FuLingDupPanel=FuLingDupPanel,window.FuLingMainViewPanel=FuLingMainViewPanel,window.FulingPross=FulingPross,window.FuLingViewPanel=FuLingViewPanel,window.FuLingItem=FuLingItem,window.ArtifactInstance=ArtifactInstance,window.BagInstance=BagInstance,window.BoxTipsBar=BoxTipsBar,window.DominateInstance=DominateInstance,window.EquipInstance=EquipInstance,window.EquipTipsBar=EquipTipsBar,window.ItemIntroducebar=ItemIntroducebar,window.IntroduceBarParam=IntroduceBarParam,window.NormalTipsBar=NormalTipsBar,window.OtherEquipTips=OtherEquipTips,window.PetInstance=PetInstance,window.ShopTipsBar=ShopTipsBar,window.SmeltInstance=SmeltInstance,window.MarryCooperationPanel=MarryCooperationPanel,window.MarryDivorcePanel=MarryDivorcePanel,window.MarryDupPanel=MarryDupPanel,window.MarryEquipSuitBoss=MarryEquipSuitBoss,window.MarryEquipSuitLevelup=MarryEquipSuitLevelup,window.MarryEquipSuitPanel=MarryEquipSuitPanel,window.MarryEquipSuitItem=MarryEquipSuitItem,window.MarryEquipSuitQHDS=MarryEquipSuitQHDS,window.MarryListPanel=MarryListPanel,window.MarryItem=MarryItem,window.MarryMainPanel=MarryMainPanel,window.MarryQiuHunPanel=MarryQiuHunPanel,window.MarryRingManager=MarryRingManager,window.MarryRingPanel=MarryRingPanel,window.MarryRingItem=MarryRingItem,window.MarryTreePanel=MarryTreePanel,window.ExhibitionItem=ExhibitionItem,window.AttributesPanel=AttributesPanel,window.AttributesText=AttributesText,window.AttributesNewText=AttributesNewText,window.RoleEquipPanel=RoleEquipPanel,window.RolePanel=RolePanel,window.RoleSelectBar=RoleSelectBar,window.SkillAttPanel=SkillAttPanel,window.SkillRolePanel=SkillRolePanel,window.SkillUpgradeItem=SkillUpgradeItem,window.SkillTipsPanel=SkillTipsPanel,window.SkillUpgradeView=SkillUpgradeView,window.SpecialEquipPanel=SpecialEquipPanel,window.WuxingPanel=WuxingPanel,window.LegendMainView=LegendMainView,window.VipGodArtifactPanel=VipGodArtifactPanel,window.DiFuDupChallenge=DiFuDupChallenge,window.XueZhanDifficultySelect=XueZhanDifficultySelect,window.DiFuDupPanel=DiFuDupPanel,window.XuezhanItem=XuezhanItem,window.LieMingIntroducebar=LieMingIntroducebar,window.LieMingIntroducebarParam=LieMingIntroducebarParam,window.LieMingMainPanel=LieMingMainPanel,window.LieMingObtainPanel=LieMingObtainPanel,window.LieMingItemRenderer=LieMingItemRenderer,window.MingGeItem=MingGeItem,window.LieMingPackagePanel=LieMingPackagePanel,window.LieMingData=LieMingData,window.LieMingSanHunPanel=LieMingSanHunPanel,window.LieMingUpLevel=LieMingUpLevel,window.LieMingUpLvPop=LieMingUpLvPop,window.Magic3DanPanel=Magic3DanPanel,window.MagicBaoQiPanel=MagicBaoQiPanel,window.MagicBasicPanel=MagicBasicPanel,window.MagicEquipPanel=MagicEquipPanel,window.MagicGodWeaponPanel=MagicGodWeaponPanel,window.MagicGodZhuangPanel=MagicGodZhuangPanel,window.MagicSlot=MagicSlot,window.MagicPosInfo=MagicPosInfo,window.MagicJueXingDanPanel=MagicJueXingDanPanel,window.MagicLingDanPanel=MagicLingDanPanel,window.MagicMainViewPanel=MagicMainViewPanel,window.MagicSkillFashionPanel=MagicSkillFashionPanel,window.MagicSkillPanel=MagicSkillPanel,window.MagicViewPanel=MagicViewPanel,window.MagicWingPanel=MagicWingPanel,window.MagicZhuanPanPanel=MagicZhuanPanPanel,window.MagicZiZhiDan=MagicZiZhiDan,window.MailPanel=MailPanel,window.MailTypePanel=MailTypePanel,window.MailItem=MailItem,window.BossTargetBar=BossTargetBar,window.ChangeNamePanel=ChangeNamePanel,window.DupguankaxiaolvPanel=DupguankaxiaolvPanel,window.MainVIew_btnBar=MainVIew_btnBar,window.MainView=MainView,window.OpenFuncView=OpenFuncView,window.FuncOpenItem=FuncOpenItem,window.OpenFunTipsBar=OpenFunTipsBar,window.OtherTargetBar=OtherTargetBar,window.PlayerHeadFramePanel=PlayerHeadFramePanel,window.HeadFrameItem=HeadFrameItem,window.PlayerSettingPanel=PlayerSettingPanel,window.SamsaraFuncBar=SamsaraFuncBar,window.StoryPanel=StoryPanel,window.SystemOptPanel=SystemOptPanel,window.PlayerIconItem=PlayerIconItem,window.TimeLimitPlayPanel=TimeLimitPlayPanel,window.TimeLimitPlayItem=TimeLimitPlayItem,window.Welcome=Welcome,window.OffLineExpPanel=OffLineExpPanel,window.BarText=BarText,window.PetEnchantPanel=PetEnchantPanel,window.PetSoulItem=PetSoulItem,window.PetLingDanPanel=PetLingDanPanel,window.PetMainPanel=PetMainPanel,window.PetUpdatePanel=PetUpdatePanel,window.PetUpgradePanel=PetUpgradePanel,window.PetZiZhiDan=PetZiZhiDan,window.PowerBar=PowerBar,window.FightingChangeAnim=FightingChangeAnim,window.GameGuideBar=GameGuideBar,window.GuideParam=GuideParam,window.PromptInfo=PromptInfo,window.PromptPanel=PromptPanel,window.RareEquipCtrl=RareEquipCtrl,window.PsychDecompose=PsychDecompose,window.PsychInstance=PsychInstance,window.PsychIntroducebar=PsychIntroducebar,window.PsychIntroducebarParam=PsychIntroducebarParam,window.PsychPanel=PsychPanel,window.PsychPreviewPanel=PsychPreviewPanel,window.PsychSelectPanel=PsychSelectPanel,window.PsychSelectItem=PsychSelectItem,window.PsychSelectParam=PsychSelectParam,window.PulsePanel=PulsePanel,window.PulseProgress=PulseProgress,window.BaseGiftContainer=BaseGiftContainer,window.BasePayContainer=BasePayContainer,window.SDKGiftPanel=SDKGiftPanel,window.AraneRankPanel=AraneRankPanel,window.AraneRankItem=AraneRankItem,window.ArenaHistoryPanel=ArenaHistoryPanel,window.ArenaHistroyItem=ArenaHistroyItem,window.ServerArenaAwdPanel=ServerArenaAwdPanel,window.ArenaSinlgeRankAwdItem=ArenaSinlgeRankAwdItem,window.ServerArenaPanel=ServerArenaPanel,window.AraneMatchItem=AraneMatchItem,window.ServerPVEBossAwardPanel=ServerPVEBossAwardPanel,window.ServerPVEBossDmgView=ServerPVEBossDmgView,window.ServerPVEBossDmgItem=ServerPVEBossDmgItem,window.ServerPVEBossDmgParam=ServerPVEBossDmgParam,window.ServerPVEBossPanel=ServerPVEBossPanel,window.BatchDisposebar=BatchDisposebar,window.BatchParam=BatchParam,window.PvPShopPanel=PvPShopPanel,window.ShopPanel=ShopPanel,window.ShopParam=ShopParam,window.ShopTypePanel=ShopTypePanel,window.shopdate=shopdate,window.ShopItem=ShopItem,window.SkillEnchantGradePanel=SkillEnchantGradePanel,window.SmeltActPanel=SmeltActPanel,window.SmeltActItem=SmeltActItem,window.SmeltEquipPanel=SmeltEquipPanel,window.SmeltPanel=SmeltPanel,window.SmeltSpecialPanel=SmeltSpecialPanel,window.StrongerMonsterPanel=StrongerMonsterPanel,window.ChengJiuAwardPanel=ChengJiuAwardPanel,window.ChengJiuAwardItem=ChengJiuAwardItem,window.ChengJiuPanel=ChengJiuPanel,window.ChengJiuItem=ChengJiuItem,window.CoatardPanel=CoatardPanel,window.CoatardTaskItem=CoatardTaskItem,window.JianchiPanel=JianchiPanel,window.JianchiTaskItem=JianchiTaskItem,window.TaskBasePanel=TaskBasePanel,window.ZhuanShengPanel=ZhuanShengPanel,window.TianshiAtlasPanel=TianshiAtlasPanel,window.TianshiAtlasItem=TianshiAtlasItem,window.TianShiLevelPanel=TianShiLevelPanel,window.TianShiMainPanel=TianShiMainPanel,window.TianshuLevelUpPanel=TianshuLevelUpPanel,window.TianshuMainPanel=TianshuMainPanel,window.TianshuUpgradePanel=TianshuUpgradePanel,window.RoleTitlePanel=RoleTitlePanel,window.TitleItem=TitleItem,window.TitleUpLvPanel=TitleUpLvPanel,window.OtherCoatardPanel=OtherCoatardPanel,window.OtherForgePanel=OtherForgePanel,window.OtherjingmaiPanel=OtherjingmaiPanel,window.OtherLegendEquipPanel=OtherLegendEquipPanel,window.OtherOrangePanel=OtherOrangePanel,window.OtherPanel=OtherPanel,window.OtherplayerDate=OtherplayerDate,window.OtherPsychPanel=OtherPsychPanel,window.OtherPulsePanel=OtherPulsePanel,window.OtherSkillPanel=OtherSkillPanel,window.TopRankActivityPanel=TopRankActivityPanel,window.TopRankActivityItem=TopRankActivityItem,window.TOPRankingList=TOPRankingList,window.TopRankSimplePanel=TopRankSimplePanel,window.TopRankSimpleItem=TopRankSimpleItem,window.TopRankSimpleParam=TopRankSimpleParam,window.TOPRankTypeListPanel=TOPRankTypeListPanel,window.TopRankItem=TopRankItem,window.TuJianPanel=TuJianPanel,window.TuJianItem=TuJianItem,window.TujianTabItem=TujianTabItem,window.TuJianUpGrade=TuJianUpGrade,window.TurnplateBase=TurnplateBase,window.UnionAppPointPanel=UnionAppPointPanel,window.UnionBossFightPanel=UnionBossFightPanel,window.UnionBossView=UnionBossView,window.UnionBossItem=UnionBossItem,window.UnionCopyView=UnionCopyView,window.UnionDupYesFirstData=UnionDupYesFirstData,window.UnionCreatePanel=UnionCreatePanel,window.UnionHallPanel=UnionHallPanel,window.UnionInputPanel=UnionInputPanel,window.UnionHallView=UnionHallView,window.UnionLimitLevelPanel=UnionLimitLevelPanel,window.UnionListPanel=UnionListPanel,window.UnionListItem=UnionListItem,window.UnionLogPanel=UnionLogPanel,window.UnionLogView=UnionLogView,window.UnionMainCityPanel=UnionMainCityPanel,window.UnionMainCityMemberItem=UnionMainCityMemberItem,window.UnionMemberInfoView=UnionMemberInfoView,window.UnionMemberListPanel=UnionMemberListPanel,window.UnionMemberItem=UnionMemberItem,window.ApplyPlayerItem=ApplyPlayerItem,window.UnionLogItem=UnionLogItem,window.UnionMemberListView=UnionMemberListView,window.UnionPrizeRecordPanel=UnionPrizeRecordPanel,window.UnionRankView=UnionRankView,window.UnionRankItem=UnionRankItem,window.UnionSearchPanel=UnionSearchPanel,window.UnionSkillPanel=UnionSkillPanel,window.UnionTaskView=UnionTaskView,window.UnionTaskItem=UnionTaskItem,window.UnionTributePanel=UnionTributePanel,window.UnionTributeItem=UnionTributeItem,window.UnionTurnplatePanel=UnionTurnplatePanel,window.UnionAllotAlertPanel=UnionAllotAlertPanel,window.UnionAllotParam=UnionAllotParam,window.UnionBattleAwdPanel=UnionBattleAwdPanel,window.UnionBattleAwdItem1=UnionBattleAwdItem1,window.UnionBattleAwdItem=UnionBattleAwdItem,window.UnionBattleGroupView=UnionBattleGroupView,window.UnionBattleGroupBar=UnionBattleGroupBar,window.UnionBattleGroupLine=UnionBattleGroupLine,window.UnionBattleMemberCangKuPanel=UnionBattleMemberCangKuPanel,window.UnionBattleHead=UnionBattleHead,window.UnionAllotParam1=UnionAllotParam1,window.UnionBattleRankPanel=UnionBattleRankPanel,window.UnionBattleRankItem=UnionBattleRankItem,window.UnionBattleResultPanel=UnionBattleResultPanel,window.UnionBattleResultParam=UnionBattleResultParam,window.UnionBattleWarehousePanel=UnionBattleWarehousePanel,window.UnionBattleWarehouseItem=UnionBattleWarehouseItem,window.UnionDepotView=UnionDepotView,window.UnionDepotItem=UnionDepotItem,window.UnionDepotAllotBar1=UnionDepotAllotBar1,window.UnionInspirePanel=UnionInspirePanel,window.MysteriousBossSummonPannel=MysteriousBossSummonPannel,window.MysteriousRewardsPanel=MysteriousRewardsPanel,window.WaitLoadingPanel=WaitLoadingPanel,window.WuTanAlertBuy=WuTanAlertBuy,window.WuTanAlertFight=WuTanAlertFight,window.WuTanAlertParam=WuTanAlertParam,window.WuTanAlertSelf=WuTanAlertSelf,window.WuTanManager=WuTanManager,window.WuTanPanel=WuTanPanel,window.WuTanPanel2=WuTanPanel2,window.WuTanItemTop=WuTanItemTop,window.WuTanItemDown=WuTanItemDown,window.WuTanResponseInfo=WuTanResponseInfo,window.WuTanListbody=WuTanListbody,window.XianDanDupPanel=XianDanDupPanel,window.XianDanDupView=XianDanDupView,window.XianDanInfo=XianDanInfo,window.XianDanMainViewPanel=XianDanMainViewPanel,window.XianDanManager=XianDanManager,window.XianDanRollData=XianDanRollData,window.XianDanTabView=XianDanTabView,window.XianDanItem=XianDanItem,window.XianShanBossView=XianShanBossView,window.XianShanBossItem=XianShanBossItem,window.XinFaPanel=XinFaPanel,window.XinfaItem=XinfaItem,window.XinfaUpgradePanel=XinfaUpgradePanel,window.EncounterLogPanel=EncounterLogPanel,window.EncounterLogItem=EncounterLogItem,window.EncounterLogItemData=EncounterLogItemData,window.EncounterPanel=EncounterPanel,window.EncounterItem=EncounterItem,window.PVPManager=PVPManager,window.PVPData=PVPData,window.RecordPVPPanel=RecordPVPPanel,window.RecordPVPItem=RecordPVPItem,window.YewaiPVPLosePanel=YewaiPVPLosePanel,window.YewaiPVPPanel=YewaiPVPPanel,window.YuanJieMainPanel=YuanJieMainPanel,window.YuanJieManager=YuanJieManager,window.YuanJiePanel=YuanJiePanel,window.ZhanWenComposePanel=ZhanWenComposePanel,window.ZhanWenTabBtnItem=ZhanWenTabBtnItem,window.ZhanWenItemLabelItem=ZhanWenItemLabelItem,window.ZhanWenMainView=ZhanWenMainView,window.ZhanWenViewPanel=ZhanWenViewPanel,window.ZhanWenItem=ZhanWenItem;
